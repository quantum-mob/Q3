(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    109373,       3080]
NotebookOptionsPosition[     97755,       2845]
NotebookOutlinePosition[     99994,       2901]
CellTagsIndexPosition[     99908,       2896]
WindowTitle->FockBilinearSystem
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3S SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "a15198a5-b3e1-48c0-82c1-8adfdfe3df40"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "836ea311-289c-414d-812e-299ba05e5d5d"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "87f503a6-94f7-4619-908c-c02de21db8d7"]
         }],ExpressionUUID->"1d16ef9b-795b-4462-835a-a8e30557d871"],
         StripOnInput->False],{
        StyleBox[
          "\"FockBilinearQ\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/FockBilinearQ"], 
         StyleBox[
          "\"FockBilinearOperators\"", "SeeAlsoRelated", StripOnInput -> 
           False] :> Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/ref/FockBilinearOperators"], 
         StyleBox[
          "\"FockBilinearMatrix\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/ref/FockBilinearMatrix"], 
         StyleBox[
          "\"FockBilinearSystem\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/ref/FockBilinearSystem"], 
         StyleBox[
          "\"CoefficientTensor\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/ref/CoefficientTensor"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "aafe5d7f-5e4a-4ca4-9c8b-4e463ab3688b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "83692c39-4c17-4f96-ad41-617bbfc0b72f"]
         }],ExpressionUUID->"2674f476-ce09-47fc-b224-c751ae566305"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/guide/QuantumManyBodySystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "0050484c-6527-45ae-8526-30da44644f67"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "2ebdc773-bfa6-46f4-87f8-27e1874428a7"]
         }],ExpressionUUID->"930bb226-2d04-45f4-a254-54857c636cf8"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumManyBodySystems"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "edf155a2-ec33-4431-a8d7-2abf3b716157"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "ffc728af-c904-4c5e-9cda-2e55fbac3c83"]
         }],ExpressionUUID->"cee970ff-2846-4528-b0c0-ecde4b663d71"],
         StripOnInput->False],{
        "\"QuantumMob/Q3S/ref/FockBilinearSystem\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3S/ref/FockBilinearSystem"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3S/ref/\
FockBilinearSystem.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "QuantumMob/Q3S/ref/FockBilinearSystem" <> ".html"], None}]}]},
        
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "4b45b0f0-f5eb-4b59-8605-afc1d8ef5501"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "54810919-72af-4260-ba0a-8589858bc9cc"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"c133e1f4-5d59-4a1f-bb41-4dee2c75da6c"],

Cell["QuantumMob`Q3S`", "ContextNameCell",ExpressionUUID->"adb3c5dc-e6f6-4cd0-a010-b415d1d2f329"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "FockBilinearSystem", "ObjectName",ExpressionUUID->
      "2353b021-48c1-4c27-a80c-cf612eca11ca"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"9612c1b0-7d3c-482d-9c1c-80b9426bff12"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "b0ec46f8-b884-4b8d-8fd8-1afa553b54a8"]
    }],ExpressionUUID->"85d739f8-477a-4ae9-aaf1-32dba34b6328"], 
    "\[SpanFromLeft]"}
  }]], "ObjectNameGrid",ExpressionUUID->"f1bfdc41-a4a8-4afd-90ad-\
552ebcfdec68"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"FockBilinearSystem", "[", "expr", "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "753142fa-1ab3-4ccc-bd7f-12f6dd1e74fe"],
     " \[LineSeparator]returns a list of {operators, matrix} of the bilinear \
combination."
    }],ExpressionUUID->"751a9055-e1f0-441c-a165-ba4756527bb9"]}
  }]], "Usage",
 CellID->982511436,ExpressionUUID->"d894b4bd-5431-44b9-9787-7c1e864af0f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375}}]],
  ExpressionUUID->"c4b44c9e-f41f-4d3d-9439-7f605fc82d94"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"f7dec356-db91-423b-ae6b-ef9dd9f7215f"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "5ed6e98d-23e9-4fdc-a80a-7ea21ef4bbf1"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->1961773882,ExpressionUUID->"40f796e8-ad4f-472c-b994-ccb61855df9b"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3S`\>\"", "]"}]], "Input", \
"ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->742081683,ExpressionUUID->"3d930caf-cbae-4e7f-a2e9-36c378fa3941"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625}}]],
  ExpressionUUID->"319e9eef-d01c-447e-bf6b-17b77cdd5f36"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"1d38f5fa-9afc-408c-8832-dd01211c6ce1"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "598de5d9-b956-48a7-bef3-86460877568c"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1217202383,ExpressionUUID->"c982d34f-7554-42a6-b8de-42012a3d9cac"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Boson", ",", "a"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[1]:=",
 CellID->54356201,ExpressionUUID->"1d884ec3-ca88-47bc-b168-30e3cbda0568"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"a", "[", "2", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], "**", 
       RowBox[{"a", "[", "3", "]"}]}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[2]:=",
 CellID->301411736,ExpressionUUID->"ead50cac-9338-40e8-ad62-7e02875d321d"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`a[1]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`a[3], 
       $CellContext`a[1]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->2048158089,ExpressionUUID->"6d38535b-bb29-402a-b8c3-6d56e0b72f48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`a[3]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`a[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`a[3], 
     $CellContext`a[1]]]}], "+", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"a", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`a[2]]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`a[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`a[2]], 
     $CellContext`a[1]]]}]}]], "Print",
 CellLabel->"During evaluation of In[372]:=",
 CellID->1377624060,ExpressionUUID->"262af68c-6100-4eb5-8527-977f283b1cc2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`a[1]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`a[2]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`a[3]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[2]]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[3]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[372]:=",
 CellID->1706378113,ExpressionUUID->"58ed029d-d676-4604-bab0-09958bbe383a"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox["x", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], "0", 
      FractionBox["x", "2"], "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 0, 1, 1, 3, 3, 4}, {{1}, {3}, {5}, {1}}}, {
      Rational[1, 2] $CellContext`x, 
       Rational[1, 2] $CellContext`x $CellContext`z, 
       Rational[1, 2] $CellContext`x, 
       Rational[1, 2] $CellContext`x $CellContext`z}}]]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1600323153,ExpressionUUID->"e7e0d523-0555-4b82-9615-905857abcf78"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`a[1]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`a[3], 
       $CellContext`a[1]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1546037443,ExpressionUUID->"bda2e46b-c6f8-4542-8911-8b11d0d6cd7a"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[2]=",
 CellID->1846659448,ExpressionUUID->"b85fc118-2187-4990-b0d5-fec2b6fbe963"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"a", "[", "2", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"Dagger", "[", 
        RowBox[{"a", "[", "1", "]"}], "]"}], "**", 
       RowBox[{"a", "[", "3", "]"}]}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[3]:=",
 CellID->950609431,ExpressionUUID->"0d41b6ea-a3f9-40bd-892f-feddf860f5dd"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"a", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`a[1]]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`a[1]], 
       $CellContext`a[3]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1185499796,ExpressionUUID->"04362a46-9a0a-4307-a717-cf32058b1dca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`a[1]]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`a[3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`a[1]], 
     $CellContext`a[3]]]}], "+", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"a", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`a[2]]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`a[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`a[2]], 
     $CellContext`a[1]]]}]}]], "Print",
 CellLabel->"During evaluation of In[379]:=",
 CellID->341794506,ExpressionUUID->"9a7c8f95-81d5-4fdc-a3fc-54ed0b36f58b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`a[1]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`a[2]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`a[3]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[379]:=",
 CellID->21506617,ExpressionUUID->"96cc469e-4649-4a76-9541-ac2a532c7a8c"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{"x", " ", "z"}]},
     {"x", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0, {
     1, {{0, 1, 2, 2}, {{3}, {
       1}}}, {$CellContext`x $CellContext`z, $CellContext`x}}]]]]], "Output",
 CellLabel->"Out[3]//MatrixForm=",
 CellID->684459223,ExpressionUUID->"3b109180-98b3-4c2b-ab7c-003a33ef0784"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"a", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`a[1]]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`a[1]], 
       $CellContext`a[3]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1783747629,ExpressionUUID->"4c97d04a-bbfc-4f19-a7d3-8990cb0ee15e"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[3]=",
 CellID->574688483,ExpressionUUID->"21277026-a609-4b21-bf29-a7d0afbb57fc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c", ",", "d"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[4]:=",
 CellID->1462286656,ExpressionUUID->"2577c066-b53b-492b-a400-c86c8689075a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", "Up", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"c", "[", "Down", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"c", "[", "Up", "]"}], "**", 
       RowBox[{"d", "[", "Up", "]"}]}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[5]:=",
 CellID->1828079879,ExpressionUUID->"5822e693-2cfe-4175-ab82-833d7ff619cc"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["d", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`d[Plus[1]/2]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`d[
        Rational[1, 2]], 
       $CellContext`c[
        Rational[1, 2]]]]}], "-", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`c[(-1)/2]]], 
         InterpretationBox[
          SubscriptBox["c", 
           
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
            "RowWithSeparators"]], 
          $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`c[
        Rational[-1, 2]]], 
      $CellContext`c[
       Rational[1, 2]]]]}], ")"}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->2099369269,ExpressionUUID->"1fda13c6-e633-4bc2-85d8-48d0b8009e62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "x"}], " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["d", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`d[Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`d[
      Rational[1, 2]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           
           TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
            "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[(-1)/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[-1, 2]]], 
     $CellContext`c[
      Rational[1, 2]]]]}]}]], "Print",
 CellLabel->"During evaluation of In[387]:=",
 CellID->942983873,ExpressionUUID->"f0a272b4-7f0a-40cd-b523-3911cf842aa6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[(-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[Plus[1]/2]], ",", 
   InterpretationBox[
    SubscriptBox["d", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`d[Plus[1]/2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[(-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"d", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`d[1/2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[387]:=",
 CellID->300638651,ExpressionUUID->"fe5c2cac-63d4-4752-9766-4095e072327d"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", 
       FractionBox["x", "2"]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], 
      FractionBox["x", "2"], "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"x", " ", "z"}], "2"]}], "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 1, 1, 1, 1, 3, 4}, {{2}, {3}, {4}, {2}}}, {
      Rational[-1, 2] $CellContext`x, 
       Rational[1, 2] $CellContext`x $CellContext`z, 
       Rational[1, 2] $CellContext`x, 
       Rational[-1, 2] $CellContext`x $CellContext`z}}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1952269613,ExpressionUUID->"9fcb7666-2118-4142-82b3-ee7a950f8626"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "x"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["d", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`d[Plus[1]/2]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`d[
        Rational[1, 2]], 
       $CellContext`c[
        Rational[1, 2]]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`c[(-1)/2]]], 
         InterpretationBox[
          SubscriptBox["c", 
           
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
            "RowWithSeparators"]], 
          $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`c[
        Rational[-1, 2]]], 
      $CellContext`c[
       Rational[1, 2]]]]}], ")"}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->392743178,ExpressionUUID->"b7b29984-93c2-4a77-be3e-e21a0f772d6e"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[5]=",
 CellID->1617345415,ExpressionUUID->"782d6a18-a090-44e1-9c5e-7c6fd5e838a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", "Up", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"c", "[", "Down", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"c", "[", "Up", "]"}], "**", 
       RowBox[{"d", "[", "Up", "]"}]}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"expr", "+", 
   RowBox[{"Dagger", "[", "expr", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[6]:=",
 CellID->680707724,ExpressionUUID->"1c986325-278e-49ce-9827-04fae00b2669"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["d", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`d[Plus[1]/2]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`d[
        Rational[1, 2]], 
       $CellContext`c[
        Rational[1, 2]]]]}], "-", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`c[(-1)/2]]], 
         InterpretationBox[
          SubscriptBox["c", 
           
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
            "RowWithSeparators"]], 
          $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`c[
        Rational[-1, 2]]], 
      $CellContext`c[
       Rational[1, 2]]]]}], ")"}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1483456694,ExpressionUUID->"f5f50686-f0d7-4270-8788-8bf3d55b34f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "z"}], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            SubscriptBox["d", 
             
             TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
              "RowWithSeparators"]], 
            $CellContext`d[Plus[1]/2]], 
           InterpretationBox[
            SubscriptBox["c", 
             
             TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
              "RowWithSeparators"]], 
            $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`d[
         Rational[1, 2]], 
        $CellContext`c[
         Rational[1, 2]]]]}], "-", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"c", 
             
             TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
              "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`c[(-1)/2]]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`c[
         Rational[-1, 2]]], 
       $CellContext`c[
        Rational[1, 2]]]]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`c[1/2]]], 
           InterpretationBox[
            SubscriptBox["c", 
             
             TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
              "RowWithSeparators"]], 
            $CellContext`c[(-1)/2]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        Q3`Dagger[
         $CellContext`c[
          Rational[1, 2]]], 
        $CellContext`c[
         Rational[-1, 2]]]]}], "-", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{"z", 
         TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
           StyleBox[
           "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
          "RowWithSeparators"]},
        "Superscript"],
       Conjugate[Q3`Private`z]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`c[1/2]]], 
           InterpretationBox[
            TemplateBox[{"d", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`d[1/2]]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        Q3`Dagger[
         $CellContext`c[
          Rational[1, 2]]], 
        Q3`Dagger[
         $CellContext`d[
          Rational[1, 2]]]]]}]}], ")"}]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->171514388,ExpressionUUID->"3af3eae4-b6d1-47df-b601-8cee213095c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "x"}], " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["d", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`d[Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`d[
      Rational[1, 2]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           
           TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
            "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[(-1)/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[-1, 2]]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[1/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[(-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[1, 2]]], 
     $CellContext`c[
      Rational[-1, 2]]]]}], "-", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   InterpretationBox[
    TemplateBox[{"z", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[1/2]]], 
        InterpretationBox[
         TemplateBox[{"d", 
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`d[1/2]]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[1, 2]]], 
     Q3`Dagger[
      $CellContext`d[
       Rational[1, 2]]]]]}]}]], "Print",
 CellLabel->"During evaluation of In[394]:=",
 CellID->719264842,ExpressionUUID->"ecf02400-d75c-45fc-ae07-01dc17c16973"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[(-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[Plus[1]/2]], ",", 
   InterpretationBox[
    SubscriptBox["d", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`d[Plus[1]/2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[(-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"d", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`d[1/2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[394]:=",
 CellID->498750531,ExpressionUUID->"8a1e0495-6b5b-469b-aad4-908a893188e3"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", 
       FractionBox["x", "2"]}], "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        InterpretationBox[
         TemplateBox[{"x", 
           TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
             StyleBox[
             "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]},
             "RowWithSeparators"]},
          "Superscript"],
         Conjugate[Q3`Private`z]], "2"]}], "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       InterpretationBox[
        TemplateBox[{"x", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]], " ", 
       InterpretationBox[
        TemplateBox[{"z", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]]}]},
     {"0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       InterpretationBox[
        TemplateBox[{"x", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]], " ", 
       InterpretationBox[
        TemplateBox[{"z", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]]}], "0"},
     {"0", "0", "0", "0", 
      FractionBox[
       InterpretationBox[
        TemplateBox[{"x", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]], "2"], "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], 
      FractionBox["x", "2"], "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"x", " ", "z"}], "2"]}], "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 1, 3, 4, 5, 7, 8}, {{2}, {1}, {6}, {5}, {5}, {3}, {4}, {2}}}, {
      Rational[-1, 2] $CellContext`x, Rational[-1, 2] 
       Conjugate[$CellContext`x], Rational[-1, 2] Conjugate[$CellContext`x] 
       Conjugate[$CellContext`z], Rational[1, 2] Conjugate[$CellContext`x] 
       Conjugate[$CellContext`z], Rational[1, 2] Conjugate[$CellContext`x], 
       Rational[1, 2] $CellContext`x $CellContext`z, 
       Rational[1, 2] $CellContext`x, 
       Rational[-1, 2] $CellContext`x $CellContext`z}}]]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->871500276,ExpressionUUID->"408df7aa-ab69-44dd-a4c7-48095cce43a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "x"}], " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["d", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`d[Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`d[
      Rational[1, 2]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           
           TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
            "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[(-1)/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[-1, 2]]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   RowBox[{"(", 
    RowBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"c", 
             
             TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
              "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`c[1/2]]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[(-1)/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`c[
         Rational[1, 2]]], 
       $CellContext`c[
        Rational[-1, 2]]]], "+", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{"z", 
         TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
           StyleBox[
           "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
          "RowWithSeparators"]},
        "Superscript"],
       Conjugate[Q3`Private`z]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`c[1/2]]], 
           InterpretationBox[
            TemplateBox[{"d", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`d[1/2]]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        Q3`Dagger[
         $CellContext`c[
          Rational[1, 2]]], 
        Q3`Dagger[
         $CellContext`d[
          Rational[1, 2]]]]]}]}], ")"}]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1466666192,ExpressionUUID->"f714c6f5-d6ec-4f76-be2e-c65018dcca6e"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->1441388678,ExpressionUUID->"9bd52b9b-eb6a-46b4-ba02-ecd9945cbdc4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "00409e62-dd82-4086-a0d1-b8c4d9604eef"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->2034447609,ExpressionUUID->"bad15282-6139-4f34-b396-fedd2a21a1bf"],

Cell["\<\
Here is another important example including anomalous bilinear form.\
\>", "ExampleText",
 CellID->2085944042,ExpressionUUID->"59ce6b42-1750-43bb-8139-1513f05153be"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"h0", "=", 
  RowBox[{"PlusDagger", "[", 
   RowBox[{"FockHopping", "@@", 
    RowBox[{"c", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"h1", "=", 
  RowBox[{"MultiplyDot", "[", 
   RowBox[{
    RowBox[{"Dagger", "@", 
     RowBox[{"FockIsospinor", "[", 
      RowBox[{"c", "[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"ThePauli", "[", "1", "]"}], ",", 
    RowBox[{"FockIsospinor", "[", 
     RowBox[{"c", "[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"hh", "=", 
  RowBox[{"h0", "+", "h1"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[1]:=",
 CellID->790976619,ExpressionUUID->"24eafcb7-9079-41e5-8c04-392687dc16b3"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`c[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1]], 
    $CellContext`c[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`c[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[2]], 
    $CellContext`c[1]]]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1496184049,ExpressionUUID->"6017d1f9-eba4-46fa-bcbe-e2f3695c6871"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[2, Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[1, (-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`c[2, 
      Rational[1, 2]], 
     $CellContext`c[1, 
      Rational[-1, 2]]]]}], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1, 1/2]]], 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2, (-1)/2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1, 
      Rational[1, 2]]], 
    Q3`Dagger[
     $CellContext`c[2, 
      Rational[-1, 2]]]]]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1479288820,ExpressionUUID->"bcae47f2-5782-4010-85d4-c5323ee9799d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[2, Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[1, (-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`c[2, 
      Rational[1, 2]], 
     $CellContext`c[1, 
      Rational[-1, 2]]]]}], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`c[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1]], 
    $CellContext`c[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`c[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[2]], 
    $CellContext`c[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1, 1/2]]], 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2, (-1)/2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1, 
      Rational[1, 2]]], 
    Q3`Dagger[
     $CellContext`c[2, 
      Rational[-1, 2]]]]]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->989016421,ExpressionUUID->"57918701-9557-457f-ad32-bde853fe847c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FockBilinearQ", "[", "hh", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FockBilinearQ", "[", 
  RowBox[{"hh", ",", "True"}], "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[2]:=",
 CellID->1401692392,ExpressionUUID->"95ebfb7d-361b-4ebb-8b14-38301d355f79"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[2]=",
 CellID->797663268,ExpressionUUID->"7bbfb170-7f7d-4fe9-b83a-f75a5239990d"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[2]=",
 CellID->1733620702,ExpressionUUID->"4879ebdf-8b3c-4879-bed7-7f2cf9243986"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "hh", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ops", "//", "Print"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[3]:=",
 CellID->1021100159,ExpressionUUID->"680e5f06-2c2b-4603-a929-eb678f0f52c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[1, (-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[1, Plus[1]/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[2, (-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[2, Plus[1]/2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
       "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1, (-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1, 1/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
       "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[2, (-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[2, 1/2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[407]:=",
 CellID->268618996,ExpressionUUID->"2dd8c32e-78ad-4edf-b0ed-e5a1f4f8a80c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {12, 12}, 0, {
     1, {{0, 1, 2, 2, 3, 4, 4, 5, 6, 7, 7, 7, 8}, {{2}, {1}, {11}, {10}, {
       8}, {7}, {6}, {3}}}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], 
       Rational[-1, 2], Rational[-1, 2], Rational[1, 2], 
       Rational[-1, 2]}}]]]]], "Output",
 CellLabel->"Out[3]//MatrixForm=",
 CellID->668839778,ExpressionUUID->"61dd02b0-442f-4470-9584-b75061caa022"]
}, Open  ]],

Cell["\<\
Let us check if the found operators and the matrix are correct\
\>", "ExampleText",
 CellID->1362781649,ExpressionUUID->"41552cbc-6c1e-4dd0-83ec-13cd18b0e2b7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"res", "=", 
  RowBox[{"MultiplyDot", "[", 
   RowBox[{
    RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"res", "-", "hh"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[4]:=",
 CellID->1358079488,ExpressionUUID->"df9d33fa-d5a2-4b2b-910b-f59d14a805dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[2, Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[1, (-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`c[2, 
      Rational[1, 2]], 
     $CellContext`c[1, 
      Rational[-1, 2]]]]}], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`c[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1]], 
    $CellContext`c[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`c[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[2]], 
    $CellContext`c[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1, 1/2]]], 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2, (-1)/2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1, 
      Rational[1, 2]]], 
    Q3`Dagger[
     $CellContext`c[2, 
      Rational[-1, 2]]]]]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->592614415,ExpressionUUID->"f90f9683-55a8-410f-a204-8156d0b96c81"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[4]=",
 CellID->41318119,ExpressionUUID->"a448b9e0-56f9-465c-8168-f319c90740cf"]
}, Open  ]],

Cell["A similar example with bosons.", "ExampleText",
 CellID->207674041,ExpressionUUID->"c62ba83e-3b4d-4d46-bd6b-b4d3c8508a49"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"h0", "=", 
  RowBox[{"PlusDagger", "@", 
   RowBox[{"FockHopping", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "**", 
    RowBox[{"a", "[", "2", "]"}]}], "+", 
   RowBox[{"Dagger", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "**", 
     RowBox[{"a", "[", "2", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"hh", "=", 
  RowBox[{"h0", "+", "h1"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[5]:=",
 CellID->716680712,ExpressionUUID->"e1078c36-848d-45c8-8eee-97f8d8f7932f"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    $CellContext`a[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[2]], 
    $CellContext`a[1]]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1573309734,ExpressionUUID->"182ace29-3199-44fe-bc21-8047eb983ab7"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`a[2], 
    $CellContext`a[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    Q3`Dagger[
     $CellContext`a[2]]]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->650553827,ExpressionUUID->"01ea8cdc-c34c-4288-8bc8-c898dcf14014"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`a[2], 
    $CellContext`a[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    $CellContext`a[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    Q3`Dagger[
     $CellContext`a[2]]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[2]], 
    $CellContext`a[1]]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1018923512,ExpressionUUID->"146e2117-320c-4f59-b5d1-24cdadb40ebf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FockBilinearQ", "[", "hh", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FockBilinearQ", "[", 
  RowBox[{"hh", ",", "True"}], "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[6]:=",
 CellID->227185655,ExpressionUUID->"e38ece31-d3db-4c47-afda-b17a3bc7c3dd"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[6]=",
 CellID->1336905752,ExpressionUUID->"b5873112-a230-46a8-aa1f-94e3f7508ae0"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[6]=",
 CellID->253575303,ExpressionUUID->"18f96071-30c5-4860-834d-6d9c8d3a5bf9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "hh", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ops", "//", "Print"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[7]:=",
 CellID->95272385,ExpressionUUID->"896c90c3-87b9-446f-b702-da9683409cda"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`a[1]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`a[2]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[417]:=",
 CellID->1407168179,ExpressionUUID->"89098d42-090c-4d4f-b1c3-3e2341d04a7d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"]},
     {
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"]},
     {
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{2}, {4}, {1}, {3}, {2}, {4}, {1}, {3}}}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[1, 2], 
       Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[
       1, 2]}}]]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->38180042,ExpressionUUID->"6fa85cd6-d6d0-48aa-94e8-b2f4cb9e2ad9"]
}, Open  ]],

Cell["\<\
Let us check if the found operators and the matrix are correct\
\>", "ExampleText",
 CellID->352647418,ExpressionUUID->"f5d88f2f-7b91-4156-8b52-d10c83ab1ec3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"res", "=", 
  RowBox[{"MultiplyDot", "[", 
   RowBox[{
    RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"res", "-", "hh"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3S`"],
 CellLabel->"In[8]:=",
 CellID->2037772253,ExpressionUUID->"21d65c3c-3a8a-46bb-9fc3-a284da2ca4ec"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`a[2], 
    $CellContext`a[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    $CellContext`a[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    Q3`Dagger[
     $CellContext`a[2]]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[2]], 
    $CellContext`a[1]]]}]], "Output",
 CellLabel->"Out[8]=",
 CellID->655607211,ExpressionUUID->"f3522642-9e1f-4d0f-98f7-ea4a124579f5"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[8]=",
 CellID->51802520,ExpressionUUID->"32f1316d-8772-437a-b5cd-41cfed0b26d3"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearQ"]], 
           "paclet:QuantumMob/Q3S/ref/FockBilinearQ", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "43d736cc-0934-49a0-82a5-80ce41d60986"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearOperators"]], 
           "paclet:QuantumMob/Q3S/ref/FockBilinearOperators", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "ccf3922c-b656-4ddb-844d-b8f6419830c6"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearMatrix"]], 
           "paclet:QuantumMob/Q3S/ref/FockBilinearMatrix", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "21dd4555-0185-4bf4-aabc-8cbe23ce119f"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearSystem"]], 
           "paclet:QuantumMob/Q3S/ref/FockBilinearSystem", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "d764d186-d023-402e-8cc6-5ae440483a86"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CoefficientTensor"]], 
           "paclet:QuantumMob/Q3S/ref/CoefficientTensor", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "f2e34e78-4ec4-4629-b97c-5f51e731b8f1"]
       }], "SeeAlso",ExpressionUUID->"30c7e678-07d6-40d9-9545-9446a8aae6d0"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"0bc53ea2-a34f-4e44-bc71-\
488510958753"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TutorialsSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3S/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "13abd5d2-3769-4e26-b4b5-35c5bed71ebf"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], 
           "paclet:QuantumMob/Q3S/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "20f52d1a-5b51-48c3-b969-09952ee01e2f"]}]}
     }]}
  }]], "TutorialsSection",ExpressionUUID->"573c5176-f4d0-48bc-802f-\
b42b3ab86440"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3S/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "89c89f68-216a-461c-b381-94b0aa05c7d6"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3S/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "ba585ff9-d97f-42fa-b2db-d3b1b6693d10"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"4cd7afcc-a047-4752-80f1-\
f045986e30af"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "d9620b08-8fc2-476f-ac84-ee5be4f9da9a"]}]],ExpressionUUID->
         "7f8b82b6-6d74-43d9-8c8e-ed8f7110fdee"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "37c65b23-8ac2-4462-b98a-9b24d10fd555"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"7d02171b-7539-4bc7-9a4e-\
7df1a157e1b9"],

Cell[" ", "FooterCell",ExpressionUUID->"76ebb4e1-d068-4f6e-a91b-a4bc122301e5"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"FockBilinearSystem",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}, 
    "AllOptsTable" -> Closed}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 3, 3, 18, 27, 43.302857}", 
    "history" -> {"12", "", "", ""}, "context" -> "QuantumMob`Q3S`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3S Symbol", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3S", "status" -> "None", "summary" -> 
    "FockBilinearSystem[expr] returns a list of {operators, matrix} of the \
bilinear combination.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "FockBilinearSystem", "titlemodifier" -> "", "metadescription" -> "", 
    "windowtitle" -> "FockBilinearSystem", "type" -> "Symbol", "uri" -> 
    "QuantumMob/Q3S/ref/FockBilinearSystem"}},
CellContext->"Global`",
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.2 for Mac OS X ARM (64-bit) (December 26, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"e356b558-f087-4ea4-8848-80a51f83cdb3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[8804, 230, 1438, 38, 34, "PrimaryExamplesSection",ExpressionUUID->"40f796e8-ad4f-472c-b994-ccb61855df9b",
   CellTags->"PrimaryExamplesSection",
   CellID->1961773882]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 99708, 2889}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[586, 21, 7005, 172, 50, "AnchorBarGrid",ExpressionUUID->"c133e1f4-5d59-4a1f-bb41-4dee2c75da6c",
 CellID->1],
Cell[7594, 195, 97, 0, 22, "ContextNameCell",ExpressionUUID->"adb3c5dc-e6f6-4cd0-a010-b415d1d2f329"],
Cell[CellGroupData[{
Cell[7716, 199, 561, 14, 57, "ObjectNameGrid",ExpressionUUID->"f1bfdc41-a4a8-4afd-90ad-552ebcfdec68"],
Cell[8280, 215, 487, 10, 106, "Usage",ExpressionUUID->"d894b4bd-5431-44b9-9787-7c1e864af0f9",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[8804, 230, 1438, 38, 34, "PrimaryExamplesSection",ExpressionUUID->"40f796e8-ad4f-472c-b994-ccb61855df9b",
 CellTags->"PrimaryExamplesSection",
 CellID->1961773882],
Cell[10245, 270, 205, 4, 29, "Input",ExpressionUUID->"3d930caf-cbae-4e7f-a2e9-36c378fa3941",
 CellID->742081683],
Cell[CellGroupData[{
Cell[10475, 278, 1416, 37, 29, "ExampleSection",ExpressionUUID->"c982d34f-7554-42a6-b8de-42012a3d9cac",
 CellID->1217202383],
Cell[11894, 317, 219, 5, 28, "Input",ExpressionUUID->"1d884ec3-ca88-47bc-b168-30e3cbda0568",
 CellID->54356201],
Cell[CellGroupData[{
Cell[12138, 326, 1215, 34, 134, "Input",ExpressionUUID->"ead50cac-9338-40e8-ad62-7e02875d321d",
 CellID->301411736],
Cell[13356, 362, 1510, 42, 37, "Output",ExpressionUUID->"6d38535b-bb29-402a-b8c3-6d56e0b72f48",
 CellID->2048158089],
Cell[CellGroupData[{
Cell[14891, 408, 1440, 39, 23, "Print",ExpressionUUID->"262af68c-6100-4eb5-8527-977f283b1cc2",
 CellID->1377624060],
Cell[16334, 449, 1356, 40, 24, "Print",ExpressionUUID->"58ed029d-d676-4604-bab0-09958bbe383a",
 CellID->1706378113]
}, Open  ]],
Cell[17705, 492, 1214, 34, 143, "Output",ExpressionUUID->"e7e0d523-0555-4b82-9615-905857abcf78",
 CellID->1600323153],
Cell[18922, 528, 1510, 42, 37, "Output",ExpressionUUID->"bda2e46b-c6f8-4542-8911-8b11d0d6cd7a",
 CellID->1546037443],
Cell[20435, 572, 127, 2, 36, "Output",ExpressionUUID->"b85fc118-2187-4990-b0d5-fec2b6fbe963",
 CellID->1846659448]
}, Open  ]],
Cell[CellGroupData[{
Cell[20599, 579, 1254, 35, 134, "Input",ExpressionUUID->"0d41b6ea-a3f9-40bd-892f-feddf860f5dd",
 CellID->950609431],
Cell[21856, 616, 1730, 48, 37, "Output",ExpressionUUID->"04362a46-9a0a-4307-a717-cf32058b1dca",
 CellID->1185499796],
Cell[CellGroupData[{
Cell[23611, 668, 1622, 43, 70, "Print",ExpressionUUID->"9a7c8f95-81d5-4fdc-a3fc-54ed0b36f58b",
 CellID->341794506],
Cell[25236, 713, 598, 19, 70, "Print",ExpressionUUID->"96cc469e-4649-4a76-9541-ac2a532c7a8c",
 CellID->21506617]
}, Open  ]],
Cell[25849, 735, 779, 23, 75, "Output",ExpressionUUID->"3b109180-98b3-4c2b-ab7c-003a33ef0784",
 CellID->684459223],
Cell[26631, 760, 1730, 48, 37, "Output",ExpressionUUID->"4c97d04a-bbfc-4f19-a7d3-8990cb0ee15e",
 CellID->1783747629],
Cell[28364, 810, 126, 2, 36, "Output",ExpressionUUID->"21277026-a609-4b21-bf29-a7d0afbb57fc",
 CellID->574688483]
}, Open  ]],
Cell[28505, 815, 233, 5, 70, "Input",ExpressionUUID->"2577c066-b53b-492b-a400-c86c8689075a",
 CellID->1462286656],
Cell[CellGroupData[{
Cell[28763, 824, 1227, 35, 70, "Input",ExpressionUUID->"5822e693-2cfe-4175-ab82-833d7ff619cc",
 CellID->1828079879],
Cell[29993, 861, 1808, 55, 37, "Output",ExpressionUUID->"1fda13c6-e633-4bc2-85d8-48d0b8009e62",
 CellID->2099369269],
Cell[CellGroupData[{
Cell[31826, 920, 1648, 46, 70, "Print",ExpressionUUID->"f0a272b4-7f0a-40cd-b523-3911cf842aa6",
 CellID->942983873],
Cell[33477, 968, 1467, 40, 70, "Print",ExpressionUUID->"fe5c2cac-63d4-4752-9766-4095e072327d",
 CellID->300638651]
}, Open  ]],
Cell[34959, 1011, 1263, 36, 143, "Output",ExpressionUUID->"9fcb7666-2118-4142-82b3-ee7a950f8626",
 CellID->1952269613],
Cell[36225, 1049, 1804, 55, 37, "Output",ExpressionUUID->"b7b29984-93c2-4a77-be3e-e21a0f772d6e",
 CellID->392743178],
Cell[38032, 1106, 127, 2, 36, "Output",ExpressionUUID->"782d6a18-a090-44e1-9c5e-7c6fd5e838a3",
 CellID->1617345415]
}, Open  ]],
Cell[CellGroupData[{
Cell[38196, 1113, 1342, 38, 70, "Input",ExpressionUUID->"1c986325-278e-49ce-9827-04fae00b2669",
 CellID->680707724],
Cell[39541, 1153, 1808, 55, 37, "Output",ExpressionUUID->"f5f50686-f0d7-4270-8788-8bf3d55b34f0",
 CellID->1483456694],
Cell[41352, 1210, 4648, 137, 37, "Output",ExpressionUUID->"3af3eae4-b6d1-47df-b601-8cee213095c2",
 CellID->171514388],
Cell[CellGroupData[{
Cell[46025, 1351, 4288, 120, 70, "Print",ExpressionUUID->"ecf02400-d75c-45fc-ae07-01dc17c16973",
 CellID->719264842],
Cell[50316, 1473, 1467, 40, 70, "Print",ExpressionUUID->"8a1e0495-6b5b-469b-aad4-908a893188e3",
 CellID->498750531]
}, Open  ]],
Cell[51798, 1516, 3577, 95, 171, "Output",ExpressionUUID->"408df7aa-ab69-44dd-a4c7-48095cce43a6",
 CellID->871500276],
Cell[55378, 1613, 4355, 126, 37, "Output",ExpressionUUID->"f714c6f5-d6ec-4f76-be2e-c65018dcca6e",
 CellID->1466666192],
Cell[59736, 1741, 127, 2, 36, "Output",ExpressionUUID->"9bd52b9b-eb6a-46b4-ba02-ecd9945cbdc4",
 CellID->1441388678]
}, Open  ]],
Cell[CellGroupData[{
Cell[59900, 1748, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"bad15282-6139-4f34-b396-fedd2a21a1bf",
 CellID->2034447609],
Cell[60146, 1755, 175, 3, 70, "ExampleText",ExpressionUUID->"59ce6b42-1750-43bb-8139-1513f05153be",
 CellID->2085944042],
Cell[CellGroupData[{
Cell[60346, 1762, 758, 20, 70, "Input",ExpressionUUID->"24eafcb7-9079-41e5-8c04-392687dc16b3",
 CellID->790976619],
Cell[61107, 1784, 1507, 41, 36, "Output",ExpressionUUID->"6017d1f9-eba4-46fa-bcbe-e2f3695c6871",
 CellID->1496184049],
Cell[62617, 1827, 1834, 54, 38, "Output",ExpressionUUID->"bcae47f2-5782-4010-85d4-c5323ee9799d",
 CellID->1479288820],
Cell[64454, 1883, 3211, 92, 38, "Output",ExpressionUUID->"57918701-9557-457f-ad32-bde853fe847c",
 CellID->989016421]
}, Open  ]],
Cell[CellGroupData[{
Cell[67702, 1980, 301, 6, 70, "Input",ExpressionUUID->"95ebfb7d-361b-4ebb-8b14-38301d355f79",
 CellID->1401692392],
Cell[68006, 1988, 129, 2, 36, "Output",ExpressionUUID->"7bbfb170-7f7d-4fe9-b83a-f75a5239990d",
 CellID->797663268],
Cell[68138, 1992, 130, 2, 36, "Output",ExpressionUUID->"4879ebdf-8b3c-4879-bed7-7f2cf9243986",
 CellID->1733620702]
}, Open  ]],
Cell[CellGroupData[{
Cell[68305, 1999, 426, 10, 70, "Input",ExpressionUUID->"680e5f06-2c2b-4603-a929-eb678f0f52c8",
 CellID->1021100159],
Cell[68734, 2011, 2769, 78, 70, "Print",ExpressionUUID->"2dd8c32e-78ad-4edf-b0ed-e5a1f4f8a80c",
 CellID->268618996],
Cell[71506, 2091, 1958, 47, 283, "Output",ExpressionUUID->"61dd02b0-442f-4470-9584-b75061caa022",
 CellID->668839778]
}, Open  ]],
Cell[73479, 2141, 169, 3, 70, "ExampleText",ExpressionUUID->"41552cbc-6c1e-4dd0-83ec-13cd18b0e2b7",
 CellID->1362781649],
Cell[CellGroupData[{
Cell[73673, 2148, 357, 8, 70, "Input",ExpressionUUID->"df9d33fa-d5a2-4b2b-910b-f59d14a805dd",
 CellID->1358079488],
Cell[74033, 2158, 3211, 92, 38, "Output",ExpressionUUID->"f90f9683-55a8-410f-a204-8156d0b96c81",
 CellID->592614415],
Cell[77247, 2252, 125, 2, 36, "Output",ExpressionUUID->"a448b9e0-56f9-465c-8168-f319c90740cf",
 CellID->41318119]
}, Open  ]],
Cell[77387, 2257, 128, 1, 70, "ExampleText",ExpressionUUID->"c62ba83e-3b4d-4d46-bd6b-b4d3c8508a49",
 CellID->207674041],
Cell[CellGroupData[{
Cell[77540, 2262, 704, 20, 70, "Input",ExpressionUUID->"e1078c36-848d-45c8-8eee-97f8d8f7932f",
 CellID->716680712],
Cell[78247, 2284, 1507, 41, 36, "Output",ExpressionUUID->"182ace29-3199-44fe-bc21-8047eb983ab7",
 CellID->1573309734],
Cell[79757, 2327, 1506, 41, 36, "Output",ExpressionUUID->"01ea8cdc-c34c-4288-8bc8-c898dcf14014",
 CellID->650553827],
Cell[81266, 2370, 2885, 79, 36, "Output",ExpressionUUID->"146e2117-320c-4f59-b5d1-24cdadb40ebf",
 CellID->1018923512]
}, Open  ]],
Cell[CellGroupData[{
Cell[84188, 2454, 300, 6, 70, "Input",ExpressionUUID->"e38ece31-d3db-4c47-afda-b17a3bc7c3dd",
 CellID->227185655],
Cell[84491, 2462, 130, 2, 36, "Output",ExpressionUUID->"b5873112-a230-46a8-aa1f-94e3f7508ae0",
 CellID->1336905752],
Cell[84624, 2466, 129, 2, 36, "Output",ExpressionUUID->"18f96071-30c5-4860-834d-6d9c8d3a5bf9",
 CellID->253575303]
}, Open  ]],
Cell[CellGroupData[{
Cell[84790, 2473, 424, 10, 70, "Input",ExpressionUUID->"896c90c3-87b9-446f-b702-da9683409cda",
 CellID->95272385],
Cell[85217, 2485, 962, 28, 70, "Print",ExpressionUUID->"89098d42-090c-4d4f-b1c3-3e2341d04a7d",
 CellID->1407168179],
Cell[86182, 2515, 1122, 33, 123, "Output",ExpressionUUID->"6fa85cd6-d6d0-48aa-94e8-b2f4cb9e2ad9",
 CellID->38180042]
}, Open  ]],
Cell[87319, 2551, 168, 3, 70, "ExampleText",ExpressionUUID->"f5d88f2f-7b91-4156-8b52-d10c83ab1ec3",
 CellID->352647418],
Cell[CellGroupData[{
Cell[87512, 2558, 357, 8, 70, "Input",ExpressionUUID->"21d65c3c-3a8a-46bb-9fc3-a284da2ca4ec",
 CellID->2037772253],
Cell[87872, 2568, 2884, 79, 36, "Output",ExpressionUUID->"f3522642-9e1f-4d0f-98f7-ea4a124579f5",
 CellID->655607211],
Cell[90759, 2649, 125, 2, 36, "Output",ExpressionUUID->"32f1316d-8772-437a-b5cd-41cfed0b26d3",
 CellID->51802520]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[91138, 2661, 3100, 83, 70, "SeeAlsoSection",ExpressionUUID->"0bc53ea2-a34f-4e44-bc71-488510958753"],
Cell[94241, 2746, 1136, 29, 70, "TutorialsSection",ExpressionUUID->"573c5176-f4d0-48bc-802f-b42b3ab86440"],
Cell[95380, 2777, 1121, 28, 70, "MoreAboutSection",ExpressionUUID->"4cd7afcc-a047-4752-80f1-f045986e30af"],
Cell[96504, 2807, 1166, 34, 70, "RelatedLinksSection",ExpressionUUID->"7d02171b-7539-4bc7-9a4e-7df1a157e1b9"],
Cell[97673, 2843, 78, 0, 70, "FooterCell",ExpressionUUID->"76ebb4e1-d068-4f6e-a91b-a4bc122301e5"]
}
]
*)

(* End of internal cache information *)

