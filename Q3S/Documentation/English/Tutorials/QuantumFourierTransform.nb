(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    298227,       7880]
NotebookOptionsPosition[    272748,       7390]
NotebookOutlinePosition[    275751,       7455]
CellTagsIndexPosition[    275708,       7452]
WindowTitle->Quantum Fourier Transform
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3S TUTORIAL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "7b353275-74e1-4775-a1fa-fe60bea9c68c"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "179d0c02-b570-41ec-96ee-0bf075a40bd3"],
        Background->RGBColor[
         0.7450980392156863, 0.3254901960784314, 0.1411764705882353],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "04170399-7905-445d-a455-162803bd9423"]
         }],ExpressionUUID->"d7b29b18-ba91-43e0-8675-0a8a783671ac"],
         StripOnInput->False],{
        StyleBox[
          "\"ControlledGate\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/ControlledGate"],
          StyleBox[
          "\"ControlledPower\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/ref/ControlledPower"], 
         StyleBox["\"QFT\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/QFT"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "f4e290c4-7040-45e4-9941-9b02aec56a78"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "764d8136-b8c4-4ba4-ad26-b4fac340ebc4"]
         }],ExpressionUUID->"3d17512d-3ab9-4a5a-a05b-b4162ddf4841"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/guide/QuantumInformationSystems"], "\"Q3\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "ee70c3ed-0e87-47c8-a4f8-788beb53a07b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "5050f98d-95de-43ac-8e2a-8ae7cec0209e"]
         }],ExpressionUUID->"d787f68a-c598-4644-a734-6e708ec10274"],
         StripOnInput->False],{
        "\"Quantum Fourier Transform: Semiclassical Implementation\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/\
QuantumFourierTransformSemiclassical"], "\"Quantum Phase Estimation\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumPhaseEstimation"], 
         "\"Quantum Algorithms\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumAlgorithms"], 
         "\"QuantumCircuit Usage Examples\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumCircuitUsage"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationSystems"], 
         "\"Quick Quantum Computing with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuickQuantumComputingWithQ3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "6dbc0df9-99f8-4b39-8154-675a95536867"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "23cd7d0e-deea-40e0-9f7b-c536cb0eae87"]
         }],ExpressionUUID->"2361dfd7-89a9-4b8b-a0d6-d58a5c3953aa"],
         StripOnInput->False],{
        "\"QuantumMob/Q3S/tutorial/QuantumFourierTransform\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3S/tutorial/QuantumFourierTransform"], 
         Delimiter, "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3S/\
tutorial/QuantumFourierTransform.html"], StandardForm]], "Input", 
                 TextClipboardType -> "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "QuantumMob/Q3S/tutorial/QuantumFourierTransform" <> ".html"], 
              None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "1a0a1dda-8014-4b0f-943a-46a06409aeec"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "09106193-7d2b-4da4-97c7-e2164b427f2f"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"9db5a958-563f-4fd8-86f0-f7fd85df4a2b"],

Cell[CellGroupData[{

Cell["Quantum Fourier Transform", "Title",
 CellID->509267359,ExpressionUUID->"632da24f-94f3-42ed-8779-09e47ef71a5d"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Definition"], 
      "paclet:QuantumMob/Q3S/tutorial/QuantumFourierTransform#1875748448", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Quantum Implementation"], 
      "paclet:QuantumMob/Q3S/tutorial/QuantumFourierTransform#727891409", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Physical Meaning"], 
      "paclet:QuantumMob/Q3S/tutorial/QuantumFourierTransform#1970601676", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Semiclassical Implementation"], 
      "paclet:QuantumMob/Q3S/tutorial/QuantumFourierTransform#1845626348", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TutorialJumpBox",ExpressionUUID->"8b7768e8-8761-4871-9d07-\
cbfb30f1b165"],

Cell[TextData[{
 "See also Section 4.3 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "befd85c5-28b2-44a4-b1a4-d4ec51fb89b4"],
 "."
}], "Text",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"ab227918-b61e-46da-a398-95b487931509"],

Cell["\<\
The quantum Fourier transform is a unitary transformation of quantum states. \
It is analogous to the discrete Fourier transform of a finite set of numbers. \
In the case of the quantum Fourier transform, the numbers are replaced with \
quantum states.\
\>", "Text",
 CellID->1636777126,ExpressionUUID->"59a29ca2-12bb-42a4-bc4d-10edc5f31cc3"],

Cell[TextData[{
 "The quantum Fourier transform can be performed efficiently on a quantum \
computer consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "8c396038-bb56-46db-b541-a6246cfde599"],
 " qubits with only ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    SuperscriptBox["n", "2"], ")"}], TraditionalForm]],ExpressionUUID->
  "d3241d69-5af3-4b16-a22c-a73fb223b942"],
 " elementary quantum gate operations, compared to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    RowBox[{"n", " ", 
     SuperscriptBox["2", "n"]}]}], TraditionalForm]],ExpressionUUID->
  "590a74f4-8ae7-47b1-b6e5-61ce5fb7b8d2"],
 ") gates for the best known classical algorithm for a discrete Fourier \
transform. This exponential speedup in the quantum Fourier transform \
algorithm relative to the classical counterpart enabled the celebrated \
quantum factorization algorithm to achieve a similar efficiency."
}], "Text",
 CellID->47638612,ExpressionUUID->"826227d5-7d9b-4bcd-8087-4b105222cbd6"],

Cell["\<\
Apart from the above mentioned quantum factorization algorithm, the quantum \
Fourier transformation is a key part of many other quantum algorithms, such \
as the quantum phase estimation, the order-finding problem, the discrete \
logarithm, and most importantly the hidden subgroup problem. Such a wide \
range of applications of the quantum Fourier transform stems from the fact \
that all known quantum algorithms featuring an exponential speedup over \
classical algorithms are variations of the hidden subgroup problem and, as \
first realized by Kitaev (1996), the key step to solve the latter problem is \
the quantum Fourier transform.\
\>", "Text",
 CellID->1798235200,ExpressionUUID->"1ca70f57-ecfe-4252-a5c2-a4d44bd3fcf3"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["QFT"]], "paclet:QuantumMob/Q3S/ref/QFT", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents the quantum Fourier transform", "TableText",ExpressionUUID->
     "428941d4-8fc8-43bc-b3a3-3637ac7e2b81"]},
   {
    TemplateBox[{
      Cell[
       TextData["ControlledPower"]], 
      "paclet:QuantumMob/Q3S/ref/ControlledPower", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents a controlled-power of unitary operator", "TableText",
     ExpressionUUID->"1c759529-2554-463d-9175-0207d17344a5"]},
   {
    TemplateBox[{
      Cell[
       TextData["ControlledGate"]], 
      "paclet:QuantumMob/Q3S/ref/ControlledGate", "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents a controlled-unitary gate", "TableText",ExpressionUUID->
     "75cea529-e8f0-4ab5-befd-d39d7b3d94a4"]}
  }]], "DefinitionBox",
 CellID->2066146172,ExpressionUUID->"f921e9b1-bd6c-42cd-97fb-862b14568e4c"],

Cell["Q3 functions related to the quantum Fourier transform.", "Caption",
 CellID->908140814,ExpressionUUID->"285e93df-bbf4-4ee2-bdd9-a88681fa261b"],

Cell["\<\
Make sure that the Q3 framework is loaded to use the demonstrations in this \
document.\
\>", "MathCaption",
 CellID->1428640008,ExpressionUUID->"f841e68d-7ec5-4d86-9a4c-3c63a8bdcbfd"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->853967906,ExpressionUUID->"3d6d4927-0294-4af7-a7ea-20c6afa3bd32"],

Cell[TextData[{
 "Throughout this document, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "MathCaption",
 CellID->1937193009,ExpressionUUID->"6083d8f6-cc45-4525-8d8e-274094b470d2"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->403330096,ExpressionUUID->"dfc8f58f-c26a-4af5-9ff4-6762cc2f47b2"],

Cell[CellGroupData[{

Cell["Definition", "Section",
 CellID->1875748448,ExpressionUUID->"c1d3d316-d3d3-431f-809b-e901e7bcb40b"],

Cell["\<\
To make the physical meaning underlying the quantum Fourier transform \
clearer, in this document, we use a slightly different notation for the \
computational basis states, and denote them by\
\>", "Text",
 CellID->644227576,ExpressionUUID->"ce8d7de7-7e85-4e80-9100-c7eb4402e224"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      SubscriptBox["X", "x"]},
     "Ket"], ":=", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["x", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["x", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["x", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "7efb3495-592d-4406-bad2-0370ddad09fc"]
}], "Text",
 CellID->2067805305,ExpressionUUID->"50940291-3f1f-41d6-b926-2e57a6f86b57"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", "=", "0"}], ",", "1", ",", "2", ",", "\[Ellipsis]", ",", 
    RowBox[{
     SuperscriptBox["2", "n"], "-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "6b784f49-1f90-484e-a424-6dc2b295ac0a"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "k"], TraditionalForm]],ExpressionUUID->
  "fb774c82-5646-4aeb-8a50-6b5703c8d5a2"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"k", "=", "1"}], ",", "2", ",", "\[Ellipsis]", ",", "n"}], 
   TraditionalForm]],ExpressionUUID->"0bd230ce-e4af-42a8-a78b-98f579fdba25"],
 " are the binary digits of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "1"], 
       SubscriptBox["x", "2"], 
       SubscriptBox["\[CenterEllipsis]x", "n"]}], ")"}], "2"]}], 
   TraditionalForm]],ExpressionUUID->"c18f9dd9-9b15-4c4e-802e-77ce6ca55a86"],
 "."
}], "Text",
 CellID->875901734,ExpressionUUID->"80d83813-d970-482b-8ad5-dd93e1389007"],

Cell["\<\
\tThe quantum Fourier transform, QFT for short, is a unitary transformation \
defined by the association\
\>", "Text",
 CellID->280043153,ExpressionUUID->"f9ad5f06-008b-4de0-91cf-6c1f365a6b7b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QFT"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], ":=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{
         SubscriptBox["X", "x"]},
        "Ket"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "x", " ", 
         SubscriptBox["p", "y"]}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "37bbef8a-f7c4-4f16-a322-fd0409798200"]
}], "Text",
 CellID->1548601894,ExpressionUUID->"9958b59b-6473-46d5-a406-85b48433a44a"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "=", "0"}], ",", "1", ",", "2", ",", "\[Ellipsis]", ",", 
    RowBox[{
     SuperscriptBox["2", "n"], "-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "7e6edd58-4751-4546-b283-09f83c7fa3f8"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "y"], TraditionalForm]],ExpressionUUID->
  "57e64655-dfba-443f-a9a3-b892e201e16a"],
 " is the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["y", "th"], TraditionalForm]],ExpressionUUID->
  "e1ac2b7b-ebad-4917-92ce-77def60f4191"],
 " \[OpenCurlyDoubleQuote]wave number\[CloseCurlyDoubleQuote] defined by"
}], "Text",
 CellID->1997714465,ExpressionUUID->"ef924c33-06b8-4029-b89f-654d4ef65330"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "y"], ":=", 
    RowBox[{
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "y"}], 
      SuperscriptBox["2", "n"]], "=", 
     RowBox[{"2", 
      SubscriptBox[
       RowBox[{"\[Pi]", "(", 
        RowBox[{"0.", 
         SubscriptBox["y", "1"], 
         SubscriptBox["y", "2"], 
         SubscriptBox["\[CenterEllipsis]y", "n"]}], ")"}], "2"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"ad029d30-86e6-4863-907e-73da997f94a6"],
 "."
}], "Text",
 CellID->1827676057,ExpressionUUID->"9bdd9950-4e74-4ea1-8d9e-2d68b53879c4"],

Cell[TextData[{
 "Like ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "k"], TraditionalForm]],ExpressionUUID->
  "ec7170a0-6661-48c7-8a85-0db6421c165c"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "k"], TraditionalForm]],ExpressionUUID->
  "389139c0-cc14-40b2-bbd4-ca693ae764b6"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"k", "=", "1"}], ",", "2", ",", "\[Ellipsis]", ",", "n"}], 
   TraditionalForm]],ExpressionUUID->"7cb38cb8-a34f-4047-991c-bc83ab319234"],
 " are the binary digits of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["y", "1"], 
       SubscriptBox["y", "2"], 
       SubscriptBox["\[CenterEllipsis]y", "n"]}], ")"}], "2"]}], 
   TraditionalForm]],ExpressionUUID->"5f61193c-17a7-471b-ad29-80a13ec2ea30"],
 "."
}], "Text",
 CellID->145403311,ExpressionUUID->"8798a58a-161a-4db5-bc9c-0f7c1f7201bd"],

Cell[TextData[{
 "\tThe expression on the right-hand side of the above definition is of a \
familiar form of the ",
 StyleBox["discrete Fourier transform",
  FontSlant->"Italic"],
 " except that instead of numerical coefficients for the exponential factor \
",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "x", " ", 
     SubscriptBox["p", "y"]}]], TraditionalForm]],ExpressionUUID->
  "47f156f6-5198-47f3-9dec-6070415e597d"],
 ", there appear state vectors. Therefore, one may think of the quantum \
Fourier transform as a ",
 StyleBox["vector-valued",
  FontSlant->"Italic"],
 " discrete Fourier transformation."
}], "Text",
 CellID->2104541338,ExpressionUUID->"e425cb34-df2b-4fc2-93a5-9a36143e2cd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Physical Meaning", "Section",
 CellID->1970601676,ExpressionUUID->"0108b28e-7bae-4b1a-a62d-769970d7ac23"],

Cell["\<\
In many physical applications, there is a more important aspect of the \
quantum Fourier transform than its formal similarity to the discrete Fourier \
transform. It is useful and inspiring to regard the QFT as a basis change, a \
unitary transformation from the computational basis\
\>", "Text",
 CellID->1409564498,ExpressionUUID->"a6083d02-f569-4aa9-b6e2-c9a4f627c972"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{
         SubscriptBox["X", "x"]},
        "Ket"], ":", "x"}], "=", "0"}], ",", "1", ",", "2", ",", 
     "\[Ellipsis]", ",", 
     RowBox[{
      SuperscriptBox["2", "n"], "-", "1"}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"47d7ae5a-020c-4b54-8951-b5dc8ff7431e"]
}], "Text",
 CellID->1658407829,ExpressionUUID->"e539ecd4-61fd-4fc0-9021-0aa4b37df486"],

Cell["to the so-called \[OpenCurlyDoubleQuote]conjugate basis\
\[CloseCurlyDoubleQuote]", "Text",
 CellID->670127590,ExpressionUUID->"7328f45e-1f8c-4a11-9bea-4ab9b6c182c5"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["P", "y"]},
       "Ket"], ":=", 
      RowBox[{
       RowBox[{
        SubscriptBox["U", "QFT"], 
        RowBox[{
         TemplateBox[{
           SubscriptBox["X", "y"]},
          "Ket"], ":", "y"}]}], "=", "0"}]}], ",", "1", ",", "2", ",", 
     "\[Ellipsis]", ",", 
     RowBox[{
      SuperscriptBox["2", "n"], "-", "1"}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"4738dd8e-19f1-4da8-b208-9ad0850e0698"],
 "."
}], "Text",
 CellID->1430160262,ExpressionUUID->"aea74edf-7948-456a-9994-35247a7ba411"],

Cell[TextData[{
 "\tThe key observation is that in the \[OpenCurlyDoubleQuote]continuum\
\[CloseCurlyDoubleQuote] limit (",
 Cell[BoxData[
  FormBox[
   RowBox[{"L", " ", ":=", " ", 
    RowBox[{
     SuperscriptBox["2", "n"], "\[RightArrow]", " ", "\[Infinity]"}]}], 
   TraditionalForm]],ExpressionUUID->"7555ddaa-3405-4778-92b2-84dbb13b911a"],
 "), the computational basis corresponds to the eigenbasis of the \
\[OpenCurlyDoubleQuote]position\[CloseCurlyDoubleQuote] and the conjugate \
basis to that of the \[OpenCurlyDoubleQuote]momentum\[CloseCurlyDoubleQuote]. \
Indeed, one can see that the two observables"
}], "Text",
 CellID->2066546210,ExpressionUUID->"4794b373-5c4d-4a69-b531-218ef84797ae"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"X", ":=", 
    RowBox[{
     UnderscriptBox["\[CapitalSigma]", "x"], 
     TemplateBox[{
       SubscriptBox["X", "x"]},
      "Ket"], "x", 
     TemplateBox[{
       SubscriptBox["X", "x"]},
      "Bra"]}]}], TraditionalForm]],ExpressionUUID->
  "914d1783-65ce-4ee7-ae6c-f9b0efe99177"],
 "     and     ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", ":=", 
    RowBox[{
     UnderscriptBox["\[CapitalSigma]", "y"], 
     TemplateBox[{
       SubscriptBox["P", "y"]},
      "Ket"], 
     SubscriptBox["p", "y"], 
     TemplateBox[{
       SubscriptBox["P", "y"]},
      "Bra"]}]}], TraditionalForm]],ExpressionUUID->
  "57238ab1-8f81-4e6d-9547-67065060c67d"]
}], "Text",
 CellID->1189128539,ExpressionUUID->"29436a5b-84e2-4923-bba5-a940bd916f91"],

Cell[TextData[{
 "bearing eigenvalues ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "5fbaa791-94d0-401e-9cae-8e8e4bd63eeb"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "y"], TraditionalForm]],ExpressionUUID->
  "487049c0-87d5-4dab-bece-083c18cd7da7"],
 ", respectively, satisfy the relation"
}], "Text",
 CellID->1200535991,ExpressionUUID->"a6f648d3-9b3a-45ba-9748-99ba50b2a448"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", "P"}]], "X", " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"+", "\[ImaginaryI]"}], " ", "a", " ", "P"}]]}], "=", 
    RowBox[{"X", " ", "-", " ", 
     RowBox[{"a", " ", "I"}]}]}], TraditionalForm]],ExpressionUUID->
  "2e535da2-64dd-4fe3-b7a8-19e472f510fc"],
 "."
}], "Text",
 CellID->1799537172,ExpressionUUID->"ebde6447-18a7-4e62-832f-f9d3775963f5"],

Cell[TextData[{
 "This implies that ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", "P"}]], TraditionalForm]],
  ExpressionUUID->"84b8381a-4f72-40a1-8ce6-7cd77178a30d"],
 "is a translation operator, and ",
 Cell[BoxData[
  FormBox["P", TraditionalForm]],ExpressionUUID->
  "a944f4bb-8135-4388-ac88-69a911307272"],
 " is the generator of the translation, i.e., the momentum."
}], "Text",
 CellID->1809049103,ExpressionUUID->"c06bd4bd-5737-4250-acdf-4260dc50a7d6"],

Cell[TextData[{
 "\tThis notion can be made rigorous even in a finite-dimensional Hilbert \
space using the unitary operators ",
 Cell[BoxData[
  FormBox[
   RowBox[{"exp", "(", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "p", " ", "X"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"f67c0b23-7b83-47dc-b7a9-aa1b3e78194a"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"exp", "(", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", "P"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"b427bb39-5001-40cc-8b74-cbf06e23f364"],
 ", which generate the so-called ",
 StyleBox["Weyl-Heisenberg group",
  FontSlant->"Italic"],
 ";  see Weyl (1931, Section IV.14) for example."
}], "Text",
 CellID->614799895,ExpressionUUID->"35980900-8abf-4abb-9c76-5d4d5a95246b"],

Cell["\<\
\tThe quantum Fourier transform appears frequently in many quantum algorithms \
(notably the quantum phase estimation algorithm), in an explicit or disguised \
form. The relation between the computational and conjugate basis defined \
above is useful to understand the principle behind the particular algorithms.\
\
\>", "Text",
 CellID->1398009548,ExpressionUUID->"b94dcfd0-1a60-453b-8f02-7b6529f88549"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum Implementation", "Section",
 CellID->727891409,ExpressionUUID->"3b71ee5e-6eed-446a-ad3f-f53a4c2af1c7"],

Cell[TextData[{
 "The quantum Fourier transform algorithm is to efficiently implement the \
unitary operator ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "QFT"], TraditionalForm]],ExpressionUUID->
  "17aeb853-4679-4e53-88ae-63e5826ebced"],
 " in terms of the elementary gates. Getting back to the definition, the \
quantum Fourier transform maps the quantum states by"
}], "Text",
 CellID->2036400266,ExpressionUUID->"382ebe22-5461-41da-b89a-3a5d18c7b416"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QFT"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], ":=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     UnderoverscriptBox["\[CapitalSigma]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{
       SubscriptBox["X", "x"]},
      "Ket"], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "x", " ", 
       SubscriptBox["p", "y"]}]]}]}], TraditionalForm]],ExpressionUUID->
  "e9efb766-2c03-4abc-979c-3a99fd2077ec"]
}], "Text",
 CellID->1332388423,ExpressionUUID->"e7eebf3a-7622-4354-af7f-9979953faec8"],

Cell["with wave number", "Text",
 CellID->1640238092,ExpressionUUID->"8e0eaa71-7cb2-4609-ae5f-1e58fb74577f"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "y"], ":=", 
    FractionBox[
     RowBox[{"2", "\[Pi]", " ", "y"}], 
     SuperscriptBox["2", "n"]]}], TraditionalForm]],ExpressionUUID->
  "fe8fc48e-b426-4348-ba54-92a5e29bfdbe"]
}], "Text",
 CellID->234035705,ExpressionUUID->"bf4a3a8d-4fa8-423a-9305-025f3a65ac0f"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "=", "0"}], ",", "1", ",", "2", ",", "\[Ellipsis]", ",", 
    RowBox[{
     SuperscriptBox["2", "n"], "-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "bd719cc8-d93c-45f7-b6e6-cbacfb0a84fb"],
 "."
}], "Text",
 CellID->1395536278,ExpressionUUID->"75e89778-13fc-4135-b91c-9e7f791120b8"],

Cell[TextData[{
 "\tSince the characteristic properties of the Fourier transform of any kind \
are attributed to an oscillatory phase factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "x", " ", 
     SubscriptBox["p", "y"]}]], TraditionalForm]],ExpressionUUID->
  "d49b2458-10d2-44a6-9152-7a49ab855ad3"],
 ", we start by elaborating it. The product ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", " ", 
    SubscriptBox["p", "y"]}], TraditionalForm]],ExpressionUUID->
  "e43098de-5e36-4b51-947c-334a27b87bf7"],
 " in the exponent is given by"
}], "Text",
 CellID->2109315459,ExpressionUUID->"404596d8-aab7-4847-a8a2-4dff227eac25"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", " ", 
     SubscriptBox["p", "y"]}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "x", " ", "y"}], 
      SuperscriptBox["2", "n"]], "=", 
     RowBox[{
      RowBox[{"2", 
       SubscriptBox[
        RowBox[{"\[Pi]", "(", 
         RowBox[{"0.", 
          SubscriptBox["x", "1"], 
          SubscriptBox["x", "2"], 
          SubscriptBox["\[CenterEllipsis]x", "n"]}], ")"}], "2"], "y"}], "=", 
      
      RowBox[{"2", "\[Pi]", " ", "y", 
       RowBox[{
        UnderoverscriptBox["\[CapitalSigma]", 
         RowBox[{"k", "=", "1"}], "n"], 
        RowBox[{
         SubscriptBox["x", "k"], 
         SuperscriptBox["2", 
          RowBox[{"-", "k"}]]}]}]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "e21c5c52-c6d1-475b-b0d8-d400c7d69c0e"],
 ","
}], "Text",
 CellID->604874737,ExpressionUUID->"e024b0ad-837b-4a72-b828-a02714c0f3c5"],

Cell["which recasts the phase factor into the form", "Text",
 CellID->2089603508,ExpressionUUID->"437bf422-b641-41c5-b2b5-278cf329dfc9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"exp", "(", 
     RowBox[{"\[ImaginaryI]", " ", "x", " ", 
      SubscriptBox["p", "y"]}], ")"}], "=", 
    RowBox[{
     UnderoverscriptBox["\[CapitalPi]", 
      RowBox[{" ", 
       RowBox[{"k", "=", "1"}]}], 
      RowBox[{" ", "n"}]], 
     RowBox[{"exp", "(", 
      RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "y", " ", 
       SubscriptBox["x", "k"], 
       SuperscriptBox["2", 
        RowBox[{"-", "k"}]]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "fe955952-5ad1-49f1-bd4a-2fd56bddd9b8"],
 "."
}], "Text",
 CellID->1128739665,ExpressionUUID->"db2fa967-696c-47a4-bf98-90787c08f5d2"],

Cell[TextData[{
 "We put it back in the defining expression of quantum Fourier transform in \
the above, and rewrite the sum over ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "7acf9a76-73d9-44ef-a17f-b10d250b6d8a"],
 " with the sum over bit values ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "k"], "\[Element]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "1612e7fa-a7c2-471e-8f97-3e26aa437bbb"],
 ", which lead to"
}], "Text",
 CellID->1156465011,ExpressionUUID->"d65438b5-68c0-4de2-84be-b317e1375acd"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QFT"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    RowBox[{
     UnderoverscriptBox[
      RowBox[{" ", 
       RowBox[{"\[CircleTimes]", " "}]}], 
      RowBox[{"k", "=", "1"}], "n"], 
     UnderscriptBox["\[CapitalSigma]", 
      RowBox[{
       SubscriptBox["x", "k"], "=", "0", ",", "1"}]], 
     TemplateBox[{
       SubscriptBox["x", "k"]},
      "Ket"], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", 
       SubscriptBox["x", "k"], 
       RowBox[{"y", "/", 
        SuperscriptBox["2", "k"]}]}]]}]}], TraditionalForm]],ExpressionUUID->
  "b0ce896f-f572-4ba5-814f-1fd6bceedd46"],
 "."
}], "Text",
 CellID->1980434527,ExpressionUUID->"1343ba8c-11a1-46f7-8f6b-7967ed1e73c2"],

Cell[TextData[{
 "For a fixed ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "a3b36643-e7a4-43f3-be29-029ce11a80b2"],
 ", the ratio ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "/", 
    SuperscriptBox["2", "k"]}], TraditionalForm]],ExpressionUUID->
  "54902e97-e0d6-4b4e-8b4f-cbbec5f762dc"],
 " is represented in binary digits as"
}], "Text",
 CellID->1314050436,ExpressionUUID->"bed12125-549f-470b-95c6-0815c41a7c91"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"y", "/", 
     SuperscriptBox["2", "k"]}], "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["y", "1"], 
       SubscriptBox["y", "2"], 
       RowBox[{
        SubscriptBox["\[CenterEllipsis]y", 
         RowBox[{"n", "-", "k"}]], ".", 
        SubscriptBox["y", 
         RowBox[{"n", "-", "k", "+", "1"}]]}], 
       SubscriptBox["\[CenterEllipsis]y", 
        RowBox[{"n", "-", "1"}]], 
       SubscriptBox["y", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"4d553fb3-e437-46b6-818e-d026a747355f"],
 "."
}], "Text",
 CellID->523852104,ExpressionUUID->"fa1c6526-557b-4c4f-9cd0-f8ef673f41d3"],

Cell[TextData[{
 "The integer part does not affect the sum because ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "m"}]], "=", "1"}], 
   TraditionalForm]],ExpressionUUID->"7eb3402c-43e1-49e8-883d-c9731998820f"],
 " for any integer ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "1936ca65-8df5-47a6-90a6-716b7d135fd4"],
 "; only the fractional part ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{"0.", 
      SubscriptBox["y", 
       RowBox[{"n", "-", "k", "+", "1"}]], 
      SubscriptBox["\[CenterEllipsis]y", "n"]}], ")"}], "2"], 
   TraditionalForm]],ExpressionUUID->"2873a9ca-76b7-43a1-aae2-f35c05f0216a"],
 " does. Depriving the phase factors ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["x", "k"], 
     SubscriptBox["p", "y"]}]], TraditionalForm]],ExpressionUUID->
  "fd76884c-a5ac-49a5-b1fa-e3bdd7e386fc"],
 " of the integer parts, we arrive at the expression for the result of the \
transformation"
}], "Text",
 CellID->1846842875,ExpressionUUID->"b671ba75-c2e4-4c5f-ae40-f130945b75ac"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QFT"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    RowBox[{
     UnderoverscriptBox[
      RowBox[{" ", 
       RowBox[{"\[CircleTimes]", " "}]}], 
      RowBox[{"k", "=", "1"}], "n"], 
     UnderscriptBox["\[CapitalSigma]", 
      RowBox[{
       SubscriptBox["x", "k"], "=", "0", ",", "1"}]], 
     TemplateBox[{
       SubscriptBox["x", "k"]},
      "Ket"], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", 
       SubscriptBox[
        RowBox[{
         SubscriptBox["x", "k"], "(", 
         RowBox[{"0.", 
          SubscriptBox["y", 
           RowBox[{"n", "-", "k", "+", "1"}]], 
          SubscriptBox["\[CenterEllipsis]y", 
           RowBox[{"n", "-", "1"}]], 
          SubscriptBox["y", "n"]}], ")"}], "2"]}]]}]}], TraditionalForm]],
  ExpressionUUID->"89a22c7e-19de-40b8-afd4-1d9ca8ead1af"],
 "."
}], "Text",
 CellID->159566387,ExpressionUUID->"466767ee-c88e-4632-97e6-b04be1c63564"],

Cell[TextData[{
 "Explicitly writing the sums over bit values ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "k"], TraditionalForm]],ExpressionUUID->
  "54a71252-fc72-459f-9cc0-b5574fdf20f4"],
 ", it reads as"
}], "Text",
 CellID->1772674853,ExpressionUUID->"3d689d8c-31fd-49e1-bb21-620e1d9611fe"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QFT"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", "n"]}]]}]}], 
       SqrtBox["2"]], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", 
            RowBox[{"n", "-", "1"}]], 
           SubscriptBox["y", "n"]}]]}]}], 
       SqrtBox["2"]], ")"}], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", "1"], 
           SubscriptBox["y", "2"], 
           SubscriptBox["\[CenterEllipsis]y", "n"]}]]}]}], 
       SqrtBox["2"]], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "ec9d227d-0883-41e6-b3f5-e65cf60a6f9b"],
 "."
}], "Text",
 CellID->1305619540,ExpressionUUID->"74e42737-cd26-4bc0-8921-6e3a74543225"],

Cell[TextData[{
 "\tInterestingly, the state resulting from the quantum Fourier transform is \
clearly a product state. The first factor is stored in the first qubit of the \
quantum register, and consecutive factors are stored in the corresponding \
qubits in the same order. For later analysis, it is useful to reverse the \
order. This is equivalent to performing the ",
 StyleBox["quantum bit-reversal transform",
  FontSlant->"Italic"],
 " (",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QBR"]], "paclet:QuantumMob/Q3S/ref/QBR", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0160a612-59e9-4c18-97b2-d3ff520dafa8"],
 ")"
}], "Text",
 CellID->559703734,ExpressionUUID->"8ccae872-d773-4e26-9fe5-6a74aeca7926"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QBR"], 
     RowBox[{
      TemplateBox[{
        SubscriptBox["y", "1"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["y", "2"]},
       "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["y", "n"]},
       "Ket"]}]}], "=", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["y", "n"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", "2"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", "1"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "92f8f624-9175-4fbd-9f37-c82bd00dc34f"],
 " ."
}], "Text",
 CellID->962283478,ExpressionUUID->"87202d93-c6ea-4872-a62f-fd387b036536"],

Cell["\<\
Note that the quantum bit-reversal transform can be efficiently implemented \
by a sequence of SWAP gates as in Figure 1. Applying the quantum bit-reversal \
transform after the quantum Fourier transform, we arrive at the final \
expression that we analyze subsequently\
\>", "Text",
 CellID->399069189,ExpressionUUID->"4a3aa893-1e8e-4d4a-9e4f-fc52c276a579"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "QBR"], 
     SubscriptBox["U", "QFT"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", "1"], 
           SubscriptBox["y", "2"], 
           SubscriptBox["\[Ellipsis]y", "n"]}]]}]}], 
       SqrtBox["2"]], ")"}], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", 
            RowBox[{"n", "-", "1"}]], 
           SubscriptBox["y", "n"]}]]}]}], 
       SqrtBox["2"]], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", "\[Pi]", " ", "\[ImaginaryI]", " ", "0.", 
           SubscriptBox["y", "n"]}]]}]}], 
       SqrtBox["2"]], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "7f675b11-fddc-4389-8ae7-d834ca33ee59"],
 "."
}], "Text",
 CellID->564429942,ExpressionUUID->"2c706183-e799-4630-a52a-e22d1f75effe"],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   InterpretationBox[
    GraphicsBox[{{
       Dashing[{Small, Small}], 
       LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
       0, -4}, {2, -4}}, {{0, -5}, {2, -5}}}], {{
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        RectangleBox[{0.6, -5.4}, {1.4, -0.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
         "\"QBR\"", {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.2]}, StripOnInput -> False], TraditionalForm], {1., -3.}, 
        
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {0, 1}]}}, {}, 
     PlotRange -> {{0, 2}, {-5.5, -0.5}}, 
     ImagePadding -> {{25.56, 25.56}, {7.2, 7.2}}, ImageSize -> 118.8, 
     AxesStyle -> Large, FrameStyle -> Large, ImageSize -> Large, 
     PlotRangePadding -> Scaled[0.025]], 
    Q3`QuantumCircuit[
     Q3`QBR[{
       $CellContext`S[1, Q3`$], 
       $CellContext`S[2, Q3`$], 
       $CellContext`S[3, Q3`$], 
       $CellContext`S[4, Q3`$], 
       $CellContext`S[5, Q3`$]}], "Visible" -> {
       $CellContext`S[1, Q3`$], 
       $CellContext`S[2, Q3`$], 
       $CellContext`S[3, Q3`$], 
       $CellContext`S[4, Q3`$], 
       $CellContext`S[5, Q3`$]}]], 
   StyleBox["=", StripOnInput -> False, FontSize -> Large], 
   InterpretationBox[
    GraphicsBox[{{
       Dashing[{Small, Small}], 
       LineBox[{}]}, 
      LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}, {{
       0, -4}, {3, -4}}, {{0, -5}, {3, -5}}}], {
       LineBox[{{1, -1}, {1, -5}}], {
        LineBox[{{{0.8200000000000001, -1.18}, {
         1.18, -0.8200000000000001}}, {{
         0.8200000000000001, -0.8200000000000001}, {1.18, -1.18}}}]}, {
        LineBox[{{{0.8200000000000001, -5.18}, {1.18, -4.82}}, {{
         0.8200000000000001, -4.82}, {1.18, -5.18}}}]}}, {
       LineBox[{{2, -2}, {2, -4}}], {
        LineBox[{{{1.82, -2.18}, {2.18, -1.82}}, {{1.82, -1.82}, {
         2.18, -2.18}}}]}, {
        LineBox[{{{1.82, -4.18}, {2.18, -3.82}}, {{1.82, -3.82}, {
         2.18, -4.18}}}]}}}, {}, PlotRange -> {{0, 3}, {-5.5, -0.5}}, 
     ImagePadding -> {{25.56, 25.56}, {7.2, 7.2}}, ImageSize -> 
     154.79999999999998`, AxesStyle -> Large, FrameStyle -> Large, ImageSize -> 
     Large, PlotRangePadding -> Scaled[0.025]], 
    Q3`QuantumCircuit[
     Q3`SWAP[
      $CellContext`S[1, Q3`$], 
      $CellContext`S[5, Q3`$]], 
     Q3`SWAP[
      $CellContext`S[2, Q3`$], 
      $CellContext`S[4, Q3`$]], "Visible" -> {
       $CellContext`S[1, Q3`$], 
       $CellContext`S[2, Q3`$], 
       $CellContext`S[3, Q3`$], 
       $CellContext`S[4, Q3`$], 
       $CellContext`S[5, Q3`$]}]]},
  "RowDefault"]],ExpressionUUID->"833d4ed1-d0cb-4f8e-83d2-cd7184370e55"]], \
"Picture",
 CellID->1842836385,ExpressionUUID->"37a39816-f582-4491-aa93-540647c430d2"],

Cell[TextData[{
 StyleBox["Figure 1",
  FontWeight->"Bold"],
 ". An implementation of quantum bit-reversal transform (QBR)."
}], "Caption",
 CellID->2022043910,ExpressionUUID->"4dbaae8e-e329-45cf-a315-81f978df9c21"],

Cell[TextData[{
 "\tSo far, we have done nothing but re-express the defining equation of the \
quantum Fourier transform. Now, we identify the elementary quantum logic \
gates that compose the transform. The product form in the above is remarkably \
simple to analyze. In particular, the state stored in the last qubit depends \
only on its own state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["y", "n"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "314a70aa-3728-4d38-9bf1-c3cc24cf6067"],
 ", and the relative phase factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", "\[Pi]", "\[VeryThinSpace]", 
     SubscriptBox[
      RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", "(", 
       RowBox[{"0.", 
        SubscriptBox["y", "n"]}], ")"}], "2"]}]], TraditionalForm]],
  ExpressionUUID->"a5addeff-a8af-4ebc-8d8f-80f39b6812df"],
 " is equivalent to applying the Hadamard gate,"
}], "Text",
 CellID->938766395,ExpressionUUID->"59a48e6a-374e-4a2b-a2fa-ee6a4c74d3da"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", "\[Pi]", "\[VeryThinSpace]", 
         SubscriptBox[
          RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", "(", 
           RowBox[{"0.", 
            SubscriptBox["y", "n"]}], ")"}], "2"]}]]}]}], 
     SqrtBox["2"]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       SuperscriptBox[
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], "(", 
         RowBox[{"-", "1"}], ")"}], 
        SubscriptBox["y", "n"]]}], 
      SqrtBox["2"]], "=", 
     RowBox[{"H", 
      TemplateBox[{
        SubscriptBox["y", "n"]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "0acd6d8c-9626-4816-9f81-1f6cca75f41d"],
 " ."
}], "Text",
 CellID->149852799,ExpressionUUID->"39b4d9a5-96ae-4312-bb76-ef29d3b2198b"],

Cell[TextData[{
 "The second last factor depends not only on the input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["y", 
      RowBox[{"n", "-", "1"}]]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "6956cfc9-11c2-4b9a-bbc2-7b2e883554ce"],
 " of the second last qubit but also on the last qubit. However, the phase \
factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"2", "\[Pi]", "\[VeryThinSpace]", 
     SubscriptBox[
      RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", "(", 
       RowBox[{"0.", 
        SubscriptBox["y", 
         RowBox[{"n", "-", "1"}]]}], ")"}], "2"]}]], TraditionalForm]],
  ExpressionUUID->"24337e9b-413e-4292-9cb9-e73658b6c11f"],
 "governed by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["y", 
      RowBox[{"n", "-", "1"}]]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "56a52e90-a0b8-4bf3-bc3d-b27d64d101f5"],
 " is again equivalent to the Hadamard gate. On the other hand, the \
additional phase factor ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", "\[Pi]", "\[VeryThinSpace]", 
      SubscriptBox[
       RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", "(", 
        RowBox[{"0.0", 
         SubscriptBox["y", "n"]}], ")"}], "2"]}]], "=", 
    SuperscriptBox[
     RowBox[{"(", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", 
        RowBox[{"\[Pi]", "/", 
         SuperscriptBox["2", "2"]}]}]], ")"}], 
     SubscriptBox["y", "n"]]}], TraditionalForm]],ExpressionUUID->
  "f643adec-2d6c-45ff-87f4-e28239185a4a"],
 "is equivalent to operating the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"controlled", "-", 
    SubscriptBox["Z", "2"]}], TraditionalForm]],ExpressionUUID->
  "78d99462-074a-4455-9fdb-7fefba8187c1"],
 " gate, where"
}], "Text",
 CellID->1009795243,ExpressionUUID->"b5d981d2-8aac-4e44-81a2-2091c49b4679"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "k"], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", "\[Pi]", "\[VeryThinSpace]", 
          RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", "/", 
           SuperscriptBox["2", "k"]}]}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "bda51d14-d4ec-4b12-a7dd-17d9ff5d76c6"],
 " ,"
}], "Text",
 CellID->2134561191,ExpressionUUID->"ac322da9-7d68-4bbf-9354-91f0fe50c85d"],

Cell[TextData[{
 "conditioned on the input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["y", "n"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "2dfbb89d-7b70-4461-9cb7-6350f658cfc2"],
 " of the last qubit. In short, the state stored in the second last qubit is \
given by"
}], "Text",
 CellID->857659199,ExpressionUUID->"f5427d1b-a329-40f5-84fb-9ef665d82dc2"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "+", 
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", "\[Pi]", "\[VeryThinSpace]", 
          SubscriptBox[
           RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", "(", 
            RowBox[{"0.", 
             SubscriptBox["y", 
              RowBox[{"n", "-", "1"}]], 
             SubscriptBox["y", "n"]}], ")"}], "2"]}]]}]}], 
      SqrtBox["2"]], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", "n"]},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["Z", "2", 
        SubscriptBox["y", "n"]], "H", 
       TemplateBox[{
         SubscriptBox["y", 
          RowBox[{"n", "-", "1"}]]},
        "Ket"]}], ")"}], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "8a7320b1-411d-42a1-8131-649b3da45fd1"],
 " ."
}], "Text",
 CellID->523059180,ExpressionUUID->"1a6780ed-8ffd-4755-a1a9-91dea9937fee"],

Cell[TextData[{
 "More generally, the state on the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["k", "th"], TraditionalForm]],ExpressionUUID->
  "7a0656eb-6eea-4df8-8e65-9095b1b12f7a"],
 " qubit"
}], "Text",
 CellID->692423820,ExpressionUUID->"f035fa05-3cf5-4e7a-8fe0-93e84c3b907f"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], "+", 
     RowBox[{
      TemplateBox[{"1"},
       "Ket"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", "\[Pi]", " ", 
        SubscriptBox[
         RowBox[{"\[ImaginaryI]", "(", 
          RowBox[{"0.", 
           SubscriptBox["y", "k"], 
           SubscriptBox["y", 
            RowBox[{"k", "+", "1"}]], 
           SubscriptBox["\[CenterEllipsis]y", "n"]}], ")"}], "2"]}]]}]}], 
    SqrtBox["2"]], TraditionalForm]],ExpressionUUID->
  "71fddd46-537f-45e0-845a-fb2df7d01b6c"]
}], "Text",
 CellID->2035810299,ExpressionUUID->"0b1f9b30-08c2-4f81-8039-883c50432df6"],

Cell["is characterized by the relative phase angle", "Text",
 CellID->409619855,ExpressionUUID->"75fa1299-c47b-4908-b9a6-82cc5e58e149"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"2", 
     SubscriptBox[
      RowBox[{"\[Pi]", "(", 
       RowBox[{"0.", 
        SubscriptBox["y", "k"], 
        SubscriptBox["y", 
         RowBox[{"k", "+", "1"}]], 
        SubscriptBox["\[Ellipsis]y", "n"]}], ")"}], "2"]}], "=", 
    RowBox[{
     RowBox[{"\[Pi]", "\[VeryThinSpace]", 
      SubscriptBox["y", "k"]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"2", "\[Pi]"}], 
       SuperscriptBox["2", "k"]], 
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["y", 
          RowBox[{"k", "+", "1"}]], 
         SubscriptBox["\[Ellipsis]y", "n"]}], ")"}], "2"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"37a22d91-ec9d-44eb-88ff-d70430fd324b"],
 " ."
}], "Text",
 CellID->1377870653,ExpressionUUID->"8ec191af-3927-48ce-bdf7-6f44537b4678"],

Cell[TextData[{
 "The first part ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Pi]", "\[VeryThinSpace]", 
    SubscriptBox["y", "k"]}], TraditionalForm]],ExpressionUUID->
  "623eaa0b-4ad7-4ce4-acb3-f6e77f82e80b"],
 " depends on the state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["y", "k"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "015ce4ae-a230-40b7-b7b9-65efff797f4d"],
 " of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["k", "th"], TraditionalForm]],ExpressionUUID->
  "38690527-d882-48b8-bcd8-4bfdfa3360af"],
 "qubit itself, and is equivalent to the relative phase angle resulting from \
the Hadamard gate,"
}], "Text",
 CellID->192432173,ExpressionUUID->"0b082402-c9e2-4356-8af8-02161f278e9d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", 
     TemplateBox[{
       SubscriptBox["y", "k"]},
      "Ket"]}], "=", 
    FractionBox[
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], "+", 
      SuperscriptBox[
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], "(", 
        RowBox[{"-", "1"}], ")"}], 
       SubscriptBox["y", "k"]]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "f593a5bb-11c7-4a84-accf-863b415fb30e"],
 "."
}], "Text",
 CellID->474108015,ExpressionUUID->"57b4aae0-50ce-48aa-ac3e-6d2048c3e436"],

Cell[TextData[{
 "The second part ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"2", "\[Pi]"}], 
     SuperscriptBox["2", "k"]], 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["y", 
        RowBox[{"k", "+", "1"}]], 
       SubscriptBox["\[Ellipsis]y", "n"]}], ")"}], "2"], " "}], 
   TraditionalForm]],ExpressionUUID->"72ae3232-bc2e-4f03-8001-dfb100dbf791"],
 " is governed by the qubits ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "+", "1"}], TraditionalForm]],ExpressionUUID->
  "73420763-bfd1-491c-b26c-bc7968d6123a"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "+", "2"}], TraditionalForm]],ExpressionUUID->
  "e024ab9a-468e-4d4e-b602-38256a2c0ec4"],
 ", \[Ellipsis], ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "565ca8e9-a780-41a2-bfcf-2d153cff1a22"],
 " through the integer ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["y", 
        RowBox[{"k", "+", "1"}]], 
       SubscriptBox["\[Ellipsis]y", "n"]}], ")"}], "2"], ":=", 
    RowBox[{
     RowBox[{
      SubscriptBox["y", 
       RowBox[{"k", "+", "1"}]], 
      SuperscriptBox["2", "k"]}], "+", "\[Ellipsis]", "+", 
     RowBox[{
      SubscriptBox["y", 
       RowBox[{"n", "-", "1"}]], 
      SuperscriptBox["2", "1"]}], "+", 
     SubscriptBox["y", "n"]}]}], TraditionalForm]],ExpressionUUID->
  "a65b167a-f540-4838-8962-8b5106a7a242"],
 " associated with the bit string ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     RowBox[{"k", "+", "1"}]], 
    SubscriptBox["\[Ellipsis]y", "n"]}], TraditionalForm]],ExpressionUUID->
  "5c147d03-a058-4458-b04c-9e96700e50d3"],
 ". This corresponds to the ",
 ButtonBox["controlled power",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/ControlledPower"],
 " of the phase gate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "5960447e-2323-4687-aad1-eaf34649bc1f"],
 ". Putting it all together, we can regard that the above state  stored on \
the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["k", "th"], TraditionalForm]],ExpressionUUID->
  "6515c661-19ac-45f7-bc60-60e0863e1b5e"],
 " qubit is a result of the transformation"
}], "Text",
 CellID->887676347,ExpressionUUID->"10be9fa2-4d47-4cf6-872d-b51b961231e0"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       SubscriptBox["y", "k"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", 
        RowBox[{"k", "+", "1"}]]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", "n"]},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       UnderoverscriptBox["\[CapitalPi]", 
        RowBox[{" ", 
         RowBox[{"j", "=", "1"}]}], 
        RowBox[{" ", 
         RowBox[{"k", "-", "1"}]}]], 
       SubsuperscriptBox["Z", "k", 
        SubscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["y", 
            RowBox[{"k", "+", "1"}]], "\[Ellipsis]", "\[VeryThinSpace]", 
           SubscriptBox["y", "n"]}], ")"}], "2"]], "H", 
       TemplateBox[{
         SubscriptBox["y", "k"]},
        "Ket"]}], ")"}], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", 
        RowBox[{"k", "+", "1"}]]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["y", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "a60d603e-0de7-4ba9-99e9-9a21bc1a7bce"],
 " ."
}], "Text",
 CellID->1802879584,ExpressionUUID->"b8e4286c-1542-4186-bc3f-b411258ff06a"],

Cell["This is depicted by the quantum circuit in Figure 2.", "Text",
 CellID->73180309,ExpressionUUID->"8a6ce9cb-2433-442b-99a4-2626a7954303"],

Cell[TextData[Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
     0, -5}, {8, -5}}}], {InsetBox[
      TemplateBox[{
        FormBox[
         InterpretationBox[
          SubscriptBox["y", 
           TemplateBox[{",", "\",\"", "k"}, "RowWithSeparators"]], 
          $CellContext`y[$CellContext`k]], TraditionalForm]},
       "Ket"], {-1.1, -1.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{
        FormBox[
         InterpretationBox[
          SubscriptBox["y", 
           TemplateBox[{",", "\",\"", 
             RowBox[{"k", "+", "1"}]}, "RowWithSeparators"]], 
          $CellContext`y[1 + $CellContext`k]], TraditionalForm]},
       "Ket"], {-1.1, -2.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{
        FormBox[
         InterpretationBox[
          SubscriptBox["y", 
           TemplateBox[{",", "\",\"", 
             RowBox[{"k", "+", "2"}]}, "RowWithSeparators"]], 
          $CellContext`y[2 + $CellContext`k]], TraditionalForm]},
       "Ket"], {-1.1, -3.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{
        FormBox[
         InterpretationBox[
          SubscriptBox["y", 
           TemplateBox[{",", "\",\"", "n"}, "RowWithSeparators"]], 
          $CellContext`y[$CellContext`n]], TraditionalForm]},
       "Ket"], {-1.1, -5.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{4, Rational[-11, 2]}, {4, Rational[-1, 2]}}, {{
        4, -5.5}, {4, -0.5}}]]}, {
     LineBox[{{6, -2}, {6, -3}, {6, -5}, {6, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -5.4}, {6.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"y\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\"k\"", "\"y\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, InsetBox[
     StyleBox["\<\"\\!\\(\\*TagBox[TemplateBox[{\\\"0\\\"},\\\"Ket\\\"],\
DisplayForm]\\)+\\!\\(\\*TagBox[TemplateBox[{\\\"1\\\"},\\\"Ket\\\"],\
DisplayForm]\\)(-1\\!\\(\\*SuperscriptBox[\\()\\), SubscriptBox[\\(y\\), \\(k\
\\)]]\\)\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.037500000000000006`],
      FontWeight->"Light",
      FontSlant->Plain], {4., -0.5}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]], 
     Automatic, {1, 0}], InsetBox[
     StyleBox["\<\"\[VerticalEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Plain], {0.5, -4.}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]], 
     Automatic, {1, 0}], 
    InsetBox["\<\"\\!\\(\\*TagBox[TemplateBox[{\\\"0\\\"},\\\"Ket\\\"],\
DisplayForm]\\)+\\!\\(\\*TagBox[RowBox[{TemplateBox[{\\\"1\\\"},\\\"Ket\\\"], \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{\\\"\[ImaginaryI]2\[Pi]\\\", \
\\\"\[VeryThinSpace]\\\", RowBox[{\\\"y\\\", \\\"/\\\", \
SuperscriptBox[\\\"2\\\", \
\\\"k\\\"]}]}]]}],DisplayForm]\\)(-1\\!\\(\\*SuperscriptBox[\\()\\), \
SubscriptBox[\\(y\\), \\(k\\)]]\\)\"\>", {8.2, -1.}, NCache[
     ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1, 
     0}], {InsetBox[
      TemplateBox[{
        FormBox[
         InterpretationBox[
          SubscriptBox["y", 
           TemplateBox[{",", "\",\"", 
             RowBox[{"k", "+", "1"}]}, "RowWithSeparators"]], 
          $CellContext`y[1 + $CellContext`k]], TraditionalForm]},
       "Ket"], {8.2, -2.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{
        FormBox[
         InterpretationBox[
          SubscriptBox["y", 
           TemplateBox[{",", "\",\"", 
             RowBox[{"k", "+", "2"}]}, "RowWithSeparators"]], 
          $CellContext`y[2 + $CellContext`k]], TraditionalForm]},
       "Ket"], {8.2, -3.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{
        FormBox[
         InterpretationBox[
          SubscriptBox["y", 
           TemplateBox[{",", "\",\"", "n"}, "RowWithSeparators"]], 
          $CellContext`y[$CellContext`n]], TraditionalForm]},
       "Ket"], {8.2, -5.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{34.56, 110.16}, {7.2, 7.2}},
   ImageSize->428.40000000000003`,
   PlotRange->{{0, 8}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[{
     Ket[<|$CellContext`S[
        1, Q3`$] -> $CellContext`y[$CellContext`k], $CellContext`S[
        2, Q3`$] -> $CellContext`y[1 + $CellContext`k], $CellContext`S[
        3, Q3`$] -> $CellContext`y[2 + $CellContext`k], $CellContext`S[
        4, Q3`$] -> $CellContext`y[$CellContext`n]|>], 
     "LabelAlignment" -> {-1, 0}}], "Spacer", 
   $CellContext`S[1, 6], "Spacer", "Separator", "Spacer", 
   Q3`Mark[
   "\!\(\*TagBox[TemplateBox[{\"0\"},\"Ket\"],DisplayForm]\)+\!\(\*TagBox[\
TemplateBox[{\"1\"},\"Ket\"],DisplayForm]\)(-1\!\(\*SuperscriptBox[\()\), \
SubscriptBox[\(y\), \(k\)]]\)", {4, 0.5}, "LabelSize" -> 0.75], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, 
    $CellContext`S[1, 3], "ControlLabel" -> "y", "Label" -> 
    Subscript["Z", "k"]], "Spacer", 
   Q3`Mark["\[VerticalEllipsis]", {0.5, 4}], 
   Q3`PortOut[
    Q3`ProductState[<|$CellContext`S[1, Q3`$] -> {1, 1}|>, "Label" -> 
     "\!\(\*TagBox[TemplateBox[{\"0\"},\"Ket\"],DisplayForm]\)+\!\(\*TagBox[\
RowBox[{TemplateBox[{\"1\"},\"Ket\"], SuperscriptBox[\"\[ExponentialE]\", \
RowBox[{\"\[ImaginaryI]2\[Pi]\", \"\[VeryThinSpace]\", RowBox[{\"y\", \"/\", \
SuperscriptBox[\"2\", \"k\"]}]}]]}],DisplayForm]\)(-1\!\(\*SuperscriptBox[\()\
\), SubscriptBox[\(y\), \(k\)]]\)"], 
    Ket[<|$CellContext`S[2, Q3`$] -> $CellContext`y[
       1 + $CellContext`k], $CellContext`S[3, Q3`$] -> $CellContext`y[
       2 + $CellContext`k], $CellContext`S[
       4, Q3`$] -> $CellContext`y[$CellContext`n]|>]], "Invisible" -> {
     $CellContext`S[3.5]}, 
   "PortSize" -> {
    0.9, 3}]]],ExpressionUUID->"57e3bd76-a224-48f8-b253-b6c9d412cc2e"]], \
"Picture",
 CellID->426432358,ExpressionUUID->"0953cbca-0d4f-4030-9304-6dcb32f60fbf"],

Cell[TextData[{
 StyleBox["Figure 2",
  FontWeight->"Bold"],
 ". A quantum circuit illustrating the output state stored on the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["k", "th"], TraditionalForm]],ExpressionUUID->
  "873867cc-9cb6-4f1f-a5ad-f2fe168f40d4"],
 " qubit. Here, ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]],ExpressionUUID->
  "5be4ad64-fb1e-400a-8f02-fc591db5b539"],
 " is the integer with binary digits ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", 
     RowBox[{"k", "+", "1"}]], 
    SubscriptBox["y", 
     RowBox[{"k", "+", "2"}]], "\[Ellipsis]", "\[VeryThinSpace]", 
    SubscriptBox["y", "n"]}], TraditionalForm]],ExpressionUUID->
  "32d64485-1136-4f22-a8de-074fc1e744f6"],
 "; that is, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", ":=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["y", 
        RowBox[{"k", "+", "1"}]], 
       SubscriptBox["y", 
        RowBox[{"k", "+", "2"}]], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["y", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"d61986d6-7d01-446f-a982-65b7c1475727"],
 "."
}], "Caption",
 CellID->1441423492,ExpressionUUID->"e2f6c8db-a9b0-4b76-8822-b1a3f1e5c486"],

Cell[TextData[Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}, {{0, -3}, {11, -3}}, {{
     0, -4}, {11, -4}}, {{0, -5}, {11, -5}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     LineBox[{{2, -2}, {2, -3}, {2, -4}, {2, -5}, {2, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -5.4}, {2.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {2., -3.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "5", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -4}, {4, -5}, {4, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -5.4}, {4.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {4., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -4}, {6, -5}, {6, -3}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -5.4}, {6.4, -3.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -5}, {8, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -5.4}, {8.4, -4.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -5.4}, {9.4, -4.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {9., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -5.4}, {10.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->442.8,
   PlotRange->{{0, 11}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$], 
     $CellContext`S[5, Q3`$]}, 
    $CellContext`S[1, 
     C[5]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$], 
     $CellContext`S[5, Q3`$]}, 
    $CellContext`S[2, 
     C[4]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   Q3`ControlledPower[{
     $CellContext`S[4, Q3`$], 
     $CellContext`S[5, Q3`$]}, 
    $CellContext`S[3, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[4, 6], 
   Q3`ControlledPower[{
     $CellContext`S[5, Q3`$]}, 
    $CellContext`S[4, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[5, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$], 
     $CellContext`S[
     5, Q3`$]}]]]], \
"Output",ExpressionUUID->"df2c93be-e914-4872-b5e2-b12908d47e9e"]], "Picture",
 CellID->805780548,ExpressionUUID->"f8d05f79-a571-45e9-8325-c1de0a6385d6"],

Cell[TextData[{
 StyleBox["Figure 3",
  FontWeight->"Bold"],
 ". A quantum circuit for the quantum Fourier transform."
}], "Caption",
 CellID->2092317985,ExpressionUUID->"443fa466-b581-4119-8411-30738c0be2cd"],

Cell[TextData[{
 "\tOverall, the quantum Fourier transform can be represented by the quantum \
circuit in Figure 3. By expanding each ",
 ButtonBox["controlled-power gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/ControlledPower"],
 " in Figure 3 in a product of ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/ControlledGate"],
 ", one can get an equivalent quantum circuit in Figure 4 for the quantum \
Fourier transform. This quantum circuit for the quantum Fourier \
transformation is found more commonly in the literature."
}], "Text",
 CellID->479591036,ExpressionUUID->"c9009317-0629-4e33-aac4-c40d52d3f569"],

Cell[TextData[Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {17, -1}}, {{0, -2}, {17, -2}}, {{0, -3}, {17, -3}}, {{
     0, -4}, {17, -4}}, {{0, -5}, {17, -5}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -4}, {4, -1}}], 
     DiskBox[{4, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -5}, {5, -1}}], 
     DiskBox[{5, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "5"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -3}, {7, -2}}], 
     DiskBox[{7, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -4}, {8, -2}}], 
     DiskBox[{8, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -5}, {9, -2}}], 
     DiskBox[{9, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {9., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -3.4}, {10.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {10., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{11, -4}, {11, -3}}], 
     DiskBox[{11, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -3.4}, {11.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {11., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{12, -5}, {12, -3}}], 
     DiskBox[{12, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{11.6, -3.4}, {12.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {12., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {13., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{14, -5}, {14, -4}}], 
     DiskBox[{14, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {14., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{14.6, -5.4}, {15.4, -4.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {15., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{15.6, -5.4}, {16.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {16., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->658.8000000000001,
   PlotRange->{{0, 17}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[5, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[5]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[5, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[4]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   Q3`ControlledGate[{$CellContext`S[5, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   $CellContext`S[4, 6], 
   Q3`ControlledGate[{$CellContext`S[5, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[5, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$], 
     $CellContext`S[
     5, Q3`$]}]]]],ExpressionUUID->"0ca71834-1874-477d-8628-87204dc18a19"]], \
"Picture",
 CellID->1374188068,ExpressionUUID->"757530df-d047-4ac4-9e2b-15911771c493"],

Cell[TextData[{
 StyleBox["Figure 4",
  FontWeight->"Bold"],
 ". A quantum circuit for the quantum Fourier transform using elementary \
gates. Here, each of the ",
 ButtonBox["controlled-power gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/ControlledPower"],
 " in Figure 3 is expanded in a product of ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/ControlledGate"],
 "."
}], "Caption",
 CellID->1066912687,ExpressionUUID->"541bdc19-f402-4950-9f4d-45b1640522b4"],

Cell[CellGroupData[{

Cell["Computational Complexity", "Subsection",
 CellID->954049670,ExpressionUUID->"f112b8f8-98b4-40ca-a728-c849a5a8456f"],

Cell[TextData[{
 "From the quantum circuits discussed above, we see that quantum Fourier \
transform requires an order of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "2"], TraditionalForm]],ExpressionUUID->
  "167df311-a63a-46ae-825f-ca7a5c546821"],
 " elementary gates. For example, consider the quantum circuit in Figure 4. \
There are ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "2e4c7518-2574-4b0f-8076-f28b0b70ecda"],
 " Hadamard gates, one for each qubit. The number of controlled-unitary gates \
is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"k", "=", "1"}], "n"], 
     RowBox[{"(", 
      RowBox[{"k", "-", "1"}], ")"}]}], "=", 
    RowBox[{
     RowBox[{"n", "(", 
      RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], TraditionalForm]],
  ExpressionUUID->"898b93cd-516b-4881-ae8a-0da7c0ab1e10"],
 ". There are ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "5a50850e-ac24-4029-8c76-514aa66f4068"],
 " SWAP gates as well, each of which requires three CNOT gates. Overall, we \
need ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"n", "(", 
      RowBox[{"n", " ", "+", " ", "4"}], ")"}], "/", "2"}], "\[Tilde]", 
    RowBox[{"O", "(", 
     SuperscriptBox["n", "2"], ")"}]}], TraditionalForm]],ExpressionUUID->
  "baebe5db-9396-4785-8648-ef7534301c26"],
 " gates. This computational load is compared to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", 
    RowBox[{"n", "\[VeryThinSpace]", 
     SuperscriptBox["2", "n"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "6fbc8e64-6c24-4ff5-8c45-289c1d873c36"],
 " gates for the fast Fourier transform (FFT), the best classical algorithm \
for the ",
 ButtonBox["discrete Fourier transform",
  BaseStyle->"Link",
  ButtonData->"paclet:ref/Fourier"],
 "."
}], "Text",
 CellID->721098022,ExpressionUUID->"9326876f-a52a-4cc1-b7f5-d8ecf7535b9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demonstration", "Subsection",
 CellID->1031420744,ExpressionUUID->"616d7587-541f-42aa-994c-4ccc6b566c1e"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[1102]:=",
 CellID->1772728377,ExpressionUUID->"d9db5a9b-d6b2-4c31-9695-c581a9175e80"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[1103]:=",
 CellID->1480056330,ExpressionUUID->"392d5b05-39a6-492e-a517-9e8e1f5f7220"],

Cell["\<\
Here, we simulate the quantum Fourier transform on a quantum register of 4 \
qubits.\
\>", "MathCaption",
 CellID->1926403282,ExpressionUUID->"58af45bc-3ac0-4143-b8e4-01f966dba0d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}]], "Input",
 CellLabel->"In[5]:=",
 CellID->1596498402,ExpressionUUID->"6ddde0eb-0895-45aa-944a-ac62bd476bbc"],

Cell["Take a quantum register.", "MathCaption",
 CellID->1819752051,ExpressionUUID->"507c3bfd-0a5c-4077-94ce-3f91da193495"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellLabel->"In[6]:=",
 CellID->1229313375,ExpressionUUID->"4a89e81a-2006-4abc-a35c-ccc048414548"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`S[4, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1452929120,ExpressionUUID->"086d1a64-f1be-429b-bf83-a64e510320ab"]
}, Open  ]],

Cell["Define the QFT operator.", "MathCaption",
 CellID->2032166571,ExpressionUUID->"71f577c7-1c6f-42f9-a39c-d6c1c247e663"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QFT", "[", "SS", "]"}]}]], "Input",
 CellLabel->"In[8]:=",
 CellID->1644145708,ExpressionUUID->"fcd12fab-c8ef-4b6a-abb8-132bef171ce7"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->325025497,ExpressionUUID->"90b59559-057a-4c33-8afa-92c81cc47cad"]
}, Open  ]],

Cell["\<\
For a reference, consider the quantum Fourier transform as a block unitary \
gate.\
\>", "MathCaption",
 CellID->1085445029,ExpressionUUID->"0213db0e-6fe3-44ee-a3cc-e8183b9a5880"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[9]:=",
 CellID->1212830196,ExpressionUUID->"b5402d18-9d59-416d-abfa-8a52f891e9e6"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QFT\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QFT[1, {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, False]]]], "Output",
 CellLabel->"Out[9]=",
 CellID->1970012534,ExpressionUUID->"50178a2e-2624-4832-82ee-edd1174fec37"]
}, Open  ]],

Cell["\<\
Now, construct the quantum circuit implementing the quantum Fourier transform.\
\>", "MathCaption",
 CellID->1696608454,ExpressionUUID->"7c9131e6-4b6c-4e60-811d-98b0aff72d80"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1a", "=", 
  RowBox[{"Expand", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[10]:=",
 CellID->824970465,ExpressionUUID->"3765dc43-7eb9-42db-bb07-bb590b29de10"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -4}, {2, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -4}, {4, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -4}, {6, -3}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, 
    $CellContext`S[1, 
     C[4]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, 
    $CellContext`S[2, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   Q3`ControlledPower[{
     $CellContext`S[4, Q3`$]}, 
    $CellContext`S[3, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[10]=",
 CellID->1716433731,ExpressionUUID->"2757f482-0671-4c85-924b-f387d079a11a"]
}, Open  ]],

Cell[TextData[{
 "In the above quantum circuit, the label ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "57583083-79a9-4112-b32e-595ae09900b0"],
 " denotes the relative phase shift by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", 
    RowBox[{"\[Pi]", "/", 
     SuperscriptBox["2", "k"]}]}], TraditionalForm]],ExpressionUUID->
  "35a0cc00-b9a8-43f7-a724-58da6df52193"],
 "; that is, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "k"], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        SuperscriptBox["e", 
         RowBox[{"2", "\[Pi]", "\[VeryThinSpace]\[VeryThinSpace]", 
          RowBox[{"\[ImaginaryI]", "/", 
           SuperscriptBox["2", "k"]}]}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "5e8a463c-8503-4473-8c32-1c5f4fbae9b4"],
 "."
}], "MathCaption",
 CellID->861360871,ExpressionUUID->"771db906-d7e2-4fdc-8cfc-6f0d52021c3d"],

Cell["Further expand each of the controlled-power gate.", "MathCaption",
 CellID->6216167,ExpressionUUID->"a8a71720-193e-4fa4-b2c0-e29fa62ff8ca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1b", "=", 
  RowBox[{"ExpandAll", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[11]:=",
 CellID->1343500228,ExpressionUUID->"9836b9fa-d370-4905-aa3b-65d900a895bc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -4}, {4, -1}}], 
     DiskBox[{4, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -2}}], 
     DiskBox[{6, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -4}, {7, -2}}], 
     DiskBox[{7, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -4}, {9, -3}}], 
     DiskBox[{9, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[4]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[3]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[11]=",
 CellID->1513621106,ExpressionUUID->"1442200e-2d33-4770-a695-e50fc55a98e8"]
}, Open  ]],

Cell["\<\
To verify the above quantum circuit model, compare its matrix representation \
with the matrix for the discrete Fourier transform.\
\>", "MathCaption",
 CellID->2097976484,ExpressionUUID->"460b22d8-c03a-44bb-8264-4d110781d70a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "qc1a", "]"}], "//", "TrigToExp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"FourierMatrix", "[", 
    RowBox[{"Power", "[", 
     RowBox[{"2", ",", "$n"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"new", "-", "mat"}], "//", "SimplifyThrough"}], "//", 
    "Flatten"}], ",", "0"}], "]"}]}], "Input",
 CellLabel->"In[12]:=",
 CellID->288131012,ExpressionUUID->"10ffc5d5-1b48-4bdc-9590-0dec064fa7ec"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[14]=",
 CellID->855371564,ExpressionUUID->"16bff20f-dfb3-49c7-be29-635f72e1cce8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "qc1b", "]"}], "//", "TrigToExp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"FourierMatrix", "[", 
    RowBox[{"Power", "[", 
     RowBox[{"2", ",", "$n"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"new", "-", "mat"}], "//", "SimplifyThrough"}], "//", 
    "Flatten"}], ",", "0"}], "]"}]}], "Input",
 CellLabel->"In[15]:=",
 CellID->894851094,ExpressionUUID->"3feef03a-0a75-45ee-b6f4-941cfe20f082"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[17]=",
 CellID->2038315794,ExpressionUUID->"7745a72b-05d6-47c5-a6e9-b71b688b08b4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Semiclassical Implementation", "Section",
 CellID->1845626348,ExpressionUUID->"76814999-978f-491d-b3c0-ae13b6030842"],

Cell["\<\
The semiclassical implementation is not only interesting from a physical \
point of view, but it is also extremely interesting given the current level \
of technology (Griffiths & Niu, 1996). Since it does not require any \
entanglement, a quantum information resource that is the most fragile and \
hence difficult to maintain, many experiments are using this implementation \
whenever the QFT and/or the quantum phase estimation is in need (Chiaverini, \
2005; Higgins et al., 2007).\
\>", "Text",
 CellID->1188233568,ExpressionUUID->"0285979e-58e5-4dbb-a907-c9d4f3f853ed"],

Cell["\<\
\tThe line of argument in the original work (Griffiths & Niu, 1996) to derive \
the semiclassical implementation of the quantum Fourier transformation is \
interesting in its own right, and it offers another physically-motivated \
derivation of the quantum Fourier transform algorithm. Here, Instead, we \
simply make use of the relation between the quantum Fourier transform and its \
inverse.\
\>", "Text",
 CellID->1191143923,ExpressionUUID->"3de5bf9e-85d3-4674-9777-dc5b8f32de1a"],

Cell["\tThe inverse quantum Fourier transform is given by", "Text",
 CellID->713356527,ExpressionUUID->"694187ff-c091-4ec6-8be7-01b3854c5737"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["U", "QFT", "\[Dagger]"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      UnderscriptBox["\[CapitalSigma]", "x"], 
      RowBox[{
       TemplateBox[{
         SubscriptBox["X", "x"]},
        "Ket"], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
         SubscriptBox["p", "y"]}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "e8972160-fcb4-47c2-be1c-71d621ec54a3"],
 ","
}], "Text",
 CellID->2129431735,ExpressionUUID->"dfc4c1ba-044c-44ae-89b0-c680abb1d3cd"],

Cell["which follows directly from the orthogonality relation", "Text",
 CellID->1544192890,ExpressionUUID->"4622149d-dadb-49d5-ae2c-06569e493598"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", "n"]], 
     RowBox[{
      UnderscriptBox["\[CapitalSigma]", "y"], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", "(", 
         RowBox[{"x", "-", 
          SuperscriptBox["x", "\[Prime]"]}], ")"}], 
        SubscriptBox["p", "y"]}]]}]}], "=", 
    SubscriptBox["\[Delta]", 
     RowBox[{"x", "\[VeryThinSpace]", 
      SuperscriptBox["x", "\[Prime]"]}]]}], TraditionalForm]],ExpressionUUID->
  "62f23ccc-dd14-4edc-9453-cd34eef6c21f"],
 "."
}], "Text",
 CellID->910028235,ExpressionUUID->"a73f8dd7-0e3b-40db-8fff-ddced1c402be"],

Cell["\<\
This expression for the inverse quantum Fourier transform suggests that the \
inverse quantum Fourier transform is just another form of the quantum Fourier \
transform, and indeed, this is a characteristic property common to any kind \
of Fourier transform. This implies that one can recover the original quantum \
Fourier transform from the inverse quantum Fourier transform, and vice versa, \
in several ways.\
\>", "Text",
 CellID->466011711,ExpressionUUID->"2b5e7726-22b3-4715-866c-f858e17461d1"],

Cell[TextData[{
 "\tFor example, note that  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["U", "QFT", "\[Dagger]"], 
    TemplateBox[{
      SubscriptBox["X", "y"]},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "1b748102-9e7c-4ec7-a96f-0764d947bcf7"],
 " is an element of the conjugate basis because "
}], "Text",
 CellID->385966168,ExpressionUUID->"1eb2c6c3-19c4-4985-beb5-99f64b5ee919"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "x", " ", 
      SubscriptBox["p", "y"]}]], "=", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "\[Pi]"}], "-", 
        SubscriptBox["p", "y"]}], ")"}]}]]}], TraditionalForm]],
  ExpressionUUID->"59a14564-0cd9-44e8-b6a5-b2a24a4f7982"],
 " "
}], "Text",
 CellID->1008799391,ExpressionUUID->"0e7555f1-7261-4e19-801d-5bd2de5532c9"],

Cell[TextData[{
 "for any ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "0cfb668e-bed3-4b2b-bbc7-c85c447040ea"],
 " and ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]],ExpressionUUID->
  "9fc39569-a584-4f6a-953d-5636e933efb5"],
 ". In fact, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["U", "QFT", "\[Dagger]"], 
     TemplateBox[{
       SubscriptBox["X", "y"]},
      "Ket"]}], "=", 
    TemplateBox[{
      SubscriptBox["P", 
       RowBox[{
         SuperscriptBox["2", "n"], "-", "y"}]]},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "409dd505-aa72-49c9-9d29-676e2694bcf7"],
 ". More useful in the context of the semiclassical implementation of the \
quantum Fourier transform is to note that the inverse quantum Fourier \
transform ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "QFT", "\[Dagger]"], TraditionalForm]],
  ExpressionUUID->"61ea4639-01f2-4ea8-8f82-4c12d135c0dd"],
 " is nothing but the quantum Fourier transform with the phase factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "x", " ", 
     SubscriptBox["p", "y"]}]], TraditionalForm]],ExpressionUUID->
  "b7811beb-8736-449f-9cc6-d16002a8f454"],
 " replaced by ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "x", " ", 
     SubscriptBox["p", "y"]}]], TraditionalForm]],ExpressionUUID->
  "ba42e2ca-db7f-4eb2-941d-14b9750c2b9e"],
 ". It corresponds to replacing the relative phase shifts ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "949ec5c5-863d-4e95-9c89-378b418d11c3"],
 " in Figure 4 by ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["Z", "k", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "4e836c51-1781-49d5-8083-fb88f1a0f43a"],
 ". Conversely, if we start with the quantum circuit in Figure 4, take its \
Hermitian conjugate (i.e., inverse), and replace ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["Z", "k", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "a213a0a3-c596-49f4-9f76-91937a9b4309"],
 " with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "c46b030e-43cc-4aa8-8f9e-cde418dafd15"],
 ", then we should recover the original quantum Fourier transform. Through \
this procedure, we get the quantum circuit in Figure 5 for the quantum \
Fourier transform."
}], "Text",
 CellID->245060466,ExpressionUUID->"f701e7e4-8b46-4462-beb8-b0471a961d97"],

Cell[TextData[Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -4}}], 
     DiskBox[{7, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -2}, {8, -4}}], 
     DiskBox[{8, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -3}, {9, -4}}], 
     DiskBox[{9, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[
     4, Q3`$]}]]]],ExpressionUUID->"e1e3e6fe-5e20-45ad-a9ac-95c982f8ae12"]], \
"Picture",
 CellID->2090695979,ExpressionUUID->"732cac94-810a-4abc-8651-938b1b522cde"],

Cell[TextData[{
 StyleBox["Figure 5",
  FontWeight->"Bold"],
 ". Another equivalent quantum circuit for quantum Fourier transform, where \
any Hadamard gate appears before the corresponding qubit ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "98adbdd2-7e8d-48c7-8adc-3704977f9f88"],
 " \[OpenCurlyDoubleQuote]controls\[CloseCurlyDoubleQuote] the phase shift ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "9f1cda56-fb22-4ae9-8c3b-e2b07b010e8a"],
 " on other qubits."
}], "Caption",
 CellID->1199886839,ExpressionUUID->"9faf1bd5-13ee-4cc8-8d06-9b2fa3d26202"],

Cell[TextData[{
 "Compared to the quantum circuit in Figure 4, the above quantum circuit in \
Figure 5 has its Hadamard gate on a fixed qubit coming before the qubit \
\[OpenCurlyDoubleQuote]controls\[CloseCurlyDoubleQuote] the operation of the \
relative phase shift ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "90ae8622-8106-4be4-b60d-c9143c0ca9ef"],
 " on other qubits. This difference brings a significant consequence. To make \
this clearer, we put measurements explicitly on the qubits as in Figure 6."
}], "Text",
 CellID->1494470790,ExpressionUUID->"b65d7cf5-9179-4b78-af6b-4043e0b82008"],

Cell[TextData[Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{12, -1}, {13, -1}}, {{12, -2}, {13, -2}}, {{12, -3}, {
      13, -3}}, {{12, -4}, {13, -4}}}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -4}}], 
     DiskBox[{7, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -2}, {8, -4}}], 
     DiskBox[{8, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {8., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -3}, {9, -4}}], 
     DiskBox[{9, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {9., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -1.4}, {12.4, -0.6}]}, 
      CircleBox[{12, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -1.2}, {12.24, -0.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, 
      CircleBox[{12, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -2.2}, {12.24, -1.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -3.4}, {12.4, -2.6}]}, 
      CircleBox[{12, -3.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -3.2}, {12.24, -2.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, 
      CircleBox[{12, -4.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -4.2}, {12.24, -3.76}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->514.8000000000001,
   PlotRange->{{0, 13}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}], 
   Q3`Measurement[{
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3], 
     $CellContext`S[
     4, 3]}]]]], \
"Output",ExpressionUUID->"83e83fa0-36a7-4eb5-9948-26a394eaf9a2"]], "Picture",
 CellID->432498188,ExpressionUUID->"fd7ca53b-9430-45da-a20f-d9f9b9c0ce52"],

Cell[TextData[{
 StyleBox["Figure 6",
  FontWeight->"Bold"],
 ". A quantum circuit equivalent to that in Figure 5, but with measurements \
displayed explicitly."
}], "Caption",
 CellID->183991796,ExpressionUUID->"e2689852-1089-49ee-a868-8c3aeacd176e"],

Cell["\<\
According to the principle of deferred measurement, the measurement can be \
performed before the controlled unitary gates as in Figure 7.\
\>", "Text",
 CellID->1746188333,ExpressionUUID->"1518fbf0-e92f-45ea-88ac-00259a30368f"],

Cell[TextData[Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{2, -1}, {15, -1}}, {{5, -2}, {15, -2}}, {{9, -3}, {
      15, -3}}, {{14, -4}, {15, -4}}}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {14, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     CircleBox[{2, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}, {
     LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     CircleBox[{5, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}, {
     LineBox[{{6, -1}, {6, -3}}], DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -3}}], 
     DiskBox[{7, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {7., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
     CircleBox[{9, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{9, -3.2}, {9.24, -2.76}}]}, {
     LineBox[{{10, -1}, {10, -4}}], DiskBox[{10, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{11, -2}, {11, -4}}], 
     DiskBox[{11, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {11., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{12, -3}, {12, -4}}], 
     DiskBox[{12, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {12., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {13., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, 
     CircleBox[{14, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{14, -4.2}, {14.24, -3.76}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->586.8000000000001,
   PlotRange->{{0, 15}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`Measurement[
    $CellContext`S[1, 3]], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   Q3`Measurement[
    $CellContext`S[2, 3]], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`Measurement[
    $CellContext`S[3, 3]], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`Measurement[
    $CellContext`S[
    4, 3]]]]],ExpressionUUID->"5e532fdf-7eb5-43ba-b905-bafb4fd5af38"]], \
"Picture",
 CellID->701997713,ExpressionUUID->"698c35b5-8ae5-4a89-9dd1-bd6662d59937"],

Cell[TextData[{
 StyleBox["Figure 7",
  FontWeight->"Bold"],
 ". A quantum circuit to implement quantum Fourier transform ",
 StyleBox["semiclassically",
  IgnoreSpellCheck->True],
 ". Note that the classical bit string from measurement outcomes needs to be \
reversed."
}], "Caption",
 CellID->1338980970,ExpressionUUID->"238cac73-d6a9-4b70-ab9e-01abbaa89f24"],

Cell["\<\
This form is exactly the quantum circuit derived in Griffiths & Niu (1996). \
The important point is that after the measurement, the controlled-unitary \
gates become just classical feedback controls that require no entanglement.\
\>", "Text",
 CellID->726276225,ExpressionUUID->"f67c4aa8-075e-45ac-a2eb-d2ff5e04d0e4"],

Cell[CellGroupData[{

Cell["Demonstration", "Subsection",
 CellID->204289853,ExpressionUUID->"1a8e8521-b853-4c28-90c3-318b8876f0f4"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[18]:=",
 CellID->432975153,ExpressionUUID->"2f073018-b231-4693-a72c-abb52664df4f"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[19]:=",
 CellID->538425044,ExpressionUUID->"c44a4684-f6ff-4c85-9981-770f51ec6857"],

Cell["\<\
Here, we simulate the semiclassical implementation of the quantum Fourier \
transform. Again, we consider a quantum register of four qubits.\
\>", "MathCaption",
 CellID->1649159624,ExpressionUUID->"6ecf26f5-4972-4a01-98f3-aed1be4fe340"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], ";"}]}], "Input",\

 CellLabel->"In[21]:=",
 CellID->72871740,ExpressionUUID->"e913998a-7429-46a4-ba9a-0e0a526dedee"],

Cell["\<\
Using the relation between the quantum Fourier transform and its inverse, one \
can construct another equivalent quantum circuit as follows. Here, the tilde \
accent emphasizes that the control qubits are in the reversed order.\
\>", "MathCaption",
 CellID->1795832665,ExpressionUUID->"c849435e-003f-4bfe-8532-bb20fd44f945"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2a", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{"op", ",", "\"\<Reversed\>\""}], "]"}]}]], "Input",
 CellLabel->"In[23]:=",
 CellID->2005468121,ExpressionUUID->"5a4a2f06-1793-4039-a3b1-307a01d6b483"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}, {4, -3}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -2}, {6, -1}, {6, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[2, 
     C[2]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[3, 
     C[3]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[4, 
     C[4]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[23]=",
 CellID->557441976,ExpressionUUID->"a4b4971f-686f-42c3-b14e-9e21521014fb"]
}, Open  ]],

Cell["Expand each of the controlled-power gates.", "MathCaption",
 CellID->1145423755,ExpressionUUID->"bad143b2-7d07-4d9c-ad51-05ebb683a557"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2b", "=", 
  RowBox[{"ExpandAll", "[", 
   RowBox[{"op", ",", "\"\<Reversed\>\""}], "]"}]}]], "Input",
 CellLabel->"In[24]:=",
 CellID->1538581204,ExpressionUUID->"5ab2b933-99a3-451a-91ef-4416b18d771a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -4}}], 
     DiskBox[{7, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -2}, {8, -4}}], 
     DiskBox[{8, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -3}, {9, -4}}], 
     DiskBox[{9, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[24]=",
 CellID->1630496338,ExpressionUUID->"54ff045c-14e5-4cd1-9a5c-d5802491e11b"]
}, Open  ]],

Cell["\<\
Verify the above quantum circuit model by comparing its matrix representation \
with the matrix for the discrete Fourier transform.\
\>", "MathCaption",
 CellID->1342942637,ExpressionUUID->"df7e1bc0-d714-4040-9e92-0f497b3c8fc7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "qc2a", "]"}], "//", "TrigToExp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"FourierMatrix", "[", 
    RowBox[{"Power", "[", 
     RowBox[{"2", ",", "$n"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"new", "-", "mat"}], "//", "SimplifyThrough"}], "//", 
    "Flatten"}], ",", "0"}], "]"}]}], "Input",
 CellLabel->"In[25]:=",
 CellID->783770089,ExpressionUUID->"e62f3cd1-5daa-44e8-b047-7a05b3e85936"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[27]=",
 CellID->2067185116,ExpressionUUID->"55b0562c-1ecb-40ca-934b-c0caccd36dfb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "qc2b", "]"}], "//", "TrigToExp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"FourierMatrix", "[", 
    RowBox[{"Power", "[", 
     RowBox[{"2", ",", "$n"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"new", "-", "mat"}], "//", "SimplifyThrough"}], "//", 
    "Flatten"}], ",", "0"}], "]"}]}], "Input",
 CellLabel->"In[28]:=",
 CellID->1764316411,ExpressionUUID->"52f00716-1a1d-4fba-97af-6e6b5862c9bd"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[30]=",
 CellID->1011195439,ExpressionUUID->"9a15f56b-a57b-4638-902c-6b30649fb680"]
}, Open  ]],

Cell["\<\
Pick an input state randomly from the computational basis, and include the \
measurements as well.\
\>", "MathCaption",
 CellID->68827890,ExpressionUUID->"7fbbab2b-3952-4c72-b999-d29c79c62580"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"Ket", "@@", 
   RowBox[{"Thread", "[", 
    RowBox[{"SS", "->", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", "$n"}], "]"}]}], 
    "]"}]}]}]], "Input",
 CellLabel->"In[31]:=",
 CellID->344851506,ExpressionUUID->"23c07413-dc90-451f-84c7-745862702d9f"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
          $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
          $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
          $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
     "RowWithSeparators"]},
   "Ket"],
  Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
    0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
    0|>]]], "Output",
 CellLabel->"Out[31]=",
 CellID->668028928,ExpressionUUID->"d2ebec70-d65b-4f6b-a853-42b3119a4d23"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc3", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"in", ",", "qc2b", ",", 
    RowBox[{"Measurement", "@", 
     RowBox[{"Through", "[", 
      RowBox[{"SS", "[", "3", "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[32]:=",
 CellID->413710622,ExpressionUUID->"d2672a3e-e1b1-4d2c-960f-0f7d54788b75"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{12, -1}, {13, -1}}, {{12, -2}, {13, -2}}, {{12, -3}, {
      13, -3}}, {{12, -4}, {13, -4}}}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {InsetBox[
      TemplateBox[{"1"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -3.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -4.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -4}}], 
     DiskBox[{7, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -2}, {8, -4}}], 
     DiskBox[{8, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {8., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -3}, {9, -4}}], 
     DiskBox[{9, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {9., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -1.4}, {12.4, -0.6}]}, 
      CircleBox[{12, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -1.2}, {12.24, -0.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, 
      CircleBox[{12, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -2.2}, {12.24, -1.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -3.4}, {12.4, -2.6}]}, 
      CircleBox[{12, -3.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -3.2}, {12.24, -2.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, 
      CircleBox[{12, -4.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -4.2}, {12.24, -3.76}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->514.8000000000001,
   PlotRange->{{0, 13}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]], 
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}], 
   Q3`Measurement[{
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3], 
     $CellContext`S[4, 3]}]]]], "Output",
 CellLabel->"Out[32]=",
 CellID->1035028918,ExpressionUUID->"90f80faf-4c35-4351-9ba4-3a24cd231c8e"]
}, Open  ]],

Cell["\<\
Convert the above quantum circuit to the form that is suitable for the \
semiclassical implementation of the quantum Fourier transform.\
\>", "MathCaption",
 CellID->1803885280,ExpressionUUID->"d4ab3101-82c7-48c9-b766-ce9faf69cfc0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc4", "=", 
  RowBox[{
   RowBox[{"Drop", "[", 
    RowBox[{"qc3", ",", 
     RowBox[{"-", "2"}]}], "]"}], "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"k_", ",", "6"}], "]"}], ":>", 
     RowBox[{"Sequence", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"k", ",", "6"}], "]"}], ",", 
       RowBox[{"Measurement", "[", 
        RowBox[{"S", "[", 
         RowBox[{"k", ",", "3"}], "]"}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellLabel->"In[33]:=",
 CellID->1906734127,ExpressionUUID->"1ab6b388-ddea-421d-8a83-65f4a2fef1b6"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{2, -1}, {15, -1}}, {{5, -2}, {15, -2}}, {{9, -3}, {
      15, -3}}, {{14, -4}, {15, -4}}}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {14, -4}}}], {InsetBox[
      TemplateBox[{"1"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -3.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -4.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     CircleBox[{2, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}, {
     LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     CircleBox[{5, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}, {
     LineBox[{{6, -1}, {6, -3}}], DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -3}}], 
     DiskBox[{7, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {7., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
     CircleBox[{9, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{9, -3.2}, {9.24, -2.76}}]}, {
     LineBox[{{10, -1}, {10, -4}}], DiskBox[{10, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{11, -2}, {11, -4}}], 
     DiskBox[{11, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {11., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{12, -3}, {12, -4}}], 
     DiskBox[{12, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {12., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {13., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, 
     CircleBox[{14, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{14, -4.2}, {14.24, -3.76}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->586.8000000000001,
   PlotRange->{{0, 15}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]], 
   $CellContext`S[1, 6], 
   Q3`Measurement[
    $CellContext`S[1, 3]], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   Q3`Measurement[
    $CellContext`S[2, 3]], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`Measurement[
    $CellContext`S[3, 3]], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`Measurement[
    $CellContext`S[4, 3]]]]], "Output",
 CellLabel->"Out[33]=",
 CellID->676632140,ExpressionUUID->"87e0d5fe-e385-424e-bdc1-3078ddcfa090"]
}, Open  ]],

Cell["\<\
To verify the equivalence of the two quantum circuit models, we compare the \
probability distributions.\
\>", "MathCaption",
 CellID->2071821703,ExpressionUUID->"c66f9a57-961c-41d7-97d9-0d8984fdc1d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"data1", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Elaborate", "[", "qc3", "]"}], ";", 
       RowBox[{"FromDigits", "[", 
        RowBox[{
         RowBox[{"Readout", "@", 
          RowBox[{"Through", "[", 
           RowBox[{"SS", "[", "3", "]"}], "]"}]}], ",", "2"}], "]"}]}], ",", 
      RowBox[{"{", "500", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->"In[34]:=",
 CellID->1287687905,ExpressionUUID->"4e310d5e-69d5-412c-b5bc-b700ab31d2e0"],

Cell[BoxData["44.140899`"], "EchoTiming",
 CellID->1832203493,ExpressionUUID->"4aa57731-7bd9-4971-9258-13eac087f67c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"data1", ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Measurement Outcome\>\"", ",", "\"\<Counts\>\""}], 
     "}"}]}]}], "]"}]], "Input",
 CellLabel->"In[35]:=",
 CellID->585052629,ExpressionUUID->"62924f7e-2af9-43de-bd2e-7b2d76d045d1"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.574], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.574], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 27.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{75.0576171875, 
           105.9571533203125}, {-69.96423732002089, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 27]& ,
        TagBoxNote->"27"],
       StyleBox["27", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[27, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 43.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{105.4571533203125, 
           136.356689453125}, {-184.76158039096927`, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 43]& ,
        TagBoxNote->"43"],
       StyleBox["43", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[43, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{1.5, 0}, {2.5, 40.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{135.856689453125, 
           166.7562255859375}, {-163.23707856516646`, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 40]& ,
        TagBoxNote->"40"],
       StyleBox["40", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[40, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{2.5, 0}, {3.5, 18.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{166.2562255859375, 
           197.15576171875}, {-5.390731842612439, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 18]& ,
        TagBoxNote->"18"],
       StyleBox["18", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[18, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{3.5, 0}, {4.5, 38.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{196.65576171875, 
           227.5552978515625}, {-148.8874106812979, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 38]& ,
        TagBoxNote->"38"],
       StyleBox["38", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[38, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{4.5, 0}, {5.5, 29.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{227.0552978515625, 
           257.954833984375}, {-84.31390520388945, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 29]& ,
        TagBoxNote->"29"],
       StyleBox["29", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[29, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{5.5, 0}, {6.5, 33.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{257.454833984375, 
           288.3543701171875}, {-113.01324097162654`, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 33]& ,
        TagBoxNote->"33"],
       StyleBox["33", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[33, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{6.5, 0}, {7.5, 33.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{287.8543701171875, 
           318.75390625}, {-113.01324097162654`, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 33]& ,
        TagBoxNote->"33"],
       StyleBox["33", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[33, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{7.5, 0}, {8.5, 25.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{318.25390625, 
           349.1534423828125}, {-55.61456943615235, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 25]& ,
        TagBoxNote->"25"],
       StyleBox["25", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[25, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{8.5, 0}, {9.5, 38.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{348.6534423828125, 
           379.552978515625}, {-148.8874106812979, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 38]& ,
        TagBoxNote->"38"],
       StyleBox["38", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[38, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{9.5, 0}, {10.5, 31.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{379.052978515625, 
           409.9525146484375}, {-98.66357308775798, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 31]& ,
        TagBoxNote->"31"],
       StyleBox["31", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[31, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{10.5, 0}, {11.5, 30.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{409.4525146484375, 
           440.35205078125}, {-91.4887391458237, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 30]& ,
        TagBoxNote->"30"],
       StyleBox["30", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[30, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{11.5, 0}, {12.5, 28.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{439.85205078125, 
           470.7515869140625}, {-77.13907126195517, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 28]& ,
        TagBoxNote->"28"],
       StyleBox["28", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[28, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{12.5, 0}, {13.5, 33.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{470.2515869140625, 
           501.151123046875}, {-113.01324097162654`, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 33]& ,
        TagBoxNote->"33"],
       StyleBox["33", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[33, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{13.5, 0}, {14.5, 32.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{500.651123046875, 
           531.5506591796875}, {-105.83840702969226`, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 32]& ,
        TagBoxNote->"32"],
       StyleBox["32", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[32, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{14.5, 0}, {15.5, 22.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{531.0506591796875, 
           561.9501953125}, {-34.09006761034951, 124.25627911220451`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 22]& ,
        TagBoxNote->"22"],
       StyleBox["22", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[22, {}], 
       "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.8200000000000001, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{
     FormBox[
      TagBox["\"Counts\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"Measurement Outcome\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  PlotRange->{{-0.5, 15.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[35]=",
 CellID->1076092518,ExpressionUUID->"3af75115-c4b4-442d-9583-682519098c1e"]
}, Open  ]],

Cell["\<\
Note that the bit strings of the measurement outcomes from the semiclassical \
model must be reversed .\
\>", "MathCaption",
 CellID->1935282369,ExpressionUUID->"7ff2bfce-7b51-45bc-8e89-a5b85e1491a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"data2", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ExpressionFor", "[", "qc4", "]"}], ";", 
       RowBox[{"FromDigits", "[", 
        RowBox[{
         RowBox[{"Reverse", "@", 
          RowBox[{"Readout", "@", 
           RowBox[{"Through", "[", 
            RowBox[{"SS", "[", "3", "]"}], "]"}]}]}], ",", "2"}], "]"}]}], ",", 
      RowBox[{"{", "500", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->"In[36]:=",
 CellID->1278110699,ExpressionUUID->"1ab562a0-1b8a-404c-bf5a-86ddc50e2c2e"],

Cell[BoxData["11.847836`"], "EchoTiming",
 CellID->1927158639,ExpressionUUID->"7e617a2c-799c-404c-9ea9-c35af1876138"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{"data2", ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Measurement Outcome\>\"", ",", "\"\<Counts\>\""}], 
     "}"}]}]}], "]"}]], "Input",
 CellLabel->"In[37]:=",
 CellID->1295721444,ExpressionUUID->"a1426c3e-6853-4284-bac4-a47b5f52e619"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.574], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.574], Thickness[Small]}], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{-0.5, 0}, {0.5, 32.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{75.0576171875, 
           105.9571533203125}, {-136.04823415362608`, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 32]& ,
        TagBoxNote->"32"],
       StyleBox["32", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[32, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{0.5, 0}, {1.5, 38.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{105.4571533203125, 
           136.356689453125}, {-184.7615803909693, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 38]& ,
        TagBoxNote->"38"],
       StyleBox["38", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[38, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{1.5, 0}, {2.5, 31.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{135.856689453125, 
           166.7562255859375}, {-127.92934311406881`, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 31]& ,
        TagBoxNote->"31"],
       StyleBox["31", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[31, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{2.5, 0}, {3.5, 35.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{166.2562255859375, 
           197.15576171875}, {-160.40490727229763`, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 35]& ,
        TagBoxNote->"35"],
       StyleBox["35", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[35, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{3.5, 0}, {4.5, 38.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{196.65576171875, 
           227.55529785156247`}, {-184.7615803909693, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 38]& ,
        TagBoxNote->"38"],
       StyleBox["38", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[38, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{4.5, 0}, {5.5, 35.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{227.05529785156247`, 
           257.954833984375}, {-160.40490727229763`, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 35]& ,
        TagBoxNote->"35"],
       StyleBox["35", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[35, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{5.5, 0}, {6.5, 26.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{257.454833984375, 
           288.3543701171875}, {-87.33488791628281, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 26]& ,
        TagBoxNote->"26"],
       StyleBox["26", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[26, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{6.5, 0}, {7.5, 27.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{287.8543701171875, 
           318.75390625}, {-95.45377895584002, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 27]& ,
        TagBoxNote->"27"],
       StyleBox["27", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[27, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{7.5, 0}, {8.5, 37.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{318.25390625, 
           349.15344238281244`}, {-176.64268935141212`, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 37]& ,
        TagBoxNote->"37"],
       StyleBox["37", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[37, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{8.5, 0}, {9.5, 35.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{348.65344238281244`, 
           379.55297851562494`}, {-160.40490727229763`, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 35]& ,
        TagBoxNote->"35"],
       StyleBox["35", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[35, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{9.5, 0}, {10.5, 21.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{379.05297851562494`, 
           409.95251464843744`}, {-46.74043271849678, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 21]& ,
        TagBoxNote->"21"],
       StyleBox["21", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[21, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{10.5, 0}, {11.5, 31.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{409.45251464843744`, 
           440.35205078124994`}, {-127.92934311406881`, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 31]& ,
        TagBoxNote->"31"],
       StyleBox["31", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[31, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{11.5, 0}, {12.5, 32.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{439.85205078124994`, 
           470.75158691406244`}, {-136.04823415362608`, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 32]& ,
        TagBoxNote->"32"],
       StyleBox["32", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[32, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{12.5, 0}, {13.5, 33.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{470.25158691406244`, 
           501.15112304687494`}, {-144.16712519318327`, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 33]& ,
        TagBoxNote->"33"],
       StyleBox["33", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[33, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{13.5, 0}, {14.5, 29.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{500.65112304687494`, 
           531.5506591796875}, {-111.69156103495442`, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 29]& ,
        TagBoxNote->"29"],
       StyleBox["29", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[29, {}], "Tooltip"]& ], 
     TagBox[
      TooltipBox[
       TagBox[
        TagBox[
         DynamicBox[{
           FEPrivate`If[
            CurrentValue["MouseOver"], 
            EdgeForm[{
              GrayLevel[0.5], 
              AbsoluteThickness[1.5], 
              Opacity[0.66]}], {}, {}], 
           RectangleBox[{14.5, 0}, {15.5, 20.}, "RoundingRadius" -> 0]},
          
          ImageSizeCache->{{531.0506591796875, 
           561.9501953125}, {-38.62154167893959, 124.25627911220448`}}],
         "DelayedMouseEffectStyle"],
        StatusArea[#, 20]& ,
        TagBoxNote->"20"],
       StyleBox["20", {}, StripOnInput -> False]],
      Annotation[#, 
       Style[20, {}], 
       "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{-0.8200000000000001, 0},
  AxesStyle->Large,
  Frame->True,
  FrameLabel->{{
     FormBox[
      TagBox["\"Counts\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"Measurement Outcome\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  PlotRange->{{-0.5, 15.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {None, 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[37]=",
 CellID->1406881619,ExpressionUUID->"15d06d50-7f8e-4bc1-8bf4-2c1003f57005"]
}, Open  ]],

Cell["\<\
The discrepancy between the two distributions is due to the finite sample \
size.\
\>", "MathCaption",
 CellID->1424295448,ExpressionUUID->"0610464c-d833-4180-bc8a-6ec2e135b812"],

Cell[CellGroupData[{

Cell["\t", "Text", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->1398946391,ExpressionUUID->"ece0f5ce-6783-4d86-942a-3933f606d071"],

Cell["\<\
Another way to test the equivalence of the fully quantum and semiclassical \
implementation of the quantum Fourier transform is to randomly take an input \
state that ends up in a product state.\
\>", "MathCaption",
 CellID->1323225536,ExpressionUUID->"db044eb0-9f52-44c3-be75-8dffddd9d1a9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vecs", "=", 
   RowBox[{
    RowBox[{"FourierMatrix", "[", 
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{"2", ",", "$n"}], "]"}], ",", 
      RowBox[{"FourierParameters", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], ".", 
    RowBox[{"Basis", "[", "SS", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "=", 
  RowBox[{"RandomChoice", "[", "vecs", "]"}]}]}], "Input",
 CellLabel->"In[42]:=",
 CellID->1882411498,ExpressionUUID->"f97d24ab-b46c-4ec5-9f0c-f9554e65f89a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellLabel->"Out[43]=",
 CellID->707533424,ExpressionUUID->"999bc6bd-0c6a-4d40-92bb-a964bde5d69e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"ExpandAll", "[", 
     RowBox[{"op", ",", "\"\<Reversed\>\""}], "]"}], ",", 
    RowBox[{"Measurement", "[", 
     RowBox[{"Through", "[", 
      RowBox[{"SS", "[", "3", "]"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[52]:=",
 CellID->733665627,ExpressionUUID->"518d430b-c6af-4064-82de-6466b8a2e950"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{12, -1}, {13, -1}}, {{12, -2}, {13, -2}}, {{12, -3}, {
      13, -3}}, {{12, -4}, {13, -4}}}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -4}}], 
     DiskBox[{7, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -2}, {8, -4}}], 
     DiskBox[{8, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {8., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -3}, {9, -4}}], 
     DiskBox[{9, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {9., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -1.4}, {12.4, -0.6}]}, 
      CircleBox[{12, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -1.2}, {12.24, -0.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, 
      CircleBox[{12, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -2.2}, {12.24, -1.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -3.4}, {12.4, -2.6}]}, 
      CircleBox[{12, -3.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -3.2}, {12.24, -2.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, 
      CircleBox[{12, -4.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -4.2}, {12.24, -3.76}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->514.8000000000001,
   PlotRange->{{0, 13}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}], 
   Q3`Measurement[{
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3], 
     $CellContext`S[4, 3]}]]]], "Output",
 CellLabel->"Out[52]=",
 CellID->842613166,ExpressionUUID->"f5f1993e-8a88-490f-b217-28034ec6da3b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"in", ",", 
      RowBox[{"\"\<Label\>\"", "\[Rule]", 
       TemplateBox[{"\"in\""},
        "Ket"]}]}], "}"}], ",", "qc", ",", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"1.2", ",", "0.5"}], "}"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[55]:=",
 CellID->1535297063,ExpressionUUID->"26cc299e-9e1a-4191-a609-75ab4c098fed"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{12, -1}, {13, -1}}, {{12, -2}, {13, -2}}, {{12, -3}, {
      13, -3}}, {{12, -4}, {13, -4}}}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {{
      BSplineCurveBox[{{-0.6000000000000001, -2.5}, {-0.4, -2.4}, {-0.4, \
-2.3}, {-0.4, -1.2}, {-0.4, -1.1}, {-0.2, -1.}}], 
      BSplineCurveBox[{{-0.6000000000000001, -2.5}, {-0.4, -2.6}, {-0.4, \
-2.7}, {-0.4, -3.8}, {-0.4, -3.9}, {-0.2, -4.}}]}, InsetBox[
      TemplateBox[{"\"in\""},
       "Ket"], {-0.8, -2.5}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -4}}], 
     DiskBox[{7, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -2}, {8, -4}}], 
     DiskBox[{8, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {8., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -3}, {9, -4}}], 
     DiskBox[{9, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {9., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03076923076923077],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -1.4}, {12.4, -0.6}]}, 
      CircleBox[{12, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -1.2}, {12.24, -0.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -2.4}, {12.4, -1.6}]}, 
      CircleBox[{12, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -2.2}, {12.24, -1.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -3.4}, {12.4, -2.6}]}, 
      CircleBox[{12, -3.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -3.2}, {12.24, -2.76}}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, 
      CircleBox[{12, -4.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{12, -4.2}, {12.24, -3.76}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{45.36, 20.160000000000004`}, {7.2, 7.2}},
   ImageSize->529.1999999999999,
   PlotRange->{{0, 13}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[{
    Rational[1, 4] 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[3, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>] + 
     Complex[0, 
        Rational[-1, 4]] 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[1, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>] + 
     Rational[-1, 4] 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[-1, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>] + 
     Complex[0, 
        Rational[1, 4]] 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[-3, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>] + 
     Rational[1, 4] 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[3, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>] + 
     Complex[0, 
        Rational[-1, 4]] 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[1, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>] + 
     Rational[-1, 4] 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[-1, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>] + 
     Complex[0, 
        Rational[1, 4]] 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[-3, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>], 
     "Label" -> Ket[{"in"}]}], 
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}], 
   Q3`Measurement[{
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3], 
     $CellContext`S[4, 3]}], "PortSize" -> {1.2, 0.5}]]], "Output",
 CellLabel->"Out[55]=",
 CellID->1970411483,ExpressionUUID->"0c371a96-34b7-41aa-ad65-2daefa083f3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{
   RowBox[{"qc1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"_Measurement", "->", "Nothing"}], ",", 
      RowBox[{"_SWAP", "->", "Nothing"}]}], "}"}]}], "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"k_", ",", "6"}], "]"}], ":>", 
     RowBox[{"Sequence", "[", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"k", ",", "6"}], "]"}], ",", 
       RowBox[{"Measurement", "[", 
        RowBox[{"S", "[", 
         RowBox[{"k", ",", "3"}], "]"}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}]}]], "Input",
 CellLabel->"In[56]:=",
 CellID->1024108386,ExpressionUUID->"962897ef-4b72-4d75-852c-a344507cd62a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{2, -1}, {16, -1}}, {{5, -2}, {16, -2}}, {{9, -3}, {
      16, -3}}, {{14, -4}, {16, -4}}}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {14, -4}}}], {{
      BSplineCurveBox[{{-0.6000000000000001, -2.5}, {-0.4, -2.4}, {-0.4, \
-2.3}, {-0.4, -1.2}, {-0.4, -1.1}, {-0.2, -1.}}], 
      BSplineCurveBox[{{-0.6000000000000001, -2.5}, {-0.4, -2.6}, {-0.4, \
-2.7}, {-0.4, -3.8}, {-0.4, -3.9}, {-0.2, -4.}}]}, InsetBox[
      TemplateBox[{"\"in\""},
       "Ket"], {-0.8, -2.5}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, 
     CircleBox[{2, -1.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{2, -1.2}, {2.24, -0.76}}]}, {
     LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
     CircleBox[{5, -2.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}, {
     LineBox[{{6, -1}, {6, -3}}], DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -3}}], 
     DiskBox[{7, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {7., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
     CircleBox[{9, -3.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{9, -3.2}, {9.24, -2.76}}]}, {
     LineBox[{{10, -1}, {10, -4}}], DiskBox[{10, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{11, -2}, {11, -4}}], 
     DiskBox[{11, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {11., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{12, -3}, {12, -4}}], 
     DiskBox[{12, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{11.6, -4.4}, {12.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {12., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {13., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, 
     CircleBox[{14, -4.2}, 0.4, 
      NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
       2.6179938779914944`}]], LineBox[{{14, -4.2}, {14.24, -3.76}}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{14.6, -4.4}, {15.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.025],
       FontWeight->"Light",
       FontSlant->Italic], {15., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{45.36, 20.160000000000004`}, {7.2, 7.2}},
   ImageSize->637.1999999999999,
   PlotRange->{{0, 16}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[{
    Rational[1, 4] 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[3, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>] + 
     Complex[0, 
        Rational[-1, 4]] 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[1, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>] + 
     Rational[-1, 4] 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[-1, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>] + 
     Complex[0, 
        Rational[1, 4]] 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[-3, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>] + 
     Rational[1, 4] 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[3, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>] + 
     Complex[0, 
        Rational[-1, 4]] 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[1, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>] + 
     Rational[-1, 4] 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[-1, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>] + 
     Complex[0, 
        Rational[1, 4]] 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>] + 
     Rational[1, 4] E^(Complex[0, 
          Rational[-3, 4]] Pi) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>], 
     "Label" -> Ket[{"in"}]}], 
   $CellContext`S[1, 6], 
   Q3`Measurement[
    $CellContext`S[1, 3]], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   Q3`Measurement[
    $CellContext`S[2, 3]], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`Measurement[
    $CellContext`S[3, 3]], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`Measurement[
    $CellContext`S[4, 3]], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}], Nothing, "PortSize" -> {1.2, 0.5}]]], "Output",\

 CellLabel->"Out[56]=",
 CellID->779805936,ExpressionUUID->"6055ac7b-39c9-4fb4-93d1-8c468877592f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out1", "=", 
  RowBox[{"ExpressionFor", "[", "qc1", "]"}]}]], "Input",
 CellLabel->"In[57]:=",
 CellID->1469523285,ExpressionUUID->"fa0a0acb-f5b1-4b5c-9d39-a928fd8463dd"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
          $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
          $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
          $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
     "RowWithSeparators"]},
   "Ket"],
  Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
    0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
    0|>]]], "Output",
 CellLabel->"Out[57]=",
 CellID->516106542,ExpressionUUID->"f748f3c9-6beb-4582-9040-8d5bea71ef1d"]
}, Open  ]],

Cell["\<\
Again, recall that the order of qubits are reversed in the semiclassical \
implementation.\
\>", "MathCaption",
 CellID->1980347370,ExpressionUUID->"8b5de8a8-ec7b-437b-8abe-c4c49ca60a68"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out2", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", "qc2", "]"}], "//", "Chop"}]}]], "Input",
 CellLabel->"In[58]:=",
 CellID->1806758675,ExpressionUUID->"52a57538-2318-4b43-beef-43b8ada31029"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
          $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
      SubscriptBox["1", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
          $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
      SubscriptBox["0", 
       TemplateBox[{",", "\",\"", 
         InterpretationBox[
          SubscriptBox["S", 
           TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
          $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
     "RowWithSeparators"]},
   "Ket"],
  Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
    0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
    0|>]]], "Output",
 CellLabel->"Out[58]=",
 CellID->20105873,ExpressionUUID->"0e329c62-0e8c-4cc0-83a5-702b973439c4"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/guide/QuantumInformationSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "49275fa8-1786-4026-9e1c-441c9acde8c1"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[TextData[ButtonBox["Q3",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3S/guide/Q3"]], "TutorialMoreAbout",
         ExpressionUUID->"ce19a995-c08e-4c93-aacc-00be689412e3"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"5f30abed-7318-40a9-93c3-\
a65f12771f02"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Fourier Transform: Semiclassical Implementation",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/\
QuantumFourierTransformSemiclassical"]], "RelatedTutorials",ExpressionUUID->
         "bf07b1a2-e79b-44db-a3c2-12fd36024ae7"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Phase Estimation",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuantumPhaseEstimation"]], 
         "RelatedTutorials",ExpressionUUID->
         "9ed47515-c6dc-4974-ad92-085e23b90268"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Algorithms",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3S/tutorial/QuantumAlgorithms"]], 
         "RelatedTutorials",ExpressionUUID->
         "c81353c6-3c99-4b70-9273-b1047f00a08a"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "QuantumCircuit Usage Examples",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3S/tutorial/QuantumCircuitUsage"]], 
         "RelatedTutorials",ExpressionUUID->
         "0cdeba52-53b1-4252-b50f-5fa0dcbbbf20"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "f6cb8c89-ea9c-4449-aa12-9fa91238fead"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quick Quantum Computing with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuickQuantumComputingWithQ3"]], 
         "RelatedTutorials",ExpressionUUID->
         "929555e2-ac66-49c5-93ec-bf071c0f3d0d"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"8b5a4e56-01d7-4481-9c97-\
3f42ebfe243d"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "A. Y. Kitaev, Electronic Colloquium on Computational \
Complexity 3, 3 (1996)"}]]]], "http://arxiv.org/abs/quant-ph/9511026"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "42c5e31a-788e-4a57-afe6-a23b7165248e"]}]],ExpressionUUID->
         "fbc04453-4059-4747-8e62-65c89c8dd485"],
        ", \[OpenCurlyDoubleQuote]Quantum Measurements and the Abelian \
Stabilizer Problem.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "95d8191a-34ed-43c9-b8ed-e0b4e566c7dd"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "R. B. Griffiths and C.-S. Niu, Physical Review Letters 76 \
(17), 3228 (1996)"}]]]], "https://doi.org/10.1103/physrevlett.76.3228"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "cda84784-7067-4740-917d-af78a03fff45"]}]],ExpressionUUID->
         "100c40ac-99db-4d3f-9d2f-4ef42aa7fd4d"],
        ", \[OpenCurlyDoubleQuote]Semiclassical Fourier Transform for Quantum \
Computation.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "e6f53c06-b40a-4cfe-8e82-c7b54161e9e4"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "J. Chiaverini "}]]]], 
             "https://doi.org/10.1126%2Fscience.1110335"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "69992b57-0b6b-46ae-b70b-ad49c228b295"]}]],ExpressionUUID->
         "f58af975-a219-4e24-8fc3-d0762f2f6664"],
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData[
             StyleBox[{
               StyleBox["et al", FontSlant -> "Italic"], 
               "., Science 308 (5724), 997 (2005)"}]]], 
           "https://doi.org/10.1126%2Fscience.1110335"},
          "WebLink",
          BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
         "c3422477-2939-42a3-b5c0-be901b847c1c"],
        ", \[OpenCurlyDoubleQuote]Implementation of the Semiclassical Quantum \
Fourier Transform in a Scalable System.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "d6b0e241-b305-4289-b23b-05c10213c32c"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "B. L. Higgins, D. W. Berry, S. D. Bartlett, H. M. Wiseman, \
& G. J. Pryde, Nature 450 (7168), 393 (2007)"}]]]], 
             "https://doi.org/10.1038/nature06257"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "d3258f7a-ed9b-4689-a792-f0e1b14c2c76"]}]],ExpressionUUID->
         "4173b3fe-b24d-4ba9-980f-41668400519a"],
        ", \[OpenCurlyDoubleQuote]Entanglement-free Heisenberg-limited phase \
estimation.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "6e464b0f-fb3c-4904-ab65-f54695aebf3f"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "Hermann Weyl (1931)"}]]]],
              "https://www.google.com/books/edition/_/jQbEcDDqGb8C?hl=en"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "6df994c7-0c7e-4969-bd4e-7ef22ebd7eeb"]}]],ExpressionUUID->
         "e1df69cf-78f7-434a-ad1a-f118346006f9"],
        ", The theory of groups and quantum mechanics (Dover, 1931)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "e31d7551-b6f0-49af-ba78-2836ac03f726"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "354cd59f-bb24-4644-bcdd-34d4ab41a8df"]}]],ExpressionUUID->
         "9f74b626-180d-4c3c-aded-7ad9a4a73e61"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "7d83400c-cea8-4bf3-9a77-22cb5ff42e03"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "f97f7b5b-c4f6-473c-8c08-f5ce54382957"]}]],ExpressionUUID->
         "f6f0ed81-4880-424a-b42c-f89c3f1f6195"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "dbdb0338-28f6-40c3-9b74-850db2f8a9b3"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"9bbf0635-b3ea-4420-b1ea-\
1c3ffb49f821"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"0cfb84cd-3341-4c10-b094-4b7a2a6075fe"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Quantum Fourier Transform",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", "2022"}, 
  "ShowCitation" -> False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 3, 2, 21, 34, 52.240281}", 
    "history" -> {"12", "13.2", "", ""}, "context" -> "QuantumMob`Q3S`", 
    "keywords" -> {"quantum Fourier transform", "quantum algorithm"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Quantum Mob/ Q3S Tutorial", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3S", "status" -> "None", "summary" -> 
    "See also Section 4.3 of the Quantum Workbook (2022). The quantum Fourier \
transform is a unitary transformation of quantum states. It is analogous to \
the discrete Fourier transform of a finite set of numbers. In the case of the \
quantum Fourier transform, the numbers are replaced with quantum states. The \
quantum Fourier transform can be performed efficiently on a quantum computer \
consisting of n qubits with only O(n^2) elementary quantum gate operations, \
compared to O(n 2^n) gates for the best known classical algorithm for a \
discrete Fourier transform. This exponential speedup in the quantum Fourier \
transform algorithm relative to the classical counterpart enabled the \
celebrated quantum factorization algorithm to achieve a similar efficiency.", 
    "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "Quantum Fourier Transform", "titlemodifier" -> "", "metadescription" -> 
    "", "windowtitle" -> "Quantum Fourier Transform", "type" -> "Tutorial", 
    "uri" -> "QuantumMob/Q3S/tutorial/QuantumFourierTransform"}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.2 for Mac OS X ARM (64-bit) (December 26, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"25f570df-59c4-4b46-b94b-ee3d2f91efb6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[593, 21, 7310, 174, 50, "AnchorBarGrid",ExpressionUUID->"9db5a958-563f-4fd8-86f0-f7fd85df4a2b",
 CellID->1],
Cell[CellGroupData[{
Cell[7928, 199, 117, 1, 62, "Title",ExpressionUUID->"632da24f-94f3-42ed-8779-09e47ef71a5d",
 CellID->509267359],
Cell[8048, 202, 3577, 80, 68, "TutorialJumpBox",ExpressionUUID->"8b7768e8-8761-4871-9d07-cbfb30f1b165"],
Cell[11628, 284, 400, 13, 34, "Text",ExpressionUUID->"ab227918-b61e-46da-a398-95b487931509",
 CellID->1308734266],
Cell[12031, 299, 352, 6, 57, "Text",ExpressionUUID->"59a29ca2-12bb-42a4-bc4d-10edc5f31cc3",
 CellID->1636777126],
Cell[12386, 307, 1019, 24, 104, "Text",ExpressionUUID->"826227d5-7d9b-4bcd-8087-4b105222cbd6",
 CellID->47638612],
Cell[13408, 333, 743, 11, 149, "Text",ExpressionUUID->"1ca70f57-ecfe-4252-a5c2-a4d44bd3fcf3",
 CellID->1798235200],
Cell[14154, 346, 1175, 30, 118, "DefinitionBox",ExpressionUUID->"f921e9b1-bd6c-42cd-97fb-862b14568e4c",
 CellID->2066146172],
Cell[15332, 378, 148, 1, 35, "Caption",ExpressionUUID->"285e93df-bbf4-4ee2-bdd9-a88681fa261b",
 CellID->908140814],
Cell[15483, 381, 194, 4, 35, "MathCaption",ExpressionUUID->"f841e68d-7ec5-4d86-9a4c-3c63a8bdcbfd",
 CellID->1428640008],
Cell[15680, 387, 177, 3, 28, "Input",ExpressionUUID->"3d6d4927-0294-4af7-a7ea-20c6afa3bd32",
 CellID->853967906],
Cell[15860, 392, 310, 6, 55, "MathCaption",ExpressionUUID->"6083d8f6-cc45-4525-8d8e-274094b470d2",
 CellID->1937193009],
Cell[16173, 400, 269, 6, 45, "Input",ExpressionUUID->"dfc8f58f-c26a-4af5-9ff4-6762cc2f47b2",
 CellID->403330096],
Cell[CellGroupData[{
Cell[16467, 410, 105, 1, 69, "Section",ExpressionUUID->"c1d3d316-d3d3-431f-809b-e901e7bcb40b",
 CellID->1875748448],
Cell[16575, 413, 291, 5, 70, "Text",ExpressionUUID->"ce8d7de7-7e85-4e80-9100-c7eb4402e224",
 CellID->644227576],
Cell[16869, 420, 583, 20, 70, "Text",ExpressionUUID->"50940291-3f1f-41d6-b926-2e57a6f86b57",
 CellID->2067805305],
Cell[17455, 442, 1046, 33, 70, "Text",ExpressionUUID->"80d83813-d970-482b-8ad5-dd93e1389007",
 CellID->875901734],
Cell[18504, 477, 203, 4, 70, "Text",ExpressionUUID->"f9ad5f06-008b-4de0-91cf-6c1f365a6b7b",
 CellID->280043153],
Cell[18710, 483, 820, 28, 70, "Text",ExpressionUUID->"9958b59b-6473-46d5-a406-85b48433a44a",
 CellID->1548601894],
Cell[19533, 513, 726, 21, 70, "Text",ExpressionUUID->"ef924c33-06b8-4029-b89f-654d4ef65330",
 CellID->1997714465],
Cell[20262, 536, 609, 20, 70, "Text",ExpressionUUID->"9bdd9950-4e74-4ea1-8d9e-2d68b53879c4",
 CellID->1827676057],
Cell[20874, 558, 923, 30, 70, "Text",ExpressionUUID->"8798a58a-161a-4db5-bc9c-0f7c1f7201bd",
 CellID->145403311],
Cell[21800, 590, 755, 19, 70, "Text",ExpressionUUID->"e425cb34-df2b-4fc2-93a5-9a36143e2cd5",
 CellID->2104541338]
}, Open  ]],
Cell[CellGroupData[{
Cell[22592, 614, 111, 1, 70, "Section",ExpressionUUID->"0108b28e-7bae-4b1a-a62d-769970d7ac23",
 CellID->1970601676],
Cell[22706, 617, 382, 6, 70, "Text",ExpressionUUID->"a6083d02-f569-4aa9-b6e2-c9a4f627c972",
 CellID->1409564498],
Cell[23091, 625, 486, 16, 70, "Text",ExpressionUUID->"e539ecd4-61fd-4fc0-9021-0aa4b37df486",
 CellID->1658407829],
Cell[23580, 643, 172, 2, 70, "Text",ExpressionUUID->"7328f45e-1f8c-4a11-9bea-4ab9b6c182c5",
 CellID->670127590],
Cell[23755, 647, 645, 23, 70, "Text",ExpressionUUID->"aea74edf-7948-456a-9994-35247a7ba411",
 CellID->1430160262],
Cell[24403, 672, 704, 14, 70, "Text",ExpressionUUID->"4794b373-5c4d-4a69-b531-218ef84797ae",
 CellID->2066546210],
Cell[25110, 688, 804, 29, 70, "Text",ExpressionUUID->"29436a5b-84e2-4923-bba5-a940bd916f91",
 CellID->1189128539],
Cell[25917, 719, 417, 12, 70, "Text",ExpressionUUID->"a6f648d3-9b3a-45ba-9748-99ba50b2a448",
 CellID->1200535991],
Cell[26337, 733, 564, 17, 70, "Text",ExpressionUUID->"ebde6447-18a7-4e62-832f-f9d3775963f5",
 CellID->1799537172],
Cell[26904, 752, 546, 14, 70, "Text",ExpressionUUID->"c06bd4bd-5737-4250-acdf-4260dc50a7d6",
 CellID->1809049103],
Cell[27453, 768, 786, 21, 70, "Text",ExpressionUUID->"35980900-8abf-4abb-9c76-5d4d5a95246b",
 CellID->614799895],
Cell[28242, 791, 414, 7, 70, "Text",ExpressionUUID->"b94dcfd0-1a60-453b-8f02-7b6529f88549",
 CellID->1398009548]
}, Open  ]],
Cell[CellGroupData[{
Cell[28693, 803, 116, 1, 70, "Section",ExpressionUUID->"3b71ee5e-6eed-446a-ad3f-f53a4c2af1c7",
 CellID->727891409],
Cell[28812, 806, 461, 10, 70, "Text",ExpressionUUID->"382ebe22-5461-41da-b89a-3a5d18c7b416",
 CellID->2036400266],
Cell[29276, 818, 771, 26, 70, "Text",ExpressionUUID->"e7eebf3a-7622-4354-af7f-9979953faec8",
 CellID->1332388423],
Cell[30050, 846, 108, 1, 70, "Text",ExpressionUUID->"8e0eaa71-7cb2-4609-ae5f-1e58fb74577f",
 CellID->1640238092],
Cell[30161, 849, 350, 11, 70, "Text",ExpressionUUID->"bf4a3a8d-4fa8-423a-9305-025f3a65ac0f",
 CellID->234035705],
Cell[30514, 862, 366, 11, 70, "Text",ExpressionUUID->"75e89778-13fc-4135-b91c-9e7f791120b8",
 CellID->1395536278],
Cell[30883, 875, 685, 17, 70, "Text",ExpressionUUID->"404596d8-aab7-4847-a8a2-4dff227eac25",
 CellID->2109315459],
Cell[31571, 894, 944, 31, 70, "Text",ExpressionUUID->"e024b0ad-837b-4a72-b828-a02714c0f3c5",
 CellID->604874737],
Cell[32518, 927, 136, 1, 70, "Text",ExpressionUUID->"437bf422-b641-41c5-b2b5-278cf329dfc9",
 CellID->2089603508],
Cell[32657, 930, 678, 21, 70, "Text",ExpressionUUID->"db2fa967-696c-47a4-bf98-90787c08f5d2",
 CellID->1128739665],
Cell[33338, 953, 598, 16, 70, "Text",ExpressionUUID->"d65438b5-68c0-4de2-84be-b317e1375acd",
 CellID->1156465011],
Cell[33939, 971, 861, 29, 70, "Text",ExpressionUUID->"1343ba8c-11a1-46f7-8f6b-7967ed1e73c2",
 CellID->1980434527],
Cell[34803, 1002, 442, 13, 70, "Text",ExpressionUUID->"bed12125-549f-470b-95c6-0815c41a7c91",
 CellID->1314050436],
Cell[35248, 1017, 710, 23, 70, "Text",ExpressionUUID->"fa1c6526-557b-4c4f-9cd0-f8ef673f41d3",
 CellID->523852104],
Cell[35961, 1042, 1212, 33, 70, "Text",ExpressionUUID->"b671ba75-c2e4-4c5f-ae40-f130945b75ac",
 CellID->1846842875],
Cell[37176, 1077, 1077, 35, 70, "Text",ExpressionUUID->"466767ee-c88e-4632-97e6-b04be1c63564",
 CellID->159566387],
Cell[38256, 1114, 300, 8, 70, "Text",ExpressionUUID->"3d689d8c-31fd-49e1-bb21-620e1d9611fe",
 CellID->1772674853],
Cell[38559, 1124, 1651, 54, 70, "Text",ExpressionUUID->"74e42737-cd26-4bc0-8921-6e3a74543225",
 CellID->1305619540],
Cell[40213, 1180, 832, 20, 70, "Text",ExpressionUUID->"8ccae872-d773-4e26-9fe5-6a74aeca7926",
 CellID->559703734],
Cell[41048, 1202, 870, 30, 70, "Text",ExpressionUUID->"87202d93-c6ea-4872-a62f-fd387b036536",
 CellID->962283478],
Cell[41921, 1234, 368, 6, 70, "Text",ExpressionUUID->"4a3aa893-1e8e-4d4a-9e4f-fc52c276a579",
 CellID->399069189],
Cell[42292, 1242, 1676, 55, 70, "Text",ExpressionUUID->"2c706183-e799-4630-a52a-e22d1f75effe",
 CellID->564429942],
Cell[43971, 1299, 2982, 75, 70, "Picture",ExpressionUUID->"37a39816-f582-4491-aa93-540647c430d2",
 CellID->1842836385],
Cell[46956, 1376, 215, 5, 70, "Caption",ExpressionUUID->"4dbaae8e-e329-45cf-a315-81f978df9c21",
 CellID->2022043910],
Cell[47174, 1383, 1026, 24, 70, "Text",ExpressionUUID->"59a48e6a-374e-4a2b-a2fa-ee6a4c74d3da",
 CellID->938766395],
Cell[48203, 1409, 1033, 38, 70, "Text",ExpressionUUID->"39b4d9a5-96ae-4312-bb76-ef29d3b2198b",
 CellID->149852799],
Cell[49239, 1449, 1906, 56, 70, "Text",ExpressionUUID->"b5d981d2-8aac-4e44-81a2-2091c49b4679",
 CellID->1009795243],
Cell[51148, 1507, 544, 17, 70, "Text",ExpressionUUID->"ac322da9-7d68-4bbf-9354-91f0fe50c85d",
 CellID->2134561191],
Cell[51695, 1526, 390, 11, 70, "Text",ExpressionUUID->"f5427d1b-a329-40f5-84fb-9ef665d82dc2",
 CellID->857659199],
Cell[52088, 1539, 1161, 40, 70, "Text",ExpressionUUID->"1a6780ed-8ffd-4755-a1a9-91dea9937fee",
 CellID->523059180],
Cell[53252, 1581, 284, 8, 70, "Text",ExpressionUUID->"f035fa05-3cf5-4e7a-8fe0-93e84c3b907f",
 CellID->692423820],
Cell[53539, 1591, 703, 23, 70, "Text",ExpressionUUID->"0b1f9b30-08c2-4f81-8039-883c50432df6",
 CellID->2035810299],
Cell[54245, 1616, 135, 1, 70, "Text",ExpressionUUID->"75fa1299-c47b-4908-b9a6-82cc5e58e149",
 CellID->409619855],
Cell[54383, 1619, 865, 29, 70, "Text",ExpressionUUID->"8ec191af-3927-48ce-bdf7-6f44537b4678",
 CellID->1377870653],
Cell[55251, 1650, 733, 22, 70, "Text",ExpressionUUID->"0b082402-c9e2-4356-8af8-02161f278e9d",
 CellID->192432173],
Cell[55987, 1674, 579, 23, 70, "Text",ExpressionUUID->"57b4aae0-50ce-48aa-ac3e-6d2048c3e436",
 CellID->474108015],
Cell[56569, 1699, 2348, 75, 70, "Text",ExpressionUUID->"10be9fa2-4d47-4cf6-872d-b51b961231e0",
 CellID->887676347],
Cell[58920, 1776, 1359, 44, 70, "Text",ExpressionUUID->"b8e4286c-1542-4186-bc3f-b411258ff06a",
 CellID->1802879584],
Cell[60282, 1822, 142, 1, 70, "Text",ExpressionUUID->"8a6ce9cb-2433-442b-99a4-2626a7954303",
 CellID->73180309],
Cell[60427, 1825, 7614, 174, 70, "Picture",ExpressionUUID->"0953cbca-0d4f-4030-9304-6dcb32f60fbf",
 CellID->426432358],
Cell[68044, 2001, 1217, 37, 70, "Caption",ExpressionUUID->"e2f6c8db-a9b0-4b76-8822-b1a3f1e5c486",
 CellID->1441423492],
Cell[69264, 2040, 7467, 187, 70, "Picture",ExpressionUUID->"f8d05f79-a571-45e9-8325-c1de0a6385d6",
 CellID->805780548],
Cell[76734, 2229, 209, 5, 70, "Caption",ExpressionUUID->"443fa466-b581-4119-8411-30738c0be2cd",
 CellID->2092317985],
Cell[76946, 2236, 693, 14, 70, "Text",ExpressionUUID->"c9009317-0629-4e33-aac4-c40d52d3f569",
 CellID->479591036],
Cell[77642, 2252, 8901, 220, 70, "Picture",ExpressionUUID->"757530df-d047-4ac4-9e2b-15911771c493",
 CellID->1374188068],
Cell[86546, 2474, 542, 14, 70, "Caption",ExpressionUUID->"541bdc19-f402-4950-9f4d-45b1640522b4",
 CellID->1066912687],
Cell[CellGroupData[{
Cell[87113, 2492, 121, 1, 70, "Subsection",ExpressionUUID->"f112b8f8-98b4-40ca-a728-c849a5a8456f",
 CellID->954049670],
Cell[87237, 2495, 1966, 56, 70, "Text",ExpressionUUID->"9326876f-a52a-4cc1-b7f5-d8ecf7535b9d",
 CellID->721098022]
}, Open  ]],
Cell[CellGroupData[{
Cell[89240, 2556, 111, 1, 70, "Subsection",ExpressionUUID->"616d7587-541f-42aa-994c-4ccc6b566c1e",
 CellID->1031420744],
Cell[89354, 2559, 181, 3, 70, "Input",ExpressionUUID->"d9db5a9b-d6b2-4c31-9695-c581a9175e80",
 CellID->1772728377],
Cell[89538, 2564, 273, 6, 70, "Input",ExpressionUUID->"392d5b05-39a6-492e-a517-9e8e1f5f7220",
 CellID->1480056330],
Cell[89814, 2572, 191, 4, 70, "MathCaption",ExpressionUUID->"58af45bc-3ac0-4143-b8e4-01f966dba0d4",
 CellID->1926403282],
Cell[90008, 2578, 167, 4, 70, "Input",ExpressionUUID->"6ddde0eb-0895-45aa-944a-ac62bd476bbc",
 CellID->1596498402],
Cell[90178, 2584, 123, 1, 70, "MathCaption",ExpressionUUID->"507c3bfd-0a5c-4077-94ce-3f91da193495",
 CellID->1819752051],
Cell[CellGroupData[{
Cell[90326, 2589, 317, 8, 70, "Input",ExpressionUUID->"4a89e81a-2006-4abc-a35c-ccc048414548",
 CellID->1229313375],
Cell[90646, 2599, 744, 24, 36, "Output",ExpressionUUID->"086d1a64-f1be-429b-bf83-a64e510320ab",
 CellID->1452929120]
}, Open  ]],
Cell[91405, 2626, 123, 1, 70, "MathCaption",ExpressionUUID->"71f577c7-1c6f-42f9-a39c-d6c1c247e663",
 CellID->2032166571],
Cell[CellGroupData[{
Cell[91553, 2631, 180, 4, 70, "Input",ExpressionUUID->"fcd12fab-c8ef-4b6a-abb8-132bef171ce7",
 CellID->1644145708],
Cell[91736, 2637, 853, 26, 36, "Output",ExpressionUUID->"90b59559-057a-4c33-8afa-92c81cc47cad",
 CellID->325025497]
}, Open  ]],
Cell[92604, 2666, 189, 4, 70, "MathCaption",ExpressionUUID->"0213db0e-6fe3-44ee-a3cc-e8183b9a5880",
 CellID->1085445029],
Cell[CellGroupData[{
Cell[92818, 2674, 191, 4, 70, "Input",ExpressionUUID->"b5402d18-9d59-416d-abfa-8a52f891e9e6",
 CellID->1212830196],
Cell[93012, 2680, 1034, 28, 170, "Output",ExpressionUUID->"50178a2e-2624-4832-82ee-edd1174fec37",
 CellID->1970012534]
}, Open  ]],
Cell[94061, 2711, 185, 3, 70, "MathCaption",ExpressionUUID->"7c9131e6-4b6c-4e60-811d-98b0aff72d80",
 CellID->1696608454],
Cell[CellGroupData[{
Cell[94271, 2718, 185, 4, 70, "Input",ExpressionUUID->"3765dc43-7eb9-42db-bb07-bb590b29de10",
 CellID->824970465],
Cell[94459, 2724, 5828, 146, 177, "Output",ExpressionUUID->"2757f482-0671-4c85-924b-f387d079a11a",
 CellID->1716433731]
}, Open  ]],
Cell[100302, 2873, 941, 29, 70, "MathCaption",ExpressionUUID->"771db906-d7e2-4fdc-8cfc-6f0d52021c3d",
 CellID->861360871],
Cell[101246, 2904, 145, 1, 70, "MathCaption",ExpressionUUID->"a8a71720-193e-4fa4-b2c0-e29fa62ff8ca",
 CellID->6216167],
Cell[CellGroupData[{
Cell[101416, 2909, 189, 4, 70, "Input",ExpressionUUID->"9836b9fa-d370-4905-aa3b-65d900a895bc",
 CellID->1343500228],
Cell[101608, 2915, 6067, 152, 177, "Output",ExpressionUUID->"1442200e-2d33-4770-a695-e50fc55a98e8",
 CellID->1513621106]
}, Open  ]],
Cell[107690, 3070, 237, 4, 70, "MathCaption",ExpressionUUID->"460b22d8-c03a-44bb-8264-4d110781d70a",
 CellID->2097976484],
Cell[CellGroupData[{
Cell[107952, 3078, 607, 17, 70, "Input",ExpressionUUID->"10ffc5d5-1b48-4bdc-9590-0dec064fa7ec",
 CellID->288131012],
Cell[108562, 3097, 144, 3, 36, "Output",ExpressionUUID->"16bff20f-dfb3-49c7-be29-635f72e1cce8",
 CellID->855371564]
}, Open  ]],
Cell[CellGroupData[{
Cell[108743, 3105, 607, 17, 70, "Input",ExpressionUUID->"3feef03a-0a75-45ee-b6f4-941cfe20f082",
 CellID->894851094],
Cell[109353, 3124, 145, 3, 36, "Output",ExpressionUUID->"7745a72b-05d6-47c5-a6e9-b71b688b08b4",
 CellID->2038315794]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109559, 3134, 123, 1, 70, "Section",ExpressionUUID->"76814999-978f-491d-b3c0-ae13b6030842",
 CellID->1845626348],
Cell[109685, 3137, 585, 9, 70, "Text",ExpressionUUID->"0285979e-58e5-4dbb-a907-c9d4f3f853ed",
 CellID->1188233568],
Cell[110273, 3148, 494, 8, 70, "Text",ExpressionUUID->"3de5bf9e-85d3-4674-9777-dc5b8f32de1a",
 CellID->1191143923],
Cell[110770, 3158, 142, 1, 70, "Text",ExpressionUUID->"694187ff-c091-4ec6-8be7-01b3854c5737",
 CellID->713356527],
Cell[110915, 3161, 803, 27, 70, "Text",ExpressionUUID->"dfc4c1ba-044c-44ae-89b0-c680abb1d3cd",
 CellID->2129431735],
Cell[111721, 3190, 146, 1, 70, "Text",ExpressionUUID->"4622149d-dadb-49d5-ae2c-06569e493598",
 CellID->1544192890],
Cell[111870, 3193, 696, 22, 70, "Text",ExpressionUUID->"a73f8dd7-0e3b-40db-8fff-ddced1c402be",
 CellID->910028235],
Cell[112569, 3217, 510, 8, 70, "Text",ExpressionUUID->"2b5e7726-22b3-4715-866c-f858e17461d1",
 CellID->466011711],
Cell[113082, 3227, 412, 12, 70, "Text",ExpressionUUID->"1eb2c6c3-19c4-4985-beb5-99f64b5ee919",
 CellID->385966168],
Cell[113497, 3241, 582, 18, 70, "Text",ExpressionUUID->"0e7555f1-7261-4e19-801d-5bd2de5532c9",
 CellID->1008799391],
Cell[114082, 3261, 2546, 71, 70, "Text",ExpressionUUID->"f701e7e4-8b46-4462-beb8-b0471a961d97",
 CellID->245060466],
Cell[116631, 3334, 6123, 153, 70, "Picture",ExpressionUUID->"732cac94-810a-4abc-8651-938b1b522cde",
 CellID->2090695979],
Cell[122757, 3489, 627, 15, 70, "Caption",ExpressionUUID->"9faf1bd5-13ee-4cc8-8d06-9b2fa3d26202",
 CellID->1199886839],
Cell[123387, 3506, 645, 12, 70, "Text",ExpressionUUID->"b65d7cf5-9179-4b78-af6b-4043e0b82008",
 CellID->1494470790],
Cell[124035, 3520, 7495, 180, 70, "Picture",ExpressionUUID->"fd7ca53b-9430-45da-a20f-d9f9b9c0ce52",
 CellID->432498188],
Cell[131533, 3702, 251, 6, 70, "Caption",ExpressionUUID->"e2689852-1089-49ee-a868-8c3aeacd176e",
 CellID->183991796],
Cell[131787, 3710, 238, 4, 70, "Text",ExpressionUUID->"1518fbf0-e92f-45ea-88ac-00259a30368f",
 CellID->1746188333],
Cell[132028, 3716, 6984, 169, 70, "Picture",ExpressionUUID->"698c35b5-8ae5-4a89-9dd1-bd6662d59937",
 CellID->701997713],
Cell[139015, 3887, 361, 9, 70, "Caption",ExpressionUUID->"238cac73-d6a9-4b70-ab9e-01abbaa89f24",
 CellID->1338980970],
Cell[139379, 3898, 328, 5, 70, "Text",ExpressionUUID->"f67c4aa8-075e-45ac-a2eb-d2ff5e04d0e4",
 CellID->726276225],
Cell[CellGroupData[{
Cell[139732, 3907, 110, 1, 70, "Subsection",ExpressionUUID->"1a8e8521-b853-4c28-90c3-318b8876f0f4",
 CellID->204289853],
Cell[139845, 3910, 178, 3, 70, "Input",ExpressionUUID->"2f073018-b231-4693-a72c-abb52664df4f",
 CellID->432975153],
Cell[140026, 3915, 270, 6, 70, "Input",ExpressionUUID->"c44a4684-f6ff-4c85-9981-770f51ec6857",
 CellID->538425044],
Cell[140299, 3923, 247, 4, 70, "MathCaption",ExpressionUUID->"6ecf26f5-4972-4a01-98f3-aed1be4fe340",
 CellID->1649159624],
Cell[140549, 3929, 329, 10, 70, "Input",ExpressionUUID->"e913998a-7429-46a4-ba9a-0e0a526dedee",
 CellID->72871740],
Cell[140881, 3941, 334, 5, 70, "MathCaption",ExpressionUUID->"c849435e-003f-4bfe-8532-bb20fd44f945",
 CellID->1795832665],
Cell[CellGroupData[{
Cell[141240, 3950, 225, 5, 70, "Input",ExpressionUUID->"5a4a2f06-1793-4039-a3b1-307a01d6b483",
 CellID->2005468121],
Cell[141468, 3957, 6109, 152, 177, "Output",ExpressionUUID->"a4b4971f-686f-42c3-b14e-9e21521014fb",
 CellID->557441976]
}, Open  ]],
Cell[147592, 4112, 141, 1, 70, "MathCaption",ExpressionUUID->"bad143b2-7d07-4d9c-ad51-05ebb683a557",
 CellID->1145423755],
Cell[CellGroupData[{
Cell[147758, 4117, 228, 5, 70, "Input",ExpressionUUID->"5ab2b933-99a3-451a-91ef-4416b18d771a",
 CellID->1538581204],
Cell[147989, 4124, 6067, 152, 177, "Output",ExpressionUUID->"54ff045c-14e5-4cd1-9a5c-d5802491e11b",
 CellID->1630496338]
}, Open  ]],
Cell[154071, 4279, 238, 4, 70, "MathCaption",ExpressionUUID->"df7e1bc0-d714-4040-9e92-0f497b3c8fc7",
 CellID->1342942637],
Cell[CellGroupData[{
Cell[154334, 4287, 607, 17, 70, "Input",ExpressionUUID->"e62f3cd1-5daa-44e8-b047-7a05b3e85936",
 CellID->783770089],
Cell[154944, 4306, 145, 3, 36, "Output",ExpressionUUID->"55b0562c-1ecb-40ca-934b-c0caccd36dfb",
 CellID->2067185116]
}, Open  ]],
Cell[CellGroupData[{
Cell[155126, 4314, 608, 17, 70, "Input",ExpressionUUID->"52f00716-1a1d-4fba-97af-6e6b5862c9bd",
 CellID->1764316411],
Cell[155737, 4333, 145, 3, 36, "Output",ExpressionUUID->"9a15f56b-a57b-4638-902c-6b30649fb680",
 CellID->1011195439]
}, Open  ]],
Cell[155897, 4339, 203, 4, 70, "MathCaption",ExpressionUUID->"7fbbab2b-3952-4c72-b999-d29c79c62580",
 CellID->68827890],
Cell[CellGroupData[{
Cell[156125, 4347, 368, 11, 70, "Input",ExpressionUUID->"23c07413-dc90-451f-84c7-745862702d9f",
 CellID->344851506],
Cell[156496, 4360, 1387, 34, 38, "Output",ExpressionUUID->"d2ebec70-d65b-4f6b-a853-42b3119a4d23",
 CellID->668028928]
}, Open  ]],
Cell[CellGroupData[{
Cell[157920, 4399, 334, 8, 70, "Input",ExpressionUUID->"d2672a3e-e1b1-4d2c-960f-0f7d54788b75",
 CellID->413710622],
Cell[158257, 4409, 8236, 198, 178, "Output",ExpressionUUID->"90f80faf-4c35-4351-9ba4-3a24cd231c8e",
 CellID->1035028918]
}, Open  ]],
Cell[166508, 4610, 242, 4, 70, "MathCaption",ExpressionUUID->"d4ab3101-82c7-48c9-b766-ce9faf69cfc0",
 CellID->1803885280],
Cell[CellGroupData[{
Cell[166775, 4618, 649, 19, 70, "Input",ExpressionUUID->"1ab6b388-ddea-421d-8a83-65f4a2fef1b6",
 CellID->1906734127],
Cell[167427, 4639, 7735, 187, 178, "Output",ExpressionUUID->"87e0d5fe-e385-424e-bdc1-3078ddcfa090",
 CellID->676632140]
}, Open  ]],
Cell[175177, 4829, 211, 4, 70, "MathCaption",ExpressionUUID->"c66f9a57-961c-41d7-97d9-0d8984fdc1d7",
 CellID->2071821703],
Cell[CellGroupData[{
Cell[175413, 4837, 604, 16, 70, "Input",ExpressionUUID->"4e310d5e-69d5-412c-b5bc-b700ab31d2e0",
 CellID->1287687905],
Cell[176020, 4855, 117, 1, 70, "EchoTiming",ExpressionUUID->"4aa57731-7bd9-4971-9258-13eac087f67c",
 CellID->1832203493]
}, Open  ]],
Cell[CellGroupData[{
Cell[176174, 4861, 323, 8, 70, "Input",ExpressionUUID->"62924f7e-2af9-43de-bd2e-7b2d76d045d1",
 CellID->585052629],
Cell[176500, 4871, 12270, 368, 70, "Output",ExpressionUUID->"3af75115-c4b4-442d-9583-682519098c1e",
 CellID->1076092518]
}, Open  ]],
Cell[188785, 5242, 210, 4, 70, "MathCaption",ExpressionUUID->"7ff2bfce-7b51-45bc-8e89-a5b85e1491a6",
 CellID->1935282369],
Cell[CellGroupData[{
Cell[189020, 5250, 647, 17, 70, "Input",ExpressionUUID->"1ab562a0-1b8a-404c-bf5a-86ddc50e2c2e",
 CellID->1278110699],
Cell[189670, 5269, 117, 1, 70, "EchoTiming",ExpressionUUID->"7e617a2c-799c-404c-9ea9-c35af1876138",
 CellID->1927158639]
}, Open  ]],
Cell[CellGroupData[{
Cell[189824, 5275, 324, 8, 70, "Input",ExpressionUUID->"a1426c3e-6853-4284-bac4-a47b5f52e619",
 CellID->1295721444],
Cell[190151, 5285, 12315, 368, 70, "Output",ExpressionUUID->"15d06d50-7f8e-4bc1-8bf4-2c1003f57005",
 CellID->1406881619]
}, Open  ]],
Cell[202481, 5656, 188, 4, 70, "MathCaption",ExpressionUUID->"0610464c-d833-4180-bc8a-6ec2e135b812",
 CellID->1424295448],
Cell[CellGroupData[{
Cell[202694, 5664, 350, 7, 70, "Text",ExpressionUUID->"ece0f5ce-6783-4d86-942a-3933f606d071",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->1398946391],
Cell[203047, 5673, 301, 5, 70, "MathCaption",ExpressionUUID->"db044eb0-9f52-44c3-be75-8dffddd9d1a9",
 CellID->1323225536],
Cell[CellGroupData[{
Cell[203373, 5682, 588, 16, 70, "Input",ExpressionUUID->"f97d24ab-b46c-4ec5-9f0c-f9554e65f89a",
 CellID->1882411498],
Cell[203964, 5700, 23216, 560, 142, "Output",ExpressionUUID->"999bc6bd-0c6a-4d40-92bb-a964bde5d69e",
 CellID->707533424]
}, Open  ]],
Cell[CellGroupData[{
Cell[227217, 6265, 404, 10, 70, "Input",ExpressionUUID->"518d430b-c6af-4064-82de-6466b8a2e950",
 CellID->733665627],
Cell[227624, 6277, 7429, 179, 178, "Output",ExpressionUUID->"f5f1993e-8a88-490f-b217-28034ec6da3b",
 CellID->842613166]
}, Open  ]],
Cell[CellGroupData[{
Cell[235090, 6461, 465, 13, 70, "Input",ExpressionUUID->"26cc299e-9e1a-4191-a609-75ab4c098fed",
 CellID->1535297063],
Cell[235558, 6476, 11079, 249, 178, "Output",ExpressionUUID->"0c371a96-34b7-41aa-ad65-2daefa083f3f",
 CellID->1970411483]
}, Open  ]],
Cell[CellGroupData[{
Cell[246674, 6730, 730, 21, 70, "Input",ExpressionUUID->"962897ef-4b72-4d75-852c-a344507cd62a",
 CellID->1024108386],
Cell[247407, 6753, 10964, 253, 178, "Output",ExpressionUUID->"6055ac7b-39c9-4fb4-93d1-8c468877592f",
 CellID->779805936]
}, Open  ]],
Cell[CellGroupData[{
Cell[258408, 7011, 194, 4, 70, "Input",ExpressionUUID->"fa0a0acb-f5b1-4b5c-9d39-a928fd8463dd",
 CellID->1469523285],
Cell[258605, 7017, 1387, 34, 38, "Output",ExpressionUUID->"f748f3c9-6beb-4582-9040-8d5bea71ef1d",
 CellID->516106542]
}, Open  ]],
Cell[260007, 7054, 197, 4, 70, "MathCaption",ExpressionUUID->"8b5de8a8-ec7b-437b-8abe-c4c49ca60a68",
 CellID->1980347370],
Cell[CellGroupData[{
Cell[260229, 7062, 222, 5, 70, "Input",ExpressionUUID->"52a57538-2318-4b43-beef-43b8ada31029",
 CellID->1806758675],
Cell[260454, 7069, 1386, 34, 38, "Output",ExpressionUUID->"0e329c62-0e8c-4cc0-83a5-702b973439c4",
 CellID->20105873]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[261891, 7109, 1009, 24, 70, "TutorialMoreAboutSection",ExpressionUUID->"5f30abed-7318-40a9-93c3-a65f12771f02"],
Cell[262903, 7135, 2501, 64, 70, "RelatedTutorialsSection",ExpressionUUID->"8b5a4e56-01d7-4481-9c97-3f42ebfe243d"],
Cell[265407, 7201, 7244, 184, 70, "TutorialRelatedLinksSection",ExpressionUUID->"9bbf0635-b3ea-4420-b1ea-1c3ffb49f821"]
}, Open  ]],
Cell[272666, 7388, 78, 0, 70, "FooterCell",ExpressionUUID->"0cfb84cd-3341-4c10-b094-4b7a2a6075fe"]
}
]
*)

(* End of internal cache information *)

