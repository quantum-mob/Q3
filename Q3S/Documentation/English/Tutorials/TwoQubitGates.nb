(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    573586,      14725]
NotebookOptionsPosition[    514349,      13568]
NotebookOutlinePosition[    520677,      13712]
CellTagsIndexPosition[    520223,      13695]
WindowTitle->Two-Qubit Gates
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3S TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "8f6b0e35-330e-4c47-9ecd-1540f8aa74ab"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "ae5af9ea-1072-4b2e-9d5f-002a172bd02c"],
        Background->RGBColor[
         0.3843137254901961, 0.4627450980392157, 0.7019607843137254],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "60174a0d-e13d-4c5a-9c5e-a2310c5f254b"]
         }],ExpressionUUID->"d16705e2-9764-47e5-99c5-c02ac309894a"],
         StripOnInput->False],{
        StyleBox["\"CNOT\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/CNOT"], 
         StyleBox[
          "\"ControlledGate\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/ControlledGate"],
          StyleBox["\"CZ\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/CZ"], 
         StyleBox[
          "\"GivensRotation\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/GivensRotation"],
          StyleBox["\"SWAP\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/SWAP"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "01804bf6-f511-4e49-8b16-3a9827e0f702"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "545f7fd5-b3ff-4fce-8c99-5fa8d8655d0e"]
         }],ExpressionUUID->"a63cf5f6-cfa5-4212-9b4d-20b1362f17cd"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "d92b3e8e-4495-4e38-8bdf-57d3afeff550"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "e6fcf8a3-8ed5-4246-b504-241e52bdac5c"]
         }],ExpressionUUID->"c2239044-78a7-4d0a-95d2-6bcb4fe23fcb"],
         StripOnInput->False],{
        "\"Quantum Computation: Overview\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumComputationOverview"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "1c39adb7-f199-4ca0-89ef-f640a39f7215"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "44c6555c-b42f-4625-bbed-92ff570669b5"]
         }],ExpressionUUID->"b6c9c932-24b4-4830-a41f-341d049bb073"],
         StripOnInput->False],{
        "\"QuantumMob/Q3S/tutorial/TwoQubitGates\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3S/tutorial/TwoQubitGates"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3S/\
tutorial/TwoQubitGates.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "QuantumMob/Q3S/tutorial/TwoQubitGates" <> ".html"], None}]}]},
        
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "22e07f9a-a809-43a0-af9f-20c7c8c1eb7a"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "82d8a0d3-bd63-4690-a039-c29a3e218c18"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"4cd3999f-1cef-4116-8f02-3aec65b2c295"],

Cell[CellGroupData[{

Cell["Two-Qubit Gates", "TechNoteTitle",
 CellID->1379112571,ExpressionUUID->"7bdb4169-71d5-404b-b82f-d01ee06df9d0"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Controlled-NOT Gate (CNOT)"], 
      "paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1585062394", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Controlled-Unitary Gates"], 
      "paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1455445268", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Controlled-Z Gate (CZ)"], 
      "paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#29167796", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["General Unitary Gates"], 
      "paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1476129218", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["SWAP Gate"], 
      "paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1218939314", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], ""}
  }]], "TechNoteJumpBox",ExpressionUUID->"24ec9c1d-cdc2-4c4b-b09d-\
908e5a8aa256"],

Cell[TextData[{
 "See also Section 2.2 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "011d1bed-6ccc-4675-a186-9e146775ef49"],
 "."
}], "TechNoteText",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"d408910d-f4aa-4937-9177-486fb45f3383"],

Cell[TextData[{
 "This document introduces quantum logic gate operations acting on two \
qubits. Such operations are represented by 4\[Times]4 unitary matrices. We \
will see that any two-qubit gate operations can be decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1455445268"],
 ". A ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1455445268"],
 " acts a unitary operator on one qubit depending on the logical state of the \
other qubit. A controlled-unitary gate on two qubits can be further \
decomposed into factors including only the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1585062394"],
 " and single-qubit rotation gates. In this sense, the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1585062394"],
 " alone is sufficient for any two-qubit gate."
}], "TechNoteText",
 CellID->1465929903,ExpressionUUID->"1fdaf110-9cfd-4687-ab77-a5c1f71a0d2c"],

Cell[TextData[{
 "The ",
 ButtonBox["controlled-unitary",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1455445268"],
 " and ",
 ButtonBox["CNOT gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1585062394"],
 " have various interesting properties that make them useful in implementing \
quantum algorithms. In this document, we first examine the basic properties \
of the CNOT gate, and in particular, how it is used to generate an \
entanglement between two qubits. Then, we discuss the properties of the ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1455445268"],
 " and describe how to implement a controlled-unitary gate in terms of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1585062394"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/SingleQubitGates#1113797362"],
 ". Finally, we discuss how an arbitrary two-qubit unitary operation can be \
decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1455445268"],
 "."
}], "TechNoteText",
 CellID->1951481337,ExpressionUUID->"a2c4bd20-1950-479d-9c59-73c95d801c74"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["CNOT"]], "paclet:QuantumMob/Q3S/ref/CNOT", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-NOT or CNOT gate", "TechNoteTableText",ExpressionUUID->
     "fd2154fb-d8e1-4837-800b-09a7ff1ebc5d"]},
   {
    TemplateBox[{
      Cell[
       TextData["CZ"]], "paclet:QuantumMob/Q3S/ref/CZ", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-Z or CZ gate", "TechNoteTableText",ExpressionUUID->
     "4bbf74e4-e4fb-4367-aa6f-1364552cd4cb"]},
   {
    TemplateBox[{
      Cell[
       TextData["SWAP"]], "paclet:QuantumMob/Q3S/ref/SWAP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The SWAP gate exchanging the states between two qubits", 
     "TechNoteTableText",ExpressionUUID->
     "309b92d2-10a9-4ceb-a3cb-d80c05cc177f"]},
   {
    TemplateBox[{
      Cell[
       TextData["ControlledGate"]], 
      "paclet:QuantumMob/Q3S/ref/ControlledGate", "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Controlled-unitary gates", "TechNoteTableText",ExpressionUUID->
     "51fb4670-e668-485b-a64e-5a3fd7e559cb"]},
   {
    TemplateBox[{
      Cell[
       TextData["GivensRotation"]], 
      "paclet:QuantumMob/Q3S/ref/GivensRotation", "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents two-level unitary transformation", "TechNoteTableText",
     ExpressionUUID->"abd02730-9c1c-412f-aeed-26c5964b494e"]}
  }]], "DefinitionBox",
 CellID->407539380,ExpressionUUID->"6aa964c6-df49-45d9-aab8-318e6ccc3bf5"],

Cell["Two-qubit gates available in Q3.", "TechNoteCaption",
 CellID->1189009377,ExpressionUUID->"9442e6dd-2b5d-40a0-966e-b2fc34a4136f"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"af3bb25d-ffac-4bbe-9210-790d65114d11"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[4]:=",
 CellID->853967906,ExpressionUUID->"138b9ea6-f61e-4b69-8d6a-bb0ba73dd4e6"],

Cell[TextData[{
 "Throughout this documentation, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "TechNoteMathCaption",
 CellID->1937193009,ExpressionUUID->"89876003-3b7c-4ea3-bd23-7a228b9ef9a6"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[5]:=",
 CellID->403330096,ExpressionUUID->"44b12c3a-fcfd-462a-8f10-39627b458736"],

Cell[CellGroupData[{

Cell["Controlled-NOT Gate (CNOT)", "TechNoteSection",
 CellTags->"Section11",
 CellID->1585062394,ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458"],

Cell[TextData[{
 "The  controlled-NOT or ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:QuantumMob/Q3S/ref/CNOT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e620a8c8-0da2-4add-9e60-e9b95269af8c"],
 " gate is a quantum logic gate on two qubits that maps the logical basis \
states as"
}], "TechNoteText",
 CellID->609014923,ExpressionUUID->"62984cd4-f3b3-450e-ad63-6354c092b443"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CNOT", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        RowBox[{"c", "\[CirclePlus]", "t"}]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "d65b82c4-da31-4b40-8e51-3f9ddd06ee1b"]
}], "TechNoteText",
 CellID->806749259,ExpressionUUID->"f15d1350-5180-4052-b407-75252bfc5e41"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "9029aa68-1d83-41e2-8780-ffac38998045"],
 ", where the first qubit is typically called the ",
 StyleBox["control qubit",
  FontSlant->"Italic"],
 " (c) and the second qubit the ",
 StyleBox["target qubit",
  FontSlant->"Italic"],
 " (t)."
}], "TechNoteText",
 CellID->1970532502,ExpressionUUID->"9e23ca1b-a44b-44a1-8afb-c73a3b805a4f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CNOT", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[7]:=",
 CellID->246957080,ExpressionUUID->"83c952c4-342b-40cc-8c28-c5974248aacf"],

Cell[BoxData[
 RowBox[{"CNOT", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`S[2, Q3`$]], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1263743562,ExpressionUUID->"fb884d14-a627-4d43-aec8-d8125fbc132c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[8]:=",
 CellID->149239284,ExpressionUUID->"c23bcfd0-0e4f-4fd2-852b-c63df535918b"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnQtsFMUfx0+eDSAiTakJKgEf1IJJUaPYAPo3gIK21GJVahQrryLIq1VE
K6ZYH6GiNFqwMRKtBhEDVBQ1YExF1IrUorVQ//WFSilWBJH6AHH/X2/C/pe5
vb25fc7u/T4J5Dq7tzM3v9/tzOzd7WfgHXNzp3cKhUJFSfgvt2DhfxYsKFg0
sQ/+yJtTNHPGnGlTx80pnjZj2oLhd3RGYTX+deDfv48Vgkgwtm3bNmvWLK9b
4T3Nzc3Dhg3r6OjwuiEn8cYbb9x///1et8J7TEfnnXfeufnmm51okr/4+++/
k5OTN2zY4HVDTuLVV1+98847vW6F95iODqW3yuTJk2+77TavW3ESlN4q5qJD
6a2Ck0Pfvn2PHTvmdUP+D6W3irnoUHqrYGrXo0ePd9991+uG/B9KbxVz0YmZ
3o2Njffcc8+oUaOGDBly++23v/jii9aaKQTmWlVVVfn5+WlpaaNHjy4pKfnm
m29cqDcnJ2fOnDkuVCRIzPSm6BhjnN5vvvlmr169QidTUFBw9OhRy42NCt6n
2dnZXKUpKSkfffSRc5Uynn/++bPPPtvpWsQxTm+KTkwM0rulpaVz538vmGdl
ZTU0NOzdu/fpp5/u0qULShYtWmRHe/XBIgJVYCSqrq5ua2urq6sbMWIEShDK
AwcOOFcv+Pnnn/GS6+vrHa1FnLVr10ZLb4qOCAbpPXv2bDR75MiR2rPBqlWr
UHj66acfOXLEanP1aG1t7datG6p4++231ULUlZ6ejsJHHnnEiUq1XHnllQ88
8IDTtQhicPam6IgQLb0xBvXs2RNtXrdunbYcS9czzjgD5c8++6zVtupRWlqK
g1944YVcOU5NKO/fv78TlWqpqKiIrN0roqU3RUeQaOnd1NTExqDIidysWbOw
ae7cuZYaGoW8vDwcvKysjCtvb29n07yDBw86Ua/Kd999h1q++uor64favXv3
ww8/bOUI0dKboiO4f7T03rx5M45z7rnnKuGVMkYErJS/+OIL/Ll06VJsmjhx
oo3NVsnMzMTBX3rpJTzGagX9WV5ezjYhmtjU2NjoRL1ahg0b9vjjj1s/Tm1t
bVJS0vz5800fIVp6U3QEd46W3mwWh1UDHm/atIm9NydMmIA/sabA4+HDh9vY
ZhUsjXFwtEoJvxBWL5ZO+HPQoEHcrM8hMASzF24dtLZ79+4LFiww9/Ro6U3R
Edw5WnqvXLkSrb3qqquU8AUo9kKuu+46/PnKK6/gcUZGBvcUnEYwamBEPn78
uOnGp6am4uBbt27F40svvZTVu2PHDvx5wQUX4HFNTQ33FAyI6OFffvnFdKUc
n3/+eadOnfbv32/L0dB7yPDi4mITz42W3hQdwehES+/XXntNXUSw4W/y5Mls
+Hvqqaew6dprr9Xu/+STT2LBzl4vVj2TJk0ylx7snMBWTHV1dRhz1eEvOTkZ
mz755BN155aWljFjxqhXXzFYI7gmKo0E5yLB1dlxATZu3Ni1a9e777473mZE
S2+KjmB0oqV3fX19KHy5PnJTSUkJNk2fPl0tYWPl+eefv3jx4meeeQZdjffX
NddcY6LlWVlZOFRlZSVXjjXUKaecgk2tra2s5M8//zzvvPNQeMstt1RVVS1Z
sgQNwA62fL4g+AWezz77LBQP69evj6sZ0dKboiP49apo6Y21MGvwzp07uU1s
VNJe5Bw7diz3zsWqytzFB3Y5NycnhytnQzBWaurY+uGHH3KnqY6OjpdfftlE
pZEMHjx4xYoVMXc7duzYfwVAq9BUBDreiUG09KboiERHMfxYB29wtBCvSFuI
mQ8K8fbXfs0AXYqSn376yUqbGRjycPwuXbrs27dPW56bmxsKf+KslrAu5Zpn
C5igInn27t1ry9E+/fTTvn37Yj6AWUS8zzX4WIeiI7KzQXq/9dZbaGHnzp3Z
hSAl/KEV3jgovP7667V7YuhBYVpa2oYNG6IF8Z9//sFQXlRUhK4wXmhcdtll
OBqCcujQIVaybNkyNrjjCOpuOAjme3il8+bN+/7770VerCCPPfYYarflUFhV
IbdvvPFGE7mtGKY3RUcEg/TGS8YMB81GIy+++OLx48f37t0bf5511llffvml
dk9MvQoLC3GKwNYBAwYsXbr0119/1e7w119/nXbaaeoU1Pitt337drZOQWJk
Z2cPHTqUPWvhwoXcnh988AGqY1GeOHHitm3buB0wR73rrrvQ+PT09Jtuuily
KNdl+PDhFj+OYSDceCE33HCD6e+QG6S336ODVi1fvhzznHPOOWfUqFFoFZoh
0idxRcf4G4PoQ6zK8ULYS8CodMUVV/z444+6Ozc3NyMW7Dts6AF2dZSBk8bK
MHh6zA5UwgMQQsYiAvr161dRUaG7J/rkhRdeuOSSS9ieyGG1l7Ci6datGzt5
4mjY2rVrV0wVjKvGORAJ09TUZLybCJh/Yry28vsI428M+jc66OTLL78c/YxN
KGRvTJGPouKNjsjPGdCNu3btwppX5LecGLNKS0vxhkW3//bbb9xW9LBIBzJw
ksEZQHAR9P7777PLVuqqavHixTgtqEPt+vXrsTUvL8/4OHhTYMkvUqMLiPyc
wY/R+eGHHwYOHLh69Wq29ffff2dznph5G290HPq1zpQpU9BanL648rg6MF5w
4sLBx44dq5Zop5pY1OM8M2TIEOODjBs3zsQFaodw6Nc6MkSHG9TYl7LWrl1r
fJB4o2M9vZFC6BbtzArnk4yMDLT266+/5na2sQNra2uLi4vxxldL2Pn51ltv
1d0fw2LPnj0xRzU45uHDh7t37x45h/cK6+ntl+hgOo2tmNgbHNNEdKynN5p0
6qmnYiaGNVR5eTlGHzaF0/3gwMYOxJwNh8LCBOv9ysrKadOmpaSkYP6JcVB3
f3Z+wOhmcEycPXCGt/Kxtb1YT29fRAd5O2jQICyKjdcpJqJjy+Tk22+/nTBh
grr6xgpuxowZut+NtLEDcRZasWLF4MGD1TUOHm/atEl35507dyYlJWVmZhp3
Tn5+/tSpU623zS5smZzIH51JkyaFBL6OZSI6Ns698Yqw0MAK3eC3fk7M7rBE
amhoaG9vj7ZDY2Mj3vU4OezZs8fgOGh2nz59Xn/9dRvbZhGDH6PFi5zRQavY
F9QffPBB4+OYi47LN4JwdPGiC87bGBZTU1O5q8GRbN68GZPzP/74w52GieDy
jSBcjg5G0sLCQtQ4b968mDubi4476b1mzZqKMOwbEUuWLGF/apceToBX17t3
7wEDBsTMbSX8OxeHfgVgGnfS25PoIFHR26juvvvuE9nfXHTcSe+0tLSQHtE+
g7CF1atXs9+9zp8/v6ys7KETvPfee5E7Y5Q888wzq6urnWuPCdxJb/ejg5n/
yJEjQ+FvyT766KMPadDd33R0AnyXKvZJQSS607ympiasPW381r0tBPUuVewL
M7ro7m86OgFO7wAQ1PR2DUpvmaH0tgilt8xQeluko6PDzct0RFwcPny4ra3N
61YQBEEQBEEQBEEQBEEQBEH4iYMHD+7evdvrVhD6tLe323Kn8YSFPrVkyCnd
pk8tGSTdtghJt2WGpNvWIem2zJB02yIk3ZYZkm5bhKTbMhMk6TZj165dixYt
KiwsbGlpcadGkm6L44voSCjdbm1tRRXM1cLYuHGjc9VpIel2TPwVHQml29u3
b+dC5loHknQ7Jv6KjmzSbSV8c8X9J0hKSnKzAxWSbsfCX9GRTbrNwe787GYH
knRbHPmjI5t0m8P9DiTptjjyR0c26TaH+x2okHRbGPmjY6N02xbvLYdIB9ru
vQ2kdDsxo2OXdNsu7y2HcQc65L0NnnQ7YaNji3TbRu8th0EHOuq9DZJ0O5Gj
Y4t020bvLYdBBzrqvQ2SdDtho6PYJN220XvLYdCBznlvlWBJtxM2OopN0m0R
7605DDrQOe9twKTbiRwdW6TbMb23SjxaZy3GixeHrMQBk27LGR3TVmL3pdsM
A++tuNYZc7Z+GtgQ3KNHD7VEe1jFASuxEjjpNkOq6Ji2EiveSbcZut5bca2z
epkrGjU1NbpPtMtKHFTpNkOS6Ji2Ensu3WbI4L1VTFmJgy3dZsgQHXNWYvel
237x3opYiZXASbf9Eh0RK7HihXTbF95bRcxKHDzpti+iI2gl9kS6rfjBeyto
JQ6edFvxQ3QErcReSbcZcnpvFWErsRJQ6TZDzuiIW4kVr6XbIshsJQ62dFsE
ma3EJN2OJC4rMUm33YxOvFZikm5zxGUlVki67WJ04rUSKyTdjiAuKzFJt92M
TrxWYpJuW4Sk2zJD0u1AQultEUpvmaH0tsjHH3987733et0KQp8tW7Zg5eV1
KwiCIAiCIAiCIAiCIAiCIAiCkILm5ubnnnvO61YQ+tTX169Zs8brVvgY+lCe
QdJtmSHptkVIui0zJN22Dkm3ZYak2xYh6bbMkHTbIiTdlhmHpNtK+Fef1dXV
M2fOXL58uYUGxgHmWlVVVfn5+WlpaaNHjy4pKdHe0dc5fCfdVryIDiMA0u1V
q1aNGTOG3cATXHTRRZbbGBu8T7Ozs7mf4KWkpNjirTBGNum28Y0gPIlOYKTb
YPz48docc6cDsYgIhW+ri5NSW1tbXV3diBEjUNKrV68DBw44WrVs0m3js7cn
0QmMdFsJ3y+X6ZWZscWFDsTJgd29QXtLriNHjqSnp4dOdmo4hF+k24oX0VGC
It3meOKJJ9zpwNLS0tAJ55cWdgPM/v37O90AX0i3OVyLDod/pdscrnVgXl4e
KiorK+PK29vb2VCoe+9HG/GFdJsjcdLbLuk2h2sdmJmZiYqYLwZrSWR7eXk5
24TZODY1NjY63Qb5pdsciZPeik3SbQ6RDrRF64ylMSpiihamqwANDQ1KWNYZ
0rtNbgJKtzlciw6Hf6XbHDE70C6tc2pqKo6wdetW5YSiEezYsQN/sotRWnuL
DFrnmDgh3eZwLToc/pVucxh3oI1aZ3bGXrduHR7X1dXl5+erk5Pk5OSQxq4r
idbZE+k2h2vR4fCvdJvDuANt1DpnZWXhUJWVlVz50aNHmWautbWVlcigdfZK
us3hWnQ4/Cvd5jDuQBu1zrNnz0ZFOTk5XDlTzmGlpk4dZdA6eyXd5nAtOhy+
lm5rMe5AG7XOmJCEworGffv2actzc3NRXlBQoJZIonWOiUPSbS2uRYfD19Jt
LcYdaK/Wmd2XG+ecQ4cOsZJly5axwR1H0O6ZyNJtLW5GR4uvpdt4papMmcma
gVpy9dVXc/vbonVWwt9qYKtIJEZ2dvbQoUPZsxYuXBi5c8JKtz2JTpCk2+p1
OV0yMjJ0n2VR68zAAISEVJ1x6LeKigrjpySadNuT6ARSum0CW7TOGEMxwImv
8RNTum0Ckm6L4xetM0m3GXJGh6TbHCTdFsEX0SHpdiQk3RZE/uiQdNsAkm6L
IGd0SLptEZJui0PSbYuQdDsuSLqtQtJtDpJuC0LSbYuQdNscJN1mkHTbIiTd
lhmSbgcSSm+LUHrLDKW3Rfbs2SPVpTBCS3Nz85YtW7xuBUEQBEEQBEEQBEEQ
BEEQBEEQUlBbWztlyhSvW+E9clqJa2pqioqKvG6F95CV2CJkJZYZshJbh6zE
MkNWYouQlVhmyEpsEbISy0yQrMQMX3hvHUVOK7GPnNESWon95b11FOP0Jmd0
TCS0EvvLe+soxjeCIGd0TGSzEit+8946imxWYt85o2XzWnLI7711FNm8lr5z
RlN6c5CV2ADfOaMpvSMhK3E0fOeMpvSOJJBWYlsw4Yy2HU+sxEqAtM7BsxIr
NkUnLmc0w9voyCbd5vBE66wEy0qs2BcdcWe0Ikd0ZJNuc3ildQ6SldjG6Ig7
o2WIjiKfdJvDK61zkKzENkZH3BktQ3QU+aTbHJ5onQNmJbYxOuLOaEmi45p0
23bvrYjWmazEit3REXRGx4yOj6zEMbXODnlvjbXOZCVm2BgdJR5ntEF0/Ggl
NtA6O+e9NZBuk5VYiy3RYYg7o6NFx79WYl2ts4pz9pZI6bZCVuIIbIxOXM7o
yOj4xUqsiwxaZ47EtBLrImF0pLUS+0XrnJhWYl9ER2YrsS+0zglrJfZFdCS3
EkuudU5wK7HM0fGRlVhOrTNZiRkSRoesxBYhK3FckJXYHGQlNgdZiVXISsxB
VmJByEoceMhKLDNkJQ4klN4WofSWGUpvcf4H0VPflg==
    "], {{0, 81.}, {122.5, 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    RasterInterpolation->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{122.5, 81.},
  PlotRange->{{0, 122.5}, {0, 81.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[10]//TableForm=",
 CellID->1461126496,ExpressionUUID->"d04d5aab-ece3-4cd9-b574-62fcdd61e8c0"]
}, Open  ]],

Cell["\<\
It has the following matrix representation in the logical basis\
\>", "TechNoteText",
 CellID->690265281,ExpressionUUID->"f38629b7-da2d-49d4-9a4f-cab818683eae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mat", "]"}]}], "Input",
 CellLabel->"In[11]:=",
 CellID->581916673,ExpressionUUID->"d5ffa1e0-0bff-4719-a383-a79ee77c4e02"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[12]//MatrixForm=",
 CellID->565678847,ExpressionUUID->"b2e039f4-59b0-47f2-a205-f3c3406e2351"]
}, Open  ]],

Cell["\<\
and is expressed in terms of the Pauli operators on the control and target \
qubit as\
\>", "TechNoteText",
 CellID->107481873,ExpressionUUID->"10cf248c-0990-4653-9460-7564067fa844"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "op", "]"}]], "Input",
 CellLabel->"In[13]:=",
 CellID->414092384,ExpressionUUID->"f7045bae-6c89-4de3-af4d-82643c928ee9"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]]}]}]], "Output",
 CellLabel->"Out[13]=",
 CellID->1341960052,ExpressionUUID->"4fdee805-5cae-40aa-b721-2f574ba9e798"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", "op", "]"}], "//", "PauliForm"}]], "Input",
 CellLabel->"In[14]:=",
 CellID->597624604,ExpressionUUID->"09b94d22-174c-4171-902d-bb4c6bcb5665"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   FractionBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"],
   Rational[1, 2]], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>"}],
    $CellContext`S[2, 1]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[1, 3]], "2"], "-", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"X\"\>"}],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]], "2"]}]], "Output",
 CellLabel->"Out[14]=",
 CellID->214561916,ExpressionUUID->"31b1a872-2454-4768-bc1f-9e2dce0ce0e0"]
}, Open  ]],

Cell["\<\
In quantum circuit model, it is represented as the following circuit element\
\>", "TechNoteText",
 CellID->1181321350,ExpressionUUID->"4ac4b380-e18c-42eb-8606-27ed2cd24c13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[15]:=",
 CellID->981612935,ExpressionUUID->"ea3e771d-8931-4af5-84ae-0743bdb4c361"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[15]=",
 CellID->790740182,ExpressionUUID->"8e7444e0-9843-4065-99e1-f67b4f307d45"]
}, Open  ]],

Cell["\<\
where the smaller filled circle indicates the dependence on the state of the \
control qubit and the circled-plus sign denotes the conditional NOT action on \
the target qubit.\
\>", "TechNoteText",
 CellID->606925297,ExpressionUUID->"d9581d0a-dbd2-482a-b817-f1d73dde1e39"],

Cell[TextData[{
 "A simple yet important feature of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:QuantumMob/Q3S/ref/CNOT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "5880ef7f-73b8-4ab6-82cc-87dc0d31f1eb"],
 " is to copy the logical state of the control qubit to the target bit \
provided that the target bit is initially set to |0\:27e9; or the reversed \
state when the target qubit is in |1\:27e9. A vital implication is that CNOT \
generates an entangled state when the control qubit is in a superposition:"
}], "TechNoteText",
 CellID->46143429,ExpressionUUID->"f58bb1d9-d484-4ea8-8203-51d02a66f420"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", "]"}], 
      RowBox[{"c", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "->", "1"}], "]"}], 
      RowBox[{"c", "[", "1", "]"}]}]}], "//", "KetRegulate"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "->", "out"}], "//", "KetFactor"}]}], "Input",
 CellLabel->"In[16]:=",
 CellID->291014636,ExpressionUUID->"62b3d615-d6f9-4ca7-b812-d7cc7d96ff73"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`c[0]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["0", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`c[1]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[2, Q3`$] -> 0|>]]}],
    HoldForm],
   Q3`OTimes[$CellContext`c[0] 
     Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + $CellContext`c[1] 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 0|>]]], "\[Rule]", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "0"},
       "RowWithSeparators"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]]}], "+", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1|>]]}]}]}]], "Output",
 CellLabel->"Out[18]=",
 CellID->832285012,ExpressionUUID->"2943fa6b-38b3-426a-afc5-2822870f7129"]
}, Open  ]],

Cell[TextData[{
 "Applying a single qubit rotation such the Hadamard gate on the control \
qubit prior to CNOT, one can thus generate entangled states from logical \
states. In this sense, such a circuit is called a ",
 StyleBox["quantum entangler circuit",
  FontSlant->"Italic"],
 ".  In general, the different product states in the logical basis are \
transformed to different ",
 StyleBox[ButtonBox["Bell states",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/BellState"],
  FontSlant->"Italic"],
 "."
}], "TechNoteText",
 CellID->1152615977,ExpressionUUID->"383827ed-7706-4ca2-876b-5a46bbd3d939"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "op"}], "]"}]}]], "Input",
 CellLabel->"In[19]:=",
 CellID->1714229499,ExpressionUUID->"6b667b08-6574-4554-b334-73f93014673e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->154.79999999999998`,
   PlotRange->{{0, 3}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[19]=",
 CellID->130382963,ExpressionUUID->"0a0f8b28-3957-4ba7-93e4-72e44e9e19b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[20]:=",
 CellID->1435008719,ExpressionUUID->"540f11dd-52fa-4772-a68f-e5ab52460160"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], 
         SqrtBox["2"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[22]//TableForm=",
 CellID->6706753,ExpressionUUID->"7c5dd0c5-16f6-4da2-8ba0-dfab4f58ef1b"]
}, Open  ]],

Cell[TextData[{
 "One can further generalize the above procedure to generate maximally \
entangled states between larger systems: Consider two quantum registers, each \
consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "af6575a1-43d0-4455-97df-db7ec963065c"],
 " qubits. We respectively call them the \[OpenCurlyQuote]control\
\[CloseCurlyQuote] and \[OpenCurlyQuote]target\[CloseCurlyQuote] register for \
the reason that will be clear below. Upon applying the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:QuantumMob/Q3S/ref/CNOT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "901a47ec-7470-4146-b686-042c18f982bb"],
 " gate on each pair of the corresponding qubits in the two registers as in \
the quantum circuit,"
}], "TechNoteText",
 CellID->1854176847,ExpressionUUID->"e9d8643a-bdae-44f6-a386-3125232e6ab1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"$n", "+", "1"}], ",", 
     RowBox[{"2", "$n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"MapThread", "[", 
      RowBox[{"CNOT", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"S", "@", "cc"}], ",", 
         RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[23]:=",
 CellID->1015065912,ExpressionUUID->"39dc9580-7a1b-4382-b6f3-3f739515f075"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}, {{0, -6}, {4, -6}}, {{0, -7}, {4, -7}}}], {
     LineBox[{{1, -1}, {1, -5}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, {
     LineBox[{{2, -2}, {2, -6}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -3}, {3, -7}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-7.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[4, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[5, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[3, Q3`$] -> 1}, {
     $CellContext`S[6, Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[26]=",
 CellID->2107153420,ExpressionUUID->"8dc93b98-e0ec-4db3-8545-b9ade51d7d9c"]
}, Open  ]],

Cell["the logical basis states are transformed as", "TechNoteText",
 CellID->1898388060,ExpressionUUID->"4f139bdc-bf15-4ac6-a51c-1922d819f608"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       RowBox[{"c", "\[CirclePlus]", "t"}]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "d41dd958-8763-4d29-b6bc-67bf58980937"],
 " ."
}], "TechNoteText",
 CellID->1043580941,ExpressionUUID->"4023a0e6-e622-4f9b-8d77-e119e9169775"],

Cell[TextData[{
 "The above association rule is formally the same as the one in (2.29) for a \
single pair of qubits. Here, however, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"c"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["c", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "18193fb8-fe63-46e6-9adb-b49b66691c9d"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"t"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["t", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "383ed95f-2d83-49c9-ab80-3650c110e70c"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[CirclePlus]", " ", "t"}], TraditionalForm]],
  ExpressionUUID->"30dfbfdc-abc1-4a43-91e4-a024c634e3b0"],
 " denotes the bit-wise exclusive OR (or XOR),"
}], "TechNoteText",
 CellID->965930338,ExpressionUUID->"0d1cfb35-cdd6-4168-9bde-3aaecc4c87de"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", "\[CirclePlus]", "t"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["t", "1"]}], ",", 
      RowBox[{
       SubscriptBox["c", "2"], "\[CirclePlus]", 
       SubscriptBox["t", "2"]}], ",", "\[Ellipsis]", ",", 
      RowBox[{
       SubscriptBox["c", "n"], "\[CirclePlus]", 
       SubscriptBox["t", "n"]}]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "9e89c491-b7a9-4bcf-a5bc-3c8c03b067f7"],
 " ,"
}], "TechNoteText",
 CellID->1562303093,ExpressionUUID->"d04b39be-74fb-4402-80d2-5e0712fe2a98"],

Cell[TextData[{
 "for the n-bit strings ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["c", "1"], ",", 
      SubscriptBox["c", "2"], ",", "...", ",", 
      SubscriptBox["c", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "91a8d8cd-fe5c-488a-9717-c0bf12b93c97"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["t", "1"], ",", 
      SubscriptBox["t", "2"], ",", "...", ",", 
      SubscriptBox["t", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "1fef8f88-4c88-4714-b329-9a1d4305b835"],
 ". When the target register is prepared in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "391653d4-d933-4e3c-bfda-d4c2b5266109"],
 ", the logical basis state of the control register is copied to the target \
register,"
}], "TechNoteText",
 CellID->345532182,ExpressionUUID->"df80024c-88fc-402c-99a8-3ac54f6c6c08"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "4192506e-ca86-4264-86b6-2c76afde6035"]
}], "TechNoteText",
 CellID->563601386,ExpressionUUID->"09b33eed-7151-471a-aa80-5102c9af7547"],

Cell[TextData[{
 "under the set of CNOT gates on paired qubits. More interestingly, when the \
control register is prepared in a superposition, say, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "7621ce2f-1c13-42ff-8aaa-50dbcc2924dd"],
 ", and the target register x=0 is in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "709dc516-26c0-43cb-8ffe-0b30b3555103"],
 ", the CNOT gate makes a copy of each logical state of the control register \
to the target register, leading to a maximally entangled state,"
}], "TechNoteText",
 CellID->2045611232,ExpressionUUID->"5cc10dbd-9cab-4ab3-b1a4-f1945afe3841"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["2", 
          RowBox[{"n", "/", "2"}]]], 
        RowBox[{
         SubsuperscriptBox["\[Sum]", 
          RowBox[{"x", "=", "0"}], 
          RowBox[{
           SuperscriptBox["2", "n"], "-", "1"}]], 
         TemplateBox[{"x"},
          "Ket"]}]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"0"},
       "Ket"]}], "\[RightTeeArrow]", 
     TemplateBox[{"\[CapitalPhi]"},
      "Ket"]}], ":=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "3c877f12-3f98-4a5b-a91c-f841483a1dff"]
}], "TechNoteText",
 CellID->1522271401,ExpressionUUID->"d3286731-09ef-4ca1-af2d-6ac91cd108fe"],

Cell[TextData[{
 "between the two registers (rather than single qubits). Since the \
superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "1a3df944-a9d2-4c37-90ff-bc9e60e7f1ab"],
 " is obtained just by the ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/Hadamard"],
 ", the maximally entangled state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[CapitalPhi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "3a3d096e-4106-4349-bb5a-6c3a2214bc3f"],
 " can be generated from the logical state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "cb7d677d-5c29-463c-af58-230e5263bea6"],
 " through the following quantum circuit."
}], "TechNoteText",
 CellID->1842749896,ExpressionUUID->"47aa758e-46c4-4652-9c32-230a16c89dec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qce", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", "qc"}], "]"}]}]], "Input",
 CellLabel->"In[27]:=",
 CellID->88345038,ExpressionUUID->"1ed5df0f-24ab-4c07-b89d-4fc278fbb02d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
     0, -5}, {5, -5}}, {{0, -6}, {5, -6}}, {{0, -7}, {5, -7}}}], {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -3.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -5}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -5}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
         2, -5.266666666666667}, {2, -4.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -6}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
         3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -7}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
         4, -7.266666666666667}, {4, -6.733333333333333}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->226.79999999999998`,
   PlotRange->{{0, 5}, {-7.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}, 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[4, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[5, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[3, Q3`$] -> 1}, {
     $CellContext`S[6, Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[27]=",
 CellID->343301842,ExpressionUUID->"65240db2-0ae9-44dc-bf7a-880122ac5f78"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qce", "**", 
    RowBox[{"Ket", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SimpleForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "@", "cc"}], ",", 
     RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[28]:=",
 CellID->1915435092,ExpressionUUID->"40759460-5bf8-427d-90d3-4d53518267a3"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      0, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 0, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1, $CellContext`S[5, Q3`$] -> 1, $CellContext`S[6, Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[29]=",
 CellID->2063407529,ExpressionUUID->"74499f83-ff42-43ee-a385-0aac7e4a3112"]
}, Open  ]],

Cell["\<\
It is also interesting to note that even though |\[CapitalPhi]\:27e9 is a \
maximally entangled state between the control and target registers, it is a \
product state of n maximally entangled pairs\
\>", "TechNoteText",
 CellID->716147443,ExpressionUUID->"79613866-65bb-4c85-b2c0-aea19f622195"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}], "=", 
    RowBox[{
     SubsuperscriptBox["\[CircleTimes]", 
      RowBox[{"k", "=", "1"}], "n"], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}]}], 
       SqrtBox["2"]], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "38a75842-a8e5-4adf-850b-3ff2f0bcef8e"],
 " ."
}], "TechNoteText",
 CellID->1791716713,ExpressionUUID->"a8b41850-f143-4cad-982f-e4cac48c5182"],

Cell["\<\
The entanglement strongly depends on how you partition the system.\
\>", "TechNoteText",
 CellID->1367097157,ExpressionUUID->"300d37d3-ac24-4fd6-a5ce-d521d49b9c4b"],

Cell["\<\
Another generalization of copying logical basis states to a series of qubits \
by consecutively applying CNOT gates with a single control qubit on multiple \
target qubits is shown in the following quantum circuit,\
\>", "TechNoteText",
 CellID->874378446,ExpressionUUID->"74d1947c-bf2c-4564-94d0-ee8b78d0e615"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"Distribute", "[", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "]"}], ",", "List"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[30]:=",
 CellID->447945501,ExpressionUUID->"84041a21-f550-43a3-a85c-e6102fbf9946"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -4}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[34]=",
 CellID->1430026836,ExpressionUUID->"c69162d7-55f4-477c-a520-e97578d2a5de"]
}, Open  ]],

Cell["or equivalently,", "TechNoteText",
 CellID->880946029,ExpressionUUID->"1ca4ed93-9296-4f2a-84cd-27a28acb3328"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"$n", "-", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"CNOT", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[35]:=",
 CellID->1307646985,ExpressionUUID->"5e29f39a-3204-497c-a88d-9c6e8d8ee8f5"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[3, Q3`$] -> 1}, {
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[38]=",
 CellID->2028733045,ExpressionUUID->"0f34f2ba-1129-48d8-9fc4-129215411fc7"]
}, Open  ]],

Cell["\<\
When the target qubits are all prepared in the logical basis state |0\:27e9, \
the series of CNOT gates makes the transformation\
\>", "TechNoteText",
 CellID->169608441,ExpressionUUID->"323e77c4-4eb8-4105-881a-bea45d584d43"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "e54c9567-fcf6-4bb6-aa51-ad46d78abac5"]
}], "TechNoteText",
 CellID->898268318,ExpressionUUID->"a08ac3b5-e6ed-4db0-bd4c-aa35a64d5eec"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", "=", "0"}], ",", "1"}], TraditionalForm]],ExpressionUUID->
  "180a4472-59f2-40f1-bee7-baf558860f8d"],
 ". Therefore, a simple application of the Hadamard gate in the control qubit \
before the CNOT gates, "
}], "TechNoteText",
 CellID->385582216,ExpressionUUID->"0dfa3798-c654-41c6-b24c-1e5409ff09fb"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
      0, -4}, {5, -4}}}], {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, 0.5}]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, 0.5}]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, 0.5}]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, 0.5}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, ImageScaled[{0.5, 0.5}]]}, {
      LineBox[{{2, -1}, {2, -2}}], 
      DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
       LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
          2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
      LineBox[{{3, -1}, {3, -3}}], 
      DiskBox[{3, -1}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
       LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
          3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}, {
      LineBox[{{4, -1}, {4, -4}}], 
      DiskBox[{4, -1}, 0.09], {CircleBox[{4, -4}, 0.26666666666666666], 
       LineBox[{{{3.7333333333333334`, -4}, {4.266666666666667, -4}}, {{
          4, -4.266666666666667}, {4, -3.7333333333333334`}}}]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->226.79999999999998`,
    PlotRangePadding->Scaled[0.025]], ","}]}]], "TechNoteText",
 CellID->1620101282,ExpressionUUID->"80e942ed-db67-4643-bf7a-4d3550bc2ebc"],

Cell["can generate a state of the form", "TechNoteText",
 CellID->712578174,ExpressionUUID->"9c5dec88-50e1-4384-80a1-52c62ce91167"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"GHZ"},
     "Ket"], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"]}]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "0ba762a6-c203-49b1-a60e-a6e8325930d1"],
 " ."
}], "TechNoteText",
 CellID->1522141313,ExpressionUUID->"be14f358-9356-40be-824c-3775f571e621"],

Cell["\<\
The above state, which is known as the Greenberger-Horne-Zeilinger (GHZ) \
state (Greenberger et al., 1989), exhibits a quantum entanglement of more \
than two particles. It has stimulated tests of non-locality of quantum \
mechanics beyond Bell inequalities (Bouwmeester et al., 1999; Pan et al., \
2000).\
\>", "TechNoteText",
 CellID->1803844527,ExpressionUUID->"47183c27-d643-4906-bcc3-a4334cf3e929"],

Cell[TextData[{
 "Quantum entanglement is a valuable resource in quantum information \
processing and in quantum communication. The most popular example of such is ",
 ButtonBox["quantum teleportation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/QuantumTeleportation"],
 "."
}], "TechNoteText",
 CellID->1188320590,ExpressionUUID->"1ce47ffc-a7e8-42be-accc-553690162eed"],

Cell["\<\
In the above consideration, CNOT gates with the same control qubit are \
applied on different target qubits. The opposite setting brings forth \
additional applications of CNOT as illustrated in the following quantum \
circuit.\
\>", "TechNoteText",
 CellID->506239030,ExpressionUUID->"7ac79346-bf40-42d5-b853-91e6a6cc390e"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, 0.5}]]}, {
     LineBox[{{1, -1}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
         1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
         2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, InsetBox[
     StyleBox[
      TemplateBox[{
        RowBox[{
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, 0.5}]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->1226753413,ExpressionUUID->"0daec1a0-b2a6-43ad-95a2-9e2423ff53c3"],

Cell["\<\
 In this quantum circuit, the successive application of the CNOT gates on the \
same target qubit with different control qubits results in the accumulation \
of the logical bit values of all qubits. The same goal may be achieved by \
applying the CNOT gates on the consecutive pairs of qubits as\
\>", "TechNoteText",
 CellID->365203462,ExpressionUUID->"f0f1d256-d003-452b-ad56-c6de1eef7f00"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, 0.5}]]}, {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -1}, ImageScaled[{0, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -2}, ImageScaled[{0, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -3}, ImageScaled[{0, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->977674470,ExpressionUUID->"26695863-b999-4dc6-bb9a-11589301ec38"],

Cell[TextData[{
 "In this case, not only the last qubit but also the qubits in the middle are \
modified. However, this makes little difference since the quantum circuit \
block is mostly used to conditionally control the operation of an unitary \
gate on a different qubit and the whole block must be undone anyway (see, for \
example, the ",
 ButtonBox["quantum circuit of conditional unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#1379525988"],
 ")."
}], "TechNoteText",
 CellID->833871357,ExpressionUUID->"714ba53e-b3ab-4802-80c2-3032089f3840"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Z Gate (CZ)", "TechNoteSection",
 CellTags->"Section12",
 CellID->29167796,ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[39]:=",
 CellID->754200946,ExpressionUUID->"54576842-4974-4bb2-8722-ba58eb507603"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[40]:=",
 CellID->1406814828,ExpressionUUID->"cc3378bc-d396-4d7e-84a7-3cef7960507b"],

Cell["\<\
An interesting variant of CNOT gates is the so-called controlled-Z or CZ \
gate. This is a quantum logic gate on two qubits that maps the logical basis \
states as\
\>", "TechNoteText",
 CellID->596875856,ExpressionUUID->"dee0244a-b497-4ac3-bcbf-73cf7bf2ce06"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CZ", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      SuperscriptBox[
       RowBox[{
        TemplateBox[{"t"},
         "Ket"], "(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"c", " ", "t"}]]}]}]}], TraditionalForm]],ExpressionUUID->
  "1ea385c0-0dbd-4923-90b1-9729933fa242"]
}], "TechNoteText",
 CellID->796396655,ExpressionUUID->"a789cdc5-659d-4100-807f-72ef7d9ece45"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "a224194f-7edc-4912-ab58-d4d4eb23fe22"],
 "."
}], "TechNoteText",
 CellID->1920492481,ExpressionUUID->"3625caaf-1149-4edf-8e0a-ea3a94e02478"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[42]:=",
 CellID->1037913757,ExpressionUUID->"e27b2630-b7c7-489b-bc92-39ee652f6ef1"],

Cell[BoxData[
 RowBox[{"CZ", "[", 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`S[1, Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`S[2, Q3`$]]}], "}"}], "]"}]], "Output",
 CellLabel->"Out[42]=",
 CellID->1853978131,ExpressionUUID->"7f1b7bf4-893b-4b9f-b8c9-bc8b52b3bf24"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[43]:=",
 CellID->1887946780,ExpressionUUID->"cef9c5bf-88a5-4811-8b56-8bcd4f4765cc"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{"-", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                 $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           1|>]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[45]//TableForm=",
 CellID->162020701,ExpressionUUID->"5dfc1efa-bd4d-4e8c-8bb5-75063ef7c04f"]
}, Open  ]],

Cell["\<\
The matrix representation of the CZ gate in the logical basis is given by\
\>", "TechNoteText",
 CellID->1230965299,ExpressionUUID->"36127d50-ae37-43a5-9a7e-3754dc1f5cdb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[46]:=",
 CellID->2123808742,ExpressionUUID->"b57487ff-4db4-4ec8-bc7a-1dc3c123ac55"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, -1}}]]]]], "Output",\

 CellLabel->"Out[46]//MatrixForm=",
 CellID->1847755910,ExpressionUUID->"d5ca4513-abec-48ad-b44e-841c4fb5b792"]
}, Open  ]],

Cell["\<\
Since it is symmetric for the two qubits, a distinction of the control and \
target qubit is meaningless. Accordingly, in quantum circuit model, the gate \
is depicted by the following quantum circuit element\
\>", "TechNoteText",
 CellID->776960470,ExpressionUUID->"15485452-1a47-484f-9ff1-d66b5524de4c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "op", "]"}]], "Input",
 CellLabel->"In[47]:=",
 CellID->1674045530,ExpressionUUID->"4284e249-9ba4-493c-805c-e967713f3c01"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CZ[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[47]=",
 CellID->384755590,ExpressionUUID->"7ddf821d-a009-492c-bece-2a6fc5ab3b1f"]
}, Open  ]],

Cell["\<\
The filled circles on both qubit lines (rather than a square box on either \
qubit) indicate that the bit values of both qubits remain unchanged.\
\>", "TechNoteText",
 CellID->573709808,ExpressionUUID->"5623df3c-159f-4542-8dd0-3572dc99d13f"],

Cell[TextData[{
 "Noting the identity ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", " ", "Z", " ", "H"}], "=", "X"}], TraditionalForm]],
  ExpressionUUID->"7a83536f-3ac5-4c9f-bee5-cbbd8e9da49f"],
 ", one can regard that the CZ gate is equal to the CNOT gate up to the \
Hadamard gate on the target qubit. The relation between the CNOT and CZ gate \
is illustrated in the following quantum circuits"
}], "TechNoteText",
 CellID->139168026,ExpressionUUID->"1b571b81-8177-4f9b-ba4b-3ac6a5409e2c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}]}], "]"}]}]}], "Input",\

 CellLabel->"In[48]:=",
 CellID->387321399,ExpressionUUID->"0586b212-b9ec-4f81-a2c8-a2577ebc16ec"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[48]=",
 CellID->1978763442,ExpressionUUID->"961c9d8e-81a1-4cab-a8f5-1deaacd32fb4"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[2, 6], 
   Q3`CZ[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[2, 6]]]], "Output",
 CellLabel->"Out[49]=",
 CellID->1145412252,ExpressionUUID->"9ecab329-b85f-4703-a52d-5a56b15f4097"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}, 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}]]], "Output",
 CellLabel->"Out[50]=",
 CellID->900307656,ExpressionUUID->"b1309838-bfef-4bdb-ae13-c32dacea0aa4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cnot", "==", "cz1", "==", "cz2"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[51]:=",
 CellID->1606586072,ExpressionUUID->"60913af4-f8cb-4363-9a8b-5b4806aea612"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[51]=",
 CellID->1863983650,ExpressionUUID->"9e761940-2b79-47c8-aa65-12801f9fa48a"]
}, Open  ]],

Cell["\<\
Depending on the Hamiltonian of a particular physical system, direct \
realization of the CNOT gate may be considerably difficult while the CZ gate \
is relatively easier to implement. In such a case, the above identity offers \
a straightforward workaround for a physical implementation of the CNOT gate.\
\>", "TechNoteText",
 CellID->799932562,ExpressionUUID->"6abe133f-d4e6-4e1c-a559-0061f164c710"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SWAP Gate", "TechNoteSection",
 CellTags->"Section13",
 CellID->1218939314,ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[52]:=",
 CellID->1843914595,ExpressionUUID->"416a44ab-67ad-4697-aa39-ac9c166cbed7"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[53]:=",
 CellID->336088308,ExpressionUUID->"24949bd9-63f1-49ec-93c4-0517f9f8fce5"],

Cell[TextData[{
 "Another interesting two-qubit gate is the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["SWAP"]], "paclet:QuantumMob/Q3S/ref/SWAP", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "1a92bc4f-5431-495f-93a4-bf7492e7da3f"],
 " gate that \[OpenCurlyQuote]swaps\[CloseCurlyQuote] the states of the two \
qubits and maps the logical basis states as"
}], "TechNoteText",
 CellID->1866541665,ExpressionUUID->"8e1b8139-4f5b-43f4-ab8a-addd28fc4c6a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"SWAP", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "70e7957f-f62a-492d-b2fd-298b150e232a"]
}], "TechNoteText",
 CellID->524648279,ExpressionUUID->"99d0f211-c322-44df-997d-159ab861a71e"],

Cell[BoxData[
 RowBox[{"for", " ", 
  RowBox[{Cell[TextData[Cell[BoxData[
    FormBox[
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      RowBox[{
       SubscriptBox["x", "2"], "\[Element]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
    "ff8569d5-2c51-4925-acc6-cd64fc41399b"]],ExpressionUUID->
    "9a7b9477-6dc2-4a42-bce9-11aaf19a2ff3"], "."}]}]], "TechNoteText",
 CellID->195770571,ExpressionUUID->"221bbebc-1c71-474f-a807-cfef7da68269"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[60]:=",
 CellID->371039593,ExpressionUUID->"5ba76920-3074-4411-aa85-668e378bbf70"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnQmMFEUbhlfODSgiBDDxIODBCpqAGkUi6G8EBeWQdVUwisi1iHLtKqKI
AfEIeEAUkBiJrgYRIyCKGjBmVVREV9B1Yf3XC5UVXBVF1wux/9et2H9TM11T
02f17PskkJnu2qqa/r7pqurpmafLtVOGj2+Sl5dXko//ho+e8Z/p00fPLGyL
J0WTSyZOmDxu7MDJpeMmjJve+9qm2FiGf/X4989ji5BGxqZNmyZNmhR3L+Kn
urq6V69e9fX1cXfkIF544YVbb7017l7Ej+fovPLKK1dccUUYXUoWf/31V/v2
7desWRN3Rw7imWeeue666+LuRfx4jg7T22bUqFFXX3113L04CKa3jbfoML1t
cHJo167d/v374+7I/2F623iLDtPbBlO7Vq1avfrqq3F35P8wvW28RSdjeldW
Vt500039+vXr0aPHNddc88QTT/jrphaYay1btmzkyJEFBQXnn3/+rFmzPvvs
swjaHTZs2OTJkyNoSJOM6c3oqFGn94svvnjooYfmHczo0aP//PNP3511Be/T
IUOGSI126NDh7bffDq9RwWOPPXbssceG3Yo+6vRmdDKiSO+ampqmTf+5YD54
8OCtW7fu2rXroYceatasGbbMnDkziP6mB4sINIGRqKysbPfu3Zs3bz777LOx
BaH8/vvvw2sXfPfdd3jJFRUVobaiz6pVq9zSm9HRQZHe119/Pbrdt29f59lg
+fLl2HjEEUf88ssvfrubjtra2hYtWqCJl19+2d6Itrp3746Nd911VxiNOjn3
3HNvu+22sFvRRHH2ZnR0cEtvjEGtW7dGn5999lnndixdjzzySGx/5JFH/PY1
HXPmzEHlp5xyirQdpyZsP+qoo8Jo1MmiRYtSW48Lt/RmdDRxS++qqioxBqVO
5CZNmoRdU6ZM8dVRF4qKilD5vHnzpO11dXVimrd3794w2rX54osv0Monn3zi
v6odO3bceeedfmpwS29GR7O8W3pv2LAB9Rx//PFWw0oZIwJWyh999BGezp8/
H7sKCwsD7LZNnz59UPmTTz6Jx1it4HguWLBA7EI0sauysjKMdp306tXr3nvv
9V9PeXl5fn7+tGnTPNfglt6MjmZht/QWszisGvB4/fr14r05dOhQPMWaAo97
9+4dYJ9tsDRG5eiV1fBCRLtYOuFp165dpVlfSGAIFi/cP+hty5Ytp0+f7u3P
3dKb0dEs7JbeS5cuRW/PO+88q+EClHghF198MZ4+/fTTeNyzZ0/pT3AawaiB
EfnAgQOeO9+pUydU/vrrr+PxGWecIdp977338PSkk07C47Vr10p/ggERR/iH
H37w3KjEhx9+2KRJkz179gRSG44eMry0tNTD37qlN6OjGR239H7uuefsRYQY
/kaNGiWGvwcffBC7LrroImf5Bx54AAt28Xqx6hkxYoS39BDnBLFi2rx5M8Zc
e/hr3749dr377rt24Zqamv79+9tXXzFYI7geGk0F5yLN1dkBDdatW9e8efMb
b7wx2264pTejoxkdt/SuqKjIa7hcn7pr1qxZ2DV+/Hh7ixgrTzzxxNmzZz/8
8MM41Hh/XXjhhR56PnjwYFS1ePFiaTvWUIcccgh21dbWii2///77CSecgI1X
XnnlsmXL5s6diw6gQCCfL2jewPPBBx/kZcPq1auz6oZbejM6mrdXuaU31sKi
w9u2bZN2iVHJeZFzwIAB0jsXqypvFx/E5dxhw4ZJ28UQjJWaPba+9dZb0mmq
vr7+qaee8tBoKt26dVuyZEnGYvv37/+vBugVuopAZzsxcEtvRkcnOpbyYx28
wdFDvCLnRsx8sBFvf+dtBjik2PLtt9/66bMAQx7qb9as2TfffOPcPnz48LyG
T5ztLeKQSt0LBExQkTy7du0KpLb333+/Xbt2mA9gFpHt3yo+1mF0dAor0vul
l15CD5s2bSouBFkNH1rhjYONl1xyibMkhh5sLCgoWLNmjVsQ//77bwzlJSUl
OBTqhcaZZ56J2hCUH3/8UWy57777xOCOGuxiqATzPbzSqVOnfvnllzovVpN7
7rkHrQdSFVZVyO3LLrvMQ25byvRmdHRQpDdeMmY46DY6edpppw0aNKhNmzZ4
eswxx3z88cfOkph6FRcX4xSBvZ07d54/f/5PP/3kLPDHH38cfvjh9hRU/dbb
smWLWKcgMYYMGXLyySeLv5oxY4ZU8s0330RzIsqFhYWbNm2SCmCOesMNN6Dz
3bt3v/zyy1OH8rT07t3b58cxAoQbL+TSSy/1fA+5Ir2THh30auHChZjnHHfc
cf369UOv0A2dY5JVdNR3DOIYYlWOFyJeAkalc8455+uvv05buLq6GrEQ97Dh
CIirowKcNJY2gD/PeACthgEIIRMRAR07dly0aFHakjgmjz/++Omnny5KIoft
o4QVTYsWLcTJE7Vhb/PmzTFVUDeNcyASpqqqSl1MB8w/MV77+X6E+o7B5EYH
B/mss87CccYubBRvTJ2PorKNjs7XGXAYt2/fjjWvznc5MWbNmTMHb1gc9p9/
/lnaiyOscwAFOMngDKC5CHrjjTfEZSt7VTV79mycFuyhdvXq1dhbVFSkrgdv
Ciz5dVqMAJ2vMyQxOl999VWXLl1WrFgh9v76669izpMxb7ONTkjf1hkzZgx6
i9OXtD2rA5gtOHGh8gEDBthbnFNNLOpxnunRo4e6koEDB3q4QB0SIX1bx4To
SIOauClr1apV6kqyjY7/9EYK4bA4Z1Y4n/Ts2RO9/fTTT6XCAR7A8vLy0tJS
vPHtLeL8fNVVV6Utj2GxdevWmKMq6ty3b1/Lli1T5/Bx4T+9kxIdTKexFxN7
RZ0eouM/vdGlww47DDMxrKEWLFiA0UdM4dJ+cBDgAcScDVVhYYL1/uLFi8eN
G9ehQwfMPzEOpi0vzg8Y3RR14uyBM7yfj62DxX96JyI6yNuuXbtiUaxep3iI
TiCTk88//3zo0KH26hsruAkTJqS9NzLAA4iz0JIlS7p162avcfB4/fr1aQtv
27YtPz+/T58+6oMzcuTIsWPH+u9bUAQyOTE/OiNGjMjTuB3LQ3QCnHvjFWGh
gRW64rt+YczusETaunVrXV2dW4HKykq863Fy2Llzp6IedLtt27bPP/98gH3z
ieLLaNliZnTQK3GD+u23366ux1t0Iv4hiFAXL2nBeRvDYqdOnaSrwals2LAB
k/Pffvstmo7pEPEPQUQcHYykxcXFaHHq1KkZC3uLTjTpvXLlykUNiDsi5s6d
K546lx5hgFfXpk2bzp07Z8xtq+F7LiF9C8Az0aR3LNFBouJoo7lbbrlFp7y3
6EST3gUFBXnpcPsMIhBWrFghvvc6bdq0efPm3fEvr732WmphjJJHH310WVlZ
eP3xQDTpHX10MPPv27dvXsNdsnffffcdDtKW9xydHP6VKvFJQSppp3lVVVVY
ewZ4130g5OqvVIkbZtKStrzn6ORweucAuZrekcH0Nhmmt0+Y3ibD9PZJfX19
lJfpSFbs27dv9+7dcfeCEEIIIYQQQgghhBBCksTevXt37NgRdy9Ieurq6gL5
pfFGCz+1FJgp3eanlgJKt31C6bbJULrtH0q3TYbSbZ9Qum0ylG77hNJtk8kl
6bZg+/btM2fOLC4urqmpiabFxEm3rYYvLZaVlU2cOHHhwoXR9IrSbT/U1tai
CeFqEaxbty685pwkS7q9fPny/v37i9+fBKeeemoEXaJ02ydbtmyRjl5k6Z0g
6TYYNGiQ8yhFk96UbvsEy4c9/5Kfnx9lelvJkW5bDT/3Ko6S8OlEkN6UbgeL
GHmjTO9ESLcl7r///mjSm9LtYIk+vRMh3ZaILL0p3Q6W6NPbSoJ0WyKy9G7M
0u1AvLcSOukduPfWfOm2hE56BxIdD9LteKMTlHQ7KO+thDq9Q/Lemi/dlsiY
3kFFJyvptgnRCUS6HaD3VkKR3qF6bw2Xbkuo0zvA6OhLtw2JTiDS7QC9txKK
9A7Ve2u4dFtCnd4BRkdfum1CdKyApNsBem8lFOkdnvfWMl66LaFO7wCjoy/d
NiE6VkDSbR3vrTcU6R2e9zYR0m0n6vQOMDr60m1DohOIdDuj99bKRuvsRL20
DMlKnAjpthN1egcbHU3pthWalTh66bZA4b3V1zpjztbRgZggtWrVyt7irNYK
wUpsJUS6jTy0j4l925u95YILLpDKBxIdKxvpthWCldiKT7otSOu91dc62xch
3XBeenISlJU4KdJt+7pcWqTLtjY+oyPQl27bBGUljl26LTDBe2t5shInTrrt
gUCik5V02wrIShy9dDsp3lsdK7GVc9LtpERHx0psxSHdToT31tKzEueedDsR
0dG0Esci3baS4L3VtBLnnnTbSkJ0NK3EcUm3BWZ6by1tK7GVo9JtgZnR0bcS
W3FLt3Uw2Uqc29JtHUy2ElO6nUpWVmJKt6OMTrZWYkq3JbKyEluUbkcYnWyt
xBal2ylkZSWmdDvK6GRrJaZ02yeUbpsMpds5CdPbJ0xvk2F6++Sdd965+eab
4+4FSc/GjRux8oq7F4QQQgghhBBCCCGEEEIIMYLq6upHH3007l6Q9FRUVKxc
uTLuXiQYfigvoHTbZCjd9gml2yZD6bZ/KN02GUq3fULptslQuu0TSrdNJiTp
tkWtc3xkTG8q0dWo05ta53hR/xAElegZUac3tc7xojh7U4mugzq9qXWOF0V6
U4mug+bSklrnWHBLbyrRNTEtvROndVYQnnSbSnTN8qald+K0zgrCk25Tia5Z
OMD0bpxaZzUhSbepRNcsHFR6N1qtc0bCkG5Tie5Tui1BrbMbsUi3qUT3Kd2W
oNY5LXFJt6lE9yndlqDWOS1xSbepRPcv3XZCrbNnQpJuU4muUziQ9DZT62zl
tHQ76Ur02KXbidY6W7ku3U60Et0E6Xaitc5Wrku3rSQr0Y2SbnvABK2z1Tik
2wlVolO6rYbSbR2SEh1KtyUo3dYhEdGhdDsVSrc1MT86lG4roHRbBzOjQ+m2
Tyjd1ofSbZ9Qup0VlG7bULotQem2JpRu+4TSbW9Qui2gdNsnlG6bDKXbOQnT
2ydMb5Nhevtk586dRl0KI06qq6s3btwYdy8IIYQQQgghhBBCCCGEEGIE5eXl
Y8aMibsX8WOmlXjt2rUlJSVx9yJ+aCX2Ca3EJkMrsX9oJTYZWol9QiuxydBK
7BNaiU0ml6zEgkR4b0NFJ70ZHQUGWomT5b0NFXV6MzoZMdBKnCzvbaiofwiC
0cmIaVZiK2ne21BRn70ZnYyY5rWUMN97GyqaS0tGxw2mt0QirMQSjI4bTO9U
zLcSSzA6bjC9UzHfSizB6LhhmnRbIhats/lWYglGxw3TpNsSsWidLeOtxBKM
jhumSbcl4tI6G24llmB03DBNui0Rl9bZcCuxBKPjhmnSbYlYtM6JsBI7YXTc
iEy6Hbj3VkfrnMNWYidJjE6CrMQZtc4heW/VWufcthInOjpJtBIrtM7heW8V
0u3cthInOjrJtRKn1TrbhGdvSZVuW43DSpwV5kQnKVbitJigdZZonFbitBgY
HWOtxEnROjdOK3EiomOylTgRWudGayVORHQMtxIbrnVu5FZik6OTICuxmVpn
WokFBkaHVmKf0EqcFbQSe4NWYm/QSmxDK7EErcSa0Eqc89BKbDK0EuckTG+f
ML1Nhumtz/8AMXfflg==
    "], {{0, 81.}, {122.5, 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{144., 144.},
    RasterInterpolation->"High"],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{122.5, 81.},
  PlotRange->{{0, 122.5}, {0, 81.}}]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[63]//TableForm=",
 CellID->677514827,ExpressionUUID->"3319b4a8-f94f-4ac8-b968-ff99cf8bbc70"]
}, Open  ]],

Cell[TextData[{
 "Given that the states ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "e1a70f29-c7a7-4611-be34-d93daa35de1b"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"1"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "e28214a6-d024-4028-b68a-dabbdac76c95"],
 " are not altered by the operation, the\nmatrix representation is given by"
}], "TechNoteText",
 CellID->809087288,ExpressionUUID->"582b724e-1059-4bf5-99c8-b28fbd21f305"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[64]:=",
 CellID->463596612,ExpressionUUID->"8a966bf6-c787-4237-aa69-65f87d256cae"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 0,
       1, 0, 1, 1, 0}}]]]]], "Output",
 CellLabel->"Out[64]//MatrixForm=",
 CellID->1156274875,ExpressionUUID->"24993ebf-c950-4ac2-936b-3bc547499a0a"]
}, Open  ]],

Cell["In quantum circuit model, it is depicted as", "TechNoteText",
 CellID->2003915004,ExpressionUUID->"44a99983-f18e-4e2e-8f6c-450e7eb85580"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[65]:=",
 CellID->813436327,ExpressionUUID->"92f47244-6c20-4aa7-8af4-7a12565b31bc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.8200000000000001, -1.18}, {1.18, -0.8200000000000001}}, {{
      0.8200000000000001, -0.8200000000000001}, {1.18, -1.18}}}], 
     LineBox[{{{0.8200000000000001, -2.18}, {1.18, -1.82}}, {{
      0.8200000000000001, -1.82}, {1.18, -2.18}}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`SWAP[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$]]]]], "Output",
 CellLabel->"Out[65]=",
 CellID->1603478823,ExpressionUUID->"a0ab58ab-1555-49ea-b20e-41909bfb47ff"]
}, Open  ]],

Cell[TextData[{
 "The SWAP gate can be implemented using the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/CNOT"],
 ". To see this, first note that a simultaneous exchange of the second and \
fourth columns and rows of the above matrix leads to"
}], "TechNoteText",
 CellID->534468518,ExpressionUUID->"59f568bf-1c4a-42a8-b77a-ff28263bc64c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[66]:=",
 CellID->2035770272,ExpressionUUID->"44c14ced-4996-43ac-9b42-14cf1df53f8d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[66]//MatrixForm=",
 CellID->1785621147,ExpressionUUID->"ac1279a3-d0b5-477f-92a7-5935cb214036"]
}, Open  ]],

Cell[TextData[{
 "which is nothing other than the matrix representation of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/CNOT"],
 ". On the other hand, the exchange of the second and fourth columns and rows \
is equivalent to flipping the bit values of the first qubit only when the \
second qubit is set to |1\:27e9. Hence, it corresponds to the CNOT gate with \
the second and first qubit as the control and target qubit, respectively. In \
short, the ",
 ButtonBox["SWAP gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/SWAP"],
 " can be achieved by a combination of the CNOT gates as follows"
}], "TechNoteText",
 CellID->1603079182,ExpressionUUID->"86dec959-b8e5-4afd-a8e7-588e5dff268d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"swap", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[67]:=",
 CellID->621976612,ExpressionUUID->"1c8bcd09-9e3a-4bc8-b2c6-b007cc070454"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.8200000000000001, -1.18}, {1.18, -0.8200000000000001}}, {{
      0.8200000000000001, -0.8200000000000001}, {1.18, -1.18}}}], 
     LineBox[{{{0.8200000000000001, -2.18}, {1.18, -1.82}}, {{
      0.8200000000000001, -1.82}, {1.18, -2.18}}}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`SWAP[
    $CellContext`S[1, Q3`$], 
    $CellContext`S[2, Q3`$]]]]], "Output",
 CellLabel->"Out[67]=",
 CellID->9339218,ExpressionUUID->"bf83cd3c-807f-4767-8088-554a04475f3a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}]]]], "Output",
 CellLabel->"Out[68]=",
 CellID->197930695,ExpressionUUID->"ae385424-f82f-4793-a761-8acd5dfb8b59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"swap", "==", "cnot"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[69]:=",
 CellID->661500490,ExpressionUUID->"09b3c5a1-b2cd-4571-8e86-8fdce980ca22"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[69]=",
 CellID->1233129467,ExpressionUUID->"59d1603d-1e0a-474f-b73d-5819d8319f98"]
}, Open  ]],

Cell[TextData[{
 "Interestingly, the SWAP gate itself is not universal, but the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "0f9dfc0b-39d9-453c-a675-eb518d512950"],
 " gate\[LongDash]the gate that equals SWAP when squared\[LongDash]is \
universal. That is, any quantum gate on a multi-qubit system can be \
implemented by combining ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "0b05be5e-8692-4a5b-84d8-b5a054b0849e"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/SingleQubitGates"],
 ". Indeed, one can combine the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "f0151c4b-fa75-4924-af0f-5c265bda68bc"],
 " gate with single-qubit rotations to construct the CZ gate (see the \
demonstration below). As discussed above, the CZ gate requires just two more ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/SingleQubitGates#347838345"],
 " to implement the CNOT gate, and it is hence universal."
}], "TechNoteText",
 CellID->666193793,ExpressionUUID->"fb85d899-8a12-44fb-bb59-df5eb9635ac7"],

Cell[TextData[{
 "Let us construct the CZ gate with the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "b7315c05-edda-4aa9-bb66-bffa244fc647"],
 "gate. Here is the matrix representation of the the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "454ba21f-a0fc-4433-a9bc-caa72aa86329"],
 "gate."
}], "TechNoteText",
 CellID->1938247085,ExpressionUUID->"fb46250f-2a57-4621-a3a1-58f8a69ec2fe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"Matrix", "@", 
      RowBox[{"Elaborate", "@", 
       RowBox[{"SWAP", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "2", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[70]:=",
 CellID->1040933486,ExpressionUUID->"333259a2-8209-4d72-a1db-bd8603d8d150"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[71]//MatrixForm=",
 CellID->350321222,ExpressionUUID->"19da9cf6-c69d-44e3-9f4f-ba95754c4543"]
}, Open  ]],

Cell[TextData[{
 "This is an explicit operator expression of the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "e185c8f7-1091-455a-a7b5-decc7ef41d04"],
 "gate in terms of the Pauli operators."
}], "TechNoteText",
 CellID->771058470,ExpressionUUID->"cbaf3894-9bb0-44f3-80a4-ec45f477bbf9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sqrtSWAP", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Elaborate", "@", 
     RowBox[{"ExpressionFor", "[", 
      RowBox[{"mat", ",", 
       RowBox[{"S", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<\!\(\*SqrtBox[\(U\)]\)\>\""}]}], 
   "}"}]}]], "Input",
 CellLabel->"In[72]:=",
 CellID->1895203240,ExpressionUUID->"4cc0ea9e-bc82-4448-91d9-1a4f7b09e7c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 1]], 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 1]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 2]], 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 3]], 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 3]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]]]}]}], ",", 
   RowBox[{"\<\"Label\"\>", 
    "\[Rule]", "\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>"}]}], "}"}]], "Output",
 CellLabel->"Out[72]=",
 CellID->2132214844,ExpressionUUID->"b930c1ab-9ff7-45a1-8fc7-6667f5f82edd"]
}, Open  ]],

Cell[TextData[{
 "This is a quantum circuit model to construct the CZ gate from the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "0c02f098-8315-4a01-9535-1f16c7d29832"],
 " gate and single-qubit rotation gates. In this diagram, ",
 Cell[BoxData[
  FormBox[
   SqrtBox["U"], TraditionalForm]],ExpressionUUID->
  "4f9c9fdf-a314-48eb-8ca5-c122c290c0f3"],
 " denotes the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "41972265-9899-479d-9dd8-e197cf8f3815"],
 "gate and ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "104915d6-026f-4c72-8e03-32e76e59fedd"],
 " the quadrant phase gate (or, equivalently, the rotation around the z-axis \
by angle \[Pi]/2)."
}], "TechNoteText",
 CellID->27233292,ExpressionUUID->"8e6ac6a3-8b8e-4f8f-8169-727d4a05e587"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"sqrtSWAP", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "sqrtSWAP", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "7"}], "]"}], ",", 
      RowBox[{"Dagger", "@", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "7"}], "]"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[73]:=",
 CellID->1505230369,ExpressionUUID->"cb04a488-e287-4016-8ec0-88b8c194e5a3"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
       StyleBox["\<\"S\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"S\"", "\"\[Dagger]\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->226.79999999999998`,
   PlotRange->{{0, 5}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, 
   $CellContext`S[1, 3], {Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, {
    $CellContext`S[1, 7], 
    $CellContext`S[2, -7]}]]], "Output",
 CellLabel->"Out[73]=",
 CellID->1783234933,ExpressionUUID->"0edde143-47cc-4a10-bdcc-4c39f532edc2"]
}, Open  ]],

Cell["\<\
To check if it indeed implements the CZ gate, take a look at the matrix \
representation of the quantum circuit model.\
\>", "TechNoteText",
 CellID->535686806,ExpressionUUID->"934f8208-9ca6-4c11-8389-661f52aeeca3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "qc", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[74]:=",
 CellID->851721286,ExpressionUUID->"6ed44b90-a812-4820-89a4-9650e9cf8901"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 1,
       0, 1, 0, -1, 0}}]]]]], "Output",
 CellLabel->"Out[74]//MatrixForm=",
 CellID->983526773,ExpressionUUID->"a5389b26-9bdc-4e65-a5ea-2f73d91ad5ae"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Unitary Gates", "TechNoteSection",
 CellTags->"Section14",
 CellID->1455445268,ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[75]:=",
 CellID->214055128,ExpressionUUID->"cfe51bff-9939-46ad-a364-51e0c1c7fb91"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[76]:=",
 CellID->167122186,ExpressionUUID->"ec5282c0-d35d-4d28-8eed-9b5293b86d87"],

Cell[CellGroupData[{

Cell["Definition", "Subsection",
 CellTags->"Section15",
 CellID->1829879946,ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13"],

Cell[TextData[{
 "Consider two qubits that are once again called control and target qubits. \
Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "7df1b7ef-7bf9-4bb2-8e0a-c82a10de8dd1"],
 " be a unitary operator on the target qubit. The controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d6c81065-e5e8-45aa-8e8b-48a9d091c461"],
 " gate is a unitary operator on the two-qubit Hilbert space defined, \
analogously to CNOT, by"
}], "TechNoteText",
 CellID->678943735,ExpressionUUID->"7c1893eb-e00c-4096-9df0-1d8392d13644"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["U", "c"], 
        TemplateBox[{"t"},
         "Ket"]}], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "b45eb968-4f6f-4d2e-aac4-e40cc028b521"],
 "."
}], "TechNoteText",
 CellID->1426737634,ExpressionUUID->"02441487-8f02-4051-8e70-9952087479c8"],

Cell["or equivalently,", "TechNoteText",
 CellID->377012236,ExpressionUUID->"c8bf8ca3-2051-4cf3-9e35-ff0cb5ee2bb9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"0"},
        "Bra"], "\[CircleTimes]", "I"}]}], "+", 
     RowBox[{
      TemplateBox[{"1"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"1"},
        "Bra"], "\[CircleTimes]", "U"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"cd25fdd5-a143-4446-9955-56a71898c384"],
 "."
}], "TechNoteText",
 CellID->1367891802,ExpressionUUID->"08fd83db-4c7e-4db6-a1c4-6278ac50a165"],

Cell[TextData[{
 "If the control qubit is in |0\:27e9, then it does nothing. On the other \
hand, if the control qubit is in |1\:27e9, then it operates unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "ee6fbbb7-d521-4262-b0a5-534ed0a3ddee"],
 " on the target qubit."
}], "TechNoteText",
 CellID->1345075079,ExpressionUUID->"cf6c2cd4-6631-4884-8ee3-e120c6989f5b"],

Cell["\<\
Analogously to the CNOT gate, the matrix representation of the \
controlled-unitary gate is thus given by\
\>", "TechNoteText",
 CellID->819163313,ExpressionUUID->"9ae49b92-0485-4f91-84e0-3259299ee14e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"]},
       {"0", "0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "55c085e5-4781-4627-a020-167c0d577b9c"],
 " ."
}], "TechNoteText",
 CellID->116500784,ExpressionUUID->"823ddb30-3d89-4cbc-ac32-204d30d25da4"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"i", " ", "j"}]], TraditionalForm]],ExpressionUUID->
  "67b2053c-b485-4ced-8776-ec6fe6dff079"],
 " are the elements of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "e6087d59-fe37-45d4-9881-210a8577b0c0"],
 "."
}], "TechNoteText",
 CellID->1671074271,ExpressionUUID->"e0c8f724-0aac-4da4-81fa-fe948087dd48"],

Cell["\<\
In quantum circuit model, a controlled-unitary gate is depicted as\
\>", "TechNoteText",
 CellID->1953344721,ExpressionUUID->"6073da26-228c-462c-9ad5-e60ca0338dcd"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
      LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"U\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->118.8,
    PlotRangePadding->Scaled[0.025]], "."}]}]], "Picture",
 CellID->954137231,ExpressionUUID->"5eead058-551c-43c0-bd6a-11877b21f329"],

Cell["\<\
The filled circle connected to the quantum circuit element on the target \
qubit indicates the conditional operation of the element conditioned on the \
state of the control qubit.\
\>", "TechNoteText",
 CellID->924049268,ExpressionUUID->"f4793b9d-fc4e-497a-9e56-0f0eaf02dbd1"],

Cell[TextData[{
 "For demonstration, consider a single-qubit rotation acting on the qubit ",
 StyleBox["S[2,$]", "Input"],
 ". It is a rotation around the y-axis by angle \[Phi]."
}], "TechNoteMathCaption",
 CellID->2041795819,ExpressionUUID->"e59af627-eb40-429f-b58e-f357d3b4785d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U", "//", "Elaborate"}], "//", "Matrix"}], "//", "ExpToTrig"}], "//",
   "MatrixForm"}]}], "Input",
 CellLabel->"In[78]:=",
 CellID->1821134520,ExpressionUUID->"8f26fa45-2b81-477a-bd0d-4f7691737668"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[80]//MatrixForm=",
 CellID->1309957850,ExpressionUUID->"5b60026c-186c-4318-9d99-9d5f251ad4cc"]
}, Open  ]],

Cell["\<\
This is a quantum circuit featuring the controlled-unitary gate.\
\>", "TechNoteMathCaption",
 CellID->1443037598,ExpressionUUID->"451bdde3-c2b5-452d-8582-a5f65a4cbf8e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}], "]"}]}]], "Input",
 CellLabel->"In[81]:=",
 CellID->1600084015,ExpressionUUID->"b36ba79e-719c-4053-abbb-c4ecfee00767"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[2, Q3`$], "Label" -> "U"]]]]], "Output",
 CellLabel->"Out[81]=",
 CellID->649519177,ExpressionUUID->"43e72801-05d6-4ea1-aebe-16e3bb01c965"]
}, Open  ]],

Cell["\<\
This is the explicit expression of the controlled-U gate  in terms of the \
Pauli operators.\
\>", "TechNoteMathCaption",
 CellID->378680471,ExpressionUUID->"c3f020cf-dc9a-4ba3-9827-94566e428171"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "qc", "]"}]], "Input",
 CellLabel->"In[82]:=",
 CellID->1488630036,ExpressionUUID->"9a550625-6acc-4557-878f-f628d228f20f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "4"], "]"}], "2"], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "4"], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2]]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 2]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[82]=",
 CellID->983664197,ExpressionUUID->"15d0352f-e1d7-4eb4-bd8a-b121945a3918"]
}, Open  ]],

Cell["\<\
The controlled-U gate maps the logical basis states as follows.\
\>", "TechNoteMathCaption",
 CellID->641929970,ExpressionUUID->"a02b844b-e1e8-44ad-96ec-f40f567abca4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[83]:=",
 CellID->2106646909,ExpressionUUID->"42ca4ef2-655c-4bed-a525-c2691d66a170"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], 
       "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1|>]]}], "-", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[85]//TableForm=",
 CellID->1228913040,ExpressionUUID->"f598328a-1bee-4de1-86cf-b08b5760c494"]
}, Open  ]],

Cell["\<\
When the control qubit  is in a superposition, the resulting state is an \
entangled state in general.\
\>", "TechNoteMathCaption",
 CellID->1736236263,ExpressionUUID->"5b8a7e8f-4101-4606-bd7c-f49e11f1239b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], "//", 
   RowBox[{
    RowBox[{"KetRegulate", "[", 
     RowBox[{"#", ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "&"}]}]}]], "Input",
 CellLabel->"In[86]:=",
 CellID->915076805,ExpressionUUID->"f0fc38c2-5dba-455f-b3cf-a648bd09aeff"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], "+", 
  
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["1", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0|>]]}]], "Output",
 CellLabel->"Out[86]=",
 CellID->1920663759,ExpressionUUID->"c6ba4064-be1f-480c-b6be-c8465992fcdf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"qc", "**", "in"}]}]], "Input",
 CellLabel->"In[87]:=",
 CellID->1955961279,ExpressionUUID->"e2c26a88-1106-4c00-b6c3-2c0e81632ab8"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 0|>]], "+", 
  
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[87]=",
 CellID->1890005442,ExpressionUUID->"e79a3afa-1355-4178-884a-13eda29f1b66"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase Acquisition", "Subsection",
 CellTags->"Section16",
 CellID->715838931,ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7"],

Cell[TextData[{
 "An important aspect of a controlled-unitary operator is that it induces \
relative phase shifts on the control qubit when the target qubit has been \
prepared in an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d72c7574-e55f-417f-84bc-b2adcf4fe225"],
 ". At first glace, it may sound counterintuitive since the definition given \
above seems to indicate that it changes only the target qubit depending on \
the state of the control qubit and keeps the latter intact. This is another \
feature distinguishing quantum gates from their classical counterparts."
}], "TechNoteText",
 CellID->901522823,ExpressionUUID->"412afd99-4edc-4af4-8913-ed6a480cb07b"],

Cell[TextData[{
 "Let us take a closer look to see how this works. Prepare the control qubit \
in a superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Psi]"},
     "Ket"], "=", 
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], "+", 
     TemplateBox[{"1"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "04b33533-0562-4608-b725-a96fec102669"],
 " and the target qubit in an eigenstate ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "d991046d-2cc8-41b9-a6b5-85cf5e124ead"],
 " of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "6b111da1-5fab-4ed2-a869-76d903e38487"],
 " with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"2b44b691-1c48-49c9-baf3-c1f5dcd541b9"],
 ". The controlled-unitary gate transforms the state to"
}], "TechNoteText",
 CellID->1396956576,ExpressionUUID->"907ed078-664a-495a-bf01-320cb5e81be8"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"\[Psi]"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"\[Phi]"},
      "Ket"]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Phi]"},
          "Ket"]}], ")"}]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], "\[CircleTimes]", 
        TemplateBox[{"\[Phi]"},
         "Ket"]}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "d52d9159-830d-4d51-a642-e0b209cbb6bd"],
 " ."
}], "TechNoteText",
 CellID->210460181,ExpressionUUID->"1e940d3f-f1a4-42df-ab6a-a3fb03a44c5d"],

Cell[TextData[{
 "This feature is extended to multi-control unitary gates and plays a crucial \
role in many quantum algorithms. In particular, the ",
 ButtonBox["quantum phase estimation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/QuantumPhaseEstimation"],
 " algorithm is a direct consequence of this feature."
}], "TechNoteText",
 CellID->298695458,ExpressionUUID->"2d9b3232-8cd9-4e86-b6f2-369c6e9772d4"],

Cell[TextData[{
 "For demonstration, consider the phase gate. Recall that state ",
 Cell[BoxData[
  TemplateBox[{"1"},
   "Ket"]],ExpressionUUID->"c8b87316-432d-4b48-a729-bbc90d23c883"],
 " is an eigenstate of it with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"840f2f8e-aaae-4feb-84ba-8e7fee414a46"],
 "."
}], "TechNoteMathCaption",
 CellID->1505279567,ExpressionUUID->"23cead0a-7b04-4142-8b7f-a558af914ae8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"U", "=", 
  RowBox[{"Phase", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "U", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[88]:=",
 CellID->1876320909,ExpressionUUID->"24b38aa4-2376-483e-b66b-cda1884a039c"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FormBox[
    TagBox[
     RowBox[{
      FormBox[
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
         "Subsuperscript"],
        $CellContext`S[2, 3]],
       TraditionalForm], "\[InvisibleApplication]", 
      RowBox[{"(", "\[Phi]", ")"}]}],
     HoldForm],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  Q3`Phase[$CellContext`\[Phi], 
   $CellContext`S[2, 3]]]], "Output",
 CellLabel->"Out[88]=",
 CellID->1422021188,ExpressionUUID->"f940e529-fda8-490b-95ad-27be3d25354b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      1, E^(Complex[0, 1] $CellContext`\[Phi])}}]]]]], "Output",
 CellLabel->"Out[89]//MatrixForm=",
 CellID->564599253,ExpressionUUID->"67a8f2c4-f2fc-402b-92f6-7c252af441d6"]
}, Open  ]],

Cell["We are interested in the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->774865820,ExpressionUUID->"0e6806d3-3b0c-4401-abeb-7b179757a738"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "op", "]"}]}], "Input",
 CellLabel->"In[90]:=",
 CellID->2117896949,ExpressionUUID->"680f2230-4831-48d9-9f90-45fde1504c64"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[2, 3]]]]]], "Output",
 CellLabel->"Out[91]=",
 CellID->646255298,ExpressionUUID->"54df934e-08cf-4244-b16e-0e87281c06ad"]
}, Open  ]],

Cell["\<\
Prepare the target qubit in the eigenstate with a finite phase shift. In \
addition, prepare the control qubit in a linear superposition of the \
computational basis states in order to pick up the phase shift.\
\>", "TechNoteMathCaption",
 CellID->193224567,ExpressionUUID->"ca12198d-43de-42d4-b084-daccacc73f50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "->", "1"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "op"}], 
   "]"}]}]], "Input",
 CellLabel->"In[92]:=",
 CellID->1062235589,ExpressionUUID->"ea168b83-5aa7-4ef7-a24c-77381a459be1"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"1"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-5, 2]}, {2, Rational[-1, 2]}}, {{
        2, -2.5}, {2, -0.5}}]]}, {LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 1|>]], 
   $CellContext`S[1, 6], "Separator", 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[2, 3]]]]]], "Output",
 CellLabel->"Out[92]=",
 CellID->815012837,ExpressionUUID->"2d551562-94a6-4e45-b25f-c6daf85cc20e"]
}, Open  ]],

Cell["\<\
Observe that the state does not change on the target qubit while the phase \
shift induced by the phase gate has been picked up by the state in the \
control qubit.\
\>", "TechNoteMathCaption",
 CellID->581406343,ExpressionUUID->"407835aa-c07a-49f4-984e-daa0774e14c0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "KetFactor"}]}], "Input",
 CellLabel->"In[93]:=",
 CellID->1127477995,ExpressionUUID->"f7a1b1ed-9d2f-4824-b7f6-706e094b019c"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]}],
    HoldForm],
   Q3`OTimes[
   Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + 
    E^(Complex[0, 1] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[94]=",
 CellID->365940228,ExpressionUUID->"1ad2510b-aefa-4b5a-9c16-056822a440bd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application: Controlled Power", "Subsection",
 CellTags->"Section17",
 CellID->616090041,ExpressionUUID->"453a152c-b3e2-48d6-be74-e6f1581ade56"],

Cell["\<\
An interesting variation of the controlled-unitary gate is the controlled \
power of a unitary gate, typically depicted by the quantum circuit element in \
Figure 1.\
\>", "TechNoteText",
 CellID->1275497408,ExpressionUUID->"7a616ccc-9433-4998-8369-2df7d2da84f1"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
      0, -4}, {2, -4}}, {{0, -6}, {2, -6}}}], {{InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`x[1]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -1}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`x[2]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -2}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`x[3]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -3}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`x[4]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -4}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"\[Psi]\""},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.16000000000000003`],
        FontWeight->"Light"], {-0.2, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
      LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -6}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -4.4}, {1.4, -0.6},
        RoundingRadius->0.4]}, InsetBox[
       StyleBox["\<\"x\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", "\"x\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{
          
          TemplateBox[{
           "\"\\!\\(\\*StyleBox[\\\"U\\\",FontSlant->\\\"Italic\\\"]\\)\"", 
            "\"\\!\\(\\*StyleBox[\\\"x\\\",FontSlant->\\\"Italic\\\"]\\)\""}, 
           "Superscript", SyntaxForm -> SuperscriptBox], 
          TemplateBox[{"\"\[Psi]\""}, "Ket"]},
         "RowDefault"],
        StripOnInput->False,
        FontSize->Scaled[0.16000000000000003`],
        FontWeight->"Light"], {2.2, -6}, NCache[
       ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], {InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`x[1]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -1}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`x[2]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -2}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`x[3]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -3}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`x[4]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -4}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{36, 46.800000000000004`}, {1, 1}},
    ImageSize->154.79999999999998`,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`QuantumCircuitIn[
     Ket[<|$CellContext`S[1, Q3`$] -> $CellContext`x[1], $CellContext`S[
        2, Q3`$] -> $CellContext`x[2], $CellContext`S[
        3, Q3`$] -> $CellContext`x[3], $CellContext`S[
        4, Q3`$] -> $CellContext`x[4]|>], 
     Q3`ProductState[<|$CellContext`T[Q3`$] -> {1, 1}|>, "Label" -> 
      Ket[{"\[Psi]"}]]], 
    Q3`ControlledPower[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$], 
      $CellContext`S[4, Q3`$]}, 
     $CellContext`T[3]], 
    Q3`QuantumCircuitOut[
     Q3`ProductState[<|$CellContext`T[Q3`$] -> {1, 1}|>, "Label" -> Row[{
         Superscript[
         "\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)", 
          "\!\(\*StyleBox[\"x\",FontSlant->\"Italic\"]\)"], 
         Ket[{"\[Psi]"}]}]], 
     Ket[<|$CellContext`S[1, Q3`$] -> $CellContext`x[1], $CellContext`S[
        2, Q3`$] -> $CellContext`x[2], $CellContext`S[
        3, Q3`$] -> $CellContext`x[3], $CellContext`S[
        4, Q3`$] -> $CellContext`x[4]|>]], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}, "PortSize" -> {1, 1.3}]]],ExpressionUUID->
  "185bf967-796c-48fc-89fb-ac0b51f19410"]
}], "Picture",
 CellID->2084184000,ExpressionUUID->"1475fba9-177e-40e7-8eb1-94b50eeac311"],

Cell[TextData[{
 StyleBox["Figure 1",
  FontWeight->"Bold"],
 ". A quantum circuit for the controlled power of unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "3650efe4-c847-4b81-9b3a-b0b25a20ea6b"],
 "."
}], "TechNoteCaption",
 CellID->1283463500,ExpressionUUID->"b9896500-fb22-49b7-ac82-574240863cb5"],

Cell[TextData[{
 "Consider a system consisting of a control register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "73faa963-5dd4-44e2-a129-af3b031341a9"],
 " qubits and a target register. Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "016ecfb4-d82f-462b-b5d9-d20ff469f062"],
 " be a unitary operator acting on the target register. The controlled power \
(or controlled exponentiation) of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d47ced69-8b87-41c4-9afb-ea9f58601ad3"],
 " is defined by"
}], "TechNoteText",
 CellID->1036421782,ExpressionUUID->"57a86a30-7e8e-4f75-b2d0-62c14934bee7"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["x", "1"], 
         SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["x", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"y"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["x", "1"], 
         SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["x", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["U", "x"], 
       TemplateBox[{"y"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "602bff8b-4228-4708-9b00-8a9c9162b6f7"],
 " ,"
}], "TechNoteText",
 CellID->1390517433,ExpressionUUID->"bd33c5dd-996b-431e-877e-f6876cc9e766"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", ":=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "1"], 
       SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["x", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"7e59d41d-141b-4617-940a-f252b5e059ab"],
 ". Like the controlled-unitary gate, the controlled-power gate induces \
relative phase shifts on the control register leaving the target register \
intact when the target register is prepared in an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "ea508afd-126b-4430-8da6-f04a6356d55e"],
 ". More explicitly, let ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "d1c5a5ab-526f-4d0b-b709-f001bbca670e"],
 " be an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "f4f6d235-d128-4aef-833c-3e1407e6c66f"],
 " belonging to eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", "\[Phi]"}]], 
   TraditionalForm]],ExpressionUUID->"a680a52f-e4ea-4dfc-9bec-9c52689284ca"],
 ". Then, the controlled-power gate makes a transformation such that"
}], "TechNoteText",
 CellID->357932788,ExpressionUUID->"20c21316-a861-4c55-9a22-3017d7cf3e7a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        UnderoverscriptBox["\[CapitalSigma]", 
         RowBox[{"x", "=", "0"}], 
         RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]], 
        TemplateBox[{"x"},
         "Ket"]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Phi]"},
          "Ket"]}], ")"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
       "\[ImaginaryI]", "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
        "\[Phi]"}]]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        UnderoverscriptBox["\[CapitalSigma]", 
         RowBox[{"x", "=", "0"}], 
         RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]], 
        TemplateBox[{"x"},
         "Ket"], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
         "\[ImaginaryI]", "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
          "\[Phi]"}]]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "633beea7-a511-4230-a850-005aab70d5d3"],
 " ."
}], "TechNoteText",
 CellID->232871499,ExpressionUUID->"c79df340-6df1-4264-a420-75bf8342298a"],

Cell[TextData[{
 "This is a straightforward generalization of the ",
 ButtonBox["phase-acquisition property",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/TwoQubitGates#715838931"],
 " of the controlled-unitary gate discussed above."
}], "TechNoteText",
 CellID->531662691,ExpressionUUID->"83f238dc-7afc-4872-a985-c7f796b7cff2"],

Cell[TextData[{
 "Note that for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "1"], 
       SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["x", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"61821f16-7d3e-4e46-877a-c475b2050444"],
 ","
}], "TechNoteText",
 CellID->1514408200,ExpressionUUID->"0bc08e04-978f-49bb-a8cf-34eb1ce33c50"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["U", "x"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", 
         RowBox[{"n", "-", "1"}]]], ")"}], 
      SubscriptBox["x", "1"]], 
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", 
         RowBox[{"n", "-", "2"}]]], ")"}], 
      SubscriptBox["x", "1"]], 
     SuperscriptBox[
      RowBox[{"\[Ellipsis]", "(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", "0"]], ")"}], 
      SubscriptBox["x", "n"]]}]}], TraditionalForm]],ExpressionUUID->
  "00ace3d2-b6b2-4581-a0fe-c1cccae885eb"],
 " ."
}], "TechNoteText",
 CellID->2034215257,ExpressionUUID->"1b15c47e-535b-4669-a118-3ded02f47ec2"],

Cell["\<\
This implies that the controlled-power gate is a combination of the usual \
controlled-unitary gates as in Figure 2.\
\>", "TechNoteText",
 CellID->1368761109,ExpressionUUID->"27f3aa74-7067-43e3-bf6e-6bcaf17ad5a4"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
      0, -4}, {2, -4}}, {{0, -6}, {2, -6}}}], {
      LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -6}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -4.4}, {1.4, -0.6},
        RoundingRadius->0.4]}, InsetBox[
       StyleBox["\<\"x\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", "\"x\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
    ImageSize->118.8,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`ControlledPower[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$], 
      $CellContext`S[4, Q3`$]}, 
     $CellContext`T[3]], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}]]],ExpressionUUID->
  "278339b7-71fd-40c6-9ddc-e7a41f26e68f"],
 "=",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
      0, -4}, {5, -4}}, {{0, -6}, {5, -6}}}], {LineBox[{{1, -1}, {1, -6}}], 
      DiskBox[{1, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "3"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -6}}], 
      DiskBox[{2, -2}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{1.6, -6.4}, {2.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -3}, {3, -6}}], 
      DiskBox[{3, -3}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -6.4}, {3.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {3, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -4}, {4, -6}}], 
      DiskBox[{4, -4}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -6.4}, {4.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {4, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
    ImageSize->226.79999999999998`,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 3]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 2]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 1]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
     Q3`ActOn[
      $CellContext`T[3], {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 0]], "LabelSize" -> 0.65], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}]]],ExpressionUUID->
  "753e9b5d-0655-41ba-826d-8c849e7ff69a"]
}], "Picture",
 CellID->757238962,ExpressionUUID->"2c1f89bf-12ac-494a-80c0-70f147dc605b"],

Cell[TextData[{
 StyleBox["Figure 2",
  FontWeight->"Bold"],
 ". A equivalent quantum circuit (right) of the controlled power of unitary \
operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "3564bf0e-0bc6-4269-95a2-e17930c777e9"],
 " (left). "
}], "TechNoteCaption",
 CellID->927142212,ExpressionUUID->"ee8dd00a-30e4-4b38-abb1-9e025434b3de"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->305516076,ExpressionUUID->"e6222d2e-fdec-4a7f-9a0a-cac47d0ffb1b"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[95]:=",
 CellID->1535052485,ExpressionUUID->"70a85bb5-d5d2-4ca2-bff2-638e2e8405be"],

Cell[TextData[{
 "Consider a control register consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "d82fd905-1f78-45d7-baae-5ba5a63c2620"],
 " qubits."
}], "TechNoteMathCaption",
 CellID->1475887768,ExpressionUUID->"46ce6238-8cd3-488a-959f-b47a70f46c9f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "$"}], "]"}]}]}], "Input",
 CellLabel->"In[96]:=",
 CellID->1092408791,ExpressionUUID->"f8be5084-1a72-4198-85c6-55a53be164b3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[98]=",
 CellID->1408780650,ExpressionUUID->"f8437ef1-1b79-40d1-94d5-fe3a70584ea6"]
}, Open  ]],

Cell["\<\
Consider a single-qubit unitary gate acting on the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1519843333,ExpressionUUID->"2c4b63aa-9188-47ac-bc7f-2e580e3232cc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"opU", "=", 
  RowBox[{"Phase", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"T", "[", "3", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[99]:=",
 CellID->21384525,ExpressionUUID->"73970fb6-d378-4c24-83f7-d7a3de8a5011"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FormBox[
    TagBox[
     RowBox[{
      FormBox[
       InterpretationBox[
        TemplateBox[{"T", 
          
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", "\"Z\""}, 
           "RowWithSeparators"]},
         "Superscript"],
        $CellContext`T[3]],
       TraditionalForm], "\[InvisibleApplication]", 
      RowBox[{"(", "\[Phi]", ")"}]}],
     HoldForm],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  Q3`Phase[$CellContext`\[Phi], 
   $CellContext`T[3]]]], "Output",
 CellLabel->"Out[100]=",
 CellID->337512046,ExpressionUUID->"6d9306c4-c600-40c1-b8f5-3b2099704d83"]
}, Open  ]],

Cell[TextData[{
 "Construct the controlled-power of ",
 StyleBox["opU", "Input"],
 " defined above."
}], "TechNoteMathCaption",
 CellID->978050365,ExpressionUUID->"64f01fe2-3329-4e1d-a62c-1d659773250c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cop", "=", 
  RowBox[{"ControlledPower", "[", 
   RowBox[{"SS", ",", "opU"}], "]"}]}]], "Input",
 CellLabel->"In[101]:=",
 CellID->2127797723,ExpressionUUID->"8a1fc341-884a-4ec1-aa43-b40f461924af"],

Cell[BoxData[
 RowBox[{"ControlledPower", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]]}], "}"}], ",", 
   InterpretationBox[
    TagBox[
     FormBox[
      TagBox[
       RowBox[{
        FormBox[
         InterpretationBox[
          TemplateBox[{"T", 
            
            TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", "\"Z\""}, 
             "RowWithSeparators"]},
           "Superscript"],
          $CellContext`T[3]],
         TraditionalForm], "\[InvisibleApplication]", 
        RowBox[{"(", "\[Phi]", ")"}]}],
       HoldForm],
      TraditionalForm],
     TraditionalForm,
     Editable->True],
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]]}], "]"}]], "Output",
 CellLabel->"Out[101]=",
 CellID->1662928265,ExpressionUUID->"91fea69c-27b2-4578-b61e-90ba49d26eec"]
}, Open  ]],

Cell["\<\
Construct a simple quantum circuit to demonstrate how the controlled-power \
gate works.\
\>", "TechNoteMathCaption",
 CellID->1664622810,ExpressionUUID->"6bf995ee-9020-414a-b0f1-ed570fc55b14"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductState", "[", 
     RowBox[{"T", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    "cop", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[102]:=",
 CellID->2027335310,ExpressionUUID->"d5c62256-61e0-4309-8387-d64cb3287486"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -5}, {2, -5}}}], InsetBox[
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], "+", 
      TemplateBox[{"1"},
       "Ket"]}], {-0.2, -5.}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1, 
     0}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -5}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{74.16, 38.160000000000004`}, {7.2, 7.2}},
   ImageSize->180,
   PlotRange->{{0, 2}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Q3`ProductState[<|$CellContext`T[Q3`$] -> {1, 1}|>]], 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]], "PortSize" -> {2, 1}]]], "Output",
 CellLabel->"Out[102]=",
 CellID->1242562724,ExpressionUUID->"459aee3c-aa54-4e2c-a688-3a5c4687c081"]
}, Open  ]],

Cell["Take computational basis states as inputs.", "TechNoteMathCaption",
 CellID->1320057003,ExpressionUUID->"a3f46d63-fbc3-4f35-9a29-27ae41f9605b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"Basis", "[", "SS", "]"}]}]], "Input",
 CellLabel->"In[103]:=",
 CellID->856233533,ExpressionUUID->"0684e151-c73f-4f8d-af8b-3f085687db78"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]]}], "}"}]], "Output",
 CellLabel->"Out[103]=",
 CellID->944356628,ExpressionUUID->"ac8b2c4c-f916-4a93-b1b0-5a2c5a3484f5"]
}, Open  ]],

Cell["Calculate the output for each input state.", "TechNoteMathCaption",
 CellID->1095734201,ExpressionUUID->"0bfda6ba-1614-40db-bb2c-d9b4938763a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"qc", "**", "in"}]}]], "Input",
 CellLabel->"In[104]:=",
 CellID->1234389837,ExpressionUUID->"4a7cc5e4-765d-497e-a5bc-a41ff5e948ed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 0|>]], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]]}], ",", 
   
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
        0, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
        1, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
        1, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
        0, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
        0, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
        1, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
        1, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[104]=",
 CellID->490447883,ExpressionUUID->"59071b77-84c2-423b-b875-9b7f1cd449ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", 
    RowBox[{"KetFactor", "[", "out", "]"}]}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellLabel->"In[105]:=",
 CellID->273770455,ExpressionUUID->"8f110ddf-5d41-47ec-bfb6-507f5470bc27"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["1", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 1|>]]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 1] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             1, $CellContext`S[3, Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           1, $CellContext`S[3, Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 2] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
             1, $CellContext`S[3, Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
           1, $CellContext`S[3, Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 3] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 4] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
             0, $CellContext`S[3, Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           0, $CellContext`S[3, Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 5] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
             1, $CellContext`S[3, Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           1, $CellContext`S[3, Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 6] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
              "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
             1, $CellContext`S[3, Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
                 "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        Q3`OTimes[
         Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
           1, $CellContext`S[3, Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[Q3`$] -> 0|>] + 
         E^(Complex[0, 7] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[Q3`$] -> 1|>]]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[105]//TableForm=",
 CellID->1547383929,ExpressionUUID->"6993ea62-7091-497f-83d0-7de589f9ce15"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->1362282140,ExpressionUUID->"a584828a-5f63-46d6-acca-17da31bc510a"],

Cell["\<\
Construct a simple quantum circuit to demonstrate how the controlled-power \
gate works.\
\>", "TechNoteMathCaption",
 CellID->523520144,ExpressionUUID->"5ace6b38-a9e2-4b77-80eb-3e959b2980e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"SS", "->", "0"}], ",", 
      RowBox[{"T", "->", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"kk", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "cop", ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[106]:=",
 CellID->770533652,ExpressionUUID->"b04ddcb3-b0e8-4c48-9266-0f030ebb00bc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}}], {InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -3.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"1"},
       "Ket"], {-0.2, -5.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -3.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
        2, -5.5}, {2, -0.5}}]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}, {3, -5}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{74.16, 38.160000000000004`}, {7.2, 7.2}},
   ImageSize->252,
   PlotRange->{{0, 4}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}, "Separator", 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]], "PortSize" -> {2, 1}]]], "Output",
 CellLabel->"Out[106]=",
 CellID->279596034,ExpressionUUID->"50a59a22-865b-4d07-8d4d-c2bacb8838cc"]
}, Open  ]],

Cell["Calculate the output state.", "TechNoteMathCaption",
 CellID->363088131,ExpressionUUID->"ea3b27aa-d6ea-4867-bf0b-11d5de562f12"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[107]:=",
 CellID->1079016412,ExpressionUUID->"ba343557-1c6b-4226-8f63-2f6d05302796"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox["T", 
            $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[107]=",
 CellID->2109626122,ExpressionUUID->"6610b719-8c02-4ca6-a3cf-eb5c237e51eb"]
}, Open  ]],

Cell["Check that the target qubit is factorized.", "TechNoteMathCaption",
 CellID->942690207,ExpressionUUID->"f1511856-759c-4555-b7cf-9bf84246565c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetFactor", "[", 
  RowBox[{"out", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[108]:=",
 CellID->473086067,ExpressionUUID->"b10a87b9-d775-453e-8b72-e0af68d42a5c"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[2, Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                 $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[2, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[3, Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                 $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
            "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[3, Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`T[Q3`$] -> 1|>]]}],
    HoldForm],
   Q3`OTimes[
   Ket[<|$CellContext`S[1, Q3`$] -> 0|>] + 
    E^(Complex[0, 4] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, Q3`$] -> 0|>] + 
    E^(Complex[0, 2] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[2, Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[3, Q3`$] -> 0|>] + 
    E^(Complex[0, 1] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[3, Q3`$] -> 1|>], 
    Ket[<|$CellContext`T[Q3`$] -> 1|>]]], 
  RowBox[{"2", " ", 
   SqrtBox["2"]}]]], "Output",
 CellLabel->"Out[108]=",
 CellID->716465632,ExpressionUUID->"7da32ef2-38cb-4f60-8880-dff6409c9131"]
}, Open  ]],

Cell["\<\
To focus on the state of the control register, ignore the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1762048567,ExpressionUUID->"a24652a6-33f8-44f8-bb4e-aafa4b4f1be2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetDrop", "[", 
  RowBox[{"out", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[109]:=",
 CellID->1674087129,ExpressionUUID->"888467fd-bd2d-4b83-ac6e-fe71ec9bb26f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[109]=",
 CellID->1552752720,ExpressionUUID->"eea6fc36-c5fe-414f-8ff0-cb976333b038"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->1016485255,ExpressionUUID->"307b8d33-34ac-49cc-a168-2603dc4e54e1"],

Cell["\<\
Consider again  the quantum circuit for controlled-power gate.\
\>", "TechNoteMathCaption",
 CellID->1235189013,ExpressionUUID->"720d3348-ec2a-4bcf-8cab-e9cdbeafcc6f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"cop", ",", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[110]:=",
 CellID->1297582908,ExpressionUUID->"9571ff5f-2c4a-44b3-9a39-ed0954bf2436"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -5}, {2, -5}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -5}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[110]=",
 CellID->862680693,ExpressionUUID->"10bdd45d-1a61-409a-b48c-c12f492ece7b"]
}, Open  ]],

Cell["\<\
Expand the controlled-power gate in terms of elementary gates (in this case, \
the controlled-unitary gates).\
\>", "TechNoteMathCaption",
 CellID->331049159,ExpressionUUID->"5b00c955-c9e2-4038-a7cd-9fb34b7ba309"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Expand", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[111]:=",
 CellID->1888208538,ExpressionUUID->"f28e6c6e-68c8-4519-8c90-aebec921c699"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}}], {LineBox[{{1, -1}, {1, -5}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], 
         TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {1., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -5}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {2., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -5}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {3., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`ActOn[
     Q3`Phase[4 $CellContext`\[Phi], 
      $CellContext`T[3]], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript[
      Superscript["Z", $CellContext`\[Phi]], 
      Superscript[2, 2]], "LabelSize" -> 0.65], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`ActOn[
     Q3`Phase[2 $CellContext`\[Phi], 
      $CellContext`T[3]], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript[
      Superscript["Z", $CellContext`\[Phi]], 
      Superscript[2, 1]], "LabelSize" -> 0.65], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Q3`ActOn[
     Q3`Phase[$CellContext`\[Phi], 
      $CellContext`T[3]], {
      $CellContext`T[Q3`$]}], "Label" -> Superscript[
      Superscript["Z", $CellContext`\[Phi]], 
      Superscript[2, 0]], "LabelSize" -> 0.65], 
   "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[111]=",
 CellID->2095711381,ExpressionUUID->"a5855174-3880-42fc-88f2-9f3cf55394a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "qc", "]"}], "-", 
   RowBox[{"Matrix", "[", "new", "]"}]}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[112]:=",
 CellID->1871953819,ExpressionUUID->"fba6c2a0-bc2a-4e9c-91fd-6323afbaf0c7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{1}, {
       2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {
       15}, {16}}}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0}}]]]]], "Output",
 CellLabel->"Out[112]//MatrixForm=",
 CellID->1865330116,ExpressionUUID->"e1524ffd-d512-4bf1-ac1e-74f7e97dda0e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application: Conditional Operation", "Subsection",
 CellTags->"Section17",
 CellID->1379525988,ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff"],

Cell[TextData[{
 "The CNOT gate and the controlled-unitary gate can be combined to achieve a \
variety of conditional gate operations. For example, consider a system \
consisting of a control register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "2b922721-8f59-4475-9ecf-8081bcea1f50"],
 " qubits and a target register of a single qubit. Suppose that you want to \
operate a unitary gate ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "4a95e72d-7750-4e2d-a2c8-9969571d6e6b"],
 " on the target qubit only when an odd number of the control qubits is set \
to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"1"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "4700c5e3-300d-40b7-b81b-bfa275a62410"],
 ","
}], "TechNoteText",
 CellID->1459827304,ExpressionUUID->"be3ad4e2-67a9-4f10-b0a7-db61881ebb40"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["U", 
        RowBox[{
         SubscriptBox["c", "1"], "\[CirclePlus]", 
         SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", "\[CirclePlus]", 
         SubscriptBox["c", "n"]}]], 
       TemplateBox[{"t"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "c961d966-d0ec-45a8-b10c-fe492251e4c2"],
 " ."
}], "TechNoteText",
 CellID->316831353,ExpressionUUID->"437d800f-a968-46d8-9800-b2f9d2c0e3f8"],

Cell[TextData[{
 "First, operate the CNOT gates consecutively with the first ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", " ", "\[Minus]", " ", "1"}], ")"}], TraditionalForm]],
  ExpressionUUID->"384b0335-b827-4145-becb-ab9f85d6d828"],
 " qubits in the control register as the control qubit and the last qubit in \
the control register as the target qubit. This transforms the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "1c7bb7e1-187a-4b4d-8a6d-64bba07245c8"],
 " qubit to",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", 
       "\[CirclePlus]", 
       SubscriptBox["c", "n"]}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "bb8c910c-1b1c-453e-bde2-bbf806d46593"],
 ". Then, the desired operation is implemented by applying the controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "798627e2-491f-450f-a1ad-8c50cb24997d"],
 " gate controlled by the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "c34cdc58-10ba-4e1a-a673-f9d4b09fb9e4"],
 " qubit. To get the control qubits back to the original state, operate the \
CNOT gates in the reverse order. Overall, the two equivalent quantum circuits \
in Figure 3 below implement the conditional operation."
}], "TechNoteText",
 CellID->1372588958,ExpressionUUID->"ad1f74b3-aede-47db-99a7-293ee6472cee"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -3}, {10, -3}}, {{0, -4}, {10, -4}}, {{
     0, -5}, {10, -5}}, {{0, -7}, {10, -7}}}], {LineBox[{{1, -1}, {1, -5}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, {
     LineBox[{{3, -3}, {3, -5}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -5}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -5}, {3.2666666666666666`, -5}}, {{
         3, -5.266666666666667}, {3, -4.733333333333333}}}]}}, {
     LineBox[{{4, -4}, {4, -5}}], 
     DiskBox[{4, -4}, 0.09], {CircleBox[{4, -5}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -5}, {4.266666666666667, -5}}, {{
         4, -5.266666666666667}, {4, -4.733333333333333}}}]}}, {
     LineBox[{{5, -5}, {5, -7}}], DiskBox[{5, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -7.4}, {5.4, -6.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -7}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -4}, {6, -5}}], 
     DiskBox[{6, -4}, 0.09], {CircleBox[{6, -5}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -5}, {6.266666666666667, -5}}, {{
         6, -5.266666666666667}, {6, -4.733333333333333}}}]}}, {
     LineBox[{{7, -3}, {7, -5}}], 
     DiskBox[{7, -3}, 0.09], {CircleBox[{7, -5}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -5}, {7.266666666666667, -5}}, {{
         7, -5.266666666666667}, {7, -4.733333333333333}}}]}}, {
     LineBox[{{9, -1}, {9, -5}}], 
     DiskBox[{9, -1}, 0.09], {CircleBox[{9, -5}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -5}, {9.266666666666667, -5}}, {{
         9, -5.266666666666667}, {9, -4.733333333333333}}}]}}, InsetBox[
     StyleBox["\<\"\[DescendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {2, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]],
     InsetBox[
     StyleBox["\<\"\[AscendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {8, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]], 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -3}, {10, -3}}, {{0, -4}, {10, -4}}, {{
     0, -5}, {10, -5}}, {{0, -7}, {10, -7}}}], {LineBox[{{1, -1}, {1, -3}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, {
     LineBox[{{4, -4}, {4, -5}}], 
     DiskBox[{4, -4}, 0.09], {CircleBox[{4, -5}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -5}, {4.266666666666667, -5}}, {{
         4, -5.266666666666667}, {4, -4.733333333333333}}}]}}, {
     LineBox[{{5, -5}, {5, -7}}], DiskBox[{5, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -7.4}, {5.4, -6.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -7}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -4}, {6, -5}}], 
     DiskBox[{6, -4}, 0.09], {CircleBox[{6, -5}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -5}, {6.266666666666667, -5}}, {{
         6, -5.266666666666667}, {6, -4.733333333333333}}}]}}, {
     LineBox[{{7, -3}, {7, -4}}], 
     DiskBox[{7, -3}, 0.09], {CircleBox[{7, -4}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -4}, {7.266666666666667, -4}}, {{
         7, -4.266666666666667}, {7, -3.7333333333333334`}}}]}}, {
     LineBox[{{9, -1}, {9, -3}}], 
     DiskBox[{9, -1}, 0.09], {CircleBox[{9, -3}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -3}, {9.266666666666667, -3}}, {{
         9, -3.2666666666666666`}, {9, -2.7333333333333334`}}}]}}, InsetBox[
     StyleBox["\<\"\[DescendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {2, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]],
     InsetBox[
     StyleBox["\<\"\[AscendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {8, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]]}]], "Picture",
 CellID->833281032,ExpressionUUID->"42ce8a38-a5fd-4f56-a691-af9baeaca46a"],

Cell[TextData[{
 StyleBox["Figure 3",
  FontWeight->"Bold"],
 ". Two equivalent quantum circuits for a conditional unitary gate based on \
sequences of CNOT gates. In principle, the two quantum circuits give the same \
result, but one quantum circuit may be more useful than the other depending \
on the physical connectivity of qubits in a particular quantum computer."
}], "TechNoteCaption",
 CellID->571282978,ExpressionUUID->"5c8a6fcd-8f70-4355-bb88-fb33d14ff756"],

Cell["\<\
This method is used to implement a multi-control unitary gate based on the \
Gray code.\
\>", "TechNoteText",
 CellID->1213442737,ExpressionUUID->"489d2626-339e-4c22-86bc-59ae9c2562c9"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->780471724,ExpressionUUID->"b8e144c2-025b-4ed9-8be3-8c9d2b5eae31"],

Cell["\<\
As a demonstration, consider a three-qubit control register. Suppose that we \
want to operate a rotation around the y-axis on the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1827368847,ExpressionUUID->"67eac4d9-0564-4823-8396-c9235f41c5c2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{
    RowBox[{"Distribute", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "[", "CNOT", "]"}], "[", 
       RowBox[{
        RowBox[{"Most", "[", "ss", "]"}], ",", 
        RowBox[{"Last", "@", "ss"}]}], "]"}], ",", "List"}], "]"}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"$n", "+", "1"}], ",", "2"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sequence", "@@", "cnot"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "$n", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Reverse", "[", "cnot", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[113]:=",
 CellID->1424575782,ExpressionUUID->"f6a65e8e-70ab-4aa7-9fed-2796da63ac11"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
     0, -4}, {6, -4}}}], {LineBox[{{1, -1}, {1, -3}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"R\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -3}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -3}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -3}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -3}, {5.266666666666667, -3}}, {{
         5, -3.2666666666666666`}, {5, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->262.8,
   PlotRange->{{0, 6}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[4, Q3`$]]], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[3, Q3`$]}], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[3, Q3`$]}]]]], "Output",
 CellLabel->"Out[117]=",
 CellID->1638618396,ExpressionUUID->"43740b83-7688-4543-914c-b4840d62cdb9"]
}, Open  ]],

Cell["\<\
Note the way the logical basis states are transformed through the above \
quantum circuit.\
\>", "TechNoteMathCaption",
 CellID->873169809,ExpressionUUID->"7e1d442c-ee61-45e6-8855-90ddc53a3787"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "ss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[118]:=",
 CellID->1609219912,ExpressionUUID->"4f766cc2-f8c7-4e98-a099-ff662b8f0117"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          0, $CellContext`S[3, Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
          1, $CellContext`S[3, Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
            0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
             "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
            1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]],
          " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[120]//TableForm=",
 CellID->2019825366,ExpressionUUID->"53e6b1e6-caa3-402d-a202-a898ab19ab62"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition into Elementary Gates", "Subsection",
 CellTags->"Section18",
 CellID->1847739219,ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15"],

Cell["\<\
How can you implement a controlled-unitary gate? The operation involves only \
two qubits, and in principle, it should be possible to implement any specific \
controlled-unitary gate. However, the requirements for a physical \
implementation of two-qubit gates is far more difficult to fulfill on \
realistic systems than for single-qubit gates. Fortunately, any \
controlled-unitary gate can be implemented using only the CNOT gate and \
single-qubit gates. This is one of the basic steps in establishing universal \
quantum computation.\
\>", "TechNoteText",
 CellID->192034466,ExpressionUUID->"4edc7e46-5256-40a9-a726-3ddceaa9b081"],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "72ee3eec-70a2-4218-a514-c4b738fe7643"],
 " be a unitary gate on the second (target) qubit controlled by the first \
(control) qubit. Suppose that ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "482d7c8e-0411-496b-8c03-b7622118e9d2"],
 " has Euler angles \[Alpha], \[Beta], and \[Gamma] and an additional phase \
factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], TraditionalForm]],
  ExpressionUUID->"f01f05ed-7b40-4560-9389-996b1c3a264d"],
 ", "
}], "TechNoteText",
 CellID->2002832268,ExpressionUUID->"cdde2c55-ba97-456a-b728-f9cdc11fa235"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", "\[Beta]", ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Gamma]", ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"1ceb2f79-208c-43ea-b423-55cfb3cd22d4"],
 " ."
}], "TechNoteText",
 CellID->1943245198,ExpressionUUID->"511a9445-33b3-4732-b4f1-06e04c3b02f9"],

Cell[TextData[{
 "Then one can always find three unitary operators ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "13fc0fd8-64b4-4a1b-91cf-e35261027499"],
 ", ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "d25d1512-d841-4f79-8ecf-3aa53afe092a"],
 ", and ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "ed6c3a87-b67c-4830-b6bc-ee86b25be7b7"],
 " such that"
}], "TechNoteText",
 CellID->1190739210,ExpressionUUID->"b5a75f30-df31-484d-926c-89133062a063"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], "A", " ", "X", " ", "B",
      " ", "X", " ", "C"}]}], TraditionalForm]],ExpressionUUID->
  "74ab9d9c-f73d-409c-b8b4-06573b856aa5"],
 " ,\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "B", " ", "C"}], "=", "I"}], TraditionalForm]],
  ExpressionUUID->"91f71196-5736-41cc-b04f-8c1e7c12218c"],
 " ,"
}], "TechNoteText",
 CellID->353796077,ExpressionUUID->"b12d9bfb-f4b6-4218-97ed-953fe6a934d9"],

Cell["\<\
where X is the Pauli X operator. More explicitly, a common choice is\
\>", "TechNoteText",
 CellID->2015931243,ExpressionUUID->"f464e4a6-30f3-4d3a-974c-a912caf858da"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{"\[Beta]", "/", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"faa23ecb-b643-490f-9a46-588cf6441d7f"],
 " ,"
}], "TechNoteText",
 CellID->906902382,ExpressionUUID->"90c6e493-254a-4535-a8f5-bdbdd6cdc4d6"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{
       RowBox[{"-", "\[Beta]"}], "/", "2"}], ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Gamma]"}], ")"}]}], "/", "2"}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "4654d436-6508-4610-abb5-0be68d6d88fc"],
 " ,"
}], "TechNoteText",
 CellID->1616891515,ExpressionUUID->"a41c275b-5578-47c0-abba-6f953fe1cbb0"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"C", "=", 
    RowBox[{
     SubscriptBox["U", "z"], "(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "-", "\[Gamma]"}], ")"}]}], "/", "2"}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"d0e584d1-6b09-480b-bdbc-36ca96bc9da7"],
 " ."
}], "TechNoteText",
 CellID->837623467,ExpressionUUID->"7762afa2-37e7-4765-96bc-bfbb5a06b4cc"],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      RowBox[{"y", "/", "z"}]], "(", "\[Phi]", ")"}], "=", 
    RowBox[{"X", " ", 
     RowBox[{
      SubscriptBox["U", 
       RowBox[{"y", "/", "z"}]], "(", 
      RowBox[{"-", "\[Phi]"}], ")"}], "X"}]}], TraditionalForm]],
  ExpressionUUID->"2b861489-f486-4764-a02d-ad68575af15c"],
 " for any \[Phi], the above choice satisfies the desired properties. These \
properties imply that the controlled-unitary gate can be implemented as in \
the following quantum circuit"
}], "TechNoteText",
 CellID->1182303784,ExpressionUUID->"0c6188b6-d96d-4b80-a1ca-37b08617b628"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->118.8,
   PlotRangePadding->Scaled[0.025]], "=", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
       StyleBox["\<\"A\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -2}, ImageScaled[{0.5, 0.5}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
       StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[ExponentialE]\\), \\(\
\[ImaginaryI]\\\\ \[CurlyPhi]\\)]\\)\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -1}, ImageScaled[{0.5, 0.5}]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->262.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->313511997,ExpressionUUID->"3e2c629a-69d4-4db3-a9e0-214f7814913b"],

Cell[TextData[{
 "where the last gate on the first qubit is the relative phase shift by \
\[CurlyPhi], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], 
     TemplateBox[{"0"},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{"1"},
      "Ket"], 
     TemplateBox[{"1"},
      "Bra"], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}]}], TraditionalForm]],
  ExpressionUUID->"04c67e1e-6647-4538-bbb6-b9def3f5571a"],
 ". Indeed, when the control qubit is in |0\:27e9, the two CNOT gates in the \
middle do nothing, and the combined operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", " ", "B", " ", "C"}], TraditionalForm]],ExpressionUUID->
  "656b77d4-b90f-4de0-b5b0-b6c3dc41a145"],
 " on the target qubit ends up with the identity operator. With the control \
qubit in |1\:27e9, on the other hand, the two CNOT gates are operational and \
the overall operator on the target qubit becomes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "X", " ", "B", " ", "X", " ", "C"}], "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], "U"}]}], 
   TraditionalForm]],ExpressionUUID->"07005521-c279-4c9c-8d8c-bafd3d51d026"],
 ", where the phase factor is canceled by the opposite phase from the control \
qubit."
}], "TechNoteText",
 CellID->1418747488,ExpressionUUID->"b2aa14f7-012e-461f-8753-5fc744091bfd"],

Cell["\<\
For demonstration, consider a unitary matrix to be applied conditionally on \
the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1378098175,ExpressionUUID->"67a96188-de7f-4f39-9302-26e05a3cefa4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"I", "*", 
     RowBox[{"TheRotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[121]:=",
 CellID->1028095504,ExpressionUUID->"2f987fe7-b09a-43aa-9da0-acd06d1d0825"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"3", "/", "4"}]]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"1", "/", "4"}]]}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[122]//MatrixForm=",
 CellID->641761720,ExpressionUUID->"2b24b42c-5fc1-4588-be74-013c155b8bb2"]
}, Open  ]],

Cell["We want to implement the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->1646790355,ExpressionUUID->"580acae7-b9ad-4398-9892-3974623ff510"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[123]:=",
 CellID->1153761970,ExpressionUUID->"e4ec4540-e7b1-4ebe-9cc9-659ed359ee49"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, Complex[0, 
       Rational[1, 2]] 3^Rational[1, 2] + 
    Rational[-1, 2] (-1)^Rational[3, 4] $CellContext`S[2, 4] + 
    Rational[1, 2] (-1)^Rational[1, 4] $CellContext`S[2, 5], "Label" -> 
    "U"]]]], "Output",
 CellLabel->"Out[124]=",
 CellID->1716960997,ExpressionUUID->"f0bc1d80-4168-4311-a741-5b14a5f34f7c"]
}, Open  ]],

Cell["\<\
First, find the Euler angles of the unitary operator and the global phase \
factor.\
\>", "TechNoteMathCaption",
 CellID->1240176371,ExpressionUUID->"1f1ae296-1351-4382-92b3-91f0bd122c45"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"det", "=", 
   RowBox[{"Det", "[", "mat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{
    RowBox[{"Arg", "[", "det", "]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
  RowBox[{"TheEulerAngles", "[", 
   RowBox[{"mat", "/", 
    RowBox[{"Sqrt", "[", "det", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[125]:=",
 CellID->167989615,ExpressionUUID->"c1e45f9d-c02a-4a61-9c8d-82ec774020f5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["\[Pi]", "4"]}], ",", 
   FractionBox["\[Pi]", "3"], ",", 
   FractionBox["\[Pi]", "4"]}], "}"}]], "Output",
 CellLabel->"Out[127]=",
 CellID->480491433,ExpressionUUID->"f7716602-97a9-49e0-9dea-8c1b096e74cb"]
}, Open  ]],

Cell["From the Euler angles, choose the component operators.", \
"TechNoteMathCaption",
 CellID->833485781,ExpressionUUID->"963fbeb9-5be5-4fc0-aa4e-e6535c958a1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opA", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"b", "/", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opB", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "b"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "+", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<B\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opC", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opD", "=", 
   RowBox[{"Phase", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[128]:=",
 CellID->359691886,ExpressionUUID->"22cf43a6-d342-468a-8655-a0dd1d1a727c"],

Cell["Finally, construct the equivalent quantum circuit model.", \
"TechNoteMathCaption",
 CellID->175061697,ExpressionUUID->"8b5bdf9d-59d5-40eb-9287-2f2fcbbd61e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"opC", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opB", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opA", ",", "opD"}], 
   "]"}]}]], "Input",
 CellLabel->"In[132]:=",
 CellID->209345089,ExpressionUUID->"6057a5cb-759f-49cf-8c29-3c747168ffea"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", 
         FractionBox["\[Pi]", "2"]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->298.8,
   PlotRange->{{0, 7}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`EulerRotation[{0, 0, Rational[1, 4] Pi}, 
    $CellContext`S[2, Q3`$], "Label" -> "C"], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`EulerRotation[{0, Rational[-1, 6] Pi, 0}, 
    $CellContext`S[2, Q3`$], "Label" -> "B"], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   Q3`EulerRotation[{Rational[-1, 4] Pi, Rational[1, 6] Pi, 0}, 
    $CellContext`S[2, Q3`$], "Label" -> "A"], 
   Q3`Phase[Rational[1, 2] Pi, 
    $CellContext`S[1, 3]]]]], "Output",
 CellLabel->"Out[132]=",
 CellID->670748328,ExpressionUUID->"42a7b163-cdce-4032-8a32-f72e616f0801"]
}, Open  ]],

Cell["Check the result.", "TechNoteMathCaption",
 CellID->2073812678,ExpressionUUID->"e03f0a78-7bf8-4ba2-a855-e6a6c4499cf0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", 
   RowBox[{"qc", "-", "new"}], "]"}], "//", "Chop"}]], "Input",
 CellLabel->"In[133]:=",
 CellID->1395051790,ExpressionUUID->"b450f130-cb5e-419e-9f7d-f748ae88fe65"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[133]=",
 CellID->926246328,ExpressionUUID->"35288c36-4faf-4022-94e8-bcbb56632e70"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Unitary Gates", "TechNoteSection",
 CellTags->"Section19",
 CellID->1476129218,ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[134]:=",
 CellID->384188579,ExpressionUUID->"9d4c47f8-41ea-494f-844e-6453be2e3d6f"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[135]:=",
 CellID->1721604371,ExpressionUUID->"c1581a35-f8c3-4b1e-8f6b-a0ffc1b1e408"],

Cell[TextData[{
 "Here, we ",
 ButtonBox["decompose",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/GivensFactor"],
 " an arbitrary two-qubit unitary gate into factors of controlled-unitary \
gates only. This is a remarkable advantage when one tries to build a quantum \
computer as you can just focus on how to implement the CNOT gate and \
single-qubit gates. Moreover, the same idea eventually leads to the proof of \
universal quantum computation on a larger system."
}], "TechNoteText",
 CellID->1572676782,ExpressionUUID->"618cd3d0-3ae7-44e0-8fd6-3c6a1dc0756c"],

Cell[CellGroupData[{

Cell["Two-Level Unitary Transforms", "Subsection",
 CellTags->"Section20",
 CellID->749947798,ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c"],

Cell[TextData[{
 "Consider an arbitrary two-qubit unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "74bbef41-b239-4256-b5d5-f4bb071f8944"],
 ". In the logical basis, it is represented by a unitary matrix"
}], "TechNoteText",
 CellID->791116743,ExpressionUUID->"faee8c52-55fe-4e60-b5e3-273a3c6e0222"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "13"], 
        SubscriptBox["U", "14"]},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "23"], 
        SubscriptBox["U", "24"]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubscriptBox["U", "33"], 
        SubscriptBox["U", "34"]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubscriptBox["U", "43"], 
        SubscriptBox["U", "44"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "49d60377-f5d7-4dc8-bd55-98e85746207e"],
 " ."
}], "TechNoteText",
 CellID->1227841024,ExpressionUUID->"440f6f4c-839f-4e67-9c31-69432084670e"],

Cell[TextData[{
 "To break the unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "b52a1ed7-0ba7-40e2-bf4c-cf1f5def16ab"],
 " down into more elementary quantum logic gates, we make use of ",
 StyleBox[ButtonBox["two-level unitary transformations",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/GivensRotation"],
  FontSlant->"Italic"],
 ". A two-level unitary transformation is a unitary operation with matrix \
representation that acts only on the two columns and rows of other matrices \
or column or row vectors. The descriptive word \
\[OpenCurlyDoubleQuote]two-level\[CloseCurlyDoubleQuote] should not be \
confused with \[OpenCurlyDoubleQuote]two-qubit\[CloseCurlyDoubleQuote]. A \
two-level transformation acts on multiple qubits, but it just transforms only \
two rows or columns at a time in the representation."
}], "TechNoteText",
 CellID->1153726345,ExpressionUUID->"2bd9e8b6-b3f9-469c-9b57-6fb1dc7da704"],

Cell["\<\
Let us start with a two-level unitary transformation of the form\
\>", "TechNoteText",
 CellID->1048831652,ExpressionUUID->"7a15a9f5-7c2b-4653-bf65-37cb896226ff"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "1"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "13", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         SubscriptBox["U", "14"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "14", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "13"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "d87e6b00-b56f-4bd7-803c-399755863cf5"],
 " "
}], "TechNoteText",
 CellID->1167800588,ExpressionUUID->"4c015e2a-e09c-4ec2-a883-33d0fc606559"],

Cell[TextData[{
 "with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalN]", "1"], ":=", 
    SqrtBox[
     RowBox[{"|", 
      SubscriptBox["U", "13"], 
      SuperscriptBox["|", "2"], 
      RowBox[{"+", 
       RowBox[{"|", 
        SubscriptBox["U", "14"], 
        SuperscriptBox["|", "2"]}]}]}]]}], TraditionalForm]],ExpressionUUID->
  "3d868cb0-ebb3-4c78-8ddc-f1586c530df3"],
 " such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "1"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "1", "\[Dagger]"], 
      SubscriptBox["T", "1"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"1f35209a-1fbf-48f3-884f-67e21e6eb28c"],
 ". When it multiplies ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "0055e7ce-786a-4e76-a5cf-7513877c3e78"],
 " from the right, it does not change the first two columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "feffd3c2-fd2b-499c-902f-353dd544563e"],
 ". It only alters the last two columns, and hence the name \
\[OpenCurlyQuote]two-level transformation\[CloseCurlyQuote]. The elements in \
the lower-right sub-block of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "1"], TraditionalForm]],ExpressionUUID->
  "de482d28-90a1-4a5c-a353-187cebeb0110"],
 " have been chosen so that the first element of the last column is \
canceled:"
}], "TechNoteText",
 CellID->1371432583,ExpressionUUID->"be7db872-aebd-4d29-b12a-d8aa9d5fe355"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubsuperscriptBox["U", "13", 
         RowBox[{" ", "\[Prime]"}]], "0"},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubsuperscriptBox["U", "23", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubsuperscriptBox["U", "33", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubsuperscriptBox["U", "43", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "229bae80-0c62-4782-80d7-bb21170e88c2"],
 " ."
}], "TechNoteText",
 CellID->725439230,ExpressionUUID->"d2586570-c120-4815-8bdd-7b090d969a06"],

Cell["\<\
Now take another two-level unitary transformation, this time, of the form\
\>", "TechNoteText",
 CellID->1192474591,ExpressionUUID->"c79ae208-23f5-46fa-824c-e75d2fff2245"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "2"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "12", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", "\[Prime]"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", 
           RowBox[{"\[Prime]", "*"}]}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "12"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "933ff944-3d93-4984-8319-45b52f0f25c3"],
 " ,"
}], "TechNoteText",
 CellID->1603057133,ExpressionUUID->"54722d52-bdb7-4f66-ae90-08ca15442533"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "2"], TraditionalForm]],ExpressionUUID->
  "42f4f8eb-8a60-4f33-83b1-ef413e77ab43"],
 " is a normalization factor like ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "1"], TraditionalForm]],ExpressionUUID->
  "b145126e-e49a-4ffe-87d5-cdb331e6d340"],
 " so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "2"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "2", "\[Dagger]"], 
      SubscriptBox["T", "2"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"9779262d-c14b-4c29-b0c0-8b11b570a42d"],
 ". It removes ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "13", 
    RowBox[{" ", "\[Prime]"}]], TraditionalForm]],ExpressionUUID->
  "e0a76015-ec0e-46ac-b6cf-de3ff7920c4f"],
 " while keeping the first and last column as they are:"
}], "TechNoteText",
 CellID->251399069,ExpressionUUID->"952610df-26fa-4d72-8c5a-212b1d359d4a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubsuperscriptBox["U", "12", "\[DoublePrime]"], "0", "0"},
       {
        SubscriptBox["U", "21"], 
        SubsuperscriptBox["U", "22", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubsuperscriptBox["U", "32", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubsuperscriptBox["U", "42", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "979aec3f-ddc0-42d0-893c-fc1f3e50ff73"],
 " ."
}], "TechNoteText",
 CellID->1163819034,ExpressionUUID->"01a7d574-97b1-4513-a180-b9fee48e6720"],

Cell["Similarly, we go further with the two-level unitary matrix", \
"TechNoteText",
 CellID->1025447562,ExpressionUUID->"7bbe944e-65a6-4595-98d4-9c6566bcde42"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "3"], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubsuperscriptBox["U", "11", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         SubsuperscriptBox["U", "12", "\[DoublePrime]"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {
        RowBox[{
         SubsuperscriptBox["U", "12", 
          RowBox[{"\[DoublePrime]", "*"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "11"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "dae78453-2ab9-4d05-ae48-8aae8af0a905"],
 " "
}], "TechNoteText",
 CellID->1140907359,ExpressionUUID->"819b4a2b-cea4-45d6-8dd2-315a3a2f9afb"],

Cell[TextData[{
 "to remove element ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "12", "\[DoublePrime]"], TraditionalForm]],
  ExpressionUUID->"58b02cc1-973b-4a66-bcf7-475a5111e0b7"],
 " and get"
}], "TechNoteText",
 CellID->348498650,ExpressionUUID->"186b09fe-bdc5-425a-a3d9-2168477b0b6d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "3"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["U", "11", "\[Prime]\[Prime]\[Prime]"], "0", "0", 
        "0"},
       {"0", 
        SubsuperscriptBox["U", "22", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "32", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "42", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "505f2971-b178-4f6c-846a-f26ff01a3e47"],
 " ."
}], "TechNoteText",
 CellID->1028905181,ExpressionUUID->"711d23a5-bd5c-4dce-8fe4-9236a9e241cb"],

Cell[TextData[{
 "At this stage, all elements except for the first of the first column vanish \
(",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["U", "21", "\[Prime]\[Prime]\[Prime]"], "=", 
    RowBox[{
     SubsuperscriptBox["U", "31", "\[Prime]\[Prime]\[Prime]"], "=", 
     RowBox[{
      SubsuperscriptBox["U", "41", "\[Prime]\[Prime]\[Prime]"], "=", 
      "0"}]}]}], TraditionalForm]],ExpressionUUID->
  "06ee66e5-d340-4277-8501-c84a3cdeb493"],
 ") the product ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", 
    SubscriptBox["T", "1"], 
    SubscriptBox["T", "2"], 
    SubscriptBox["T", "3"]}], TraditionalForm]],ExpressionUUID->
  "9fc42948-ccec-4b1f-9f6b-3150b50e591b"],
 " is a unitary matrix. "
}], "TechNoteText",
 CellID->1271051423,ExpressionUUID->"04125d4e-3fc2-4dcd-bdfc-2ba2972bfb70"],

Cell["\<\
Repeating the procedure, we can remove all off-diagonal elements to get\
\>", "TechNoteText",
 CellID->1541429652,ExpressionUUID->"a27d0f24-19ca-4d80-8b92-75813d60eea7"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "L"]}], "=", "I"}], TraditionalForm]],ExpressionUUID->
  "8ea5b480-8693-4958-ad10-aae38ff8a622"],
 " ."
}], "TechNoteText",
 CellID->1712927403,ExpressionUUID->"2eb037f1-e08c-4499-abc5-5d61c9713351"],

Cell[TextData[{
 "As Tj are all unitary, it enables us to rewrite ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "75eab368-2039-46a2-8453-a51d75dee9a1"],
 " in a combination of two-level unitary transformations, that is,"
}], "TechNoteText",
 CellID->5090539,ExpressionUUID->"eb5151e6-dba9-415c-a179-e419fa112c54"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", "=", 
    RowBox[{
     SubsuperscriptBox["T", "L", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "2", "\[Dagger]"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}]}], TraditionalForm]],
  ExpressionUUID->"c92fea36-6858-4b54-9a85-a0bea3369da5"],
 " ."
}], "TechNoteText",
 CellID->1804826740,ExpressionUUID->"7e8a395b-efc0-4fde-88ce-a2f78edd4b83"],

Cell["\<\
For demonstration, consider a Hermitian operator on a two-qubit system. \
Physically, it corresponds to a transverse-field Ising model.\
\>", "TechNoteMathCaption",
 CellID->516505305,ExpressionUUID->"e31c1eb9-c123-47d3-871c-726a37523b11"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "H", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[137]:=",
 CellID->775759961,ExpressionUUID->"6cbb809c-af60-461b-a90d-af4c95e198b4"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellLabel->"Out[137]=",
 CellID->1308787834,ExpressionUUID->"d57bb907-a58d-4b68-b879-c2596a1ee8e5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", 
      RowBox[{"-", "\[ImaginaryI]"}], 
      RowBox[{"-", "\[ImaginaryI]"}], "1"},
     {"\[ImaginaryI]", "0", "1", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"\[ImaginaryI]", "1", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"1", "\[ImaginaryI]", "\[ImaginaryI]", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {4}, {3}, {3}, {
       4}, {1}, {2}, {4}, {3}, {2}, {1}}}, {
      2, Complex[0, -1], Complex[0, -1], 1, 0, Complex[0, 1], Complex[0, -1], 
       1, 0, Complex[0, -1], Complex[0, 1], 1, -2, Complex[0, 1], Complex[
       0, 1], 1}}]]]]], "Output",
 CellLabel->"Out[138]//MatrixForm=",
 CellID->122129817,ExpressionUUID->"a2316662-dffc-497d-844c-333f2715156a"]
}, Open  ]],

Cell["\<\
This is the unitary operator generated by the above Hermitian operator.\
\>", "TechNoteMathCaption",
 CellID->595736468,ExpressionUUID->"9e9bdb33-3885-4b97-b4a6-3b9aa0139fc3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", " ", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[139]:=",
 CellID->974055362,ExpressionUUID->"9f763984-cadc-4f1b-b2d7-eb9d66653a9e"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  Q3`MultiplyExp[Complex[0, 
     Rational[-1, 4]] Pi (Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellLabel->"Out[139]=",
 CellID->1575357876,ExpressionUUID->"df66e092-d4ce-42f4-9436-fe7db088bc68"]
}, Open  ]],

Cell[TextData[{
 "This shows the matrix representation of ",
 StyleBox["U", "Input"],
 " in the logical basis."
}], "TechNoteMathCaption",
 CellID->1817782849,ExpressionUUID->"d818ba92-80c1-44ed-8268-89b2f29e7ed9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "U", "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[140]:=",
 CellID->1373980921,ExpressionUUID->"159f42ef-b496-44a3-b012-497c207c35dd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[141]//MatrixForm=",
 CellID->157194427,ExpressionUUID->"b5aa7442-1d9e-471a-9f48-a93596020c0d"]
}, Open  ]],

Cell[TextData[{
 "This shows the decomposition of the unitary matrix into two-level matrices \
(displaying the first three elements). For the purpose of efficiency, the \
resulting list is given in terms of ",
 StyleBox["GivensRotation", "Input"],
 "."
}], "TechNoteMathCaption",
 CellID->642635412,ExpressionUUID->"5a7e27fe-2225-44e8-b317-d0ae0115f239"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"GivensFactor", "[", 
     RowBox[{
      RowBox[{"N", "@", "mat"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "//", "Chop"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"twl", "[", 
  RowBox[{"[", 
   RowBox[{";;", "4"}], "]"}], "]"}]}], "Input",
 CellLabel->"In[142]:=",
 CellID->1078108721,ExpressionUUID->"caaa5b20-76a0-4440-add3-3dd839c66643"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.18898223650461365`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"-", "0.566946709513841`"}], "-", 
                    RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.566946709513841`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"0.18898223650461365`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}],
                     "}"}]}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Q3`GivensRotation[{{Complex[0.18898223650461365`, -0.5669467095138409], 
      Complex[-0.566946709513841, -0.566946709513841]}, {Complex[
      0.566946709513841, -0.566946709513841], Complex[0.18898223650461365`, 
      0.5669467095138409]}}, {3, 4}, {
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.1622214211307625`"}], "+", 
                    RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
                    ",", "0.8583950752789522`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.8583950752789522`"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.1622214211307625`"}], "-", 
                    RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}]}],
                     "}"}]}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Q3`GivensRotation[{{
       Complex[-0.1622214211307625, 0.4866642633922876], 
       0.8583950752789522}, {-0.8583950752789522, 
       Complex[-0.1622214211307625, -0.4866642633922876]}}, {2, 3}, {
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.2525381361380527`"}], "-", 
                    RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}], 
                    ",", "0.9340497736158587`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.9340497736158587`"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.2525381361380527`"}], "+", 
                    
                    RowBox[{"0.25253813613805276`", " ", 
                    "\[ImaginaryI]"}]}]}], "}"}]}], "}"}], "SummaryItem"]}]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    Q3`GivensRotation[{{
       Complex[-0.2525381361380527, -0.25253813613805276`], 
       0.9340497736158587}, {-0.9340497736158587, 
       Complex[-0.2525381361380527, 0.25253813613805276`]}}, {3, 4}, {
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], "}"}]], "Output",
 CellLabel->"Out[143]=",
 CellID->942723797,ExpressionUUID->"a440580e-040d-4b09-9a05-601501accf09"]
}, Open  ]],

Cell[TextData[{
 "For a more intuitive form, you can convert ",
 StyleBox["GivensRotation", "Input"],
 " into the normal matrix form using ",
 StyleBox["Matrix", "Input"],
 ". Here the first three are shown."
}], "TechNoteMathCaption",
 CellID->1155771237,ExpressionUUID->"c1e2182b-67be-45fd-ba84-8cddb6f5a8d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Chop", "[", 
   RowBox[{"Matrix", "/@", 
    RowBox[{"twl", "[", 
     RowBox[{"[", 
      RowBox[{";;", "3"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[155]:=",
 CellID->1057593144,ExpressionUUID->"0ede892b-4cb1-4ba4-913c-aba1ed31bc97"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0"},
       {"0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {2, 2}, 0, {1, {{0, 1, 2}, {{1}, {2}}}, {1., 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.9999999999999999`", "0", "0", "0"},
       {"0", "0.9999999999999999`", "0", "0"},
       {"0", "0", 
        RowBox[{"0.18898223650461354`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.566946709513841`"}], "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.566946709513841`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.18898223650461354`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        0.9999999999999999, 0.9999999999999999, Complex[
         0.18898223650461354`, -0.5669467095138409], 
         Complex[-0.566946709513841, -0.566946709513841], Complex[
         0.566946709513841, -0.566946709513841], Complex[
         0.18898223650461354`, 0.5669467095138409]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789522`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789522`"}], 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {
        1., Complex[-0.16222142113076243`, 0.4866642633922876], 
         0.8583950752789522, -0.8583950752789522, 
         Complex[-0.16222142113076243`, -0.4866642633922876], 1.}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[155]=",
 CellID->372808929,ExpressionUUID->"11c3b3ed-a85f-48b4-a0ec-0bbb4d2bd38a"]
}, Open  ]],

Cell["Indeed, they reconstruct the original matrix.", "TechNoteMathCaption",
 CellID->1969536942,ExpressionUUID->"0abe399f-d574-48d6-9464-09cf9892c877"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "[", "twl", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[156]:=",
 CellID->694449336,ExpressionUUID->"2a5e5870-3c58-41bb-81a2-ff7c2bbea5dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[157]//MatrixForm=",
 CellID->1145675512,ExpressionUUID->"da1fef6f-3f18-4dae-b443-3d89cb699836"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Two-Level Unitary Transformations with Controlled-Unitary Gates\
\>", "Subsection",
 CellTags->"Section22",
 CellID->1363502801,ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0"],

Cell["\<\
We are still to express the two-level unitary transformations in terms of \
controlled-unitary gates. The two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->593579270,ExpressionUUID->"add844bf-4f28-4802-8dbf-0318c1198384"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "e083befc-a7e0-4768-988b-1f27cc7af22e"],
 " "
}], "TechNoteText",
 CellID->1225250575,ExpressionUUID->"b4f13e92-e965-4186-8e10-cdd2e6ac9ac3"],

Cell["\<\
is already in the form of the matrix representation of a controlled-unitary \
gate, and just corresponds to a single controlled-unitary\
\>", "TechNoteText",
 CellID->565722942,ExpressionUUID->"a106bff1-0e48-4ed8-8984-c0f8bee331c9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "8f633567-5d40-438e-aba9-efed74c06e17"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "2d010309-ce55-49c2-83d0-d75b6330abac"],
 "."
}], "TechNoteText",
 CellID->1195380925,ExpressionUUID->"3e71e7b5-e516-4ed5-a32a-a400626e5963"],

Cell["A two-level unitary matrix of the form", "TechNoteText",
 CellID->1057688790,ExpressionUUID->"031369b6-4115-4197-9093-4b5b90cab738"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "6c480a58-bff4-4f80-9c35-7dda6b9ea4c8"],
 " "
}], "TechNoteText",
 CellID->1853347311,ExpressionUUID->"3740369b-7399-4b7c-bf9d-b6dfb8397cec"],

Cell["\<\
also corresponds to a single controlled-unitary gate with the control and \
target qubit exchanged. Here, the first qubit is the target qubit and the \
second the control qubit:\
\>", "TechNoteText",
 CellID->2105439889,ExpressionUUID->"8265105d-e991-48df-989b-060f20b2b124"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "e38a6c68-2602-4891-bc34-1311b80dde5d"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "4d558d0d-ffca-4755-8bde-b9812f09c2c1"],
 "."
}], "TechNoteText",
 CellID->2040162804,ExpressionUUID->"65f0722c-cdde-4e17-9663-455704380a1b"],

Cell["\<\
\tMore complicated is the two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->144855179,ExpressionUUID->"beabb6e9-02f6-4562-8d67-2586c9ed9506"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "37c16ac8-7e58-4468-b68c-6d10cb79975f"],
 " . "
}], "TechNoteText",
 CellID->1482021402,ExpressionUUID->"92af741b-5dfb-4c57-96e9-69ece1ad09e3"],

Cell["\<\
As it affects both qubits, it cannot be represented by a single \
controlled-unitary gate. However, it is possible to bring it to the second of \
the above two forms by simultaneously exchanging the last two columns and \
rows.\
\>", "TechNoteText",
 CellID->1818365508,ExpressionUUID->"f005fddb-fefd-4a1e-94fd-6776cb80b0ac"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], "0", 
        SubscriptBox["U", "12"]},
       {"0", "0", "1", "0"},
       {"0", 
        SubscriptBox["U", "21"], "0", 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "7a86ab8c-235e-4dd8-8ed7-c6ce57b24b88"],
 " . "
}], "TechNoteText",
 CellID->429312499,ExpressionUUID->"70978724-636f-46cf-9224-a297fe97ad0f"],

Cell["\<\
The specified exchanges correspond to flipping the bit values of the second \
qubit only when the first qubit has a value of 1, and they can be implemented \
by applying the CNOT gate with the first qubit as the control qubit and the \
second qubit as the target qubit. These observations lead to the following \
equivalence,\
\>", "TechNoteText",
 CellID->2057600420,ExpressionUUID->"6be7269d-f409-4a5d-a017-6f6dba94b169"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "fd0b029d-8d4b-4398-8da1-87506b4b2332"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "3cdee78c-a236-4778-a65c-f5b50fb80706"],
 ". "
}], "TechNoteText",
 CellID->1161091299,ExpressionUUID->"82ae7617-f874-4f3b-8ffe-2e984b3250dd"],

Cell["\<\
which allows us to implement the two-level unitary transformation with two \
CNOT gates and a controlled-unitary gate.\
\>", "TechNoteText",
 CellID->277562004,ExpressionUUID->"51b2db5e-d601-4dc4-b5ae-00787ac0969b"],

Cell["\<\
Of course, the way is not unique. For example, it is also possible to bring \
the same two-level unitary matrix to the first two-level unitary form, this \
time, by simultaneously exchanging the second and fourth columns and rows.\
\>", "TechNoteText",
 CellID->650119944,ExpressionUUID->"9a3fbd85-d314-4f83-92f5-e46ad9e3273a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "21"]},
       {"0", "0", 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "11"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "10683ca9-7618-42dc-a15d-b71e59a3adf7"],
 " . "
}], "TechNoteText",
 CellID->169102872,ExpressionUUID->"1c920c34-03a3-4197-94f8-948a8611b7b4"],

Cell[TextData[{
 "These exchanges correspond to flipping the bit values of the first qubit \
only when the second qubit has a value of 1, that is, to applying the CNOT \
gate with the second qubit as the control qubit and the first qubit as the \
target qubit. Note that in this case, unitary matrix ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "4084441d-9e5a-4132-baea-8f23cd937a23"],
 " itself is modified through the exchanges, and the rows and columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "32a80573-6a45-46d2-8c11-76524149bbfd"],
 " are exchanged. This is equivalent to the basis change by the Pauli X \
matrix, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", "\[RightArrow]", " ", 
     SuperscriptBox[
      RowBox[{"U", " "}], "\[Prime]"]}], " ", "=", " ", 
    RowBox[{"X", " ", "U", " ", "X"}]}], TraditionalForm]],ExpressionUUID->
  "7c5991a1-4d8d-48e2-8f28-7d190e4d8098"],
 ". Putting all together, the two-level unitary matrix is implemented as"
}], "TechNoteText",
 CellID->991104723,ExpressionUUID->"7d507b5f-7ebc-45e2-95fe-99b0410d42be"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "89f4fe62-4810-4870-b7fa-c07e8a70e33c"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U'\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "b1853fbd-2d28-48c7-81bc-05f3cde24749"],
 ". "
}], "TechNoteText",
 CellID->1613913329,ExpressionUUID->"feb19f0c-ef1c-4a81-96a8-39cc6be55e9b"],

Cell["\<\
\tIn a similar manner, we can implement another form of two-level unitary \
matrix as\
\>", "TechNoteText",
 CellID->175375246,ExpressionUUID->"305a9ba2-1e31-4cc3-aaca-8be1de1b9cc0"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["U", "11"], "0", "0", 
       SubscriptBox["U", "12"]},
      {"0", "1", "0", "0"},
      {"0", "0", "1", "0"},
      {
       SubscriptBox["U", "21"], "0", "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "f5f73d4b-faa8-47cd-99b4-95b842181aa8"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{4, -2}, {4, -1}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, ImageScaled[{0.5, 0.5}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->295.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "9af252a6-d7fe-4869-ae7f-3fceeb977059"],
 "= ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{5, -2}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -1}, ImageScaled[{0.5, 0.5}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -1}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->367.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "88048059-bb49-4867-aa3c-b3d2e0a1135c"],
 "."
}], "TechNoteText",
 CellID->1184195838,ExpressionUUID->"c713e31e-6862-43f1-95b3-765b40de7bad"],

Cell["\<\
For a demonstration, consider a single-qubit rotation around the y-axis.\
\>", "TechNoteText",
 CellID->2048492517,ExpressionUUID->"58e84920-dc8c-42db-948d-ba1d72ee7e1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "U", "]"}], "//", "ExpToTrig"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[158]:=",
 CellID->555904515,ExpressionUUID->"df57f8c0-d3d4-4802-9d4b-eb661effcb49"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[159]//MatrixForm=",
 CellID->1650072520,ExpressionUUID->"d9415cb8-d290-44a8-9b7f-81c1317cbf52"]
}, Open  ]],

Cell["\<\
This is the two-level unitary transformation to be implemented with \
elementary gates.\
\>", "TechNoteMathCaption",
 CellID->691274085,ExpressionUUID->"c090a61b-de7b-475f-94f1-879eb4f6e7ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"GivensRotation", "[", 
    RowBox[{
     RowBox[{"Matrix", "[", "U", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "op", "]"}], "//", "ExpToTrig"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[160]:=",
 CellID->357016325,ExpressionUUID->"b038ee12-cb1f-486e-b4b5-72e894862208"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 3, 4, 6}, {{1}, {4}, {2}, {3}, {4}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], 1, 1, Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[161]//MatrixForm=",
 CellID->441869156,ExpressionUUID->"a9efa7b9-9e8c-4249-8900-4979ca520f0e"]
}, Open  ]],

Cell["This quantum circuit shows one implementation.", "TechNoteMathCaption",
 CellID->1549413286,ExpressionUUID->"586ba44a-d133-4393-998b-df051f90f86e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Spacer\>\"", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[162]:=",
 CellID->602394280,ExpressionUUID->"a64dacdb-20c7-4a74-9473-c3feaf940a38"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{5.76, 5.76}, {7.2, 7.2}},
   ImageSize->295.2,
   PlotRange->{{0, 8}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], "Spacer", 
   $CellContext`S[2, 1], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[1, Q3`$], "Label" -> "U"]], 
   $CellContext`S[2, 1], "Spacer", 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], "PortSize" -> 0.1]]], "Output",
 CellLabel->"Out[162]=",
 CellID->1118532525,ExpressionUUID->"c531c402-2ce1-4f9d-89ab-1226a2a9e760"]
}, Open  ]],

Cell["This is another implementation.", "TechNoteMathCaption",
 CellID->389328403,ExpressionUUID->"59e5bd6f-f7cb-4b67-91bd-10b198004228"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Spacer\>\"", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[163]:=",
 CellID->59796812,ExpressionUUID->"cac6d6f9-8c70-4a84-8c9c-9e235b81d4d2"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -1}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{5.76, 5.76}, {7.2, 7.2}},
   ImageSize->367.2,
   PlotRange->{{0, 10}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 1], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[1, 1], "Spacer", 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[1, Q3`$], "Label" -> "U"]], "Spacer", 
   $CellContext`S[1, 1], 
   Q3`CNOT[{$CellContext`S[1, Q3`$] -> 1}, {
     $CellContext`S[2, Q3`$]}], 
   $CellContext`S[1, 1], "PortSize" -> 0.1]]], "Output",
 CellLabel->"Out[163]=",
 CellID->94168347,ExpressionUUID->"64db1a07-4476-4ce8-acb9-dea5fa17c77f"]
}, Open  ]],

Cell["\<\
Check the equivalence of the two-level unitary matrix and the implementations\
\
\>", "TechNoteMathCaption",
 CellID->834281808,ExpressionUUID->"fafb3a72-0290-48ce-9954-d8c82c37ff76"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc1", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc2", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[164]:=",
 CellID->853615793,ExpressionUUID->"b5e37e89-dc3c-4bb8-92a2-bb9bb3fe6da2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[164]//MatrixForm=",
 CellID->1418788588,ExpressionUUID->"6e6ec4ca-57b6-465c-a7ba-0a684da6208c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[165]//MatrixForm=",
 CellID->2068865875,ExpressionUUID->"10bb4ac0-7004-4ffe-8d6e-583e1bc2b65c"]
}, Open  ]],

Cell[TextData[{
 "So far, we have determined the implementations of 4 \[Times] 4 two-level \
unitary matrices of different forms just by inspection, that is, in an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " manner. For more than two qubits, the size of the two-level unitary \
matrices is much larger, and it is difficult to find proper implementations \
in such a way. Fortunately, there is a ",
 ButtonBox["systematic way based on the Gray code",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/ref/GivensFactor"],
 "."
}], "TechNoteText",
 CellID->645391397,ExpressionUUID->"49cf7222-dcc6-4ebe-9b96-ec67e3c673d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demonstration", "Subsection",
 CellTags->"Section23",
 CellID->153308382,ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9"],

Cell["\<\
In the above, we have shown that an arbitrary two-qubit unitary gate can be \
carried out by first decomposing its matrix representation into two-level \
unitary matrices and then implementing the two-level unitary matrices by \
means of the CNOT and controlled-unitary gates. Here we demonstrate the whole \
procedure.\
\>", "TechNoteText",
 CellID->1821083521,ExpressionUUID->"7feb337b-aad0-44e7-9043-154e336795d6"],

Cell["\<\
Consider a two-qubit model. Physically, it describes two qubits coupled with \
each other through an Ising-type couping and subject to an external magnetic \
field..\
\>", "TechNoteMathCaption",
 CellID->1013800403,ExpressionUUID->"f05ef591-c1b2-484a-9eae-8a873e985d98"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}]], "Input",
 CellLabel->"In[166]:=",
 CellID->808117923,ExpressionUUID->"1963b422-7823-4e68-a4c3-8f0ca00ee5b8"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellLabel->"Out[166]=",
 CellID->97748634,ExpressionUUID->"ec6930bb-308f-404b-9661-c995ade6d0ac"]
}, Open  ]],

Cell["\<\
We are interested in simulating the time-evolution operator governed by the \
above Hamiltonian.\
\>", "TechNoteMathCaption",
 CellID->322701359,ExpressionUUID->"9934f4e4-ea83-4b1a-b44e-d5cf3c98da28"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", "*", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[167]:=",
 CellID->1245532038,ExpressionUUID->"cdece733-8fb4-4999-840a-5783b21928d4"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  Q3`MultiplyExp[Complex[0, 
     Rational[-1, 4]] Pi (Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellLabel->"Out[167]=",
 CellID->452680772,ExpressionUUID->"3eb70bc7-8f0b-4010-8646-df4ad547fec3"]
}, Open  ]],

Cell["\<\
This is the 4\[Times]4 unitary matrix to implement in terms of elementary \
gates.\
\>", "TechNoteMathCaption",
 CellID->730080199,ExpressionUUID->"e7b44c3f-92c8-4b10-8faa-c9690661bcb3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"U", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[168]:=",
 CellID->1883829282,ExpressionUUID->"4674d0ae-34a5-4aac-803c-50b3b6e57459"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[169]//MatrixForm=",
 CellID->882493169,ExpressionUUID->"c3f3d390-90c2-4789-9307-bdb8c09abd14"]
}, Open  ]],

Cell["\<\
First, decompose the 4\[Times]4 unitary matrix into the two-level unitary \
matrices.\
\>", "TechNoteMathCaption",
 CellID->2133759026,ExpressionUUID->"a382ce6e-c586-4619-8bf8-82de1aaad833"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"GivensFactor", "[", 
     RowBox[{
      RowBox[{"N", "@", "mat"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Chop", "@", 
   RowBox[{"Matrix", "[", "twl", "]"}]}]}]}], "Input",
 CellLabel->"In[172]:=",
 CellID->1258528729,ExpressionUUID->"d7864f38-cc2e-4575-bafb-99d65aecd045"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", "1.`", "0", "0"},
       {"0", "0", "1.`", "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1., 1., 1., 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.9999999999999999`", "0", "0", "0"},
       {"0", "0.9999999999999999`", "0", "0"},
       {"0", "0", 
        RowBox[{"0.18898223650461354`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.566946709513841`"}], "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.566946709513841`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.18898223650461354`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        0.9999999999999999, 0.9999999999999999, Complex[
         0.18898223650461354`, -0.5669467095138409], 
         Complex[-0.566946709513841, -0.566946709513841], Complex[
         0.566946709513841, -0.566946709513841], Complex[
         0.18898223650461354`, 0.5669467095138409]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789522`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789522`"}], 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {
        1., Complex[-0.16222142113076243`, 0.4866642633922876], 
         0.8583950752789522, -0.8583950752789522, 
         Complex[-0.16222142113076243`, -0.4866642633922876], 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", "1.`", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.25253813613805276`"}], "-", 
         RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}], 
        "0.9340497736158587`"},
       {"0", "0", 
        RowBox[{"-", "0.9340497736158587`"}], 
        RowBox[{
         RowBox[{"-", "0.25253813613805276`"}], "+", 
         RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        1., 1., Complex[-0.25253813613805276`, -0.25253813613805276`], 
         0.9340497736158587, -0.9340497736158587, 
         Complex[-0.25253813613805276`, 0.25253813613805276`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.35355339059327384`"}], "-", 
         RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], 
        "0.7264831572567789`", "0", "0"},
       {
        RowBox[{"-", "0.7264831572567789`"}], 
        RowBox[{
         RowBox[{"-", "0.35355339059327384`"}], "+", 
         RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1.`", "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {1}, {2}, {3}, {4}}}, {
        Complex[-0.35355339059327384`, -0.5892556509887896], 
         0.7264831572567789, -0.7264831572567789, 
         Complex[-0.35355339059327384`, 0.5892556509887896], 1., 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789521`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789521`"}], 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {
        1., Complex[-0.16222142113076243`, 0.4866642633922876], 
         0.8583950752789521, -0.8583950752789521, 
         Complex[-0.16222142113076243`, -0.4866642633922876], 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.9999999999999999`", "0", "0", "0"},
       {"0", "0.9999999999999999`", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.18898223650461354`"}], "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.5669467095138409`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.5669467095138409`"}], "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.18898223650461354`"}], "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        0.9999999999999999, 0.9999999999999999, 
         Complex[-0.18898223650461354`, 0.5669467095138409], Complex[
         0.5669467095138409, -0.5669467095138409], 
         Complex[-0.5669467095138409, -0.5669467095138409], 
         Complex[-0.18898223650461354`, -0.5669467095138409]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[173]=",
 CellID->1519960140,ExpressionUUID->"8db1c03e-45ef-4f97-8f2f-dd8bb804cc27"]
}, Open  ]],

Cell[TextData[{
 "Next, rewrite the two-level unitary matrices in terms of the CNOT and \
controlled-unitary gates. The first element of list ",
 StyleBox["twl", "Input"],
 " happens to be the identity matrix in this case, and it is excluded in the \
further analysis."
}], "TechNoteMathCaption",
 CellID->702850526,ExpressionUUID->"6046572a-5a8d-462c-87f1-604f37996030"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Expand", "/@", 
   RowBox[{"Rest", "[", "twl", "]"}]}]}]], "Input",
 CellLabel->"In[174]:=",
 CellID->1648731982,ExpressionUUID->"e7a875dd-2a45-4176-b53c-961560777468"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {GrayLevel[1], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
      Complex[0.18898223650461365`, 0.] + 
      Complex[0., -0.566946709513841] $CellContext`S[2, 1] + 
      Complex[0., -0.566946709513841] $CellContext`S[2, 2] + 
      Complex[0., -0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
       LineBox[{{1, -2}, {1, -1}}], 
       DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
        LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
           1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
       LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
       {GrayLevel[1], EdgeForm[Opacity[1]], 
        RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.1],
         FontWeight->"Light",
         FontSlant->Italic], {2., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{3, -2}, {3, -1}}], 
       DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
        LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
           3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->190.79999999999998`,
     PlotRange->{{0, 4}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
       $CellContext`S[1, Q3`$]}], 
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
      Complex[-0.1622214211307625, 0.] + 
      Complex[0., -0.8583950752789522] $CellContext`S[2, 2] + 
      Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
     
     Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
       $CellContext`S[1, Q3`$]}]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {GrayLevel[1], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
      Complex[-0.2525381361380527, 0.] + 
      Complex[0., 6.466853413996861*^-17] $CellContext`S[2, 1] + 
      Complex[0., 0.9340497736158587] $CellContext`S[2, 2] + 
      Complex[0., -0.25253813613805276`] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], 
       {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{1, -1}, 0.09]}, 
       {GrayLevel[1], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0}, 
      Complex[-0.35355339059327373`, 0.] + 
      Complex[0., 0.7264831572567789] $CellContext`S[2, 2] + 
      Complex[0., -0.5892556509887896] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
       LineBox[{{1, -2}, {1, -1}}], 
       DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
        LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
           1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
       LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
       {GrayLevel[1], EdgeForm[Opacity[1]], 
        RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.1],
         FontWeight->"Light",
         FontSlant->Italic], {2., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{3, -2}, {3, -1}}], 
       DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
        LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
           3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->190.79999999999998`,
     PlotRange->{{0, 4}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
       $CellContext`S[1, Q3`$]}], 
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
      Complex[-0.1622214211307625, 0.] + 
      Complex[0., 1.910269724657813*^-17] $CellContext`S[2, 1] + 
      Complex[0., -0.8583950752789521] $CellContext`S[2, 2] + 
      Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
     
     Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
       $CellContext`S[1, Q3`$]}]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {GrayLevel[1], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     AxesStyle->Large,
     FrameStyle->Large,
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    Q3`QuantumCircuit[
     Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
      Complex[-0.18898223650461357`, 0.] + 
      Complex[0., -0.5669467095138409] $CellContext`S[2, 1] + 
      Complex[0., 0.5669467095138409] $CellContext`S[2, 2] + 
      Complex[0., 0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
      "U"]]]}], "}"}]], "Output",
 CellLabel->"Out[174]=",
 CellID->1743970539,ExpressionUUID->"990b0642-62c4-4a0e-a815-0379312c182e"]
}, Open  ]],

Cell["\<\
This shows the overall quantum circuit model. Here the same label \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] has been used for different \
controlled-unitary gates just for convenience. Do not forget to reverse the \
order before plugging the gates in the quantum circuit model.\
\>", "TechNoteMathCaption",
 CellID->328948492,ExpressionUUID->"3523e715-b452-4dd9-884b-229139011a80"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"Reverse", "@", "gates"}]}]}]], "Input",
 CellLabel->"In[175]:=",
 CellID->1014397666,ExpressionUUID->"7623237b-ab08-4470-8a3d-1c6bcbf3cc24"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
     LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
         4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
     LineBox[{{5, -1}, {5, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{5, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -1}, {6, -2}}], 
     DiskBox[{6, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -1}}], 
     DiskBox[{7, -2}, 0.09], {CircleBox[{7, -1}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -1}, {7.266666666666667, -1}}, {{
         7, -1.2666666666666666`}, {7, -0.7333333333333334}}}]}}, {
     LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -2}, {9, -1}}], 
     DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
         9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
     LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->442.8,
   PlotRange->{{0, 11}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Complex[-0.18898223650461357`, 0.] + 
    Complex[0., -0.5669467095138409] $CellContext`S[2, 1] + 
    Complex[0., 0.5669467095138409] $CellContext`S[2, 2] + 
    Complex[0., 0.5669467095138409] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Complex[-0.1622214211307625, 0.] + 
    Complex[0., 1.910269724657813*^-17] $CellContext`S[2, 1] + 
    Complex[0., -0.8583950752789521] $CellContext`S[2, 2] + 
    Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0}, 
    Complex[-0.35355339059327373`, 0.] + 
    Complex[0., 0.7264831572567789] $CellContext`S[2, 2] + 
    Complex[0., -0.5892556509887896] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Complex[-0.2525381361380527, 0.] + 
    Complex[0., 6.466853413996861*^-17] $CellContext`S[2, 1] + 
    Complex[0., 0.9340497736158587] $CellContext`S[2, 2] + 
    Complex[0., -0.25253813613805276`] $CellContext`S[2, 3], "Label" -> "U"], 
   
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Complex[-0.1622214211307625, 0.] + 
    Complex[0., -0.8583950752789522] $CellContext`S[2, 2] + 
    Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
   Q3`CNOT[{$CellContext`S[2, Q3`$] -> 1}, {
     $CellContext`S[1, Q3`$]}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Complex[0.18898223650461365`, 0.] + 
    Complex[0., -0.566946709513841] $CellContext`S[2, 1] + 
    Complex[0., -0.566946709513841] $CellContext`S[2, 2] + 
    Complex[0., -0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
    "U"]]]], "Output",
 CellLabel->"Out[175]=",
 CellID->1180909134,ExpressionUUID->"b1408366-e2cf-454b-b054-4ee44f210012"]
}, Open  ]],

Cell["\<\
Check the above quantum circuit by converting it into the matrix \
representation.\
\>", "TechNoteMathCaption",
 CellID->608232459,ExpressionUUID->"92764ace-1689-49ff-9930-2bfaeb7a59b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[176]:=",
 CellID->540778693,ExpressionUUID->"85c51043-5ed8-4721-8789-7728f3721e37"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "-", 
       RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11785113019775788`"}], "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1178511301977579`"}], "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.11785113019775788`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11785113019775796`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "-", 
       RowBox[{"0.5892556509887898`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3535533905932737`"}], "-", 
       RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.11785113019775796`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "-", 
       RowBox[{"0.5892556509887897`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3535533905932737`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1178511301977579`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3535533905932739`"}], "-", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327384`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327395`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327384`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "+", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[177]//MatrixForm=",
 CellID->742656172,ExpressionUUID->"992c88f7-5cd1-4c7b-8f15-f83e93c4da65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "mat"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellLabel->"In[178]:=",
 CellID->326787606,ExpressionUUID->"de86b3f9-682a-4faa-b06d-29494ad665cb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[178]//MatrixForm=",
 CellID->222343541,ExpressionUUID->"161c7b9c-d6cd-428b-9774-ad2613c906d0"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/guide/QuantumInformationSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "4a34ab7c-05b0-4f6c-b807-210184726b24"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"2967b1dd-a3a9-4716-be27-\
45e3b7298b10"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "70de6aa0-fc83-43c9-8388-a1bac326c320"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "769e6e6d-dabe-4846-849f-cff5bf8c8365"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"68b342ce-135c-45ab-ae7e-\
a9563ed8d5eb"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. M. Greenberger, M. A. Horne, & A. Zeilinger, \
\[OpenCurlyDoubleQuote]Going beyond Bell\[CloseCurlyQuote]s theorem,\
\[CloseCurlyDoubleQuote]"}]]]], "http://arxiv.org/abs/0712.0921"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "715b2c9b-30d8-44af-9a1d-b13464ba1837"]}]],ExpressionUUID->
         "96f2f443-6413-4759-b26e-8ae1137c5350"],
        " in Bell\[CloseCurlyQuote]s Theorem, Quantum Theory, and Conceptions \
of the Universe, edited by Kafatos, M. (Kluwer Academic, Dordrecht, The \
Netherlands, 1989)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "aca9bd33-36b1-4873-9af7-a58e67bfb358"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. Bouwmeester, J.-W. Pan, M. Daniell, H. Weinfurter, & A. \
Zeilinger, Phys. Rev. Lett. 82 (7), 1345 (1999)"}]]]], 
             "https://doi.org/10.1103/PhysRevLett.82.1345"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "372de275-8bde-4213-b56f-5d908e2da901"]}]],ExpressionUUID->
         "35f39343-5903-4182-9813-e695994523e4"],
        ", \[OpenCurlyDoubleQuote]Observation of Three-Photon Greenberger- \
Horne-Zeilinger Entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "aa4c1e7d-4bdc-4382-bc6c-aa7b8343b83d"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J.-W. Pan, D. Bouwmeester, M. Daniell, H. Weinfurter, & A. \
Zeilinger, Nature 403, 515 (2000)"}]]]], "https://doi.org/10.1038/35000514"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "194c8bde-9f9c-4c5e-ace8-c80d4b3d98a1"]}]],ExpressionUUID->
         "bc8a168d-27b1-441c-b397-a901003bf326"],
        ", \[OpenCurlyDoubleQuote]Experimental test of quantum nonlocality in \
three-photon Greenberger-Horne-Zeilinger entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "a821e7eb-6571-4a82-8b5d-fd47d4a054b1"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "dcace612-9f2e-4398-a6eb-19cc364df333"]}]],ExpressionUUID->
         "04c801fc-7087-42fb-8486-8cbdc767fc3c"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "bea60db6-5aa3-4b2f-a998-954dfc342bfa"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "6037aaf0-965c-4c95-8037-45a5115df6d5"]}]],ExpressionUUID->
         "1c7a6834-2bff-45f7-bc10-1db8b3414f0f"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "dd6b64d8-b32e-4457-a692-5aae5ec7c290"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"b0d3eea2-70fc-49a3-84e5-\
86a47c581d7f"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"3b298671-4e8b-4e15-8788-e894e4a8c85b"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Two-Qubit Gates",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 3, 2, 21, 35, 48.390249}", 
    "history" -> {"12", "", "", ""}, "context" -> "QuantumMob`Q3S`", 
    "keywords" -> {"quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3S Tech Note", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3S", "status" -> "None", "summary" -> 
    "See also Section 2.2 of the Quantum Workbook (2022). This document \
introduces quantum logic gate operations acting on two qubits. Such \
operations are represented by 4*4 unitary matrices. We will see that any \
two-qubit gate operations can be decomposed into controlled-unitary gates. A \
controlled-unitary gate acts a unitary operator on one qubit depending on the \
logical state of the other qubit. A controlled-unitary gate on two qubits can \
be further decomposed into factors including only the CNOT gate and \
single-qubit rotation gates. In this sense, the CNOT gate alone is sufficient \
for any two-qubit gate. The controlled-unitary and CNOT gates have various \
interesting properties that make them useful in implementing quantum \
algorithms. In this document, we first examine the basic properties of the \
CNOT gate, and in particular, how it is used to generate an entanglement \
between two qubits. Then, we discuss the properties of the controlled-unitary \
gate and describe how to implement a controlled-unitary gate in terms of the \
CNOT gate and single-qubit rotations. Finally, we discuss how an arbitrary \
two-qubit unitary operation can be decomposed into controlled-unitary gates.",
     "synonyms" -> {}, "tabletags" -> {}, "title" -> "Two-Qubit Gates", 
    "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "Two-Qubit Gates", "type" -> "Tech Note", "uri" -> 
    "QuantumMob/Q3S/tutorial/TwoQubitGates"}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.2 for Mac OS X ARM (64-bit) (December 26, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"f7aee4aa-429a-431f-9c40-6b49bd23135e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Section11"->{
  Cell[18022, 452, 153, 2, 70, "TechNoteSection",ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458",
   CellTags->"Section11",
   CellID->1585062394]},
 "RasterizedOutput"->{
  Cell[21171, 561, 6849, 118, 114, "Output",ExpressionUUID->"d04d5aab-ece3-4cd9-b574-62fcdd61e8c0",
   CellTags->"RasterizedOutput",
   CellID->1461126496],
  Cell[119251, 3209, 6336, 110, 114, "Output",ExpressionUUID->"3319b4a8-f94f-4ac8-b968-ff99cf8bbc70",
   CellTags->"RasterizedOutput",
   CellID->677514827]},
 "Section12"->{
  Cell[95946, 2547, 147, 2, 70, "TechNoteSection",ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46",
   CellTags->"Section12",
   CellID->29167796]},
 "Section13"->{
  Cell[116233, 3114, 136, 2, 70, "TechNoteSection",ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436",
   CellTags->"Section13",
   CellID->1218939314]},
 "Section14"->{
  Cell[148117, 3969, 151, 2, 70, "TechNoteSection",ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e",
   CellTags->"Section14",
   CellID->1455445268]},
 "Section15"->{
  Cell[148747, 3988, 132, 2, 70, "Subsection",ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13",
   CellTags->"Section15",
   CellID->1829879946]},
 "Section16"->{
  Cell[174963, 4722, 138, 2, 70, "Subsection",ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7",
   CellTags->"Section16",
   CellID->715838931]},
 "Section17"->{
  Cell[188459, 5122, 150, 2, 70, "Subsection",ExpressionUUID->"453a152c-b3e2-48d6-be74-e6f1581ade56",
   CellTags->"Section17",
   CellID->616090041],
  Cell[320700, 8488, 156, 2, 70, "Subsection",ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff",
   CellTags->"Section17",
   CellID->1379525988]},
 "Section18"->{
  Cell[363313, 9479, 157, 2, 70, "Subsection",ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15",
   CellTags->"Section18",
   CellID->1847739219]},
 "Section19"->{
  Cell[383960, 10074, 148, 2, 70, "TechNoteSection",ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273",
   CellTags->"Section19",
   CellID->1476129218]},
 "Section20"->{
  Cell[385176, 10106, 149, 2, 70, "Subsection",ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c",
   CellTags->"Section20",
   CellID->749947798]},
 "Section22"->{
  Cell[435600, 11458, 193, 4, 70, "Subsection",ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0",
   CellTags->"Section22",
   CellID->1363502801]},
 "Section23"->{
  Cell[467864, 12362, 134, 2, 70, "Subsection",ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9",
   CellTags->"Section23",
   CellID->153308382]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Section11", 517677, 13634},
 {"RasterizedOutput", 517856, 13638},
 {"Section12", 518188, 13645},
 {"Section13", 518359, 13649},
 {"Section14", 518533, 13653},
 {"Section15", 518707, 13657},
 {"Section16", 518876, 13661},
 {"Section17", 519044, 13665},
 {"Section18", 519364, 13672},
 {"Section19", 519533, 13676},
 {"Section20", 519708, 13680},
 {"Section22", 519877, 13684},
 {"Section23", 520047, 13688}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[583, 21, 6835, 164, 50, "AnchorBarGrid",ExpressionUUID->"4cd3999f-1cef-4116-8f02-3aec65b2c295",
 CellID->1],
Cell[CellGroupData[{
Cell[7443, 189, 116, 1, 67, "TechNoteTitle",ExpressionUUID->"7bdb4169-71d5-404b-b82f-d01ee06df9d0",
 CellID->1379112571],
Cell[7562, 192, 4408, 100, 109, "TechNoteJumpBox",ExpressionUUID->"24ec9c1d-cdc2-4c4b-b09d-908e5a8aa256"],
Cell[11973, 294, 408, 13, 34, "TechNoteText",ExpressionUUID->"d408910d-f4aa-4937-9177-486fb45f3383",
 CellID->1308734266],
Cell[12384, 309, 1147, 23, 126, "TechNoteText",ExpressionUUID->"1fdaf110-9cfd-4687-ab77-a5c1f71a0d2c",
 CellID->1465929903],
Cell[13534, 334, 1390, 31, 126, "TechNoteText",ExpressionUUID->"a2c4bd20-1950-479d-9c59-73c95d801c74",
 CellID->1951481337],
Cell[14927, 367, 1851, 48, 175, "DefinitionBox",ExpressionUUID->"6aa964c6-df49-45d9-aab8-318e6ccc3bf5",
 CellID->407539380],
Cell[16781, 417, 135, 1, 30, "TechNoteCaption",ExpressionUUID->"9442e6dd-2b5d-40a0-966e-b2fc34a4136f",
 CellID->1189009377],
Cell[16919, 420, 300, 7, 35, "TechNoteMathCaption",ExpressionUUID->"af3bb25d-ffac-4bbe-9210-790d65114d11",
 CellID->1428640008],
Cell[17222, 429, 177, 3, 28, "Input",ExpressionUUID->"138b9ea6-f61e-4b69-8d6a-bb0ba73dd4e6",
 CellID->853967906],
Cell[17402, 434, 323, 6, 55, "TechNoteMathCaption",ExpressionUUID->"89876003-3b7c-4ea3-bd23-7a228b9ef9a6",
 CellID->1937193009],
Cell[17728, 442, 269, 6, 45, "Input",ExpressionUUID->"44b12c3a-fcfd-462a-8f10-39627b458736",
 CellID->403330096],
Cell[CellGroupData[{
Cell[18022, 452, 153, 2, 70, "TechNoteSection",ExpressionUUID->"838f415d-57de-4939-93c7-5dcfc414f458",
 CellTags->"Section11",
 CellID->1585062394],
Cell[18178, 456, 519, 14, 70, "TechNoteText",ExpressionUUID->"62984cd4-f3b3-450e-ad63-6354c092b443",
 CellID->609014923],
Cell[18700, 472, 554, 19, 70, "TechNoteText",ExpressionUUID->"f15d1350-5180-4052-b407-75252bfc5e41",
 CellID->806749259],
Cell[19257, 493, 537, 17, 70, "TechNoteText",ExpressionUUID->"9e23ca1b-a44b-44a1-8afb-c73a3b805a4f",
 CellID->1970532502],
Cell[CellGroupData[{
Cell[19819, 514, 263, 7, 70, "Input",ExpressionUUID->"83c952c4-342b-40cc-8c28-c5974248aacf",
 CellID->246957080],
Cell[20085, 523, 550, 17, 36, "Output",ExpressionUUID->"fb884d14-a627-4d43-aec8-d8125fbc132c",
 CellID->1263743562]
}, Open  ]],
Cell[CellGroupData[{
Cell[20672, 545, 496, 14, 70, "Input",ExpressionUUID->"c23bcfd0-0e4f-4fd2-852b-c63df535918b",
 CellID->149239284],
Cell[21171, 561, 6849, 118, 114, "Output",ExpressionUUID->"d04d5aab-ece3-4cd9-b574-62fcdd61e8c0",
 CellTags->"RasterizedOutput",
 CellID->1461126496]
}, Open  ]],
Cell[28035, 682, 170, 3, 70, "TechNoteText",ExpressionUUID->"f38629b7-da2d-49d4-9a4f-cab818683eae",
 CellID->690265281],
Cell[CellGroupData[{
Cell[28230, 689, 271, 6, 70, "Input",ExpressionUUID->"d5ffa1e0-0bff-4719-a383-a79ee77c4e02",
 CellID->581916673],
Cell[28504, 697, 804, 23, 91, "Output",ExpressionUUID->"b2e039f4-59b0-47f2-a205-f3c3406e2351",
 CellID->565678847]
}, Open  ]],
Cell[29323, 723, 192, 4, 70, "TechNoteText",ExpressionUUID->"10cf248c-0990-4653-9460-7564067fa844",
 CellID->107481873],
Cell[CellGroupData[{
Cell[29540, 731, 162, 3, 70, "Input",ExpressionUUID->"f7045bae-6c89-4de3-af4d-82643c928ee9",
 CellID->414092384],
Cell[29705, 736, 1563, 41, 48, "Output",ExpressionUUID->"4fdee805-5cae-40aa-b721-2f574ba9e798",
 CellID->1341960052]
}, Open  ]],
Cell[CellGroupData[{
Cell[31305, 782, 194, 4, 70, "Input",ExpressionUUID->"09b94d22-174c-4171-902d-bb4c6bcb5665",
 CellID->597624604],
Cell[31502, 788, 705, 21, 49, "Output",ExpressionUUID->"31b1a872-2454-4768-bc1f-9e2dce0ce0e0",
 CellID->214561916]
}, Open  ]],
Cell[32222, 812, 184, 3, 70, "TechNoteText",ExpressionUUID->"4ac4b380-e18c-42eb-8606-27ed2cd24c13",
 CellID->1181321350],
Cell[CellGroupData[{
Cell[32431, 819, 191, 4, 70, "Input",ExpressionUUID->"ea3e771d-8931-4af5-84ae-0743bdb4c361",
 CellID->981612935],
Cell[32625, 825, 795, 19, 103, "Output",ExpressionUUID->"8e7444e0-9843-4065-99e1-f67b4f307d45",
 CellID->790740182]
}, Open  ]],
Cell[33435, 847, 283, 5, 70, "TechNoteText",ExpressionUUID->"d9581d0a-dbd2-482a-b817-f1d73dde1e39",
 CellID->606925297],
Cell[33721, 854, 747, 16, 70, "TechNoteText",ExpressionUUID->"f58bb1d9-d484-4ea8-8203-51d02a66f420",
 CellID->46143429],
Cell[CellGroupData[{
Cell[34493, 874, 644, 19, 70, "Input",ExpressionUUID->"62b3d615-d6f9-4ca7-b812-d7cc7d96ff73",
 CellID->291014636],
Cell[35140, 895, 4194, 112, 38, "Output",ExpressionUUID->"2943fa6b-38b3-426a-afc5-2822870f7129",
 CellID->832285012]
}, Open  ]],
Cell[39349, 1010, 617, 14, 70, "TechNoteText",ExpressionUUID->"383827ed-7706-4ca2-876b-5a46bbd3d939",
 CellID->1152615977],
Cell[CellGroupData[{
Cell[39991, 1028, 272, 7, 70, "Input",ExpressionUUID->"6b667b08-6574-4554-b334-73f93014673e",
 CellID->1714229499],
Cell[40266, 1037, 1216, 28, 104, "Output",ExpressionUUID->"0a0f8b28-3957-4ba7-93e4-72e44e9e19b4",
 CellID->130382963]
}, Open  ]],
Cell[CellGroupData[{
Cell[41519, 1070, 498, 14, 70, "Input",ExpressionUUID->"540f11dd-52fa-4772-a68f-e5ab52460160",
 CellID->1435008719],
Cell[42020, 1086, 11383, 280, 153, "Output",ExpressionUUID->"7c5dd0c5-16f6-4da2-8ba0-dfab4f58ef1b",
 CellID->6706753]
}, Open  ]],
Cell[53418, 1369, 988, 22, 70, "TechNoteText",ExpressionUUID->"e9d8643a-bdae-44f6-a386-3125232e6ab1",
 CellID->1854176847],
Cell[CellGroupData[{
Cell[54431, 1395, 943, 28, 70, "Input",ExpressionUUID->"39dc9580-7a1b-4382-b6f3-3f739515f075",
 CellID->1015065912],
Cell[55377, 1425, 1593, 33, 279, "Output",ExpressionUUID->"8dc93b98-e0ec-4db3-8545-b9ade51d7d9c",
 CellID->2107153420]
}, Open  ]],
Cell[56985, 1461, 143, 1, 70, "TechNoteText",ExpressionUUID->"4f139bdc-bf15-4ac6-a51c-1922d819f608",
 CellID->1898388060],
Cell[57131, 1464, 523, 19, 70, "TechNoteText",ExpressionUUID->"4023a0e6-e622-4f9b-8d77-e119e9169775",
 CellID->1043580941],
Cell[57657, 1485, 1369, 43, 70, "TechNoteText",ExpressionUUID->"0d1cfb35-cdd6-4168-9bde-3aaecc4c87de",
 CellID->965930338],
Cell[59029, 1530, 654, 20, 70, "TechNoteText",ExpressionUUID->"d04b39be-74fb-4402-80d2-5e0712fe2a98",
 CellID->1562303093],
Cell[59686, 1552, 1170, 35, 70, "TechNoteText",ExpressionUUID->"df80024c-88fc-402c-99a8-3ac54f6c6c08",
 CellID->345532182],
Cell[60859, 1589, 475, 17, 70, "TechNoteText",ExpressionUUID->"09b33eed-7151-471a-aa80-5102c9af7547",
 CellID->563601386],
Cell[61337, 1608, 1089, 31, 70, "TechNoteText",ExpressionUUID->"5cc10dbd-9cab-4ab3-b1a4-f1945afe3841",
 CellID->2045611232],
Cell[62429, 1641, 1119, 39, 70, "TechNoteText",ExpressionUUID->"d3286731-09ef-4ca1-af2d-6ac91cd108fe",
 CellID->1522271401],
Cell[63551, 1682, 1193, 38, 70, "TechNoteText",ExpressionUUID->"47aa758e-46c4-4652-9c32-230a16c89dec",
 CellID->1842749896],
Cell[CellGroupData[{
Cell[64769, 1724, 272, 7, 70, "Input",ExpressionUUID->"1ed5df0f-24ab-4c07-b89d-4fc278fbb02d",
 CellID->88345038],
Cell[65044, 1733, 2861, 63, 281, "Output",ExpressionUUID->"65240db2-0ae9-44dc-bf7a-880122ac5f78",
 CellID->343301842]
}, Open  ]],
Cell[CellGroupData[{
Cell[67942, 1801, 417, 12, 70, "Input",ExpressionUUID->"40759460-5bf8-427d-90d3-4d53518267a3",
 CellID->1915435092],
Cell[68362, 1815, 5178, 131, 59, "Output",ExpressionUUID->"74499f83-ff42-43ee-a385-0aac7e4a3112",
 CellID->2063407529]
}, Open  ]],
Cell[73555, 1949, 305, 5, 70, "TechNoteText",ExpressionUUID->"79613866-65bb-4c85-b2c0-aea19f622195",
 CellID->716147443],
Cell[73863, 1956, 1249, 45, 70, "TechNoteText",ExpressionUUID->"a8b41850-f143-4cad-982f-e4cac48c5182",
 CellID->1791716713],
Cell[75115, 2003, 174, 3, 70, "TechNoteText",ExpressionUUID->"300d37d3-ac24-4fd6-a5ce-d521d49b9c4b",
 CellID->1367097157],
Cell[75292, 2008, 321, 5, 70, "TechNoteText",ExpressionUUID->"74d1947c-bf2c-4564-94d0-ee8b78d0e615",
 CellID->874378446],
Cell[CellGroupData[{
Cell[75638, 2017, 773, 22, 70, "Input",ExpressionUUID->"84041a21-f550-43a3-a85c-e6102fbf9946",
 CellID->447945501],
Cell[76414, 2041, 1504, 31, 175, "Output",ExpressionUUID->"c69162d7-55f4-477c-a520-e97578d2a5de",
 CellID->1430026836]
}, Open  ]],
Cell[77933, 2075, 115, 1, 70, "TechNoteText",ExpressionUUID->"1ca4ed93-9296-4f2a-84cd-27a28acb3328",
 CellID->880946029],
Cell[CellGroupData[{
Cell[78073, 2080, 731, 21, 70, "Input",ExpressionUUID->"5e29f39a-3204-497c-a88d-9c6e8d8ee8f5",
 CellID->1307646985],
Cell[78807, 2103, 1504, 31, 175, "Output",ExpressionUUID->"0f34f2ba-1129-48d8-9fc4-129215411fc7",
 CellID->2028733045]
}, Open  ]],
Cell[80326, 2137, 235, 4, 70, "TechNoteText",ExpressionUUID->"323e77c4-4eb8-4105-881a-bea45d584d43",
 CellID->169608441],
Cell[80564, 2143, 667, 21, 70, "TechNoteText",ExpressionUUID->"a08ac3b5-e6ed-4db0-bd4c-aa35a64d5eec",
 CellID->898268318],
Cell[81234, 2166, 381, 10, 70, "TechNoteText",ExpressionUUID->"0dfa3798-c654-41c6-b24c-1e5409ff09fb",
 CellID->385582216],
Cell[81618, 2178, 2416, 55, 70, "TechNoteText",ExpressionUUID->"80e942ed-db67-4643-bf7a-4d3550bc2ebc",
 CellID->1620101282],
Cell[84037, 2235, 131, 1, 70, "TechNoteText",ExpressionUUID->"9c5dec88-50e1-4384-80a1-52c62ce91167",
 CellID->712578174],
Cell[84171, 2238, 787, 27, 70, "TechNoteText",ExpressionUUID->"be14f358-9356-40be-824c-3775f571e621",
 CellID->1522141313],
Cell[84961, 2267, 414, 7, 70, "TechNoteText",ExpressionUUID->"47183c27-d643-4906-bcc3-a4334cf3e929",
 CellID->1803844527],
Cell[85378, 2276, 394, 8, 70, "TechNoteText",ExpressionUUID->"1ce47ffc-a7e8-42be-accc-553690162eed",
 CellID->1188320590],
Cell[85775, 2286, 334, 6, 70, "TechNoteText",ExpressionUUID->"7ac79346-bf40-42d5-b853-91e6a6cc390e",
 CellID->506239030],
Cell[86112, 2294, 3535, 89, 70, "TechNoteText",ExpressionUUID->"0daec1a0-b2a6-43ad-95a2-9e2423ff53c3",
 CellID->1226753413],
Cell[89650, 2385, 402, 6, 70, "TechNoteText",ExpressionUUID->"f0f1d256-d003-452b-ad56-c6de1eef7f00",
 CellID->365203462],
Cell[90055, 2393, 5254, 136, 70, "TechNoteText",ExpressionUUID->"26695863-b999-4dc6-bb9a-11589301ec38",
 CellID->977674470],
Cell[95312, 2531, 597, 11, 70, "TechNoteText",ExpressionUUID->"714ba53e-b3ab-4802-80c2-3032089f3840",
 CellID->833871357]
}, Open  ]],
Cell[CellGroupData[{
Cell[95946, 2547, 147, 2, 70, "TechNoteSection",ExpressionUUID->"7d36e7fe-f1b4-492d-a9b4-013a01d4aa46",
 CellTags->"Section12",
 CellID->29167796],
Cell[96096, 2551, 178, 3, 70, "Input",ExpressionUUID->"54576842-4974-4bb2-8722-ba58eb507603",
 CellID->754200946],
Cell[96277, 2556, 271, 6, 70, "Input",ExpressionUUID->"cc3378bc-d396-4d7e-84a7-3cef7960507b",
 CellID->1406814828],
Cell[96551, 2564, 270, 5, 70, "TechNoteText",ExpressionUUID->"dee0244a-b497-4ac3-bcbf-73cf7bf2ce06",
 CellID->596875856],
Cell[96824, 2571, 628, 22, 70, "TechNoteText",ExpressionUUID->"a789cdc5-659d-4100-807f-72ef7d9ece45",
 CellID->796396655],
Cell[97455, 2595, 344, 11, 70, "TechNoteText",ExpressionUUID->"3625caaf-1149-4edf-8e0a-ea3a94e02478",
 CellID->1920492481],
Cell[CellGroupData[{
Cell[97824, 2610, 263, 7, 70, "Input",ExpressionUUID->"e27b2630-b7c7-489b-bc92-39ee652f6ef1",
 CellID->1037913757],
Cell[98090, 2619, 489, 15, 36, "Output",ExpressionUUID->"7f1b7bf4-893b-4b9f-b8c9-bc8b52b3bf24",
 CellID->1853978131]
}, Open  ]],
Cell[CellGroupData[{
Cell[98616, 2639, 498, 14, 70, "Input",ExpressionUUID->"cef9c5bf-88a5-4811-8b56-8bcd4f4765cc",
 CellID->1887946780],
Cell[99117, 2655, 7287, 177, 113, "Output",ExpressionUUID->"5dfc1efa-bd4d-4e8c-8bb5-75063ef7c04f",
 CellID->162020701]
}, Open  ]],
Cell[106419, 2835, 181, 3, 70, "TechNoteText",ExpressionUUID->"36127d50-ae37-43a5-9a7e-3754dc1f5cdb",
 CellID->1230965299],
Cell[CellGroupData[{
Cell[106625, 2842, 193, 4, 70, "Input",ExpressionUUID->"b57487ff-4db4-4ec8-bc7a-1dc3c123ac55",
 CellID->2123808742],
Cell[106821, 2848, 791, 24, 91, "Output",ExpressionUUID->"d5ca4513-abec-48ad-b44e-841c4fb5b792",
 CellID->1847755910]
}, Open  ]],
Cell[107627, 2875, 315, 5, 70, "TechNoteText",ExpressionUUID->"15485452-1a47-484f-9ff1-d66b5524de4c",
 CellID->776960470],
Cell[CellGroupData[{
Cell[107967, 2884, 168, 3, 70, "Input",ExpressionUUID->"4284e249-9ba4-493c-805c-e967713f3c01",
 CellID->1674045530],
Cell[108138, 2889, 634, 18, 103, "Output",ExpressionUUID->"7ddf821d-a009-492c-bece-2a6fc5ab3b1f",
 CellID->384755590]
}, Open  ]],
Cell[108787, 2910, 252, 4, 70, "TechNoteText",ExpressionUUID->"5623df3c-159f-4542-8dd0-3572dc99d13f",
 CellID->573709808],
Cell[109042, 2916, 505, 11, 70, "TechNoteText",ExpressionUUID->"1b571b81-8177-4f9b-ba4b-3ac6a5409e2c",
 CellID->139168026],
Cell[CellGroupData[{
Cell[109572, 2931, 1147, 35, 70, "Input",ExpressionUUID->"0586b212-b9ec-4f81-a2c8-a2577ebc16ec",
 CellID->387321399],
Cell[110722, 2968, 796, 19, 103, "Output",ExpressionUUID->"961c9d8e-81a1-4cab-a8f5-1deaacd32fb4",
 CellID->1978763442],
Cell[111521, 2989, 1433, 37, 105, "Output",ExpressionUUID->"9ecab329-b85f-4703-a52d-5a56b15f4097",
 CellID->1145412252],
Cell[112957, 3028, 2441, 59, 105, "Output",ExpressionUUID->"b1309838-bfef-4bdb-ae13-c32dacea0aa4",
 CellID->900307656]
}, Open  ]],
Cell[CellGroupData[{
Cell[115435, 3092, 200, 4, 70, "Input",ExpressionUUID->"60913af4-f8cb-4363-9a8b-5b4806aea612",
 CellID->1606586072],
Cell[115638, 3098, 131, 2, 36, "Output",ExpressionUUID->"9e761940-2b79-47c8-aa65-12801f9fa48a",
 CellID->1863983650]
}, Open  ]],
Cell[115784, 3103, 412, 6, 70, "TechNoteText",ExpressionUUID->"6abe133f-d4e6-4e1c-a559-0061f164c710",
 CellID->799932562]
}, Open  ]],
Cell[CellGroupData[{
Cell[116233, 3114, 136, 2, 70, "TechNoteSection",ExpressionUUID->"d9e16b27-9a9d-44fc-9e84-0fd25cc72436",
 CellTags->"Section13",
 CellID->1218939314],
Cell[116372, 3118, 179, 3, 70, "Input",ExpressionUUID->"416a44ab-67ad-4697-aa39-ac9c166cbed7",
 CellID->1843914595],
Cell[116554, 3123, 270, 6, 70, "Input",ExpressionUUID->"24949bd9-63f1-49ec-93c4-0517f9f8fce5",
 CellID->336088308],
Cell[116827, 3131, 575, 14, 70, "TechNoteText",ExpressionUUID->"8e1b8139-4f5b-43f4-ab8a-addd28fc4c6a",
 CellID->1866541665],
Cell[117405, 3147, 625, 22, 70, "TechNoteText",ExpressionUUID->"99d0f211-c322-44df-997d-159ab861a71e",
 CellID->524648279],
Cell[118033, 3171, 505, 12, 70, "TechNoteText",ExpressionUUID->"221bbebc-1c71-474f-a807-cfef7da68269",
 CellID->195770571],
Cell[CellGroupData[{
Cell[118563, 3187, 685, 20, 70, "Input",ExpressionUUID->"5ba76920-3074-4411-aa85-668e378bbf70",
 CellID->371039593],
Cell[119251, 3209, 6336, 110, 114, "Output",ExpressionUUID->"3319b4a8-f94f-4ac8-b968-ff99cf8bbc70",
 CellTags->"RasterizedOutput",
 CellID->677514827]
}, Open  ]],
Cell[125602, 3322, 642, 21, 70, "TechNoteText",ExpressionUUID->"582b724e-1059-4bf5-99c8-b28fbd21f305",
 CellID->809087288],
Cell[CellGroupData[{
Cell[126269, 3347, 192, 4, 70, "Input",ExpressionUUID->"8a966bf6-c787-4237-aa69-65f87d256cae",
 CellID->463596612],
Cell[126464, 3353, 805, 23, 91, "Output",ExpressionUUID->"24993ebf-c950-4ac2-936b-3bc547499a0a",
 CellID->1156274875]
}, Open  ]],
Cell[127284, 3379, 143, 1, 70, "TechNoteText",ExpressionUUID->"44a99983-f18e-4e2e-8f6c-450e7eb85580",
 CellID->2003915004],
Cell[CellGroupData[{
Cell[127452, 3384, 191, 4, 70, "Input",ExpressionUUID->"92f47244-6c20-4aa7-8af4-7a12565b31bc",
 CellID->813436327],
Cell[127646, 3390, 839, 21, 103, "Output",ExpressionUUID->"a0ab58ab-1555-49ea-b20e-41909bfb47ff",
 CellID->1603478823]
}, Open  ]],
Cell[128500, 3414, 383, 8, 70, "TechNoteText",ExpressionUUID->"59f568bf-1c4a-42a8-b77a-ff28263bc64c",
 CellID->534468518],
Cell[CellGroupData[{
Cell[128908, 3426, 310, 9, 70, "Input",ExpressionUUID->"44c14ced-4996-43ac-9b42-14cf1df53f8d",
 CellID->2035770272],
Cell[129221, 3437, 805, 23, 91, "Output",ExpressionUUID->"ac1279a3-d0b5-477f-92a7-5935cb214036",
 CellID->1785621147]
}, Open  ]],
Cell[130041, 3463, 759, 15, 70, "TechNoteText",ExpressionUUID->"86dec959-b8e5-4afd-a8e7-588e5dff268d",
 CellID->1603079182],
Cell[CellGroupData[{
Cell[130825, 3482, 810, 23, 70, "Input",ExpressionUUID->"1c8bcd09-9e3a-4bc8-b2c6-b007cc070454",
 CellID->621976612],
Cell[131638, 3507, 836, 21, 103, "Output",ExpressionUUID->"bf83cd3c-807f-4767-8088-554a04475f3a",
 CellID->9339218],
Cell[132477, 3530, 1463, 31, 105, "Output",ExpressionUUID->"ae385424-f82f-4793-a761-8acd5dfb8b59",
 CellID->197930695]
}, Open  ]],
Cell[CellGroupData[{
Cell[133977, 3566, 187, 4, 70, "Input",ExpressionUUID->"09b3c5a1-b2cd-4571-8e86-8fdce980ca22",
 CellID->661500490],
Cell[134167, 3572, 131, 2, 36, "Output",ExpressionUUID->"59d1603d-1e0a-474f-b73d-5819d8319f98",
 CellID->1233129467]
}, Open  ]],
Cell[134313, 3577, 1225, 29, 70, "TechNoteText",ExpressionUUID->"fb85d899-8a12-44fb-bb59-df5eb9635ac7",
 CellID->666193793],
Cell[135541, 3608, 467, 13, 70, "TechNoteText",ExpressionUUID->"fb46250f-2a57-4621-a3a1-58f8a69ec2fe",
 CellID->1938247085],
Cell[CellGroupData[{
Cell[136033, 3625, 524, 14, 70, "Input",ExpressionUUID->"333259a2-8209-4d72-a1db-bd8603d8d150",
 CellID->1040933486],
Cell[136560, 3641, 1031, 31, 108, "Output",ExpressionUUID->"19da9cf6-c69d-44e3-9f4f-ba95754c4543",
 CellID->350321222]
}, Open  ]],
Cell[137606, 3675, 327, 8, 70, "TechNoteText",ExpressionUUID->"cbaf3894-9bb0-44f3-80a4-ec45f477bbf9",
 CellID->771058470],
Cell[CellGroupData[{
Cell[137958, 3687, 471, 13, 70, "Input",ExpressionUUID->"4cc0ea9e-bc82-4448-91d9-1a4f7b09e7c2",
 CellID->1895203240],
Cell[138432, 3702, 3343, 83, 49, "Output",ExpressionUUID->"b930c1ab-9ff7-45a1-8fc7-6667f5f82edd",
 CellID->2132214844]
}, Open  ]],
Cell[141790, 3788, 849, 23, 70, "TechNoteText",ExpressionUUID->"8e6ac6a3-8b8e-4f8f-8169-727d4a05e587",
 CellID->27233292],
Cell[CellGroupData[{
Cell[142664, 3815, 510, 14, 70, "Input",ExpressionUUID->"cb04a488-e287-4016-8ec0-88b8c194e5a3",
 CellID->1505230369],
Cell[143177, 3831, 3604, 91, 105, "Output",ExpressionUUID->"0edde143-47cc-4a10-bdcc-4c39f532edc2",
 CellID->1783234933]
}, Open  ]],
Cell[146796, 3925, 225, 4, 70, "TechNoteText",ExpressionUUID->"934f8208-9ca6-4c11-8389-661f52aeeca3",
 CellID->535686806],
Cell[CellGroupData[{
Cell[147046, 3933, 192, 4, 70, "Input",ExpressionUUID->"6ed44b90-a812-4820-89a4-9650e9cf8901",
 CellID->851721286],
Cell[147241, 3939, 827, 24, 91, "Output",ExpressionUUID->"a5389b26-9bdc-4e65-a5ea-2f73d91ad5ae",
 CellID->983526773]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[148117, 3969, 151, 2, 70, "TechNoteSection",ExpressionUUID->"e1d8995b-323a-4285-aa4a-3ecf6fe7a78e",
 CellTags->"Section14",
 CellID->1455445268],
Cell[148271, 3973, 178, 3, 70, "Input",ExpressionUUID->"cfe51bff-9939-46ad-a364-51e0c1c7fb91",
 CellID->214055128],
Cell[148452, 3978, 270, 6, 70, "Input",ExpressionUUID->"ec5282c0-d35d-4d28-8eed-9b5293b86d87",
 CellID->167122186],
Cell[CellGroupData[{
Cell[148747, 3988, 132, 2, 70, "Subsection",ExpressionUUID->"d3c1f0dd-ac83-4b2c-ad1d-04d12d513a13",
 CellTags->"Section15",
 CellID->1829879946],
Cell[148882, 3992, 572, 13, 70, "TechNoteText",ExpressionUUID->"7c1893eb-e00c-4096-9df0-1d8392d13644",
 CellID->678943735],
Cell[149457, 4007, 634, 23, 70, "TechNoteText",ExpressionUUID->"02441487-8f02-4051-8e70-9952087479c8",
 CellID->1426737634],
Cell[150094, 4032, 115, 1, 70, "TechNoteText",ExpressionUUID->"c8bf8ca3-2051-4cf3-9e35-ff0cb5ee2bb9",
 CellID->377012236],
Cell[150212, 4035, 584, 22, 70, "TechNoteText",ExpressionUUID->"08fd83db-4c7e-4db6-a1c4-6278ac50a165",
 CellID->1367891802],
Cell[150799, 4059, 400, 8, 70, "TechNoteText",ExpressionUUID->"cf6c2cd4-6631-4884-8ee3-e120c6989f5b",
 CellID->1345075079],
Cell[151202, 4069, 212, 4, 70, "TechNoteText",ExpressionUUID->"9ae49b92-0485-4f91-84e0-3259299ee14e",
 CellID->819163313],
Cell[151417, 4075, 569, 19, 70, "TechNoteText",ExpressionUUID->"823ddb30-3d89-4cbc-ac32-204d30d25da4",
 CellID->116500784],
Cell[151989, 4096, 446, 13, 70, "TechNoteText",ExpressionUUID->"e0c8f724-0aac-4da4-81fa-fe948087dd48",
 CellID->1671074271],
Cell[152438, 4111, 174, 3, 70, "TechNoteText",ExpressionUUID->"6073da26-228c-462c-9ad5-e60ca0338dcd",
 CellID->1953344721],
Cell[152615, 4116, 781, 19, 70, "Picture",ExpressionUUID->"5eead058-551c-43c0-bd6a-11877b21f329",
 CellID->954137231],
Cell[153399, 4137, 287, 5, 70, "TechNoteText",ExpressionUUID->"f4793b9d-fc4e-497a-9e56-0f0eaf02dbd1",
 CellID->924049268],
Cell[153689, 4144, 282, 5, 70, "TechNoteMathCaption",ExpressionUUID->"e59af627-eb40-429f-b58e-f357d3b4785d",
 CellID->2041795819],
Cell[CellGroupData[{
Cell[153996, 4153, 602, 16, 70, "Input",ExpressionUUID->"8f26fa45-2b81-477a-bd0d-4f7691737668",
 CellID->1821134520],
Cell[154601, 4171, 1154, 33, 79, "Output",ExpressionUUID->"5b60026c-186c-4318-9d99-9d5f251ad4cc",
 CellID->1309957850]
}, Open  ]],
Cell[155770, 4207, 179, 3, 70, "TechNoteMathCaption",ExpressionUUID->"451bdde3-c2b5-452d-8582-a5f65a4cbf8e",
 CellID->1443037598],
Cell[CellGroupData[{
Cell[155974, 4214, 289, 7, 70, "Input",ExpressionUUID->"b36ba79e-719c-4053-abbb-c4ecfee00767",
 CellID->1600084015],
Cell[156266, 4223, 1048, 26, 103, "Output",ExpressionUUID->"43e72801-05d6-4ea1-aebe-16e3bb01c965",
 CellID->649519177]
}, Open  ]],
Cell[157329, 4252, 206, 4, 70, "TechNoteMathCaption",ExpressionUUID->"c3f020cf-dc9a-4ba3-9827-94566e428171",
 CellID->378680471],
Cell[CellGroupData[{
Cell[157560, 4260, 163, 3, 70, "Input",ExpressionUUID->"9a550625-6acc-4557-878f-f628d228f20f",
 CellID->1488630036],
Cell[157726, 4265, 1870, 49, 48, "Output",ExpressionUUID->"15d0352f-e1d7-4eb4-bd8a-b121945a3918",
 CellID->983664197]
}, Open  ]],
Cell[159611, 4317, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"a02b844b-e1e8-44ad-96ec-f40f567abca4",
 CellID->641929970],
Cell[CellGroupData[{
Cell[159813, 4324, 498, 14, 70, "Input",ExpressionUUID->"42ca4ef2-655c-4bed-a525-c2691d66a170",
 CellID->2106646909],
Cell[160314, 4340, 9532, 232, 122, "Output",ExpressionUUID->"f598328a-1bee-4de1-86cf-b08b5760c494",
 CellID->1228913040]
}, Open  ]],
Cell[169861, 4575, 217, 4, 70, "TechNoteMathCaption",ExpressionUUID->"5b8a7e8f-4101-4606-bd7c-f49e11f1239b",
 CellID->1736236263],
Cell[CellGroupData[{
Cell[170103, 4583, 489, 15, 70, "Input",ExpressionUUID->"f0fc38c2-5dba-455f-b3cf-a648bd09aeff",
 CellID->915076805],
Cell[170595, 4600, 1591, 41, 38, "Output",ExpressionUUID->"c6ba4064-be1f-480c-b6be-c8465992fcdf",
 CellID->1920663759]
}, Open  ]],
Cell[CellGroupData[{
Cell[172223, 4646, 177, 4, 70, "Input",ExpressionUUID->"e2c26a88-1106-4c00-b6c3-2c0e81632ab8",
 CellID->1955961279],
Cell[172403, 4652, 2511, 64, 48, "Output",ExpressionUUID->"e79a3afa-1355-4178-884a-13eda29f1b66",
 CellID->1890005442]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[174963, 4722, 138, 2, 70, "Subsection",ExpressionUUID->"d6a17c2c-30e2-489a-8f55-309f1b12b0a7",
 CellTags->"Section16",
 CellID->715838931],
Cell[175104, 4726, 709, 12, 70, "TechNoteText",ExpressionUUID->"412afd99-4edc-4af4-8913-ed6a480cb07b",
 CellID->901522823],
Cell[175816, 4740, 1046, 32, 70, "TechNoteText",ExpressionUUID->"907ed078-664a-495a-bf01-320cb5e81be8",
 CellID->1396956576],
Cell[176865, 4774, 1478, 53, 70, "TechNoteText",ExpressionUUID->"1e940d3f-f1a4-42df-ab6a-a3fb03a44c5d",
 CellID->210460181],
Cell[178346, 4829, 432, 8, 70, "TechNoteText",ExpressionUUID->"2d9b3232-8cd9-4e86-b6f2-369c6e9772d4",
 CellID->298695458],
Cell[178781, 4839, 528, 13, 70, "TechNoteMathCaption",ExpressionUUID->"23cead0a-7b04-4142-8b7f-a558af914ae8",
 CellID->1505279567],
Cell[CellGroupData[{
Cell[179334, 4856, 361, 9, 70, "Input",ExpressionUUID->"24b38aa4-2376-483e-b66b-cda1884a039c",
 CellID->1876320909],
Cell[179698, 4867, 684, 22, 36, "Output",ExpressionUUID->"f940e529-fda8-490b-95ad-27be3d25354b",
 CellID->1422021188],
Cell[180385, 4891, 799, 23, 61, "Output",ExpressionUUID->"67a8f2c4-f2fc-402b-92f6-7c252af441d6",
 CellID->564599253]
}, Open  ]],
Cell[181199, 4917, 167, 2, 70, "TechNoteMathCaption",ExpressionUUID->"0e6806d3-3b0c-4401-abeb-7b179757a738",
 CellID->774865820],
Cell[CellGroupData[{
Cell[181391, 4923, 337, 8, 70, "Input",ExpressionUUID->"680f2230-4831-48d9-9f90-45fde1504c64",
 CellID->2117896949],
Cell[181731, 4933, 1067, 28, 103, "Output",ExpressionUUID->"54df934e-08cf-4244-b16e-0e87281c06ad",
 CellID->646255298]
}, Open  ]],
Cell[182813, 4964, 323, 5, 70, "TechNoteMathCaption",ExpressionUUID->"ca12198d-43de-42d4-b084-daccacc73f50",
 CellID->193224567],
Cell[CellGroupData[{
Cell[183161, 4973, 538, 15, 70, "Input",ExpressionUUID->"ea168b83-5aa7-4ef7-a24c-77381a459be1",
 CellID->1062235589],
Cell[183702, 4990, 2034, 51, 105, "Output",ExpressionUUID->"2d551562-94a6-4e45-b25f-c6daf85cc20e",
 CellID->815012837]
}, Open  ]],
Cell[185751, 5044, 278, 5, 70, "TechNoteMathCaption",ExpressionUUID->"407835aa-c07a-49f4-984e-daa0774e14c0",
 CellID->581406343],
Cell[CellGroupData[{
Cell[186054, 5053, 270, 6, 70, "Input",ExpressionUUID->"f7a1b1ed-9d2f-4824-b7f6-706e094b019c",
 CellID->1127477995],
Cell[186327, 5061, 2083, 55, 58, "Output",ExpressionUUID->"1ad2510b-aefa-4b5a-9c16-056822a440bd",
 CellID->365940228]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[188459, 5122, 150, 2, 70, "Subsection",ExpressionUUID->"453a152c-b3e2-48d6-be74-e6f1581ade56",
 CellTags->"Section17",
 CellID->616090041],
Cell[188612, 5126, 273, 5, 70, "TechNoteText",ExpressionUUID->"7a616ccc-9433-4998-8369-2df7d2da84f1",
 CellID->1275497408],
Cell[188888, 5133, 7318, 182, 70, "Picture",ExpressionUUID->"1475fba9-177e-40e7-8eb1-94b50eeac311",
 CellID->2084184000],
Cell[196209, 5317, 342, 9, 70, "TechNoteCaption",ExpressionUUID->"b9896500-fb22-49b7-ac82-574240863cb5",
 CellID->1283463500],
Cell[196554, 5328, 668, 16, 70, "TechNoteText",ExpressionUUID->"57a86a30-7e8e-4f75-b2d0-62c14934bee7",
 CellID->1036421782],
Cell[197225, 5346, 864, 29, 70, "TechNoteText",ExpressionUUID->"bd33c5dd-996b-431e-877e-f6876cc9e766",
 CellID->1390517433],
Cell[198092, 5377, 1382, 36, 70, "TechNoteText",ExpressionUUID->"20c21316-a861-4c55-9a22-3017d7cf3e7a",
 CellID->357932788],
Cell[199477, 5415, 1870, 62, 70, "TechNoteText",ExpressionUUID->"c79df340-6df1-4264-a420-75bf8342298a",
 CellID->232871499],
Cell[201350, 5479, 350, 7, 70, "TechNoteText",ExpressionUUID->"83f238dc-7afc-4872-a985-c7f796b7cff2",
 CellID->531662691],
Cell[201703, 5488, 460, 14, 70, "TechNoteText",ExpressionUUID->"0bc08e04-978f-49bb-a8cf-34eb1ce33c50",
 CellID->1514408200],
Cell[202166, 5504, 799, 27, 70, "TechNoteText",ExpressionUUID->"1b15c47e-535b-4669-a118-3ded02f47ec2",
 CellID->2034215257],
Cell[202968, 5533, 224, 4, 70, "TechNoteText",ExpressionUUID->"27f3aa74-7067-43e3-bf6e-6bcaf17ad5a4",
 CellID->1368761109],
Cell[203195, 5539, 5599, 145, 70, "Picture",ExpressionUUID->"2c1f89bf-12ac-494a-80c0-70f147dc605b",
 CellID->757238962],
Cell[208797, 5686, 369, 10, 70, "TechNoteCaption",ExpressionUUID->"ee8dd00a-30e4-4b38-abb1-9e025434b3de",
 CellID->927142212],
Cell[CellGroupData[{
Cell[209191, 5700, 357, 7, 70, "TechNoteText",ExpressionUUID->"e6222d2e-fdec-4a7f-9a0a-cac47d0ffb1b",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->305516076],
Cell[209551, 5709, 193, 4, 70, "Input",ExpressionUUID->"70a85bb5-d5d2-4ca2-bff2-638e2e8405be",
 CellID->1535052485],
Cell[209747, 5715, 285, 7, 70, "TechNoteMathCaption",ExpressionUUID->"46ce6238-8cd3-488a-959f-b47a70f46c9f",
 CellID->1475887768],
Cell[CellGroupData[{
Cell[210057, 5726, 377, 10, 70, "Input",ExpressionUUID->"f8be5084-1a72-4198-85c6-55a53be164b3",
 CellID->1092408791],
Cell[210437, 5738, 597, 19, 36, "Output",ExpressionUUID->"f8437ef1-1b79-40d1-94d5-fe3a70584ea6",
 CellID->1408780650]
}, Open  ]],
Cell[211049, 5760, 179, 3, 70, "TechNoteMathCaption",ExpressionUUID->"2c4b63aa-9188-47ac-bc7f-2e580e3232cc",
 CellID->1519843333],
Cell[CellGroupData[{
Cell[211253, 5767, 330, 8, 70, "Input",ExpressionUUID->"73970fb6-d378-4c24-83f7-d7a3de8a5011",
 CellID->21384525],
Cell[211586, 5777, 654, 23, 36, "Output",ExpressionUUID->"6d9306c4-c600-40c1-b8f5-3b2099704d83",
 CellID->337512046]
}, Open  ]],
Cell[212255, 5803, 202, 5, 70, "TechNoteMathCaption",ExpressionUUID->"64f01fe2-3329-4e1d-a62c-1d659773250c",
 CellID->978050365],
Cell[CellGroupData[{
Cell[212482, 5812, 221, 5, 70, "Input",ExpressionUUID->"8a1fc341-884a-4ec1-aa43-b40f461924af",
 CellID->2127797723],
Cell[212706, 5819, 1264, 42, 37, "Output",ExpressionUUID->"91fea69c-27b2-4578-b61e-90ba49d26eec",
 CellID->1662928265]
}, Open  ]],
Cell[213985, 5864, 203, 4, 70, "TechNoteMathCaption",ExpressionUUID->"6bf995ee-9020-414a-b0f1-ed570fc55b14",
 CellID->1664622810],
Cell[CellGroupData[{
Cell[214213, 5872, 708, 18, 70, "Input",ExpressionUUID->"d5c62256-61e0-4309-8387-d64cb3287486",
 CellID->2027335310],
Cell[214924, 5892, 2031, 53, 204, "Output",ExpressionUUID->"459aee3c-aa54-4e2c-a688-3a5c4687c081",
 CellID->1242562724]
}, Open  ]],
Cell[216970, 5948, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"a3f46d63-fbc3-4f35-9a29-27ae41f9605b",
 CellID->1320057003],
Cell[CellGroupData[{
Cell[217144, 5953, 183, 4, 70, "Input",ExpressionUUID->"0684e151-c73f-4f8d-af8b-3f085687db78",
 CellID->856233533],
Cell[217330, 5959, 8465, 204, 38, "Output",ExpressionUUID->"ac8b2c4c-f916-4a93-b1b0-5a2c5a3484f5",
 CellID->944356628]
}, Open  ]],
Cell[225810, 6166, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"0bfda6ba-1614-40db-bb2c-d9b4938763a3",
 CellID->1095734201],
Cell[CellGroupData[{
Cell[225984, 6171, 178, 4, 70, "Input",ExpressionUUID->"4a7cc5e4-765d-497e-a5bc-a41ff5e948ed",
 CellID->1234389837],
Cell[226165, 6177, 21369, 499, 76, "Output",ExpressionUUID->"59071b77-84c2-423b-b875-9b7f1cd449ee",
 CellID->490447883]
}, Open  ]],
Cell[CellGroupData[{
Cell[247571, 6681, 260, 7, 70, "Input",ExpressionUUID->"8f110ddf-5d41-47ec-bfb6-507f5470bc27",
 CellID->273770455],
Cell[247834, 6690, 31204, 716, 198, "Output",ExpressionUUID->"6993ea62-7091-497f-83d0-7de589f9ce15",
 CellID->1547383929]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[279087, 7412, 358, 7, 70, "TechNoteText",ExpressionUUID->"a584828a-5f63-46d6-acca-17da31bc510a",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->1362282140],
Cell[279448, 7421, 202, 4, 70, "TechNoteMathCaption",ExpressionUUID->"5ace6b38-a9e2-4b77-80eb-3e959b2980e5",
 CellID->523520144],
Cell[CellGroupData[{
Cell[279675, 7429, 792, 20, 70, "Input",ExpressionUUID->"b04ddcb3-b0e8-4c48-9266-0f030ebb00bc",
 CellID->770533652],
Cell[280470, 7451, 3910, 97, 210, "Output",ExpressionUUID->"50a59a22-865b-4d07-8d4d-c2bacb8838cc",
 CellID->279596034]
}, Open  ]],
Cell[284395, 7551, 133, 1, 70, "TechNoteMathCaption",ExpressionUUID->"ea3b27aa-d6ea-4867-bf0b-11d5de562f12",
 CellID->363088131],
Cell[CellGroupData[{
Cell[284553, 7556, 189, 4, 70, "Input",ExpressionUUID->"ba343557-1c6b-4226-8f63-2f6d05302796",
 CellID->1079016412],
Cell[284745, 7562, 11415, 280, 98, "Output",ExpressionUUID->"6610b719-8c02-4ca6-a3cf-eb5c237e51eb",
 CellID->2109626122]
}, Open  ]],
Cell[296175, 7845, 148, 1, 70, "TechNoteMathCaption",ExpressionUUID->"f1511856-759c-4555-b7cf-9bf84246565c",
 CellID->942690207],
Cell[CellGroupData[{
Cell[296348, 7850, 187, 4, 70, "Input",ExpressionUUID->"b10a87b9-d775-453e-8b72-e0af68d42a5c",
 CellID->473086067],
Cell[296538, 7856, 4687, 120, 58, "Output",ExpressionUUID->"7da32ef2-38cb-4f60-8880-dff6409c9131",
 CellID->716465632]
}, Open  ]],
Cell[301240, 7979, 186, 3, 70, "TechNoteMathCaption",ExpressionUUID->"a24652a6-33f8-44f8-bb4e-aafa4b4f1be2",
 CellID->1762048567],
Cell[CellGroupData[{
Cell[301451, 7986, 186, 4, 70, "Input",ExpressionUUID->"888467fd-bd2d-4b83-ac6e-fe71ec9bb26f",
 CellID->1674087129],
Cell[301640, 7992, 9899, 248, 98, "Output",ExpressionUUID->"eea6fc36-c5fe-414f-8ff0-cb976333b038",
 CellID->1552752720]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[311588, 8246, 358, 7, 70, "TechNoteText",ExpressionUUID->"307b8d33-34ac-49cc-a168-2603dc4e54e1",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->1016485255],
Cell[311949, 8255, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"720d3348-ec2a-4bcf-8cab-e9cdbeafcc6f",
 CellID->1235189013],
Cell[CellGroupData[{
Cell[312151, 8262, 347, 9, 70, "Input",ExpressionUUID->"9571ff5f-2c4a-44b3-9a39-ed0954bf2436",
 CellID->1297582908],
Cell[312501, 8273, 1701, 44, 204, "Output",ExpressionUUID->"10bdd45d-1a61-409a-b48c-c12f492ece7b",
 CellID->862680693]
}, Open  ]],
Cell[314217, 8320, 223, 4, 70, "TechNoteMathCaption",ExpressionUUID->"5b00c955-c9e2-4038-a7cd-9fb34b7ba309",
 CellID->331049159],
Cell[CellGroupData[{
Cell[314465, 8328, 186, 4, 70, "Input",ExpressionUUID->"f28e6c6e-68c8-4519-8c90-aebec921c699",
 CellID->1888208538],
Cell[314654, 8334, 3357, 81, 209, "Output",ExpressionUUID->"a5855174-3880-42fc-88f2-9f3cf55394a7",
 CellID->2095711381]
}, Open  ]],
Cell[CellGroupData[{
Cell[318048, 8420, 254, 6, 70, "Input",ExpressionUUID->"fba6c2a0-bc2a-4e9c-91fd-6323afbaf0c7",
 CellID->1871953819],
Cell[318305, 8428, 2334, 53, 281, "Output",ExpressionUUID->"e1524ffd-d512-4bf1-ac1e-74f7e97dda0e",
 CellID->1865330116]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[320700, 8488, 156, 2, 70, "Subsection",ExpressionUUID->"a26af0a3-8b77-4b65-bdc3-e9d5fddde8ff",
 CellTags->"Section17",
 CellID->1379525988],
Cell[320859, 8492, 849, 21, 70, "TechNoteText",ExpressionUUID->"be3ad4e2-67a9-4f10-b0a7-db61881ebb40",
 CellID->1459827304],
Cell[321711, 8515, 751, 25, 70, "TechNoteText",ExpressionUUID->"437d800f-a968-46d8-9800-b2f9d2c0e3f8",
 CellID->316831353],
Cell[322465, 8542, 1528, 37, 70, "TechNoteText",ExpressionUUID->"ad1f74b3-aede-47db-99a7-293ee6472cee",
 CellID->1372588958],
Cell[323996, 8581, 5917, 116, 70, "Picture",ExpressionUUID->"42ce8a38-a5fd-4f56-a691-af9baeaca46a",
 CellID->833281032],
Cell[329916, 8699, 468, 8, 70, "TechNoteCaption",ExpressionUUID->"5c8a6fcd-8f70-4355-bb88-fb33d14ff756",
 CellID->571282978],
Cell[330387, 8709, 195, 4, 70, "TechNoteText",ExpressionUUID->"489d2626-339e-4c22-86bc-59ae9c2562c9",
 CellID->1213442737],
Cell[CellGroupData[{
Cell[330607, 8717, 357, 7, 70, "TechNoteText",ExpressionUUID->"b8e144c2-025b-4ed9-8be3-8c9d2b5eae31",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->780471724],
Cell[330967, 8726, 259, 4, 70, "TechNoteMathCaption",ExpressionUUID->"67eac4d9-0564-4823-8396-c9235f41c5c2",
 CellID->1827368847],
Cell[CellGroupData[{
Cell[331251, 8734, 1338, 38, 70, "Input",ExpressionUUID->"f6a65e8e-70ab-4aa7-9fed-2796da63ac11",
 CellID->1424575782],
Cell[332592, 8774, 2424, 50, 176, "Output",ExpressionUUID->"43740b83-7688-4543-914c-b4840d62cdb9",
 CellID->1638618396]
}, Open  ]],
Cell[335031, 8827, 204, 4, 70, "TechNoteMathCaption",ExpressionUUID->"7e1d442c-ee61-45e6-8855-90ddc53a3787",
 CellID->873169809],
Cell[CellGroupData[{
Cell[335260, 8835, 422, 11, 70, "Input",ExpressionUUID->"4f766cc2-f8c7-4e98-a099-ff662b8f0117",
 CellID->1609219912],
Cell[335685, 8848, 27567, 624, 216, "Output",ExpressionUUID->"53e6b1e6-caa3-402d-a202-a898ab19ab62",
 CellID->2019825366]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[363313, 9479, 157, 2, 70, "Subsection",ExpressionUUID->"d598f461-606f-4e40-9abf-c355a5f68d15",
 CellTags->"Section18",
 CellID->1847739219],
Cell[363473, 9483, 645, 10, 70, "TechNoteText",ExpressionUUID->"4edc7e46-5256-40a9-a726-3ddceaa9b081",
 CellID->192034466],
Cell[364121, 9495, 733, 19, 70, "TechNoteText",ExpressionUUID->"cdde2c55-ba97-456a-b728-f9cdc11fa235",
 CellID->2002832268],
Cell[364857, 9516, 567, 17, 70, "TechNoteText",ExpressionUUID->"511a9445-33b3-4732-b4f1-06e04c3b02f9",
 CellID->1943245198],
Cell[365427, 9535, 521, 15, 70, "TechNoteText",ExpressionUUID->"b5a75f30-df31-484d-926c-89133062a063",
 CellID->1190739210],
Cell[365951, 9552, 587, 18, 70, "TechNoteText",ExpressionUUID->"b12d9bfb-f4b6-4218-97ed-953fe6a934d9",
 CellID->353796077],
Cell[366541, 9572, 176, 3, 70, "TechNoteText",ExpressionUUID->"f464e4a6-30f3-4d3a-974c-a912caf858da",
 CellID->2015931243],
Cell[366720, 9577, 429, 14, 70, "TechNoteText",ExpressionUUID->"90c6e493-254a-4535-a8f5-bdbdd6cdc4d6",
 CellID->906902382],
Cell[367152, 9593, 576, 20, 70, "TechNoteText",ExpressionUUID->"a41c275b-5578-47c0-abba-6f953fe1cbb0",
 CellID->1616891515],
Cell[367731, 9615, 430, 14, 70, "TechNoteText",ExpressionUUID->"7762afa2-37e7-4765-96bc-bfbb5a06b4cc",
 CellID->837623467],
Cell[368164, 9631, 669, 18, 70, "TechNoteText",ExpressionUUID->"0c6188b6-d96d-4b80-a1ca-37b08617b628",
 CellID->1182303784],
Cell[368836, 9651, 2830, 63, 70, "TechNoteText",ExpressionUUID->"3e2c629a-69d4-4db3-a9e0-214f7814913b",
 CellID->313511997],
Cell[371669, 9716, 1491, 40, 70, "TechNoteText",ExpressionUUID->"b2aa14f7-012e-461f-8753-5fc744091bfd",
 CellID->1418747488],
Cell[373163, 9758, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"67a96188-de7f-4f39-9302-26e05a3cefa4",
 CellID->1378098175],
Cell[CellGroupData[{
Cell[373398, 9766, 464, 13, 70, "Input",ExpressionUUID->"2f987fe7-b09a-43aa-9da0-acd06d1d0825",
 CellID->1028095504],
Cell[373865, 9781, 1114, 36, 80, "Output",ExpressionUUID->"2b24b42c-5fc1-4588-be74-013c155b8bb2",
 CellID->641761720]
}, Open  ]],
Cell[374994, 9820, 168, 2, 70, "TechNoteMathCaption",ExpressionUUID->"580acae7-b9ad-4398-9892-3974623ff510",
 CellID->1646790355],
Cell[CellGroupData[{
Cell[375187, 9826, 527, 14, 70, "Input",ExpressionUUID->"e4ec4540-e7b1-4ebe-9cc9-659ed359ee49",
 CellID->1153761970],
Cell[375717, 9842, 1154, 28, 103, "Output",ExpressionUUID->"f0bc1d80-4168-4311-a741-5b14a5f34f7c",
 CellID->1716960997]
}, Open  ]],
Cell[376886, 9873, 198, 4, 70, "TechNoteMathCaption",ExpressionUUID->"1f1ae296-1351-4382-92b3-91f0bd122c45",
 CellID->1240176371],
Cell[CellGroupData[{
Cell[377109, 9881, 541, 15, 70, "Input",ExpressionUUID->"c1e45f9d-c02a-4a61-9c8d-82ec774020f5",
 CellID->167989615],
Cell[377653, 9898, 281, 8, 46, "Output",ExpressionUUID->"f7716602-97a9-49e0-9dea-8c1b096e74cb",
 CellID->480491433]
}, Open  ]],
Cell[377949, 9909, 162, 2, 70, "TechNoteMathCaption",ExpressionUUID->"963fbeb9-5be5-4fc0-aa4e-e6535c958a1d",
 CellID->833485781],
Cell[378114, 9913, 1471, 43, 70, "Input",ExpressionUUID->"22cf43a6-d342-468a-8655-a0dd1d1a727c",
 CellID->359691886],
Cell[379588, 9958, 164, 2, 70, "TechNoteMathCaption",ExpressionUUID->"8b5bdf9d-59d5-40eb-9287-2f2fcbbd61e1",
 CellID->175061697],
Cell[CellGroupData[{
Cell[379777, 9964, 514, 14, 70, "Input",ExpressionUUID->"6057a5cb-759f-49cf-8c29-3c747168ffea",
 CellID->209345089],
Cell[380294, 9980, 3093, 70, 106, "Output",ExpressionUUID->"42a7b163-cdce-4032-8a32-f72e616f0801",
 CellID->670748328]
}, Open  ]],
Cell[383402, 10053, 124, 1, 70, "TechNoteMathCaption",ExpressionUUID->"e03f0a78-7bf8-4ba2-a855-e6a6c4499cf0",
 CellID->2073812678],
Cell[CellGroupData[{
Cell[383551, 10058, 217, 5, 70, "Input",ExpressionUUID->"b450f130-cb5e-419e-9f7d-f748ae88fe65",
 CellID->1395051790],
Cell[383771, 10065, 128, 2, 36, "Output",ExpressionUUID->"35288c36-4faf-4022-94e8-bcbb56632e70",
 CellID->926246328]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[383960, 10074, 148, 2, 70, "TechNoteSection",ExpressionUUID->"b649919a-7522-414a-88a6-68facfed1273",
 CellTags->"Section19",
 CellID->1476129218],
Cell[384111, 10078, 179, 3, 70, "Input",ExpressionUUID->"9d4c47f8-41ea-494f-844e-6453be2e3d6f",
 CellID->384188579],
Cell[384293, 10083, 272, 6, 70, "Input",ExpressionUUID->"c1581a35-f8c3-4b1e-8f6b-a0ffc1b1e408",
 CellID->1721604371],
Cell[384568, 10091, 583, 11, 70, "TechNoteText",ExpressionUUID->"618cd3d0-3ae7-44e0-8fd6-3c6a1dc0756c",
 CellID->1572676782],
Cell[CellGroupData[{
Cell[385176, 10106, 149, 2, 70, "Subsection",ExpressionUUID->"034aec99-5bba-45aa-af6c-72c4ff52b20c",
 CellTags->"Section20",
 CellID->749947798],
Cell[385328, 10110, 337, 7, 70, "TechNoteText",ExpressionUUID->"faee8c52-55fe-4e60-b5e3-273a3c6e0222",
 CellID->791116743],
Cell[385668, 10119, 875, 30, 70, "TechNoteText",ExpressionUUID->"440f6f4c-839f-4e67-9c31-69432084670e",
 CellID->1227841024],
Cell[386546, 10151, 970, 18, 70, "TechNoteText",ExpressionUUID->"2bd9e8b6-b3f9-469c-9b57-6fb1dc7da704",
 CellID->1153726345],
Cell[387519, 10171, 172, 3, 70, "TechNoteText",ExpressionUUID->"7a15a9f5-7c2b-4653-bf65-37cb896226ff",
 CellID->1048831652],
Cell[387694, 10176, 896, 28, 70, "TechNoteText",ExpressionUUID->"4c015e2a-e09c-4ec2-a883-33d0fc606559",
 CellID->1167800588],
Cell[388593, 10206, 1548, 45, 70, "TechNoteText",ExpressionUUID->"be7db872-aebd-4d29-b12a-d8aa9d5fe355",
 CellID->1371432583],
Cell[390144, 10253, 1189, 38, 70, "TechNoteText",ExpressionUUID->"d2586570-c120-4815-8bdd-7b090d969a06",
 CellID->725439230],
Cell[391336, 10293, 181, 3, 70, "TechNoteText",ExpressionUUID->"c79ae208-23f5-46fa-824c-e75d2fff2245",
 CellID->1192474591],
Cell[391520, 10298, 1000, 31, 70, "TechNoteText",ExpressionUUID->"54722d52-bdb7-4f66-ae90-08ca15442533",
 CellID->1603057133],
Cell[392523, 10331, 1046, 31, 70, "TechNoteText",ExpressionUUID->"952610df-26fa-4d72-8c5a-212b1d359d4a",
 CellID->251399069],
Cell[393572, 10364, 1184, 34, 70, "TechNoteText",ExpressionUUID->"01a7d574-97b1-4513-a180-b9fee48e6720",
 CellID->1163819034],
Cell[394759, 10400, 160, 2, 70, "TechNoteText",ExpressionUUID->"7bbe944e-65a6-4595-98d4-9c6566bcde42",
 CellID->1025447562],
Cell[394922, 10404, 958, 29, 70, "TechNoteText",ExpressionUUID->"819b4a2b-cea4-45d6-8dd2-315a3a2f9afb",
 CellID->1140907359],
Cell[395883, 10435, 300, 8, 70, "TechNoteText",ExpressionUUID->"186b09fe-bdc5-425a-a3d9-2168477b0b6d",
 CellID->348498650],
Cell[396186, 10445, 1147, 32, 70, "TechNoteText",ExpressionUUID->"711d23a5-bd5c-4dce-8fe4-9236a9e241cb",
 CellID->1028905181],
Cell[397336, 10479, 821, 23, 70, "TechNoteText",ExpressionUUID->"04125d4e-3fc2-4dcd-bdfc-2ba2972bfb70",
 CellID->1271051423],
Cell[398160, 10504, 179, 3, 70, "TechNoteText",ExpressionUUID->"a27d0f24-19ca-4d80-8b92-75813d60eea7",
 CellID->1541429652],
Cell[398342, 10509, 392, 12, 70, "TechNoteText",ExpressionUUID->"2eb037f1-e08c-4499-abc5-5d61c9713351",
 CellID->1712927403],
Cell[398737, 10523, 337, 7, 70, "TechNoteText",ExpressionUUID->"eb5151e6-dba9-415c-a179-e419fa112c54",
 CellID->5090539],
Cell[399077, 10532, 441, 12, 70, "TechNoteText",ExpressionUUID->"7e8a395b-efc0-4fde-88ce-a2f78edd4b83",
 CellID->1804826740],
Cell[399521, 10546, 249, 4, 70, "TechNoteMathCaption",ExpressionUUID->"e31c1eb9-c123-47d3-871c-726a37523b11",
 CellID->516505305],
Cell[CellGroupData[{
Cell[399795, 10554, 650, 19, 70, "Input",ExpressionUUID->"6cbb809c-af60-461b-a90d-af4c95e198b4",
 CellID->775759961],
Cell[400448, 10575, 1815, 46, 36, "Output",ExpressionUUID->"d57bb907-a58d-4b68-b879-c2596a1ee8e5",
 CellID->1308787834],
Cell[402266, 10623, 1202, 31, 91, "Output",ExpressionUUID->"a2316662-dffc-497d-844c-333f2715156a",
 CellID->122129817]
}, Open  ]],
Cell[403483, 10657, 185, 3, 70, "TechNoteMathCaption",ExpressionUUID->"9e9bdb33-3885-4b97-b4a6-3b9aa0139fc3",
 CellID->595736468],
Cell[CellGroupData[{
Cell[403693, 10664, 268, 7, 70, "Input",ExpressionUUID->"9f763984-cadc-4f1b-b2d7-eb9d66653a9e",
 CellID->974055362],
Cell[403964, 10673, 2405, 57, 42, "Output",ExpressionUUID->"df66e092-d4ce-42f4-9436-fe7db088bc68",
 CellID->1575357876]
}, Open  ]],
Cell[406384, 10733, 214, 5, 70, "TechNoteMathCaption",ExpressionUUID->"d818ba92-80c1-44ed-8268-89b2f29e7ed9",
 CellID->1817782849],
Cell[CellGroupData[{
Cell[406623, 10742, 301, 7, 70, "Input",ExpressionUUID->"159f42ef-b496-44a3-b012-497c207c35dd",
 CellID->1373980921],
Cell[406927, 10751, 3153, 110, 168, "Output",ExpressionUUID->"b5aa7442-1d9e-471a-9f48-a93596020c0d",
 CellID->157194427]
}, Open  ]],
Cell[410095, 10864, 354, 7, 70, "TechNoteMathCaption",ExpressionUUID->"5a7e27fe-2225-44e8-b317-d0ae0115f239",
 CellID->642635412],
Cell[CellGroupData[{
Cell[410474, 10875, 480, 14, 70, "Input",ExpressionUUID->"caaa5b20-76a0-4440-add3-3dd839c66643",
 CellID->1078108721],
Cell[410957, 10891, 19285, 411, 70, "Output",ExpressionUUID->"a440580e-040d-4b09-9a05-601501accf09",
 CellID->942723797]
}, Open  ]],
Cell[430257, 11305, 311, 7, 70, "TechNoteMathCaption",ExpressionUUID->"c1e2182b-67be-45fd-ba84-8cddb6f5a8d5",
 CellID->1155771237],
Cell[CellGroupData[{
Cell[430593, 11316, 302, 8, 70, "Input",ExpressionUUID->"0ede892b-4cb1-4ba4-913c-aba1ed31bc97",
 CellID->1057593144],
Cell[430898, 11326, 3436, 87, 142, "Output",ExpressionUUID->"11c3b3ed-a85f-48b4-a0ec-0bbb4d2bd38a",
 CellID->372808929]
}, Open  ]],
Cell[434349, 11416, 152, 1, 70, "TechNoteMathCaption",ExpressionUUID->"0abe399f-d574-48d6-9464-09cf9892c877",
 CellID->1969536942],
Cell[CellGroupData[{
Cell[434526, 11421, 353, 10, 70, "Input",ExpressionUUID->"2a5e5870-3c58-41bb-81a2-ff7c2bbea5dc",
 CellID->694449336],
Cell[434882, 11433, 669, 19, 91, "Output",ExpressionUUID->"da1fef6f-3f18-4dae-b443-3d89cb699836",
 CellID->1145675512]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[435600, 11458, 193, 4, 70, "Subsection",ExpressionUUID->"67cdb688-dace-4636-984d-c0b0c191ead0",
 CellTags->"Section22",
 CellID->1363502801],
Cell[435796, 11464, 249, 4, 70, "TechNoteText",ExpressionUUID->"add844bf-4f28-4802-8dbf-0318c1198384",
 CellID->593579270],
Cell[436048, 11470, 492, 17, 70, "TechNoteText",ExpressionUUID->"b4f13e92-e965-4186-8e10-cdd2e6ac9ac3",
 CellID->1225250575],
Cell[436543, 11489, 242, 4, 70, "TechNoteText",ExpressionUUID->"a106bff1-0e48-4ed8-8984-c0f8bee331c9",
 CellID->565722942],
Cell[436788, 11495, 1185, 36, 70, "TechNoteText",ExpressionUUID->"3e71e7b5-e516-4ed5-a32a-a400626e5963",
 CellID->1195380925],
Cell[437976, 11533, 138, 1, 70, "TechNoteText",ExpressionUUID->"031369b6-4115-4197-9093-4b5b90cab738",
 CellID->1057688790],
Cell[438117, 11536, 492, 17, 70, "TechNoteText",ExpressionUUID->"3740369b-7399-4b7c-bf9d-b6dfb8397cec",
 CellID->1853347311],
Cell[438612, 11555, 285, 5, 70, "TechNoteText",ExpressionUUID->"8265105d-e991-48df-989b-060f20b2b124",
 CellID->2105439889],
Cell[438900, 11562, 1185, 36, 70, "TechNoteText",ExpressionUUID->"65f0722c-cdde-4e17-9663-455704380a1b",
 CellID->2040162804],
Cell[440088, 11600, 169, 3, 70, "TechNoteText",ExpressionUUID->"beabb6e9-02f6-4562-8d67-2586c9ed9506",
 CellID->144855179],
Cell[440260, 11605, 494, 17, 70, "TechNoteText",ExpressionUUID->"92af741b-5dfb-4c57-96e9-69ece1ad09e3",
 CellID->1482021402],
Cell[440757, 11624, 335, 6, 70, "TechNoteText",ExpressionUUID->"f005fddb-fefd-4a1e-94fd-6776cb80b0ac",
 CellID->1818365508],
Cell[441095, 11632, 810, 28, 70, "TechNoteText",ExpressionUUID->"70978724-636f-46cf-9224-a297fe97ad0f",
 CellID->429312499],
Cell[441908, 11662, 433, 7, 70, "TechNoteText",ExpressionUUID->"6be7269d-f409-4a5d-a017-6f6dba94b169",
 CellID->2057600420],
Cell[442344, 11671, 1672, 44, 70, "TechNoteText",ExpressionUUID->"82ae7617-f874-4f3b-8ffe-2e984b3250dd",
 CellID->1161091299],
Cell[444019, 11717, 225, 4, 70, "TechNoteText",ExpressionUUID->"51b2db5e-d601-4dc4-b5ae-00787ac0969b",
 CellID->277562004],
Cell[444247, 11723, 337, 5, 70, "TechNoteText",ExpressionUUID->"9a3fbd85-d314-4f83-92f5-e46ad9e3273a",
 CellID->650119944],
Cell[444587, 11730, 810, 28, 70, "TechNoteText",ExpressionUUID->"1c920c34-03a3-4197-94f8-948a8611b7b4",
 CellID->169102872],
Cell[445400, 11760, 1128, 24, 70, "TechNoteText",ExpressionUUID->"7d507b5f-7ebc-45e2-95fe-99b0410d42be",
 CellID->991104723],
Cell[446531, 11786, 1671, 44, 70, "TechNoteText",ExpressionUUID->"feb19f0c-ef1c-4a81-96a8-39cc6be55e9b",
 CellID->1613913329],
Cell[448205, 11832, 192, 4, 70, "TechNoteText",ExpressionUUID->"305a9ba2-1e31-4cc3-aaca-8be1de1b9cc0",
 CellID->175375246],
Cell[448400, 11838, 4614, 113, 70, "TechNoteText",ExpressionUUID->"c713e31e-6862-43f1-95b3-765b40de7bad",
 CellID->1184195838],
Cell[453017, 11953, 180, 3, 70, "TechNoteText",ExpressionUUID->"58e84920-dc8c-42db-948d-ba1d72ee7e1e",
 CellID->2048492517],
Cell[CellGroupData[{
Cell[453222, 11960, 479, 13, 70, "Input",ExpressionUUID->"df57f8c0-d3d4-4802-9d4b-eb661effcb49",
 CellID->555904515],
Cell[453704, 11975, 1155, 33, 79, "Output",ExpressionUUID->"d9415cb8-d290-44a8-9b7f-81c1317cbf52",
 CellID->1650072520]
}, Open  ]],
Cell[454874, 12011, 201, 4, 70, "TechNoteMathCaption",ExpressionUUID->"c090a61b-de7b-475f-94f1-879eb4f6e7ac",
 CellID->691274085],
Cell[CellGroupData[{
Cell[455100, 12019, 466, 13, 70, "Input",ExpressionUUID->"b038ee12-cb1f-486e-b4b5-72e894862208",
 CellID->357016325],
Cell[455569, 12034, 1250, 35, 111, "Output",ExpressionUUID->"a9efa7b9-9e8c-4249-8900-4979ca520f0e",
 CellID->441869156]
}, Open  ]],
Cell[456834, 12072, 153, 1, 70, "TechNoteMathCaption",ExpressionUUID->"586ba44a-d133-4393-998b-df051f90f86e",
 CellID->1549413286],
Cell[CellGroupData[{
Cell[457012, 12077, 906, 23, 70, "Input",ExpressionUUID->"a64dacdb-20c7-4a74-9473-c3feaf940a38",
 CellID->602394280],
Cell[457921, 12102, 2525, 57, 106, "Output",ExpressionUUID->"c531c402-2ce1-4f9d-89ab-1226a2a9e760",
 CellID->1118532525]
}, Open  ]],
Cell[460461, 12162, 137, 1, 70, "TechNoteMathCaption",ExpressionUUID->"59e5bd6f-f7cb-4b67-91bd-10b198004228",
 CellID->389328403],
Cell[CellGroupData[{
Cell[460623, 12167, 1037, 27, 70, "Input",ExpressionUUID->"cac6d6f9-8c70-4a84-8c9c-9e235b81d4d2",
 CellID->59796812],
Cell[461663, 12196, 3388, 76, 106, "Output",ExpressionUUID->"64db1a07-4476-4ce8-acb9-dea5fa17c77f",
 CellID->94168347]
}, Open  ]],
Cell[465066, 12275, 193, 4, 70, "TechNoteMathCaption",ExpressionUUID->"fafb3a72-0290-48ce-9954-d8c82c37ff76",
 CellID->834281808],
Cell[CellGroupData[{
Cell[465284, 12283, 551, 16, 70, "Input",ExpressionUUID->"b5e37e89-dc3c-4bb8-92a2-bb9bb3fe6da2",
 CellID->853615793],
Cell[465838, 12301, 669, 19, 91, "Output",ExpressionUUID->"6e6ec4ca-57b6-465c-a7ba-0a684da6208c",
 CellID->1418788588],
Cell[466510, 12322, 669, 19, 91, "Output",ExpressionUUID->"10bb4ac0-7004-4ffe-8d6e-583e1bc2b65c",
 CellID->2068865875]
}, Open  ]],
Cell[467194, 12344, 633, 13, 70, "TechNoteText",ExpressionUUID->"49cf7222-dcc6-4ebe-9b96-ec67e3c673d9",
 CellID->645391397]
}, Open  ]],
Cell[CellGroupData[{
Cell[467864, 12362, 134, 2, 70, "Subsection",ExpressionUUID->"3a6c8676-47ee-432a-b76d-72a842f564f9",
 CellTags->"Section23",
 CellID->153308382],
Cell[468001, 12366, 427, 7, 70, "TechNoteText",ExpressionUUID->"7feb337b-aad0-44e7-9043-154e336795d6",
 CellID->1821083521],
Cell[468431, 12375, 280, 5, 70, "TechNoteMathCaption",ExpressionUUID->"f05ef591-c1b2-484a-9eae-8a873e985d98",
 CellID->1013800403],
Cell[CellGroupData[{
Cell[468736, 12384, 555, 17, 70, "Input",ExpressionUUID->"1963b422-7823-4e68-a4c3-8f0ca00ee5b8",
 CellID->808117923],
Cell[469294, 12403, 1813, 46, 36, "Output",ExpressionUUID->"ec6930bb-308f-404b-9661-c995ade6d0ac",
 CellID->97748634]
}, Open  ]],
Cell[471122, 12452, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"9934f4e4-ea83-4b1a-b44e-d5cf3c98da28",
 CellID->322701359],
Cell[CellGroupData[{
Cell[471357, 12460, 269, 7, 70, "Input",ExpressionUUID->"cdece733-8fb4-4999-840a-5783b21928d4",
 CellID->1245532038],
Cell[471629, 12469, 2404, 57, 42, "Output",ExpressionUUID->"3eb70bc7-8f0b-4010-8646-df4ad547fec3",
 CellID->452680772]
}, Open  ]],
Cell[474048, 12529, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"e7b44c3f-92c8-4b10-8faa-c9690661bcb3",
 CellID->730080199],
Cell[CellGroupData[{
Cell[474269, 12537, 374, 10, 70, "Input",ExpressionUUID->"4674d0ae-34a5-4aac-803c-50b3b6e57459",
 CellID->1883829282],
Cell[474646, 12549, 3153, 110, 168, "Output",ExpressionUUID->"c3f3d390-90c2-4789-9307-bdb8c09abd14",
 CellID->882493169]
}, Open  ]],
Cell[477814, 12662, 200, 4, 70, "TechNoteMathCaption",ExpressionUUID->"a382ce6e-c586-4619-8bf8-82de1aaad833",
 CellID->2133759026],
Cell[CellGroupData[{
Cell[478039, 12670, 509, 15, 70, "Input",ExpressionUUID->"d7864f38-cc2e-4575-bafb-99d65aecd045",
 CellID->1258528729],
Cell[478551, 12687, 8675, 219, 396, "Output",ExpressionUUID->"8db1c03e-45ef-4f97-8f2f-dd8bb804cc27",
 CellID->1519960140]
}, Open  ]],
Cell[487241, 12909, 371, 7, 70, "TechNoteMathCaption",ExpressionUUID->"6046572a-5a8d-462c-87f1-604f37996030",
 CellID->702850526],
Cell[CellGroupData[{
Cell[487637, 12920, 217, 5, 70, "Input",ExpressionUUID->"e7a875dd-2a45-4176-b53c-961560777468",
 CellID->1648731982],
Cell[487857, 12927, 8253, 189, 196, "Output",ExpressionUUID->"990b0642-62c4-4a0e-a815-0379312c182e",
 CellID->1743970539]
}, Open  ]],
Cell[496125, 13119, 400, 6, 70, "TechNoteMathCaption",ExpressionUUID->"3523e715-b452-4dd9-884b-229139011a80",
 CellID->328948492],
Cell[CellGroupData[{
Cell[496550, 13129, 222, 5, 70, "Input",ExpressionUUID->"7623237b-ab08-4470-8a3d-1c6bcbf3cc24",
 CellID->1014397666],
Cell[496775, 13136, 6112, 124, 106, "Output",ExpressionUUID->"b1408366-e2cf-454b-b054-4ee44f210012",
 CellID->1180909134]
}, Open  ]],
Cell[502902, 13263, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"92764ace-1689-49ff-9930-2bfaeb7a59b3",
 CellID->608232459],
Cell[CellGroupData[{
Cell[503123, 13271, 338, 9, 70, "Input",ExpressionUUID->"85c51043-5ed8-4721-8789-7728f3721e37",
 CellID->540778693],
Cell[503464, 13282, 2682, 59, 91, "Output",ExpressionUUID->"992c88f7-5cd1-4c7b-8f15-f83e93c4da65",
 CellID->742656172]
}, Open  ]],
Cell[CellGroupData[{
Cell[506183, 13346, 216, 6, 70, "Input",ExpressionUUID->"de86b3f9-682a-4faa-b06d-29494ad665cb",
 CellID->326787606],
Cell[506402, 13354, 668, 19, 91, "Output",ExpressionUUID->"161c7b9c-d6cd-428b-9774-ad2613c906d0",
 CellID->222343541]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[507109, 13378, 753, 19, 70, "TutorialMoreAboutSection",ExpressionUUID->"2967b1dd-a3a9-4716-be27-45e3b7298b10"],
Cell[507865, 13399, 1140, 30, 70, "RelatedTutorialsSection",ExpressionUUID->"68b342ce-135c-45ab-ae7e-a9563ed8d5eb"],
Cell[509008, 13431, 5244, 132, 70, "TutorialRelatedLinksSection",ExpressionUUID->"b0d3eea2-70fc-49a3-84e5-86a47c581d7f"]
}, Open  ]],
Cell[514267, 13566, 78, 0, 70, "FooterCell",ExpressionUUID->"3b298671-4e8b-4e15-8788-e894e4a8c85b"]
}
]
*)

(* End of internal cache information *)

