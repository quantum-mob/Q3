(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    259591,       6691]
NotebookOptionsPosition[    238454,       6311]
NotebookOutlinePosition[    241912,       6383]
CellTagsIndexPosition[    241869,       6380]
WindowTitle->Quantum Search Algorithm
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3S TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "f897f824-c972-4886-aad7-0592b2d60dc7"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "23eb01e3-e5da-484d-8f2e-7e98b24dda38"],
        Background->RGBColor[
         0.3843137254901961, 0.4627450980392157, 0.7019607843137254],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "9394e3bf-56f2-4ee1-948e-01aa0c960c6e"]
         }],ExpressionUUID->"b1da79f6-a5ef-44a6-9c8a-19ae0635bc7e"],
         StripOnInput->False],{
        StyleBox["\"CZ\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/CZ"], 
         StyleBox["\"Hadamard\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/Hadamard"], 
         StyleBox["\"Oracle\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3S/ref/Oracle"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "3c6ba892-daef-40bb-a701-5348c7a0755f"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "79423742-51a2-41b4-a163-0ae27227953b"]
         }],ExpressionUUID->"106afef5-754a-4216-9036-567c4fd52e82"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "c5fc0c1e-5325-4310-8647-61fc692c1bc9"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "e4f6d426-846a-42aa-8ce3-14e07e0e59bf"]
         }],ExpressionUUID->"fae3ff46-fb64-4504-ae65-2ad8fe6af39f"],
         StripOnInput->False],{
        "\"Quantum Algorithms\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumAlgorithms"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "9c88771d-4da7-4f8f-bef3-cc062438c8b1"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "1037e931-ec5b-4ae9-b4a4-fd84a407f1b5"]
         }],ExpressionUUID->"0a140d96-107d-4964-bf0e-ec7bc1697268"],
         StripOnInput->False],{
        "\"QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm"], 
         Delimiter, "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3S/\
tutorial/QuantumSearchAlgorithm.html"], StandardForm]], "Input", 
                 TextClipboardType -> "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm" <> ".html"], 
              None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "ee4fa794-c16e-426d-8bb9-870136447845"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "f4eab3fe-4753-4d1b-a943-6e2d1d77f04a"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"6020a569-6a90-411c-9614-5fe3cd1ac9a1"],

Cell[CellGroupData[{

Cell["Quantum Search Algorithm", "TechNoteTitle",
 CellID->431054410,ExpressionUUID->"74e72a5a-d115-4292-88f9-895c564fd340"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Householder Transformation"], 
      "paclet:QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm#1076935439", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Example"], 
      "paclet:QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm#1481138763", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Grover Rotation"], 
      "paclet:QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm#1497043023", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Notes"], 
      "paclet:QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm#1668202417", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Quantum Implementation"], 
      "paclet:QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm#1111568547", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], ""}
  }]], "TechNoteJumpBox",ExpressionUUID->"8c511528-10fc-477c-a87c-\
7c134dafabeb"],

Cell[TextData[{
 "See also Section 4.5 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "8fdc656d-8a8b-4fea-b376-4e13f13b2fc6"],
 "."
}], "TechNoteText",
 TextAlignment->"Right",
 CellID->1308734266,ExpressionUUID->"687c81cd-9b5d-4d62-ad8c-5c913010e987"],

Cell[TextData[{
 "The quantum search algorithm\[LongDash]also known as Grover\
\[CloseCurlyQuote]s algorithm after its inventor (Grover, 1996, 1997)\
\[LongDash]is a quantum algorithm to conduct an unstructured search. The \
unstructured search problem is to find a small number of elements with a \
specified property from within a huge unsorted (or, more generally, \
unstructured) data set. The quantum search algorithm finds a desired element \
with a high probability with an order of ",
 Cell[BoxData[
  FormBox[
   SqrtBox["N"], TraditionalForm]],ExpressionUUID->
  "641bc9b3-6bc9-42ec-b79a-fe699ef9475d"],
 " queries to the function that defines the property, where ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]],ExpressionUUID->
  "f71dccb7-9ce0-4565-9264-75b4970cc6b1"],
 " is the size of the data set. Classical algorithms needs ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]],ExpressionUUID->
  "9980822a-1449-4f10-a1a7-ef976d880323"],
 " queries."
}], "TechNoteText",
 CellID->511227000,ExpressionUUID->"45904a04-26ea-40ef-850b-23211c1aa26b"],

Cell[TextData[{
 "Interestingly, the quantum search algorithm is known to be already optimal \
in the sense that any quantum algorithm for unstructured search needs an \
order of ",
 Cell[BoxData[
  FormBox[
   SqrtBox["N"], TraditionalForm]],ExpressionUUID->
  "c8a462db-be52-433e-bf3d-f5def74eab69"],
 " queries. In any case, the superiority of the quantum algorithm over its \
classical counterparts is merely quadratic (i.e., polynomial) rather than \
exponential. However, the quadratic speedup cannot be underestimated. The \
efficacy is considerable for large ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]],ExpressionUUID->
  "b2ec5acb-27ba-4eb6-bd17-c9e9bcaf3c58"],
 "."
}], "TechNoteText",
 CellID->110117353,ExpressionUUID->"e773b89a-e29b-450c-9186-d702cd7835be"],

Cell["\<\
Furthermore, the quantum search algorithm can apply to a wide range of \
problems. For example, it enables us to determine the existence and number of \
solutions of so-called NP-complete problems and to search exhaustively for \
the solutions.\
\>", "TechNoteText",
 CellID->1374334002,ExpressionUUID->"935055c0-759e-422a-9f25-727dffde0737"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["Oracle"]], "paclet:QuantumMob/Q3S/ref/Oracle", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents a quantum implementation of classical oracle.", 
     "TechNoteTableText",ExpressionUUID->
     "c818eaa4-a6f8-4a14-a575-3e7715b8ec3f"]},
   {
    TemplateBox[{
      Cell[
       TextData["Hadamard"]], "paclet:QuantumMob/Q3S/ref/Hadamard", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The Hadamard gate on a single qubit.", "TechNoteTableText",
     ExpressionUUID->"a0fddfd5-cc39-4372-898b-2f4337e89c5b"]},
   {
    TemplateBox[{
      Cell[
       TextData["CZ"]], "paclet:QuantumMob/Q3S/ref/CZ", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Controlled-Z gate.", "TechNoteTableText",ExpressionUUID->
     "50eeadc6-ca7a-40fb-8e35-f423c3a45139"]}
  }]], "DefinitionBox",
 CellID->172000137,ExpressionUUID->"f86d0323-7f15-4e3f-a76c-4d39a2597ef0"],

Cell["Q3 functions used in the quantum search algorithm.", "TechNoteCaption",
 CellID->293313697,ExpressionUUID->"7ae5a030-4d43-4e76-91a2-3de0cb24db96"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/guide/Q3"],
 " package is loaded to use the demonstrations in this document."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"d7c25232-8189-48ed-b6d7-3324ac06f887"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[160]:=",
 CellID->853967906,ExpressionUUID->"643b7028-c3ec-4552-a891-88de29d78453"],

Cell[TextData[{
 "Throughout this document, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "TechNoteMathCaption",
 CellID->1937193009,ExpressionUUID->"69bc801f-5504-4ff1-8c51-8bc9b9a3e4c6"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[161]:=",
 CellID->403330096,ExpressionUUID->"dfd3630d-f88a-4efd-a53d-6e304576396d"],

Cell[CellGroupData[{

Cell["Householder Transformation", "TechNoteSection",
 CellID->1076935439,ExpressionUUID->"3c0632e7-6909-4304-961c-7453ae0e58a2"],

Cell[TextData[{
 "To understand and analyze the quantum search algorithm, it is convenient to \
introduce two closely related unitary operators. One is ",
 StyleBox["Householder transformation",
  FontSlant->"Italic"],
 ". Let ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "22177c3e-053e-4d5e-817a-9c97cdecf7eb"],
 " be a normalized vector in the Hilbert space. The Householder \
transformation associated with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "47e368d9-d48b-4f14-ba20-be8360d37e56"],
 " is a unitary transformation defined by"
}], "TechNoteText",
 CellID->1061746357,ExpressionUUID->"65015c11-c095-42cb-884c-952def4a3413"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "v"], ":=", 
    RowBox[{"I", "-", 
     RowBox[{"2", 
      TemplateBox[{"v"},
       "Ket"], 
      TemplateBox[{"v"},
       "Bra"]}]}]}], TraditionalForm]],ExpressionUUID->
  "1d5e1628-93ba-4d1b-b370-806f1a00a629"],
 "."
}], "TechNoteText",
 CellID->792087644,ExpressionUUID->"b5ac9929-36f0-4945-adf3-1f20a49f7433"],

Cell[TextData[{
 "Geometrically, it is a reflection in the hyperplane perpendicular to the \
vector ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "2b8b94d6-4a97-47dc-b2a8-3671d7243857"],
 " and containing the origin (null vector) as illustrated in ",
 ButtonBox["Figure 1",
  BaseStyle->"Link",
  ButtonData->
   "paclet:QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm#891091610"],
 ". For this reason, it is also known as ",
 StyleBox["Householder reflection",
  FontSlant->"Italic"],
 "."
}], "TechNoteText",
 CellID->365904955,ExpressionUUID->"089df284-5919-467a-8727-73721406c379"],

Cell[TextData[Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[$Failed, {{0, 301.14}, {300.06, 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{400, 400}],
   BoxForm`ImageTag[
   "Byte", ColorSpace -> "RGB", Interleaving -> True, 
    MetaInformation -> <|
     "Exif" -> <|
       "ImageWidth" -> 1667, "ImageLength" -> 1673, "XResolution" -> 400, 
        "YResolution" -> 400, "ResolutionUnit" -> "Inch", "Software" -> 
        "Created with the Wolfram Language : www.wolfram.com", "DateTime" -> 
        DateObject[{2022, 1, 12, 21, 39, 14.}, "Instant", "Gregorian", 9.], 
        "TimeZoneOffset" -> 9|>|>],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSizeRaw->{300.06, 301.14},
  PlotRange->{{0, 300.06}, {
    0, 301.14}}]],ExpressionUUID->"b0db0ec6-68cb-4c41-ac3d-a7bbc2157d7f"]], \
"Picture",
 TextAlignment->Center,
 CellID->1940887528,ExpressionUUID->"4cdfb2b0-b56d-4661-94c9-78f96f20e9ce"],

Cell[TextData[{
 StyleBox["Figure 1",
  FontWeight->"Bold"],
 ". Geometric interpretation of the Householder transformation. Householder \
transformation ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "v"], TraditionalForm]],ExpressionUUID->
  "329068a8-0a9b-48c3-aa1a-6b7427ec248d"],
 " associated with a normalized vector ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "e280b4c1-c0d8-4506-98b1-c0477712fc10"],
 " is a reflection in the hyperplane containing the origin and perpendicular \
to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "a1b2a906-ac3a-4e6c-b0e3-258f838f66b6"],
 "."
}], "TechNoteCaption",
 TextAlignment->Center,
 CellID->891091610,ExpressionUUID->"1c78c035-76ce-46fe-b0ea-3db44bc4e8fe"],

Cell[TextData[{
 "\tThe other is ",
 StyleBox["Grover\[CloseCurlyQuote]s diffusion operator",
  FontSlant->"Italic"],
 ". Grover\[CloseCurlyQuote]s diffusion operator associated with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "48c07c5f-b5a9-41ba-b957-59a5f7bd966f"],
 " is defined by"
}], "TechNoteText",
 CellID->892352758,ExpressionUUID->"44233ce0-3cf6-4ca8-8d2d-e08248f8de85"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["V", "v"], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       TemplateBox[{"v"},
        "Ket"], 
       TemplateBox[{"v"},
        "Bra"]}], "-", "I"}], "=", 
     RowBox[{"-", 
      SubscriptBox["U", "v"]}]}]}], TraditionalForm]],ExpressionUUID->
  "54b03202-56b7-4de5-ad1f-253236daae76"],
 "."
}], "TechNoteText",
 CellID->1894496705,ExpressionUUID->"f4ba2b34-c64a-4d72-bf06-a4907bc9fa4b"],

Cell[TextData[{
 "It is a reflection in the line along the vector |v\:27e9 as shown in ",
 ButtonBox["Figure 2",
  BaseStyle->"Link",
  ButtonData->
   "paclet:QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm#725901784"],
 ". It can also be regarded as the Householder reflection ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "v"], TraditionalForm]],ExpressionUUID->
  "09c8424b-a422-416c-a0c3-3989de77b76e"],
 " associated with the same vector ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "f8f6e302-89cd-4485-a327-b7bed17971ae"],
 " followed by another reflection through the origin as illustrated in the \
above figure."
}], "TechNoteText",
 CellID->384300394,ExpressionUUID->"ca894f29-6266-405a-a111-d8db1b949a1e"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[$Failed, {{0, 301.14}, {300.06, 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->{400, 400}],
   BoxForm`ImageTag[
   "Byte", ColorSpace -> "RGB", Interleaving -> True, 
    MetaInformation -> <|
     "Exif" -> <|
       "ImageWidth" -> 1667, "ImageLength" -> 1673, "XResolution" -> 400, 
        "YResolution" -> 400, "ResolutionUnit" -> "Inch", "Software" -> 
        "Created with the Wolfram Language : www.wolfram.com", "DateTime" -> 
        DateObject[{2022, 1, 12, 21, 39, 14.}, "Instant", "Gregorian", 9.], 
        "TimeZoneOffset" -> 9|>|>],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSizeRaw->{300.06, 301.14},
  PlotRange->{{0, 300.06}, {0, 301.14}}]], "TechNoteText",
 TextAlignment->Center,
 CellID->472911363,ExpressionUUID->"315dede2-3004-4e53-a81c-018fe7d7aac1"],

Cell[TextData[{
 StyleBox["Figure 2",
  FontWeight->"Bold"],
 ". Geometric interpretation of Grover\[CloseCurlyQuote]s diffusion operator. \
Grover\[CloseCurlyQuote]s diffusion operator ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "v"], TraditionalForm]],ExpressionUUID->
  "f63c9e97-eeee-4520-90f4-f1a9c5623640"],
 " with respect to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "ec13677e-1811-4183-909c-51d92ebd9925"],
 " is a reflection in the line along the vector ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "138117ea-e433-40d0-8cd1-3cba2513b38c"],
 ". It can also be regarded as Householder transformation ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "v"], TraditionalForm]],ExpressionUUID->
  "a8d68837-a08e-44fb-b246-11a6544734cc"],
 " associated with the same vector ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "b61798c5-9a98-4533-a0ae-1183796232d6"],
 " followed by another reflection through the origin."
}], "TechNoteCaption",
 TextAlignment->Center,
 CellID->725901784,ExpressionUUID->"691bcf3d-38c0-49f8-9f18-0b3400557348"],

Cell[TextData[{
 "\tOne can directly implement the Householder reflection ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "v"], TraditionalForm]],ExpressionUUID->
  "bac9536d-74b4-4ff1-9096-8e5810c257b5"],
 " for a ",
 StyleBox["known",
  FontSlant->"Italic"],
 " state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "abfc90a0-0a98-4f43-a089-1ccac1fe3adf"],
 ". Suppose that ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "5ffabebc-88a1-413e-b2a5-562aab54fffc"],
 " is achieved from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "5968b03a-a1ca-4787-82cf-5c19bb84bb26"],
 " by a unitary transformation ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],ExpressionUUID->
  "e6e1e9eb-49be-4196-916f-12240544fede"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"v"},
     "Ket"], "=", 
    RowBox[{"W", 
     TemplateBox[{"0"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "f29ce544-4f28-4503-90d4-d32cecc1586a"],
 ". Then it follows that"
}], "TechNoteText",
 CellID->1453395429,ExpressionUUID->"dfdaf8fd-69fa-4fa2-9403-dc39af0eff0d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "v"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"W", "(", 
       RowBox[{"1", "-", 
        RowBox[{"2", 
         TemplateBox[{"0"},
          "Ket"], 
         TemplateBox[{"0"},
          "Bra"]}]}], ")"}], 
      SuperscriptBox["W", "\[Dagger]"]}], "=", 
     RowBox[{"W", " ", 
      SubscriptBox["U", "0"], 
      SuperscriptBox["W", "\[Dagger]"]}]}]}], TraditionalForm]],
  ExpressionUUID->"e417073a-59db-4b4b-a863-e38a6eb25f1d"],
 " ."
}], "TechNoteText",
 CellID->1737974225,ExpressionUUID->"acc56f8d-db9a-4c59-8432-704fb5a6ca57"],

Cell[TextData[{
 "Note that ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "0"], TraditionalForm]],ExpressionUUID->
  "bb68c83d-d631-409c-bfae-15bded6db9d4"],
 " flips the phase of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"0"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "09416098-52b8-46d0-b400-1937238fd113"],
 " to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "560a198e-9929-4694-ae07-54d224cfef84"],
 " but leaves other states unaffected. It is equivalent to writing"
}], "TechNoteText",
 CellID->60233081,ExpressionUUID->"05e69009-b6c4-4a93-ad67-2535b67e585f"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "v"], ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", "\[CenterEllipsis]", ",", 
          SubscriptBox["x", 
           RowBox[{"n", "-", "1"}]]}]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "n"]},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{
        RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", "\[CenterEllipsis]", ",", 
          SubscriptBox["x", 
           RowBox[{"n", "-", "1"}]]}]},
       "Ket"], "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "Z"}], 
        TemplateBox[{
          SubscriptBox["x", "n"]},
         "Ket"]}], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "84066fdd-a4a3-4830-9a5f-fb5ab7a2614d"]
}], "TechNoteText",
 CellID->872594630,ExpressionUUID->"33878362-fcac-405f-b99e-264abb005b8c"],

Cell[TextData[{
 "if ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "1"], "=", 
    RowBox[{
     SubscriptBox["x", "1"], "=", 
     RowBox[{"\[CenterEllipsis]", "=", 
      RowBox[{
       SubscriptBox["x", "1"], "=", "0"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"857cf4b1-2c7c-46a6-bc1b-318cc03c3736"],
 " and "
}], "TechNoteText",
 CellID->532121047,ExpressionUUID->"661f6553-0a22-45d0-96f1-77173aa8e7bc"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "v"], ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", "\[CenterEllipsis]", ",", 
          SubscriptBox["x", 
           RowBox[{"n", "-", "1"}]]}]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "n"]},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{
        RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", "\[CenterEllipsis]", ",", 
          SubscriptBox["x", 
           RowBox[{"n", "-", "1"}]]}]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "n"]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "cb90349d-e728-4191-9f5e-db70e0ed42b7"]
}], "TechNoteText",
 CellID->1236530821,ExpressionUUID->"e51dda3f-6212-4831-ab9d-6e9c764dec76"],

Cell[TextData[{
 "otherwise. It is a variant of multi-control Pauli-Z gate. More explicitly, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "0"], TraditionalForm]],ExpressionUUID->
  "80edb12f-e8fc-478c-87e1-fec15e5e581d"],
 " for four qubits is described by the following quantum circuit"
}], "TechNoteText",
 CellID->1174256528,ExpressionUUID->"3be5be1f-63f2-4014-8cb2-747977c83a6b"],

Cell[TextData[Cell[BoxData[
 TemplateBox[{
   InterpretationBox[
    GraphicsBox[{{
       Dashing[{Small, Small}], 
       LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -4}, {2, -4}}, {{
       0, -5}, {2, -5}}}], {
       LineBox[{{1, -1}, {1, -2}, {1, -4}, {1, -5}}], {
        EdgeForm[
         GrayLevel[0]], 
        GrayLevel[1], 
        DiskBox[{1, -1}, 0.09]}, {
        EdgeForm[
         GrayLevel[0]], 
        GrayLevel[1], 
        DiskBox[{1, -2}, 0.09]}, {
        EdgeForm[
         GrayLevel[0]], 
        GrayLevel[1], 
        DiskBox[{1, -4}, 0.09]}, {
        EdgeForm[], 
        GrayLevel[1], 
        RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, 
       LineBox[{{0.6, -5.4}, {1.4, -5.4}, {1.4, -4.6}, {0.6, -4.6}, {
        0.6, -5.4}}], 
       InsetBox[
        FormBox[
         StyleBox[
         "\"-Z\"", {}, FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
          Scaled[0.2], StripOnInput -> False], TraditionalForm], {1, -5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}, 
      InsetBox[
       FormBox[
        StyleBox[
        "\"\[VerticalEllipsis]\"", {}, FontSlant -> Plain, FontWeight -> 
         "Light", FontSize -> Scaled[0.2], StripOnInput -> False], 
        TraditionalForm], {0.4, -3}, 
       NCache[
        ImageScaled[{
          Rational[1, 2], 
          Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, PlotRange -> NCache[{Full, {
         Rational[-11, 2], 
         Rational[-1, 2]}}, {Full, {-5.5, -0.5}}], 
     ImagePadding -> {{23.400000000000002`, 23.400000000000002`}, {1, 1}}, 
     ImageSize -> 118.8, AxesStyle -> Large, FrameStyle -> Large, ImageSize -> 
     Large, PlotRangePadding -> Scaled[0.025]], 
    Q3`QuantumCircuit[
     Q3`ControlledGate[{
        $CellContext`S[1, Q3`$], 
        $CellContext`S[2, Q3`$], 
        $CellContext`S[3, Q3`$]} -> {0, 0, 0}, -$CellContext`S[4, 3], "Label" -> 
      "-Z"], 
     Q3`Mark["\[VerticalEllipsis]", {0.4, 3}], "Invisible" -> {
       $CellContext`S[
        Rational[5, 2]]}]], 
   StyleBox["=", StripOnInput -> False, FontSize -> Large], 
   InterpretationBox[
    GraphicsBox[{{
       Dashing[{Small, Small}], 
       LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -4}, {4, -4}}, {{
       0, -5}, {4, -5}}}], {{
        EdgeForm[], 
        GrayLevel[1], 
        RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, 
       LineBox[{{0.6, -5.4}, {1.4, -5.4}, {1.4, -4.6}, {0.6, -4.6}, {
        0.6, -5.4}}], 
       InsetBox[
        FormBox[
         StyleBox[
         "\"X\"", {}, FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
          Scaled[0.1], StripOnInput -> False], TraditionalForm], {1, -5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}, {
       LineBox[{{2, -1}, {2, -2}, {2, -4}, {2, -5}}], {
        EdgeForm[
         GrayLevel[0]], 
        GrayLevel[1], 
        DiskBox[{2, -1}, 0.09]}, {
        EdgeForm[
         GrayLevel[0]], 
        GrayLevel[1], 
        DiskBox[{2, -2}, 0.09]}, {
        EdgeForm[
         GrayLevel[0]], 
        GrayLevel[1], 
        DiskBox[{2, -4}, 0.09]}, {
        EdgeForm[], 
        GrayLevel[1], 
        RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, 
       LineBox[{{1.6, -5.4}, {2.4, -5.4}, {2.4, -4.6}, {1.6, -4.6}, {
        1.6, -5.4}}], 
       InsetBox[
        FormBox[
         StyleBox[
         "\"Z\"", {}, FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
          Scaled[0.1], StripOnInput -> False], TraditionalForm], {2, -5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}, {{
        EdgeForm[], 
        GrayLevel[1], 
        RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, 
       LineBox[{{2.6, -5.4}, {3.4, -5.4}, {3.4, -4.6}, {2.6, -4.6}, {
        2.6, -5.4}}], 
       InsetBox[
        FormBox[
         StyleBox[
         "\"X\"", {}, FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
          Scaled[0.1], StripOnInput -> False], TraditionalForm], {3, -5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]]]}, 
      InsetBox[
       FormBox[
        StyleBox[
        "\"\[VerticalEllipsis]\"", {}, FontSlant -> Plain, FontWeight -> 
         "Light", FontSize -> Scaled[0.1], StripOnInput -> False], 
        TraditionalForm], {0.4, -3}, 
       NCache[
        ImageScaled[{
          Rational[1, 2], 
          Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, PlotRange -> NCache[{Full, {
         Rational[-11, 2], 
         Rational[-1, 2]}}, {Full, {-5.5, -0.5}}], 
     ImagePadding -> {{23.400000000000002`, 23.400000000000002`}, {1, 1}}, 
     ImageSize -> 190.79999999999998`, AxesStyle -> Large, FrameStyle -> 
     Large, ImageSize -> Large, PlotRangePadding -> Scaled[0.025]], 
    Q3`QuantumCircuit[
     $CellContext`S[4, 1], 
     Q3`ControlledGate[{
        $CellContext`S[1, Q3`$], 
        $CellContext`S[2, Q3`$], 
        $CellContext`S[3, Q3`$]} -> {0, 0, 0}, 
      $CellContext`S[4, 3]], 
     $CellContext`S[4, 1], 
     Q3`Mark["\[VerticalEllipsis]", {0.4, 3}], "Invisible" -> {
       $CellContext`S[
        Rational[5, 2]]}]]},
  "RowDefault"]],ExpressionUUID->"e0ac1702-cd10-4b2a-b1cb-d833d665491e"]], \
"Picture",
 TextAlignment->Center,
 CellID->2056845661,ExpressionUUID->"4b770d64-f5d8-4bc0-b78e-c9fcea998180"],

Cell[TextData[{
 "Overall, the Householder transformation ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "v"], TraditionalForm]],ExpressionUUID->
  "417a5c64-ddfb-49c3-bb71-ca80b7f19efe"],
 " associated with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "2b4f2a2f-da5f-4f5f-b120-04a9b9d4ce0d"],
 " can be implemented by a quantum circuit of the form"
}], "TechNoteText",
 CellID->384530690,ExpressionUUID->"27b3e749-851d-4fcc-810f-475661fb42e8"],

Cell[TextData[Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -4}, {6, -4}}, {{
     0, -5}, {6, -5}}}], {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -5.4}, {1.4, -0.6}]}, 
     LineBox[{{0.6, -5.4}, {1.4, -5.4}, {1.4, -0.6}, {0.6, -0.6}, {
      0.6, -5.4}}], InsetBox[
      StyleBox["\<\"W\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, 
     LineBox[{{1.6, -5.4}, {2.4, -5.4}, {2.4, -4.6}, {1.6, -4.6}, {
      1.6, -5.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -4}, {3, -5}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{3, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, 
     LineBox[{{2.6, -5.4}, {3.4, -5.4}, {3.4, -4.6}, {2.6, -4.6}, {
      2.6, -5.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -5.4}, {4.4, -4.6}]}, 
     LineBox[{{3.6, -5.4}, {4.4, -5.4}, {4.4, -4.6}, {3.6, -4.6}, {
      3.6, -5.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {4, -5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -5.4}, {5.4, -0.6}]}, 
     LineBox[{{4.6, -5.4}, {5.4, -5.4}, {5.4, -0.6}, {4.6, -0.6}, {
      4.6, -5.4}}], InsetBox[
      StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(W\\), \\(\[Dagger]\\)]\\)\"\>",
       
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {5, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, InsetBox[
     StyleBox["\<\"\[VerticalEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.06666666666666667],
      FontWeight->"Light",
      FontSlant->Plain], {2, -3}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->262.8,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{
    $CellContext`W[{
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 1], 
      $CellContext`S[4, 1]}], "Label" -> "W"}, 
   $CellContext`S[4, 1], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {0, 0, 0}, 
    $CellContext`S[4, 3]], 
   $CellContext`S[4, 1], 
   Q3`Mark["\[VerticalEllipsis]", {2, 3}], {
    $CellContext`W[{
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 1], 
      $CellContext`S[4, 1]}], "Label" -> 
    "\!\(\*SuperscriptBox[\(W\), \(\[Dagger]\)]\)"}, "Invisible" -> {
     $CellContext`S[
      Rational[
      5, 2]]}]]],ExpressionUUID->"8f2c3a68-014c-4e58-8f2a-42e367f7d1c8"]], \
"Picture",
 TextAlignment->Center,
 CellID->1527920433,ExpressionUUID->"6af842e8-64c5-40e5-9143-dbd34ae77450"],

Cell[TextData[{
 "\tOne can achieve Grover\[CloseCurlyQuote]s diffusion operator ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "v"], TraditionalForm]],ExpressionUUID->
  "18f88c7f-2bce-4a8b-8a1e-7bcc79836c17"],
 " for a known vector ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"v"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "c1a3aa8e-e6c3-4373-9b7c-a59211493999"],
 " in the same manner (up to a global phase factor \[Minus]1)."
}], "TechNoteText",
 CellID->1957062925,ExpressionUUID->"e0962da3-83bb-48a5-8c1f-f5e0e1400780"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grover Rotation", "TechNoteSection",
 CellID->1497043023,ExpressionUUID->"2f504705-534f-4be3-9c26-c34c86eca2ee"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[166]:=",
 CellID->115353160,ExpressionUUID->"95291454-dafe-4582-ac75-063907e5fb4e"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[167]:=",
 CellID->1120395387,ExpressionUUID->"4e5a0a2e-8177-4d3e-a3ed-8ca3304e826c"],

Cell[TextData[{
 "Let us now describe the unstructured search problem more precisely. Suppose \
that we have a large list of items labeled by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", " ", "=", " ", "0"}], ",", "1", ",", "2", ",", "\[Ellipsis]",
     " ", ",", 
    RowBox[{"N", "\[Minus]", "1"}]}], TraditionalForm]],ExpressionUUID->
  "34732de3-d2a1-4c84-861c-1713d76497d9"],
 ". Among the items, there are a small number ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]],ExpressionUUID->
  "a64e5be2-7c83-4df5-9997-02bad4530660"],
 " (",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", " ", "\[LessEqual]", " ", "M", " ", "\[LessLess]", " ", "N"}],
    TraditionalForm]],ExpressionUUID->
  "ba0fe2b2-5420-49ab-b5c6-6c1ca089cbc6"],
 ") of items with a unique property. The problem is to seek those items. The \
property is usually described by a classical oracle, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", ":", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "n"], " ", "\[RightArrow]", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "89dc364c-465c-41ed-a9f6-4cd979b4960f"],
 ", where we assume ",
 Cell[BoxData[
  FormBox[
   RowBox[{"N", " ", "\[Congruent]", " ", 
    SuperscriptBox["2", "n"]}], TraditionalForm]],ExpressionUUID->
  "c81e884c-23f1-442b-9e1d-b9d01e151144"],
 ". The desired items are designated by the condition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "x", ")"}], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"f39fa531-5334-4ba9-bdce-efab065c657b"],
 ". In other words, an unstructured search is to find the solutions to the \
equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "x", ")"}], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"24b3842a-8094-4861-b7ba-7596bfa769ea"],
 ". This is why the quantum search algorithm applies to a broad class of \
problems where a function ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", 
    RowBox[{"(", "x", ")"}]}], TraditionalForm]],ExpressionUUID->
  "34680711-ef3b-42a3-b7f3-d91cd2072712"],
 " is well defined and can be evaluated without heavy cost."
}], "TechNoteText",
 CellID->883679309,ExpressionUUID->"f5b4f728-168e-4699-9674-022536249948"],

Cell[TextData[{
 "\tWe construct the quantum search algorithm combining Householder \
reflections and Grover\[CloseCurlyQuote]s diffusion operators. Let ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalM]", TraditionalForm]],ExpressionUUID->
  "ec5f31de-351a-4e54-9680-2e6dfa8dc166"],
 " be the set of solutions,"
}], "TechNoteText",
 CellID->1243711,ExpressionUUID->"e0b63732-d12d-4f6b-a7a0-f4b1002bf87b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalM]", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x", ":", 
        RowBox[{"f", "(", "x", ")"}]}], "=", "1"}], ",", " ", 
      RowBox[{"x", "=", "0"}], ",", "1", ",", "2", ",", "\[Ellipsis]", ",", 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"75701da7-9954-46c1-82dc-8834321e8d1a"],
 " ."
}], "TechNoteText",
 CellID->1575697954,ExpressionUUID->"a08f3dc7-e892-4eb0-ac20-eea6ca2b9156"],

Cell["Define a state of superposition consisting of the solutions", \
"TechNoteText",
 CellID->2134661721,ExpressionUUID->"c64c9c23-9a50-4e49-891d-dd52fef247e5"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Omega]"},
     "Ket"], ":=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["M"]], 
     UnderscriptBox["\[CapitalSigma]", 
      RowBox[{"x", "\[Element]", "\[ScriptCapitalM]"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "2f222b03-fd06-417c-bc1d-ce5a420d12f3"],
 " ,"
}], "TechNoteText",
 CellID->1397738065,ExpressionUUID->"fafad344-e7ed-4463-844f-0228ebda933f"],

Cell["and another consisting of items that are not solutions", "TechNoteText",
 CellID->460043922,ExpressionUUID->"643feacb-36e4-488f-81b4-031a6d34fa8a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      SubscriptBox["\[Omega]", "\[Perpendicular]"]},
     "Ket"], ":=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox[
       RowBox[{"N", "-", "M"}]]], 
     UnderscriptBox["\[CapitalSigma]", 
      RowBox[{"x", "\[NotElement]", "\[ScriptCapitalM]"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "fe747c2c-ae6d-4eca-a722-4b8d5b133727"],
 " ."
}], "TechNoteText",
 CellID->1017067854,ExpressionUUID->"84ae10a2-34ca-4519-880f-cf4df6f9dc4b"],

Cell[TextData[{
 "Obviously, they are orthogonal to each other, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Omega]", 
      SubscriptBox["\[Omega]", "\[Perpendicular]"]},
     "BraKet"], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "8ecaa0e5-0ef8-45f8-8653-aed80e3e8aea"],
 ". Neither of the two states are known nor can be prepared directly. Rather, \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "343f9b00-3bc1-4b63-b411-45785ea490fd"],
 " is the state that we want to produce through the algorithm. Now consider \
the overall-superposition state, consisting all logical basis states"
}], "TechNoteText",
 CellID->2037075705,ExpressionUUID->"6697388d-1535-47ae-865f-f62f5d2884be"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Alpha]"},
     "Ket"], ":=", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["N"]], 
     UnderoverscriptBox["\[CapitalSigma]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{"N", "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "e3b0e295-f80f-4872-9971-de8f00a76f4b"],
 " ,"
}], "TechNoteText",
 CellID->1947073461,ExpressionUUID->"cafecfcd-6dae-4dea-9542-a876abd6c765"],

Cell[TextData[{
 "which can be prepared by applying the Hadamard gates ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["H", 
    RowBox[{"\[CircleTimes]", "n"}]], TraditionalForm]],ExpressionUUID->
  "a60b53ee-b08c-4f33-9f06-0da85cabc4ba"],
 " on ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"0"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "7e365d65-a605-44c1-93f2-f8145e2fc0c7"],
 ". Since ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Alpha]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "2064093d-83f4-44d8-9feb-c743fd863c23"],
 " involves both solutions and non-solutions, one can rewrite it into the form"
}], "TechNoteText",
 CellID->1107846041,ExpressionUUID->"f1f483a0-6c1a-4984-a802-c02f908b5dcd"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Alpha]"},
     "Ket"], "=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"\[Omega]"},
       "Ket"], 
      SqrtBox[
       FractionBox["M", "N"]]}], "+", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["\[Omega]", "\[Perpendicular]"]},
       "Ket"], 
      SqrtBox[
       FractionBox[
        RowBox[{"N", "-", "M"}], "N"]]}]}]}], TraditionalForm]],
  ExpressionUUID->"25211be0-bd15-4077-b708-da0a66eeb571"],
 "."
}], "TechNoteText",
 CellID->885191597,ExpressionUUID->"e554fbae-6643-4e84-ac1e-e40fa587891e"],

Cell[TextData[{
 "\tThe advantage of the overall-superposition state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Alpha]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "dee965ea-cfdc-4dd1-8f7c-608223219387"],
 " is that one can make use of the linearity of quantum \
mechanics\[LongDash]or ",
 StyleBox["quantum parallelism",
  FontSlant->"Italic"],
 "\[LongDash]to evaluate an operator on every state all at once. Indeed, \
applying the Householder reflection ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "\[Omega]"], TraditionalForm]],ExpressionUUID->
  "1951de2e-94b4-4c81-bcee-7be4909a5c28"],
 " associated with the state vector ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "97fa5449-7e1e-4ea3-9356-296806758486"],
 " on ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Alpha]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "99b9ef87-e8db-43df-83ca-3bfbbae15ffb"],
 " produces"
}], "TechNoteText",
 CellID->1795948010,ExpressionUUID->"21403955-1a83-4bc0-b20b-32cdbd4d2724"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "\[Omega]"], 
     TemplateBox[{"\[Alpha]"},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        TemplateBox[{"\[Omega]"},
         "Ket"]}], 
       SqrtBox[
        FractionBox["M", "N"]]}], "+", 
      RowBox[{
       TemplateBox[{
         SubscriptBox["\[Omega]", "\[Perpendicular]"]},
        "Ket"], 
       SqrtBox[
        FractionBox[
         RowBox[{"N", "-", "M"}], "N"]]}]}], "=", 
     RowBox[{
      FractionBox["1", 
       SqrtBox["N"]], 
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"x", "=", "0"}], 
        RowBox[{"N", "-", "1"}]], 
       SuperscriptBox[
        RowBox[{
         TemplateBox[{"x"},
          "Ket"], "(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"f", "(", "x", ")"}]]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"0c74787a-8a02-4d8c-89e2-be1e09c08154"],
 "."
}], "TechNoteText",
 CellID->1615545485,ExpressionUUID->"99f7a53f-a110-40e8-834b-3eadfce39f3e"],

Cell[TextData[{
 "With a single operation of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "\[Omega]"], TraditionalForm]],ExpressionUUID->
  "0b4f76ab-40e9-463b-a5cb-28aeac05ca01"],
 ", we have flagged the states ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"x"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "3cabf78a-dbd6-4585-9a58-dfaf1c747a11"],
 " associated with the solutions by the reversed phase factor \[Minus]1. \
Unfortunately, however, we cannot directly single out those states. Instead, \
the tactic is to amplify the component along the state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "6d3cf7cd-e288-4e36-9228-03dbefb46ec1"],
 ". This can be achieved by applying Grover\[CloseCurlyQuote]s diffusion \
operator ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Alpha]"], TraditionalForm]],ExpressionUUID->
  "cc08b22a-64eb-4894-bf47-375d66ee7881"],
 " associated with ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Alpha]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "69c549c7-5abc-407c-a7fa-03dab8e87d4d"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", "\[Omega]"], 
     TemplateBox[{"\[Alpha]"},
      "Ket"]}], "\[RightArrow]", 
    RowBox[{
     SubscriptBox["V", "\[Alpha]"], 
     SubscriptBox["U", "\[Omega]"], 
     TemplateBox[{"\[Alpha]"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "da72cd0c-8a4d-476c-9f5d-f76460cce107"],
 ". As illustrated geometrically in ",
 ButtonBox["Figure 3",
  BaseStyle->"Link",
  ButtonData->
   "paclet:QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm#1113346130"],
 " (left), it brings the state closer to the state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "cadfeb32-f40a-44f0-b6a5-4cf80f60ba36"],
 "."
}], "TechNoteText",
 CellID->1837217374,ExpressionUUID->"3aa557c7-d813-4b7e-afb5-052da691b3b3"],

Cell[TextData[{
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[$Failed, {{0, 343.08}, {400.14, 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{400, 400}],
    BoxForm`ImageTag[
    "Byte", ColorSpace -> "RGB", Interleaving -> True, 
     MetaInformation -> <|
      "Exif" -> <|
        "ImageWidth" -> 2223, "ImageLength" -> 1906, "XResolution" -> 400, 
         "YResolution" -> 400, "ResolutionUnit" -> "Inch", "Software" -> 
         "Created with the Wolfram Language : www.wolfram.com", "DateTime" -> 
         DateObject[{2022, 4, 5, 9, 12, 7.}, "Instant", "Gregorian", 9.], 
         "TimeZoneOffset" -> 9|>, 
       "Comments" -> <|
        "Software" -> "Created with the Wolfram Language : www.wolfram.com", 
         "Creation Time" -> 
         DateObject[{2022, 4, 5, 9, 12, 7.}, "Instant", "Gregorian", 
           None]|>|>],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->{299.92515625, Automatic},
   ImageSizeRaw->{400.14, 343.08},
   PlotRange->{{0, 400.14}, {0, 343.08}}]], "Input",ExpressionUUID->
  "3583340d-38e7-4bae-ae07-12b641bbb68a"],
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[$Failed, {{0, 343.08}, {400.14, 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{400, 400}],
    BoxForm`ImageTag[
    "Byte", ColorSpace -> "RGB", Interleaving -> True, 
     MetaInformation -> <|
      "Exif" -> <|
        "ImageWidth" -> 2223, "ImageLength" -> 1906, "XResolution" -> 400, 
         "YResolution" -> 400, "ResolutionUnit" -> "Inch", "Software" -> 
         "Created with the Wolfram Language : www.wolfram.com", "DateTime" -> 
         DateObject[{2022, 4, 5, 9, 12, 8.}, "Instant", "Gregorian", 9.], 
         "TimeZoneOffset" -> 9|>, 
       "Comments" -> <|
        "Software" -> "Created with the Wolfram Language : www.wolfram.com", 
         "Creation Time" -> 
         DateObject[{2022, 4, 5, 9, 12, 8.}, "Instant", "Gregorian", 
           None]|>|>],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->{299.91734375, Automatic},
   ImageSizeRaw->{400.14, 343.08},
   PlotRange->{{0, 400.14}, {0, 343.08}}]], "Input",ExpressionUUID->
  "43b86a40-c63d-4f8b-b8cf-31600c070d60"]
}], "Picture",
 TextAlignment->Center,
 CellID->1449455432,ExpressionUUID->"bb1c6d3d-3224-4eee-9114-2a5103609c75"],

Cell[TextData[{
 StyleBox["Figure 3",
  FontWeight->"Bold"],
 ". Geometric interpretation of the quantum search algorithm. ",
 StyleBox["(left)",
  FontWeight->"Bold"],
 " The application of the Householder reflection ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "\[Omega]"], TraditionalForm]],ExpressionUUID->
  "aea93cde-ffec-41e3-8760-89957b75c5a5"],
 " followed by Grover\[CloseCurlyQuote]s diffusion operator ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Alpha]"], TraditionalForm]],ExpressionUUID->
  "da94d248-9a99-4d01-bb04-45c685439ccc"],
 " leads to the Grover rotation, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"G", ":=", 
    RowBox[{
     SubscriptBox["V", "\[Alpha]"], 
     SubscriptBox["U", "\[Omega]"]}]}], TraditionalForm]],ExpressionUUID->
  "8e25f3b4-7d00-4eab-a373-76ded8ded3aa"],
 ", a rotation by angle ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Theta]"}], TraditionalForm]],ExpressionUUID->
  "efb0c0aa-e765-44b5-8f28-b9219f837349"],
 ", where ",
 Cell[BoxData[
  FormBox["\[Theta]", TraditionalForm]],ExpressionUUID->
  "99b6ded9-b5e5-49dd-87a1-d73af060bce0"],
 " is the angle between ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Alpha]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "336d1503-e7f1-4390-a64c-c08aa63efef6"],
 " and the horizontal axis. ",
 StyleBox["(right)",
  FontWeight->"Bold"],
 " Alternating applications of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "\[Omega]"], TraditionalForm]],ExpressionUUID->
  "3502b992-ee28-425f-80ec-5fcbe10e5204"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Alpha]"], TraditionalForm]],ExpressionUUID->
  "50ab7bdc-d7ee-4e94-ae68-cf0f06cd43cb"],
 ", or equivalently repeated applications of the Grover rotation ",
 Cell[BoxData[
  FormBox["G", TraditionalForm]],ExpressionUUID->
  "967ce2d5-0bfc-420d-9311-14912eaac038"],
 ", bring ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Alpha]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "42f12726-ed2b-4927-a899-17ef37c993c6"],
 " increasingly closer to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "4b4e52ff-83cd-4792-8199-7e6cb64f87e8"],
 "."
}], "TechNoteCaption",
 TextAlignment->Center,
 CellID->1113346130,ExpressionUUID->"87e96136-945e-414b-937b-e3709f7e9d41"],

Cell[TextData[{
 "\tAt this stage, it is convenient to define the ",
 StyleBox["Grover rotation operator",
  FontSlant->"Italic"]
}], "TechNoteText",
 CellID->1533638803,ExpressionUUID->"8195f86a-3f7d-4f19-92e1-e97cd934a429"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"G", ":=", 
    RowBox[{
     SubscriptBox["V", "\[Alpha]"], 
     SubscriptBox["U", "\[Omega]"]}]}], TraditionalForm]],ExpressionUUID->
  "a3b59c5f-b3c8-4df5-a641-bb485dd310f1"],
 " ."
}], "TechNoteText",
 CellID->1768630727,ExpressionUUID->"41f93912-1fda-4b66-b7ae-8126b2ebda90"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["G", TraditionalForm]],ExpressionUUID->
  "f416e783-d30c-44be-83d5-5e582d188533"],
 " describes a rotation within the subspace spanned by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "8896a8bd-e108-4bf9-ad9c-fbb8b2899cc4"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Alpha]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "00cb994f-bc03-45d1-b9fc-1b2a64202ae0"],
 " towards the desired state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "1b5eb858-d045-41a6-8485-538766db376a"],
 ". For a more quantitative analysis, we define the angle \[Theta] by"
}], "TechNoteText",
 CellID->2055470562,ExpressionUUID->"0c1cec4d-498c-478e-aac5-563a7c7517fd"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"sin", "(", 
     RowBox[{"\[Theta]", "/", "2"}], ")"}], ":=", 
    SqrtBox[
     FractionBox["M", "N"]]}], TraditionalForm]],ExpressionUUID->
  "4b1aac1c-f02e-40f0-ad94-70ab32e7e4f0"],
 ", \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"cos", "(", 
     RowBox[{"\[Theta]", "/", "2"}], ")"}], ":=", 
    SqrtBox[
     FractionBox[
      RowBox[{"N", "-", "M"}], "N"]]}], TraditionalForm]],ExpressionUUID->
  "9426ea35-6e44-4189-b09b-9839f7c3eb36"],
 " "
}], "TechNoteText",
 CellID->1871789892,ExpressionUUID->"6b829ae5-14aa-4b38-8d8a-3e1eef816ad1"],

Cell["and", "TechNoteText",
 CellID->684769941,ExpressionUUID->"a0cbef0e-aa8e-4b21-8f12-43a7aa08ce09"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Alpha]"},
     "Ket"], "=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"\[Omega]"},
       "Ket"], 
      RowBox[{"sin", "(", 
       RowBox[{"\[Theta]", "/", "2"}], ")"}]}], "+", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["\[Omega]", "\[Perpendicular]"]},
       "Ket"], 
      RowBox[{"cos", "(", 
       RowBox[{"\[Theta]", "/", "2"}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"1d2cd2c5-a5ec-4715-a850-fb59aecd55be"],
 " ."
}], "TechNoteText",
 CellID->563534114,ExpressionUUID->"923fc664-1636-4382-88d4-5b30fc81144a"],

Cell[TextData[{
 "It corresponds to the state rotated from ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["\[Omega]", "\[Perpendicular]"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "a7950ae4-7f3a-492a-9a29-0cb756df288d"],
 " by angle \[Theta] around the axis perpendicular to both ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "d86ff6c9-9734-4692-aef0-77aea77af657"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["\[Omega]", "\[Perpendicular]"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "7df60c65-8253-4574-8d17-b0ad05b4c099"],
 " in the Bloch space corresponding to the two-dimensional subspace spanned \
by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "8a990410-adf8-4289-99b8-0d5375c788cb"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["\[Omega]", "\[Perpendicular]"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "5727c704-d739-4aea-a6f5-4fa5b5378017"],
 ". Accordingly, ",
 Cell[BoxData[
  FormBox["G", TraditionalForm]],ExpressionUUID->
  "570aeb8f-b9d7-4bfd-8f60-f59fc3df2076"],
 " corresponds to a rotation by angle ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Theta]"}], TraditionalForm]],ExpressionUUID->
  "c4db754a-6558-40c3-bedf-367a55c4ff67"],
 " around the same axis as illustrated in ",
 ButtonBox["Figure 3",
  BaseStyle->"Link",
  ButtonData->
   "paclet:QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm#1113346130"],
 " (right). This may also be understood explicitly by considering the matrix \
representations of the Householder reflections and Grover rotation, \
respectively,  in the basis of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     TemplateBox[{"\[Omega]"},
      "Ket"], ",", 
     TemplateBox[{
       SubscriptBox["\[Omega]", "\[Perpendicular]"]},
      "Ket"]}], "}"}], TraditionalForm]],ExpressionUUID->
  "84467423-7ad6-4014-bc30-c92c8450163e"],
 ":"
}], "TechNoteText",
 CellID->914970728,ExpressionUUID->"cedcdb80-10e3-42de-80ab-acbec39d364b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["V", "\[Alpha]"], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "cos"}], "\[VeryThinSpace]", "\[Theta]"}], 
        RowBox[{"sin", "\[VeryThinSpace]", "\[Theta]"}]},
       {
        RowBox[{"sin", "\[VeryThinSpace]", "\[Theta]"}], 
        RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "91da1571-9270-4913-afb7-9fc5a8e602e6"],
 ", \t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "\[Omega]"], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", "1"}], "0"},
       {"0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "0d09eee6-2f39-4226-bf95-1739ac31f862"],
 ", \t",
 Cell[BoxData[
  FormBox[
   RowBox[{"G", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}], 
        RowBox[{"sin", "\[VeryThinSpace]", "\[Theta]"}]},
       {
        RowBox[{
         RowBox[{"-", "sin"}], "\[VeryThinSpace]", "\[Theta]"}], 
        RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "338a38a6-c106-453c-b54a-37200ca1d471"],
 " ."
}], "TechNoteText",
 CellID->1602567379,ExpressionUUID->"ac84fd7b-c39f-4558-a2b5-939796646a49"],

Cell[TextData[{
 "The ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "336cd8c1-50e0-4ed2-a05e-d746b352f0c0"],
 " repeated applications of the Grover rotation ",
 Cell[BoxData[
  FormBox["G", TraditionalForm]],ExpressionUUID->
  "02876a15-5bbd-4554-bd72-d9d1720ea6b3"],
 " give"
}], "TechNoteText",
 CellID->1668299697,ExpressionUUID->"c6c19b05-efc4-4aeb-83fe-922b795719f9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      SubscriptBox["\[Psi]", "k"]},
     "Ket"], "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["G", "k"], 
      TemplateBox[{"\[Alpha]"},
       "Ket"]}], "=", 
     RowBox[{
      RowBox[{
       TemplateBox[{"\[Omega]"},
        "Ket"], 
       RowBox[{"sin", "(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "+", 
           RowBox[{"1", "/", "2"}]}], ")"}], "\[Theta]"}], ")"}]}], "+", 
      RowBox[{
       TemplateBox[{
         SubscriptBox["\[Omega]", "\[Perpendicular]"]},
        "Ket"], 
       RowBox[{"cos", "(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k", "+", 
           RowBox[{"1", "/", "2"}]}], ")"}], "\[Theta]"}], ")"}]}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"823dd9c3-ccc7-4948-ac20-a31c852dfa74"],
 " ."
}], "TechNoteText",
 CellID->1566512247,ExpressionUUID->"5189f2f3-c429-4f72-ad75-d9b94e15e3e7"],

Cell[TextData[{
 "Starting from the overall-superposition state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Alpha]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "248d469a-32d4-4736-b93d-67c71cd140c9"],
 ", the resulting state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SubscriptBox["\[Psi]", "k"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "9cfa5272-67a1-457a-abd8-8787220bfe5d"],
 " gets closest to the desired state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "64556011-698c-4a24-9eeb-490daa80e90a"],
 " when ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"k", " ", "+", " ", 
       RowBox[{"1", "/", "2"}]}], ")"}], "\[Theta]"}], " ", "\[TildeTilde]", 
    " ", 
    RowBox[{"\[Pi]", "/", "2"}]}], TraditionalForm]],ExpressionUUID->
  "120b24e9-fc00-45d9-8ed7-7adf04cc877e"],
 ". Therefore, the optimal number ",
 Cell[BoxData[
  FormBox["K", TraditionalForm]],ExpressionUUID->
  "30c5fb1f-170b-436b-961c-02ab2abe38e7"],
 " of the Grover rotations to apply is given by"
}], "TechNoteText",
 CellID->221823109,ExpressionUUID->"ba3793f0-81b7-40da-beaf-7b27e8d215dd"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"K", "=", 
    RowBox[{"round", "(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Pi]", "/", "2"}], "\[Theta]"}], "-", 
      RowBox[{"1", "/", "2"}]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "e67ac642-866e-4ca7-b4b6-ec5c9750f53d"],
 " ."
}], "TechNoteText",
 CellID->149381771,ExpressionUUID->"5e74029e-a681-4c42-9f72-f201d304196d"],

Cell[TextData[{
 "Assuming that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", " ", "\[LessLess]", " ", "N"}], TraditionalForm]],
  ExpressionUUID->"a716b72e-c30a-4322-9a36-8e86f7ead835"],
 ", we observe that"
}], "TechNoteText",
 CellID->251041854,ExpressionUUID->"ab450af5-1671-4757-ad0c-b7802aed7fd3"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "\[TildeTilde]", 
    RowBox[{"2", 
     RowBox[{
      SuperscriptBox["sin", 
       RowBox[{"-", "1"}]], "(", 
      SqrtBox[
       RowBox[{"M", "/", "N"}]], ")"}]}], "\[TildeTilde]", 
    RowBox[{"2", 
     SqrtBox[
      RowBox[{"M", "/", "N"}]]}], "\[LessLess]", "1"}], TraditionalForm]],
  ExpressionUUID->"b7dc9d78-7562-48e2-82cd-1bbb309dbcfd"],
 " ."
}], "TechNoteText",
 CellID->1602557470,ExpressionUUID->"4c4757dc-7bf9-4639-a210-f39420a3db18"],

Cell["Then, it follows that", "TechNoteText",
 CellID->443497616,ExpressionUUID->"537518e7-3027-4aa5-b3c5-db978247043e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"K", "\[TildeTilde]", 
    RowBox[{
     FractionBox["\[Pi]", "4"], 
     SqrtBox[
      FractionBox["N", "M"]]}]}], TraditionalForm]],ExpressionUUID->
  "6ec656b4-15f8-4c92-803a-a7e74d0eafc4"],
 "."
}], "TechNoteText",
 CellID->2096177022,ExpressionUUID->"1179d03b-e7a0-413d-8a2e-7065f584bdeb"],

Cell[TextData[{
 "This means that we can find the solution by applying the Grover rotations \
",
 Cell[BoxData[
  FormBox["G", TraditionalForm]],ExpressionUUID->
  "18936acf-f6b9-48ff-b35f-84d7cb5b1e55"],
 " an order of ",
 Cell[BoxData[
  FormBox[
   SqrtBox["N"], TraditionalForm]],ExpressionUUID->
  "d88b2f66-2f01-4f98-bfc7-8ed2f1ef3c6e"],
 " times."
}], "TechNoteText",
 CellID->977979719,ExpressionUUID->"13740d39-8115-4f72-bb0e-d8783b46fedb"],

Cell["\<\
\tWe can make the estimation of the performance more rigorous and get the
upper bound. Note that\
\>", "TechNoteText",
 CellID->65303095,ExpressionUUID->"ef4fde1e-131d-4c46-a720-81f9d2a0c4a5"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]", "/", "2"}], "\[GreaterEqual]", 
     RowBox[{"sin", "(", 
      RowBox[{"\[Theta]", "/", "2"}], ")"}]}], "=", 
    SqrtBox[
     RowBox[{"M", "/", "N"}]]}], TraditionalForm]],ExpressionUUID->
  "b7ff1cc1-a5bc-4282-8df4-f3847b044488"],
 ","
}], "TechNoteText",
 CellID->184974048,ExpressionUUID->"ab7a154e-464e-4c0a-b956-c3c1996d96db"],

Cell[TextData[{
 "where we have assumed that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "\[LessEqual]", 
    RowBox[{"N", "/", "2"}]}], TraditionalForm]],ExpressionUUID->
  "1e10677e-82b9-4691-9042-0a139528b789"],
 ", and hence"
}], "TechNoteText",
 CellID->1449987527,ExpressionUUID->"df2b13da-4875-4609-a44e-ed4f8cb89c9e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"K", "\[LessEqual]", 
    RowBox[{"ceil", "(", 
     RowBox[{
      RowBox[{"\[Pi]", "/", "2"}], "\[Theta]"}], ")"}], "\[LessEqual]", 
    RowBox[{
     FractionBox["\[Pi]", "4"], 
     SqrtBox[
      FractionBox["N", "M"]]}]}], TraditionalForm]],ExpressionUUID->
  "2f79c0dd-0a6e-48e1-9792-2d45670ab78f"],
 "."
}], "TechNoteText",
 CellID->295940133,ExpressionUUID->"bca44da5-9595-4339-8a1d-06cb7056d063"],

Cell["\<\
Therefore, the above crude estimation turns out to be the worst case \
estimation.\
\>", "TechNoteText",
 CellID->293688879,ExpressionUUID->"e86054a7-cbc6-4d78-b431-17eeb64c4d38"],

Cell[TextData[{
 "\tNote that the above analysis assumes that the number ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]],ExpressionUUID->
  "caef55fc-70eb-4047-8dff-5099711a6340"],
 " of solutions is known. Fortunately, on quantum computers, it is possible \
to find ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]],ExpressionUUID->
  "ddfcb31f-df1e-44b8-a917-43a5da5882ae"],
 " efficiently by combining the ",
 StyleBox["Grover rotation",
  FontSlant->"Italic"],
 " and ",
 ButtonBox["quantum phase estimation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/QuantumPhaseEstimation"],
 ". This procedure is often called the ",
 StyleBox["quantum counting",
  FontSlant->"Italic"],
 " or ",
 StyleBox["quantum amplitude estimation",
  FontSlant->"Italic"],
 " (Brassard ",
 StyleBox["et al",
  FontSlant->"Italic"],
 "., 2002)."
}], "TechNoteText",
 CellID->1132582699,ExpressionUUID->"6bb91f12-7054-4696-8181-a4af71741ffa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum Implementation", "TechNoteSection",
 CellID->1111568547,ExpressionUUID->"7f74b528-4142-44d4-b81e-385778105137"],

Cell[TextData[{
 "In the above, we have described the quantum search algorithm in terms of \
the Grover rotation consisting of the Householder reflection ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "\[Omega]"], TraditionalForm]],ExpressionUUID->
  "654e7bb1-ff48-4b91-8464-36d2cabde207"],
 " and Grover\[CloseCurlyQuote]s diffusion operator ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Alpha]"], TraditionalForm]],ExpressionUUID->
  "51d01185-d465-4a21-9a42-a0b358fa0770"],
 ". ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Alpha]"], TraditionalForm]],ExpressionUUID->
  "bb8acdd6-c440-45d4-b5d4-c21919ca7ffb"],
 " can be implemented in terms of elementary gates because the state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Alpha]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "134a4156-c98b-439b-9704-57315769fc35"],
 " is known. However, ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Omega]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "2c99789e-4d5b-457b-9cf1-72ae1d292c79"],
 " is unknown, and one cannot implement ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "\[Omega]"], TraditionalForm]],ExpressionUUID->
  "70942e5a-aa3d-47d6-a755-e30ad5e66cd3"],
 " in a similar way."
}], "TechNoteText",
 CellID->1172324176,ExpressionUUID->"2e380898-b420-4b8a-8c8e-90d906a036fe"],

Cell[TextData[{
 "\tFortunately, we have noted above that the effect of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "\[Omega]"], TraditionalForm]],ExpressionUUID->
  "db6c71cb-ca3d-4f2e-afc3-51d187e72ed6"],
 " is flagging the states ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"x"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "b788e543-ccd3-4171-bbae-c795a157e697"],
 " corresponding to the solutions with the reversed phase factor \[Minus]1. \
One can achieve exactly the same effect by employing the ",
 ButtonBox["quantum oracle",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/QuantumOracle"],
 "  corresponding to the classical oracle ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", 
    RowBox[{"(", "x", ")"}]}], TraditionalForm]],ExpressionUUID->
  "d4c6a4e0-844c-4258-a085-c84ed995fa38"],
 ". In particular, with the ancillary qubit prepared in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"-"},
     "Ket"], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "-", 
       TemplateBox[{"1"},
        "Ket"]}], ")"}], "/", 
     SqrtBox["2"]}]}], TraditionalForm]],ExpressionUUID->
  "d4f40004-af96-43f6-937f-35f094f16872"],
 ", the ",
 ButtonBox["quantum oracle",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/tutorial/QuantumOracle"],
 " induces a conditional phase shift as follows"
}], "TechNoteText",
 CellID->348391527,ExpressionUUID->"7823c88b-0882-49e9-a472-c3817f1c9c48"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"-"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     RowBox[{"(", 
      SuperscriptBox[
       RowBox[{
        TemplateBox[{"x"},
         "Ket"], "(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"f", "(", "x", ")"}]], ")"}], "\[CircleTimes]", 
     TemplateBox[{"-"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "d3ef4803-51c8-4d4d-9ae1-579db5a3ded8"],
 " ."
}], "TechNoteText",
 CellID->89964807,ExpressionUUID->"0f6bb461-07de-4e55-b805-baebd6af83a6"],

Cell["\<\
\tIn quantum circuit model, the identity is expressed as follows\
\>", "TechNoteText",
 CellID->210023761,ExpressionUUID->"f416a841-6900-4ad3-9178-447c538486c0"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[$Failed, {{0, 153.}, {635., 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->144.],
   BoxForm`ImageTag[
   "Byte", ColorSpace -> "RGB", Interleaving -> True, Magnification -> 
    Automatic],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->{446.32421875, Automatic},
  ImageSizeRaw->{635., 153.},
  PlotRange->{{0, 635.}, {0, 153.}}]], "TechNoteText",
 TextAlignment->"Center",
 CellID->1553719106,ExpressionUUID->"5125f37b-933b-4c2f-9345-58cc06b342d8"],

Cell[TextData[{
 "The overall quantum circuit to implement the Grover rotation is given in ",
 ButtonBox["Figure 4",
  BaseStyle->"Link",
  ButtonData->
   "paclet:QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm#1783078446"],
 " below."
}], "TechNoteText",
 CellID->2103350669,ExpressionUUID->"64379e1f-bb1d-445c-ada0-1054b9d6e9b2"],

Cell[TextData[Cell[BoxData[
 GraphicsBox[{
   {Dashing[{Small, Small}], LineBox[{}]}, 
   LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
    0, -4}, {8, -4}}, {{0, -5}, {8, -5}}}], InsetBox[
    FormBox[
     StyleBox[
      GraphicsBox[
       {Thickness[0.03584229390681004], 
        FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
         3}, {1, 3, 3}}}, {{{3.8484399999999988`, 3.6125000000000003`}, {
         3.8484399999999988`, 20.345299999999998`}, {3.8484399999999988`, 
         20.595299999999998`}, {3.8484399999999988`, 20.935900000000004`}, {
         3.4906299999999995`, 20.935900000000004`}, {3.1312499999999996`, 
         20.935900000000004`}, {3.1312499999999996`, 20.595299999999998`}, {
         3.1312499999999996`, 20.345299999999998`}, {3.1312499999999996`, 
         3.6125000000000003`}, {3.1312499999999996`, 3.3609399999999994`}, {
         3.1312499999999996`, 3.02188}, {3.4906299999999995`, 3.02188}, {
         3.8484399999999988`, 3.02188}, {3.8484399999999988`, 
         3.3609399999999994`}, {3.8484399999999988`, 3.6125000000000003`}}}], 
        FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
         0}, {1, 3, 3}}}, {{{18.4328, 11.9781}, {18.4328, 
         12.337499999999997`}, {18.092200000000002`, 12.337499999999997`}, {
         17.842200000000002`, 12.337499999999997`}, {8.07813, 
         12.337499999999997`}, {7.82656, 12.337499999999997`}, {
         7.487499999999997, 12.337499999999997`}, {7.487499999999997, 
         11.9781}, {7.487499999999997, 11.6203}, {7.82656, 11.6203}, {8.07813,
          11.6203}, {17.842200000000002`, 11.6203}, {18.092200000000002`, 
         11.6203}, {18.4328, 11.6203}, {18.4328, 11.9781}}}], 
        FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
         3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
         0}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYC4m6vVywmDy0cMvM/tJ78ou7QBeVnQPkw+VfF
W0V/a2s4bDH/cSjllIVD9acNAdmzNBxSYu+4Ma8wdVB70jzvbJeJg8y8OM3T
E0wd/nwrfTDnoImDiTEQNJs6TAguUZn+3sThYNvy8FNOCH7Bmu7bGQIIfiPL
0X7D5yYOaSBwDMH3uzgx5t9kE4cGKN8XyofJ8/ivn5JaYeIQKb79IsM/E4ce
kLsdTRxuSdckGqki/AeTty1xrD09hxeuPx1k3zNuOF/jk8rLWZy4+dd5b4ul
lnHC3f+y9nH2eR0OuP9g/FOHndZm1iH4sPCB6QeHz2JTuPmw8D2xa0cvWwAi
/MHm7EPwM9HiB8YHALCtzXE=
         "]]},
       AspectRatio->Automatic,
       AxesStyle->Automatic,
       BaselinePosition->Scaled[0.3169518292168768],
       FrameStyle->Automatic,
       ImageSize->{27.89547198007472, 23.511820672478205`},
       PlotRange->{{0., 27.9}, {0., 23.51}},
       PlotRangePadding->Scaled[0.025]],
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"],
     TraditionalForm], {-0.1, -5}, NCache[
    ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], {
    LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -5}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], 
     FilledCurveBox[{
      BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
         0.6, -0.47439999999999993`}, {0.6, -1}}], 
       Line[{{0.6, -1}, {0.6, -4}}], 
       BezierCurve[{{0.6, -4.5256}, {1.4, -4.5256}, {1.4, -4}}]}]}, InsetBox[
     StyleBox["\<\"f(x)\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.045000000000000005`],
      FontWeight->"Light",
      FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]], {CircleBox[{1, -5}, 0.26666666666666666], 
     LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
        1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, 
   {Dashing[{0, Small}], 
    LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
       2, -5.5}, {2, -0.5}}]]}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
     LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
      2.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
     LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
      2.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
     LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
      2.6, -3.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
     LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
      2.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}, {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
    LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
     3.6, -4.4}}], InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {4, -4}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {
    LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}}], 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -1}, 0.09]}, 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -2}, 0.09]}, 
    {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -3}, 0.09]}, 
    {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
    LineBox[{{4.6, -4.4}, {5.4, -4.4}, {5.4, -3.6}, {4.6, -3.6}, {
     4.6, -4.4}}], InsetBox[
     StyleBox["\<\"Z\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {5, -4}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {
    {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, 
    LineBox[{{5.6, -4.4}, {6.4, -4.4}, {6.4, -3.6}, {5.6, -3.6}, {
     5.6, -4.4}}], InsetBox[
     StyleBox["\<\"X\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.05],
      FontWeight->"Light",
      FontSlant->Italic], {6, -4}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
      ImageScaled[{0.5, 0.5}]]]}, {{
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, 
     LineBox[{{6.6, -1.4}, {7.4, -1.4}, {7.4, -0.6}, {6.6, -0.6}, {
      6.6, -1.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, 
     LineBox[{{6.6, -2.4}, {7.4, -2.4}, {7.4, -1.6}, {6.6, -1.6}, {
      6.6, -2.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -2}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, 
     LineBox[{{6.6, -3.4}, {7.4, -3.4}, {7.4, -2.6}, {6.6, -2.6}, {
      6.6, -3.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -3}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
     LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
      6.6, -4.4}}], InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}}, InsetBox[
    FormBox[
     StyleBox[
      GraphicsBox[
       {Thickness[0.03584229390681004], 
        FilledCurveBox[{{{0, 2, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
         3}, {1, 3, 3}}}, {{{3.8484399999999988`, 3.6125000000000003`}, {
         3.8484399999999988`, 20.345299999999998`}, {3.8484399999999988`, 
         20.595299999999998`}, {3.8484399999999988`, 20.935900000000004`}, {
         3.4906299999999995`, 20.935900000000004`}, {3.1312499999999996`, 
         20.935900000000004`}, {3.1312499999999996`, 20.595299999999998`}, {
         3.1312499999999996`, 20.345299999999998`}, {3.1312499999999996`, 
         3.6125000000000003`}, {3.1312499999999996`, 3.3609399999999994`}, {
         3.1312499999999996`, 3.02188}, {3.4906299999999995`, 3.02188}, {
         3.8484399999999988`, 3.02188}, {3.8484399999999988`, 
         3.3609399999999994`}, {3.8484399999999988`, 3.6125000000000003`}}}], 
        FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
         0}, {1, 3, 3}}}, {{{18.4328, 11.9781}, {18.4328, 
         12.337499999999997`}, {18.092200000000002`, 12.337499999999997`}, {
         17.842200000000002`, 12.337499999999997`}, {8.07813, 
         12.337499999999997`}, {7.82656, 12.337499999999997`}, {
         7.487499999999997, 12.337499999999997`}, {7.487499999999997, 
         11.9781}, {7.487499999999997, 11.6203}, {7.82656, 11.6203}, {8.07813,
          11.6203}, {17.842200000000002`, 11.6203}, {18.092200000000002`, 
         11.6203}, {18.4328, 11.6203}, {18.4328, 11.9781}}}], 
        FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
         3}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 
         0}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJZIGYC4m6vVywmDy0cMvM/tJ78ou7QBeVnQPkw+VfF
W0V/a2s4bDH/cSjllIVD9acNAdmzNBxSYu+4Ma8wdVB70jzvbJeJg8y8OM3T
E0wd/nwrfTDnoImDiTEQNJs6TAguUZn+3sThYNvy8FNOCH7Bmu7bGQIIfiPL
0X7D5yYOaSBwDMH3uzgx5t9kE4cGKN8XyofJ8/ivn5JaYeIQKb79IsM/E4ce
kLsdTRxuSdckGqki/AeTty1xrD09hxeuPx1k3zNuOF/jk8rLWZy4+dd5b4ul
lnHC3f+y9nH2eR0OuP9g/FOHndZm1iH4sPCB6QeHz2JTuPmw8D2xa0cvWwAi
/MHm7EPwM9HiB8YHALCtzXE=
         "]]},
       AspectRatio->Automatic,
       AxesStyle->Automatic,
       BaselinePosition->Scaled[0.3169518292168768],
       FrameStyle->Automatic,
       ImageSize->{27.89547198007472, 23.511820672478205`},
       PlotRange->{{0., 27.9}, {0., 23.51}},
       PlotRangePadding->Scaled[0.025]],
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light"],
     TraditionalForm], {8.1, -5}, NCache[
    ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]},
  AxesStyle->Automatic,
  FrameStyle->Automatic,
  ImagePadding->{{28.8, 28.8}, {1, 1}},
  ImageSize->345.59999999999997`,
  PlotRange->NCache[{Full, {
      Rational[-11, 2], 
      Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
  PlotRangePadding->Scaled[
   0.025]]],ExpressionUUID->"a0f0ab88-b8bc-4069-885d-d41a72d0e9b9"]], \
"Picture",
 TextAlignment->Center,
 CellID->690721683,ExpressionUUID->"edbc7d3e-db50-4b03-b3ec-00a1707e10c3"],

Cell[TextData[{
 StyleBox["Figure 4",
  FontWeight->"Bold"],
 ". A quantum circuit for the Grover rotation. The first part before the \
vertical dashed line effectively implements the Householder transformation ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "\[Omega]"], TraditionalForm]],ExpressionUUID->
  "480fcbf2-0f9f-41f5-a62b-87e091bfb9a0"],
 ". The second part corresponds to Grover\[CloseCurlyQuote]s diffusion \
operator ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Alpha]"], TraditionalForm]],ExpressionUUID->
  "dbde016d-3697-4c53-9957-a9143587c3f9"],
 "."
}], "TechNoteCaption",
 TextAlignment->Center,
 CellID->1783078446,ExpressionUUID->"0b8a613a-1b68-4f3b-a6cf-fec872b49b37"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "TechNoteSection",
 CellID->1481138763,ExpressionUUID->"e8df3226-514d-4f86-9f0c-50e74e9ef11a"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[50]:=",
 CellID->371295434,ExpressionUUID->"2d17dc94-e977-4a26-bd3a-be21b66fa40a"],

Cell["Let us demonstrate the quantum search algorithm. ", "TechNoteText",
 CellID->994254636,ExpressionUUID->"91075e6b-8967-4d82-9553-14f4bb0dd627"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S", ",", "T"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[2]:=",
 CellID->1644652659,ExpressionUUID->"cd9b21ce-138c-4154-8852-c8a32c6f99df"],

Cell["\<\
We work with 4 (system) qubits and one ancillary qubit. The ancillary qubit \
is for the quantum oracle.\
\>", "TechNoteMathCaption",
 CellID->663476370,ExpressionUUID->"d563a9c7-dcde-42f6-9ca5-9c825cf22a34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"$n", "-", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", "$n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[4]:=",
 CellID->215354860,ExpressionUUID->"cd2ae2ee-cff2-4c72-9621-e554d111f4bf"],

Cell["\<\
Here, we specify a classical oracle in a more human readable way.\
\>", "TechNoteMathCaption",
 CellID->1204678952,ExpressionUUID->"2ec002f0-b981-4c91-81dd-045f4b6278ab"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "f", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "3", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "_Integer", "]"}], "=", "0"}], ";"}]}], "Input",
 CellLabel->"In[13]:=",
 CellID->867337255,ExpressionUUID->"ff07ae89-ef29-4e7e-83b4-7dfbe3cd0d63"],

Cell[TextData[{
 "The ancilla qubit is prepared in the eigenstate of Pauli X operator \
belonging to eigenvalue ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "1"}], TraditionalForm]],ExpressionUUID->
  "7a5daf25-c996-4e06-89e4-f57e6a720a10"],
 "."
}], "TechNoteMathCaption",
 CellID->489040982,ExpressionUUID->"8387b886-03fc-4e46-9061-07c8854fe7a3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"ProductState", "[", 
    RowBox[{"T", "->", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "Elaborate"}]}], "Input",
 CellLabel->"In[16]:=",
 CellID->275964604,ExpressionUUID->"13addeba-ede8-4c4c-8019-c3ad3a69b11a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["0", 
         InterpretationBox["T", 
          $CellContext`T[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`T[Q3`$] -> 0|>]], 
   SqrtBox["2"]], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{
        SubscriptBox["1", 
         InterpretationBox["T", 
          $CellContext`T[Q3`$]]]}, "RowDefault"]},
     "Ket"],
    Ket[<|$CellContext`T[Q3`$] -> 1|>]], 
   SqrtBox["2"]]}]], "Output",
 CellLabel->"Out[17]=",
 CellID->666686370,ExpressionUUID->"536f6368-629f-4c29-913c-5b77b400b2c9"]
}, Open  ]],

Cell["Construct a quantum circuit for the Grover rotation.", \
"TechNoteMathCaption",
 CellID->1882657478,ExpressionUUID->"7f737874-02ed-4390-9661-f897ffca9f9e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"grv", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Oracle", "[", 
     RowBox[{"f", ",", 
      RowBox[{"S", "[", "kk", "]"}], ",", "T"}], "]"}], 
    ",", "\"\<Separator\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"kk", ",", "6"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"$n", ",", "1"}], "]"}], ",", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "cc", "]"}], "->", "0"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"tt", ",", "3"}], "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"$n", ",", "1"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"kk", ",", "6"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0.2"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[19]:=",
 CellID->254452149,ExpressionUUID->"4940a69e-c419-41b9-a3a7-6b21676518f4"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
     0, -4}, {8, -4}}, {{0, -5}, {8, -5}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -5}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
          0.6, -0.47439999999999993`}, {0.6, -1}}], 
        Line[{{0.6, -1}, {0.6, -4}}], 
        BezierCurve[{{0.6, -4.5256}, {1.4, -4.5256}, {1.4, -4}}]}]}, 
     InsetBox[
      StyleBox["\<\"f(x)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.045000000000000005`],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
        2, -5.5}, {2, -0.5}}]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
      LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
       2.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
      LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
       2.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
      LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
       2.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
      LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
       2.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
     LineBox[{{4.6, -4.4}, {5.4, -4.4}, {5.4, -3.6}, {4.6, -3.6}, {
      4.6, -4.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, 
     LineBox[{{5.6, -4.4}, {6.4, -4.4}, {6.4, -3.6}, {5.6, -3.6}, {
      5.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, 
      LineBox[{{6.6, -1.4}, {7.4, -1.4}, {7.4, -0.6}, {6.6, -0.6}, {
       6.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, 
      LineBox[{{6.6, -2.4}, {7.4, -2.4}, {7.4, -1.6}, {6.6, -1.6}, {
       6.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, 
      LineBox[{{6.6, -3.4}, {7.4, -3.4}, {7.4, -2.6}, {6.6, -2.6}, {
       6.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
      LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
       6.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{18., 7.2}, {1, 1}},
   ImageSize->313.2,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`Oracle[$CellContext`f, {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, {
     $CellContext`T[Q3`$]}], "Separator", {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, 
   $CellContext`S[4, 1], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {0, 0, 0}, 
    $CellContext`S[4, 3]], 
   $CellContext`S[4, 1], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, "PortSize" -> {0.5, 0.2}]]], "Output",
 CellLabel->"Out[19]=",
 CellID->348266070,ExpressionUUID->"3e6309d7-b706-4b51-9bcb-2821a73a009d"]
}, Open  ]],

Cell["Apply the Grover rotation on the input state.", "TechNoteMathCaption",
 CellID->32473192,ExpressionUUID->"3ec10202-0a39-4c01-93d4-e5f09d7265e3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{"S", "[", "kk", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"in", ",", 
      RowBox[{"\"\<Label\>\"", 
       "->", "\"\<\!\(\*TemplateBox[{\"-\"},\"Ket\"]\)\>\""}]}], "}"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"kk", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "grv"}], 
   "]"}]}]], "Input",
 CellLabel->"In[20]:=",
 CellID->1257594333,ExpressionUUID->"70003d2c-d9b1-4e2e-9ad4-7a6d0ea20bbd"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}, {{0, -3}, {10, -3}}, {{
     0, -4}, {10, -4}}, {{0, -5}, {10, -5}}}], {{InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -1}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -2}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -3}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.03200000000000001],
        FontWeight->"Light"], {-0.1, -4}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*TemplateBox[{\\\"-\\\"},\\\"Ket\\\"]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03200000000000001],
       FontWeight->"Light"], {-0.1, -5}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, 
      LineBox[{{0.6, -1.4}, {1.4, -1.4}, {1.4, -0.6}, {0.6, -0.6}, {
       0.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, 
      LineBox[{{0.6, -2.4}, {1.4, -2.4}, {1.4, -1.6}, {0.6, -1.6}, {
       0.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, 
      LineBox[{{0.6, -3.4}, {1.4, -3.4}, {1.4, -2.6}, {0.6, -2.6}, {
       0.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {1, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{0.6, -4.4}, {1.4, -3.6}]}, 
      LineBox[{{0.6, -4.4}, {1.4, -4.4}, {1.4, -3.6}, {0.6, -3.6}, {
       0.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {1, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
        2, -5.5}, {2, -0.5}}]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}, {3, -4}, {3, -5}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{3.4, -1}, {3.4, -0.47439999999999993`}, {
          2.6, -0.47439999999999993`}, {2.6, -1}}], 
        Line[{{2.6, -1}, {2.6, -4}}], 
        BezierCurve[{{2.6, -4.5256}, {3.4, -4.5256}, {3.4, -4}}]}]}, 
     InsetBox[
      StyleBox["\<\"f(x)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03600000000000001],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{3, Rational[-5, 2]}, {3, -2.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], {CircleBox[{3, -5}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -5}, {3.2666666666666666`, -5}}, {{
         3, -5.266666666666667}, {3, -4.733333333333333}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{4, Rational[-11, 2]}, {4, Rational[-1, 2]}}, {{
        4, -5.5}, {4, -0.5}}]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
      LineBox[{{4.6, -1.4}, {5.4, -1.4}, {5.4, -0.6}, {4.6, -0.6}, {
       4.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {5, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
      LineBox[{{4.6, -2.4}, {5.4, -2.4}, {5.4, -1.6}, {4.6, -1.6}, {
       4.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {5, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, 
      LineBox[{{4.6, -3.4}, {5.4, -3.4}, {5.4, -2.6}, {4.6, -2.6}, {
       4.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {5, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
      LineBox[{{4.6, -4.4}, {5.4, -4.4}, {5.4, -3.6}, {4.6, -3.6}, {
       4.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {5, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, 
     LineBox[{{5.6, -4.4}, {6.4, -4.4}, {6.4, -3.6}, {5.6, -3.6}, {
      5.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {6, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{7, -1}, {7, -2}, {7, -3}, {7, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{7, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{7, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{7, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
     LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
      6.6, -4.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, 
     LineBox[{{7.6, -4.4}, {8.4, -4.4}, {8.4, -3.6}, {7.6, -3.6}, {
      7.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {8, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, 
      LineBox[{{8.6, -1.4}, {9.4, -1.4}, {9.4, -0.6}, {8.6, -0.6}, {
       8.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {9, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, 
      LineBox[{{8.6, -2.4}, {9.4, -2.4}, {9.4, -1.6}, {8.6, -1.6}, {
       8.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {9, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, 
      LineBox[{{8.6, -3.4}, {9.4, -3.4}, {9.4, -2.6}, {8.6, -2.6}, {
       8.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {9, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, 
      LineBox[{{8.6, -4.4}, {9.4, -4.4}, {9.4, -3.6}, {8.6, -3.6}, {
       8.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.04000000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {9, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{18., 7.2}, {1, 1}},
   ImageSize->385.2,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>], {
     Q3`ProductState[<|$CellContext`T[Q3`$] -> {
        2^Rational[-1, 2], -2^Rational[-1, 2]}|>], "Label" -> 
     "\!\(\*TemplateBox[{\"-\"},\"Ket\"]\)"}], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, "Separator", 
   Q3`Oracle[$CellContext`f, {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, {
     $CellContext`T[Q3`$]}], "Separator", {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, 
   $CellContext`S[4, 1], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {0, 0, 0}, 
    $CellContext`S[4, 3]], 
   $CellContext`S[4, 1], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, "PortSize" -> {0.5, 0.2}]]], "Output",
 CellLabel->"Out[20]=",
 CellID->1037271865,ExpressionUUID->"7eac019f-5907-4a5a-ac3a-819a8d81b220"]
}, Open  ]],

Cell["Here is the resulting output state.", "TechNoteMathCaption",
 CellID->1021716225,ExpressionUUID->"695b7853-6855-42aa-b5dd-8587c4cf38f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{"out1", "=", 
   RowBox[{"Elaborate", "[", "qc1", "]"}]}], "]"}]], "Input",
 CellLabel->"In[21]:=",
 CellID->1161547237,ExpressionUUID->"95c44b44-dee8-4c10-925b-4382d3568049"],

Cell[BoxData["1.185898`"], "EchoTiming",
 CellID->1838562799,ExpressionUUID->"f2086b3d-690f-4dcf-996f-96f0df68451b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"3", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], 
            $CellContext`S[1, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], 
            $CellContext`S[2, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], 
            $CellContext`S[3, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox[
            SubscriptBox[
             TemplateBox[{"S"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], 
            $CellContext`S[4, Q3`$]]], 
          SubscriptBox["0", 
           InterpretationBox["T", 
            $CellContext`T[Q3`$]]]}, "RowDefault"]},
       "Ket"],
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
        0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
        0, $CellContext`T[Q3`$] -> 0|>]]}], 
    RowBox[{"16", " ", 
     SqrtBox["2"]}]]}], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"11", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"11", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       0, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["0", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 0|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], 
           $CellContext`S[1, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], 
           $CellContext`S[2, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], 
           $CellContext`S[3, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"S"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], 
           $CellContext`S[4, Q3`$]]], 
         SubscriptBox["1", 
          InterpretationBox["T", 
           $CellContext`T[Q3`$]]]}, "RowDefault"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
       1, $CellContext`T[Q3`$] -> 1|>]]}], 
   RowBox[{"16", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[21]=",
 CellID->245236435,ExpressionUUID->"c9f2b435-0a84-4c56-a611-a106c4e2e285"]
}, Open  ]],

Cell["\<\
To analyze the result, we take the partial trace over the ancillary qubit. \
Note that the result is a density matrix.\
\>", "TechNoteMathCaption",
 CellID->2003803216,ExpressionUUID->"9517274f-bcfa-4ad3-9ff2-1e9d2ef51ac5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"PartialTrace", "[", 
     RowBox[{"out4", ",", "T"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[22]:=",
 CellID->528506718,ExpressionUUID->"4083873d-bb56-4744-a204-b45960240623"],

Cell["\<\
The diagonal elements of the density matrix are the probability in the \
computational basis.\
\>", "TechNoteMathCaption",
 CellID->386816352,ExpressionUUID->"48e0108e-6e4e-406b-ab0c-b178d6eeb420"],

Cell[BoxData[
 RowBox[{
  RowBox[{"prb", "=", 
   RowBox[{"Diagonal", "[", "new", "]"}]}], ";"}]], "Input",
 CellLabel->"In[24]:=",
 CellID->1776881829,ExpressionUUID->"a71df679-01e8-4173-846e-a5cd580fa39b"],

Cell["\<\
Observe how the amplitude corresponding to the desired item has been enhanced.\
\>", "TechNoteText",
 CellID->1988772383,ExpressionUUID->"a7bbe96c-3131-4776-941d-9ff463e6c066"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"prb", "=", 
   RowBox[{"Diagonal", "@", 
    RowBox[{"Matrix", "[", 
     RowBox[{
      RowBox[{"PartialTrace", "[", 
       RowBox[{"out1", ",", "T"}], "]"}], ",", 
      RowBox[{"S", "@", "kk"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"prb", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"2", ",", "$n"}], "]"}], "-", "1"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"PlotMarkers", "->", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", "Medium"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<item number\>\"", ",", "\"\<probability\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellLabel->"In[27]:=",
 CellID->228651475,ExpressionUUID->"b709d0f4-5dca-4b3b-bae6-4494a2b29ca8"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], Thickness[Large], 
      LineBox[{{0., 0.03515625}, {1., 0.03515625}, {2., 0.03515625}, {3., 
       0.47265625}, {4., 0.03515625}, {5., 0.03515625}, {6., 0.03515625}, {7.,
        0.03515625}, {8., 0.03515625}, {9., 0.03515625}, {10., 0.03515625}, {
       11., 0.03515625}, {12., 0.03515625}, {13., 0.03515625}, {14., 
       0.03515625}, {15., 0.03515625}}]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], Thickness[Large], 
     GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[
          {EdgeForm[None], DiskBox[{0, 0}]},
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->Large,
          PlotRangePadding->Scaled[0.025]],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6], 
           Thickness[Large]]}],
        TraditionalForm], {0., 0.}, Automatic, Offset[10]], {{{0., 
      0.03515625}}, {{1., 0.03515625}}, {{2., 0.03515625}}, {{3., 
      0.47265625}}, {{4., 0.03515625}}, {{5., 0.03515625}}, {{6., 
      0.03515625}}, {{7., 0.03515625}}, {{8., 0.03515625}}, {{9., 
      0.03515625}}, {{10., 0.03515625}}, {{11., 0.03515625}}, {{12., 
      0.03515625}}, {{13., 0.03515625}}, {{14., 0.03515625}}, {{15., 
      0.03515625}}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Large,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"probability\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"item number\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
    "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 15.}, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[28]=",
 CellID->789954813,ExpressionUUID->"5e2f6185-7984-4b4a-bc46-6112adafd5d7"]
}, Open  ]],

Cell["Apply the Grover rotation again on the above output state.", \
"TechNoteMathCaption",
 CellID->484486733,ExpressionUUID->"14e27e6f-21c0-4c6c-90e6-1e7ed32bded4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out1", ",", 
      RowBox[{"\"\<Label\>\"", 
       "->", "\"\<\!\(\*TemplateBox[{\"\[Psi]\"},\"Ket\"]\)\>\""}]}], "}"}], ",",
     "grv"}], "]"}]}]], "Input",
 CellLabel->"In[29]:=",
 CellID->1744020104,ExpressionUUID->"1cc7e0f2-91c7-4053-9c76-4e476e55b367"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
     0, -4}, {8, -4}}, {{0, -5}, {
     8, -5}}}], {{
      BSplineCurveBox[{{-0.225, -3.}, {-0.1625, -2.96875}, {-0.1625, \
-2.9375}, {-0.1625, -1.0625}, {-0.1625, -1.03125}, {-0.1, -1.}}], 
      BSplineCurveBox[{{-0.225, -3.}, {-0.1625, -3.03125}, {-0.1625, \
-3.0625}, {-0.1625, -4.9375}, {-0.1625, -4.96875}, {-0.1, -5.}}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*TemplateBox[{\\\"\[Psi]\\\"},\\\"Ket\\\"]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light"], {-0.325, -3.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -5}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
          0.6, -0.47439999999999993`}, {0.6, -1}}], 
        Line[{{0.6, -1}, {0.6, -4}}], 
        BezierCurve[{{0.6, -4.5256}, {1.4, -4.5256}, {1.4, -4}}]}]}, 
     InsetBox[
      StyleBox["\<\"f(x)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.045000000000000005`],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
        2, -5.5}, {2, -0.5}}]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
      LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
       2.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
      LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
       2.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
      LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
       2.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
      LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
       2.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
     LineBox[{{4.6, -4.4}, {5.4, -4.4}, {5.4, -3.6}, {4.6, -3.6}, {
      4.6, -4.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, 
     LineBox[{{5.6, -4.4}, {6.4, -4.4}, {6.4, -3.6}, {5.6, -3.6}, {
      5.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, 
      LineBox[{{6.6, -1.4}, {7.4, -1.4}, {7.4, -0.6}, {6.6, -0.6}, {
       6.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, 
      LineBox[{{6.6, -2.4}, {7.4, -2.4}, {7.4, -1.6}, {6.6, -1.6}, {
       6.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, 
      LineBox[{{6.6, -3.4}, {7.4, -3.4}, {7.4, -2.6}, {6.6, -2.6}, {
       6.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
      LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
       6.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{18., 7.2}, {1, 1}},
   ImageSize->313.2,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[{(Rational[-3, 16] 2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[-11, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[11, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[-3, 16] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[3, 16] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>], "Label" -> 
     "\!\(\*TemplateBox[{\"\[Psi]\"},\"Ket\"]\)"}], 
   Q3`Oracle[$CellContext`f, {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, {
     $CellContext`T[Q3`$]}], "Separator", {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, 
   $CellContext`S[4, 1], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {0, 0, 0}, 
    $CellContext`S[4, 3]], 
   $CellContext`S[4, 1], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, "PortSize" -> {0.5, 0.2}]]], "Output",
 CellLabel->"Out[29]=",
 CellID->107519884,ExpressionUUID->"da510cea-6d79-467a-bd30-f054641773ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"out2", "=", 
    RowBox[{"Elaborate", "[", "qc2", "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prb", "=", 
   RowBox[{"Diagonal", "@", 
    RowBox[{"Matrix", "[", 
     RowBox[{
      RowBox[{"PartialTrace", "[", 
       RowBox[{"out2", ",", "T"}], "]"}], ",", 
      RowBox[{"S", "@", "kk"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"prb", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"2", ",", "$n"}], "]"}], "-", "1"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"PlotMarkers", "->", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", "Medium"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<item number\>\"", ",", "\"\<probability\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellLabel->"In[30]:=",
 CellID->1156473617,ExpressionUUID->"0693b909-469d-45ae-8314-0878ce627a9b"],

Cell[BoxData["1.150831`"], "EchoTiming",
 CellID->155579424,ExpressionUUID->"aaf1deff-7483-47b3-83a7-8aca0507cd09"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], Thickness[Large], 
      LineBox[{{0., 0.006103515625}, {1., 0.006103515625}, {2., 
       0.006103515625}, {3., 0.908447265625}, {4., 0.006103515625}, {5., 
       0.006103515625}, {6., 0.006103515625}, {7., 0.006103515625}, {8., 
       0.006103515625}, {9., 0.006103515625}, {10., 0.006103515625}, {11., 
       0.006103515625}, {12., 0.006103515625}, {13., 0.006103515625}, {14., 
       0.006103515625}, {15., 0.006103515625}}]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], Thickness[Large], 
     GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[
          {EdgeForm[None], DiskBox[{0, 0}]},
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->Large,
          PlotRangePadding->Scaled[0.025]],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6], 
           Thickness[Large]]}],
        TraditionalForm], {0., 0.}, Automatic, Offset[10]], {{{0., 
      0.006103515625}}, {{1., 0.006103515625}}, {{2., 0.006103515625}}, {{3., 
      0.908447265625}}, {{4., 0.006103515625}}, {{5., 0.006103515625}}, {{6., 
      0.006103515625}}, {{7., 0.006103515625}}, {{8., 0.006103515625}}, {{9., 
      0.006103515625}}, {{10., 0.006103515625}}, {{11., 0.006103515625}}, {{
      12., 0.006103515625}}, {{13., 0.006103515625}}, {{14., 
      0.006103515625}}, {{15., 0.006103515625}}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Large,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"probability\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"item number\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
    "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 15.}, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[32]=",
 CellID->673338845,ExpressionUUID->"4d9ffeec-2ea0-4651-859b-fec7db403ca5"]
}, Open  ]],

Cell["Repeat the same procedure.", "TechNoteMathCaption",
 CellID->1752880784,ExpressionUUID->"3f25da86-7d2c-4ded-8b41-aeb61321b929"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc3", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out2", ",", 
      RowBox[{"\"\<Label\>\"", 
       "->", "\"\<\!\(\*TemplateBox[{\"\[Psi]\"},\"Ket\"]\)\>\""}]}], "}"}], ",",
     "grv"}], "]"}]}]], "Input",
 CellLabel->"In[33]:=",
 CellID->942757313,ExpressionUUID->"451f6609-43e4-4d61-bf58-49bd1be8a7d5"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
     0, -4}, {8, -4}}, {{0, -5}, {
     8, -5}}}], {{
      BSplineCurveBox[{{-0.225, -3.}, {-0.1625, -2.96875}, {-0.1625, \
-2.9375}, {-0.1625, -1.0625}, {-0.1625, -1.03125}, {-0.1, -1.}}], 
      BSplineCurveBox[{{-0.225, -3.}, {-0.1625, -3.03125}, {-0.1625, \
-3.0625}, {-0.1625, -4.9375}, {-0.1625, -4.96875}, {-0.1, -5.}}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*TemplateBox[{\\\"\[Psi]\\\"},\\\"Ket\\\"]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light"], {-0.325, -3.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -5}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
          0.6, -0.47439999999999993`}, {0.6, -1}}], 
        Line[{{0.6, -1}, {0.6, -4}}], 
        BezierCurve[{{0.6, -4.5256}, {1.4, -4.5256}, {1.4, -4}}]}]}, 
     InsetBox[
      StyleBox["\<\"f(x)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.045000000000000005`],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
        2, -5.5}, {2, -0.5}}]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
      LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
       2.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
      LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
       2.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
      LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
       2.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
      LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
       2.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
     LineBox[{{4.6, -4.4}, {5.4, -4.4}, {5.4, -3.6}, {4.6, -3.6}, {
      4.6, -4.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, 
     LineBox[{{5.6, -4.4}, {6.4, -4.4}, {6.4, -3.6}, {5.6, -3.6}, {
      5.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, 
      LineBox[{{6.6, -1.4}, {7.4, -1.4}, {7.4, -0.6}, {6.6, -0.6}, {
       6.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, 
      LineBox[{{6.6, -2.4}, {7.4, -2.4}, {7.4, -1.6}, {6.6, -1.6}, {
       6.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, 
      LineBox[{{6.6, -3.4}, {7.4, -3.4}, {7.4, -2.6}, {6.6, -2.6}, {
       6.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
      LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
       6.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{18., 7.2}, {1, 1}},
   ImageSize->313.2,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[{(Rational[5, 64] 2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[61, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-61, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[5, 64] 2^Rational[-1, 2])
        Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-5, 64] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>], "Label" -> 
     "\!\(\*TemplateBox[{\"\[Psi]\"},\"Ket\"]\)"}], 
   Q3`Oracle[$CellContext`f, {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, {
     $CellContext`T[Q3`$]}], "Separator", {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, 
   $CellContext`S[4, 1], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {0, 0, 0}, 
    $CellContext`S[4, 3]], 
   $CellContext`S[4, 1], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, "PortSize" -> {0.5, 0.2}]]], "Output",
 CellLabel->"Out[33]=",
 CellID->1972106437,ExpressionUUID->"7d749f75-a105-47d0-ad1d-5a9df77c1a6c"]
}, Open  ]],

Cell["This must be optimal and is the final state.", "TechNoteMathCaption",
 CellID->1339699637,ExpressionUUID->"066994f4-1fef-4a43-a906-7d0e2c61881e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"out3", "=", 
    RowBox[{"Elaborate", "[", "qc3", "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prb", "=", 
   RowBox[{"Diagonal", "@", 
    RowBox[{"Matrix", "[", 
     RowBox[{
      RowBox[{"PartialTrace", "[", 
       RowBox[{"out3", ",", "T"}], "]"}], ",", 
      RowBox[{"S", "@", "kk"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"prb", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"2", ",", "$n"}], "]"}], "-", "1"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"PlotMarkers", "->", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", "Medium"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<item number\>\"", ",", "\"\<probability\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellLabel->"In[40]:=",
 CellID->1521174526,ExpressionUUID->"75998d29-d367-417e-a8f2-5ecc8723c183"],

Cell[BoxData["1.156201`"], "EchoTiming",
 CellID->1388115381,ExpressionUUID->"6c7ac049-1c0a-43f3-bc36-0e86f6e648cf"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], Thickness[Large], 
      LineBox[{{0., 0.0025787353515625}, {1., 0.0025787353515625}, {2., 
       0.0025787353515625}, {3., 0.9613189697265625}, {4., 
       0.0025787353515625}, {5., 0.0025787353515625}, {6., 
       0.0025787353515625}, {7., 0.0025787353515625}, {8., 
       0.0025787353515625}, {9., 0.0025787353515625}, {10., 
       0.0025787353515625}, {11., 0.0025787353515625}, {12., 
       0.0025787353515625}, {13., 0.0025787353515625}, {14., 
       0.0025787353515625}, {15., 0.0025787353515625}}]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], Thickness[Large], 
     GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[
          {EdgeForm[None], DiskBox[{0, 0}]},
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->Large,
          PlotRangePadding->Scaled[0.025]],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6], 
           Thickness[Large]]}],
        TraditionalForm], {0., 0.}, Automatic, Offset[10]], {{{0., 
      0.0025787353515625}}, {{1., 0.0025787353515625}}, {{2., 
      0.0025787353515625}}, {{3., 0.9613189697265625}}, {{4., 
      0.0025787353515625}}, {{5., 0.0025787353515625}}, {{6., 
      0.0025787353515625}}, {{7., 0.0025787353515625}}, {{8., 
      0.0025787353515625}}, {{9., 0.0025787353515625}}, {{10., 
      0.0025787353515625}}, {{11., 0.0025787353515625}}, {{12., 
      0.0025787353515625}}, {{13., 0.0025787353515625}}, {{14., 
      0.0025787353515625}}, {{15., 0.0025787353515625}}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Large,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"probability\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"item number\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
    "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 15.}, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[42]=",
 CellID->1332769304,ExpressionUUID->"2d0bfa5a-5eee-43a9-b759-6ebb1cafd0d6"]
}, Open  ]],

Cell["\<\
Any further application of the Grover rotation will overshoot the desired \
result.\
\>", "TechNoteMathCaption",
 CellID->713979167,ExpressionUUID->"3f3ebde4-3f94-48c7-b327-8081d1d33ae1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc4", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out3", ",", 
      RowBox[{"\"\<Label\>\"", 
       "->", "\"\<\!\(\*TemplateBox[{\"\[Psi]\"},\"Ket\"]\)\>\""}]}], "}"}], ",",
     "grv"}], "]"}]}]], "Input",
 CellLabel->"In[43]:=",
 CellID->1856723980,ExpressionUUID->"a01e2e99-444b-43f4-8ce4-69f179a34caf"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}, {{
     0, -4}, {8, -4}}, {{0, -5}, {
     8, -5}}}], {{
      BSplineCurveBox[{{-0.225, -3.}, {-0.1625, -2.96875}, {-0.1625, \
-2.9375}, {-0.1625, -1.0625}, {-0.1625, -1.03125}, {-0.1, -1.}}], 
      BSplineCurveBox[{{-0.225, -3.}, {-0.1625, -3.03125}, {-0.1625, \
-3.0625}, {-0.1625, -4.9375}, {-0.1625, -4.96875}, {-0.1, -5.}}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*TemplateBox[{\\\"\[Psi]\\\"},\\\"Ket\\\"]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light"], {-0.325, -3.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
     LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -5}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      FilledCurveBox[{
       BezierCurve[{{1.4, -1}, {1.4, -0.47439999999999993`}, {
          0.6, -0.47439999999999993`}, {0.6, -1}}], 
        Line[{{0.6, -1}, {0.6, -4}}], 
        BezierCurve[{{0.6, -4.5256}, {1.4, -4.5256}, {1.4, -4}}]}]}, 
     InsetBox[
      StyleBox["\<\"f(x)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.045000000000000005`],
       FontWeight->"Light",
       FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
        2, -5.5}, {2, -0.5}}]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, 
      LineBox[{{2.6, -1.4}, {3.4, -1.4}, {3.4, -0.6}, {2.6, -0.6}, {
       2.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, 
      LineBox[{{2.6, -2.4}, {3.4, -2.4}, {3.4, -1.6}, {2.6, -1.6}, {
       2.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, 
      LineBox[{{2.6, -3.4}, {3.4, -3.4}, {3.4, -2.6}, {2.6, -2.6}, {
       2.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
      LineBox[{{2.6, -4.4}, {3.4, -4.4}, {3.4, -3.6}, {2.6, -3.6}, {
       2.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {3, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
     LineBox[{{3.6, -4.4}, {4.4, -4.4}, {4.4, -3.6}, {3.6, -3.6}, {
      3.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     LineBox[{{5, -1}, {5, -2}, {5, -3}, {5, -4}}], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], DiskBox[{5, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[None], RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
     LineBox[{{4.6, -4.4}, {5.4, -4.4}, {5.4, -3.6}, {4.6, -3.6}, {
      4.6, -4.4}}], InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {
     {GrayLevel[1], EdgeForm[None], RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, 
     LineBox[{{5.6, -4.4}, {6.4, -4.4}, {6.4, -3.6}, {5.6, -3.6}, {
      5.6, -4.4}}], InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6, -4}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {{
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, 
      LineBox[{{6.6, -1.4}, {7.4, -1.4}, {7.4, -0.6}, {6.6, -0.6}, {
       6.6, -1.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -1}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, 
      LineBox[{{6.6, -2.4}, {7.4, -2.4}, {7.4, -1.6}, {6.6, -1.6}, {
       6.6, -2.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -2}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, 
      LineBox[{{6.6, -3.4}, {7.4, -3.4}, {7.4, -2.6}, {6.6, -2.6}, {
       6.6, -3.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -3}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {
      {GrayLevel[1], EdgeForm[None], RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, 
      LineBox[{{6.6, -4.4}, {7.4, -4.4}, {7.4, -3.6}, {6.6, -3.6}, {
       6.6, -4.4}}], InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05],
        FontWeight->"Light",
        FontSlant->Italic], {7, -4}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{18., 7.2}, {1, 1}},
   ImageSize->313.2,
   PlotRange->NCache[{Full, {
       Rational[-11, 2], 
       Rational[-1, 2]}}, {Full, {-5.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QuantumCircuitIn[{(Rational[13, 256] 2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[-251, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[251, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         0, $CellContext`T[Q3`$] -> 1|>] + (Rational[13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 0|>] + (Rational[-13, 256] 
       2^Rational[-1, 2]) 
      Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
         1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
         1, $CellContext`T[Q3`$] -> 1|>], "Label" -> 
     "\!\(\*TemplateBox[{\"\[Psi]\"},\"Ket\"]\)"}], 
   Q3`Oracle[$CellContext`f, {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, {
     $CellContext`T[Q3`$]}], "Separator", {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, 
   $CellContext`S[4, 1], 
   Q3`ControlledGate[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$]} -> {0, 0, 0}, 
    $CellContext`S[4, 3]], 
   $CellContext`S[4, 1], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6], 
    $CellContext`S[4, 6]}, "PortSize" -> {0.5, 0.2}]]], "Output",
 CellLabel->"Out[43]=",
 CellID->1194411734,ExpressionUUID->"de672cb7-5432-4c9b-b63f-26c28f6e4d5f"]
}, Open  ]],

Cell["Observe that the output state overshoot.", "TechNoteMathCaption",
 CellID->1120076865,ExpressionUUID->"b15b8750-82d7-474f-a0eb-f89e868a594b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"out4", "=", 
    RowBox[{"Elaborate", "[", "qc4", "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prb", "=", 
   RowBox[{"Diagonal", "@", 
    RowBox[{"Matrix", "[", 
     RowBox[{
      RowBox[{"PartialTrace", "[", 
       RowBox[{"out4", ",", "T"}], "]"}], ",", 
      RowBox[{"S", "@", "kk"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"prb", ",", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"2", ",", "$n"}], "]"}], "-", "1"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}], ",", 
   RowBox[{"PlotMarkers", "->", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", "Medium"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<item number\>\"", ",", "\"\<probability\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellLabel->"In[47]:=",
 CellID->290220453,ExpressionUUID->"48f1c54d-352a-4dca-b80b-bccab8f4df2f"],

Cell[BoxData["1.15307`"], "EchoTiming",
 CellID->1929882330,ExpressionUUID->"ee8f1baa-f932-40cc-bdbd-09a9db7cc533"],

Cell[BoxData[
 GraphicsBox[{{}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
       NCache[
        Rational[7, 360], 0.019444444444444445`]], Thickness[Large], 
      LineBox[{{0., 0.027886390686035156`}, {1., 0.027886390686035156`}, {2., 
       0.027886390686035156`}, {3., 0.5817041397094727}, {4., 
       0.027886390686035156`}, {5., 0.027886390686035156`}, {6., 
       0.027886390686035156`}, {7., 0.027886390686035156`}, {8., 
       0.027886390686035156`}, {9., 0.027886390686035156`}, {10., 
       0.027886390686035156`}, {11., 0.027886390686035156`}, {12., 
       0.027886390686035156`}, {13., 0.027886390686035156`}, {14., 
       0.027886390686035156`}, {15., 0.027886390686035156`}}]}}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], Thickness[Large], 
     GeometricTransformationBox[InsetBox[
       FormBox[
        StyleBox[
         GraphicsBox[
          {EdgeForm[None], DiskBox[{0, 0}]},
          AxesStyle->Large,
          FrameStyle->Large,
          ImageSize->Large,
          PlotRangePadding->Scaled[0.025]],
         StripOnInput->False,
         GraphicsBoxOptions->{DefaultBaseStyle->Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6], 
           Thickness[Large]]}],
        TraditionalForm], {0., 0.}, Automatic, Offset[10]], {{{0., 
      0.027886390686035156`}}, {{1., 0.027886390686035156`}}, {{2., 
      0.027886390686035156`}}, {{3., 0.5817041397094727}}, {{4., 
      0.027886390686035156`}}, {{5., 0.027886390686035156`}}, {{6., 
      0.027886390686035156`}}, {{7., 0.027886390686035156`}}, {{8., 
      0.027886390686035156`}}, {{9., 0.027886390686035156`}}, {{10., 
      0.027886390686035156`}}, {{11., 0.027886390686035156`}}, {{12., 
      0.027886390686035156`}}, {{13., 0.027886390686035156`}}, {{14., 
      0.027886390686035156`}}, {{15., 0.027886390686035156`}}}]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  AxesStyle->Large,
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"probability\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"item number\"", HoldForm], TraditionalForm], None}},
  FrameStyle->Large,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Large,
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
    "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 15.}, {0., 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[49]=",
 CellID->2086799669,ExpressionUUID->"55e8ed6f-c47c-4072-a03e-38e0cfe9179d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Notes", "TechNoteSection",
 CellID->1668202417,ExpressionUUID->"f281699c-0222-4099-bf42-887551ccbbfe"],

Cell[TextData[{
 "The process explained here can also be regarded as (or generalized to) ",
 StyleBox["quantum amplitude amplification",
  FontSlant->"Italic"],
 "; see ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Brassard et al. (2002)"]], 
    "https://doi.org/10.1090/conm/305/05215"},
   "WebLink",
   BaseStyle->{"TechNoteText"}]],ExpressionUUID->
  "9389fda1-8e05-4545-9d40-71c0cf33acd0"],
 "."
}], "TechNoteText",
 CellID->1064615759,ExpressionUUID->"8d6dc971-e08e-446d-9f84-3b3ae8b8a1e5"],

Cell[TextData[{
 "It has been assumed that the number ",
 StyleBox["M",
  FontSlant->"Italic"],
 " of solutions is known. It is also possible to achieve similar speed-up \
even if ",
 StyleBox["M",
  FontSlant->"Italic"],
 " is not known; it is call the ",
 StyleBox["quantum counting",
  FontSlant->"Italic"],
 " or ",
 StyleBox["quantum amplitude estimation",
  FontSlant->"Italic"],
 ". See ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Brassard et al. (2002)"]], 
    "https://doi.org/10.1090/conm/305/05215"},
   "WebLink",
   BaseStyle->{"TechNoteText"}]],ExpressionUUID->
  "f7b90edd-8ea1-49b1-b385-103786401917"],
 "."
}], "TechNoteText",
 CellID->1067628485,ExpressionUUID->"19585576-3921-478f-a8a4-26be7f67f053"]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/guide/QuantumInformationSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "2c50ab0c-6a4a-4353-86b8-7c16d249ffee"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"81ee3813-687a-4611-9624-\
34f2dc08b4e8"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Algorithms",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3S/tutorial/QuantumAlgorithms"]], 
         "RelatedTutorials",ExpressionUUID->
         "480a7989-f664-4790-8433-613cae692def"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "8dae8e67-7667-4c7c-af9e-78e37bb604a8"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"ddb1cfff-21d5-4f9b-afa4-\
54f46aa8b61d"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "L. K. Grover (1996)"}]]]],
              "http://arxiv.org/abs/quant-ph/9605043"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "1cbd051b-74e5-4d5a-8622-f7a956a8af31"]}]],ExpressionUUID->
         "317b9695-afba-4dc5-a0c0-38744955d890"],
        ", \[OpenCurlyDoubleQuote]A fast quantum mechanical algorithm for \
database search,\[CloseCurlyDoubleQuote] in Proceedings of the 28th Annual \
ACM Symposium on the Theory of Computing (ACM Press, New York, 1996), p. \
212."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "dc9d1b5c-223f-40bc-be57-9f8bdc66cc90"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "L. K. Grover, Physical Review Letters 79, 325 (1997)"}]]]],
              "https://doi.org/10.1103/PhysRevLett.79.325"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "7cef03b1-601e-4f41-963a-6b39beb63d62"]}]],ExpressionUUID->
         "08ac406e-0600-4321-a2bd-246e25e68b09"],
        ", \"Quantum Mechanics Helps in Searching for a Needle in a Haystack.\
\""
       }], "TutorialRelatedLinks",
        PageWidth->DirectedInfinity[1],ExpressionUUID->
        "4ab1b2c5-faa8-4086-9a18-96eb8deec19b"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "G. Brassard, P. H\[OSlash]yer, M. Mosca, A. Tapp, \
Contemporary Mathematics 305, 53 (2002)"}]]]], 
             "https://doi.org/10.1090/conm/305/05215"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "13d0efec-930e-471d-b1af-d98f10a3a481"]}]],ExpressionUUID->
         "f4a21b4c-ce15-4c39-b580-986f56ca547e"],
        ", \"Quantum amplitude amplification and estimation\"."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "07166b6d-c05f-44a8-ab7c-ae16ab4dfffa"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "T. J. Yoder, G. H. Low and I. L. Chuang, Physical Review \
Letters 113, 210501 (2014)"}]]]], 
             "https://doi.org/10.1103/physrevlett.113.210501"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "b54da148-aef9-44e9-9c0d-c448b9b04fe8"]}]],ExpressionUUID->
         "b02aa0c1-139a-4950-8a3b-9847fdfd58e2"],
        ", \"Fixed-Point Quantum Search with an Optimal Number of Queries\"."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "f3b99c38-5999-48cb-a7de-06142a0e31d8"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "3a8a743b-98ec-402a-9f8f-fe32068f05d5"]}]],ExpressionUUID->
         "907409f0-d913-484b-a0b3-0da08c0243c5"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "42044b50-a874-4fa8-9f66-e89a81c2df0b"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "399054ae-bba6-4ac4-aef5-56e0503396ee"]}]],ExpressionUUID->
         "e4feb454-dd89-4595-996a-d24ff4e18d3a"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "291f38b2-9169-4e01-a0c0-b9d6a28eaf7e"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"4e55bed2-698f-4d3b-95f9-\
91802e09d71c"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"a08d50d4-d612-4fed-9d34-b1fdbb219b96"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Quantum Search Algorithm",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2021", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 3, 2, 21, 35, 5.889169}", 
    "history" -> {"13", "", "", ""}, "context" -> "QuantumMob`Q3S`", 
    "keywords" -> {
     "quantum search algorithm", "quantum amplitude amplification", 
      "unstructured search problem", "quantum counting", 
      "quantum amplitude amplification", "quantum amplitude estimation"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Quantum Mob/ Q3S Tech Note", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3S", "status" -> "None", "summary" -> 
    "See also Section 4.5 of the Quantum Workbook (2022). The quantum search \
algorithm\\[LongDash]also known as Grover's algorithm after its inventor \
(Grover, 1996, 1997)\\[LongDash]is a quantum algorithm to conduct an \
unstructured search. The unstructured search problem is to find a small \
number of elements with a specified property from within a huge unsorted (or, \
more generally, unstructured) data set. The quantum search algorithm finds a \
desired element with a high probability with an order of SqrtBox[N] queries \
to the function that defines the property, where N is the size of the data \
set. Classical algorithms needs N queries. Interestingly, the quantum search \
algorithm is known to be already optimal in the sense that any quantum \
algorithm for unstructured search needs an order of SqrtBox[N] queries. In \
any case, the superiority of the quantum algorithm over its classical \
counterparts is merely quadratic (i.e., polynomial) rather than exponential. \
However, the quadratic speedup cannot be underestimated. The efficacy is \
considerable for large N.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "Quantum Search Algorithm", "titlemodifier" -> "", "metadescription" -> 
    "", "windowtitle" -> "Quantum Search Algorithm", "type" -> "Tech Note", 
    "uri" -> "QuantumMob/Q3S/tutorial/QuantumSearchAlgorithm"}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.2 for Mac OS X ARM (64-bit) (December 26, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"4708167b-c16c-4f52-8074-9ca9937654c4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[592, 21, 6517, 158, 50, "AnchorBarGrid",ExpressionUUID->"6020a569-6a90-411c-9614-5fe3cd1ac9a1",
 CellID->1],
Cell[CellGroupData[{
Cell[7134, 183, 124, 1, 67, "TechNoteTitle",ExpressionUUID->"74e72a5a-d115-4292-88f9-895c564fd340",
 CellID->431054410],
Cell[7261, 186, 4428, 100, 109, "TechNoteJumpBox",ExpressionUUID->"8c511528-10fc-477c-a87c-7c134dafabeb"],
Cell[11692, 288, 408, 13, 34, "TechNoteText",ExpressionUUID->"687c81cd-9b5d-4d62-ad8c-5c913010e987",
 CellID->1308734266],
Cell[12103, 303, 1062, 22, 127, "TechNoteText",ExpressionUUID->"45904a04-26ea-40ef-850b-23211c1aa26b",
 CellID->511227000],
Cell[13168, 327, 777, 17, 104, "TechNoteText",ExpressionUUID->"e773b89a-e29b-450c-9186-d702cd7835be",
 CellID->110117353],
Cell[13948, 346, 352, 6, 57, "TechNoteText",ExpressionUUID->"935055c0-759e-422a-9f25-727dffde0737",
 CellID->1374334002],
Cell[14303, 354, 1150, 30, 118, "DefinitionBox",ExpressionUUID->"f86d0323-7f15-4e3f-a76c-4d39a2597ef0",
 CellID->172000137],
Cell[15456, 386, 152, 1, 30, "TechNoteCaption",ExpressionUUID->"7ae5a030-4d43-4e76-91a2-3de0cb24db96",
 CellID->293313697],
Cell[15611, 389, 295, 7, 35, "TechNoteMathCaption",ExpressionUUID->"d7c25232-8189-48ed-b6d7-3324ac06f887",
 CellID->1428640008],
Cell[15909, 398, 179, 3, 28, "Input",ExpressionUUID->"643b7028-c3ec-4552-a891-88de29d78453",
 CellID->853967906],
Cell[16091, 403, 318, 6, 55, "TechNoteMathCaption",ExpressionUUID->"69bc801f-5504-4ff1-8c51-8bc9b9a3e4c6",
 CellID->1937193009],
Cell[16412, 411, 271, 6, 45, "Input",ExpressionUUID->"dfd3630d-f88a-4efd-a53d-6e304576396d",
 CellID->403330096],
Cell[CellGroupData[{
Cell[16708, 421, 129, 1, 70, "TechNoteSection",ExpressionUUID->"3c0632e7-6909-4304-961c-7453ae0e58a2",
 CellID->1076935439],
Cell[16840, 424, 744, 20, 70, "TechNoteText",ExpressionUUID->"65015c11-c095-42cb-884c-952def4a3413",
 CellID->1061746357],
Cell[17587, 446, 402, 15, 70, "TechNoteText",ExpressionUUID->"b5ac9929-36f0-4945-adf3-1f20a49f7433",
 CellID->792087644],
Cell[17992, 463, 638, 18, 70, "TechNoteText",ExpressionUUID->"089df284-5919-467a-8727-73721406c379",
 CellID->365904955],
Cell[18633, 483, 941, 21, 70, "Picture",ExpressionUUID->"4cdfb2b0-b56d-4661-94c9-78f96f20e9ce",
 CellID->1940887528],
Cell[19577, 506, 817, 25, 70, "TechNoteCaption",ExpressionUUID->"1c78c035-76ce-46fe-b0ea-3db44bc4e8fe",
 CellID->891091610],
Cell[20397, 533, 436, 12, 70, "TechNoteText",ExpressionUUID->"44233ce0-3cf6-4ca8-8d2d-e08248f8de85",
 CellID->892352758],
Cell[20836, 547, 481, 18, 70, "TechNoteText",ExpressionUUID->"f4ba2b34-c64a-4d72-bf06-a4907bc9fa4b",
 CellID->1894496705],
Cell[21320, 567, 774, 20, 70, "TechNoteText",ExpressionUUID->"ca894f29-6266-405a-a111-d8db1b949a1e",
 CellID->384300394],
Cell[22097, 589, 867, 19, 70, "TechNoteText",ExpressionUUID->"315dede2-3004-4e53-a81c-018fe7d7aac1",
 CellID->472911363],
Cell[22967, 610, 1213, 35, 70, "TechNoteCaption",ExpressionUUID->"691bcf3d-38c0-49f8-9f18-0b3400557348",
 CellID->725901784],
Cell[24183, 647, 1351, 48, 70, "TechNoteText",ExpressionUUID->"dfdaf8fd-69fa-4fa2-9403-dc39af0eff0d",
 CellID->1453395429],
Cell[25537, 697, 628, 22, 70, "TechNoteText",ExpressionUUID->"acc56f8d-db9a-4c59-8432-704fb5a6ca57",
 CellID->1737974225],
Cell[26168, 721, 654, 21, 70, "TechNoteText",ExpressionUUID->"05e69009-b6c4-4a93-ad67-2535b67e585f",
 CellID->60233081],
Cell[26825, 744, 1044, 34, 70, "TechNoteText",ExpressionUUID->"33878362-fcac-405f-b99e-264abb005b8c",
 CellID->872594630],
Cell[27872, 780, 429, 14, 70, "TechNoteText",ExpressionUUID->"661f6553-0a22-45d0-96f1-77173aa8e7bc",
 CellID->532121047],
Cell[28304, 796, 965, 31, 70, "TechNoteText",ExpressionUUID->"e51dda3f-6212-4831-ab9d-6e9c764dec76",
 CellID->1236530821],
Cell[29272, 829, 388, 8, 70, "TechNoteText",ExpressionUUID->"3be5be1f-63f2-4014-8cb2-747977c83a6b",
 CellID->1174256528],
Cell[29663, 839, 5590, 156, 70, "Picture",ExpressionUUID->"4b770d64-f5d8-4bc0-b78e-c9fcea998180",
 CellID->2056845661],
Cell[35256, 997, 502, 14, 70, "TechNoteText",ExpressionUUID->"27b3e749-851d-4fcc-810f-475661fb42e8",
 CellID->384530690],
Cell[35761, 1013, 4170, 100, 70, "Picture",ExpressionUUID->"6af842e8-64c5-40e5-9143-dbd34ae77450",
 CellID->1527920433],
Cell[39934, 1115, 537, 14, 70, "TechNoteText",ExpressionUUID->"e0962da3-83bb-48a5-8c1f-f5e0e1400780",
 CellID->1957062925]
}, Open  ]],
Cell[CellGroupData[{
Cell[40508, 1134, 118, 1, 70, "TechNoteSection",ExpressionUUID->"2f504705-534f-4be3-9c26-c34c86eca2ee",
 CellID->1497043023],
Cell[40629, 1137, 179, 3, 70, "Input",ExpressionUUID->"95291454-dafe-4582-ac75-063907e5fb4e",
 CellID->115353160],
Cell[40811, 1142, 272, 6, 70, "Input",ExpressionUUID->"4e5a0a2e-8177-4d3e-a3ed-8ca3304e826c",
 CellID->1120395387],
Cell[41086, 1150, 2277, 60, 70, "TechNoteText",ExpressionUUID->"f5b4f728-168e-4699-9674-022536249948",
 CellID->883679309],
Cell[43366, 1212, 401, 8, 70, "TechNoteText",ExpressionUUID->"e0b63732-d12d-4f6b-a7a0-f4b1002bf87b",
 CellID->1243711],
Cell[43770, 1222, 550, 16, 70, "TechNoteText",ExpressionUUID->"a08f3dc7-e892-4eb0-ac20-eea6ca2b9156",
 CellID->1575697954],
Cell[44323, 1240, 161, 2, 70, "TechNoteText",ExpressionUUID->"c64c9c23-9a50-4e49-891d-dd52fef247e5",
 CellID->2134661721],
Cell[44487, 1244, 488, 17, 70, "TechNoteText",ExpressionUUID->"fafad344-e7ed-4463-844f-0228ebda933f",
 CellID->1397738065],
Cell[44978, 1263, 153, 1, 70, "TechNoteText",ExpressionUUID->"643feacb-36e4-488f-81b4-031a6d34fa8a",
 CellID->460043922],
Cell[45134, 1266, 560, 19, 70, "TechNoteText",ExpressionUUID->"84ae10a2-34ca-4519-880f-cf4df6f9dc4b",
 CellID->1017067854],
Cell[45697, 1287, 765, 19, 70, "TechNoteText",ExpressionUUID->"6697388d-1535-47ae-865f-f62f5d2884be",
 CellID->2037075705],
Cell[46465, 1308, 499, 18, 70, "TechNoteText",ExpressionUUID->"cafecfcd-6dae-4dea-9542-a876abd6c765",
 CellID->1947073461],
Cell[46967, 1328, 720, 21, 70, "TechNoteText",ExpressionUUID->"f1f483a0-6c1a-4984-a802-c02f908b5dcd",
 CellID->1107846041],
Cell[47690, 1351, 602, 23, 70, "TechNoteText",ExpressionUUID->"e554fbae-6643-4e84-ac1e-e40fa587891e",
 CellID->885191597],
Cell[48295, 1376, 1056, 31, 70, "TechNoteText",ExpressionUUID->"21403955-1a83-4bc0-b20b-32cdbd4d2724",
 CellID->1795948010],
Cell[49354, 1409, 1069, 40, 70, "TechNoteText",ExpressionUUID->"99f7a53f-a110-40e8-834b-3eadfce39f3e",
 CellID->1615545485],
Cell[50426, 1451, 1950, 59, 70, "TechNoteText",ExpressionUUID->"3aa557c7-d813-4b7e-afb5-052da691b3b3",
 CellID->1837217374],
Cell[52379, 1512, 2327, 53, 70, "Picture",ExpressionUUID->"bb1c6d3d-3224-4eee-9114-2a5103609c75",
 CellID->1449455432],
Cell[54709, 1567, 2304, 71, 70, "TechNoteCaption",ExpressionUUID->"87e96136-945e-414b-937b-e3709f7e9d41",
 CellID->1113346130],
Cell[57016, 1640, 225, 5, 70, "TechNoteText",ExpressionUUID->"8195f86a-3f7d-4f19-92e1-e97cd934a429",
 CellID->1533638803],
Cell[57244, 1647, 341, 11, 70, "TechNoteText",ExpressionUUID->"41f93912-1fda-4b66-b7ae-8126b2ebda90",
 CellID->1768630727],
Cell[57588, 1660, 825, 24, 70, "TechNoteText",ExpressionUUID->"0c1cec4d-498c-478e-aac5-563a7c7517fd",
 CellID->2055470562],
Cell[58416, 1686, 631, 22, 70, "TechNoteText",ExpressionUUID->"6b829ae5-14aa-4b38-8d8a-3e1eef816ad1",
 CellID->1871789892],
Cell[59050, 1710, 102, 1, 70, "TechNoteText",ExpressionUUID->"a0cbef0e-aa8e-4b21-8f12-43a7aa08ce09",
 CellID->684769941],
Cell[59155, 1713, 628, 22, 70, "TechNoteText",ExpressionUUID->"923fc664-1636-4382-88d4-5b30fc81144a",
 CellID->563534114],
Cell[59786, 1737, 2115, 64, 70, "TechNoteText",ExpressionUUID->"cedcdb80-10e3-42de-80ab-acbec39d364b",
 CellID->914970728],
Cell[61904, 1803, 1359, 43, 70, "TechNoteText",ExpressionUUID->"ac84fd7b-c39f-4558-a2b5-939796646a49",
 CellID->1602567379],
Cell[63266, 1848, 396, 11, 70, "TechNoteText",ExpressionUUID->"c6c19b05-efc4-4aeb-83fe-922b795719f9",
 CellID->1668299697],
Cell[63665, 1861, 959, 34, 70, "TechNoteText",ExpressionUUID->"5189f2f3-c429-4f72-ad75-d9b94e15e3e7",
 CellID->1566512247],
Cell[64627, 1897, 1197, 37, 70, "TechNoteText",ExpressionUUID->"ba3793f0-81b7-40da-beaf-7b27e8d215dd",
 CellID->221823109],
Cell[65827, 1936, 403, 13, 70, "TechNoteText",ExpressionUUID->"5e74029e-a681-4c42-9f72-f201d304196d",
 CellID->149381771],
Cell[66233, 1951, 302, 8, 70, "TechNoteText",ExpressionUUID->"ab450af5-1671-4757-ad0c-b7802aed7fd3",
 CellID->251041854],
Cell[66538, 1961, 527, 17, 70, "TechNoteText",ExpressionUUID->"4c4757dc-7bf9-4639-a210-f39420a3db18",
 CellID->1602557470],
Cell[67068, 1980, 120, 1, 70, "TechNoteText",ExpressionUUID->"537518e7-3027-4aa5-b3c5-db978247043e",
 CellID->443497616],
Cell[67191, 1983, 355, 12, 70, "TechNoteText",ExpressionUUID->"1179d03b-e7a0-413d-8a2e-7065f584bdeb",
 CellID->2096177022],
Cell[67549, 1997, 449, 13, 70, "TechNoteText",ExpressionUUID->"13740d39-8115-4f72-bb0e-d8783b46fedb",
 CellID->977979719],
Cell[68001, 2012, 202, 4, 70, "TechNoteText",ExpressionUUID->"ef4fde1e-131d-4c46-a720-81f9d2a0c4a5",
 CellID->65303095],
Cell[68206, 2018, 433, 14, 70, "TechNoteText",ExpressionUUID->"ab7a154e-464e-4c0a-b956-c3c1996d96db",
 CellID->184974048],
Cell[68642, 2034, 326, 9, 70, "TechNoteText",ExpressionUUID->"df2b13da-4875-4609-a44e-ed4f8cb89c9e",
 CellID->1449987527],
Cell[68971, 2045, 466, 15, 70, "TechNoteText",ExpressionUUID->"bca44da5-9595-4339-8a1d-06cb7056d063",
 CellID->295940133],
Cell[69440, 2062, 189, 4, 70, "TechNoteText",ExpressionUUID->"e86054a7-cbc6-4d78-b431-17eeb64c4d38",
 CellID->293688879],
Cell[69632, 2068, 949, 28, 70, "TechNoteText",ExpressionUUID->"6bb91f12-7054-4696-8181-a4af71741ffa",
 CellID->1132582699]
}, Open  ]],
Cell[CellGroupData[{
Cell[70618, 2101, 125, 1, 70, "TechNoteSection",ExpressionUUID->"7f74b528-4142-44d4-b81e-385778105137",
 CellID->1111568547],
Cell[70746, 2104, 1318, 36, 70, "TechNoteText",ExpressionUUID->"2e380898-b420-4b8a-8c8e-90d906a036fe",
 CellID->1172324176],
Cell[72067, 2142, 1498, 44, 70, "TechNoteText",ExpressionUUID->"7823c88b-0882-49e9-a472-c3817f1c9c48",
 CellID->348391527],
Cell[73568, 2188, 631, 23, 70, "TechNoteText",ExpressionUUID->"0f6bb461-07de-4e55-b805-baebd6af83a6",
 CellID->89964807],
Cell[74202, 2213, 171, 3, 70, "TechNoteText",ExpressionUUID->"f416a841-6900-4ad3-9178-447c538486c0",
 CellID->210023761],
Cell[74376, 2218, 542, 14, 70, "TechNoteText",ExpressionUUID->"5125f37b-933b-4c2f-9345-58cc06b342d8",
 CellID->1553719106],
Cell[74921, 2234, 331, 8, 70, "TechNoteText",ExpressionUUID->"64379e1f-bb1d-445c-ada0-1054b9d6e9b2",
 CellID->2103350669],
Cell[75255, 2244, 11813, 243, 70, "Picture",ExpressionUUID->"edbc7d3e-db50-4b03-b3ec-00a1707e10c3",
 CellID->690721683],
Cell[87071, 2489, 702, 18, 70, "TechNoteCaption",ExpressionUUID->"0b8a613a-1b68-4f3b-a6cf-fec872b49b37",
 CellID->1783078446]
}, Open  ]],
Cell[CellGroupData[{
Cell[87810, 2512, 110, 1, 70, "TechNoteSection",ExpressionUUID->"e8df3226-514d-4f86-9f0c-50e74e9ef11a",
 CellID->1481138763],
Cell[87923, 2515, 178, 3, 70, "Input",ExpressionUUID->"2d17dc94-e977-4a26-bd3a-be21b66fa40a",
 CellID->371295434],
Cell[88104, 2520, 148, 1, 70, "TechNoteText",ExpressionUUID->"91075e6b-8967-4d82-9553-14f4bb0dd627",
 CellID->994254636],
Cell[88255, 2523, 280, 6, 70, "Input",ExpressionUUID->"cd9b21ce-138c-4154-8852-c8a32c6f99df",
 CellID->1644652659],
Cell[88538, 2531, 218, 4, 70, "TechNoteMathCaption",ExpressionUUID->"d563a9c7-dcde-42f6-9ca5-9c825cf22a34",
 CellID->663476370],
Cell[88759, 2537, 469, 13, 70, "Input",ExpressionUUID->"cd2ae2ee-cff2-4c72-9621-e554d111f4bf",
 CellID->215354860],
Cell[89231, 2552, 180, 3, 70, "TechNoteMathCaption",ExpressionUUID->"2ec002f0-b981-4c91-81dd-045f4b6278ab",
 CellID->1204678952],
Cell[89414, 2557, 360, 9, 70, "Input",ExpressionUUID->"ff07ae89-ef29-4e7e-83b4-7dfbe3cd0d63",
 CellID->867337255],
Cell[89777, 2568, 348, 9, 70, "TechNoteMathCaption",ExpressionUUID->"8387b886-03fc-4e46-9061-07c8854fe7a3",
 CellID->489040982],
Cell[CellGroupData[{
Cell[90150, 2581, 435, 12, 70, "Input",ExpressionUUID->"13addeba-ede8-4c4c-8019-c3ad3a69b11a",
 CellID->275964604],
Cell[90588, 2595, 659, 23, 58, "Output",ExpressionUUID->"536f6368-629f-4c29-913c-5b77b400b2c9",
 CellID->666686370]
}, Open  ]],
Cell[91262, 2621, 161, 2, 70, "TechNoteMathCaption",ExpressionUUID->"7f737874-02ed-4390-9661-f897ffca9f9e",
 CellID->1882657478],
Cell[CellGroupData[{
Cell[91448, 2627, 1014, 27, 70, "Input",ExpressionUUID->"4940a69e-c419-41b9-a3a7-6b21676518f4",
 CellID->254452149],
Cell[92465, 2656, 7266, 171, 203, "Output",ExpressionUUID->"3e6309d7-b706-4b51-9bcb-2821a73a009d",
 CellID->348266070]
}, Open  ]],
Cell[99746, 2830, 150, 1, 70, "TechNoteMathCaption",ExpressionUUID->"3ec10202-0a39-4c01-93d4-e5f09d7265e3",
 CellID->32473192],
Cell[CellGroupData[{
Cell[99921, 2835, 532, 14, 70, "Input",ExpressionUUID->"70003d2c-d9b1-4e2e-9ad4-7a6d0ea20bbd",
 CellID->1257594333],
Cell[100456, 2851, 11151, 257, 201, "Output",ExpressionUUID->"7eac019f-5907-4a5a-ac3a-819a8d81b220",
 CellID->1037271865]
}, Open  ]],
Cell[111622, 3111, 142, 1, 70, "TechNoteMathCaption",ExpressionUUID->"695b7853-6855-42aa-b5dd-8587c4cf38f2",
 CellID->1021716225],
Cell[CellGroupData[{
Cell[111789, 3116, 228, 5, 70, "Input",ExpressionUUID->"95c44b44-dee8-4c10-925b-4382d3568049",
 CellID->1161547237],
Cell[112020, 3123, 116, 1, 70, "EchoTiming",ExpressionUUID->"f2086b3d-690f-4dcf-996f-96f0df68451b",
 CellID->1838562799],
Cell[112139, 3126, 42523, 1220, 298, "Output",ExpressionUUID->"c9f2b435-0a84-4c56-a611-a106c4e2e285",
 CellID->245236435]
}, Open  ]],
Cell[154677, 4349, 233, 4, 70, "TechNoteMathCaption",ExpressionUUID->"9517274f-bcfa-4ad3-9ff2-1e9d2ef51ac5",
 CellID->2003803216],
Cell[154913, 4355, 267, 7, 70, "Input",ExpressionUUID->"4083873d-bb56-4744-a204-b45960240623",
 CellID->528506718],
Cell[155183, 4364, 207, 4, 70, "TechNoteMathCaption",ExpressionUUID->"48e0108e-6e4e-406b-ab0c-b178d6eeb420",
 CellID->386816352],
Cell[155393, 4370, 207, 5, 70, "Input",ExpressionUUID->"a71df679-01e8-4173-846e-a5cd580fa39b",
 CellID->1776881829],
Cell[155603, 4377, 186, 3, 70, "TechNoteText",ExpressionUUID->"a7bbe96c-3131-4776-941d-9ff463e6c066",
 CellID->1988772383],
Cell[CellGroupData[{
Cell[155814, 4384, 1024, 30, 70, "Input",ExpressionUUID->"b709d0f4-5dca-4b3b-bae6-4494a2b29ca8",
 CellID->228651475],
Cell[156841, 4416, 4961, 129, 402, "Output",ExpressionUUID->"5e2f6185-7984-4b4a-bc46-6112adafd5d7",
 CellID->789954813]
}, Open  ]],
Cell[161817, 4548, 166, 2, 70, "TechNoteMathCaption",ExpressionUUID->"14e27e6f-21c0-4c6c-90e6-1e7ed32bded4",
 CellID->484486733],
Cell[CellGroupData[{
Cell[162008, 4554, 373, 10, 70, "Input",ExpressionUUID->"1cc7e0f2-91c7-4053-9c76-4e476e55b367",
 CellID->1744020104],
Cell[162384, 4566, 15122, 295, 195, "Output",ExpressionUUID->"da510cea-6d79-467a-bd30-f054641773ad",
 CellID->107519884]
}, Open  ]],
Cell[CellGroupData[{
Cell[177543, 4866, 1174, 34, 70, "Input",ExpressionUUID->"0693b909-469d-45ae-8314-0878ce627a9b",
 CellID->1156473617],
Cell[178720, 4902, 115, 1, 70, "EchoTiming",ExpressionUUID->"aaf1deff-7483-47b3-83a7-8aca0507cd09",
 CellID->155579424],
Cell[178838, 4905, 5097, 130, 402, "Output",ExpressionUUID->"4d9ffeec-2ea0-4651-859b-fec7db403ca5",
 CellID->673338845]
}, Open  ]],
Cell[183950, 5038, 133, 1, 70, "TechNoteMathCaption",ExpressionUUID->"3f25da86-7d2c-4ded-8b41-aeb61321b929",
 CellID->1752880784],
Cell[CellGroupData[{
Cell[184108, 5043, 372, 10, 70, "Input",ExpressionUUID->"451f6609-43e4-4d61-bf58-49bd1be8a7d5",
 CellID->942757313],
Cell[184483, 5055, 15130, 296, 195, "Output",ExpressionUUID->"7d749f75-a105-47d0-ad1d-5a9df77c1a6c",
 CellID->1972106437]
}, Open  ]],
Cell[199628, 5354, 151, 1, 70, "TechNoteMathCaption",ExpressionUUID->"066994f4-1fef-4a43-a906-7d0e2c61881e",
 CellID->1339699637],
Cell[CellGroupData[{
Cell[199804, 5359, 1174, 34, 70, "Input",ExpressionUUID->"75998d29-d367-417e-a8f2-5ecc8723c183",
 CellID->1521174526],
Cell[200981, 5395, 116, 1, 70, "EchoTiming",ExpressionUUID->"6c7ac049-1c0a-43f3-bc36-0e86f6e648cf",
 CellID->1388115381],
Cell[201100, 5398, 5256, 134, 402, "Output",ExpressionUUID->"2d0bfa5a-5eee-43a9-b759-6ebb1cafd0d6",
 CellID->1332769304]
}, Open  ]],
Cell[206371, 5535, 197, 4, 70, "TechNoteMathCaption",ExpressionUUID->"3f3ebde4-3f94-48c7-b327-8081d1d33ae1",
 CellID->713979167],
Cell[CellGroupData[{
Cell[206593, 5543, 373, 10, 70, "Input",ExpressionUUID->"a01e2e99-444b-43f4-8ce4-69f179a34caf",
 CellID->1856723980],
Cell[206969, 5555, 15292, 310, 195, "Output",ExpressionUUID->"de672cb7-5432-4c9b-b63f-26c28f6e4d5f",
 CellID->1194411734]
}, Open  ]],
Cell[222276, 5868, 147, 1, 70, "TechNoteMathCaption",ExpressionUUID->"b15b8750-82d7-474f-a0eb-f89e868a594b",
 CellID->1120076865],
Cell[CellGroupData[{
Cell[222448, 5873, 1173, 34, 70, "Input",ExpressionUUID->"48f1c54d-352a-4dca-b80b-bccab8f4df2f",
 CellID->290220453],
Cell[223624, 5909, 115, 1, 70, "EchoTiming",ExpressionUUID->"ee8f1baa-f932-40cc-bdbd-09a9db7cc533",
 CellID->1929882330],
Cell[223742, 5912, 5346, 134, 402, "Output",ExpressionUUID->"55e8ed6f-c47c-4072-a03e-38e0cfe9179d",
 CellID->2086799669]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[229137, 6052, 108, 1, 70, "TechNoteSection",ExpressionUUID->"f281699c-0222-4099-bf42-887551ccbbfe",
 CellID->1668202417],
Cell[229248, 6055, 510, 15, 70, "TechNoteText",ExpressionUUID->"8d6dc971-e08e-446d-9f84-3b3ae8b8a1e5",
 CellID->1064615759],
Cell[229761, 6072, 735, 25, 70, "TechNoteText",ExpressionUUID->"19585576-3921-478f-a8a4-26be7f67f053",
 CellID->1067628485]
}, Open  ]],
Cell[230511, 6100, 753, 19, 70, "TutorialMoreAboutSection",ExpressionUUID->"81ee3813-687a-4611-9624-34f2dc08b4e8"],
Cell[231267, 6121, 1109, 29, 70, "RelatedTutorialsSection",ExpressionUUID->"ddb1cfff-21d5-4f9b-afa4-54f46aa8b61d"],
Cell[232379, 6152, 5978, 154, 70, "TutorialRelatedLinksSection",ExpressionUUID->"4e55bed2-698f-4d3b-95f9-91802e09d71c"]
}, Open  ]],
Cell[238372, 6309, 78, 0, 70, "FooterCell",ExpressionUUID->"a08d50d4-d612-4fed-9d34-b1fdbb219b96"]
}
]
*)

(* End of internal cache information *)

