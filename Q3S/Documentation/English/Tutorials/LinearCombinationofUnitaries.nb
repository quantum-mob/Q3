(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    135035,       3583]
NotebookOptionsPosition[    121014,       3299]
NotebookOutlinePosition[    123986,       3366]
CellTagsIndexPosition[    123943,       3363]
WindowTitle->Linear Combination of Unitaries
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3S TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "a5b3e5c5-6e20-4cb9-bc0f-fcb6d3231920"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "2242fb43-510d-4518-8c74-63cd501eafb9"],
        Background->RGBColor[
         0.3843137254901961, 0.4627450980392157, 0.7019607843137254],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "a7fa7406-8c27-41a2-9c19-641d0a9187c0"]
         }],ExpressionUUID->"a8f718d8-d035-4808-a3b5-af984ecff4ac"],
         StripOnInput->False],{
        StyleBox[
          "\"UniformlyControlledGate\"", "SeeAlsoRelated", StripOnInput -> 
           False] :> Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/ref/UniformlyControlledGate"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "f1ca95dc-c917-4651-98e9-2dcbb044c011"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "e4baa9d7-67bd-4e53-ba47-be783a4a9667"]
         }],ExpressionUUID->"f0981842-81ab-4439-9ec1-0963f681c821"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "abc4c30f-2df8-446d-a220-de597453b0d2"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "aecb18a7-1c6d-4809-a286-fc1820601a63"]
         }],ExpressionUUID->"27cc27ef-43b3-4016-a7e7-d088f6f6c4af"],
         StripOnInput->False],{
        "\"Quantum Computation: Overview\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumComputationOverview"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "1a2e0b27-69cf-4526-8d58-d0a048d904b5"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}}]],ExpressionUUID->
           "cf817021-5e9f-496d-90b5-6ff9ba9011fa"]
         }],ExpressionUUID->"4d35a007-0450-4598-ae33-a1dcac8b6775"],
         StripOnInput->False],{
        "\"QuantumMob/Q3S/tutorial/LinearCombinationofUnitaries\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard[
          "QuantumMob/Q3S/tutorial/LinearCombinationofUnitaries"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3S/\
tutorial/LinearCombinationofUnitaries.html"], StandardForm]], "Input", 
                 TextClipboardType -> "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "QuantumMob/Q3S/tutorial/LinearCombinationofUnitaries" <> 
               ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "aeca2c0e-554d-4ac5-9e23-3b77a6a521b8"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "5b1716b9-25d7-4456-baea-1e86d6ad72f5"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"59162b45-0d7e-4fa8-b4e8-a90652be3e9d"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "Linear Combination of Unitaries", "TechNoteTitle",ExpressionUUID->
      "388c204d-82de-4857-98e5-7cd401da3248"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"6d039536-30e4-4558-93fe-779d78d16f5c"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "75047e1f-caeb-4136-b87d-15eb32999443"]
    }],ExpressionUUID->"5001f4ca-f193-4b5f-88a0-2a275a328802"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.0\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24}], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "e2252a6c-4565-44c3-9114-a00cfa789e05"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"e1a09567-526f-45b1-9bbf-cf639e05fbea"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["General Implementation"], 
      "paclet:QuantumMob/Q3S/tutorial/LinearCombinationofUnitaries#221637712", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Examples"], 
      "paclet:QuantumMob/Q3S/tutorial/LinearCombinationofUnitaries#\
2113806542", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited, StripOnInput -> False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TechNoteJumpBox",ExpressionUUID->"17d3bb5a-b083-4566-9aca-\
0f0ee4942f02"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["UniformlyControlledGate"]], 
      "paclet:QuantumMob/Q3S/ref/UniformlyControlledGate", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Uniformly controlled unitary gates", "TechNoteTableText",ExpressionUUID->
     "72b2893f-62d1-42ad-b884-7d187c676a1a"]}
  }]], "DefinitionBox",
 CellID->1025109959,ExpressionUUID->"f124192d-758c-411c-8988-457e52439003"],

Cell["\<\
Q3 functions that are useful to construct a linear combination of unitaries.\
\>", "TechNoteCaption",
 CellID->1909264679,ExpressionUUID->"bbc464ac-42bf-464a-bb92-9c548b4b1f9e"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3S/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"1b2ffd88-381c-4303-b53f-401bee06d578"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[291]:=",
 CellID->853967906,ExpressionUUID->"d11a928a-60c5-4936-86c4-c8ef71a20446"],

Cell[TextData[{
 "Throughout this document, symbol ",
 StyleBox["S", "Input"],
 " will be used to denote qubits and Pauli operators on them. Similarly, \
symbol c will be used to denote complex-valued coefficients."
}], "TechNoteMathCaption",
 CellID->1937193009,ExpressionUUID->"65741eca-6411-4766-94c8-ebb88813699d"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[292]:=",
 CellID->403330096,ExpressionUUID->"56261e99-d64e-4a2a-ab7d-59c97695d1a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Implementation", "TechNoteSection",
 CellID->221637712,ExpressionUUID->"6a5c0855-8b59-4749-a86e-abb755385af1"],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "1"], ",", 
    SubscriptBox["U", "2"], ",", "\[Ellipsis]"}], TraditionalForm]],
  ExpressionUUID->"0b658a41-16b7-4134-87db-e920cfbac931"],
 " be unitary operators. and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", ":=", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Alpha]", "1"], ",", 
      SubscriptBox["\[Alpha]", "2"], ",", "\[Ellipsis]"}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"bb97c883-a233-4ba9-bdfa-134c32a92771"],
 " be a vector of complex numbers. Define a unitary operator ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "6330aa20-eecf-403c-9718-f8c213c04cb3"],
 "by"
}], "TechNoteText",
 CellID->2083809428,ExpressionUUID->"f78c4934-d8b3-4dca-8c87-9c687523c0e6"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "\[DotEqual]", 
    RowBox[{
     FractionBox["1", 
      SqrtBox[
       RowBox[{"\[LeftDoubleBracketingBar]", 
        RowBox[{"\[Alpha]", 
         SubscriptBox["\[LeftDoubleBracketingBar]", "1"]}]}]]], 
     RowBox[{"(", GridBox[{
        {
         SqrtBox[
          SubscriptBox["\[Alpha]", "1"]], "*", "\[Ellipsis]", "*"},
        {
         SqrtBox[
          SubscriptBox["\[Alpha]", "2"]], "*", "\[Ellipsis]", "*"},
        {"\[VerticalEllipsis]", "\[VerticalEllipsis]", 
         "\[DescendingEllipsis]", "\[VerticalEllipsis]"},
        {"\[VerticalEllipsis]", "*", "\[Ellipsis]", "*"}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "d38adc16-a2a7-4dfe-8398-83e217237355"],
 " ."
}], "TechNoteText",
 CellID->1421741120,ExpressionUUID->"ea994e3d-7024-41f4-a728-b9d173bbb8d9"],

Cell[TextData[{
 "Then, one way to implement ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", ":=", 
    RowBox[{
     SubscriptBox["\[Sum]", "k"], 
     RowBox[{
      SubscriptBox["\[Alpha]", "k"], 
      SubscriptBox["U", "k"]}]}]}], TraditionalForm]],ExpressionUUID->
  "7966ca2c-5c15-48bc-b5c9-e7866ca0c318"],
 " is through the quantum circuit in Figure 1."
}], "TechNoteText",
 CellID->1718500619,ExpressionUUID->"0a53b040-7343-461d-a8da-1e00be60ad43"],

Cell[TextData[{
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], 
      LineBox[{{{5, -1}, {6, -1}}, {{5, -2}, {6, -2}}}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -4}, {6, -4}}}], {
      InsetBox[
       TemplateBox[{"0"},
        "Ket"], {-0.2, -1.}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {
       1, 0}], InsetBox[
       TemplateBox[{"0"},
        "Ket"], {-0.2, -2.}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {
       1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"V\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      LineBox[{{2, -1}, {2, -2}, {2, -4}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       DiskBox[{2, -1}, 0.09, 
        NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
         3.9269908169872414`}]], 
       {GrayLevel[0], 
        DiskBox[{2, -1}, 0.09, 
         NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
          0.7853981633974483}]]}}, 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       DiskBox[{2, -2}, 0.09, 
        NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
         3.9269908169872414`}]], 
       {GrayLevel[0], 
        DiskBox[{2, -2}, 0.09, 
         NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
          0.7853981633974483}]]}}, 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "\<\"\[Ellipsis]\"\>"],
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {2., -4.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(V\\), \\(T\\)]\\)\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {{
       {GrayLevel[1], EdgeForm[Opacity[1]], 
        RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
       CircleBox[{5, -1.2}, 0.4, 
        NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
         2.6179938779914944`}]], LineBox[{{5, -1.2}, {5.24, -0.76}}]}, {
       {GrayLevel[1], EdgeForm[Opacity[1]], 
        RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
       CircleBox[{5, -2.2}, 0.4, 
        NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
         2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}}, {
      InsetBox[
       TemplateBox[{"0"},
        "Ket"], {6.2, -1.}, NCache[
       ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {
       1, 0}], InsetBox[
       TemplateBox[{"0"},
        "Ket"], {6.2, -2.}, NCache[
       ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {
       1, 0}]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
    ImageSize->262.8,
    PlotRange->{{0, 6}, {-4.5, -0.5}},
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`PortIn[
     Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>]], 
    Q3`Gate[{
      $CellContext`A[1, Q3`$], 
      $CellContext`A[2, Q3`$]}, "Label" -> "V"], 
    Q3`UniformlyControlledGate[{
      $CellContext`A[1, Q3`$], 
      $CellContext`A[2, Q3`$]}, {
      $CellContext`S[1, 2], 
      $CellContext`S[1, 2], 
      $CellContext`S[1, 3], 
      $CellContext`S[1, 1]}, "Label" -> "U"], 
    Q3`Gate[{
      $CellContext`A[1, Q3`$], 
      $CellContext`A[2, Q3`$]}, "Label" -> 
     "\!\(\*SuperscriptBox[\(V\), \(T\)]\)"], "Spacer", 
    Q3`Measurement[{
      $CellContext`A[1, 3], 
      $CellContext`A[2, 3]}], 
    Q3`PortOut[
     Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>]], 
    "Invisible" -> {
      $CellContext`A[
       Rational[5, 2]]}]]],ExpressionUUID->
  "ea8fb798-2ed1-4c10-bd84-399bb41549d1"],
 "=",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], 
      LineBox[{{{8, -1}, {9, -1}}, {{8, -2}, {9, -2}}}]}, 
     LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -4}, {9, -4}}}], {
      InsetBox[
       TemplateBox[{"0"},
        "Ket"], {-0.2, -1.}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {
       1, 0}], InsetBox[
       TemplateBox[{"0"},
        "Ket"], {-0.2, -2.}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {
       1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"V\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.044444444444444446`],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      LineBox[{{2, -1}, {2, -2}, {2, -4}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -1}, 0.09]}, 
      {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -2}, 0.09]}, 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "0"],
        StripOnInput->False,
        FontSize->Scaled[0.044444444444444446`],
        FontWeight->"Light",
        FontSlant->Italic], {2., -4.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      LineBox[{{3, -1}, {3, -2}, {3, -4}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{3, -1}, 0.09]}, 
      DiskBox[{3, -2}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "1"],
        StripOnInput->False,
        FontSize->Scaled[0.044444444444444446`],
        FontWeight->"Light",
        FontSlant->Italic], {3., -4.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      LineBox[{{4, -1}, {4, -2}, {4, -4}}], DiskBox[{4, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{4, -2}, 0.09]}, 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "2"],
        StripOnInput->False,
        FontSize->Scaled[0.044444444444444446`],
        FontWeight->"Light",
        FontSlant->Italic], {4., -4.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      LineBox[{{5, -1}, {5, -2}, {5, -4}}], DiskBox[{5, -1}, 0.09], 
      DiskBox[{5, -2}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "3"],
        StripOnInput->False,
        FontSize->Scaled[0.044444444444444446`],
        FontWeight->"Light",
        FontSlant->Italic], {5., -4.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{5.6, -2.4}, {6.4, -0.6}]}, InsetBox[
       StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(V\\), \\(T\\)]\\)\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.044444444444444446`],
        FontWeight->"Light",
        FontSlant->Italic], {6., -1.5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {{
       {GrayLevel[1], EdgeForm[Opacity[1]], 
        RectangleBox[{7.6, -1.4}, {8.4, -0.6}]}, 
       CircleBox[{8, -1.2}, 0.4, 
        NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
         2.6179938779914944`}]], LineBox[{{8, -1.2}, {8.24, -0.76}}]}, {
       {GrayLevel[1], EdgeForm[Opacity[1]], 
        RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, 
       CircleBox[{8, -2.2}, 0.4, 
        NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
         2.6179938779914944`}]], LineBox[{{8, -2.2}, {8.24, -1.76}}]}}, {
      InsetBox[
       TemplateBox[{"0"},
        "Ket"], {9.2, -1.}, NCache[
       ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {
       1, 0}], InsetBox[
       TemplateBox[{"0"},
        "Ket"], {9.2, -2.}, NCache[
       ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {
       1, 0}]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
    ImageSize->370.8,
    PlotRange->{{0, 9}, {-4.5, -0.5}},
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`PortIn[
     Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>]], 
    Q3`Gate[{
      $CellContext`A[1, Q3`$], 
      $CellContext`A[2, Q3`$]}, "Label" -> "V"], 
    Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0}, 
     $CellContext`S[1, 2], "Label" -> Subscript["U", 0], "Label" -> "U"], 
    Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      1}, 
     $CellContext`S[1, 2], "Label" -> Subscript["U", 1], "Label" -> "U"], 
    Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      0}, 
     $CellContext`S[1, 3], "Label" -> Subscript["U", 2], "Label" -> "U"], 
    Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
      1}, 
     $CellContext`S[1, 1], "Label" -> Subscript["U", 3], "Label" -> "U"], 
    Q3`Gate[{
      $CellContext`A[1, Q3`$], 
      $CellContext`A[2, Q3`$]}, "Label" -> 
     "\!\(\*SuperscriptBox[\(V\), \(T\)]\)"], "Spacer", 
    Q3`Measurement[{
      $CellContext`A[1, 3], 
      $CellContext`A[2, 3]}], 
    Q3`PortOut[
     Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>]], 
    "Invisible" -> {
      $CellContext`A[
       Rational[5, 2]]}]]],ExpressionUUID->
  "b3874dbf-c171-4d07-83e3-d3b9e40564a8"]
}], "Picture",
 CellID->2094833135,ExpressionUUID->"cd04241d-ec95-42fa-b452-0b030f36fe88"],

Cell[TextData[{
 StyleBox["Figure 1",
  FontWeight->"Bold"],
 ". A quantum circuit implementing the linear combination of unitary gates, \
",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "k"], 
    RowBox[{
     SubscriptBox["\[Alpha]", "k"], 
     SubscriptBox["U", "k"]}]}], TraditionalForm]],ExpressionUUID->
  "2b593465-f678-4fc3-a6fc-56fdfce06874"],
 ". Here, Here, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["V", "T"], TraditionalForm]],ExpressionUUID->
  "3ccea0df-d608-49e4-9368-623fb0e81def"],
 " is a unitary operator the matrix representation of which is given by the \
transpose of that of ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "3236d25b-371b-42ba-bfb1-e6f4b8c4752c"],
 " in the computational basis."
}], "TechNoteCaption",
 CellID->1051781767,ExpressionUUID->"11bd03a1-92de-456b-8253-3e9c5542629f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "TechNoteSection",
 CellID->2113806542,ExpressionUUID->"2e614a48-b7df-43ee-a9ac-86e03bc9e660"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuamtumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[50]:=",
 CellID->546965754,ExpressionUUID->"ac875c4e-7c9f-46cc-a05f-8165bc752959"],

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "A", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}]}], "Input",
 CellLabel->"In[51]:=",
 CellID->430885452,ExpressionUUID->"f6217ff4-bec7-4191-86ef-d8504ffc08cf"],

Cell[TextData[{
 "Consider a system register consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "cbccb719-bc36-4cc6-89f8-1fed3049e5b3"],
 " qubits."
}], "TechNoteMathCaption",
 CellID->1499619177,ExpressionUUID->"e49a5bf6-f9ae-416a-8c7e-55b36454c836"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellLabel->"In[53]:=",
 CellID->839037348,ExpressionUUID->"5281582e-11c5-426b-9bc6-3f5f34830f3e"],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   SubscriptBox["S", 
    TemplateBox[{",", "\",\"", "1"},
     "RowWithSeparators"]],
   $CellContext`S[1, Q3`$]], "}"}]], "Output",
 CellLabel->"Out[54]=",
 CellID->1509612144,ExpressionUUID->"91ab3a9c-8089-4554-bcf9-acd2ebdf70b0"]
}, Open  ]],

Cell[TextData[{
 "Take some unitary gates ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "k"], TraditionalForm]],ExpressionUUID->
  "16b1b48c-9508-41bd-a1a9-1d463508209a"],
 " (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"k", "=", "0"}], ",", "\[Ellipsis]", ",", 
     RowBox[{
      SuperscriptBox["2", "m"], "-", "1"}]}], ")"}], TraditionalForm]],
  ExpressionUUID->"362fc549-ed71-4aeb-b6cc-3fb8b421daea"],
 " on the system register."
}], "TechNoteMathCaption",
 CellID->1587367910,ExpressionUUID->"b73aaf1d-6c05-4742-ab61-75446207cd3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$m", "=", "2"}], ";"}]], "Input",
 CellLabel->"In[57]:=",
 CellID->1381591108,ExpressionUUID->"33e64549-0f75-48b7-b6b1-891a10152e6a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "[", "k_", "]"}], ":=", 
  RowBox[{"Rotation", "[", 
   RowBox[{
    RowBox[{"Pi", "*", 
     RowBox[{"k", "/", "6"}]}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"UU", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"U", "[", "k", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{
       RowBox[{"Range", "@", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", "$m"}], "]"}]}], "-", "1"}]}], "}"}]}], 
   "]"}]}]}], "Input",
 CellLabel->"In[58]:=",
 CellID->1361450766,ExpressionUUID->"7b709b41-7276-4b08-b02a-89b82ed362c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TagBox[
     RowBox[{"Exp", 
      RowBox[{"(", "0", ")"}]}],
     DisplayForm],
    Q3`Rotation[0, {0, 1, 0}, 
     $CellContext`S[1, Q3`$]]], ",", 
   InterpretationBox[
    TagBox[
     RowBox[{"Exp", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "12"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
          "Subsuperscript"],
         $CellContext`S[1, 2]]}], ")"}]}],
     DisplayForm],
    Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
     $CellContext`S[1, Q3`$]]], ",", 
   InterpretationBox[
    TagBox[
     RowBox[{"Exp", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "6"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
          "Subsuperscript"],
         $CellContext`S[1, 2]]}], ")"}]}],
     DisplayForm],
    Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
     $CellContext`S[1, Q3`$]]], ",", 
   InterpretationBox[
    TagBox[
     RowBox[{"Exp", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
          "Subsuperscript"],
         $CellContext`S[1, 2]]}], ")"}]}],
     DisplayForm],
    Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
     $CellContext`S[1, Q3`$]]]}], "}"}]], "Output",
 CellLabel->"Out[59]=",
 CellID->526104685,ExpressionUUID->"07d1758f-cfed-4283-9638-6170c1f076df"]
}, Open  ]],

Cell[TextData[{
 "We will need an ancilla register of ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "c4263c1c-517e-4b38-9792-6d753801bd0b"],
 " qubits."
}], "TechNoteMathCaption",
 CellID->225013878,ExpressionUUID->"38153f4a-d212-4aa2-b08b-97e269dc2e8b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AA", "=", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$m"}], ",", "$"}], "]"}]}]], "Input",
 CellLabel->"In[60]:=",
 CellID->576934080,ExpressionUUID->"3ce1506a-faa3-41ac-a5a9-01465decb479"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["A", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`A[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["A", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`A[2, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[60]=",
 CellID->1319205668,ExpressionUUID->"2dfd5444-1af1-4984-8c12-ff67dfb2293f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simple Sum", "Subsection",
 CellID->1973147550,ExpressionUUID->"70fef44e-32f0-4824-aa3f-2ffb81b3f2af"],

Cell[TextData[{
 "Consider the sum ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", ":=", 
    RowBox[{
     SubscriptBox["\[Sum]", "k"], 
     SubscriptBox["U", "k"]}]}], TraditionalForm]],ExpressionUUID->
  "af94415e-77e2-48f0-8adb-e4176326fe56"],
 " of the unitary gates."
}], "TechNoteMathCaption",
 CellID->1846260513,ExpressionUUID->"3780eddb-d653-43f3-8400-b2501e5d5e23"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TT", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"U", "[", "k", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[62]:=",
 CellID->740865323,ExpressionUUID->"d95633c7-9543-4fbb-91b9-08f93d149ab4"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    RowBox[{"Exp", 
     RowBox[{"(", "0", ")"}]}],
    DisplayForm],
   Q3`Rotation[0, {0, 1, 0}, 
    $CellContext`S[1, Q3`$]]], "+", 
  InterpretationBox[
   TagBox[
    RowBox[{"Exp", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "12"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
         "Subsuperscript"],
        $CellContext`S[1, 2]]}], ")"}]}],
    DisplayForm],
   Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
    $CellContext`S[1, Q3`$]]], "+", 
  InterpretationBox[
   TagBox[
    RowBox[{"Exp", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "6"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
         "Subsuperscript"],
        $CellContext`S[1, 2]]}], ")"}]}],
    DisplayForm],
   Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
    $CellContext`S[1, Q3`$]]], "+", 
  InterpretationBox[
   TagBox[
    RowBox[{"Exp", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
         "Subsuperscript"],
        $CellContext`S[1, 2]]}], ")"}]}],
    DisplayForm],
   Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
    $CellContext`S[1, Q3`$]]]}]], "Output",
 CellLabel->"Out[62]=",
 CellID->1186808524,ExpressionUUID->"e4d7b4fe-785d-436f-a3c4-539ab87eaaf8"]
}, Open  ]],

Cell[TextData[{
 "In general, ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "335678db-8f55-4cfc-95eb-05408d11fdeb"],
 " is not unitary, and cannot be directly implemented on a quantum computer. \
However, one can realize it probabilistically with a quantum circuit of the \
form and post-selection with respect to the ancilla register for state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{"00", "\[Ellipsis]0"}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "936ccb4a-f9ea-4f60-aa46-765c9cd5e192"],
 "."
}], "TechNoteMathCaption",
 CellID->47470155,ExpressionUUID->"bf43ab6c-f6b1-4d66-bb8c-7b8fd3b437a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", "AA", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Through", "[", 
     RowBox[{"AA", "[", "6", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"UniformlyControlledGate", "[", 
     RowBox[{"AA", ",", "UU", ",", 
      RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Through", "[", 
     RowBox[{"AA", "[", "6", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"A", "[", 
      RowBox[{"$m", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[63]:=",
 CellID->260210010,ExpressionUUID->"44710695-bfe6-4534-afc9-bd123e361627"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -4}, {4, -4}}}], {
     InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -2}, {2, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -1}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -1}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -2}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -2}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"\[Ellipsis]\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>]], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, 
   Q3`UniformlyControlledGate[{
     $CellContext`A[1, Q3`$], 
     $CellContext`A[2, Q3`$]}, {
     Q3`Rotation[0, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]], 
     Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]], 
     Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]], 
     Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]]}, "Label" -> "U"], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, "Invisible" -> $CellContext`A[
     Rational[5, 2]]]]], "Output",
 CellLabel->"Out[63]=",
 CellID->1964444323,ExpressionUUID->"81da14da-3009-4c95-8866-cd5c5fc719f8"]
}, Open  ]],

Cell["\<\
The above quantum circuit is, of course, equivalent to the following one.\
\>", "TechNoteMathCaption",
 CellID->1302929911,ExpressionUUID->"eeddda81-f450-4b9c-b8d3-31f479942f64"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", "qc", "]"}]], "Input",
 CellLabel->"In[64]:=",
 CellID->418097618,ExpressionUUID->"4d29b768-19bf-46c8-9f92-03e1f6410dfb"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -4}, {7, -4}}}], {
     InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -2}, {2, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -1}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "0"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -1}, {3, -2}, {3, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{3, -1}, 0.09]}, 
     DiskBox[{3, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "1"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -2}, {4, -4}}], 
     DiskBox[{4, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{4, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {4., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -1}, {5, -2}, {5, -4}}], 
     DiskBox[{5, -1}, 0.09], DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {6., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {6., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->298.8,
   PlotRange->{{0, 7}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>]], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, 
   Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     0}, 
    Q3`Rotation[0, {0, 1, 0}, 
     $CellContext`S[1, Q3`$]], "Label" -> Subscript["U", 0], "Label" -> "U"], 
   
   Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
     1}, 
    Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
     $CellContext`S[1, Q3`$]], "Label" -> Subscript["U", 1], "Label" -> "U"], 
   
   Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     0}, 
    Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
     $CellContext`S[1, Q3`$]], "Label" -> Subscript["U", 2], "Label" -> "U"], 
   
   Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
     1}, 
    Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
     $CellContext`S[1, Q3`$]], "Label" -> Subscript["U", 3], "Label" -> "U"], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, "Invisible" -> $CellContext`A[
     Rational[5, 2]]]]], "Output",
 CellLabel->"Out[64]=",
 CellID->171877833,ExpressionUUID->"4f3403a6-4ca0-453c-969f-64079200a1e4"]
}, Open  ]],

Cell["To test  it, take an arbitrary input state.", "TechNoteMathCaption",
 CellID->196018039,ExpressionUUID->"ee21c24c-32de-44ff-8d1e-b58c488778c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"ProductState", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], "->", 
     RowBox[{"c", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}]}], ",", 
    RowBox[{"\"\<Label\>\"", "->", 
     RowBox[{"Ket", "@", 
      RowBox[{"{", "\"\<\[Psi]\>\"", "}"}]}]}]}], "]"}]}]], "Input",
 CellLabel->"In[76]:=",
 CellID->164075254,ExpressionUUID->"9ad6d17f-a724-4d17-bf5a-a8dc580d431d"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]], " ", 
       TemplateBox[{"0"},
        "Ket"]}], "+", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`c[1]], " ", 
       TemplateBox[{"1"},
        "Ket"]}]}], ")"}], 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`S[1, Q3`$]]],
   DisplayForm],
  Q3`ProductState[<|$CellContext`S[1, Q3`$] -> {
      $CellContext`c[0], 
      $CellContext`c[1]}|>, "Label" -> Ket[{"\[Psi]"}]]]], "Output",
 CellLabel->"Out[76]=",
 CellID->1149233402,ExpressionUUID->"5c2d3eff-80c9-454d-b6a3-e8de7781f337"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"full", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"in", ",", "qc"}], "]"}]}]], "Input",
 CellLabel->"In[77]:=",
 CellID->1764537993,ExpressionUUID->"e3e55b09-82db-466a-9bb8-e7ba67a441fe"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -4}, {4, -4}}}], 
    InsetBox[
     TemplateBox[{"\"\[Psi]\""},
      "Ket"], {-0.2, -4.}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1, 
     0}], {InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -2}, {2, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -1}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -1}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -2}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -2}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"\[Ellipsis]\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`PortIn[
    Q3`ProductState[<|$CellContext`S[1, Q3`$] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}|>, "Label" -> Ket[{"\[Psi]"}]], 
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>]], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, 
   Q3`UniformlyControlledGate[{
     $CellContext`A[1, Q3`$], 
     $CellContext`A[2, Q3`$]}, {
     Q3`Rotation[0, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]], 
     Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]], 
     Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]], 
     Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]]}, "Label" -> "U"], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, "Invisible" -> $CellContext`A[
     Rational[5, 2]]]]], "Output",
 CellLabel->"Out[77]=",
 CellID->957740053,ExpressionUUID->"c1ca2a9d-d9a1-42d8-a54a-03efb82f6ebf"]
}, Open  ]],

Cell[TextData[{
 "Take the projection operator onto ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{"00", "\[Ellipsis]0"}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "39c630e7-7514-4019-9352-70667077bc0c"],
 "."
}], "TechNoteMathCaption",
 CellID->1459936136,ExpressionUUID->"4485e10e-205c-4b45-84c3-deb7135db702"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prj", "=", 
  RowBox[{"Dyad", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "AA", "]"}], ",", 
    RowBox[{"Ket", "[", "AA", "]"}], ",", "AA"}], "]"}]}]], "Input",
 CellLabel->"In[78]:=",
 CellID->2013398190,ExpressionUUID->"98fdf658-b565-4cbe-aab6-b02ba36e92c4"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["A", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`A[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["A", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`A[2, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]}, "Ket"], 
     Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>]], 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["A", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`A[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["A", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`A[2, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]}, "Bra"], 
     Bra[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>]]},
   "RowDefault"],
  Q3`Dyad[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
    0|>, <|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
    0|>]]], "Output",
 CellLabel->"Out[78]=",
 CellID->1564799294,ExpressionUUID->"b0fc4b0e-334f-44e0-be13-c782e1e8129f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"out", "=", 
  RowBox[{"prj", "**", "full"}]}], "\[IndentingNewLine]", 
 RowBox[{"out", "=", 
  RowBox[{"KetCanonical", "@", 
   RowBox[{"KetDrop", "[", 
    RowBox[{"out", ",", "AA"}], "]"}]}]}]}], "Input",
 CellLabel->"In[79]:=",
 CellID->1512371685,ExpressionUUID->"471e87fb-44c6-4f23-ab4d-5c555498a796"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "+", 
        RowBox[{"3", " ", 
         SqrtBox["2"]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}], "+", 
        SqrtBox["6"]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`c[0]]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SqrtBox["2"], "+", 
        SqrtBox["6"]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`S[1, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SqrtBox["2"], "+", 
        SqrtBox["6"]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`c[0]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "+", 
        RowBox[{"3", " ", 
         SqrtBox["2"]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}], "+", 
        SqrtBox["6"]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
      0, $CellContext`S[1, Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[79]=",
 CellID->2080681408,ExpressionUUID->"507a67c2-9c29-4797-93e5-2a5fe746a325"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SqrtBox["2"], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "+", 
         RowBox[{"3", " ", 
          SqrtBox["2"]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["3"]}], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`c[1]]}]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", "+", 
       RowBox[{"3", " ", 
        SqrtBox["2"]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox["3"]}], "+", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`c[0]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       SqrtBox["2"], "+", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]]}]}]]}]], "Output",
 CellLabel->"Out[80]=",
 CellID->388716508,ExpressionUUID->"516b4960-fdca-4a1c-bd49-8622079efa1f"]
}, Open  ]],

Cell[TextData[{
 "Compare the above result with the direct operation of ",
 StyleBox["T",
  FontSlant->"Italic"],
 " on the input state."
}], "TechNoteMathCaption",
 CellID->1926262569,ExpressionUUID->"f05971e4-411a-4c1f-97b8-6d1d3f0f4fe4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Elaborate", "@", 
   RowBox[{"KetCanonical", "[", 
    RowBox[{"T", "**", "in"}], "]"}]}]}]], "Input",
 CellLabel->"In[81]:=",
 CellID->550906173,ExpressionUUID->"f58a9b11-27f7-42d4-bc09-965e3842961c"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SqrtBox["2"], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "+", 
         RowBox[{"3", " ", 
          SqrtBox["2"]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["3"]}], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`c[1]]}]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", "+", 
       RowBox[{"3", " ", 
        SqrtBox["2"]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox["3"]}], "+", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`c[0]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       SqrtBox["2"], "+", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]]}]}]]}]], "Output",
 CellLabel->"Out[81]=",
 CellID->1309557227,ExpressionUUID->"2974a5e3-e186-4daf-be46-4831229644e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "-", "new"}]], "Input",
 CellLabel->"In[82]:=",
 CellID->209695444,ExpressionUUID->"2aea083b-8ae8-4c94-b34b-8bd7f2a0611b"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[82]=",
 CellID->132995768,ExpressionUUID->"cb7eb963-f732-4251-ad9f-91189e6dbaf2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear Superposition", "Subsection",
 CellID->1004589932,ExpressionUUID->"74cd9794-6b76-4118-9d65-5e5693536700"],

Cell[TextData[{
 "Let us now consider a more general form of linear combination ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", ":=", 
    RowBox[{
     SubscriptBox["\[Sum]", "k"], 
     RowBox[{
      SubscriptBox["\[Alpha]", "k"], 
      SubscriptBox["U", "k"]}]}]}], TraditionalForm]],ExpressionUUID->
  "c4716883-e9fa-465f-a559-7d3ace92b219"],
 " of the unitary gates."
}], "TechNoteMathCaption",
 CellID->996657064,ExpressionUUID->"51d82cb7-0756-448f-a3f2-818f0ded25da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Alpha]", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", 
    RowBox[{"1", "/", "2"}], ",", 
    RowBox[{"-", "I"}], ",", 
    RowBox[{
     RowBox[{"-", "I"}], "/", "2"}]}], "}"}]}]], "Input",
 CellLabel->"In[246]:=",
 CellID->1658219594,ExpressionUUID->"6cec52dd-3881-48f0-9d6b-aa4513e218dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["1", "2"], ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", "2"]}]}], "}"}]], "Output",
 CellLabel->"Out[246]=",
 CellID->1870746279,ExpressionUUID->"d245a298-0f4d-441c-8127-ab7db71c92ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TT", "=", 
  RowBox[{"\[Alpha]", ".", "UU"}]}]], "Input",
 CellLabel->"In[247]:=",
 CellID->75389019,ExpressionUUID->"57efd43a-0491-4768-849c-e7ba1346adf9"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    RowBox[{"Exp", 
     RowBox[{"(", "0", ")"}]}],
    DisplayForm],
   Q3`Rotation[0, {0, 1, 0}, 
    $CellContext`S[1, Q3`$]]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    InterpretationBox[
     TagBox[
      RowBox[{"Exp", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "12"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
           "Subsuperscript"],
          $CellContext`S[1, 2]]}], ")"}]}],
      DisplayForm],
     Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]]], ")"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    InterpretationBox[
     TagBox[
      RowBox[{"Exp", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "6"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
           "Subsuperscript"],
          $CellContext`S[1, 2]]}], ")"}]}],
      DisplayForm],
     Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]]], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    InterpretationBox[
     TagBox[
      RowBox[{"Exp", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
           "Subsuperscript"],
          $CellContext`S[1, 2]]}], ")"}]}],
      DisplayForm],
     Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
      $CellContext`S[1, Q3`$]]], ")"}]}]}]], "Output",
 CellLabel->"Out[247]=",
 CellID->2065718548,ExpressionUUID->"c8039f64-65c5-4d62-9ca7-ef4e709a332d"]
}, Open  ]],

Cell[TextData[{
 "We fist construct the so-called ",
 StyleBox["preparation oracles",
  FontSlant->"Italic"],
 ", ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "a6635bed-a8ac-4403-ae09-91033f5d6519"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["V", "T"], TraditionalForm]],ExpressionUUID->
  "b856e085-bba7-4914-9134-4fc2bae07505"]
}], "TechNoteMathCaption",
 CellID->163515187,ExpressionUUID->"4e29bfac-5a94-4098-ae73-9d7fe4f42c07"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matV", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"One", "[", 
     RowBox[{"Power", "[", 
      RowBox[{"2", ",", "$m"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matV", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"N", "@", "\[Alpha]"}], "]"}], "/", 
    RowBox[{"Norm", "[", 
     RowBox[{"\[Alpha]", ",", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matV", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Chop", "@", 
     RowBox[{"Orthogonalize", "@", "matV"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"matV", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[273]:=",
 CellID->1103004868,ExpressionUUID->"bd3aaf52-482b-44df-ae66-ca8e6bf83e36"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5773502691896258`", 
      RowBox[{"-", "0.2581988897471611`"}], 
      RowBox[{
       RowBox[{"-", "0.36514837167011077`"}], "-", 
       RowBox[{"0.36514837167011077`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4082482904638631`"}], "-", 
       RowBox[{"0.4082482904638631`", " ", "\[ImaginaryI]"}]}]},
     {"0.40824829046386313`", "0.9128709291752768`", "0", "0"},
     {
      RowBox[{"0.40824829046386313`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.40824829046386313`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.18257418583505539`"}], "+", 
       RowBox[{"0.18257418583505539`", " ", "\[ImaginaryI]"}]}], 
      "0.7745966692414834`", "0"},
     {
      RowBox[{"0.2886751345948129`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2886751345948129`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.12909944487358055`"}], "+", 
       RowBox[{"0.12909944487358055`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.36514837167011077`"}], "0.8164965809277261`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[276]//MatrixForm=",
 CellID->39104677,ExpressionUUID->"ada325d7-e683-417e-9248-7a2f48199f93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"matV", ".", 
    RowBox[{"Topple", "[", "matV", "]"}]}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[277]:=",
 CellID->1455841953,ExpressionUUID->"03cbf777-94d9-4a60-88dd-9522a4a4e7ad"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.0000000000000002`", "0", "0", "0"},
     {"0", "1.`", "0", "0"},
     {"0", "0", "1.0000000000000004`", "0"},
     {"0", "0", "0", "1.0000000000000002`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[277]//MatrixForm=",
 CellID->1578798180,ExpressionUUID->"7a9f29a1-eaa5-43f0-ab35-a7f9ee62e930"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"VV", "=", 
  RowBox[{"Operator", "[", 
   RowBox[{"matV", ",", "AA", ",", 
    RowBox[{"\"\<Label\>\"", "->", "\"\<V\>\""}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"VT", "=", 
  RowBox[{"Operator", "[", 
   RowBox[{
    RowBox[{"Transpose", "@", "matV"}], ",", "AA", ",", 
    RowBox[{"\"\<Label\>\"", 
     "->", "\"\<\!\(\*SuperscriptBox[\(V\), \(T\)]\)\>\""}]}], 
   "]"}]}]}], "Input",
 CellLabel->"In[278]:=",
 CellID->591283205,ExpressionUUID->"22bd328c-db1c-4f4f-b945-0a82a37d037a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["Operator",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Species: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Species: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Matrix (5\[Times]5): \"", "SummaryItemAnnotation"],
                  "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0.5773502691896258`", 
                    RowBox[{"-", "0.2581988897471611`"}], 
                    RowBox[{
                    RowBox[{"-", "0.36514837167011077`"}], "-", 
                    RowBox[{"0.36514837167011077`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.4082482904638631`"}], "-", 
                    
                    RowBox[{
                    "0.4082482904638631`", " ", "\[ImaginaryI]"}]}]}, {
                    "0.40824829046386313`", "0.9128709291752768`", "0", "0"}, {
                    RowBox[{
                    RowBox[{"0.40824829046386313`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.40824829046386313`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.18257418583505539`"}], "+", 
                    RowBox[{"0.18257418583505539`", " ", "\[ImaginaryI]"}]}], 
                    "0.7745966692414834`", "0"}, {
                    RowBox[{
                    RowBox[{"0.2886751345948129`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.2886751345948129`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.12909944487358055`"}], "+", 
                    RowBox[{"0.12909944487358055`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{"-", "0.36514837167011077`"}], 
                    "0.8164965809277261`"}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$]]], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Options: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"\"Label\"", "\[Rule]", "\"V\""}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`Operator[{{0.5773502691896258, -0.2581988897471611, 
     Complex[-0.36514837167011077`, -0.36514837167011077`], 
     Complex[-0.4082482904638631, -0.4082482904638631]}, {
    0.40824829046386313`, 0.9128709291752768, 0, 0}, {
     Complex[0.40824829046386313`, -0.40824829046386313`], 
     Complex[-0.18257418583505539`, 0.18257418583505539`], 0.7745966692414834,
      0}, {
     Complex[0.2886751345948129, -0.2886751345948129], 
     Complex[-0.12909944487358055`, 
      0.12909944487358055`], -0.36514837167011077`, 0.8164965809277261}}, {
    $CellContext`A[1, Q3`$], 
    $CellContext`A[2, Q3`$]}, "Label" -> "V"],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[278]=",
 CellID->1696427632,ExpressionUUID->"16999950-a4d4-4cec-a88c-5530e6571a3a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["Operator",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Species: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Species: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Matrix (5\[Times]5): \"", "SummaryItemAnnotation"],
                  "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0.5773502691896258`", "0.40824829046386313`", 
                    RowBox[{
                    RowBox[{"0.40824829046386313`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.40824829046386313`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.2886751345948129`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.2886751345948129`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{"-", "0.2581988897471611`"}], 
                    "0.9128709291752768`", 
                    RowBox[{
                    RowBox[{"-", "0.18257418583505539`"}], "+", 
                    RowBox[{"0.18257418583505539`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.12909944487358055`"}], "+", 
                    
                    RowBox[{
                    "0.12909944487358055`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.36514837167011077`"}], "-", 
                    RowBox[{"0.36514837167011077`", " ", "\[ImaginaryI]"}]}], 
                    "0", "0.7745966692414834`", 
                    RowBox[{"-", "0.36514837167011077`"}]}, {
                    RowBox[{
                    RowBox[{"-", "0.4082482904638631`"}], "-", 
                    RowBox[{"0.4082482904638631`", " ", "\[ImaginaryI]"}]}], 
                    "0", "0", "0.8164965809277261`"}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$]]], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Options: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "\"Label\"", "\[Rule]", 
                    "\"\\!\\(\\*SuperscriptBox[\\(V\\), \\(T\\)]\\)\""}], 
                    "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`Operator[{{0.5773502691896258, 0.40824829046386313`, 
     Complex[0.40824829046386313`, -0.40824829046386313`], 
     Complex[0.2886751345948129, -0.2886751345948129]}, {-0.2581988897471611, 
     0.9128709291752768, 
     Complex[-0.18257418583505539`, 0.18257418583505539`], 
     Complex[-0.12909944487358055`, 0.12909944487358055`]}, {
     Complex[-0.36514837167011077`, -0.36514837167011077`], 0, 
     0.7745966692414834, -0.36514837167011077`}, {
     Complex[-0.4082482904638631, -0.4082482904638631], 0, 0, 
     0.8164965809277261}}, {
    $CellContext`A[1, Q3`$], 
    $CellContext`A[2, Q3`$]}, "Label" -> 
   "\!\(\*SuperscriptBox[\(V\), \(T\)]\)"],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[279]=",
 CellID->1866313452,ExpressionUUID->"adabd095-fc91-4204-a3a2-4a45057ad04c"]
}, Open  ]],

Cell[TextData[{
 "Construct the so-called selection oracle, ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],ExpressionUUID->
  "1aacb787-d9db-4e30-b582-3c7667b77608"],
 ", which is just given by the uniformly-controlled gate."
}], "TechNoteMathCaption",
 CellID->250193288,ExpressionUUID->"1882fd51-281f-440c-a751-a37d47e37792"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WW", "=", 
  RowBox[{"UniformlyControlledGate", "[", 
   RowBox[{"AA", ",", "UU", ",", 
    RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}]}]], "Input",
 CellLabel->"In[283]:=",
 CellID->419092567,ExpressionUUID->"3d193a57-2835-4919-b04d-56e3bd35bb67"],

Cell[BoxData[
 RowBox[{"UniformlyControlledGate", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["A", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`A[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["A", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`A[2, Q3`$]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      TagBox[
       RowBox[{"Exp", 
        RowBox[{"(", "0", ")"}]}],
       DisplayForm],
      Q3`Rotation[0, {0, 1, 0}, 
       $CellContext`S[1, Q3`$]]], ",", 
     InterpretationBox[
      TagBox[
       RowBox[{"Exp", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "12"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
          
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
            "Subsuperscript"],
           $CellContext`S[1, 2]]}], ")"}]}],
       DisplayForm],
      Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
       $CellContext`S[1, Q3`$]]], ",", 
     InterpretationBox[
      TagBox[
       RowBox[{"Exp", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "6"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
            "Subsuperscript"],
           $CellContext`S[1, 2]]}], ")"}]}],
       DisplayForm],
      Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
       $CellContext`S[1, Q3`$]]], ",", 
     InterpretationBox[
      TagBox[
       RowBox[{"Exp", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
            "Subsuperscript"],
           $CellContext`S[1, 2]]}], ")"}]}],
       DisplayForm],
      Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
       $CellContext`S[1, Q3`$]]]}], "}"}], ",", 
   RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}]], "Output",
 CellLabel->"Out[283]=",
 CellID->1546029524,ExpressionUUID->"8d2561ac-948a-42f3-93f1-87f417428ea3"]
}, Open  ]],

Cell["Take the overall quantum circuit.", "TechNoteMathCaption",
 CellID->1713564815,ExpressionUUID->"1e8bd4b5-5036-46e7-b0c0-310cb90b6958"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qc", "=", 
   RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ket", "[", "AA", "]"}], ",", "in", ",", "\[IndentingNewLine]", 
     "VV", ",", "WW", ",", "VT", ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Invisible\>\"", "->", 
      RowBox[{"A", "@", 
       RowBox[{"{", 
        RowBox[{"$m", "+", 
         RowBox[{"1", "/", "2"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "@", 
  RowBox[{"{", 
   RowBox[{"qc", ",", "\"\<=\>\"", ",", 
    RowBox[{"Expand", "[", "qc", "]"}]}], "}"}]}]}], "Input",
 CellLabel->"In[284]:=",
 CellID->866928573,ExpressionUUID->"37672fb6-e15c-4c49-8fc5-5950c707b17d"],

Cell[BoxData[
 TemplateBox[{
   InterpretationBox[
    GraphicsBox[{{
       Dashing[{Small, Small}], 
       LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -4}, {4, -4}}}], {
      
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"0"}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -1.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}], 
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"0"}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -2.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}]}, {
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"\"\[Psi]\""}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -4.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}]}, {{
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
         "\"V\"", {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.1]}, StripOnInput -> False], TraditionalForm], {1., -1.5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{2, -1}, {2, -2}, {2, -4}}], {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        DiskBox[{2, -1}, 0.09, 
         NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
          3.9269908169872414`}]], 
        GrayLevel[0], 
        DiskBox[{2, -1}, 0.09, 
         NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
          0.7853981633974483}]]}, {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        DiskBox[{2, -2}, 0.09, 
         NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
          3.9269908169872414`}]], 
        GrayLevel[0], 
        DiskBox[{2, -2}, 0.09, 
         NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
          0.7853981633974483}]]}, {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
          SubscriptBox["\"U\"", "\"\[Ellipsis]\""], {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.1]}, StripOnInput -> False], TraditionalForm], {2., -4.}, 
        
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {{
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
         "\"\\!\\(\\*SuperscriptBox[\\(V\\), \\(T\\)]\\)\"", {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.1]}, StripOnInput -> False], TraditionalForm], {3., -1.5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {}, 
     PlotRange -> {{0, 4}, {-4.5, -0.5}}, 
     ImagePadding -> {{25.56, 25.56}, {7.2, 7.2}}, ImageSize -> 
     190.79999999999998`, AxesStyle -> Large, FrameStyle -> Large, ImageSize -> 
     Large, PlotRangePadding -> Scaled[0.025]], 
    Q3`QuantumCircuit[
     Q3`PortIn[
      Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>], 
      Q3`ProductState[<|$CellContext`S[1, Q3`$] -> {
          $CellContext`c[0], 
          $CellContext`c[1]}|>, "Label" -> Ket[{"\[Psi]"}]]], 
     Q3`Operator[{{0.5773502691896258, -0.2581988897471611, 
        Complex[-0.36514837167011077`, -0.36514837167011077`], 
        Complex[-0.4082482904638631, -0.4082482904638631]}, {
       0.40824829046386313`, 0.9128709291752768, 0, 0}, {
        Complex[0.40824829046386313`, -0.40824829046386313`], 
        Complex[-0.18257418583505539`, 0.18257418583505539`], 
        0.7745966692414834, 0}, {
        Complex[0.2886751345948129, -0.2886751345948129], 
        Complex[-0.12909944487358055`, 
         0.12909944487358055`], -0.36514837167011077`, 
        0.8164965809277261}}, {
       $CellContext`A[1, Q3`$], 
       $CellContext`A[2, Q3`$]}, "Label" -> "V"], 
     Q3`UniformlyControlledGate[{
       $CellContext`A[1, Q3`$], 
       $CellContext`A[2, Q3`$]}, {
       Q3`Rotation[0, {0, 1, 0}, 
        $CellContext`S[1, Q3`$]], 
       Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
        $CellContext`S[1, Q3`$]], 
       Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
        $CellContext`S[1, Q3`$]], 
       Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
        $CellContext`S[1, Q3`$]]}, "Label" -> "U"], 
     Q3`Operator[{{0.5773502691896258, 0.40824829046386313`, 
        Complex[0.40824829046386313`, -0.40824829046386313`], 
        Complex[
        0.2886751345948129, -0.2886751345948129]}, {-0.2581988897471611, 
        0.9128709291752768, 
        Complex[-0.18257418583505539`, 0.18257418583505539`], 
        Complex[-0.12909944487358055`, 0.12909944487358055`]}, {
        Complex[-0.36514837167011077`, -0.36514837167011077`], 0, 
        0.7745966692414834, -0.36514837167011077`}, {
        Complex[-0.4082482904638631, -0.4082482904638631], 0, 0, 
        0.8164965809277261}}, {
       $CellContext`A[1, Q3`$], 
       $CellContext`A[2, Q3`$]}, "Label" -> 
      "\!\(\*SuperscriptBox[\(V\), \(T\)]\)"], "Invisible" -> {
       $CellContext`A[
        Rational[5, 2]]}]], "\"=\"", 
   InterpretationBox[
    GraphicsBox[{{
       Dashing[{Small, Small}], 
       LineBox[{}]}, 
      LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -4}, {7, -4}}}], {
      
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"0"}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -1.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}], 
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"0"}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -2.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}]}, {
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"\"\[Psi]\""}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -4.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}]}, {{
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
         "\"V\"", {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {1., -1.5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{2, -1}, {2, -2}, {2, -4}}], {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        DiskBox[{2, -1}, 0.09]}, {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        DiskBox[{2, -2}, 0.09]}, {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
          SubscriptBox["\"U\"", "0"], {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {2., -4.}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{3, -1}, {3, -2}, {3, -4}}], {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        DiskBox[{3, -1}, 0.09]}, 
       DiskBox[{3, -2}, 0.09], {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
          SubscriptBox["\"U\"", "1"], {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {3., -4.}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{4, -1}, {4, -2}, {4, -4}}], 
       DiskBox[{4, -1}, 0.09], {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        DiskBox[{4, -2}, 0.09]}, {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
          SubscriptBox["\"U\"", "2"], {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {4., -4.}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{5, -1}, {5, -2}, {5, -4}}], 
       DiskBox[{5, -1}, 0.09], 
       DiskBox[{5, -2}, 0.09], {
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
          SubscriptBox["\"U\"", "3"], {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {5., -4.}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {{
        EdgeForm[
         Opacity[1]], 
        GrayLevel[1], 
        RectangleBox[{5.6, -2.4}, {6.4, -0.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
         "\"\\!\\(\\*SuperscriptBox[\\(V\\), \\(T\\)]\\)\"", {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {6., -1.5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {}, 
     PlotRange -> {{0, 7}, {-4.5, -0.5}}, 
     ImagePadding -> {{25.56, 25.56}, {7.2, 7.2}}, ImageSize -> 298.8, 
     AxesStyle -> Large, FrameStyle -> Large, ImageSize -> Large, 
     PlotRangePadding -> Scaled[0.025]], 
    Q3`QuantumCircuit[
     Q3`PortIn[
      Ket[<|$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 0|>], 
      Q3`ProductState[<|$CellContext`S[1, Q3`$] -> {
          $CellContext`c[0], 
          $CellContext`c[1]}|>, "Label" -> Ket[{"\[Psi]"}]]], 
     Q3`Operator[{{0.5773502691896258, -0.2581988897471611, 
        Complex[-0.36514837167011077`, -0.36514837167011077`], 
        Complex[-0.4082482904638631, -0.4082482904638631]}, {
       0.40824829046386313`, 0.9128709291752768, 0, 0}, {
        Complex[0.40824829046386313`, -0.40824829046386313`], 
        Complex[-0.18257418583505539`, 0.18257418583505539`], 
        0.7745966692414834, 0}, {
        Complex[0.2886751345948129, -0.2886751345948129], 
        Complex[-0.12909944487358055`, 
         0.12909944487358055`], -0.36514837167011077`, 
        0.8164965809277261}}, {
       $CellContext`A[1, Q3`$], 
       $CellContext`A[2, Q3`$]}, "Label" -> "V"], 
     Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
       0}, 
      Q3`Rotation[0, {0, 1, 0}, 
       $CellContext`S[1, Q3`$]], "Label" -> Subscript["U", 0], "Label" -> 
      "U"], 
     Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 0, $CellContext`A[2, Q3`$] -> 
       1}, 
      Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
       $CellContext`S[1, Q3`$]], "Label" -> Subscript["U", 1], "Label" -> 
      "U"], 
     Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
       0}, 
      Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
       $CellContext`S[1, Q3`$]], "Label" -> Subscript["U", 2], "Label" -> 
      "U"], 
     Q3`ControlledGate[{$CellContext`A[1, Q3`$] -> 1, $CellContext`A[2, Q3`$] -> 
       1}, 
      Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
       $CellContext`S[1, Q3`$]], "Label" -> Subscript["U", 3], "Label" -> 
      "U"], 
     Q3`Operator[{{0.5773502691896258, 0.40824829046386313`, 
        Complex[0.40824829046386313`, -0.40824829046386313`], 
        Complex[
        0.2886751345948129, -0.2886751345948129]}, {-0.2581988897471611, 
        0.9128709291752768, 
        Complex[-0.18257418583505539`, 0.18257418583505539`], 
        Complex[-0.12909944487358055`, 0.12909944487358055`]}, {
        Complex[-0.36514837167011077`, -0.36514837167011077`], 0, 
        0.7745966692414834, -0.36514837167011077`}, {
        Complex[-0.4082482904638631, -0.4082482904638631], 0, 0, 
        0.8164965809277261}}, {
       $CellContext`A[1, Q3`$], 
       $CellContext`A[2, Q3`$]}, "Label" -> 
      "\!\(\*SuperscriptBox[\(V\), \(T\)]\)"], "Invisible" -> {
       $CellContext`A[
        Rational[5, 2]]}]]},
  "RowDefault"]], "Output",
 CellLabel->"Out[285]=",
 CellID->163474990,ExpressionUUID->"3d0fd232-0c4b-4a29-a63c-8b8be4fd547c"]
}, Open  ]],

Cell["Calculate the output state, and perform the post-selection.", \
"TechNoteMathCaption",
 CellID->1735772354,ExpressionUUID->"bae11d38-cde4-4d5b-8cc4-77b9e89a79ed"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"prj", "**", "qc"}], "//", "KetChop"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "=", 
  RowBox[{"KetCanonical", "@", 
   RowBox[{"KetDrop", "[", 
    RowBox[{"out", ",", "AA"}], "]"}]}]}]}], "Input",
 CellLabel->"In[286]:=",
 CellID->907370804,ExpressionUUID->"c5c8cf54-1d2f-4891-b1cd-2014a7e29c49"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.334427759521011`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.30054182938744944`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "-", 
         RowBox[{"5.551115123125783`*^-17", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`c[1]]}]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}], 
   RowBox[{
    RowBox[{"1.`", " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`c[0]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.334427759521011`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.30054182938744944`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]]}]}]]}]], "Output",
 CellLabel->"Out[287]=",
 CellID->1122015419,ExpressionUUID->"436cd3ef-e181-4477-8ece-e0e768863d14"]
}, Open  ]],

Cell[TextData[{
 "Compare the result above with the one from directly applying ",
 StyleBox["T",
  FontSlant->"Italic"],
 " on the input state."
}], "TechNoteMathCaption",
 CellID->170046271,ExpressionUUID->"289fe45f-4274-434a-aec7-5125e7e33972"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Elaborate", "@", 
   RowBox[{"KetCanonical", "[", 
    RowBox[{"TT", "**", "in"}], "]"}]}]}]], "Input",
 CellLabel->"In[289]:=",
 CellID->1809121102,ExpressionUUID->"0571b27b-2d3e-4cc4-bc91-5e812b5af5f9"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0|>]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "\[ImaginaryI]"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          SqrtBox["2"]}], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"8", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          SqrtBox["2"]}], "-", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", 
          SqrtBox["3"]}], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`c[1]]}]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1|>]]}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"8", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        SqrtBox["2"]}], "-", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "+", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`c[0]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "\[ImaginaryI]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        SqrtBox["2"]}], "-", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]]}]}]]}]], "Output",
 CellLabel->"Out[289]=",
 CellID->1621781676,ExpressionUUID->"242ed0dc-3428-494e-b8ef-cc031194529f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"out", "-", "new"}], "//", "Garner"}], "//", "Chop"}]], "Input",
 CellLabel->"In[290]:=",
 CellID->733395986,ExpressionUUID->"9bc2ab74-569c-4b59-9a28-d4c181adff2d"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[290]=",
 CellID->447101159,ExpressionUUID->"14b6e0e4-bf83-4516-a059-29ae9edfaa99"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/guide/QuantumInformationSystems"]], 
         "TutorialMoreAbout",ExpressionUUID->
         "82e840fd-52e6-4d64-9c1e-24add8face82"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"0a0c3948-85d8-405a-9c08-\
35a80acaa9f4"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "c709d7e9-c7d2-4727-a766-bda7e0356e8b"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3S/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "1e1fa4c1-680d-43ef-86a3-9f79fc8bdb62"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"84c5a476-2ded-4551-a664-\
ca35025c476e"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "A. Gilyen, Y. Su, G. Hao, and N. Wiebe (2019)"}]]]], 
             "https://doi.org/10.1145/3313276.3316366"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "86070537-98ec-4ab4-b671-f484c1ddbcfa"]}]],ExpressionUUID->
         "f41aad77-1285-49e8-9468-421e2e8c3519"],
        ", Proceedings of the 51st Annual ACM SIGACT Symposium on Theory of \
Computing, \"Quantum singular value transformation and beyond: exponential \
improvements for quantum matrix arithmetics.\""
       }], "TutorialRelatedLinks",ExpressionUUID->
        "69dd74e5-bda1-41b3-93db-688f78b0994d"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "L. Lin (2022)"}]]]], 
             "https://arxiv.org/abs/2201.08309"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "9adaa6f0-d738-4e13-88ea-107e378c1e83"]}]],ExpressionUUID->
         "3ea490be-a54a-4cbb-8398-de333d09f600"],
        ", arXiv:2201.08309, \"Lecture Notes on Quantum Algorithms for \
Scientific Computation.\""
       }], "TutorialRelatedLinks",ExpressionUUID->
        "6ab586a8-a7f4-4e93-b85a-c6f23745b8c1"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J. M. Martyn, Z. M. Rossi, A. K. Tan, I. L. Chuan \
(2021)"}]]]], "https://doi.org/10.1103%2Fprxquantum.2.040203"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "5a1af965-f66b-4566-bda6-88d9ab86f4a9"]}]],ExpressionUUID->
         "0739be6c-ee66-400f-b658-3f03c921f42d"],
        ", PRX Quantum 2, 4 040203, \"Grand Unification of Quantum \
Algorithms.\""
       }], "TutorialRelatedLinks",ExpressionUUID->
        "2d7117d8-7472-4d89-8d87-b31c2c224c1b"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "a9539e0c-3eae-4d01-96fe-8bd5006fba64"]}]],ExpressionUUID->
         "6712c35b-f6ef-44fc-b44c-df1083ebcf8b"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "afcd8dab-662f-4458-8b72-6111b2a4017c"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "31b38ec9-ee9a-4300-ae2e-44eab074013b"]}]],ExpressionUUID->
         "4cc633bf-548c-480c-8606-73644c6f3c3e"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "eb14502a-6a96-4b68-b520-a1775a102902"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"4da40e09-c620-4a65-a0b0-\
7274944a0e69"],

Cell[" ", "FooterCell",ExpressionUUID->"4eb662a4-2393-4d7b-95e5-519b1708339b"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Linear Combination of Unitaries",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2024", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 3, 2, 21, 34, 9.863628}", 
    "history" -> {"14.0", "", "", ""}, "context" -> "QuantumMob`Q3S`", 
    "keywords" -> {
     "quantum singular value transform", "quantum eigen-value transform"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Quantum Mob/ Q3S Tech Note", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3S", "status" -> "None", "summary" -> 
    "Let U_ 1,U_ 2,\\[Ellipsis] be unitary operators. and \
\\[Alpha]:=(\\[Alpha]_ 1,\\[Alpha]_ 2,\\[Ellipsis]) be a vector of complex \
numbers. Define a unitary operator Vby V\\[DotEqual] ( 1 ) / ( \
SqrtBox[RowBox[{\\[LeftDoubleBracketingBar], RowBox[{\\[Alpha], SubscriptBox[\
\\[LeftDoubleBracketingBar], 1]}]}]] ) \
(GridBox[{{SqrtBox[SubscriptBox[\\[Alpha], 1]], *, \\[Ellipsis], *}, \
{SqrtBox[SubscriptBox[\\[Alpha], 2]], *, \\[Ellipsis], *}, \
{\\[VerticalEllipsis], \\[VerticalEllipsis], \\[DescendingEllipsis], \
\\[VerticalEllipsis]}, {\\[VerticalEllipsis], *, \\[Ellipsis], *}}]) . Then, \
one way to implement T:=\\[Sum]_k\\[Alpha] _kU _k is through the quantum \
circuit in Figure 1.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "Linear Combination of Unitaries", "titlemodifier" -> "", 
    "metadescription" -> "", "windowtitle" -> 
    "Linear Combination of Unitaries", "type" -> "Tech Note", "uri" -> 
    "QuantumMob/Q3S/tutorial/LinearCombinationofUnitaries"}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.2 for Mac OS X ARM (64-bit) (December 26, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"cb5e15ab-ced4-4938-9e27-348b93e248aa"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[599, 21, 6337, 157, 50, "AnchorBarGrid",ExpressionUUID->"59162b45-0d7e-4fa8-b4e8-a90652be3e9d",
 CellID->1],
Cell[CellGroupData[{
Cell[6961, 182, 1308, 35, 59, "ObjectNameGrid",ExpressionUUID->"e1a09567-526f-45b1-9bbf-cf639e05fbea"],
Cell[8272, 219, 1844, 42, 62, "TechNoteJumpBox",ExpressionUUID->"17d3bb5a-b083-4566-9aca-0f0ee4942f02"],
Cell[10119, 263, 502, 12, 63, "DefinitionBox",ExpressionUUID->"f124192d-758c-411c-8988-457e52439003",
 CellID->1025109959],
Cell[10624, 277, 187, 3, 30, "TechNoteCaption",ExpressionUUID->"bbc464ac-42bf-464a-bb92-9c548b4b1f9e",
 CellID->1909264679],
Cell[10814, 282, 300, 7, 35, "TechNoteMathCaption",ExpressionUUID->"1b2ffd88-381c-4303-b53f-401bee06d578",
 CellID->1428640008],
Cell[11117, 291, 179, 3, 28, "Input",ExpressionUUID->"d11a928a-60c5-4936-86c4-c8ef71a20446",
 CellID->853967906],
Cell[11299, 296, 318, 6, 55, "TechNoteMathCaption",ExpressionUUID->"65741eca-6411-4766-94c8-ebb88813699d",
 CellID->1937193009],
Cell[11620, 304, 271, 6, 45, "Input",ExpressionUUID->"56261e99-d64e-4a2a-ab7d-59c97695d1a3",
 CellID->403330096]
}, Open  ]],
Cell[CellGroupData[{
Cell[11928, 315, 124, 1, 79, "TechNoteSection",ExpressionUUID->"6a5c0855-8b59-4749-a86e-abb755385af1",
 CellID->221637712],
Cell[12055, 318, 808, 23, 34, "TechNoteText",ExpressionUUID->"f78c4934-d8b3-4dca-8c87-9c687523c0e6",
 CellID->2083809428],
Cell[12866, 343, 864, 25, 103, "TechNoteText",ExpressionUUID->"ea994e3d-7024-41f4-a728-b9d173bbb8d9",
 CellID->1421741120],
Cell[13733, 370, 454, 13, 34, "TechNoteText",ExpressionUUID->"0a53b040-7343-461d-a8da-1e00be60ad43",
 CellID->1718500619],
Cell[14190, 385, 10774, 253, 164, "Picture",ExpressionUUID->"cd04241d-ec95-42fa-b452-0b030f36fe88",
 CellID->2094833135],
Cell[24967, 640, 867, 25, 49, "TechNoteCaption",ExpressionUUID->"11bd03a1-92de-456b-8253-3e9c5542629f",
 CellID->1051781767]
}, Open  ]],
Cell[CellGroupData[{
Cell[25871, 670, 111, 1, 70, "TechNoteSection",ExpressionUUID->"2e614a48-b7df-43ee-a9ac-86e03bc9e660",
 CellID->2113806542],
Cell[25985, 673, 178, 3, 70, "Input",ExpressionUUID->"ac875c4e-7c9f-46cc-a05f-8165bc752959",
 CellID->546965754],
Cell[26166, 678, 280, 6, 70, "Input",ExpressionUUID->"f6217ff4-bec7-4191-86ef-d8504ffc08cf",
 CellID->430885452],
Cell[26449, 686, 284, 7, 70, "TechNoteMathCaption",ExpressionUUID->"e49a5bf6-f9ae-416a-8c7e-55b36454c836",
 CellID->1499619177],
Cell[CellGroupData[{
Cell[26758, 697, 302, 8, 70, "Input",ExpressionUUID->"5281582e-11c5-426b-9bc6-3f5f34830f3e",
 CellID->839037348],
Cell[27063, 707, 283, 8, 36, "Output",ExpressionUUID->"91ab3a9c-8089-4554-bcf9-acd2ebdf70b0",
 CellID->1509612144]
}, Open  ]],
Cell[27361, 718, 565, 17, 70, "TechNoteMathCaption",ExpressionUUID->"b73aaf1d-6c05-4742-ab61-75446207cd3b",
 CellID->1587367910],
Cell[27929, 737, 168, 4, 70, "Input",ExpressionUUID->"33e64549-0f75-48b7-b6b1-891a10152e6a",
 CellID->1381591108],
Cell[CellGroupData[{
Cell[28122, 745, 668, 21, 70, "Input",ExpressionUUID->"7b709b41-7276-4b08-b02a-89b82ed362c9",
 CellID->1361450766],
Cell[28793, 768, 2003, 59, 48, "Output",ExpressionUUID->"07d1758f-cfed-4283-9638-6170c1f076df",
 CellID->526104685]
}, Open  ]],
Cell[30811, 830, 278, 7, 70, "TechNoteMathCaption",ExpressionUUID->"38153f4a-d212-4aa2-b08b-97e269dc2e8b",
 CellID->225013878],
Cell[CellGroupData[{
Cell[31114, 841, 231, 6, 70, "Input",ExpressionUUID->"3ce1506a-faa3-41ac-a5a9-01465decb479",
 CellID->576934080],
Cell[31348, 849, 449, 14, 36, "Output",ExpressionUUID->"2dfd5444-1af1-4984-8c12-ff67dfb2293f",
 CellID->1319205668]
}, Open  ]],
Cell[CellGroupData[{
Cell[31834, 868, 108, 1, 70, "Subsection",ExpressionUUID->"70fef44e-32f0-4824-aa3f-2ffb81b3f2af",
 CellID->1973147550],
Cell[31945, 871, 374, 11, 70, "TechNoteMathCaption",ExpressionUUID->"3780eddb-d653-43f3-8400-b2501e5d5e23",
 CellID->1846260513],
Cell[CellGroupData[{
Cell[32344, 886, 294, 8, 70, "Input",ExpressionUUID->"d95633c7-9543-4fbb-91b9-08f93d149ab4",
 CellID->740865323],
Cell[32641, 896, 1926, 58, 48, "Output",ExpressionUUID->"e4d7b4fe-785d-436f-a3c4-539ab87eaaf8",
 CellID->1186808524]
}, Open  ]],
Cell[34582, 957, 648, 16, 70, "TechNoteMathCaption",ExpressionUUID->"bf43ab6c-f6b1-4d66-bb8c-7b8fd3b437a2",
 CellID->47470155],
Cell[CellGroupData[{
Cell[35255, 977, 827, 19, 70, "Input",ExpressionUUID->"44710695-bfe6-4534-afc9-bd123e361627",
 CellID->260210010],
Cell[36085, 998, 4185, 103, 175, "Output",ExpressionUUID->"81da14da-3009-4c95-8866-cd5c5fc719f8",
 CellID->1964444323]
}, Open  ]],
Cell[40285, 1104, 188, 3, 70, "TechNoteMathCaption",ExpressionUUID->"eeddda81-f450-4b9c-b8d3-31f479942f64",
 CellID->1302929911],
Cell[CellGroupData[{
Cell[40498, 1111, 159, 3, 70, "Input",ExpressionUUID->"4d29b768-19bf-46c8-9f92-03e1f6410dfb",
 CellID->418097618],
Cell[40660, 1116, 5710, 132, 176, "Output",ExpressionUUID->"4f3403a6-4ca0-453c-969f-64079200a1e4",
 CellID->171877833]
}, Open  ]],
Cell[46385, 1251, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"ee21c24c-32de-44ff-8d1e-b58c488778c5",
 CellID->196018039],
Cell[CellGroupData[{
Cell[46559, 1256, 456, 13, 70, "Input",ExpressionUUID->"9ad6d17f-a724-4d17-bf5a-a8dc580d431d",
 CellID->164075254],
Cell[47018, 1271, 959, 32, 40, "Output",ExpressionUUID->"5c2d3eff-80c9-454d-b6a3-e8de7781f337",
 CellID->1149233402]
}, Open  ]],
Cell[CellGroupData[{
Cell[48014, 1308, 219, 5, 70, "Input",ExpressionUUID->"e3e55b09-82db-466a-9bb8-e7ba67a441fe",
 CellID->1764537993],
Cell[48236, 1315, 4489, 110, 175, "Output",ExpressionUUID->"c1ca2a9d-d9a1-42d8-a54a-03efb82f6ebf",
 CellID->957740053]
}, Open  ]],
Cell[52740, 1428, 333, 10, 70, "TechNoteMathCaption",ExpressionUUID->"4485e10e-205c-4b45-84c3-deb7135db702",
 CellID->1459936136],
Cell[CellGroupData[{
Cell[53098, 1442, 283, 7, 70, "Input",ExpressionUUID->"98fdf658-b565-4cbe-aab6-b02ba36e92c4",
 CellID->2013398190],
Cell[53384, 1451, 1832, 42, 38, "Output",ExpressionUUID->"b0fc4b0e-334f-44e0-be13-c782e1e8129f",
 CellID->1564799294]
}, Open  ]],
Cell[CellGroupData[{
Cell[55253, 1498, 331, 8, 70, "Input",ExpressionUUID->"471e87fb-44c6-4f23-ab4d-5c555498a796",
 CellID->1512371685],
Cell[55587, 1508, 3690, 107, 79, "Output",ExpressionUUID->"507a67c2-9c29-4797-93e5-2a5fe746a325",
 CellID->2080681408],
Cell[59280, 1617, 2433, 78, 62, "Output",ExpressionUUID->"516b4960-fdca-4a1c-bd49-8622079efa1f",
 CellID->388716508]
}, Open  ]],
Cell[61728, 1698, 240, 6, 70, "TechNoteMathCaption",ExpressionUUID->"f05971e4-411a-4c1f-97b8-6d1d3f0f4fe4",
 CellID->1926262569],
Cell[CellGroupData[{
Cell[61993, 1708, 248, 6, 70, "Input",ExpressionUUID->"f58a9b11-27f7-42d4-bc09-965e3842961c",
 CellID->550906173],
Cell[62244, 1716, 2434, 78, 62, "Output",ExpressionUUID->"2974a5e3-e186-4daf-be46-4831229644e5",
 CellID->1309557227]
}, Open  ]],
Cell[CellGroupData[{
Cell[64715, 1799, 152, 3, 70, "Input",ExpressionUUID->"2aea083b-8ae8-4c94-b34b-8bd7f2a0611b",
 CellID->209695444],
Cell[64870, 1804, 127, 2, 36, "Output",ExpressionUUID->"cb7eb963-f732-4251-ad9f-91189e6dbaf2",
 CellID->132995768]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65046, 1812, 118, 1, 70, "Subsection",ExpressionUUID->"74cd9794-6b76-4118-9d65-5e5693536700",
 CellID->1004589932],
Cell[65167, 1815, 473, 13, 70, "TechNoteMathCaption",ExpressionUUID->"51d82cb7-0756-448f-a3f2-818f0ded25da",
 CellID->996657064],
Cell[CellGroupData[{
Cell[65665, 1832, 315, 9, 70, "Input",ExpressionUUID->"6cec52dd-3881-48f0-9d6b-aa4513e218dc",
 CellID->1658219594],
Cell[65983, 1843, 301, 8, 49, "Output",ExpressionUUID->"d245a298-0f4d-441c-8127-ab7db71c92ff",
 CellID->1870746279]
}, Open  ]],
Cell[CellGroupData[{
Cell[66321, 1856, 180, 4, 70, "Input",ExpressionUUID->"57efd43a-0491-4768-849c-e7ba1346adf9",
 CellID->75389019],
Cell[66504, 1862, 2242, 66, 48, "Output",ExpressionUUID->"c8039f64-65c5-4d62-9ca7-ef4e709a332d",
 CellID->2065718548]
}, Open  ]],
Cell[68761, 1931, 468, 14, 70, "TechNoteMathCaption",ExpressionUUID->"4e29bfac-5a94-4098-ae73-9d7fe4f42c07",
 CellID->163515187],
Cell[CellGroupData[{
Cell[69254, 1949, 821, 24, 70, "Input",ExpressionUUID->"bd3aaf52-482b-44df-ae66-ca8e6bf83e36",
 CellID->1103004868],
Cell[70078, 1975, 1604, 38, 91, "Output",ExpressionUUID->"ada325d7-e683-417e-9248-7a2f48199f93",
 CellID->39104677]
}, Open  ]],
Cell[CellGroupData[{
Cell[71719, 2018, 255, 7, 70, "Input",ExpressionUUID->"03cbf777-94d9-4a60-88dd-9522a4a4e7ad",
 CellID->1455841953],
Cell[71977, 2027, 725, 19, 91, "Output",ExpressionUUID->"7a9f29a1-eaa5-43f0-ab35-a7f9ee62e930",
 CellID->1578798180]
}, Open  ]],
Cell[CellGroupData[{
Cell[72739, 2051, 519, 13, 70, "Input",ExpressionUUID->"22bd328c-db1c-4f4f-b945-0a82a37d037a",
 CellID->591283205],
Cell[73261, 2066, 7892, 165, 70, "Output",ExpressionUUID->"16999950-a4d4-4cec-a88c-5530e6571a3a",
 CellID->1696427632],
Cell[81156, 2233, 8018, 168, 70, "Output",ExpressionUUID->"adabd095-fc91-4204-a3a2-4a45057ad04c",
 CellID->1866313452]
}, Open  ]],
Cell[89189, 2404, 331, 7, 70, "TechNoteMathCaption",ExpressionUUID->"1882fd51-281f-440c-a751-a37d47e37792",
 CellID->250193288],
Cell[CellGroupData[{
Cell[89545, 2415, 282, 6, 70, "Input",ExpressionUUID->"3d193a57-2835-4919-b04d-56e3bd35bb67",
 CellID->419092567],
Cell[89830, 2423, 2607, 75, 48, "Output",ExpressionUUID->"8d2561ac-948a-42f3-93f1-87f417428ea3",
 CellID->1546029524]
}, Open  ]],
Cell[92452, 2501, 140, 1, 70, "TechNoteMathCaption",ExpressionUUID->"1e8bd4b5-5036-46e7-b0c0-310cb90b6958",
 CellID->1713564815],
Cell[CellGroupData[{
Cell[92617, 2506, 730, 18, 70, "Input",ExpressionUUID->"37672fb6-e15c-4c49-8fc5-5950c707b17d",
 CellID->866928573],
Cell[93350, 2526, 13821, 366, 176, "Output",ExpressionUUID->"3d0fd232-0c4b-4a29-a63c-8b8be4fd547c",
 CellID->163474990]
}, Open  ]],
Cell[107186, 2895, 168, 2, 70, "TechNoteMathCaption",ExpressionUUID->"bae11d38-cde4-4d5b-8cc4-77b9e89a79ed",
 CellID->1735772354],
Cell[CellGroupData[{
Cell[107379, 2901, 380, 10, 70, "Input",ExpressionUUID->"c5c8cf54-1d2f-4891-b1cd-2014a7e29c49",
 CellID->907370804],
Cell[107762, 2913, 2304, 65, 56, "Output",ExpressionUUID->"436cd3ef-e181-4477-8ece-e0e768863d14",
 CellID->1122015419]
}, Open  ]],
Cell[110081, 2981, 246, 6, 70, "TechNoteMathCaption",ExpressionUUID->"289fe45f-4274-434a-aec7-5125e7e33972",
 CellID->170046271],
Cell[CellGroupData[{
Cell[110352, 2991, 251, 6, 70, "Input",ExpressionUUID->"0571b27b-2d3e-4cc4-bc91-5e812b5af5f9",
 CellID->1809121102],
Cell[110606, 2999, 3067, 95, 62, "Output",ExpressionUUID->"242ed0dc-3428-494e-b8ef-cc031194529f",
 CellID->1621781676]
}, Open  ]],
Cell[CellGroupData[{
Cell[113710, 3099, 210, 5, 70, "Input",ExpressionUUID->"9bc2ab74-569c-4b59-9a28-d4c181adff2d",
 CellID->733395986],
Cell[113923, 3106, 128, 2, 36, "Output",ExpressionUUID->"14b6e0e4-bf83-4516-a059-29ae9edfaa99",
 CellID->447101159]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[114090, 3113, 753, 19, 70, "TutorialMoreAboutSection",ExpressionUUID->"0a0c3948-85d8-405a-9c08-35a80acaa9f4"],
Cell[114846, 3134, 1140, 30, 70, "RelatedTutorialsSection",ExpressionUUID->"84c5a476-2ded-4551-a664-ca35025c476e"],
Cell[115989, 3166, 4940, 129, 70, "TutorialRelatedLinksSection",ExpressionUUID->"4da40e09-c620-4a65-a0b0-7274944a0e69"],
Cell[120932, 3297, 78, 0, 70, "FooterCell",ExpressionUUID->"4eb662a4-2393-4d7b-95e5-519b1708339b"]
}
]
*)

(* End of internal cache information *)

