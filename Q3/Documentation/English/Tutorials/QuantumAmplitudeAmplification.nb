(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    180097,       4473]
NotebookOptionsPosition[    160088,       4091]
NotebookOutlinePosition[    163580,       4166]
CellTagsIndexPosition[    163537,       4163]
WindowTitle->Quantum Amplitude Amplification
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "b0eb763b-6c8b-4ace-82e2-e6df8d8d2d31"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "ac5bb8be-99ce-4978-b5c4-c3b4bb1b6456"],
        Background->LightDarkSwitched[
          RGBColor[
          0.3843137254901961, 0.4627450980392157, 0.7019607843137254]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "e565bad9-e14d-43f8-91ab-9814bce2e614"]
         }],ExpressionUUID->"fa77452e-3bbb-4543-809c-cbfe436e9766"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "ac5db92c-8994-440a-bff8-7048e2e43035"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "d0b427de-efb7-41de-ac43-3ef00a580215"]
         }],ExpressionUUID->"8bc0898d-dd8b-4058-a854-0a2e172cc795"],
         StripOnInput->False],{
        "\"Quantum Search Algorithm\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumSearchAlgorithm"], 
         "\"Block Encoding\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/BlockEncoding"], 
         "\"Quantum Computation: Overview\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "490010a2-3649-493d-868f-3877228602f8"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "21fab35a-0225-4a36-a6fb-083e6bc71f4a"]
         }],ExpressionUUID->"53c6efa3-c9f5-4705-918e-68f21bf479c0"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/tutorial/QuantumAmplitudeAmplification\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard[
          "QuantumMob/Q3/tutorial/QuantumAmplitudeAmplification"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/\
tutorial/QuantumAmplitudeAmplification.html"], StandardForm]], "Input", 
                 TextClipboardType -> "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/tutorial/QuantumAmplitudeAmplification") <> 
               ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "d73ed9ba-e4ca-41fc-9453-6fa47178a6dc"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "b80a39b1-a865-4764-bbba-070f43eaa603"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"97ebebbc-d195-4342-b1c0-c8a0c1ef8c73"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "Quantum Amplitude Amplification", "TechNoteTitle",ExpressionUUID->
      "a6873395-25b2-4da2-904a-3868d436af22"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"0908f90e-488c-4c6e-8c66-ca0a1538b277"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "94beef12-2687-454e-a556-99ba3987aaa8"]
    }],ExpressionUUID->"44bb05e1-a4f7-4e44-b6ce-5f1108860a48"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.2\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->LightDarkSwitched[
              RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "d8ed20f6-9a9a-478f-88aa-a9c75cb3304d"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"1a73170d-ee59-4e42-a60d-503940169c53"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Quantum Amplitude Amplification (QAA)"], 
      "paclet:QuantumMob/Q3/tutorial/QuantumAmplitudeAmplification#\
1404287834", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Oblivious Amplitude Amplification (OAA)"], 
      "paclet:QuantumMob/Q3/tutorial/QuantumAmplitudeAmplification#635509592", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TechNoteJumpBox",ExpressionUUID->"9fc3c05e-921b-4863-a92f-\
d2a11cc28c51"],

Cell["\<\
Quantum amplitude amplification is a quantum algorithmic technique used to \
increase the probability of finding a desired outcome in a quantum system. It \
generalizes the concept of Grover's algorithm, which is specifically designed \
for unstructured search problems. In quantum amplitude amplification, the \
basic idea is to start with a superposition of quantum states, each with a \
certain amplitude, and iteratively apply a sequence of quantum operations to \
amplify the amplitudes of the states corresponding to desired outcomes while \
reducing the amplitudes of the undesired ones. This is achieved through a \
process involving quantum reflection and interference, which systematically \
increases the likelihood of measuring the correct state upon observation. The \
technique is widely applicable in quantum algorithms, providing a quadratic \
speedup over classical counterparts for a variety of search and optimization \
problems. \
\>", "TechNoteText",
 CellID->2066743005,ExpressionUUID->"5b196a23-ce7e-4aa4-8d5c-306f0a683a80"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Quantum Amplitude Amplification (QAA)", "TechNoteSection",
 CellID->1404287834,ExpressionUUID->"576f2893-ee8c-4bbd-ae25-328ebacfdfdd"],

Cell[TextData[{
 "Consider a unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "56ebc677-f86e-4e77-b6ac-3bb3f7e21950"],
 " such that"
}], "TechNoteText",
 CellID->1020345508,ExpressionUUID->"3fefa46e-474a-4868-bcc6-843a73adf30d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      RowBox[{"\[Psi]", "'"}]},
     "Ket"], ":=", 
    RowBox[{
     RowBox[{"U", 
      TemplateBox[{"\[Psi]"},
       "Ket"]}], "=", 
     RowBox[{
      RowBox[{
       TemplateBox[{"\[Phi]"},
        "Ket"], 
       SqrtBox["p"]}], "+", 
      RowBox[{
       TemplateBox[{
         SuperscriptBox["\[Phi]", "\[Perpendicular]"]},
        "Ket"], 
       SqrtBox[
        RowBox[{"1", "-", "p"}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "dc4d1bab-56b0-4196-b821-439d2379e805"],
 ","
}], "TechNoteText",
 CellID->1290031661,ExpressionUUID->"1af1eaef-9da5-4400-b893-925ab49d0353"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "c49d8a25-4353-4ca9-acef-b797601a4766"],
 " is the \[OpenCurlyDoubleQuote]good\[CloseCurlyDoubleQuote] (or desired) \
state and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SuperscriptBox["\[Phi]", "\[Perpendicular]"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "87a5c47f-5e36-402c-99d1-5c20dd06df41"],
 " is the \[OpenCurlyDoubleQuote]bad\[CloseCurlyDoubleQuote] state, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Phi]", 
      SuperscriptBox["\[Phi]", "\[Perpendicular]"]},
     "BraKet"], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "2905419f-b0fc-4eb1-9e7a-5fd2b2b68196"],
 ", and ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "c7a736a7-95f4-41fa-98b2-8fcdf556d516"],
 " is the probability to achieve the good state. The input state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Psi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "06933103-12e2-454d-afb0-d66462532c8c"],
 " is typically set to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SuperscriptBox["0", 
      RowBox[{"\[CircleTimes]", "n"}]]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "4ea193a6-05fc-4962-87a4-8345668d4d09"],
 ", but here we consider a more general case. Although we usually do not have \
a direct access to the good state itself, it is assumed that we do have an \
access to the oracle "
}], "TechNoteText",
 CellID->567226315,ExpressionUUID->"2d209c1f-9a95-499a-b93c-8b2112c9193c"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["Z", "\[Phi]"]}], ":=", 
    RowBox[{"I", "-", 
     RowBox[{"2", 
      TemplateBox[{"\[Phi]"},
       "Ket"], 
      TemplateBox[{"\[Phi]"},
       "Bra"]}]}]}], TraditionalForm]],ExpressionUUID->
  "fc0ceee2-70f0-450c-afb8-9c359e0aaa17"],
 ","
}], "TechNoteText",
 CellID->692767172,ExpressionUUID->"163f3c9f-eada-4f74-b160-fc5d79d5e2df"],

Cell[TextData[{
 "which \[OpenCurlyDoubleQuote]marks\[CloseCurlyDoubleQuote] the good state \
by the phase factor ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", "1"}], TraditionalForm]],ExpressionUUID->
  "25e6636e-f750-49d2-9763-474e4dee71ee"],
 " or, equivalently, may be regarded as a reflection about the hyperplane \
perpendicular to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "3758a8ea-ece9-4db6-9565-5fb803bf3d0e"],
 "."
}], "TechNoteText",
 CellID->1829009417,ExpressionUUID->"d100405a-7564-454b-83f4-1fa0b7ea87c1"],

Cell[TextData[{
 "Following the idea behind the quantum search algorithm, we combine the \
oracle ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "\[Phi]"], TraditionalForm]],ExpressionUUID->
  "e13424f8-a1ac-4254-9ceb-ebd15fa0f590"],
 " and the reflection ",
 StyleBox["about",
  FontSlant->"Italic"],
 " the state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{"\[Psi]", "'"}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "7ac9c7b2-2d98-46f6-a6ef-897311b02761"],
 ",\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", 
     RowBox[{"\[Psi]", "'"}]], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"2", 
       TemplateBox[{
         RowBox[{"\[Psi]", "'"}]},
        "Ket"], 
       TemplateBox[{
         RowBox[{"\[Psi]", "'"}]},
        "Bra"]}], "-", "I"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"U", "(", 
        RowBox[{
         RowBox[{"2", 
          TemplateBox[{"\[Psi]"},
           "Ket"], 
          TemplateBox[{"\[Psi]"},
           "Bra"]}], "-", "I"}], ")"}], 
       SuperscriptBox["U", "\[Dagger]"]}], "=", 
      RowBox[{"U", "\[VeryThinSpace]", 
       SubscriptBox["Z", "\[Psi]"], 
       SuperscriptBox["U", "\[Dagger]"]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"66fc8aac-8ffd-49f4-8022-bfaae911ffdc"],
 ", "
}], "TechNoteText",
 CellID->1080348361,ExpressionUUID->"9ba5925e-5808-4b84-8bf4-d52844519f66"],

Cell[TextData[{
 "to get the rotation by angle ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Theta]"}], TraditionalForm]],ExpressionUUID->
  "b30da56a-3d3f-4fb4-b50e-1115cb91abf1"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"sin", "\[VeryThinSpace]", "\[Theta]"}], ":=", 
     SqrtBox["p"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "114c37ea-0e92-492f-a668-0d564a6c4bb9"],
 " "
}], "TechNoteText",
 CellID->1564974967,ExpressionUUID->"f29ac36d-58a1-47dd-96b9-5109faaad0be"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalOmega]", "AA"], ":=", 
    RowBox[{
     RowBox[{"-", "U"}], "\[VeryThinSpace]", 
     SubscriptBox["Z", "\[Psi]"], 
     SuperscriptBox["U", "\[Dagger]"], 
     SubscriptBox["Z", "\[Phi]"]}]}], TraditionalForm]],ExpressionUUID->
  "5c03a2e7-c660-426d-9b32-209216981fde"]
}], "TechNoteText",
 CellID->440667942,ExpressionUUID->"c0c12247-460a-4413-b198-32fdace851e3"],

Cell["toward the desired state.", "TechNoteText",
 CellID->1782486338,ExpressionUUID->"b5ae8ee0-7fe7-49f3-b40e-02f30905bc71"],

Cell[TextData[{
 "Technically, it is interesting to note that the amplitude amplification \
process ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalOmega]", "AA"], TraditionalForm]],ExpressionUUID->
  "36536b1a-dbd1-4054-b475-1ae9c7d72abe"],
 " preserves the two-dimensional subspace spanned by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "c4da0be4-d211-4ed6-ad1f-9429473cf6be"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SuperscriptBox["\[Phi]", "\[Perpendicular]"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "db47c41e-ac0b-416c-b4aa-2ea5a3512f5b"],
 " as first observed by ",
 ButtonBox["Brassard and H\[OSlash]yer (1997)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1109%2FISTCS.1997.595153"], None},
  ButtonNote->"https://doi.org/10.1109%2FISTCS.1997.595153"],
 " and rediscovered by ",
 ButtonBox["Grover (1998)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1103/PhysRevLett.80.4329"], None},
  ButtonNote->"https://doi.org/10.1103/PhysRevLett.80.4329"],
 "; see ",
 ButtonBox["Figure 1",
  BaseStyle->"Link",
  ButtonData->
   "paclet:QuantumMob/Q3/tutorial/AmplitudeAmplification#106944923"],
 " below."
}], "TechNoteText",
 CellID->851007116,ExpressionUUID->"9c5cbe47-47f3-4ec2-86ac-07d9a8c478b4"],

Cell[TextData[Cell[BoxData[
 GraphicsBox[{CircleBox[{0, 0}], 
   {GrayLevel[0.8], ArrowBox[{{-1.5, 0}, {1.5, 0}}], 
    LineBox[{{0, -1.5}, {0, 1.5}}], InsetBox[
     StyleBox["\<\"\\!\\(\\*TemplateBox[{SuperscriptBox[\\\"\[Phi]\\\", \\\"\
\[Perpendicular]\\\"]},\\\"Ket\\\"]\\)\"\>",
      StripOnInput->False,
      FontSize->14], {1.5, 0}, NCache[
     ImageScaled[{1, Rational[3, 2]}], ImageScaled[{1, 1.5}]]]}, 
   ArrowBox[{{0, 0}, {0, 1.5}}], InsetBox[
    StyleBox["\<\"\\!\\(\\*StyleBox[TemplateBox[{\\\"\[Phi]\\\"},\\\"Ket\\\"],\
FontWeight->\\\"Plain\\\"]\\)\"\>",
     StripOnInput->False,
     FontSize->14], {0, 1.5}, ImageScaled[{-0.25, 1}]], 
   {Thickness[Large], InsetBox[
     RotationBox[
      StyleBox["\<\"\\!\\(\\*StyleBox[TemplateBox[{\\\"\[Psi]\\\"},\\\"Ket\\\"\
],FontWeight->\\\"Plain\\\"]\\)\"\>",
       StripOnInput->False,
       FontSize->12],
      BoxRotation->0.19634954084936207`], {0.9807852804032304, 0.19509032201612825},
      ImageScaled[{-0.25, 0.25}]], 
    {RGBColor[0, 0, 1], 
     ArrowBox[{{0, 0}, {0.9807852804032304, 0.19509032201612825`}}]}, 
    {RGBColor[1, 0, 0], 
     ArrowBox[{{0, 0}, {0.9807852804032304, -0.19509032201612825`}}]}, 
    {RGBColor[0, 0, 1], 
     ArrowBox[{{0, 0}, {0.8314696123025452, 0.5555702330196022}}]}, 
    {RGBColor[1, 0, 0], 
     ArrowBox[{{0, 0}, {0.8314696123025452, -0.5555702330196022}}]}, 
    {RGBColor[0, 0, 1], 
     ArrowBox[{{0, 0}, {0.5555702330196023, 0.8314696123025451}}]}}, 
   {LightDarkSwitched[
     GrayLevel[0]], Dashing[{Small, Small}], 
    ArrowBox[{{0.9807852804032304, 0.19509032201612825`}, {
     0.9807852804032304, -0.19509032201612825`}}], 
    ArrowBox[{{0.9807852804032304, -0.19509032201612825`}, {
     0.8314696123025452, 0.5555702330196022}}], 
    ArrowBox[{{0.8314696123025452, 0.5555702330196022}, {
     0.8314696123025452, -0.5555702330196022}}], 
    ArrowBox[{{0.8314696123025452, -0.5555702330196022}, {0.5555702330196023, 
     0.8314696123025451}}]}},
  ImageSize->450,
  PlotRangePadding->Scaled[
   0.025]]],ExpressionUUID->"220a1454-1fa3-4fb7-bcff-47ac5db28f19"]], \
"Picture",
 CellID->1160036613,ExpressionUUID->"9a4a1b49-57fc-4448-881b-37d18c3500f0"],

Cell[TextData[{
 StyleBox["Figure 1",
  FontWeight->"Bold"],
 ". Geometric demonstration of the quantum amplitude amplification process ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalOmega]", "AA"], ":=", 
    RowBox[{
     RowBox[{"-", "U"}], "\[VeryThinSpace]", 
     SubscriptBox["Z", "\[Psi]"], 
     SuperscriptBox["U", "\[Dagger]"], 
     SubscriptBox["Z", "\[Phi]"]}]}], TraditionalForm]],ExpressionUUID->
  "073f8d18-c15d-4135-882a-4202c9ef11ac"],
 ". Note that to construct the unitary operation ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalOmega]", "AA"], TraditionalForm]],ExpressionUUID->
  "eca1056a-0b14-4ede-a908-04495ae68144"],
 " requires the knowledge of the initial state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Psi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "45e62b76-43f0-4b7b-bbc1-27dfb6b9d597"],
 ", which is typically set to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SuperscriptBox["0", 
      RowBox[{"\[CircleTimes]", "n"}]]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "045b4389-3016-4e11-b0a5-6f44afd8e69f"],
 "."
}], "TechNoteCaption",
 CellID->106944923,ExpressionUUID->"0ff7bb1c-c5f2-4763-8514-9953164cad17"],

Cell[CellGroupData[{

Cell["Demonstration", "Subsection",
 CellID->1502243926,ExpressionUUID->"c97180ac-5e4b-4948-ac05-3de4a589e909"],

Cell["Consider a quantum register of a finite number of qubits:", \
"TechNoteMathCaption",
 CellID->1056618802,ExpressionUUID->"72330a5b-f0ce-47d8-b186-8a489030346c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$N", "=", 
   RowBox[{"Power", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[237]:=",
 CellID->1030530536,ExpressionUUID->"70cdc679-5910-4d21-9dba-9dec25701b42"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellLabel->"In[239]:=",
 CellID->671105497,ExpressionUUID->"66c93bff-7029-4dbd-828a-a1abdd187416"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[240]=",
 CellID->526504709,ExpressionUUID->"d1e122fd-60f2-4943-9cec-e3d6a66f3aca"]
}, Open  ]],

Cell["\<\
Consider an algorithm (or, equivalently, a unitary operator) in a numerical \
matrix form for convenience:\
\>", "TechNoteMathCaption",
 CellID->1332018523,ExpressionUUID->"4bf4adaf-aa1a-4ab7-a6e2-e72d4f689f83"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"UU", "=", 
   RowBox[{
    RowBox[{"Rotation", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "3"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "3"}], "]"}]}], "]"}], "**", 
    RowBox[{"Rotation", "[", 
     RowBox[{
      RowBox[{"Pi", "/", "4"}], ",", 
      RowBox[{"S", "[", 
       RowBox[{"2", ",", "1"}], "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UU", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", 
     RowBox[{"UU", ",", "SS"}], "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UU", "//", "IntegerChop"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[241]:=",
 CellID->1473389149,ExpressionUUID->"4bfa308c-4333-46a9-bcb9-7848431c33dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.8001031451912655`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1913417161825449`"}], "-", 
       RowBox[{"0.3314135740355918`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {
      RowBox[{
       RowBox[{"-", "0.1913417161825449`"}], "-", 
       RowBox[{"0.3314135740355918`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.8001031451912655`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"0", "0", 
      RowBox[{"0.8001031451912655`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1913417161825449`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3314135740355918`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", 
      RowBox[{"0.1913417161825449`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3314135740355918`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.8001031451912655`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {Complex[
      0.8001031451912655, -0.46193976625564337`], 
      Complex[-0.1913417161825449, -0.3314135740355918], Complex[
      0.8001031451912655, -0.46193976625564337`], 
      Complex[-0.1913417161825449, -0.3314135740355918], Complex[
      0.8001031451912655, 0.46193976625564337`], Complex[
      0.1913417161825449, -0.3314135740355918], Complex[0.8001031451912655, 
      0.46193976625564337`], Complex[
      0.1913417161825449, -0.3314135740355918]}}]]]]], "Output",
 CellLabel->"Out[243]//MatrixForm=",
 CellID->215290027,ExpressionUUID->"f7452476-8338-4018-ada7-3e58ceeca746"]
}, Open  ]],

Cell["Choose an initial state:", "TechNoteMathCaption",
 CellID->1689971758,ExpressionUUID->"ad50f533-3bf5-47f1-9cca-7eab2b14a2de"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], "**", 
    RowBox[{"Ket", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"in", ",", "SS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "Normal"}]}], "Input",
 CellLabel->"In[247]:=",
 CellID->1575398298,ExpressionUUID->"781976da-880b-413c-a594-1b620093c5fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"], ",", 
   FractionBox["1", "2"]}], "}"}]], "Output",
 CellLabel->"Out[249]=",
 CellID->1970545658,ExpressionUUID->"88cfbbbe-fa63-48e7-a018-2466b9ef1b0d"]
}, Open  ]],

Cell["Get the output state through the algorithm:", "TechNoteMathCaption",
 CellID->468069972,ExpressionUUID->"6860209c-9c6a-4e32-bfd3-fb78ab0f0c8b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"UU", ".", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "Normal"}]}], "Input",
 CellLabel->"In[250]:=",
 CellID->1209953873,ExpressionUUID->"322e8830-0776-4565-a530-5a5a4a2a6450"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.3043807145043603`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.3966766701456176`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.3043807145043603`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.3966766701456176`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.4957224306869052`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.06526309611002579`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.4957224306869052`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.06526309611002579`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[251]=",
 CellID->1714818271,ExpressionUUID->"1fb5af78-c14c-464f-a7c5-c30ead609b38"]
}, Open  ]],

Cell["\<\
We want the output state to be close to a desired \"good\" state:\
\>", "TechNoteMathCaption",
 CellID->1720137957,ExpressionUUID->"3fb83724-110e-4496-990f-56dfcf10ef65"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"good", "=", 
  RowBox[{
   RowBox[{"GHZState", "[", "SS", "]"}], "//", "First"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"good", "=", 
   RowBox[{"Matrix", "[", "good", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"good", "//", "Normal"}]}], "Input",
 CellLabel->"In[252]:=",
 CellID->450278945,ExpressionUUID->"cb46f0b7-0f6f-4fd4-9453-9783d91deb31"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "+", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[252]=",
 CellID->1564409363,ExpressionUUID->"bd2f3adc-4fff-4dd8-89a3-fd37466088c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], ",", "0", ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]]}], "}"}]], "Output",
 CellLabel->"Out[254]=",
 CellID->1385873720,ExpressionUUID->"4e7218e2-1e4c-4f81-a44f-ff677f485d83"]
}, Open  ]],

Cell["\<\
Check the fidelity between the output from the algorithm and the desired \
state:\
\>", "TechNoteMathCaption",
 CellID->715602821,ExpressionUUID->"788ac777-b0cd-4a41-a262-f3756a09e087"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fdl", "=", 
  RowBox[{
   RowBox[{"Fidelity", "[", 
    RowBox[{"good", ",", "out"}], "]"}], "//", "N"}]}]], "Input",
 CellLabel->"In[261]:=",
 CellID->897371023,ExpressionUUID->"d1dc2367-fe5b-4107-882e-1e5d3b292e2d"],

Cell[BoxData["0.6123724356957945`"], "Output",
 CellLabel->"Out[261]=",
 CellID->770727201,ExpressionUUID->"752babd7-6c47-4132-a447-8b595c77cc66"]
}, Open  ]],

Cell["\<\
Before constructing the amplitude amplification (AA) operator, construct the \
\"phase marker\" operators:\
\>", "TechNoteMathCaption",
 CellID->566017205,ExpressionUUID->"1d55131c-ec46-416e-84a9-143de5fd6e28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Zin", "=", 
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{"Dyad", "[", 
      RowBox[{"in", ",", "in"}], "]"}]}], "-", 
    RowBox[{"One", "[", "$N", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zgd", "=", 
   RowBox[{
    RowBox[{"2", "*", 
     RowBox[{"Dyad", "[", 
      RowBox[{"good", ",", "good"}], "]"}]}], "-", 
    RowBox[{"One", "[", "$N", "]"}]}]}], ";"}]}], "Input",
 CellLabel->"In[262]:=",
 CellID->675092936,ExpressionUUID->"0e6d054b-57c9-48d2-a069-8ed365aa22e8"],

Cell["Construct the AA operator:", "TechNoteMathCaption",
 CellID->1195732985,ExpressionUUID->"cc17a22b-be47-4c22-bd82-1e59d014c194"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{"UU", ".", "Zin", ".", 
    RowBox[{"ConjugateTranspose", "[", "UU", "]"}], ".", "Zgd"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AA", "//", "ArrayShort"}]}], "Input",
 CellLabel->"In[264]:=",
 CellID->1130868251,ExpressionUUID->"a1749d49-601a-4e92-a1de-0bf042cb80c5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.24999999999999994`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.4330127018922193`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.5`"}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "+", 
       RowBox[{"0.4330127018922193`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.5`"}]},
     {
      RowBox[{"0.24999999999999994`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.4330127018922193`", " ", "\[ImaginaryI]"}]}], "0.5`", 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "+", 
       RowBox[{"0.4330127018922193`", " ", "\[ImaginaryI]"}]}], "0.5`"},
     {"0.49999999999999994`", 
      RowBox[{
       RowBox[{"-", "0.25`"}], "-", 
       RowBox[{"0.4330127018922193`", " ", "\[ImaginaryI]"}]}], 
      "0.49999999999999994`", 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4330127018922193`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"-", "0.49999999999999994`"}], 
      RowBox[{
       RowBox[{"-", "0.25`"}], "-", 
       RowBox[{"0.4330127018922193`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.49999999999999994`"}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.4330127018922193`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {4}, {2}, {3}, {1}, {4}, {2}, {3}, {3}, {
       4}, {1}, {2}, {3}, {4}, {1}, {2}}}, {
      Complex[0.24999999999999994`, -0.4330127018922193], -0.5, -0.5, 
       Complex[-0.24999999999999994`, 0.4330127018922193], Complex[
       0.24999999999999994`, -0.4330127018922193], 0.5, 0.5, 
       Complex[-0.24999999999999994`, 0.4330127018922193], 
       0.49999999999999994`, Complex[0.25, 0.4330127018922193], 
       0.49999999999999994`, 
       Complex[-0.25, -0.4330127018922193], -0.49999999999999994`, Complex[
       0.25, 0.4330127018922193], -0.49999999999999994`, 
       Complex[-0.25, -0.4330127018922193]}}], TableHeadings -> 
    None, {}]]]], "Output",
 CellLabel->"Out[265]//MatrixForm=",
 CellID->1182453891,ExpressionUUID->"d0f0fc69-b8ce-451b-b85d-7a968718e53f"]
}, Open  ]],

Cell["Apply the AA operator on the output state:", "TechNoteMathCaption",
 CellID->1879778906,ExpressionUUID->"eb3f63ec-7656-490a-a74c-ed490f18b7c0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mid", "=", 
  RowBox[{"AA", ".", "out"}]}]], "Input",
 CellLabel->"In[266]:=",
 CellID->1093477974,ExpressionUUID->"62dacd26-bbb5-42f6-9f2c-4608c7ff09a7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             
             RasterBox[{{{0.16791, 0., 0.301671}, {0.2676237806670256, 
              0.5570910109816173, 0.9292576695573885}, {0.4144780568024588, 
              0.732770445360275, 0.9799957116085724}, {0.24835553205885708`, 
              0.03544529171065877, 0.4768359192919526}}}, {{0, 0}, {4, 1}}, {
              0, 1}], AspectRatio -> 1, Axes -> False, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", "4", "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             
             RasterBox[{{{0.16791, 0., 0.301671}, {0.2676237806670256, 
              0.5570910109816173, 0.9292576695573885}, {0.4144780568024588, 
              0.732770445360275, 0.9799957116085724}, {0.24835553205885708`, 
              0.03544529171065877, 0.4768359192919526}}}, {{0, 0}, {4, 1}}, {
              0, 1}], AspectRatio -> 1, Axes -> False, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", "4", "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1.`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", "1", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.6479127879390852`"}], "+", 
                    RowBox[{"0.13307523896278303`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "2", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.15219035725218016`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.19833833507280876`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "3", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.24786121534345257`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.03263154805501298`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "4", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.5522419298478127`"}], "+", 
                    RowBox[{"0.3640451220906046`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}}, GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {4}, Complex[0., 0.], {
   1, {{0, 4}, {{1}, {2}, {3}, {4}}}, {Complex[-0.6479127879390852, 
    0.13307523896278303`], Complex[
    0.15219035725218016`, -0.19833833507280876`], Complex[
    0.24786121534345257`, 0.03263154805501298], Complex[-0.5522419298478127, 
    0.3640451220906046]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[266]=",
 CellID->816115503,ExpressionUUID->"a9716a50-233e-4b2f-9844-d552ef30cf50"]
}, Open  ]],

Cell["The fidelity has been improved:", "TechNoteMathCaption",
 CellID->2008839700,ExpressionUUID->"bbe3e2fe-4939-42fd-a07d-dc8eabd7c615"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fdl", "=", 
  RowBox[{
   RowBox[{"Fidelity", "[", 
    RowBox[{"good", ",", "mid"}], "]"}], "//", "N"}]}]], "Input",
 CellLabel->"In[267]:=",
 CellID->178736448,ExpressionUUID->"0a2f73c2-fa95-4d81-a256-860b9249cb6c"],

Cell[BoxData["0.9185586535436914`"], "Output",
 CellLabel->"Out[267]=",
 CellID->1753558182,ExpressionUUID->"56d11836-3a54-4a07-bf04-9b572840868e"]
}, Open  ]],

Cell["\<\
If you apply the AA operator too many times, then the fidelity gets worse \
again:\
\>", "TechNoteMathCaption",
 CellID->1702758543,ExpressionUUID->"e885c9f7-9961-433e-87a1-c9f509fdf590"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mid", "=", 
   RowBox[{
    RowBox[{"MatrixPower", "[", 
     RowBox[{
      RowBox[{"N", "@", "AA"}], ",", "2"}], "]"}], ".", "out"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fdl", "=", 
  RowBox[{
   RowBox[{"Fidelity", "[", 
    RowBox[{"good", ",", "mid"}], "]"}], "//", "N"}]}]}], "Input",
 CellLabel->"In[268]:=",
 CellID->65468293,ExpressionUUID->"d1b59e0d-eaeb-4618-8109-f82fa6e4ba9a"],

Cell[BoxData["0.15309310892394853`"], "Output",
 CellLabel->"Out[269]=",
 CellID->1234794999,ExpressionUUID->"c75b8e4b-aa09-4739-b094-b18748b384b8"]
}, Open  ]],

Cell["Repeating the AA operation, the fidelity oscillates:", \
"TechNoteMathCaption",
 CellID->887215026,ExpressionUUID->"574ad45c-73f4-4865-a46c-efad8207dfc7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mid", "=", 
   RowBox[{
    RowBox[{"MatrixPower", "[", 
     RowBox[{
      RowBox[{"N", "@", "AA"}], ",", "5"}], "]"}], ".", "out"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fdl", "=", 
  RowBox[{
   RowBox[{"Fidelity", "[", 
    RowBox[{"good", ",", "mid"}], "]"}], "//", "N"}]}]}], "Input",
 CellLabel->"In[270]:=",
 CellID->976522519,ExpressionUUID->"33b87f5e-2a6a-42e9-9f36-06930a49de94"],

Cell[BoxData["0.8228754604662235`"], "Output",
 CellLabel->"Out[271]=",
 CellID->556534282,ExpressionUUID->"4579cf2f-50fc-4e37-a729-7523529fd03e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Oblivious Amplitude Amplification (OAA)", "TechNoteSection",
 CellID->635509592,ExpressionUUID->"ce91adf5-6d35-4e88-8955-9282241681a1"],

Cell["\<\
Oblivious amplitude amplification (OAA) is a generalization of the quantum \
amplitude amplification algorithm. Unlike the standard amplitude \
amplification, OAA does not require knowledge of the initial state or a full \
reflection about it. Instead, it amplifies the amplitude of a target state \
while handling scenarios where the initial state is unknown or \
\[OpenCurlyDoubleQuote]oblivious.\[CloseCurlyDoubleQuote]\
\>", "TechNoteText",
 CellID->162019086,ExpressionUUID->"c9b0b7ce-07ff-4978-afdd-1bcf310a5dfc"],

Cell[TextData[{
 "        Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "51f9f556-f189-4534-a146-f81f655e92d8"],
 " be a unitary operator on the quantum register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "3bc84782-f104-448e-a9f9-c7c5434e2901"],
 " qubits. Introduce an ancillary quantum register of ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "3fef9e27-6c7f-469d-8ced-b181a20c653e"],
 " qubits, and let ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "09cc5ff2-55d2-4cb6-9d8c-f680fb2ea03c"],
 " be a unitary gate on the overall quantum register such that"
}], "TechNoteText",
 CellID->1166117144,ExpressionUUID->"31af1105-04a0-49e7-872c-866b0d975864"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"V", "(", 
     RowBox[{
      TemplateBox[{
        SuperscriptBox["0", "m"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"\[Psi]"},
       "Ket"]}], ")"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{
         SuperscriptBox["0", "m"]},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Psi]"},
          "Ket"]}], ")"}]}], 
      SqrtBox["p"]}], "+", 
     RowBox[{
      TemplateBox[{
        SuperscriptBox["\[CapitalPhi]", "\[Perpendicular]"]},
       "Ket"], 
      SqrtBox[
       RowBox[{"1", "-", "p"}]]}]}]}], TraditionalForm]],ExpressionUUID->
  "12cc4e0e-049b-4198-bb8f-8bc11fc94563"],
 ", "
}], "TechNoteText",
 CellID->45514006,ExpressionUUID->"b47c7ed8-0b33-4289-a029-71347b548216"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SuperscriptBox["\[CapitalPhi]", "\[Perpendicular]"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "65ef44db-9c9b-4169-812e-b82216a41699"],
 " is a normalized state that is not of our interest, such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[CapitalPi]", 
     TemplateBox[{
       SuperscriptBox["\[CapitalPhi]", "\[Perpendicular]"]},
      "Ket"]}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "fb658efb-7b66-4b45-a4f4-15ff9e754c8f"],
 ", where\t"
}], "TechNoteText",
 CellID->449720510,ExpressionUUID->"f71009f2-2ed8-47c2-8d08-0397e0cc3be4"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalPi]", ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       TemplateBox[{
         SuperscriptBox["0", "m"]},
        "Ket"], 
       TemplateBox[{
         SuperscriptBox["0", "m"]},
        "Bra"]}], ")"}], "\[CircleTimes]", 
     SubscriptBox["I", "n"]}]}], TraditionalForm]],ExpressionUUID->
  "61a39f35-83ac-4834-af44-55e83c61776e"],
 " ,\[LineSeparator]where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["I", "k"], TraditionalForm]],ExpressionUUID->
  "8d204411-a8ae-4149-8915-811e08273546"],
 " denotes the identity matrix on ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "c912d0ce-be5b-47eb-a5a0-a43b5aa9c0c7"],
 " qubits, i.e., the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", "k"], "\[Times]", 
    SuperscriptBox["2", "k"]}], TraditionalForm]],ExpressionUUID->
  "e2d36336-7ac9-4f8f-aaae-f5dea54a62bf"],
 " (not ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "\[Times]", "k"}], TraditionalForm]],ExpressionUUID->
  "2da6514f-d87d-4983-b958-2458d046c212"],
 ") identity matrix."
}], "TechNoteText",
 CellID->7974949,ExpressionUUID->"4df222ba-0c6e-4705-bbff-fb124403f5ef"],

Cell[TextData[{
 "In the matrix form, the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{"m", "+", "n"}]], "\[Times]", 
    SuperscriptBox["2", 
     RowBox[{"m", "+", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "6a6dce49-6118-416d-858a-95b303aad1c6"],
 " unitary matrix ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "36be0d51-641f-48a3-bed7-921d50a0b952"],
 " is a ",
 ButtonBox["block encoding",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/BlockEncoding"],
 " of the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", "n"], "\[Times]", 
    SuperscriptBox["2", "n"]}], TraditionalForm]],ExpressionUUID->
  "543924d8-2fac-4264-b334-7ffc98cd5078"],
 " unitary matrix ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d0b7d24d-ede0-4787-b62c-a7ba79dde7eb"],
 ","
}], "TechNoteText",
 CellID->1154511227,ExpressionUUID->"ab25c2e5-2d53-4a26-83cd-c998b1ac45a1"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SqrtBox["p"], "U"}], "*"},
       {"*", "*"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "cda01e2f-be24-4e7f-80f6-901e1eb7c7ba"],
 " ."
}], "TechNoteText",
 CellID->1457657777,ExpressionUUID->"c3c54bc4-9f77-4d94-a904-16ce77d498f2"],

Cell[TextData[{
 "Here, it is important that ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "bdc5d0ed-9462-4c42-8cab-356225be4f46"],
 " is unitary. The goal is to increase the success probability for ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SuperscriptBox["0", "m"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "e7e6c1ea-8ef3-4371-9391-bfc743a275aa"],
 " on the ancillary register."
}], "TechNoteText",
 CellID->360813063,ExpressionUUID->"0bcbe9bc-28af-4d43-a684-08f8945cddb5"],

Cell["        For later use, we define the product states", "TechNoteText",
 CellID->1710258253,ExpressionUUID->"ba81d7cc-1fe0-4ce5-83ef-82ee9e0bb44d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[CapitalPsi]"},
     "Ket"], ":=", 
    RowBox[{
     TemplateBox[{
       SuperscriptBox["0", "m"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"\[Psi]"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "0f4b11b6-87a8-45fe-bfbd-6376e11c9036"],
 "  ,       ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[CapitalPhi]"},
     "Ket"], ":=", 
    RowBox[{
     TemplateBox[{
       SuperscriptBox["0", "m"]},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{"U", 
       TemplateBox[{"\[Psi]"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "ec857166-0781-4e90-9877-37c108e822af"]
}], "TechNoteText",
 CellID->1161918896,ExpressionUUID->"d87d8b4c-d923-42b8-b2ec-a796c3165e57"],

Cell[TextData[{
 "so that the operation of ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "19a4adab-defd-49bf-8b84-0db72f4823be"],
 " reads as"
}], "TechNoteText",
 CellID->1840366080,ExpressionUUID->"8e19fb46-5748-41e1-b8bb-a6f5de62b887"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"V", 
     TemplateBox[{"\[CapitalPsi]"},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"\[CapitalPhi]"},
       "Ket"], 
      SqrtBox["p"]}], "+", 
     RowBox[{
      TemplateBox[{
        SuperscriptBox["\[CapitalPhi]", "\[Perpendicular]"]},
       "Ket"], 
      SqrtBox[
       RowBox[{"1", "-", "p"}]]}]}]}], TraditionalForm]],ExpressionUUID->
  "0b7e7584-a96b-4f86-b2af-1e1922e7dc59"],
 "."
}], "TechNoteText",
 CellID->960150010,ExpressionUUID->"6b5562a5-bdd1-4539-aa05-88d51eb96a95"],

Cell["\<\
        If you follow the standard amplitude amplification idea in the above, \
you need an oracle\
\>", "TechNoteText",
 CellID->1838814360,ExpressionUUID->"de98f962-39a0-4302-9775-f1bdf865db31"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["I", "m"], "\[CircleTimes]", "U"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["I", 
       RowBox[{"m", "+", "n"}]], "-", 
      RowBox[{"2", 
       TemplateBox[{
         SuperscriptBox["0", "m"]},
        "Ket"], 
       RowBox[{
        TemplateBox[{
          SuperscriptBox["0", "m"]},
         "Bra"], "\[CircleTimes]", 
        TemplateBox[{"\[Psi]"},
         "Ket"]}], 
       TemplateBox[{"\[Psi]"},
        "Bra"]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["I", "m"], "\[CircleTimes]", 
      SuperscriptBox["U", "\[Dagger]"]}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"980ec10d-c4a7-46b8-ae58-1551c1abd916"]
}], "TechNoteText",
 CellID->515784543,ExpressionUUID->"4273cd8c-b6bf-4e3a-abfe-0a512f5b28b0"],

Cell[TextData[{
 "and the reflection in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", 
    TemplateBox[{"\[CapitalPsi]"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "f9b93ae5-fe79-4cff-8a1f-594da1ecbe2d"],
 ",\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"V", "(", 
     RowBox[{
      RowBox[{"2", 
       TemplateBox[{
         SuperscriptBox["0", "m"]},
        "Ket"], 
       RowBox[{
        TemplateBox[{
          SuperscriptBox["0", "m"]},
         "Bra"], "\[CircleTimes]", 
        TemplateBox[{"\[Psi]"},
         "Ket"]}], 
       TemplateBox[{"\[Psi]"},
        "Bra"]}], "-", 
      SubscriptBox["I", 
       RowBox[{"m", "+", "n"}]]}], ")"}], 
    SuperscriptBox["V", "\[Dagger]"]}], TraditionalForm]],ExpressionUUID->
  "fcd8dfd2-8866-4370-aa93-0f1cf7ce9769"],
 "."
}], "TechNoteText",
 CellID->1546814909,ExpressionUUID->"1d43b504-1663-4180-b5eb-4d92c2dd8954"],

Cell[TextData[{
 "Note that both require an access to the initial state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Psi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "0edde61c-16de-422e-8f69-4b9dc2c748d4"],
 " or the reflection about it."
}], "TechNoteText",
 CellID->2028628628,ExpressionUUID->"732bd6e9-652d-44b7-8e50-dffa5aab95e0"],

Cell[TextData[{
 "        However, the OAA lemma (",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Berry et al., 2014"]], 
    "https://doi.org/10.1145/2591796.2591854"},
   "WebLink",
   BaseStyle->{"TechNoteText"}]],ExpressionUUID->
  "fc62b0d2-02a1-4048-85cc-0bd7bac23cb9"],
 ") asserts that the goal can be achieved by just repeatedly applying"
}], "TechNoteText",
 CellID->1710971024,ExpressionUUID->"cd38bc2b-a0d4-4efa-b60b-1f365b526d6e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalOmega]", "OAA"], ":=", 
    RowBox[{
     RowBox[{"-", "V"}], "\[VeryThinSpace]", "Z", "\[VeryThinSpace]", 
     SuperscriptBox["V", "\[Dagger]"], "Z"}]}], TraditionalForm]],
  ExpressionUUID->"33fed0a7-ca42-441f-b092-197f2cf006f1"],
 "    with    ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        TemplateBox[{
          SuperscriptBox["0", "m"]},
         "Ket"], 
        TemplateBox[{
          SuperscriptBox["0", "m"]},
         "Bra"]}], "-", 
       SubscriptBox["I", "m"]}], ")"}], "\[CircleTimes]", 
     SubscriptBox["I", "n"]}]}], TraditionalForm]],ExpressionUUID->
  "83a437e0-81b4-48cb-a110-2f594387843f"],
 "."
}], "TechNoteText",
 CellID->1483967038,ExpressionUUID->"944edf85-fec2-4eb2-968b-a7e1201f1332"],

Cell[TextData[{
 "Here, the crucial point is that it does not require a copy (or knowledge) \
of the initial state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Psi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "a4fe1907-22e4-422e-9c33-2b460b8e02e2"],
 " at all."
}], "TechNoteText",
 CellID->158931408,ExpressionUUID->"990dd127-5a16-446b-9747-c9e35c0b86e9"],

Cell[TextData[{
 "To understand the OAA lemma, the key observation is that over the transform \
",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "af8a4b84-ea90-43ae-80fb-76a3ddc13133"],
 " (and hence the OAA process), the state remains in the two-dimensional \
subspace spanned by ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[CapitalPhi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "ff519d08-5e20-41e5-8033-952b3c00b4f8"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SuperscriptBox["\[CapitalPhi]", "\[Perpendicular]"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "dcbff782-9795-4446-b08b-e676fac1dac4"],
 " (",
 ButtonBox["Berry et al., 2014",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1145/2591796.2591854"], None},
  ButtonNote->"https://doi.org/10.1145/2591796.2591854"],
 ") as shown in ",
 ButtonBox["Figure 2",
  BaseStyle->"Link",
  ButtonData->
   "paclet:QuantumMob/Q3/tutorial/AmplitudeAmplification#1519958685"],
 ". This can be clearly seen by recalling the unitary gate ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "226122b3-1dc9-4ce8-a58d-46fef2b2fa72"]
}], "TechNoteText",
 CellID->1838001035,ExpressionUUID->"ce571c03-0109-4628-b076-5d4aa9796744"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"V", 
     TemplateBox[{"\[CapitalPsi]"},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"\[CapitalPhi]"},
       "Ket"], 
      SqrtBox["p"]}], "+", 
     RowBox[{
      TemplateBox[{
        SuperscriptBox["\[CapitalPhi]", "\[Perpendicular]"]},
       "Ket"], 
      SqrtBox[
       RowBox[{"1", "-", "p"}]]}]}]}], TraditionalForm]],ExpressionUUID->
  "e58c9e83-516f-4fe4-80f9-d82b44e62a63"],
 ", "
}], "TechNoteText",
 CellID->1878616797,ExpressionUUID->"ed33a1f5-de09-425c-bbbc-303866e1fa0f"],

Cell[TextData[{
 "and defining a new state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     SuperscriptBox["\[CapitalPsi]", "\[Perpendicular]"]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "11026e3f-e61e-4bc8-90bb-232f84be7c22"],
 " through"
}], "TechNoteText",
 CellID->1607928985,ExpressionUUID->"9aad81aa-0b26-4216-ace2-790291d81eef"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"V", 
     TemplateBox[{
       SuperscriptBox["\[CapitalPsi]", "\[Perpendicular]"]},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"\[CapitalPhi]"},
       "Ket"], 
      SqrtBox[
       RowBox[{"1", "-", "p"}]]}], "-", 
     RowBox[{
      TemplateBox[{
        SuperscriptBox["\[CapitalPhi]", "\[Perpendicular]"]},
       "Ket"], 
      SqrtBox["p"]}]}]}], TraditionalForm]],ExpressionUUID->
  "4821c80e-8bfd-443f-acad-547182ce469b"],
 "."
}], "TechNoteText",
 CellID->528237047,ExpressionUUID->"7b28613d-48bf-417a-b029-dae2bab135e3"],

Cell[TextData[{
 "One can see that not only ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[CapitalPsi]", 
      SuperscriptBox["\[CapitalPsi]", "\[Perpendicular]"]},
     "BraKet"], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "a0461e64-3c68-45d2-b9ed-d51a766901df"],
 " but also ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[CapitalPi]", 
     TemplateBox[{
       SuperscriptBox["\[CapitalPsi]", "\[Perpendicular]"]},
      "Ket"]}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "af15ca34-e8b3-40f7-8f7c-4dd1390b7a30"],
 "; hence, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Z", 
     TemplateBox[{
       SubscriptBox["\[CapitalPsi]", "\[Perpendicular]"]},
      "Ket"]}], "=", 
    RowBox[{"-", 
     TemplateBox[{
       SubscriptBox["\[CapitalPsi]", "\[Perpendicular]"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "70c8b338-e782-4284-aa9c-0b7e1c9801e5"],
 ". Then, one can show that\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[CapitalOmega]", "OAA", "k"], "V", 
     TemplateBox[{"\[CapitalPsi]"},
      "Ket"]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"V", 
       TemplateBox[{"\[CapitalPsi]"},
        "Ket"], 
       RowBox[{"cos", "(", 
        RowBox[{"2", "k", "\[VeryThinSpace]", "\[Theta]"}], ")"}]}], "+", 
      RowBox[{"V", 
       TemplateBox[{
         SubscriptBox["\[CapitalPsi]", "\[Perpendicular]"]},
        "Ket"], 
       RowBox[{"sin", "(", 
        RowBox[{"2", "k", "\[VeryThinSpace]", "\[Theta]"}], ")"}]}]}], "=", 
     RowBox[{
      RowBox[{
       TemplateBox[{"\[CapitalPhi]"},
        "Ket"], 
       RowBox[{"sin", "(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "k"}], "+", "1"}], ")"}], "\[Theta]"}], ")"}]}], "+", 
      
      RowBox[{
       TemplateBox[{
         SubscriptBox["\[CapitalPhi]", "\[Perpendicular]"]},
        "Ket"], 
       RowBox[{"cos", "(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "k"}], "+", "1"}], ")"}], "\[Theta]"}], ")"}]}]}]}]}],
    TraditionalForm]],ExpressionUUID->
  "b1c9b70a-5348-4b7d-8df0-d1258e90f998"],
 "\[LineSeparator]with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"sin", "(", "\[Theta]", ")"}], ":=", 
    SqrtBox["p"]}], TraditionalForm]],ExpressionUUID->
  "261d3dd6-8d83-4dd3-9678-cf6f0e3aa8ec"],
 "."
}], "TechNoteText",
 CellID->382652231,ExpressionUUID->"e53ddd98-71dd-4c05-af25-79029d4f18b5"],

Cell[TextData[Cell[BoxData[
 GraphicsBox[{CircleBox[{0, 0}], 
   {GrayLevel[0.8], ArrowBox[{{-1.5, 0}, {1.5, 0}}], 
    LineBox[{{0, -1.5}, {0, 1.5}}], InsetBox[
     StyleBox["\<\"\\!\\(\\*TemplateBox[{SuperscriptBox[\\\"\[CapitalPhi]\\\",\
 \\\"\[Perpendicular]\\\"]},\\\"Ket\\\"]\\)\"\>",
      StripOnInput->False,
      FontSize->14], {1.5, 0}, NCache[
     ImageScaled[{1, Rational[3, 2]}], ImageScaled[{1, 1.5}]]]}, 
   ArrowBox[{{0, 0}, {0, 1.5}}], InsetBox[
    StyleBox["\<\"\\!\\(\\*StyleBox[TemplateBox[{\\\"\[CapitalPhi]\\\"},\\\"\
Ket\\\"],FontWeight->\\\"Plain\\\"]\\)\"\>",
     StripOnInput->False,
     FontSize->14], {0, 1.5}, ImageScaled[{-0.25, 1}]], 
   {Thickness[Large], InsetBox[
     RotationBox[
      StyleBox["\<\"\\!\\(\\*FormBox[RowBox[{\\\"V\\\", RowBox[{\\\"(\\\", \
RowBox[{TemplateBox[{SuperscriptBox[\\\"0\\\", \\\"m\\\"]},\\\"Ket\\\"], \\\"\
\[CircleTimes]\\\", TemplateBox[{\\\"\[Psi]\\\"},\\\"Ket\\\"]}], \
\\\")\\\"}]}],TraditionalForm]\\)\"\>",
       StripOnInput->False,
       FontSize->12],
      BoxRotation->0.19634954084936207`], {0.9807852804032304, 0.19509032201612825},
      ImageScaled[{-0.09999999999999998, 0.2}]], 
    {RGBColor[0, 0, 1], 
     ArrowBox[{{0, 0}, {0.9807852804032304, 0.19509032201612825`}}]}, 
    {RGBColor[0, 0, 1], 
     ArrowBox[{{0, 0}, {0.5555702330196023, 0.8314696123025451}}]}}, 
   {LightDarkSwitched[
     GrayLevel[0]], Dashing[{Small, Small}], 
    ArrowBox[{{0.9807852804032304, 0.19509032201612825`}, {0.5555702330196023,
      0.8314696123025451}}]}},
  ImageSize->400,
  PlotRangePadding->Scaled[
   0.025]]],ExpressionUUID->"f3305881-70cc-4a64-a8b9-1a2465f25a73"]], \
"Picture",
 CellID->956114126,ExpressionUUID->"40ea6d2a-c515-45d7-8c17-9b7395675cb3"],

Cell[TextData[{
 StyleBox["Figure 2",
  FontWeight->"Bold"],
 ". Geometric demonstration of the oblivious amplitude amplification process ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalOmega]", "OAA"], ":=", 
    RowBox[{
     RowBox[{"-", "V"}], "\[VeryThinSpace]", "Z", "\[VeryThinSpace]", 
     SuperscriptBox["V", "\[Dagger]"], "Z"}]}], TraditionalForm]],
  ExpressionUUID->"21922f70-7927-4bfa-8cb6-2aa384eb8b03"],
 ". Unlike the standard amplitude amplification, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalOmega]", "OAA"], TraditionalForm]],ExpressionUUID->
  "2f095216-8816-43ab-b804-3e8124167128"],
 " does not require the information about initial state."
}], "TechNoteCaption",
 CellID->1519958685,ExpressionUUID->"a67d19ad-ca4c-41ec-8bad-22aae08483a6"],

Cell[CellGroupData[{

Cell["Demonstration", "Subsection",
 CellID->617274088,ExpressionUUID->"4bae9f92-d31c-409e-af8e-1faaa3c09785"],

Cell["\<\
Set the number of qubits in the ancillary and system register respectively:\
\>", "TechNoteMathCaption",
 CellID->1563943485,ExpressionUUID->"510cf9a6-c1dc-47b9-8a68-ed052397ea99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$m", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]}], "Input",
 CellLabel->"In[226]:=",
 CellID->1874195322,ExpressionUUID->"d5c90200-0d15-422b-bc14-9934e8454eb2"],

Cell["Set the ancillary and system registers:", "TechNoteMathCaption",
 CellID->1573982178,ExpressionUUID->"a76210b5-0984-48a2-8ec6-9e9102493090"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "A", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AA", "=", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$m"}], ",", "$"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AS", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"AA", ",", "SS"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[228]:=",
 CellID->1718584036,ExpressionUUID->"c93f19bd-05f6-4ecc-b1f5-7155d10d1204"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["A", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`A[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["A", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`A[2, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[229]=",
 CellID->1521480529,ExpressionUUID->"475ed774-5781-453f-ac26-280ec3442135"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[230]=",
 CellID->1435466074,ExpressionUUID->"8493f0f9-800c-4651-9310-172f01b72a27"]
}, Open  ]],

Cell["Take a unitary operator on the system register:", "TechNoteMathCaption",
 CellID->1923303247,ExpressionUUID->"fca354f2-8ba0-49e1-b333-57dbc1625103"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"UU", "=", 
  RowBox[{
   RowBox[{"Rotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "]"}], "**", 
   RowBox[{"Rotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "4"}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UU", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", 
     RowBox[{"UU", ",", "SS"}], "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UU", "//", "IntegerChop"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[232]:=",
 CellID->1534262640,ExpressionUUID->"df3ec777-c744-4c14-92d7-2beef36ee360"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
      InterpretationBox[
       TagBox[
        RowBox[{"Exp", 
          RowBox[{"(", 
            RowBox[{
              RowBox[{"-", 
                FractionBox["1", "6"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", 
              " ", 
              InterpretationBox[
               TemplateBox[{"S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
                 TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
                "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
               $CellContext`S[1, 3]]}], ")"}]}], DisplayForm], 
       QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 0, 1}, 
        $CellContext`S[1, QuantumMob`Q3`$]]], 
      InterpretationBox[
       TagBox[
        RowBox[{"Exp", 
          RowBox[{"(", 
            RowBox[{
              RowBox[{"-", 
                FractionBox["1", "8"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", 
              " ", 
              InterpretationBox[
               TemplateBox[{"S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
                 TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
                "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
               $CellContext`S[2, 2]]}], ")"}]}], DisplayForm], 
       QuantumMob`Q3`Rotation[Rational[1, 4] Pi, {0, 1, 0}, 
        $CellContext`S[2, QuantumMob`Q3`$]]]}, "RowWithSeparators"]},
   "RowDefault"],
  QuantumMob`Q3`Multiply[
   QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 0, 1}, 
    $CellContext`S[1, QuantumMob`Q3`$]], 
   QuantumMob`Q3`Rotation[Rational[1, 4] Pi, {0, 1, 0}, 
    $CellContext`S[2, QuantumMob`Q3`$]]]]], "Output",
 CellLabel->"Out[232]=",
 CellID->1650539534,ExpressionUUID->"9c5ef7e2-8d4d-4619-bce3-f95c9e220b27"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.8001031451912655`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3314135740355918`"}], "+", 
       RowBox[{"0.1913417161825449`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {
      RowBox[{"0.3314135740355918`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1913417161825449`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.8001031451912655`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}], "0", "0"},
     {"0", "0", 
      RowBox[{"0.8001031451912655`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3314135740355918`"}], "-", 
       RowBox[{"0.1913417161825449`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", 
      RowBox[{"0.3314135740355918`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1913417161825449`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.8001031451912655`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.46193976625564337`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {Complex[
      0.8001031451912655, -0.46193976625564337`], Complex[-0.3314135740355918,
       0.1913417161825449], Complex[
      0.8001031451912655, -0.46193976625564337`], Complex[
      0.3314135740355918, -0.1913417161825449], Complex[0.8001031451912655, 
      0.46193976625564337`], 
      Complex[-0.3314135740355918, -0.1913417161825449], Complex[
      0.8001031451912655, 0.46193976625564337`], Complex[0.3314135740355918, 
      0.1913417161825449]}}]]]]], "Output",
 CellLabel->"Out[234]//MatrixForm=",
 CellID->1571679639,ExpressionUUID->"03de6fe2-465e-4280-a4eb-fde695d321bb"]
}, Open  ]],

Cell["\<\
Embed the unitary operator into the larger register including the ancillary \
and system registers:\
\>", "TechNoteMathCaption",
 CellID->788095177,ExpressionUUID->"db2d06eb-b9a6-4dbf-8175-5a98a361909c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$p", "=", "0.1"}], ";"}]], "Input",
 CellLabel->"In[259]:=",
 CellID->189140081,ExpressionUUID->"b8b1cf36-fdb2-4c34-aaf6-d65aee4fa777"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"VV", "=", 
  RowBox[{"BlockEncoding", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", "$p", "]"}], "*", "UU"}], ",", "SS", ",", "AA"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VV", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"VV", ",", 
     RowBox[{"Join", "[", 
      RowBox[{"AA", ",", "SS"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"VV", "//", "ArrayShort"}]}], "Input",
 CellLabel->"In[260]:=",
 CellID->1163884679,ExpressionUUID->"14cf020e-c5b0-44af-a532-ae59d80af232"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BlockEncoding",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"System Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Ancilla Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, QuantumMob`Q3`$]]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"System Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Ancilla Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, QuantumMob`Q3`$]]}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"0.2530148301868796`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.1460781803173624`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.10480217414493112`"}], "+", 
                    RowBox[{"0.06050756345423402`", " ", "\[ImaginaryI]"}]}], 
                    "0.`", "0.`"}, {
                    RowBox[{
                    RowBox[{"0.10480217414493112`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.06050756345423402`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.2530148301868796`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.1460781803173624`", " ", "\[ImaginaryI]"}]}], 
                    "0.`", "0.`"}, {"0.`", "0.`", 
                    RowBox[{
                    RowBox[{"0.2530148301868796`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.1460781803173624`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.10480217414493112`"}], "-", 
                    
                    RowBox[{
                    "0.06050756345423402`", " ", "\[ImaginaryI]"}]}]}, {
                    "0.`", "0.`", 
                    RowBox[{
                    RowBox[{"0.10480217414493112`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.06050756345423402`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.2530148301868796`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.1460781803173624`", " ", "\[ImaginaryI]"}]}]}},
                     RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {4, 4}, 0., {
                    1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {
                    3}}}, {Complex[0.2530148301868796, -0.1460781803173624], 
                    Complex[-0.10480217414493112`, 0.06050756345423402], 
                    Complex[0.2530148301868796, -0.1460781803173624], Complex[
                    0.10480217414493112`, -0.06050756345423402], Complex[
                    0.2530148301868796, 0.1460781803173624], 
                    Complex[-0.10480217414493112`, -0.06050756345423402], 
                    Complex[0.2530148301868796, 0.1460781803173624], Complex[
                    0.10480217414493112`, 0.06050756345423402]}}]]]], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`Private`vec,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[260]=",
 CellID->1119111113,ExpressionUUID->"27786672-31ec-4c9b-af22-e1c2043daab1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.25301483018687965`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1460781803173624`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1048021741449311`"}], "+", 
       RowBox[{"0.06050756345423401`", " ", "\[ImaginaryI]"}]}], "0", 
      "0", "\<\"\[Ellipsis]\"\>"},
     {
      RowBox[{"0.1048021741449311`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.06050756345423401`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2530148301868796`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1460781803173624`", " ", "\[ImaginaryI]"}]}], "0", 
      "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", 
      RowBox[{"0.25301483018687965`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1460781803173624`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1048021741449311`"}], "-", 
       RowBox[{
       "0.06050756345423401`", " ", 
        "\[ImaginaryI]"}]}], "\<\"\[Ellipsis]\"\>"},
     {"0", "0", 
      RowBox[{"0.1048021741449311`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.06050756345423401`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.2530148301868796`", "\[VeryThinSpace]", "+", 
       RowBox[{
       "0.1460781803173624`", " ", "\[ImaginaryI]"}]}], "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {5, 5}, 0, {
     1, {{0, 3, 6, 9, 12, 17}, {{1}, {2}, {5}, {1}, {2}, {5}, {3}, {4}, {5}, {
       3}, {4}, {5}, {1}, {2}, {3}, {4}, {5}}}, {
      Complex[0.25301483018687965`, -0.1460781803173624], 
       Complex[-0.1048021741449311, 0.06050756345423401], "\[Ellipsis]", 
       Complex[0.1048021741449311, -0.06050756345423401], Complex[
       0.2530148301868796, -0.1460781803173624], "\[Ellipsis]", Complex[
       0.25301483018687965`, 0.1460781803173624], 
       Complex[-0.1048021741449311, -0.06050756345423401], "\[Ellipsis]", 
       Complex[0.1048021741449311, 0.06050756345423401], Complex[
       0.2530148301868796, 0.1460781803173624], "\[Ellipsis]", "\[Ellipsis]", 
       "\[Ellipsis]", "\[Ellipsis]", "\[Ellipsis]", "\[Ellipsis]"}}], 
    TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[262]//MatrixForm=",
 CellID->1238695765,ExpressionUUID->"fcca18d9-daa1-49a6-960d-d62c32a99894"]
}, Open  ]],

Cell["Construct the \"phase marker\" operator:", "TechNoteMathCaption",
 CellID->1974888155,ExpressionUUID->"67f9323e-3e95-4c5d-9a9b-cade46a8f8a6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ZZ", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{
      RowBox[{"Ket", "[", "AA", "]"}], "**", 
      RowBox[{"Bra", "[", "AA", "]"}]}]}], "-", "1"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZZ", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"ZZ", ",", "AS"}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[267]:=",
 CellID->420239022,ExpressionUUID->"2f85c4a7-4b0e-49f2-8eef-6fae6ed3166a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{"2", " ", 
   InterpretationBox[
    TemplateBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           SubscriptBox["0", 
            TemplateBox[{",", "\",\"", 
              InterpretationBox[
               SubscriptBox["A", 
                TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
               $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
           SubscriptBox["0", 
            TemplateBox[{",", "\",\"", 
              InterpretationBox[
               SubscriptBox["A", 
                TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
               $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
          "RowWithSeparators"]}, "Ket"], 
       Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
         0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           SubscriptBox["0", 
            TemplateBox[{",", "\",\"", 
              InterpretationBox[
               SubscriptBox["A", 
                TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
               $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
           SubscriptBox["0", 
            TemplateBox[{",", "\",\"", 
              InterpretationBox[
               SubscriptBox["A", 
                TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
               $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
          "RowWithSeparators"]}, "Bra"], 
       Bra[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
         0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>]]},
     "RowDefault"],
    QuantumMob`Q3`Dyad[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      0|>, <|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>]]}]}]], "Output",
 CellLabel->"Out[267]=",
 CellID->1863202789,ExpressionUUID->"047b2980-025f-43d0-ba7f-cb3584c883ab"]
}, Open  ]],

Cell["\<\
Construct the oblivious amplitude amplification (OAA) operator:\
\>", "TechNoteMathCaption",
 CellID->242734169,ExpressionUUID->"2037ed35-0a1b-437a-8ed5-4fb6c4667f29"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"OAA", "=", 
   RowBox[{"-", 
    RowBox[{"VV", ".", "ZZ", ".", 
     RowBox[{"ConjugateTranspose", "[", "VV", "]"}], ".", "ZZ"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OAA", "//", "IntegerChop"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[269]:=",
 CellID->575262923,ExpressionUUID->"89777d37-d303-40ec-9339-2904de966248"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.8000000000000004`", "0", "0", "0", "0.6000000000000001`", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0.7999999999999997`", "0", "0", "0", "0.5999999999999999`", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0.8000000000000004`", "0", "0", "0", "0.6000000000000001`", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0.7999999999999997`", "0", "0", "0", 
      "0.5999999999999999`", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "0.6000000000000001`"}], "0", "0", "0", 
      "0.8000000000000004`", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0"},
     {"0", 
      RowBox[{"-", "0.5999999999999999`"}], "0", "0", "0", 
      "0.7999999999999997`", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "0.6000000000000001`"}], "0", "0", "0", 
      "0.8000000000000004`", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "0.5999999999999999`"}], "0", "0", "0", 
      "0.7999999999999997`", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60, 64}, {{
       1}, {2}, {5}, {6}, {1}, {2}, {5}, {6}, {3}, {4}, {7}, {8}, {3}, {4}, {
       7}, {8}, {1}, {2}, {5}, {6}, {1}, {2}, {5}, {6}, {3}, {4}, {7}, {8}, {
       3}, {4}, {7}, {8}, {9}, {10}, {13}, {14}, {9}, {10}, {13}, {14}, {
       11}, {12}, {15}, {16}, {11}, {12}, {15}, {16}, {9}, {10}, {13}, {14}, {
       9}, {10}, {13}, {14}, {11}, {12}, {15}, {16}, {11}, {12}, {15}, {
       16}}}, {0.8000000000000004, 0, 0.6000000000000001, 0, 0, 
       0.7999999999999997, 0, 0.5999999999999999, 0.8000000000000004, 0, 
       0.6000000000000001, 0, 0, 0.7999999999999997, 0, 
       0.5999999999999999, -0.6000000000000001, 0, 0.8000000000000004, 0, 
       0, -0.5999999999999999, 0, 0.7999999999999997, -0.6000000000000001, 0, 
       0.8000000000000004, 0, 0, -0.5999999999999999, 0, 
       0.7999999999999997, -1, 0, 0, 0, 0, -1, 0, 0, -1, 0, 0, 0, 0, -1, 0, 0,
        0, 0, -1, 0, 0, 0, 0, -1, 0, 0, -1, 0, 0, 0, 0, -1}}]]]]], "Output",
 CellLabel->"Out[270]//MatrixForm=",
 CellID->1342986410,ExpressionUUID->"bf57e6c5-13d9-48b2-b721-e206f31c08ce"]
}, Open  ]],

Cell[TextData[{
 "Take an arbitrary input state of the form ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{
      SuperscriptBox["0", "m"]},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"\[Psi]"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "1fb907ba-90c0-479e-bd41-737a9fa5dbdc"],
 ":"
}], "TechNoteMathCaption",
 CellID->1519462900,ExpressionUUID->"a39e365e-ce6b-49fc-baa2-83e109f92cff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"Ket", "[", 
    RowBox[{"AA", "->", "0"}], "]"}], "**", 
   RowBox[{"First", "[", 
    RowBox[{"GHZState", "[", "SS", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Matrix", "[", "in", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "Normal"}]}], "Input",
 CellLabel->"In[271]:=",
 CellID->1740420427,ExpressionUUID->"f546c008-f3ea-4592-b62f-8a236e40a887"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], 
   SqrtBox["2"]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
   SqrtBox["2"]]}]], "Output",
 CellLabel->"Out[271]=",
 CellID->860597013,ExpressionUUID->"37a32aec-2a21-4c0d-b0a0-141a54d33ba2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    SqrtBox["2"]], ",", "0", ",", "0", ",", 
   FractionBox["1", 
    SqrtBox["2"]], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellLabel->"Out[273]=",
 CellID->751634946,ExpressionUUID->"72b5cd66-d575-4076-a488-b900d5363a1e"]
}, Open  ]],

Cell["\<\
Apply the embedded unitary operator on the input state to get the output \
state:\
\>", "TechNoteMathCaption",
 CellID->1222680484,ExpressionUUID->"b898e5b7-d63f-45f9-a867-175e725e1bcd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"VV", ".", "in"}], "//", "Chop"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExpressionFor", "[", 
  RowBox[{"out", ",", "AS"}], "]"}]}], "Input",
 CellLabel->"In[276]:=",
 CellID->2110635699,ExpressionUUID->"791ffbc2-f56d-4a12-a2c9-1081c512360f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17890850216590537`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.1032928718857982`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.07410632802097424`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.04278530843156419`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.07410632802097424`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.04278530843156419`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17890850216590534`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.1032928718857982`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.5367255064977162`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.3098786156573946`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2223189840629227`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.12835592529469256`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.22231898406292275`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.12835592529469256`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.536725506497716`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.30987861565739455`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[277]=",
 CellID->456623575,ExpressionUUID->"cc24c62e-8142-4fdb-9d17-b8eeb5a415f7"]
}, Open  ]],

Cell["\<\
We want the output state to be close to the desired \"good\" state:\
\>", "TechNoteMathCaption",
 CellID->1513354294,ExpressionUUID->"1ab21410-58a4-4c2d-9554-636070a17e1f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"good", "=", 
  RowBox[{
   RowBox[{"MatrixEmbed", "[", 
    RowBox[{"UU", ",", "SS", ",", "AS"}], "]"}], ".", "in"}]}]], "Input",
 CellLabel->"In[278]:=",
 CellID->760373933,ExpressionUUID->"2b741114-7d15-41eb-94e5-5f434dfac30f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGIBIAaxd3YbuO7c8sL+hvvydTXT3tqfjMj9F//1vf2M
PSu4Dp+9aL+o59EEa5sn9tffGyhE73tnn5l9a9I8ncv27TbPvQ5M22pv8fLB
i9ZXj+1xmWNVvjtultI5+znGi7aY/7hi/2KR4uPAVa9GxaHiAKRq0Ps=
              "], {{0, 0}, {16, 1}}, {0, 1}], AspectRatio -> 1, Axes -> False,
              Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", "16", "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGIBIAaxd3YbuO7c8sL+hvvydTXT3tqfjMj9F//1vf2M
PSu4Dp+9aL+o59EEa5sn9tffGyhE73tnn5l9a9I8ncv27TbPvQ5M22pv8fLB
i9ZXj+1xmWNVvjtultI5+znGi7aY/7hi/2KR4uPAVa9GxaHiAKRq0Ps=
              "], {{0, 0}, {16, 1}}, {0, 1}], AspectRatio -> 1, Axes -> False,
              Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", "16", "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.25`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", "1", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.5657583596134286`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.3266407412190941`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "2", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.23434478557783686`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.13529902503654923`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "3", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.23434478557783686`"}], "-", 
                    RowBox[{"0.13529902503654923`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "4", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.5657583596134286`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.3266407412190941`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}}, GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {16}, Complex[0., 0.], {
   1, {{0, 4}, {{1}, {2}, {3}, {4}}}, {Complex[
    0.5657583596134286, -0.3266407412190941], Complex[
    0.23434478557783686`, -0.13529902503654923`], 
    Complex[-0.23434478557783686`, -0.13529902503654923`], Complex[
    0.5657583596134286, 0.3266407412190941]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[278]=",
 CellID->261299191,ExpressionUUID->"63491bd4-cf5e-40d3-a11a-bbe5a025cb29"]
}, Open  ]],

Cell["Check the fidelity between the desired and output states:", \
"TechNoteMathCaption",
 CellID->1099486414,ExpressionUUID->"2ea686b5-96d3-41af-8bd7-368858065cf1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fdl", "=", 
  RowBox[{"Fidelity", "[", 
   RowBox[{"good", ",", "out"}], "]"}]}]], "Input",
 CellLabel->"In[280]:=",
 CellID->363472710,ExpressionUUID->"56e48371-7a9d-4a9b-91d0-63d8f16e74fe"],

Cell[BoxData["0.3162277660168379`"], "Output",
 CellLabel->"Out[280]=",
 CellID->1418740836,ExpressionUUID->"bb6cc6a6-9744-43a5-95ec-f046bb54eda3"]
}, Open  ]],

Cell["Apply the OAA operator to improve the fidelity:", "TechNoteMathCaption",
 CellID->903110508,ExpressionUUID->"602ac855-41e6-4705-bc2d-916e3d25c187"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mid", "=", 
  RowBox[{"OAA", ".", "out"}]}], "\[IndentingNewLine]", 
 RowBox[{"fdl", "=", 
  RowBox[{"Fidelity", "[", 
   RowBox[{"good", ",", "mid"}], "]"}]}]}], "Input",
 CellLabel->"In[283]:=",
 CellID->521012542,ExpressionUUID->"e4f56f1b-55e1-4db6-b6c4-ca33c0dc63b7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGIBIAaxd3YbuO7c8sL+hvvydTXT3tqfjMj9F//1vb2U
+DStS74X7U/X/FbyL3lkn9wU/GPF/7f2vJUCb6fnXLJXehL6b031AfsPWj4i
MmpP7X1K95okszyz55yya5ee6ht7e+8cg9iL7+1/Kyu7vPC+a3/n4L5rwoYv
7L8en5S+Ju+9/eoj519+zbpgvz1mv9fh6ffsuTddCWpb+8ae3Y2hQ1Lion1E
v9Wm9xNP2Wsnfk3cFPrcXuG7jbLN6+v2vHyXHh3d/8w+e9fEmSu93ttble+O
m6V0zn6O8aIt5j+u2L9YpPg4cNWrISMOABFPydA=
              "], {{0, 0}, {16, 1}}, {0, 1}], AspectRatio -> 1, Axes -> False,
              Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", "16", "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGIBIAaxd3YbuO7c8sL+hvvydTXT3tqfjMj9F//1vb2U
+DStS74X7U/X/FbyL3lkn9wU/GPF/7f2vJUCb6fnXLJXehL6b031AfsPWj4i
MmpP7X1K95okszyz55yya5ee6ht7e+8cg9iL7+1/Kyu7vPC+a3/n4L5rwoYv
7L8en5S+Ju+9/eoj519+zbpgvz1mv9fh6ffsuTddCWpb+8ae3Y2hQ1Lion1E
v9Wm9xNP2Wsnfk3cFPrcXuG7jbLN6+v2vHyXHh3d/8w+e9fEmSu93ttble+O
m6V0zn6O8aIt5j+u2L9YpPg4cNWrISMOABFPydA=
              "], {{0, 0}, {16, 1}}, {0, 1}], AspectRatio -> 1, Axes -> False,
              Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", "16", "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.5`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", "1", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.46516210563135413`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.26856146690307536`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "2", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.19267645285453297`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.11124180192206688`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "3", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.19267645285453303`"}], "-", 
                    RowBox[{"0.11124180192206691`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", "4", "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.46516210563135374`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.2685614669030752`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {16}, Complex[0., 0.], {
   1, {{0, 8}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}}}, {Complex[
    0.46516210563135413`, -0.26856146690307536`], Complex[
    0.19267645285453297`, -0.11124180192206688`], 
    Complex[-0.19267645285453303`, -0.11124180192206691`], Complex[
    0.46516210563135374`, 0.2685614669030752], Complex[
    0.32203530389862994`, -0.18592716939443688`], Complex[
    0.13339139043775355`, -0.07701355517681552], 
    Complex[-0.1333913904377537, -0.07701355517681557], Complex[
    0.32203530389862944`, 0.18592716939443663`]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[283]=",
 CellID->256541369,ExpressionUUID->"1f5c8ed8-19a8-4dfa-a21c-313b1384f0ee"],

Cell[BoxData["0.8221921916437784`"], "Output",
 CellLabel->"Out[284]=",
 CellID->1691109254,ExpressionUUID->"31997028-935d-4c5b-911b-df59127fb17c"]
}, Open  ]],

Cell["Repeating the OAA operations, the fidelity oscillates:", \
"TechNoteMathCaption",
 CellID->2020109135,ExpressionUUID->"9c5a97fd-f32a-4c2f-84a9-dc65719792fc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mid", "=", 
   RowBox[{"NestList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"OAA", ".", "#"}], "&"}], ",", "out", ",", "12"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fdl", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Fidelity", "[", 
      RowBox[{"good", ",", "#"}], "]"}], "&"}], ",", "mid"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[287]:=",
 CellID->340423664,ExpressionUUID->"9c211060-48d7-4e19-b45b-5a71a65aae04"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.3162277660168379`", ",", "0.8221921916437784`", ",", 
   "0.9992797406132077`", ",", "0.7766553933373539`", ",", 
   "0.24336888872655865`", ",", "0.38726517137486016`", ",", 
   "0.862993162926335`", ",", "0.9935238893072758`", ",", 
   "0.7266450599653063`", ",", "0.16910820663721443`", ",", 
   "0.4560719293457632`", ",", "0.8988232935904357`", ",", 
   "0.982045340398934`"}], "}"}]], "Output",
 CellLabel->"Out[288]=",
 CellID->165677652,ExpressionUUID->"8522f188-c25c-4924-90e5-195ab38560e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"fdl", ",", "\[IndentingNewLine]", 
   RowBox[{"DataRange", "->", 
    RowBox[{"{", 
     RowBox[{"0", ",", "12"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotMarkers", "->", "Automatic"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<iteration\>\"", ",", "\"\<fidelity\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellLabel->"In[289]:=",
 CellID->100186964,ExpressionUUID->"c3f709ec-f22c-42e7-9a2e-98773b582772"],

Cell[BoxData[
 GraphicsBox[{{}, 
   InterpretationBox[{
     TagBox[{{{}, {}, 
        TagBox[
         {RGBColor[0.24, 0.6, 0.8], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[2], 
          LineBox[{{0., 0.3162277660168379}, {1., 0.8221921916437784}, {2., 
           0.9992797406132077}, {3., 0.7766553933373539}, {4., 
           0.24336888872655865`}, {5., 0.38726517137486016`}, {6., 
           0.862993162926335}, {6.999999999999999, 0.9935238893072758}, {8., 
           0.7266450599653063}, {9., 0.16910820663721443`}, {10., 
           0.4560719293457632}, {11., 0.8988232935904357}, {12., 
           0.982045340398934}}]},
         Annotation[#, "Charting`Private`Tag#1"]& ]}, 
       TagBox[
        {RGBColor[0.24, 0.6, 0.8], PointSize[
          NCache[
           Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[2], 
         GeometricTransformationBox[InsetBox[
           FormBox[
            StyleBox[
             GraphicsBox[
              {EdgeForm[None], DiskBox[{0, 0}]},
              PlotRangePadding->Scaled[0.15]],
             StripOnInput->False,
             GraphicsBoxOptions->{DefaultBaseStyle->Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]]}],
            TraditionalForm], {0., 0.}, Automatic, Offset[10.976]], {{{0., 
          0.3162277660168379}}, {{1., 0.8221921916437784}}, {{2., 
          0.9992797406132077}}, {{3., 0.7766553933373539}}, {{4., 
          0.24336888872655865`}}, {{5., 0.38726517137486016`}}, {{6., 
          0.862993162926335}}, {{6.999999999999999, 0.9935238893072758}}, {{
          8., 0.7266450599653063}}, {{9., 0.16910820663721443`}}, {{10., 
          0.4560719293457632}}, {{11., 0.8988232935904357}}, {{12., 
          0.982045340398934}}}]},
        Annotation[#, "Charting`Private`Tag#1"]& ]},
      {"WolframDynamicHighlight", <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>}], 
     StyleBox[
      DynamicBox[(Charting`HighlightActionBox["DynamicHighlight", {}, 
        Slot["HighlightElements"], 
        Slot["LayoutOptions"], 
        Slot["Meta"], 
        Charting`HighlightActionFunction["DynamicHighlight", {{{}, {}, 
           Annotation[{
             Hue[0.67, 0.6, 0.6], 
             Directive[
              PointSize[
               Rational[7, 360]], 
              RGBColor[0.24, 0.6, 0.8], 
              AbsoluteThickness[2]], 
             
             Line[{{0., 0.3162277660168379}, {1., 0.8221921916437784}, {2., 
              0.9992797406132077}, {3., 0.7766553933373539}, {4., 
              0.24336888872655865`}, {5., 0.38726517137486016`}, {6., 
              0.862993162926335}, {6.999999999999999, 0.9935238893072758}, {
              8., 0.7266450599653063}, {9., 0.16910820663721443`}, {10., 
              0.4560719293457632}, {11., 0.8988232935904357}, {12., 
              0.982045340398934}}]}, "Charting`Private`Tag#1"]}, {
           Annotation[{
             Directive[
              PointSize[
               Rational[7, 360]], 
              RGBColor[0.24, 0.6, 0.8], 
              AbsoluteThickness[2]], 
             GeometricTransformation[
              Inset[
               Style[
                Graphics[{
                  EdgeForm[], 
                  Disk[{0, 0}]}, PlotRangePadding -> Scaled[0.15]], 
                GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                    PointSize[
                    Rational[7, 360]], 
                    RGBColor[0.24, 0.6, 0.8], 
                    AbsoluteThickness[2]]}], {0., 0.}, Automatic, 
               Offset[10.976]], {{{0., 0.3162277660168379}}, {{1., 
              0.8221921916437784}}, {{2., 0.9992797406132077}}, {{3., 
              0.7766553933373539}}, {{4., 0.24336888872655865`}}, {{5., 
              0.38726517137486016`}}, {{6., 0.862993162926335}}, {{
              6.999999999999999, 0.9935238893072758}}, {{8., 
              0.7266450599653063}}, {{9., 0.16910820663721443`}}, {{10., 
              0.4560719293457632}}, {{11., 0.8988232935904357}}, {{12., 
              0.982045340398934}}}]}, "Charting`Private`Tag#1"]}}, <|
         "HighlightElements" -> <|
           "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
          "LayoutOptions" -> <|
           "PanelPlotLayout" -> <||>, 
            "PlotRange" -> {{0, 12.}, {0.14726158732205727`, 
              0.9992797406132077}}, "Frame" -> {{True, True}, {True, True}}, 
            "AxesOrigin" -> {0, 0.14726158732205727`}, 
            "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {False, False}, 
            "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
            "DefaultStyle" -> {
              Directive[
               PointSize[
                Rational[7, 360]], 
               RGBColor[0.24, 0.6, 0.8], 
               AbsoluteThickness[2]]}, 
            "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                (Identity[#]& )[
                 Part[#, 1]], 
                (Identity[#]& )[
                 Part[#, 2]]}& ), 
              "ScalingFunctions" -> {{Identity, Identity}, {
                Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
            False|>, 
          "Meta" -> <|
           "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
            ListLinePlot, "GroupHighlight" -> False|>|>]]& )[<|
        "HighlightElements" -> <|
          "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
         "LayoutOptions" -> <|
          "PanelPlotLayout" -> <||>, 
           "PlotRange" -> {{0, 12.}, {0.14726158732205727`, 
             0.9992797406132077}}, "Frame" -> {{True, True}, {True, True}}, 
           "AxesOrigin" -> {0, 0.14726158732205727`}, 
           "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {False, False}, 
           "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
           "DefaultStyle" -> {
             Directive[
              PointSize[
               Rational[7, 360]], 
              RGBColor[0.24, 0.6, 0.8], 
              AbsoluteThickness[2]]}, 
           "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
               (Identity[#]& )[
                Part[#, 1]], 
               (Identity[#]& )[
                Part[#, 2]]}& ), 
             "ScalingFunctions" -> {{Identity, Identity}, {
               Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
           False|>, 
         "Meta" -> <|
          "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
           ListLinePlot, "GroupHighlight" -> False|>|>],
       ImageSizeCache->{{106.10595703125, 
        133.89404296875}, {-10.171874999999995`, 4.880859375000005}}],
      Selectable->False]},
    Annotation[{{{}, {}, 
       Annotation[{
         Hue[0.67, 0.6, 0.6], 
         Directive[
          PointSize[
           Rational[7, 360]], 
          RGBColor[0.24, 0.6, 0.8], 
          AbsoluteThickness[2]], 
         Line[{{0., 0.3162277660168379}, {1., 0.8221921916437784}, {2., 
          0.9992797406132077}, {3., 0.7766553933373539}, {4., 
          0.24336888872655865`}, {5., 0.38726517137486016`}, {6., 
          0.862993162926335}, {6.999999999999999, 0.9935238893072758}, {8., 
          0.7266450599653063}, {9., 0.16910820663721443`}, {10., 
          0.4560719293457632}, {11., 0.8988232935904357}, {12., 
          0.982045340398934}}]}, "Charting`Private`Tag#1"]}, {
       Annotation[{
         Directive[
          PointSize[
           Rational[7, 360]], 
          RGBColor[0.24, 0.6, 0.8], 
          AbsoluteThickness[2]], 
         GeometricTransformation[
          Inset[
           Style[
            Graphics[{
              EdgeForm[], 
              Disk[{0, 0}]}, PlotRangePadding -> Scaled[0.15]], 
            GraphicsBoxOptions -> {DefaultBaseStyle -> Directive[
                PointSize[
                 Rational[7, 360]], 
                RGBColor[0.24, 0.6, 0.8], 
                AbsoluteThickness[2]]}], {0., 0.}, Automatic, 
           Offset[10.976]], {{{0., 0.3162277660168379}}, {{1., 
          0.8221921916437784}}, {{2., 0.9992797406132077}}, {{3., 
          0.7766553933373539}}, {{4., 0.24336888872655865`}}, {{5., 
          0.38726517137486016`}}, {{6., 0.862993162926335}}, {{
          6.999999999999999, 0.9935238893072758}}, {{8., 
          0.7266450599653063}}, {{9., 0.16910820663721443`}}, {{10., 
          0.4560719293457632}}, {{11., 0.8988232935904357}}, {{12., 
          0.982045340398934}}}]}, "Charting`Private`Tag#1"]}}, <|
     "HighlightElements" -> <|
       "Label" -> {"XYLabel"}, "Ball" -> {"InterpolatedBall"}|>, 
      "LayoutOptions" -> <|
       "PanelPlotLayout" -> <||>, 
        "PlotRange" -> {{0, 12.}, {0.14726158732205727`, 0.9992797406132077}},
         "Frame" -> {{True, True}, {True, True}}, 
        "AxesOrigin" -> {0, 0.14726158732205727`}, 
        "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {False, False}, 
        "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), "DefaultStyle" -> {
          Directive[
           PointSize[
            Rational[7, 360]], 
           RGBColor[0.24, 0.6, 0.8], 
           AbsoluteThickness[2]]}, 
        "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), 
          "ScalingFunctions" -> {{Identity, Identity}, {
            Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>, 
      "Meta" -> <|
       "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
        ListLinePlot, "GroupHighlight" -> False|>|>, 
     "DynamicHighlight"]], {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.14726158732205727`},
  DefaultBaseStyle->{"PlotGraphics", "Graphics"},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{
     FormBox[
      TagBox["\"fidelity\"", HoldForm], TraditionalForm], None}, {
     FormBox[
      TagBox["\"iteration\"", HoldForm], TraditionalForm], None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{Automatic, Automatic},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.24, 0.6, 0.8], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.95, 0.627, 0.1425], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.455, 0.7, 0.21], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.578, 0.51, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.4, 0.64, 1.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[1., 0.75, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.8, 0.4, 0.76], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.637, 0.65, 0.], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[2]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05], "OptimizePlotMarkers" -> True, 
    "IncludeHighlighting" -> Automatic, "HighlightStyle" -> Automatic, 
    "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentSet", 
    "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotInteractivity:>True,
  PlotRange->{{0, 12.}, {0.14726158732205727`, 0.9992797406132077}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.025], 
     Scaled[0.025]}, {
     Scaled[0.025], 
     Scaled[0.025]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellLabel->"Out[289]=",
 CellID->2055087632,ExpressionUUID->"8bf7576c-6caa-4a4a-84bb-55656cdbb2cc"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]],
          "TutorialMoreAbout",ExpressionUUID->
         "7a4803c8-0adb-4502-89f4-c724a35e8f2c"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"dbae8209-75fd-44af-ab7b-\
edab9a5a95ba"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Search Algorithm",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/tutorial/QuantumSearchAlgorithm"]],
          "RelatedTutorials",ExpressionUUID->
         "97c3283d-7fdb-4385-aeb8-48dd4fed2ccb"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox["Block Encoding",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/tutorial/BlockEncoding"]], 
         "RelatedTutorials",ExpressionUUID->
         "386e0f6f-d82e-43ac-b54c-8b8af69ce1fc"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "e10a6837-dab1-4db7-9c7b-05a6bb41e414"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "6aecd068-a79b-45da-afb8-1d2b48cf0bf3"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"eae3b3ed-9ada-4cc7-bcba-\
fe2253092e4d"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "G . Brassard and P. H\[OSlash]yer (1997)"}]]]], 
             "https://doi.org/10.1109%2FISTCS.1997.595153"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "7388086a-5c7d-4dfd-805a-1d1d9ab3384f"]}]],ExpressionUUID->
         "866830c9-3f55-4bca-ae26-997e295868e6"],
        ", Proceedings of the Fifth Israeli Symposium on Theory of Computing \
and Systems, \[OpenCurlyDoubleQuote]An exact quantum polynomial-time \
algorithm for Simon\[CloseCurlyQuote]s problem.\[CloseCurlyDoubleQuote] "
       }], "TutorialRelatedLinks",ExpressionUUID->
        "ae56ca27-92e0-4c38-8b9f-0b5894e60525"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Lov K . Grover (1998)"}]]]], 
             "https://doi.org/10.1103/PhysRevLett.80.4329"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "a0455305-8cea-44dd-b75b-bb36eeac06f8"]}]],ExpressionUUID->
         "29a02e3a-123f-43c7-bff2-cf681ea24409"],
        ", Physical Review Letters 80, 4329 (1998), \
\[OpenCurlyDoubleQuote]Quantum Computers Can Search Rapidly by Using Almost \
Any Transformation.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "45f65af3-b292-4122-9352-f7d27e0162fa"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. W. Berry et al. (2014)"}]]]], 
             "https://doi.org/10.1145/2591796.2591854"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "b9e82e33-66a7-4f02-8b48-8c1104e538e7"]}]],ExpressionUUID->
         "705bf145-1a0d-43b4-b8a0-741078801f9b"],
        ", Proceedings of the 2014 ACM symposium on Theory of Computing (STOC \
2014), \[OpenCurlyDoubleQuote]Exponential improvement in precision \:2217 for \
simulating sparse Hamiltonians.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "c68f381c-df1e-447c-90a9-966d4c4b34a4"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "23182682-cb68-4b4f-9189-2b7f4c190df2"]}]],ExpressionUUID->
         "3f92612d-55eb-4dfd-b730-eeb263efae46"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "f7285374-829b-4e5a-9fbc-3156d02a828e"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"fd751380-485b-461b-9aca-\
cc920ae84cfe"],

Cell[" ", "FooterCell",ExpressionUUID->"04515db9-18fb-4c97-a8a8-e3f49f736a7e"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Quantum Amplitude Amplification",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2025", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 10, 14, 29, 51.375440}", 
    "history" -> {"14.2", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {
     "amplitude amplification", "quantum search algorithm", 
      "Grover's algorithm"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Tech Note", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3", "status" -> "None", "summary" -> 
    "Quantum amplitude amplification is a quantum algorithmic technique used \
to increase the probability of finding a desired outcome in a quantum system. \
It generalizes the concept of Grover's algorithm, which is specifically \
designed for unstructured search problems. In quantum amplitude \
amplification, the basic idea is to start with a superposition of quantum \
states, each with a certain amplitude, and iteratively apply a sequence of \
quantum operations to amplify the amplitudes of the states corresponding to \
desired outcomes while reducing the amplitudes of the undesired ones. This is \
achieved through a process involving quantum reflection and interference, \
which systematically increases the likelihood of measuring the correct state \
upon observation. The technique is widely applicable in quantum algorithms, \
providing a quadratic speedup over classical counterparts for a variety of \
search and optimization problems. Consider a unitary operator U such that \
TemplateBox[{RowBox[{\\[Psi], '}]}, Ket]:=UTemplateBox[{\\[Psi]}, \
Ket]=TemplateBox[{\\[Phi]}, \
Ket]SqrtBox[p]+TemplateBox[{SuperscriptBox[\\[Phi], \\[Perpendicular]]}, \
Ket]SqrtBox[RowBox[{1, -, p}]],", "synonyms" -> {}, "tabletags" -> {}, 
    "title" -> "Quantum Amplitude Amplification", "titlemodifier" -> "", 
    "metadescription" -> "", "windowtitle" -> 
    "Quantum Amplitude Amplification", "type" -> "Tech Note", "uri" -> 
    "QuantumMob/Q3/tutorial/QuantumAmplitudeAmplification"}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"cdfec8b4-82b8-44c2-99ac-807d0dee53a6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[599, 21, 5699, 139, 70, "AnchorBarGrid",ExpressionUUID->"97ebebbc-d195-4342-b1c0-c8a0c1ef8c73",
 CellID->1],
Cell[CellGroupData[{
Cell[6323, 164, 1385, 37, 70, "ObjectNameGrid",ExpressionUUID->"1a73170d-ee59-4e42-a60d-503940169c53"],
Cell[7711, 203, 2066, 46, 70, "TechNoteJumpBox",ExpressionUUID->"9fc3c05e-921b-4863-a92f-d2a11cc28c51"],
Cell[9780, 251, 1057, 15, 70, "TechNoteText",ExpressionUUID->"5b196a23-ce7e-4aa4-8d5c-306f0a683a80",
 CellID->2066743005]
}, Open  ]],
Cell[CellGroupData[{
Cell[10874, 271, 140, 1, 70, "TechNoteSection",ExpressionUUID->"576f2893-ee8c-4bbd-ae25-328ebacfdfdd",
 CellID->1404287834],
Cell[11017, 274, 266, 7, 70, "TechNoteText",ExpressionUUID->"3fefa46e-474a-4868-bcc6-843a73adf30d",
 CellID->1020345508],
Cell[11286, 283, 667, 26, 70, "TechNoteText",ExpressionUUID->"1af1eaef-9da5-4400-b893-925ab49d0353",
 CellID->1290031661],
Cell[11956, 311, 1571, 45, 70, "TechNoteText",ExpressionUUID->"2d209c1f-9a95-499a-b93c-8b2112c9193c",
 CellID->567226315],
Cell[13530, 358, 438, 16, 70, "TechNoteText",ExpressionUUID->"163f3c9f-eada-4f74-b160-fc5d79d5e2df",
 CellID->692767172],
Cell[13971, 376, 583, 16, 70, "TechNoteText",ExpressionUUID->"d100405a-7564-454b-83f4-1fa0b7ea87c1",
 CellID->1829009417],
Cell[14557, 394, 1384, 48, 70, "TechNoteText",ExpressionUUID->"9ba5925e-5808-4b84-8bf4-d52844519f66",
 CellID->1080348361],
Cell[15944, 444, 513, 16, 70, "TechNoteText",ExpressionUUID->"f29ac36d-58a1-47dd-96b9-5109faaad0be",
 CellID->1564974967],
Cell[16460, 462, 454, 13, 70, "TechNoteText",ExpressionUUID->"c0c12247-460a-4413-b198-32fdace851e3",
 CellID->440667942],
Cell[16917, 477, 125, 1, 70, "TechNoteText",ExpressionUUID->"b5ae8ee0-7fe7-49f3-b40e-02f30905bc71",
 CellID->1782486338],
Cell[17045, 480, 1351, 39, 70, "TechNoteText",ExpressionUUID->"9c5cbe47-47f3-4ec2-86ac-07d9a8c478b4",
 CellID->851007116],
Cell[18399, 521, 2187, 46, 70, "Picture",ExpressionUUID->"9a4a1b49-57fc-4448-881b-37d18c3500f0",
 CellID->1160036613],
Cell[20589, 569, 1203, 35, 70, "TechNoteCaption",ExpressionUUID->"0ff7bb1c-c5f2-4763-8514-9953164cad17",
 CellID->106944923],
Cell[CellGroupData[{
Cell[21817, 608, 111, 1, 70, "Subsection",ExpressionUUID->"c97180ac-5e4b-4948-ac05-3de4a589e909",
 CellID->1502243926],
Cell[21931, 611, 166, 2, 70, "TechNoteMathCaption",ExpressionUUID->"72330a5b-f0ce-47d8-b186-8a489030346c",
 CellID->1056618802],
Cell[22100, 615, 299, 8, 70, "Input",ExpressionUUID->"70cdc679-5910-4d21-9dba-9dec25701b42",
 CellID->1030530536],
Cell[CellGroupData[{
Cell[22424, 627, 318, 8, 70, "Input",ExpressionUUID->"66c93bff-7029-4dbd-828a-a1abdd187416",
 CellID->671105497],
Cell[22745, 637, 471, 14, 70, "Output",ExpressionUUID->"d1e122fd-60f2-4943-9cec-e3d6a66f3aca",
 CellID->526504709]
}, Open  ]],
Cell[23231, 654, 221, 4, 70, "TechNoteMathCaption",ExpressionUUID->"4bf4adaf-aa1a-4ab7-a6e2-e72d4f689f83",
 CellID->1332018523],
Cell[CellGroupData[{
Cell[23477, 662, 750, 22, 70, "Input",ExpressionUUID->"4bfa308c-4333-46a9-bcb9-7848431c33dc",
 CellID->1473389149],
Cell[24230, 686, 2232, 48, 70, "Output",ExpressionUUID->"f7452476-8338-4018-ada7-3e58ceeca746",
 CellID->215290027]
}, Open  ]],
Cell[26477, 737, 131, 1, 70, "TechNoteMathCaption",ExpressionUUID->"ad50f533-3bf5-47f1-9cca-7eab2b14a2de",
 CellID->1689971758],
Cell[CellGroupData[{
Cell[26633, 742, 533, 15, 70, "Input",ExpressionUUID->"781976da-880b-413c-a594-1b620093c5fc",
 CellID->1575398298],
Cell[27169, 759, 282, 8, 70, "Output",ExpressionUUID->"88cfbbbe-fa63-48e7-a018-2466b9ef1b0d",
 CellID->1970545658]
}, Open  ]],
Cell[27466, 770, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"6860209c-9c6a-4e32-bfd3-fb78ab0f0c8b",
 CellID->468069972],
Cell[CellGroupData[{
Cell[27640, 775, 256, 6, 70, "Input",ExpressionUUID->"322e8830-0776-4565-a530-5a5a4a2a6450",
 CellID->1209953873],
Cell[27899, 783, 667, 13, 70, "Output",ExpressionUUID->"1fb5af78-c14c-464f-a7c5-c30ead609b38",
 CellID->1714818271]
}, Open  ]],
Cell[28581, 799, 180, 3, 70, "TechNoteMathCaption",ExpressionUUID->"3fb83724-110e-4496-990f-56dfcf10ef65",
 CellID->1720137957],
Cell[CellGroupData[{
Cell[28786, 806, 386, 9, 70, "Input",ExpressionUUID->"cb46f0b7-0f6f-4fd4-9453-9783d91deb31",
 CellID->450278945],
Cell[29175, 817, 1754, 43, 70, "Output",ExpressionUUID->"bd2f3adc-4fff-4dd8-89a3-fd37466088c1",
 CellID->1564409363],
Cell[30932, 862, 266, 8, 70, "Output",ExpressionUUID->"4e7218e2-1e4c-4f81-a44f-ff677f485d83",
 CellID->1385873720]
}, Open  ]],
Cell[31213, 873, 195, 4, 70, "TechNoteMathCaption",ExpressionUUID->"788ac777-b0cd-4a41-a262-f3756a09e087",
 CellID->715602821],
Cell[CellGroupData[{
Cell[31433, 881, 241, 6, 70, "Input",ExpressionUUID->"d1dc2367-fe5b-4107-882e-1e5d3b292e2d",
 CellID->897371023],
Cell[31677, 889, 146, 2, 70, "Output",ExpressionUUID->"752babd7-6c47-4132-a447-8b595c77cc66",
 CellID->770727201]
}, Open  ]],
Cell[31838, 894, 220, 4, 70, "TechNoteMathCaption",ExpressionUUID->"1d55131c-ec46-416e-84a9-143de5fd6e28",
 CellID->566017205],
Cell[32061, 900, 535, 16, 70, "Input",ExpressionUUID->"0e6d054b-57c9-48d2-a069-8ed365aa22e8",
 CellID->675092936],
Cell[32599, 918, 133, 1, 70, "TechNoteMathCaption",ExpressionUUID->"cc17a22b-be47-4c22-bd82-1e59d014c194",
 CellID->1195732985],
Cell[CellGroupData[{
Cell[32757, 923, 329, 7, 70, "Input",ExpressionUUID->"a1749d49-601a-4e92-a1de-0bf042cb80c5",
 CellID->1130868251],
Cell[33089, 932, 2519, 58, 70, "Output",ExpressionUUID->"d0f0fc69-b8ce-451b-b85d-7a968718e53f",
 CellID->1182453891]
}, Open  ]],
Cell[35623, 993, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"eb3f63ec-7656-490a-a74c-ed490f18b7c0",
 CellID->1879778906],
Cell[CellGroupData[{
Cell[35797, 998, 178, 4, 70, "Input",ExpressionUUID->"62dacd26-bbb5-42f6-9f2c-4608c7ff09a7",
 CellID->1093477974],
Cell[35978, 1004, 10986, 224, 70, "Output",ExpressionUUID->"a9716a50-233e-4b2f-9844-d552ef30cf50",
 CellID->816115503]
}, Open  ]],
Cell[46979, 1231, 138, 1, 70, "TechNoteMathCaption",ExpressionUUID->"bbe3e2fe-4939-42fd-a07d-dc8eabd7c615",
 CellID->2008839700],
Cell[CellGroupData[{
Cell[47142, 1236, 241, 6, 70, "Input",ExpressionUUID->"0a2f73c2-fa95-4d81-a256-860b9249cb6c",
 CellID->178736448],
Cell[47386, 1244, 147, 2, 70, "Output",ExpressionUUID->"56d11836-3a54-4a07-bf04-9b572840868e",
 CellID->1753558182]
}, Open  ]],
Cell[47548, 1249, 197, 4, 70, "TechNoteMathCaption",ExpressionUUID->"e885c9f7-9961-433e-87a1-c9f509fdf590",
 CellID->1702758543],
Cell[CellGroupData[{
Cell[47770, 1257, 432, 12, 70, "Input",ExpressionUUID->"d1b59e0d-eaeb-4618-8109-f82fa6e4ba9a",
 CellID->65468293],
Cell[48205, 1271, 148, 2, 70, "Output",ExpressionUUID->"c75b8e4b-aa09-4739-b094-b18748b384b8",
 CellID->1234794999]
}, Open  ]],
Cell[48368, 1276, 160, 2, 70, "TechNoteMathCaption",ExpressionUUID->"574ad45c-73f4-4865-a46c-efad8207dfc7",
 CellID->887215026],
Cell[CellGroupData[{
Cell[48553, 1282, 433, 12, 70, "Input",ExpressionUUID->"33b87f5e-2a6a-42e9-9f36-06930a49de94",
 CellID->976522519],
Cell[48989, 1296, 146, 2, 70, "Output",ExpressionUUID->"4579cf2f-50fc-4e37-a729-7523529fd03e",
 CellID->556534282]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49196, 1305, 141, 1, 70, "TechNoteSection",ExpressionUUID->"ce91adf5-6d35-4e88-8955-9282241681a1",
 CellID->635509592],
Cell[49340, 1308, 529, 8, 70, "TechNoteText",ExpressionUUID->"c9b0b7ce-07ff-4978-afdd-1bcf310a5dfc",
 CellID->162019086],
Cell[49872, 1318, 758, 19, 70, "TechNoteText",ExpressionUUID->"31af1105-04a0-49e7-872c-866b0d975864",
 CellID->1166117144],
Cell[50633, 1339, 858, 32, 70, "TechNoteText",ExpressionUUID->"b47c7ed8-0b33-4289-a029-71347b548216",
 CellID->45514006],
Cell[51494, 1373, 646, 19, 70, "TechNoteText",ExpressionUUID->"f71009f2-2ed8-47c2-8d08-0397e0cc3be4",
 CellID->449720510],
Cell[52143, 1394, 1200, 39, 70, "TechNoteText",ExpressionUUID->"4df222ba-0c6e-4705-bbff-fb124403f5ef",
 CellID->7974949],
Cell[53346, 1435, 973, 31, 70, "TechNoteText",ExpressionUUID->"ab25c2e5-2d53-4a26-83cd-c998b1ac45a1",
 CellID->1154511227],
Cell[54322, 1468, 376, 14, 70, "TechNoteText",ExpressionUUID->"c3c54bc4-9f77-4d94-a904-16ce77d498f2",
 CellID->1457657777],
Cell[54701, 1484, 516, 14, 70, "TechNoteText",ExpressionUUID->"0bcbe9bc-28af-4d43-a684-08f8945cddb5",
 CellID->360813063],
Cell[55220, 1500, 151, 1, 70, "TechNoteText",ExpressionUUID->"ba81d7cc-1fe0-4ce5-83ef-82ee9e0bb44d",
 CellID->1710258253],
Cell[55374, 1503, 818, 30, 70, "TechNoteText",ExpressionUUID->"d87d8b4c-d923-42b8-b2ec-a796c3165e57",
 CellID->1161918896],
Cell[56195, 1535, 262, 7, 70, "TechNoteText",ExpressionUUID->"8e19fb46-5748-41e1-b8bb-a6f5de62b887",
 CellID->1840366080],
Cell[56460, 1544, 588, 22, 70, "TechNoteText",ExpressionUUID->"6b5562a5-bdd1-4539-aa05-88d51eb96a95",
 CellID->960150010],
Cell[57051, 1568, 206, 4, 70, "TechNoteText",ExpressionUUID->"de98f962-39a0-4302-9775-f1bdf865db31",
 CellID->1838814360],
Cell[57260, 1574, 871, 30, 70, "TechNoteText",ExpressionUUID->"4273cd8c-b6bf-4e3a-abfe-0a512f5b28b0",
 CellID->515784543],
Cell[58134, 1606, 897, 32, 70, "TechNoteText",ExpressionUUID->"1d43b504-1663-4180-b5eb-4d92c2dd8954",
 CellID->1546814909],
Cell[59034, 1640, 345, 9, 70, "TechNoteText",ExpressionUUID->"732bd6e9-652d-44b7-8e50-dffa5aab95e0",
 CellID->2028628628],
Cell[59382, 1651, 454, 12, 70, "TechNoteText",ExpressionUUID->"cd38bc2b-a0d4-4efa-b60b-1f365b526d6e",
 CellID->1710971024],
Cell[59839, 1665, 887, 29, 70, "TechNoteText",ExpressionUUID->"944edf85-fec2-4eb2-968b-a7e1201f1332",
 CellID->1483967038],
Cell[60729, 1696, 367, 10, 70, "TechNoteText",ExpressionUUID->"990dd127-5a16-446b-9747-c9e35c0b86e9",
 CellID->158931408],
Cell[61099, 1708, 1269, 36, 70, "TechNoteText",ExpressionUUID->"ce571c03-0109-4628-b076-5d4aa9796744",
 CellID->1838001035],
Cell[62371, 1746, 590, 22, 70, "TechNoteText",ExpressionUUID->"ed33a1f5-de09-425c-bbbc-303866e1fa0f",
 CellID->1878616797],
Cell[62964, 1770, 345, 10, 70, "TechNoteText",ExpressionUUID->"9aad81aa-0b26-4216-ace2-790291d81eef",
 CellID->1607928985],
Cell[63312, 1782, 632, 23, 70, "TechNoteText",ExpressionUUID->"7b28613d-48bf-417a-b029-dae2bab135e3",
 CellID->528237047],
Cell[63947, 1807, 2493, 82, 70, "TechNoteText",ExpressionUUID->"e53ddd98-71dd-4c05-af25-79029d4f18b5",
 CellID->382652231],
Cell[66443, 1891, 1744, 36, 70, "Picture",ExpressionUUID->"40ea6d2a-c515-45d7-8c17-9b7395675cb3",
 CellID->956114126],
Cell[68190, 1929, 795, 19, 70, "TechNoteCaption",ExpressionUUID->"a67d19ad-ca4c-41ec-8bad-22aae08483a6",
 CellID->1519958685],
Cell[CellGroupData[{
Cell[69010, 1952, 110, 1, 70, "Subsection",ExpressionUUID->"4bae9f92-d31c-409e-af8e-1faaa3c09785",
 CellID->617274088],
Cell[69123, 1955, 190, 3, 70, "TechNoteMathCaption",ExpressionUUID->"510cf9a6-c1dc-47b9-8a68-ed052397ea99",
 CellID->1563943485],
Cell[69316, 1960, 240, 6, 70, "Input",ExpressionUUID->"d5c90200-0d15-422b-bc14-9934e8454eb2",
 CellID->1874195322],
Cell[69559, 1968, 146, 1, 70, "TechNoteMathCaption",ExpressionUUID->"a76210b5-0984-48a2-8ec6-9e9102493090",
 CellID->1573982178],
Cell[CellGroupData[{
Cell[69730, 1973, 598, 18, 70, "Input",ExpressionUUID->"c93f19bd-05f6-4ecc-b1f5-7155d10d1204",
 CellID->1718584036],
Cell[70331, 1993, 472, 14, 70, "Output",ExpressionUUID->"475ed774-5781-453f-ac26-280ec3442135",
 CellID->1521480529],
Cell[70806, 2009, 472, 14, 70, "Output",ExpressionUUID->"8493f0f9-800c-4651-9310-172f01b72a27",
 CellID->1435466074]
}, Open  ]],
Cell[71293, 2026, 154, 1, 70, "TechNoteMathCaption",ExpressionUUID->"fca354f2-8ba0-49e1-b333-57dbc1625103",
 CellID->1923303247],
Cell[CellGroupData[{
Cell[71472, 2031, 721, 21, 70, "Input",ExpressionUUID->"df3ec777-c744-4c14-92d7-2beef36ee360",
 CellID->1534262640],
Cell[72196, 2054, 1877, 43, 70, "Output",ExpressionUUID->"9c5ef7e2-8d4d-4619-bce3-f95c9e220b27",
 CellID->1650539534],
Cell[74076, 2099, 2231, 48, 70, "Output",ExpressionUUID->"03de6fe2-465e-4280-a4eb-fde695d321bb",
 CellID->1571679639]
}, Open  ]],
Cell[76322, 2150, 213, 4, 70, "TechNoteMathCaption",ExpressionUUID->"db2d06eb-b9a6-4dbf-8175-5a98a361909c",
 CellID->788095177],
Cell[76538, 2156, 170, 4, 70, "Input",ExpressionUUID->"b8b1cf36-fdb2-4c34-aaf6-d65aee4fa777",
 CellID->189140081],
Cell[CellGroupData[{
Cell[76733, 2164, 547, 15, 70, "Input",ExpressionUUID->"14cf020e-c5b0-44af-a532-ae59d80af232",
 CellID->1163884679],
Cell[77283, 2181, 8990, 186, 70, "Output",ExpressionUUID->"27786672-31ec-4c9b-af22-e1c2043daab1",
 CellID->1119111113],
Cell[86276, 2369, 2728, 58, 70, "Output",ExpressionUUID->"fcca18d9-daa1-49a6-960d-d62c32a99894",
 CellID->1238695765]
}, Open  ]],
Cell[89019, 2430, 147, 1, 70, "TechNoteMathCaption",ExpressionUUID->"67f9323e-3e95-4c5d-9a9b-cade46a8f8a6",
 CellID->1974888155],
Cell[CellGroupData[{
Cell[89191, 2435, 446, 13, 70, "Input",ExpressionUUID->"2f85c4a7-4b0e-49f2-8eef-6fae6ed3166a",
 CellID->420239022],
Cell[89640, 2450, 2146, 48, 70, "Output",ExpressionUUID->"047b2980-025f-43d0-ba7f-cb3584c883ab",
 CellID->1863202789]
}, Open  ]],
Cell[91801, 2501, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"2037ed35-0a1b-437a-8ed5-4fb6c4667f29",
 CellID->242734169],
Cell[CellGroupData[{
Cell[92003, 2508, 383, 9, 70, "Input",ExpressionUUID->"89777d37-d303-40ec-9339-2904de966248",
 CellID->575262923],
Cell[92389, 2519, 3621, 69, 70, "Output",ExpressionUUID->"bf57e6c5-13d9-48b2-b721-e206f31c08ce",
 CellID->1342986410]
}, Open  ]],
Cell[96025, 2591, 412, 13, 70, "TechNoteMathCaption",ExpressionUUID->"a39e365e-ce6b-49fc-baa2-83e109f92cff",
 CellID->1519462900],
Cell[CellGroupData[{
Cell[96462, 2608, 467, 12, 70, "Input",ExpressionUUID->"f546c008-f3ea-4592-b62f-8a236e40a887",
 CellID->1740420427],
Cell[96932, 2622, 3056, 73, 70, "Output",ExpressionUUID->"37a32aec-2a21-4c0d-b0a0-141a54d33ba2",
 CellID->860597013],
Cell[99991, 2697, 392, 10, 70, "Output",ExpressionUUID->"72b5cd66-d575-4076-a488-b900d5363a1e",
 CellID->751634946]
}, Open  ]],
Cell[100398, 2710, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"b898e5b7-d63f-45f9-a867-175e725e1bcd",
 CellID->1222680484],
Cell[CellGroupData[{
Cell[100619, 2718, 320, 8, 70, "Input",ExpressionUUID->"791ffbc2-f56d-4a12-a2c9-1081c512360f",
 CellID->2110635699],
Cell[100942, 2728, 12899, 299, 70, "Output",ExpressionUUID->"cc24c62e-8142-4fdb-9d17-b8eeb5a415f7",
 CellID->456623575]
}, Open  ]],
Cell[113856, 3030, 182, 3, 70, "TechNoteMathCaption",ExpressionUUID->"1ab21410-58a4-4c2d-9554-636070a17e1f",
 CellID->1513354294],
Cell[CellGroupData[{
Cell[114063, 3037, 253, 6, 70, "Input",ExpressionUUID->"2b741114-7d15-41eb-94e5-5f434dfac30f",
 CellID->760373933],
Cell[114319, 3045, 10927, 226, 70, "Output",ExpressionUUID->"63491bd4-cf5e-40d3-a11a-bbe5a025cb29",
 CellID->261299191]
}, Open  ]],
Cell[125261, 3274, 166, 2, 70, "TechNoteMathCaption",ExpressionUUID->"2ea686b5-96d3-41af-8bd7-368858065cf1",
 CellID->1099486414],
Cell[CellGroupData[{
Cell[125452, 3280, 215, 5, 70, "Input",ExpressionUUID->"56e48371-7a9d-4a9b-91d0-63d8f16e74fe",
 CellID->363472710],
Cell[125670, 3287, 147, 2, 70, "Output",ExpressionUUID->"bb6cc6a6-9744-43a5-95ec-f046bb54eda3",
 CellID->1418740836]
}, Open  ]],
Cell[125832, 3292, 153, 1, 70, "TechNoteMathCaption",ExpressionUUID->"602ac855-41e6-4705-bc2d-916e3d25c187",
 CellID->903110508],
Cell[CellGroupData[{
Cell[126010, 3297, 296, 7, 70, "Input",ExpressionUUID->"e4f56f1b-55e1-4db6-b6c4-ca33c0dc63b7",
 CellID->521012542],
Cell[126309, 3306, 11643, 238, 70, "Output",ExpressionUUID->"1f5c8ed8-19a8-4dfa-a21c-313b1384f0ee",
 CellID->256541369],
Cell[137955, 3546, 147, 2, 70, "Output",ExpressionUUID->"31997028-935d-4c5b-911b-df59127fb17c",
 CellID->1691109254]
}, Open  ]],
Cell[138117, 3551, 163, 2, 70, "TechNoteMathCaption",ExpressionUUID->"9c5a97fd-f32a-4c2f-84a9-dc65719792fc",
 CellID->2020109135],
Cell[CellGroupData[{
Cell[138305, 3557, 498, 16, 70, "Input",ExpressionUUID->"9c211060-48d7-4e19-b45b-5a71a65aae04",
 CellID->340423664],
Cell[138806, 3575, 545, 11, 70, "Output",ExpressionUUID->"8522f188-c25c-4924-90e5-195ab38560e1",
 CellID->165677652]
}, Open  ]],
Cell[CellGroupData[{
Cell[139388, 3591, 526, 12, 70, "Input",ExpressionUUID->"c3f709ec-f22c-42e7-9a2e-98773b582772",
 CellID->100186964],
Cell[139917, 3605, 13299, 303, 70, "Output",ExpressionUUID->"8bf7576c-6caa-4a4a-84bb-55656cdbb2cc",
 CellID->2055087632]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[153255, 3913, 741, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"dbae8209-75fd-44af-ab7b-edab9a5a95ba"],
Cell[153999, 3933, 1762, 45, 70, "RelatedTutorialsSection",ExpressionUUID->"eae3b3ed-9ada-4cc7-bcba-fe2253092e4d"],
Cell[155764, 3980, 4239, 107, 70, "TutorialRelatedLinksSection",ExpressionUUID->"fd751380-485b-461b-9aca-cc920ae84cfe"],
Cell[160006, 4089, 78, 0, 70, "FooterCell",ExpressionUUID->"04515db9-18fb-4c97-a8a8-e3f49f736a7e"]
}
]
*)

(* End of internal cache information *)
