(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    141089,       3708]
NotebookOptionsPosition[    126605,       3417]
NotebookOutlinePosition[    129793,       3487]
CellTagsIndexPosition[    129750,       3484]
WindowTitle->Linear Combination of Unitary Operators
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "37dcc71f-40fe-45d6-a8e5-5b5b21a29dce"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "137d9c13-f4ca-47d3-a21f-d789388683c3"],
        Background->LightDarkSwitched[
          RGBColor[
          0.3843137254901961, 0.4627450980392157, 0.7019607843137254]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "92b9d95e-abac-40f0-8a31-8ab601d6f31f"]
         }],ExpressionUUID->"c0bc3a8d-3134-41bf-861a-4d730161c9f3"],
         StripOnInput->False],{
        StyleBox[
          "\"AmplitudeEncoding\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/AmplitudeEncoding"], 
         StyleBox[
          "\"UniformlyControlledGate\"", "SeeAlsoRelated", StripOnInput -> 
           False] :> Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/UniformlyControlledGate"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "cbac4031-5b0d-423b-9f32-717fe6d15e2b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "8f9a5673-bcbe-4c8c-b623-a32dad96e7a6"]
         }],ExpressionUUID->"8185207f-77b1-43f6-b76b-3ef77358dd7d"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "07abf0d6-303a-4085-925a-3f8afe91f06b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "bd2ad524-3192-45f3-9bc1-d4ce1b176999"]
         }],ExpressionUUID->"63989172-d6da-4cab-9735-cd03afc0c215"],
         StripOnInput->False],{
        "\"Quantum Computation: Overview\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "36e506a6-4054-4f5b-bf5b-97f99ac765e3"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "7d569ee3-5c59-499c-8da3-0be2bf1e01c1"]
         }],ExpressionUUID->"61f4b15b-7cac-4e87-ae9e-31a9292b2dbf"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/tutorial/LinearCombinationOfUnitaries\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard[
          "QuantumMob/Q3/tutorial/LinearCombinationOfUnitaries"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/\
tutorial/LinearCombinationOfUnitaries.html"], StandardForm]], "Input", 
                 TextClipboardType -> "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/tutorial/LinearCombinationOfUnitaries") <> 
               ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "52745ea5-9ed7-47b1-ba43-f02e55a436fb"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "6bbbcd69-680f-4cff-b695-42b46554bf2a"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"f481a5b7-14c8-4489-aea8-64995afd1f7a"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "Linear Combination of Unitary Operators", "TechNoteTitle",
      ExpressionUUID->"70f201bb-b156-4531-8871-489e672dab53"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"3598db66-69ed-4206-b431-5b88952e6331"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "b25148f5-0f2b-4453-a3fa-8ffbd0848f5c"]
    }],ExpressionUUID->"9988e238-d832-4a41-a344-44f22301a382"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.0\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->LightDarkSwitched[
              RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "c3caacad-3376-46b5-9f1c-8c79f85190b0"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"ea40ebab-8464-437e-b0af-204592dfdb8a"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["General Implementation"], 
      "paclet:QuantumMob/Q3/tutorial/LinearCombinationOfUnitaries#221637712", 
      
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Examples"], 
      "paclet:QuantumMob/Q3/tutorial/LinearCombinationOfUnitaries#2113806542", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TechNoteJumpBox",ExpressionUUID->"a7135d33-86ca-4b63-a478-\
198b5af92278"],

Cell[TextData[{
 "Given unitary operators ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "1"], ",", 
    SubscriptBox["U", "2"], ",", "\[Ellipsis]", ",", 
    SubscriptBox["U", "n"]}], TraditionalForm]],ExpressionUUID->
  "30e9bd67-7999-45be-ad64-2655510c59be"],
 ", let ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", ":=", 
    RowBox[{
     SubscriptBox["\[Sum]", "k"], 
     RowBox[{
      SubscriptBox["\[Alpha]", "k"], 
      SubscriptBox["U", "k"]}]}]}], TraditionalForm]],ExpressionUUID->
  "7a68c5a2-ed84-4020-9298-26820b5f43d1"],
 " be a linear combination of those unitary operators, where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Alpha]", "k"], TraditionalForm]],ExpressionUUID->
  "c7f19a80-52a6-4bdb-b320-9ecc17a695c0"],
 " are complex coefficients. In general, ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "6cda84e0-41f6-4970-be4a-9f3ac6d471ae"],
 " is not unitary and cannot be implemented directly on a quantum computer. \
However, using an ancillary qubits, it can be implemented as discussed below. "
}], "TechNoteText",
 CellID->275259851,ExpressionUUID->"c925d693-9309-4865-8878-50ae1971a396"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["UniformlyControlledGate"]], 
      "paclet:QuantumMob/Q3/ref/UniformlyControlledGate", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Uniformly controlled unitary gates", "TechNoteTableText",ExpressionUUID->
     "cc2f00e3-0686-4fd8-ad03-7c892c68c339"]},
   {
    TemplateBox[{
      Cell[
       TextData["AmplitudeEncoding"]], 
      "paclet:QuantumMob/Q3/ref/AmplitudeEncoding", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Encodes classical data in a quantum state", "TechNoteTableText",
     ExpressionUUID->"a2cd5a2b-ef55-494b-b5b0-a3a38d07f827"]}
  }]], "DefinitionBox",
 CellID->1025109959,ExpressionUUID->"64fe5b49-8e92-41ca-bd7e-c2fd25d01588"],

Cell["\<\
Q3 functions that are useful to construct a linear combination of unitary \
operators.\
\>", "TechNoteCaption",
 CellID->1909264679,ExpressionUUID->"c4f7088f-6d77-4d4a-a70f-386720cdc95e"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation:"
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"647db0b7-de13-4c95-ba56-254d966aec68"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",
 CellID->853967906,ExpressionUUID->"ac1d84b4-802e-48dd-821d-f71c3ac1a764"]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Implementation", "TechNoteSection",
 CellID->221637712,ExpressionUUID->"aa1a1814-d60b-4642-9e68-85f261df1b3c"],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "1"], ",", 
    SubscriptBox["U", "2"], ",", "\[Ellipsis]"}], TraditionalForm]],
  ExpressionUUID->"dd2f26b7-b329-4d0c-9e41-58764d741570"],
 " be unitary operators and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", ":=", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Alpha]", "1"], ",", 
      SubscriptBox["\[Alpha]", "2"], ",", "\[Ellipsis]"}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"87f41f8a-7505-43d9-baf2-de0d2b1ecf79"],
 " be a vector of complex numbers.  We want to implement a linear combination \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", ":=", 
    RowBox[{
     SubscriptBox["\[Sum]", "k"], 
     RowBox[{
      SubscriptBox["\[Alpha]", "k"], 
      SubscriptBox["U", "k"]}]}]}], TraditionalForm]],ExpressionUUID->
  "befa5fef-4b42-42c7-84ed-a24e8d7c27a3"],
 " of those unitary operators. Since ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "363fb121-70bb-4c19-bccd-d3a22c048831"],
 " is not unitary in general, ancillary qubits are necessary."
}], "TechNoteText",
 CellID->2083809428,ExpressionUUID->"8108a9e3-2b85-43d9-854c-2cdc1b18c690"],

Cell[TextData[{
 "One way to implement ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "4403dfe9-64c1-436a-b85e-7a80108e5e85"],
 " is through the quantum circuit shown in Figure 1, where ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "69a260c9-9eb6-42ee-86f7-d2beb753c976"],
 " is a unitary operator with the first column stores the coefficients ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Alpha]", "k"], TraditionalForm]],ExpressionUUID->
  "eaefe8fe-50e8-4bd8-9248-3292e9673dc3"],
 " as follows:"
}], "TechNoteText",
 CellID->786839548,ExpressionUUID->"b1829de5-75d9-41ac-b81f-58f9c279c561"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "\[DotEqual]", 
    RowBox[{
     FractionBox["1", 
      SqrtBox[
       RowBox[{"\[LeftDoubleBracketingBar]", 
        RowBox[{"\[Alpha]", 
         SubscriptBox["\[LeftDoubleBracketingBar]", "1"]}]}]]], 
     RowBox[{"(", GridBox[{
        {
         SqrtBox[
          SubscriptBox["\[Alpha]", "1"]], "*", "\[Ellipsis]", "*"},
        {
         SqrtBox[
          SubscriptBox["\[Alpha]", "2"]], "*", "\[Ellipsis]", "*"},
        {"\[VerticalEllipsis]", "\[VerticalEllipsis]", 
         "\[DescendingEllipsis]", "\[VerticalEllipsis]"},
        {"\[VerticalEllipsis]", "*", "\[Ellipsis]", "*"}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "cedb0798-6eef-4962-8a5e-ff0203bf2c6d"],
 " ."
}], "TechNoteText",
 CellID->1421741120,ExpressionUUID->"3c02c6e5-931b-4402-9568-4f772275855f"],

Cell[TextData[{
 "The desired operation ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "471f763e-8409-416a-b398-a42fb5a93430"],
 " is achieved when the ancillary register is measured with all qubits in the \
",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"0"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "8f1cfad7-2e75-4dc8-b59d-2571b55c3cfb"],
 " state; if not, the procedure fails and must be attempted again. But how \
can you construct the unitary operator ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "1c9422b9-7dd0-4649-af1b-5dd05a6a1c99"],
 " for given coefficients ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", ":=", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Alpha]", "1"], ",", 
      SubscriptBox["\[Alpha]", "2"], ",", "\[Ellipsis]"}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"189bf17b-1a96-4472-a90b-2c2ff0e91ba6"],
 ". One way to achieve it is to use the ",
 ButtonBox["amplitude encoding gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/AmplitudeEncoding"],
 "."
}], "TechNoteText",
 CellID->1718500619,ExpressionUUID->"d8c45519-0889-418a-b439-a0a5b9d836c7"],

Cell[TextData[{
 "When the number of terms is small, the above methods provide a convenient \
tool to compose a more complicated operation from simpler gates ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "k"], TraditionalForm]],ExpressionUUID->
  "0736f2b9-ffac-4ddf-884f-dc48db8a6755"],
 ". However, as the number of terms increases, it becomes inefficient in \
general and the quantum eigenvalue transform (QET) or quantum singular value \
transform (QSVT) is required."
}], "TechNoteText",
 CellID->1328382424,ExpressionUUID->"f6461958-552e-451f-a0b0-6bdf1ab4c468"],

Cell[TextData[{
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{5, -1}, {6, -1}}, {{5, -2}, {6, -2}}}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -4}, {6, -4}}}], {
     InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}, {2, -4}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      DiskBox[{2, -1}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {LightDarkSwitched[
        GrayLevel[0]], 
       DiskBox[{2, -1}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      DiskBox[{2, -2}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {LightDarkSwitched[
        GrayLevel[0]], 
       DiskBox[{2, -2}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"\[Ellipsis]\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(V\\), \\(T\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, 
      CircleBox[{5, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{5, -1.2}, {5.24, -0.76}}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, 
      CircleBox[{5, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{5, -2.2}, {5.24, -1.76}}]}}, {
     InsetBox[
      TemplateBox[{"0"},
       "Ket"], {6.2, -1.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {6.2, -2.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->262.8,
   PlotRange->{{0, 6}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "e8e26b72-3ee3-4751-ba1c-62a6f3f3e0f7"],
 "=",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], 
     LineBox[{{{8, -1}, {9, -1}}, {{8, -2}, {9, -2}}}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -4}, {9, -4}}}], {
     InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}, {2, -4}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{2, -1}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{2, -2}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "0"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -1}, {3, -2}, {3, -4}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{3, -1}, 0.09]}, 
     DiskBox[{3, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "1"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -2}, {4, -4}}], 
     DiskBox[{4, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{4, -2}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -1}, {5, -2}, {5, -4}}], 
     DiskBox[{5, -1}, 0.09], DiskBox[{5, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(V\\), \\(T\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{7.6, -1.4}, {8.4, -0.6}]}, 
      CircleBox[{8, -1.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{8, -1.2}, {8.24, -0.76}}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, 
      CircleBox[{8, -2.2}, 0.4, 
       NCache[{Rational[1, 6] Pi, Rational[5, 6] Pi}, {0.5235987755982988, 
        2.6179938779914944`}]], LineBox[{{8, -2.2}, {8.24, -1.76}}]}}, {
     InsetBox[
      TemplateBox[{"0"},
       "Ket"], {9.2, -1.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {9.2, -2.}, NCache[
      ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]], Automatic, {1,
       0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "bb066c79-8d25-4c26-addd-61023d93155e"]
}], "Picture",
 CellID->2094833135,ExpressionUUID->"41a6cf96-7d2b-474f-bc33-c315ad5063aa"],

Cell[TextData[{
 StyleBox["Figure 1",
  FontWeight->"Bold"],
 ". A quantum circuit implementing the linear combination of unitary gates, \
",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sum]", "k"], 
    RowBox[{
     SubscriptBox["\[Alpha]", "k"], 
     SubscriptBox["U", "k"]}]}], TraditionalForm]],ExpressionUUID->
  "ee2f2ac9-c1b9-4f01-815f-f57887b75268"],
 ". Here, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["V", "T"], TraditionalForm]],ExpressionUUID->
  "3ca76c48-24ba-4366-9788-d606c032be1d"],
 " is a unitary operator the matrix representation of which is given by the \
transpose of that of ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "e473e33d-3946-485d-9b2e-7eb4369489ce"],
 " in the computational basis."
}], "TechNoteCaption",
 CellID->1051781767,ExpressionUUID->"be1725be-30e3-42ac-8ddd-da53e4f66dbb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "TechNoteSection",
 CellID->2113806542,ExpressionUUID->"c3c849ca-c0dc-4a1b-abee-499405e659d4"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[2]:=",
 CellID->546965754,ExpressionUUID->"85ec98f3-8339-43c2-9899-afa8a98fe5de"],

Cell["\<\
Refer to the ancillary and system register by symbols A and S:\
\>", "TechNoteMathCaption",
 CellID->858035274,ExpressionUUID->"f7bcae5f-44ac-46a2-b1ab-bf46e444bbb3"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "A", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[3]:=",
 CellID->430885452,ExpressionUUID->"3f190472-6c16-470d-a4d0-0d0158ed732a"],

Cell[TextData[{
 "Consider a system register consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "15622a71-2555-40be-881f-4ec610cb81e3"],
 " qubits:"
}], "TechNoteMathCaption",
 CellID->1499619177,ExpressionUUID->"02f5fee0-95f9-4ce8-8377-52aa9672d451"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellLabel->"In[4]:=",
 CellID->839037348,ExpressionUUID->"d9a366ee-6e79-4521-9561-77dc86fe2f0f"],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   SubscriptBox["S", 
    TemplateBox[{",", "\",\"", "1"},
     "RowWithSeparators"]],
   $CellContext`S[1, QuantumMob`Q3`$]], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->2024425648,ExpressionUUID->"a1d42b77-4887-4bf5-84ce-e9f593dec9f3"]
}, Open  ]],

Cell[TextData[{
 "Take some unitary gates ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", "k"], TraditionalForm]],ExpressionUUID->
  "0f59f6ea-2d42-4366-b030-7140561ccefa"],
 " (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"k", "=", "0"}], ",", "\[Ellipsis]", ",", 
     RowBox[{
      SuperscriptBox["2", "m"], "-", "1"}]}], ")"}], TraditionalForm]],
  ExpressionUUID->"edca8aa1-4e67-4006-9077-e7a474736ab7"],
 " on the system register:"
}], "TechNoteMathCaption",
 CellID->1587367910,ExpressionUUID->"4e509a82-8f73-4079-bc5e-466fb2fde218"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$m", "=", "2"}], ";"}]], "Input",
 CellLabel->"In[6]:=",
 CellID->1381591108,ExpressionUUID->"9117f9ce-afc2-42b7-a669-788128e32c08"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "[", "k_", "]"}], ":=", 
  RowBox[{"Rotation", "[", 
   RowBox[{
    RowBox[{"Pi", "*", 
     RowBox[{"k", "/", "6"}]}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"UU", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"U", "[", "k", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{
       RowBox[{"Range", "@", 
        RowBox[{"Power", "[", 
         RowBox[{"2", ",", "$m"}], "]"}]}], "-", "1"}]}], "}"}]}], 
   "]"}]}]}], "Input",
 CellLabel->"In[7]:=",
 CellID->1361450766,ExpressionUUID->"86eb3131-2cfd-447f-acd8-198ed0d5cb98"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TagBox[
     RowBox[{"Exp", 
      RowBox[{"(", "0", ")"}]}],
     DisplayForm],
    QuantumMob`Q3`Rotation[0, {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$]]], ",", 
   InterpretationBox[
    TagBox[
     RowBox[{"Exp", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "12"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
          "Subsuperscript"],
         $CellContext`S[1, 2]]}], ")"}]}],
     DisplayForm],
    QuantumMob`Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$]]], ",", 
   InterpretationBox[
    TagBox[
     RowBox[{"Exp", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "6"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
          "Subsuperscript"],
         $CellContext`S[1, 2]]}], ")"}]}],
     DisplayForm],
    QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$]]], ",", 
   InterpretationBox[
    TagBox[
     RowBox[{"Exp", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
          "Subsuperscript"],
         $CellContext`S[1, 2]]}], ")"}]}],
     DisplayForm],
    QuantumMob`Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$]]]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1938446515,ExpressionUUID->"e2e36959-1bca-4f59-9b9c-5eea2273ccbf"]
}, Open  ]],

Cell[TextData[{
 "We will need an ancilla register of ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "92b22266-543d-4c77-9e4e-a5f2cbf3317b"],
 " qubits:"
}], "TechNoteMathCaption",
 CellID->225013878,ExpressionUUID->"e65a08b6-9742-4932-8be7-00aea0386da7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AA", "=", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$m"}], ",", "$"}], "]"}]}]], "Input",
 CellLabel->"In[9]:=",
 CellID->576934080,ExpressionUUID->"7c91e07c-425f-4326-99e5-dbd0fa6be9ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["A", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`A[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["A", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`A[2, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->2143652615,ExpressionUUID->"2d947d8c-1ee4-4663-a7be-2b6ba6bde3a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simple Sum", "Subsection",
 CellID->1973147550,ExpressionUUID->"01f91745-b5c0-474c-a58e-d4045d5c894b"],

Cell[TextData[{
 "Consider the sum ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", ":=", 
    RowBox[{
     SubscriptBox["\[Sum]", "k"], 
     SubscriptBox["U", "k"]}]}], TraditionalForm]],ExpressionUUID->
  "76f5fc26-849f-4879-bb92-570886f37c3a"],
 " of the unitary gates:"
}], "TechNoteMathCaption",
 CellID->1846260513,ExpressionUUID->"3ae2f8f5-a8ea-4fde-b5f2-2025aad2edf8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TT", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"U", "[", "k", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[10]:=",
 CellID->740865323,ExpressionUUID->"9b9ba0ad-becd-4a04-9739-1a4c8730e6d5"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    RowBox[{"Exp", 
     RowBox[{"(", "0", ")"}]}],
    DisplayForm],
   QuantumMob`Q3`Rotation[0, {0, 1, 0}, 
    $CellContext`S[1, QuantumMob`Q3`$]]], "+", 
  InterpretationBox[
   TagBox[
    RowBox[{"Exp", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "12"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
         "Subsuperscript"],
        $CellContext`S[1, 2]]}], ")"}]}],
    DisplayForm],
   QuantumMob`Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
    $CellContext`S[1, QuantumMob`Q3`$]]], "+", 
  InterpretationBox[
   TagBox[
    RowBox[{"Exp", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "6"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
         "Subsuperscript"],
        $CellContext`S[1, 2]]}], ")"}]}],
    DisplayForm],
   QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
    $CellContext`S[1, QuantumMob`Q3`$]]], "+", 
  InterpretationBox[
   TagBox[
    RowBox[{"Exp", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
         "Subsuperscript"],
        $CellContext`S[1, 2]]}], ")"}]}],
    DisplayForm],
   QuantumMob`Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
    $CellContext`S[1, QuantumMob`Q3`$]]]}]], "Output",
 CellLabel->"Out[10]=",
 CellID->36354586,ExpressionUUID->"888afe13-5615-4b2e-919b-7a6a714adb7d"]
}, Open  ]],

Cell[TextData[{
 "In general, ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "fa66a92f-4207-458e-8be7-8e02c1a04af8"],
 " is not unitary, and cannot be directly implemented on a quantum computer. \
However, one can realize it probabilistically with a quantum circuit of the \
form and post-selection with respect to the ancilla register for state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{"00", "\[Ellipsis]0"}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "23dae7a4-6665-439d-8526-e887bc50df4b"],
 ":"
}], "TechNoteMathCaption",
 CellID->47470155,ExpressionUUID->"018032f3-6c35-4de0-a022-ae1bd9d0b949"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", "AA", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Through", "[", 
     RowBox[{"AA", "[", "6", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"UniformlyControlledGate", "[", 
     RowBox[{"AA", ",", "UU", ",", 
      RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Through", "[", 
     RowBox[{"AA", "[", "6", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"A", "[", 
      RowBox[{"$m", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[11]:=",
 CellID->260210010,ExpressionUUID->"5d14bfe4-0125-41b7-840c-0ebeb942cd2e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -4}, {4, -4}}}], {
     InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -2}, {2, -4}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      DiskBox[{2, -1}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {LightDarkSwitched[
        GrayLevel[0]], 
       DiskBox[{2, -1}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      DiskBox[{2, -2}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {LightDarkSwitched[
        GrayLevel[0]], 
       DiskBox[{2, -2}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"\[Ellipsis]\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`PortIn[
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>]], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, 
   QuantumMob`Q3`UniformlyControlledGate[{
     $CellContext`A[1, QuantumMob`Q3`$], 
     $CellContext`A[2, QuantumMob`Q3`$]}, {
     QuantumMob`Q3`Rotation[0, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]], 
     QuantumMob`Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]], 
     QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]], 
     QuantumMob`Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]]}, "Label" -> "U"], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, "Invisible" -> $CellContext`A[
     Rational[5, 2]]]]], "Output",
 CellLabel->"Out[11]=",
 CellID->1126171154,ExpressionUUID->"a1153a8d-f5a5-4386-aa24-80b9154269c3"]
}, Open  ]],

Cell["\<\
The above quantum circuit is, of course, equivalent to the following one:\
\>", "TechNoteMathCaption",
 CellID->1302929911,ExpressionUUID->"bfca0bd6-1e12-4573-a557-98eb1d9ef210"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Unfold", "[", "qc", "]"}]], "Input",
 CellLabel->"In[12]:=",
 CellID->418097618,ExpressionUUID->"f7d0e447-3d6e-49c1-988b-a3a8d51efa79"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -4}, {7, -4}}}], {
     InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -2}, {2, -4}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{2, -1}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{2, -2}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "0"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -1}, {3, -2}, {3, -4}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{3, -1}, 0.09]}, 
     DiskBox[{3, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "1"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -2}, {4, -4}}], 
     DiskBox[{4, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{4, -2}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {4., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -1}, {5, -2}, {5, -4}}], 
     DiskBox[{5, -1}, 0.09], DiskBox[{5, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {6., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.05714285714285714],
        FontWeight->"Light",
        FontSlant->Italic], {6., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->298.8,
   PlotRange->{{0, 7}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`PortIn[
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>]], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, 
   QuantumMob`Q3`ControlledGate[{$CellContext`A[1, QuantumMob`Q3`$] -> 
     0, $CellContext`A[2, QuantumMob`Q3`$] -> 0}, 
    QuantumMob`Q3`Rotation[0, {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$]], "Label" -> Subscript["U", 0], 
    "Label" -> "U"], 
   QuantumMob`Q3`ControlledGate[{$CellContext`A[1, QuantumMob`Q3`$] -> 
     0, $CellContext`A[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$]], "Label" -> Subscript["U", 1], 
    "Label" -> "U"], 
   QuantumMob`Q3`ControlledGate[{$CellContext`A[1, QuantumMob`Q3`$] -> 
     1, $CellContext`A[2, QuantumMob`Q3`$] -> 0}, 
    QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$]], "Label" -> Subscript["U", 2], 
    "Label" -> "U"], 
   QuantumMob`Q3`ControlledGate[{$CellContext`A[1, QuantumMob`Q3`$] -> 
     1, $CellContext`A[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$]], "Label" -> Subscript["U", 3], 
    "Label" -> "U"], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, "Invisible" -> $CellContext`A[
     Rational[5, 2]]]]], "Output",
 CellLabel->"Out[12]=",
 CellID->1785204267,ExpressionUUID->"efd047ef-5394-4475-8b87-d4cb1ff1716e"]
}, Open  ]],

Cell["To test  it, take an arbitrary input state:", "TechNoteMathCaption",
 CellID->196018039,ExpressionUUID->"92ab3459-6fe6-45b4-b144-8beed87e934d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"in", "=", 
  RowBox[{"ProductState", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], "->", 
     RowBox[{"c", "@", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}]}], ",", 
    RowBox[{"\"\<Label\>\"", "->", 
     RowBox[{"Ket", "@", 
      RowBox[{"{", "\"\<\[Psi]\>\"", "}"}]}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[13]:=",
 CellID->164075254,ExpressionUUID->"d91254fe-cb5c-4b5e-852a-edda08227f26"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]], " ", 
       TemplateBox[{"0"},
        "Ket"]}], "+", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`c[1]], " ", 
       TemplateBox[{"1"},
        "Ket"]}]}], ")"}], 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`S[1, QuantumMob`Q3`$]]],
   DisplayForm],
  QuantumMob`Q3`ProductState[<|$CellContext`S[1, QuantumMob`Q3`$] -> {
      $CellContext`c[0], 
      $CellContext`c[1]}|>, "Label" -> Ket[{"\[Psi]"}]]]], "Output",
 CellLabel->"Out[14]=",
 CellID->1434083232,ExpressionUUID->"772b3faa-87dc-4531-8e63-b03ef83e71a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"full", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"in", ",", "qc"}], "]"}]}]], "Input",
 CellLabel->"In[15]:=",
 CellID->1764537993,ExpressionUUID->"fbce44ee-381b-4f68-b1c6-b0ad47cb4edf"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -4}, {4, -4}}}], 
    InsetBox[
     TemplateBox[{"\"\[Psi]\""},
      "Ket"], {-0.2, -4.}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1, 
     0}], {InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -2}, {2, -4}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      DiskBox[{2, -1}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {LightDarkSwitched[
        GrayLevel[0]], 
       DiskBox[{2, -1}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      DiskBox[{2, -2}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {LightDarkSwitched[
        GrayLevel[0]], 
       DiskBox[{2, -2}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "\<\"\[Ellipsis]\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`PortIn[
    QuantumMob`Q3`ProductState[<|$CellContext`S[1, QuantumMob`Q3`$] -> {
        $CellContext`c[0], 
        $CellContext`c[1]}|>, "Label" -> Ket[{"\[Psi]"}]], 
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>]], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, 
   QuantumMob`Q3`UniformlyControlledGate[{
     $CellContext`A[1, QuantumMob`Q3`$], 
     $CellContext`A[2, QuantumMob`Q3`$]}, {
     QuantumMob`Q3`Rotation[0, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]], 
     QuantumMob`Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]], 
     QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]], 
     QuantumMob`Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]]}, "Label" -> "U"], {
    $CellContext`A[1, 6], 
    $CellContext`A[2, 6]}, "Invisible" -> $CellContext`A[
     Rational[5, 2]]]]], "Output",
 CellLabel->"Out[15]=",
 CellID->1427909943,ExpressionUUID->"23df9bf1-5d0a-4c34-ab90-7751d89039e8"]
}, Open  ]],

Cell[TextData[{
 "Take the projection operator onto ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{"00", "\[Ellipsis]0"}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "e62828b1-5a44-431d-ad6d-8eecede120e9"],
 ":"
}], "TechNoteMathCaption",
 CellID->1459936136,ExpressionUUID->"3269bb36-5c6b-4731-9bfd-faca6c4c6cd1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"prj", "=", 
  RowBox[{"Dyad", "[", 
   RowBox[{
    RowBox[{"Ket", "[", "AA", "]"}], ",", 
    RowBox[{"Ket", "[", "AA", "]"}], ",", "AA"}], "]"}]}]], "Input",
 CellLabel->"In[16]:=",
 CellID->2013398190,ExpressionUUID->"c0ad419e-7f6c-452d-a24b-757707fba34c"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["A", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["A", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]}, "Ket"], 
     Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
       0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>]], 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["A", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["A", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]}, "Bra"], 
     Bra[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
       0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>]]},
   "RowDefault"],
  QuantumMob`Q3`Dyad[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
    0, $CellContext`A[2, QuantumMob`Q3`$] -> 
    0|>, <|$CellContext`A[1, QuantumMob`Q3`$] -> 
    0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>]]], "Output",
 CellLabel->"Out[16]=",
 CellID->752656776,ExpressionUUID->"261d210e-f6a9-48f7-a062-369b600d0a96"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"out", "=", 
  RowBox[{"prj", "**", "full"}]}], "\[IndentingNewLine]", 
 RowBox[{"out", "=", 
  RowBox[{"KetCanonical", "[", 
   RowBox[{
    RowBox[{"KetDrop", "[", 
     RowBox[{"out", ",", "AA"}], "]"}], ",", "False"}], "]"}]}]}], "Input",
 CellLabel->"In[17]:=",
 CellID->1512371685,ExpressionUUID->"cc5db219-8259-45e7-839f-f0fa1535a3b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "+", 
        RowBox[{"3", " ", 
         SqrtBox["2"]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}], "+", 
        SqrtBox["6"]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`c[0]]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SqrtBox["2"], "+", 
        SqrtBox["6"]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[1, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SqrtBox["2"], "+", 
        SqrtBox["6"]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`c[0]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "+", 
        RowBox[{"3", " ", 
         SqrtBox["2"]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox["3"]}], "+", 
        SqrtBox["6"]}], ")"}], " ", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`A[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["A", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`A[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
      0, $CellContext`A[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[17]=",
 CellID->1223753402,ExpressionUUID->"5084c71d-df63-41c5-9520-3f40014abf97"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SqrtBox["2"], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "+", 
         RowBox[{"3", " ", 
          SqrtBox["2"]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["3"]}], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`c[1]]}]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", "+", 
       RowBox[{"3", " ", 
        SqrtBox["2"]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox["3"]}], "+", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`c[0]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       SqrtBox["2"], "+", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]]}]}]]}]], "Output",
 CellLabel->"Out[18]=",
 CellID->1172540095,ExpressionUUID->"426f052e-9f6c-46d6-a302-86f924d4b3e9"]
}, Open  ]],

Cell[TextData[{
 "Compare the above result with the direct operation of ",
 StyleBox["T",
  FontSlant->"Italic"],
 " on the input state:"
}], "TechNoteMathCaption",
 CellID->1926262569,ExpressionUUID->"a5313e99-a09c-425c-9214-0e5f64741bfc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Elaborate", "@", 
   RowBox[{"KetCanonical", "[", 
    RowBox[{
     RowBox[{"TT", "**", "in"}], ",", "False"}], "]"}]}]}]], "Input",
 CellLabel->"In[19]:=",
 CellID->550906173,ExpressionUUID->"ab1949f2-16a9-4736-8562-bd42a277bde6"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SqrtBox["2"], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "+", 
         RowBox[{"3", " ", 
          SqrtBox["2"]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["3"]}], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`c[1]]}]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"4", "+", 
       RowBox[{"3", " ", 
        SqrtBox["2"]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox["3"]}], "+", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`c[0]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       SqrtBox["2"], "+", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]]}]}]]}]], "Output",
 CellLabel->"Out[19]=",
 CellID->1571431793,ExpressionUUID->"85cd6a4d-eb46-4739-8883-6fe57bb6139f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "-", "new"}]], "Input",
 CellLabel->"In[20]:=",
 CellID->209695444,ExpressionUUID->"79d4c458-e434-4f6c-ade0-25b7e462d53c"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[20]=",
 CellID->1300254145,ExpressionUUID->"9c3b5f42-c554-4a96-a0c2-c0abd79dcc5f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear Superposition", "Subsection",
 CellID->1004589932,ExpressionUUID->"166af076-4334-4afa-a032-bd9f06c7aa16"],

Cell[TextData[{
 "Let us now consider a more general form of linear combination ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", ":=", 
    RowBox[{
     SubscriptBox["\[Sum]", "k"], 
     RowBox[{
      SubscriptBox["\[Alpha]", "k"], 
      SubscriptBox["U", "k"]}]}]}], TraditionalForm]],ExpressionUUID->
  "0efdb133-cfbe-434e-b77b-6a0acca69eab"],
 " of the unitary gates:"
}], "TechNoteMathCaption",
 CellID->996657064,ExpressionUUID->"fb5c85ef-92f8-43e1-9f36-e45b3e7fc3b3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Alpha]", "=", 
  RowBox[{"{", 
   RowBox[{"1", ",", 
    RowBox[{"1", "/", "2"}], ",", 
    RowBox[{"-", "I"}], ",", 
    RowBox[{
     RowBox[{"-", "I"}], "/", "2"}]}], "}"}]}]], "Input",
 CellLabel->"In[21]:=",
 CellID->1658219594,ExpressionUUID->"b786d700-5aaa-4fe6-bd90-0b2921bbd212"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["1", "2"], ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", 
   RowBox[{"-", 
    FractionBox["\[ImaginaryI]", "2"]}]}], "}"}]], "Output",
 CellLabel->"Out[21]=",
 CellID->577823143,ExpressionUUID->"a010e213-f04e-45f5-a96d-33813c2ab3f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TT", "=", 
  RowBox[{"\[Alpha]", ".", "UU"}]}]], "Input",
 CellLabel->"In[22]:=",
 CellID->75389019,ExpressionUUID->"010e9e1f-d1d9-4bd7-a8be-35e920d1ba37"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    RowBox[{"Exp", 
     RowBox[{"(", "0", ")"}]}],
    DisplayForm],
   QuantumMob`Q3`Rotation[0, {0, 1, 0}, 
    $CellContext`S[1, QuantumMob`Q3`$]]], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    InterpretationBox[
     TagBox[
      RowBox[{"Exp", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "12"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
           "Subsuperscript"],
          $CellContext`S[1, 2]]}], ")"}]}],
      DisplayForm],
     QuantumMob`Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]]], ")"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"(", 
    InterpretationBox[
     TagBox[
      RowBox[{"Exp", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "6"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
           "Subsuperscript"],
          $CellContext`S[1, 2]]}], ")"}]}],
      DisplayForm],
     QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]]], ")"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    InterpretationBox[
     TagBox[
      RowBox[{"Exp", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
           "Subsuperscript"],
          $CellContext`S[1, 2]]}], ")"}]}],
      DisplayForm],
     QuantumMob`Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
      $CellContext`S[1, QuantumMob`Q3`$]]], ")"}]}]}]], "Output",
 CellLabel->"Out[22]=",
 CellID->552512667,ExpressionUUID->"52b5c998-334a-40d0-9f01-afe3af88d66b"]
}, Open  ]],

Cell[TextData[{
 "We fist construct the so-called ",
 StyleBox["preparation oracles",
  FontSlant->"Italic"],
 ", ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "5c7e56c6-2fa6-4d81-ae74-68b7174d1159"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["V", "T"], TraditionalForm]],ExpressionUUID->
  "681a6709-536e-433b-99ad-5f250f7e4475"],
 ":"
}], "TechNoteMathCaption",
 CellID->163515187,ExpressionUUID->"262cda82-1a2b-4f21-aeff-49fa85db2349"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matV", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"One", "[", 
     RowBox[{"Power", "[", 
      RowBox[{"2", ",", "$m"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matV", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"N", "@", "\[Alpha]"}], "]"}], "/", 
    RowBox[{"Norm", "[", 
     RowBox[{"\[Alpha]", ",", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matV", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Chop", "@", 
     RowBox[{"Orthogonalize", "@", "matV"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"matV", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[23]:=",
 CellID->1103004868,ExpressionUUID->"76647d73-5550-446c-ae57-1221195e6db4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5773502691896258`", 
      RowBox[{"-", "0.2581988897471611`"}], 
      RowBox[{
       RowBox[{"-", "0.36514837167011077`"}], "-", 
       RowBox[{"0.36514837167011077`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4082482904638631`"}], "-", 
       RowBox[{"0.4082482904638631`", " ", "\[ImaginaryI]"}]}]},
     {"0.40824829046386313`", "0.9128709291752768`", "0", "0"},
     {
      RowBox[{"0.40824829046386313`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.40824829046386313`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.18257418583505539`"}], "+", 
       RowBox[{"0.18257418583505539`", " ", "\[ImaginaryI]"}]}], 
      "0.7745966692414834`", "0"},
     {
      RowBox[{"0.2886751345948129`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2886751345948129`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.12909944487358055`"}], "+", 
       RowBox[{"0.12909944487358055`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.36514837167011077`"}], "0.8164965809277261`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[26]//MatrixForm=",
 CellID->361104641,ExpressionUUID->"fb2be90f-8d61-44f6-9d14-37b2dac02ffb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"matV", ".", 
    RowBox[{"Topple", "[", "matV", "]"}]}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[27]:=",
 CellID->1455841953,ExpressionUUID->"a5683a35-ba8d-47b2-815f-e05ec98e53bf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.0000000000000002`", "0", "0", "0"},
     {"0", "1.`", "0", "0"},
     {"0", "0", "1.0000000000000004`", "0"},
     {"0", "0", "0", "1.0000000000000002`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[27]//MatrixForm=",
 CellID->296914865,ExpressionUUID->"5f6ff6a0-590f-40df-890b-2bc9a6d2ecaf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"VV", "=", 
  RowBox[{"Operator", "[", 
   RowBox[{"matV", ",", "AA", ",", 
    RowBox[{"\"\<Label\>\"", "->", "\"\<V\>\""}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"VT", "=", 
  RowBox[{"Operator", "[", 
   RowBox[{
    RowBox[{"Transpose", "@", "matV"}], ",", "AA", ",", 
    RowBox[{"\"\<Label\>\"", 
     "->", "\"\<\!\(\*SuperscriptBox[\(V\), \(T\)]\)\>\""}]}], 
   "]"}]}]}], "Input",
 CellLabel->"In[28]:=",
 CellID->591283205,ExpressionUUID->"c22041a5-45b9-4b56-b7db-82e27ee4932a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["Operator",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Species: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, QuantumMob`Q3`$]]}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Species: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, QuantumMob`Q3`$]]}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Matrix (5\[Times]5): \"", "SummaryItemAnnotation"],
                  "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0.5773502691896258`", 
                    RowBox[{"-", "0.2581988897471611`"}], 
                    RowBox[{
                    RowBox[{"-", "0.36514837167011077`"}], "-", 
                    RowBox[{"0.36514837167011077`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.4082482904638631`"}], "-", 
                    
                    RowBox[{
                    "0.4082482904638631`", " ", "\[ImaginaryI]"}]}]}, {
                    "0.40824829046386313`", "0.9128709291752768`", "0", "0"}, {
                    RowBox[{
                    RowBox[{"0.40824829046386313`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.40824829046386313`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.18257418583505539`"}], "+", 
                    RowBox[{"0.18257418583505539`", " ", "\[ImaginaryI]"}]}], 
                    "0.7745966692414834`", "0"}, {
                    RowBox[{
                    RowBox[{"0.2886751345948129`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.2886751345948129`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.12909944487358055`"}], "+", 
                    RowBox[{"0.12909944487358055`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{"-", "0.36514837167011077`"}], 
                    "0.8164965809277261`"}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$]]], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Options: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"\"Label\"", "\[Rule]", "\"V\""}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`Operator[{{0.5773502691896258, -0.2581988897471611, 
     Complex[-0.36514837167011077`, -0.36514837167011077`], 
     Complex[-0.4082482904638631, -0.4082482904638631]}, {
    0.40824829046386313`, 0.9128709291752768, 0, 0}, {
     Complex[0.40824829046386313`, -0.40824829046386313`], 
     Complex[-0.18257418583505539`, 0.18257418583505539`], 0.7745966692414834,
      0}, {
     Complex[0.2886751345948129, -0.2886751345948129], 
     Complex[-0.12909944487358055`, 
      0.12909944487358055`], -0.36514837167011077`, 0.8164965809277261}}, {
    $CellContext`A[1, QuantumMob`Q3`$], 
    $CellContext`A[2, QuantumMob`Q3`$]}, "Label" -> "V"],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[28]=",
 CellID->1643624074,ExpressionUUID->"f10e4345-8a22-4e30-a967-f7ea135a972a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["Operator",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Species: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, QuantumMob`Q3`$]]}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Species: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, QuantumMob`Q3`$]]}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimension: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Matrix (5\[Times]5): \"", "SummaryItemAnnotation"],
                  "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0.5773502691896258`", "0.40824829046386313`", 
                    RowBox[{
                    RowBox[{"0.40824829046386313`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.40824829046386313`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.2886751345948129`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.2886751345948129`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{"-", "0.2581988897471611`"}], 
                    "0.9128709291752768`", 
                    RowBox[{
                    RowBox[{"-", "0.18257418583505539`"}], "+", 
                    RowBox[{"0.18257418583505539`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.12909944487358055`"}], "+", 
                    
                    RowBox[{
                    "0.12909944487358055`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.36514837167011077`"}], "-", 
                    RowBox[{"0.36514837167011077`", " ", "\[ImaginaryI]"}]}], 
                    "0", "0.7745966692414834`", 
                    RowBox[{"-", "0.36514837167011077`"}]}, {
                    RowBox[{
                    RowBox[{"-", "0.4082482904638631`"}], "-", 
                    RowBox[{"0.4082482904638631`", " ", "\[ImaginaryI]"}]}], 
                    "0", "0", "0.8164965809277261`"}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$]]], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Options: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "\"Label\"", "\[Rule]", 
                    "\"\\!\\(\\*SuperscriptBox[\\(V\\), \\(T\\)]\\)\""}], 
                    "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`Operator[{{0.5773502691896258, 0.40824829046386313`, 
     Complex[0.40824829046386313`, -0.40824829046386313`], 
     Complex[0.2886751345948129, -0.2886751345948129]}, {-0.2581988897471611, 
     0.9128709291752768, 
     Complex[-0.18257418583505539`, 0.18257418583505539`], 
     Complex[-0.12909944487358055`, 0.12909944487358055`]}, {
     Complex[-0.36514837167011077`, -0.36514837167011077`], 0, 
     0.7745966692414834, -0.36514837167011077`}, {
     Complex[-0.4082482904638631, -0.4082482904638631], 0, 0, 
     0.8164965809277261}}, {
    $CellContext`A[1, QuantumMob`Q3`$], 
    $CellContext`A[2, QuantumMob`Q3`$]}, "Label" -> 
   "\!\(\*SuperscriptBox[\(V\), \(T\)]\)"],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[29]=",
 CellID->1307660357,ExpressionUUID->"0e21caa4-050a-4aeb-a761-bd4e0f87458f"]
}, Open  ]],

Cell[TextData[{
 "Construct the so-called selection oracle, ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],ExpressionUUID->
  "a58ed633-cdbb-49d8-9bab-67473a10a0c3"],
 ", which is just given by the uniformly-controlled gate:"
}], "TechNoteMathCaption",
 CellID->250193288,ExpressionUUID->"8a60afde-2095-44e4-8b17-1055a05571a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WW", "=", 
  RowBox[{"UniformlyControlledGate", "[", 
   RowBox[{"AA", ",", "UU", ",", 
    RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}]}]], "Input",
 CellLabel->"In[30]:=",
 CellID->419092567,ExpressionUUID->"94525bf0-88a9-416c-acf3-d7d9e73b4c5c"],

Cell[BoxData[
 RowBox[{"UniformlyControlledGate", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["A", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`A[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["A", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`A[2, QuantumMob`Q3`$]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      TagBox[
       RowBox[{"Exp", 
        RowBox[{"(", "0", ")"}]}],
       DisplayForm],
      QuantumMob`Q3`Rotation[0, {0, 1, 0}, 
       $CellContext`S[1, QuantumMob`Q3`$]]], ",", 
     InterpretationBox[
      TagBox[
       RowBox[{"Exp", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "12"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
          
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
            "Subsuperscript"],
           $CellContext`S[1, 2]]}], ")"}]}],
       DisplayForm],
      QuantumMob`Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
       $CellContext`S[1, QuantumMob`Q3`$]]], ",", 
     InterpretationBox[
      TagBox[
       RowBox[{"Exp", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "6"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
            "Subsuperscript"],
           $CellContext`S[1, 2]]}], ")"}]}],
       DisplayForm],
      QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
       $CellContext`S[1, QuantumMob`Q3`$]]], ",", 
     InterpretationBox[
      TagBox[
       RowBox[{"Exp", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
            "Subsuperscript"],
           $CellContext`S[1, 2]]}], ")"}]}],
       DisplayForm],
      QuantumMob`Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
       $CellContext`S[1, QuantumMob`Q3`$]]]}], "}"}], ",", 
   RowBox[{"\<\"Label\"\>", "\[Rule]", "\<\"U\"\>"}]}], "]"}]], "Output",
 CellLabel->"Out[30]=",
 CellID->499976701,ExpressionUUID->"fe0610a6-1c74-4f26-8168-53cfd88d3fd3"]
}, Open  ]],

Cell["Take the overall quantum circuit:", "TechNoteMathCaption",
 CellID->1713564815,ExpressionUUID->"8c3c960e-7963-4465-84bf-f726e0db8c8f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qc", "=", 
   RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ket", "[", "AA", "]"}], ",", "in", ",", "\[IndentingNewLine]", 
     "VV", ",", "WW", ",", "VT", ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Invisible\>\"", "->", 
      RowBox[{"A", "@", 
       RowBox[{"{", 
        RowBox[{"$m", "+", 
         RowBox[{"1", "/", "2"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "@", 
  RowBox[{"{", 
   RowBox[{"qc", ",", "\"\<=\>\"", ",", 
    RowBox[{"Unfold", "[", "qc", "]"}]}], "}"}]}]}], "Input",
 CellLabel->"In[31]:=",
 CellID->866928573,ExpressionUUID->"858cb061-6d7a-4dd6-a458-2b234f723b17"],

Cell[BoxData[
 TemplateBox[{
   InterpretationBox[
    GraphicsBox[{{
       Dashing[{Small, Small}], 
       LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -4}, {4, -4}}}], {
      
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"0"}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -1.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}], 
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"0"}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -2.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}]}, {
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"\"\[Psi]\""}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -4.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}]}, {{
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
         "\"V\"", {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.1]}, StripOnInput -> False], TraditionalForm], {1., -1.5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{2, -1}, {2, -2}, {2, -4}}], {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        DiskBox[{2, -1}, 0.09, 
         NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
          3.9269908169872414`}]], 
        LightDarkSwitched[
         GrayLevel[0]], 
        DiskBox[{2, -1}, 0.09, 
         NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
          0.7853981633974483}]]}, {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        DiskBox[{2, -2}, 0.09, 
         NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
          3.9269908169872414`}]], 
        LightDarkSwitched[
         GrayLevel[0]], 
        DiskBox[{2, -2}, 0.09, 
         NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
          0.7853981633974483}]]}, {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
          SubscriptBox["\"U\"", "\"\[Ellipsis]\""], {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.1]}, StripOnInput -> False], TraditionalForm], {2., -4.}, 
        
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {{
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
         "\"\\!\\(\\*SuperscriptBox[\\(V\\), \\(T\\)]\\)\"", {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.1]}, StripOnInput -> False], TraditionalForm], {3., -1.5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {}, 
     PlotRange -> {{0, 4}, {-4.5, -0.5}}, 
     ImagePadding -> {{25.56, 25.56}, {7.2, 7.2}}, ImageSize -> 
     190.79999999999998`, PlotRangePadding -> Scaled[0.025]], 
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`PortIn[
      Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
        0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>], 
      QuantumMob`Q3`ProductState[<|$CellContext`S[1, QuantumMob`Q3`$] -> {
          $CellContext`c[0], 
          $CellContext`c[1]}|>, "Label" -> Ket[{"\[Psi]"}]]], 
     QuantumMob`Q3`Operator[{{0.5773502691896258, -0.2581988897471611, 
        Complex[-0.36514837167011077`, -0.36514837167011077`], 
        Complex[-0.4082482904638631, -0.4082482904638631]}, {
       0.40824829046386313`, 0.9128709291752768, 0, 0}, {
        Complex[0.40824829046386313`, -0.40824829046386313`], 
        Complex[-0.18257418583505539`, 0.18257418583505539`], 
        0.7745966692414834, 0}, {
        Complex[0.2886751345948129, -0.2886751345948129], 
        Complex[-0.12909944487358055`, 
         0.12909944487358055`], -0.36514837167011077`, 
        0.8164965809277261}}, {
       $CellContext`A[1, QuantumMob`Q3`$], 
       $CellContext`A[2, QuantumMob`Q3`$]}, "Label" -> "V"], 
     QuantumMob`Q3`UniformlyControlledGate[{
       $CellContext`A[1, QuantumMob`Q3`$], 
       $CellContext`A[2, QuantumMob`Q3`$]}, {
       QuantumMob`Q3`Rotation[0, {0, 1, 0}, 
        $CellContext`S[1, QuantumMob`Q3`$]], 
       QuantumMob`Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
        $CellContext`S[1, QuantumMob`Q3`$]], 
       QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
        $CellContext`S[1, QuantumMob`Q3`$]], 
       QuantumMob`Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
        $CellContext`S[1, QuantumMob`Q3`$]]}, "Label" -> "U"], 
     QuantumMob`Q3`Operator[{{0.5773502691896258, 0.40824829046386313`, 
        Complex[0.40824829046386313`, -0.40824829046386313`], 
        Complex[
        0.2886751345948129, -0.2886751345948129]}, {-0.2581988897471611, 
        0.9128709291752768, 
        Complex[-0.18257418583505539`, 0.18257418583505539`], 
        Complex[-0.12909944487358055`, 0.12909944487358055`]}, {
        Complex[-0.36514837167011077`, -0.36514837167011077`], 0, 
        0.7745966692414834, -0.36514837167011077`}, {
        Complex[-0.4082482904638631, -0.4082482904638631], 0, 0, 
        0.8164965809277261}}, {
       $CellContext`A[1, QuantumMob`Q3`$], 
       $CellContext`A[2, QuantumMob`Q3`$]}, "Label" -> 
      "\!\(\*SuperscriptBox[\(V\), \(T\)]\)"], "Invisible" -> {
       $CellContext`A[
        Rational[5, 2]]}]], "\"=\"", 
   InterpretationBox[
    GraphicsBox[{{
       Dashing[{Small, Small}], 
       LineBox[{}]}, 
      LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -4}, {7, -4}}}], {
      
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"0"}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -1.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}], 
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"0"}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -2.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}]}, {
       InsetBox[
        FormBox[
         StyleBox[
          TemplateBox[{"\"\[Psi]\""}, "Ket"], {}, StripOnInput -> False], 
         TraditionalForm], {-0.2, -4.}, 
        NCache[
         ImageScaled[{1, 
           Rational[1, 2]}], 
         ImageScaled[{1, 0.5}]], Automatic, {1, 0}]}, {{
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
         "\"V\"", {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {1., -1.5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{2, -1}, {2, -2}, {2, -4}}], {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        DiskBox[{2, -1}, 0.09]}, {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        DiskBox[{2, -2}, 0.09]}, {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
          SubscriptBox["\"U\"", "0"], {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {2., -4.}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{3, -1}, {3, -2}, {3, -4}}], {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        DiskBox[{3, -1}, 0.09]}, 
       DiskBox[{3, -2}, 0.09], {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
          SubscriptBox["\"U\"", "1"], {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {3., -4.}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{4, -1}, {4, -2}, {4, -4}}], 
       DiskBox[{4, -1}, 0.09], {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        DiskBox[{4, -2}, 0.09]}, {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
          SubscriptBox["\"U\"", "2"], {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {4., -4.}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{5, -1}, {5, -2}, {5, -4}}], 
       DiskBox[{5, -1}, 0.09], 
       DiskBox[{5, -2}, 0.09], {
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
          SubscriptBox["\"U\"", "3"], {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {5., -4.}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {{
        EdgeForm[
         Opacity[1]], 
        LightDarkSwitched[
         GrayLevel[1]], 
        RectangleBox[{5.6, -2.4}, {6.4, -0.6}]}, 
       InsetBox[
        FormBox[
         StyleBox[
         "\"\\!\\(\\*SuperscriptBox[\\(V\\), \\(T\\)]\\)\"", {
          FontSlant -> Italic, FontWeight -> "Light", FontSize -> 
           Scaled[0.05714285714285714]}, StripOnInput -> False], 
         TraditionalForm], {6., -1.5}, 
        NCache[
         ImageScaled[{
           Rational[1, 2], 
           Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {}, 
     PlotRange -> {{0, 7}, {-4.5, -0.5}}, 
     ImagePadding -> {{25.56, 25.56}, {7.2, 7.2}}, ImageSize -> 298.8, 
     PlotRangePadding -> Scaled[0.025]], 
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`PortIn[
      Ket[<|$CellContext`A[1, QuantumMob`Q3`$] -> 
        0, $CellContext`A[2, QuantumMob`Q3`$] -> 0|>], 
      QuantumMob`Q3`ProductState[<|$CellContext`S[1, QuantumMob`Q3`$] -> {
          $CellContext`c[0], 
          $CellContext`c[1]}|>, "Label" -> Ket[{"\[Psi]"}]]], 
     QuantumMob`Q3`Operator[{{0.5773502691896258, -0.2581988897471611, 
        Complex[-0.36514837167011077`, -0.36514837167011077`], 
        Complex[-0.4082482904638631, -0.4082482904638631]}, {
       0.40824829046386313`, 0.9128709291752768, 0, 0}, {
        Complex[0.40824829046386313`, -0.40824829046386313`], 
        Complex[-0.18257418583505539`, 0.18257418583505539`], 
        0.7745966692414834, 0}, {
        Complex[0.2886751345948129, -0.2886751345948129], 
        Complex[-0.12909944487358055`, 
         0.12909944487358055`], -0.36514837167011077`, 
        0.8164965809277261}}, {
       $CellContext`A[1, QuantumMob`Q3`$], 
       $CellContext`A[2, QuantumMob`Q3`$]}, "Label" -> "V"], 
     QuantumMob`Q3`ControlledGate[{$CellContext`A[1, QuantumMob`Q3`$] -> 
       0, $CellContext`A[2, QuantumMob`Q3`$] -> 0}, 
      QuantumMob`Q3`Rotation[0, {0, 1, 0}, 
       $CellContext`S[1, QuantumMob`Q3`$]], "Label" -> Subscript["U", 0], 
      "Label" -> "U"], 
     QuantumMob`Q3`ControlledGate[{$CellContext`A[1, QuantumMob`Q3`$] -> 
       0, $CellContext`A[2, QuantumMob`Q3`$] -> 1}, 
      QuantumMob`Q3`Rotation[Rational[1, 6] Pi, {0, 1, 0}, 
       $CellContext`S[1, QuantumMob`Q3`$]], "Label" -> Subscript["U", 1], 
      "Label" -> "U"], 
     QuantumMob`Q3`ControlledGate[{$CellContext`A[1, QuantumMob`Q3`$] -> 
       1, $CellContext`A[2, QuantumMob`Q3`$] -> 0}, 
      QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
       $CellContext`S[1, QuantumMob`Q3`$]], "Label" -> Subscript["U", 2], 
      "Label" -> "U"], 
     QuantumMob`Q3`ControlledGate[{$CellContext`A[1, QuantumMob`Q3`$] -> 
       1, $CellContext`A[2, QuantumMob`Q3`$] -> 1}, 
      QuantumMob`Q3`Rotation[Rational[1, 2] Pi, {0, 1, 0}, 
       $CellContext`S[1, QuantumMob`Q3`$]], "Label" -> Subscript["U", 3], 
      "Label" -> "U"], 
     QuantumMob`Q3`Operator[{{0.5773502691896258, 0.40824829046386313`, 
        Complex[0.40824829046386313`, -0.40824829046386313`], 
        Complex[
        0.2886751345948129, -0.2886751345948129]}, {-0.2581988897471611, 
        0.9128709291752768, 
        Complex[-0.18257418583505539`, 0.18257418583505539`], 
        Complex[-0.12909944487358055`, 0.12909944487358055`]}, {
        Complex[-0.36514837167011077`, -0.36514837167011077`], 0, 
        0.7745966692414834, -0.36514837167011077`}, {
        Complex[-0.4082482904638631, -0.4082482904638631], 0, 0, 
        0.8164965809277261}}, {
       $CellContext`A[1, QuantumMob`Q3`$], 
       $CellContext`A[2, QuantumMob`Q3`$]}, "Label" -> 
      "\!\(\*SuperscriptBox[\(V\), \(T\)]\)"], "Invisible" -> {
       $CellContext`A[
        Rational[5, 2]]}]]},
  "RowDefault"]], "Output",
 CellLabel->"Out[32]=",
 CellID->4902996,ExpressionUUID->"69108812-8b08-4877-bd2f-f9458b62694b"]
}, Open  ]],

Cell["Calculate the output state, and perform the post-selection:", \
"TechNoteMathCaption",
 CellID->1735772354,ExpressionUUID->"8fa9ac1f-5144-4a24-9829-c4de7314588e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{"prj", "**", "qc"}], "//", "KetChop"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "=", 
  RowBox[{"KetCanonical", "[", 
   RowBox[{
    RowBox[{"KetDrop", "[", 
     RowBox[{"out", ",", "AA"}], "]"}], ",", "False"}], "]"}]}]}], "Input",
 CellLabel->"In[33]:=",
 CellID->907370804,ExpressionUUID->"c1202ea5-0179-4c6e-bf8d-ee363a6edbbe"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0.334427759521011`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.30054182938744944`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]]}], "+", 
      InterpretationBox[
       SubscriptBox["c", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`c[1]]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "0"},
       "RowWithSeparators"]],
     $CellContext`c[0]], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.334427759521011`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.30054182938744944`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]]}]}]]}]], "Output",
 CellLabel->"Out[34]=",
 CellID->800275186,ExpressionUUID->"22124626-b79e-4892-a510-f629888d3af2"]
}, Open  ]],

Cell[TextData[{
 "Compare the result above with the one from directly applying ",
 StyleBox["T",
  FontSlant->"Italic"],
 " on the input state:"
}], "TechNoteMathCaption",
 CellID->170046271,ExpressionUUID->"492c6cd8-ebf2-4588-a968-cc192061dc2d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Elaborate", "@", 
   RowBox[{"KetCanonical", "[", 
    RowBox[{
     RowBox[{"TT", "**", "in"}], ",", "False"}], "]"}]}]}]], "Input",
 CellLabel->"In[35]:=",
 CellID->1809121102,ExpressionUUID->"2af26ff9-ca7e-4b25-82af-374525c0e070"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "\[ImaginaryI]"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          SqrtBox["2"]}], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`c[0]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"8", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          SqrtBox["2"]}], "-", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", 
          SqrtBox["3"]}], "+", 
         SqrtBox["6"]}], ")"}], " ", 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`c[1]]}]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"8", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        SqrtBox["2"]}], "-", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "+", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`c[0]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "\[ImaginaryI]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        SqrtBox["2"]}], "-", 
       SqrtBox["6"]}], ")"}], " ", 
     InterpretationBox[
      SubscriptBox["c", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`c[1]]}]}]]}]], "Output",
 CellLabel->"Out[35]=",
 CellID->534969941,ExpressionUUID->"afeb8598-3d74-4b2a-b5b0-b6329c9f12e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"out", "-", "new"}], "//", "Garner"}], "//", "Chop"}]], "Input",
 CellLabel->"In[36]:=",
 CellID->733395986,ExpressionUUID->"789fffaf-dc4c-49d8-92ec-0c061b8c9bd4"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[36]=",
 CellID->1873252045,ExpressionUUID->"8ed3bc05-2326-4f3c-8709-b28810d4211c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]],
          "TutorialMoreAbout",ExpressionUUID->
         "2e2c79fe-bec0-4410-92e1-ded76c9cc5ee"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"39e1405f-dc10-4f2e-ba57-\
327eb6cc7f64"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "a7207d38-5dfe-4af4-bf22-ed4419adf0da"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "d39871c2-ebc1-4379-9f68-f43506ad0ed8"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"d53a098e-42fa-48da-9830-\
7e2faf5fdf62"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "A. Gilyen, Y. Su, G. Hao, and N. Wiebe (2019)"}]]]], 
             "https://doi.org/10.1145/3313276.3316366"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "57d32b3a-e27f-4950-85ef-c1b9f5d76b0f"]}]],ExpressionUUID->
         "6aedc8ba-862b-4eb1-bbad-89c05e678b05"],
        ", Proceedings of the 51st Annual ACM SIGACT Symposium on Theory of \
Computing, \"Quantum singular value transformation and beyond: exponential \
improvements for quantum matrix arithmetics.\""
       }], "TutorialRelatedLinks",ExpressionUUID->
        "2c4d86cd-8918-4a91-bf28-5d4ce8580535"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "L. Lin (2022)"}]]]], 
             "https://arxiv.org/abs/2201.08309"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "a8b6d020-8a1c-4873-91bc-48e04536baa4"]}]],ExpressionUUID->
         "3bc239ae-2b54-471a-b411-3a3865cdff54"],
        ", arXiv:2201.08309, \"Lecture Notes on Quantum Algorithms for \
Scientific Computation.\""
       }], "TutorialRelatedLinks",ExpressionUUID->
        "7fd66c74-8647-45d2-ac4f-58a2819affec"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J. M. Martyn, Z. M. Rossi, A. K. Tan, I. L. Chuan \
(2021)"}]]]], "https://doi.org/10.1103%2Fprxquantum.2.040203"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "2396c6c5-ac6a-4034-bf97-87078fc40a2c"]}]],ExpressionUUID->
         "e6a1e1c9-93aa-402f-a452-caf77f10c4ea"],
        ", PRX Quantum 2, 4 040203, \"Grand Unification of Quantum \
Algorithms.\""
       }], "TutorialRelatedLinks",ExpressionUUID->
        "f290e82a-5ce8-475c-b951-50f47f0f3404"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "9c2d09e7-d186-4d71-92d1-8fa827c79196"]}]],ExpressionUUID->
         "7552cc31-8d77-4588-8350-55216fbc6f8e"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "c4f270dc-04ba-4707-8e13-4024e3f177de"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "477e9afc-111c-49f8-97bd-ffe025316030"]}]],ExpressionUUID->
         "49105c6a-21bf-41da-9d26-6ce8a67fd78e"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "285eeaa7-b97c-4469-aa6d-820e63c4f473"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"02fdf0e2-5c86-487e-a0aa-\
aa459b5be5ab"],

Cell[" ", "FooterCell",ExpressionUUID->"a46f6d2f-bc93-4930-847e-bfa2d7dddefd"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Linear Combination of Unitary Operators",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2024", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 10, 28, 9, 43, 1.226894}", 
    "history" -> {"14.0", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {
     "quantum singular value transform", "quantum eigen-value transform", 
      "linear combination of unitaries"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Tech Note", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3", "status" -> "None", "summary" -> 
    "Given unitary operators U_ 1,U_ 2,\\[Ellipsis],U_n, let \
T:=\\[Sum]_k\\[Alpha] _kU _k be a linear combination of those unitary \
operators, where \\[Alpha]_k are complex coefficients. In general, T is not \
unitary and cannot be implemented directly on a quantum computer. However, \
using an ancillary qubits, it can be implemented as discussed below. Let U_ \
1,U_ 2,\\[Ellipsis] be unitary operators and \\[Alpha]:=(\\[Alpha]_ \
1,\\[Alpha]_ 2,\\[Ellipsis]) be a vector of complex numbers. We want to \
implement a linear combination T:=\\[Sum]_k\\[Alpha] _kU _k of those unitary \
operators. Since T is not unitary in general, ancillary qubits are necessary. \
One way to implement T is through the quantum circuit shown in Figure 1, \
where V is a unitary operator with the first column stores the coefficients \
\\[Alpha]_k as follows:", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "Linear Combination of Unitary Operators", "titlemodifier" -> "", 
    "metadescription" -> "", "windowtitle" -> 
    "Linear Combination of Unitary Operators", "type" -> "Tech Note", "uri" -> 
    "QuantumMob/Q3/tutorial/LinearCombinationOfUnitaries"}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"14ddeb7b-95c5-4630-bfe9-ed9ce5cd17f1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[607, 21, 6736, 166, 70, "AnchorBarGrid",ExpressionUUID->"f481a5b7-14c8-4489-aea8-64995afd1f7a",
 CellID->1],
Cell[CellGroupData[{
Cell[7368, 191, 1393, 37, 70, "ObjectNameGrid",ExpressionUUID->"ea40ebab-8464-437e-b0af-204592dfdb8a"],
Cell[8764, 230, 2023, 46, 70, "TechNoteJumpBox",ExpressionUUID->"a7135d33-86ca-4b63-a478-198b5af92278"],
Cell[10790, 278, 1159, 31, 70, "TechNoteText",ExpressionUUID->"c925d693-9309-4865-8878-50ae1971a396",
 CellID->275259851],
Cell[11952, 311, 876, 22, 70, "DefinitionBox",ExpressionUUID->"64fe5b49-8e92-41ca-bd7e-c2fd25d01588",
 CellID->1025109959],
Cell[12831, 335, 197, 4, 70, "TechNoteCaption",ExpressionUUID->"c4f7088f-6d77-4d4a-a70f-386720cdc95e",
 CellID->1909264679],
Cell[13031, 341, 299, 7, 70, "TechNoteMathCaption",ExpressionUUID->"647db0b7-de13-4c95-ba56-254d966aec68",
 CellID->1428640008],
Cell[13333, 350, 177, 3, 70, "Input",ExpressionUUID->"ac1d84b4-802e-48dd-821d-f71c3ac1a764",
 CellID->853967906]
}, Open  ]],
Cell[CellGroupData[{
Cell[13547, 358, 124, 1, 70, "TechNoteSection",ExpressionUUID->"aa1a1814-d60b-4642-9e68-85f261df1b3c",
 CellID->221637712],
Cell[13674, 361, 1186, 34, 70, "TechNoteText",ExpressionUUID->"8108a9e3-2b85-43d9-854c-2cdc1b18c690",
 CellID->2083809428],
Cell[14863, 397, 642, 16, 70, "TechNoteText",ExpressionUUID->"b1829de5-75d9-41ac-b81f-58f9c279c561",
 CellID->786839548],
Cell[15508, 415, 864, 25, 70, "TechNoteText",ExpressionUUID->"3c02c6e5-931b-4402-9568-4f772275855f",
 CellID->1421741120],
Cell[16375, 442, 1169, 32, 70, "TechNoteText",ExpressionUUID->"d8c45519-0889-418a-b439-a0a5b9d836c7",
 CellID->1718500619],
Cell[17547, 476, 572, 11, 70, "TechNoteText",ExpressionUUID->"f6461958-552e-451f-a0b0-6bdf1ab4c468",
 CellID->1328382424],
Cell[18122, 489, 8898, 209, 70, "Picture",ExpressionUUID->"41a6cf96-7d2b-474f-bc33-c315ad5063aa",
 CellID->2094833135],
Cell[27023, 700, 861, 25, 70, "TechNoteCaption",ExpressionUUID->"be1725be-30e3-42ac-8ddd-da53e4f66dbb",
 CellID->1051781767]
}, Open  ]],
Cell[CellGroupData[{
Cell[27921, 730, 111, 1, 70, "TechNoteSection",ExpressionUUID->"c3c849ca-c0dc-4a1b-abee-499405e659d4",
 CellID->2113806542],
Cell[28035, 733, 177, 3, 70, "Input",ExpressionUUID->"85ec98f3-8339-43c2-9899-afa8a98fe5de",
 CellID->546965754],
Cell[28215, 738, 176, 3, 70, "TechNoteMathCaption",ExpressionUUID->"f7bcae5f-44ac-46a2-b1ab-bf46e444bbb3",
 CellID->858035274],
Cell[28394, 743, 191, 4, 70, "Input",ExpressionUUID->"3f190472-6c16-470d-a4d0-0d0158ed732a",
 CellID->430885452],
Cell[28588, 749, 284, 7, 70, "TechNoteMathCaption",ExpressionUUID->"02f5fee0-95f9-4ce8-8377-52aa9672d451",
 CellID->1499619177],
Cell[CellGroupData[{
Cell[28897, 760, 301, 8, 70, "Input",ExpressionUUID->"d9a366ee-6e79-4521-9561-77dc86fe2f0f",
 CellID->839037348],
Cell[29201, 770, 293, 8, 70, "Output",ExpressionUUID->"a1d42b77-4887-4bf5-84ce-e9f593dec9f3",
 CellID->2024425648]
}, Open  ]],
Cell[29509, 781, 565, 17, 70, "TechNoteMathCaption",ExpressionUUID->"4e509a82-8f73-4079-bc5e-466fb2fde218",
 CellID->1587367910],
Cell[30077, 800, 167, 4, 70, "Input",ExpressionUUID->"9117f9ce-afc2-42b7-a669-788128e32c08",
 CellID->1381591108],
Cell[CellGroupData[{
Cell[30269, 808, 667, 21, 70, "Input",ExpressionUUID->"86eb3131-2cfd-447f-acd8-198ed0d5cb98",
 CellID->1361450766],
Cell[30939, 831, 2091, 59, 70, "Output",ExpressionUUID->"e2e36959-1bca-4f59-9b9c-5eea2273ccbf",
 CellID->1938446515]
}, Open  ]],
Cell[33045, 893, 278, 7, 70, "TechNoteMathCaption",ExpressionUUID->"e65a08b6-9742-4932-8be7-00aea0386da7",
 CellID->225013878],
Cell[CellGroupData[{
Cell[33348, 904, 230, 6, 70, "Input",ExpressionUUID->"7c91e07c-425f-4326-99e5-dbd0fa6be9ee",
 CellID->576934080],
Cell[33581, 912, 470, 14, 70, "Output",ExpressionUUID->"2d947d8c-1ee4-4663-a7be-2b6ba6bde3a5",
 CellID->2143652615]
}, Open  ]],
Cell[CellGroupData[{
Cell[34088, 931, 108, 1, 70, "Subsection",ExpressionUUID->"01f91745-b5c0-474c-a58e-d4045d5c894b",
 CellID->1973147550],
Cell[34199, 934, 374, 11, 70, "TechNoteMathCaption",ExpressionUUID->"3ae2f8f5-a8ea-4fde-b5f2-2025aad2edf8",
 CellID->1846260513],
Cell[CellGroupData[{
Cell[34598, 949, 294, 8, 70, "Input",ExpressionUUID->"9b9ba0ad-becd-4a04-9739-1a4c8730e6d5",
 CellID->740865323],
Cell[34895, 959, 2012, 58, 70, "Output",ExpressionUUID->"888afe13-5615-4b2e-919b-7a6a714adb7d",
 CellID->36354586]
}, Open  ]],
Cell[36922, 1020, 648, 16, 70, "TechNoteMathCaption",ExpressionUUID->"018032f3-6c35-4de0-a022-ae1bd9d0b949",
 CellID->47470155],
Cell[CellGroupData[{
Cell[37595, 1040, 827, 19, 70, "Input",ExpressionUUID->"5d14bfe4-0125-41b7-840c-0ebeb942cd2e",
 CellID->260210010],
Cell[38425, 1061, 4563, 111, 70, "Output",ExpressionUUID->"a1153a8d-f5a5-4386-aa24-80b9154269c3",
 CellID->1126171154]
}, Open  ]],
Cell[43003, 1175, 188, 3, 70, "TechNoteMathCaption",ExpressionUUID->"bfca0bd6-1e12-4573-a557-98eb1d9ef210",
 CellID->1302929911],
Cell[CellGroupData[{
Cell[43216, 1182, 159, 3, 70, "Input",ExpressionUUID->"f7d0e447-3d6e-49c1-988b-a3a8d51efa79",
 CellID->418097618],
Cell[43378, 1187, 6275, 144, 70, "Output",ExpressionUUID->"efd047ef-5394-4475-8b87-d4cb1ff1716e",
 CellID->1785204267]
}, Open  ]],
Cell[49668, 1334, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"92ab3459-6fe6-45b4-b144-8beed87e934d",
 CellID->196018039],
Cell[CellGroupData[{
Cell[49842, 1339, 544, 15, 70, "Input",ExpressionUUID->"d91254fe-cb5c-4b5e-852a-edda08227f26",
 CellID->164075254],
Cell[50389, 1356, 992, 32, 70, "Output",ExpressionUUID->"772b3faa-87dc-4531-8e63-b03ef83e71a3",
 CellID->1434083232]
}, Open  ]],
Cell[CellGroupData[{
Cell[51418, 1393, 219, 5, 70, "Input",ExpressionUUID->"fbce44ee-381b-4f68-b1c6-b0ad47cb4edf",
 CellID->1764537993],
Cell[51640, 1400, 4890, 118, 70, "Output",ExpressionUUID->"23df9bf1-5d0a-4c34-ab90-7751d89039e8",
 CellID->1427909943]
}, Open  ]],
Cell[56545, 1521, 333, 10, 70, "TechNoteMathCaption",ExpressionUUID->"3269bb36-5c6b-4731-9bfd-faca6c4c6cd1",
 CellID->1459936136],
Cell[CellGroupData[{
Cell[56903, 1535, 283, 7, 70, "Input",ExpressionUUID->"c0ad419e-7f6c-452d-a24b-757707fba34c",
 CellID->2013398190],
Cell[57189, 1544, 1995, 45, 70, "Output",ExpressionUUID->"261d210e-f6a9-48f7-a062-369b600d0a96",
 CellID->752656776]
}, Open  ]],
Cell[CellGroupData[{
Cell[59221, 1594, 366, 9, 70, "Input",ExpressionUUID->"cc5db219-8259-45e7-839f-f0fa1535a3b8",
 CellID->1512371685],
Cell[59590, 1605, 3836, 109, 70, "Output",ExpressionUUID->"5084c71d-df63-41c5-9520-3f40014abf97",
 CellID->1223753402],
Cell[63429, 1716, 2478, 78, 70, "Output",ExpressionUUID->"426f052e-9f6c-46d6-a302-86f924d4b3e9",
 CellID->1172540095]
}, Open  ]],
Cell[65922, 1797, 240, 6, 70, "TechNoteMathCaption",ExpressionUUID->"a5313e99-a09c-425c-9214-0e5f64741bfc",
 CellID->1926262569],
Cell[CellGroupData[{
Cell[66187, 1807, 279, 7, 70, "Input",ExpressionUUID->"ab1949f2-16a9-4736-8562-bd42a277bde6",
 CellID->550906173],
Cell[66469, 1816, 2478, 78, 70, "Output",ExpressionUUID->"85cd6a4d-eb46-4739-8883-6fe57bb6139f",
 CellID->1571431793]
}, Open  ]],
Cell[CellGroupData[{
Cell[68984, 1899, 152, 3, 70, "Input",ExpressionUUID->"79d4c458-e434-4f6c-ade0-25b7e462d53c",
 CellID->209695444],
Cell[69139, 1904, 128, 2, 70, "Output",ExpressionUUID->"9c3b5f42-c554-4a96-a0c2-c0abd79dcc5f",
 CellID->1300254145]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69316, 1912, 118, 1, 70, "Subsection",ExpressionUUID->"166af076-4334-4afa-a032-bd9f06c7aa16",
 CellID->1004589932],
Cell[69437, 1915, 473, 13, 70, "TechNoteMathCaption",ExpressionUUID->"fb5c85ef-92f8-43e1-9f36-e45b3e7fc3b3",
 CellID->996657064],
Cell[CellGroupData[{
Cell[69935, 1932, 314, 9, 70, "Input",ExpressionUUID->"b786d700-5aaa-4fe6-bd90-0b2921bbd212",
 CellID->1658219594],
Cell[70252, 1943, 299, 8, 70, "Output",ExpressionUUID->"a010e213-f04e-45f5-a96d-33813c2ab3f7",
 CellID->577823143]
}, Open  ]],
Cell[CellGroupData[{
Cell[70588, 1956, 179, 4, 70, "Input",ExpressionUUID->"010e9e1f-d1d9-4bd7-a8be-35e920d1ba37",
 CellID->75389019],
Cell[70770, 1962, 2328, 66, 70, "Output",ExpressionUUID->"52b5c998-334a-40d0-9f01-afe3af88d66b",
 CellID->552512667]
}, Open  ]],
Cell[73113, 2031, 474, 15, 70, "TechNoteMathCaption",ExpressionUUID->"262cda82-1a2b-4f21-aeff-49fa85db2349",
 CellID->163515187],
Cell[CellGroupData[{
Cell[73612, 2050, 820, 24, 70, "Input",ExpressionUUID->"76647d73-5550-446c-ae57-1221195e6db4",
 CellID->1103004868],
Cell[74435, 2076, 1604, 38, 70, "Output",ExpressionUUID->"fb2be90f-8d61-44f6-9d14-37b2dac02ffb",
 CellID->361104641]
}, Open  ]],
Cell[CellGroupData[{
Cell[76076, 2119, 254, 7, 70, "Input",ExpressionUUID->"a5683a35-ba8d-47b2-815f-e05ec98e53bf",
 CellID->1455841953],
Cell[76333, 2128, 723, 19, 70, "Output",ExpressionUUID->"5f6ff6a0-590f-40df-890b-2bc9a6d2ecaf",
 CellID->296914865]
}, Open  ]],
Cell[CellGroupData[{
Cell[77093, 2152, 518, 13, 70, "Input",ExpressionUUID->"c22041a5-45b9-4b56-b7db-82e27ee4932a",
 CellID->591283205],
Cell[77614, 2167, 8006, 167, 70, "Output",ExpressionUUID->"f10e4345-8a22-4e30-a967-f7ea135a972a",
 CellID->1643624074],
Cell[85623, 2336, 8132, 170, 70, "Output",ExpressionUUID->"0e21caa4-050a-4aeb-a761-bd4e0f87458f",
 CellID->1307660357]
}, Open  ]],
Cell[93770, 2509, 331, 7, 70, "TechNoteMathCaption",ExpressionUUID->"8a60afde-2095-44e4-8b17-1055a05571a3",
 CellID->250193288],
Cell[CellGroupData[{
Cell[94126, 2520, 281, 6, 70, "Input",ExpressionUUID->"94525bf0-88a9-416c-acf3-d7d9e73b4c5c",
 CellID->419092567],
Cell[94410, 2528, 2715, 75, 70, "Output",ExpressionUUID->"fe0610a6-1c74-4f26-8168-53cfd88d3fd3",
 CellID->499976701]
}, Open  ]],
Cell[97140, 2606, 140, 1, 70, "TechNoteMathCaption",ExpressionUUID->"8c3c960e-7963-4465-84bf-f726e0db8c8f",
 CellID->1713564815],
Cell[CellGroupData[{
Cell[97305, 2611, 729, 18, 70, "Input",ExpressionUUID->"858cb061-6d7a-4dd6-a458-2b234f723b17",
 CellID->866928573],
Cell[98037, 2631, 14800, 383, 70, "Output",ExpressionUUID->"69108812-8b08-4877-bd2f-f9458b62694b",
 CellID->4902996]
}, Open  ]],
Cell[112852, 3017, 168, 2, 70, "TechNoteMathCaption",ExpressionUUID->"8fa9ac1f-5144-4a24-9829-c4de7314588e",
 CellID->1735772354],
Cell[CellGroupData[{
Cell[113045, 3023, 414, 11, 70, "Input",ExpressionUUID->"c1202ea5-0179-4c6e-bf8d-ee363a6edbbe",
 CellID->907370804],
Cell[113462, 3036, 2139, 60, 70, "Output",ExpressionUUID->"22124626-b79e-4892-a510-f629888d3af2",
 CellID->800275186]
}, Open  ]],
Cell[115616, 3099, 246, 6, 70, "TechNoteMathCaption",ExpressionUUID->"492c6cd8-ebf2-4588-a968-cc192061dc2d",
 CellID->170046271],
Cell[CellGroupData[{
Cell[115887, 3109, 280, 7, 70, "Input",ExpressionUUID->"2af26ff9-ca7e-4b25-82af-374525c0e070",
 CellID->1809121102],
Cell[116170, 3118, 3109, 95, 70, "Output",ExpressionUUID->"afeb8598-3d74-4b2a-b5b0-b6329c9f12e5",
 CellID->534969941]
}, Open  ]],
Cell[CellGroupData[{
Cell[119316, 3218, 209, 5, 70, "Input",ExpressionUUID->"789fffaf-dc4c-49d8-92ec-0c061b8c9bd4",
 CellID->733395986],
Cell[119528, 3225, 128, 2, 70, "Output",ExpressionUUID->"8ed3bc05-2326-4f3c-8709-b28810d4211c",
 CellID->1873252045]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[119695, 3232, 741, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"39e1405f-dc10-4f2e-ba57-327eb6cc7f64"],
Cell[120439, 3252, 1138, 30, 70, "RelatedTutorialsSection",ExpressionUUID->"d53a098e-42fa-48da-9830-7e2faf5fdf62"],
Cell[121580, 3284, 4940, 129, 70, "TutorialRelatedLinksSection",ExpressionUUID->"02fdf0e2-5c86-487e-a0aa-aa459b5be5ab"],
Cell[126523, 3415, 78, 0, 70, "FooterCell",ExpressionUUID->"a46f6d2f-bc93-4930-847e-bfa2d7dddefd"]
}
]
*)

(* End of internal cache information *)
