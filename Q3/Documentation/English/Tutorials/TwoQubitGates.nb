(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    592041,      15050]
NotebookOptionsPosition[    532427,      13887]
NotebookOutlinePosition[    538374,      14023]
CellTagsIndexPosition[    537958,      14007]
WindowTitle->Two-Qubit Gates
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "28857d15-6fd4-456c-9443-555c940f06e9"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "4571a742-7957-4119-a11c-915673d3e01a"],
        Background->LightDarkSwitched[
          RGBColor[
          0.3843137254901961, 0.4627450980392157, 0.7019607843137254]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "40eb3c85-0d98-49c8-aace-6ae30434855b"]
         }],ExpressionUUID->"f667b3aa-9f63-49c2-80ee-44915f3b09f0"],
         StripOnInput->False],{
        StyleBox["\"CNOT\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/CNOT"], 
         StyleBox[
          "\"ControlledGate\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ControlledGate"], 
         StyleBox["\"CZ\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/CZ"], 
         StyleBox[
          "\"GivensRotation\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/GivensRotation"], 
         StyleBox["\"SWAP\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/SWAP"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "1f05dc72-bbea-4d70-b896-62e2f6aa2baa"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "eb63cc57-f1a4-4be9-ad6a-99aa1d90a36b"]
         }],ExpressionUUID->"2fc1bdb7-e9f5-4d4a-a5f2-1523a941325d"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "b83de202-3e35-4694-8a62-534d9266756e"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "4e88efbd-4332-4389-9dd6-2be21c3fd3c9"]
         }],ExpressionUUID->"edabd273-9c77-4d0d-9cf0-79b426f51bbc"],
         StripOnInput->False],{
        "\"Quantum Computation: Overview\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "5dad0520-56e9-4c50-ad6f-efe3a634d916"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "dd2f3862-350f-4cc4-82f7-5ea9d34d11dd"]
         }],ExpressionUUID->"2e62148d-ca74-4018-a87d-c6a289426d55"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/tutorial/TwoQubitGates\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/tutorial/TwoQubitGates"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/\
tutorial/TwoQubitGates.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/tutorial/TwoQubitGates") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "2db285b6-af9f-41e7-a589-f61e5fbfc4cf"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "fa4492ec-b115-4a32-b60d-db471e79b3f7"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"9deb9064-470a-4b2d-b63b-68e9665b171b"],

Cell[CellGroupData[{

Cell["Two-Qubit Gates", "TechNoteTitle",
 CellID->1379112571,ExpressionUUID->"44311607-c44b-4382-9057-66a7165354fc"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Controlled-NOT Gate (CNOT)"], 
      "paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1585062394", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Controlled-Unitary Gates"], 
      "paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Controlled-Z Gate (CZ)"], 
      "paclet:QuantumMob/Q3/tutorial/TwoQubitGates#29167796", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["General Unitary Gates"], 
      "paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1476129218", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["SWAP Gate"], 
      "paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1218939314", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], ""}
  }]], "TechNoteJumpBox",ExpressionUUID->"dccd8606-d5cd-4fd3-835a-\
b368ec5a0e4a"],

Cell[TextData[{
 "This document introduces quantum logic gate operations acting on two \
qubits. Such operations are represented by 4\[Times]4 unitary matrices. We \
will see that any two-qubit gate operations can be decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268"],
 ". A ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268"],
 " acts a unitary operator on one qubit depending on the logical state of the \
other qubit. A controlled-unitary gate on two qubits can be further \
decomposed into factors including only the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1585062394"],
 " and single-qubit rotation gates. In this sense, the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1585062394"],
 " alone is sufficient for any two-qubit gate."
}], "TechNoteText",
 CellID->1465929903,ExpressionUUID->"3cf54b08-c705-4f32-b93c-f922d2a87c4e"],

Cell[TextData[{
 "The ",
 ButtonBox["controlled-unitary",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268"],
 " and ",
 ButtonBox["CNOT gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1585062394"],
 " have various interesting properties that make them useful in implementing \
quantum algorithms. In this document, we first examine the basic properties \
of the CNOT gate, and in particular, how it is used to generate an \
entanglement between two qubits. Then, we discuss the properties of the ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268"],
 " and describe how to implement a controlled-unitary gate in terms of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1585062394"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/SingleQubitGates#1113797362"],
 ". Finally, we discuss how an arbitrary two-qubit unitary operation can be \
decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268"],
 "."
}], "TechNoteText",
 CellID->1951481337,ExpressionUUID->"f2af2e41-344c-44d1-bd2c-87cb27084240"],

Cell[TextData[{
 "See also Section 2.2 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "c6dd1450-e4a2-4f2c-a0af-98c380f52209"],
 "."
}], "TechNoteText",
 CellID->1308734266,ExpressionUUID->"266407f1-63fc-4ddb-82d6-6a6d289e0ea5"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["CNOT"]], "paclet:QuantumMob/Q3/ref/CNOT", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-NOT or CNOT gate", "TechNoteTableText",ExpressionUUID->
     "6744997c-7a1c-4022-92d3-ee7604e1f88b"]},
   {
    TemplateBox[{
      Cell[
       TextData["CZ"]], "paclet:QuantumMob/Q3/ref/CZ", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-Z or CZ gate", "TechNoteTableText",ExpressionUUID->
     "d6fa5407-7861-4aa2-b528-0360880b337a"]},
   {
    TemplateBox[{
      Cell[
       TextData["SWAP"]], "paclet:QuantumMob/Q3/ref/SWAP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The SWAP gate exchanging the states between two qubits", 
     "TechNoteTableText",ExpressionUUID->
     "2db93e55-779e-42b2-8774-5d06b4dab503"]},
   {
    TemplateBox[{
      Cell[
       TextData["ControlledGate"]], "paclet:QuantumMob/Q3/ref/ControlledGate",
       "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Controlled-unitary gates", "TechNoteTableText",ExpressionUUID->
     "b5550434-f281-4521-9082-c6ee30c20ce1"]},
   {
    TemplateBox[{
      Cell[
       TextData["GivensRotation"]], "paclet:QuantumMob/Q3/ref/GivensRotation",
       "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents two-level unitary transformation", "TechNoteTableText",
     ExpressionUUID->"75ffe091-8f46-406e-8e79-1ebf058e6f05"]}
  }]], "DefinitionBox",
 CellID->407539380,ExpressionUUID->"e879472c-14ea-4028-972f-05f6e839ebee"],

Cell["Two-qubit gates available in Q3.", "TechNoteCaption",
 CellID->1189009377,ExpressionUUID->"696c7ce7-5226-4070-9f9b-a04caf2d8d52"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3: Symbolic Quantum Simulation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation:"
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"952f0792-fa6d-4b1c-af51-24e763c51f5c"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[278]:=",
 CellID->853967906,ExpressionUUID->"29bf024d-0b65-436e-bae7-5cae742a3ed7"],

Cell[CellGroupData[{

Cell["Controlled-NOT Gate (CNOT)", "TechNoteSection",
 CellTags->"Section11",
 CellID->1585062394,ExpressionUUID->"201818e8-83ff-4057-9d12-ec58bd170abf"],

Cell[TextData[{
 "The  controlled-NOT or ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:QuantumMob/Q3/ref/CNOT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "a8a64700-3e03-4c24-8f9a-612288dd2a95"],
 " gate is a quantum logic gate on two qubits that maps the logical basis \
states as"
}], "TechNoteText",
 CellID->609014923,ExpressionUUID->"7a488d6c-8fe0-42f7-80b7-32369eeee3d1"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CNOT", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        RowBox[{"c", "\[CirclePlus]", "t"}]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "c7bc756e-0b39-45b5-a508-84cf6a18e9db"]
}], "TechNoteText",
 CellID->806749259,ExpressionUUID->"676ca9b2-02fe-4489-b16d-f0eba457679d"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "6fcf7867-c1d0-40d1-a6ac-163b99999580"],
 ", where the first qubit is typically called the ",
 StyleBox["control qubit",
  FontSlant->"Italic"],
 " (c) and the second qubit the ",
 StyleBox["target qubit",
  FontSlant->"Italic"],
 " (t)."
}], "TechNoteText",
 CellID->1970532502,ExpressionUUID->"38367914-92e0-4943-9620-ab5d87b08c35"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[279]:=",
 CellID->861826122,ExpressionUUID->"bfa5bfca-3973-4137-9473-c2f239cfeb03"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CNOT", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[280]:=",
 CellID->246957080,ExpressionUUID->"8b2b2475-ada6-4332-ad8a-24057ccb8955"],

Cell[BoxData[
 RowBox[{"CNOT", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`S[2, QuantumMob`Q3`$]], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[280]=",
 CellID->1268158967,ExpressionUUID->"603d1ea8-90a4-46a5-9dea-3bdf281c84c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[281]:=",
 CellID->149239284,ExpressionUUID->"ecdb17d2-5b14-4caa-956e-2f83899896ff"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[283]//TableForm=",
 CellID->172561894,ExpressionUUID->"2f9f6079-7384-404d-8254-c04e68577312"]
}, Open  ]],

Cell["\<\
It has the following matrix representation in the logical basis\
\>", "TechNoteText",
 CellID->690265281,ExpressionUUID->"cd49cafb-b787-4c04-b794-ddd254e34bed"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mat", "]"}]}], "Input",
 CellLabel->"In[284]:=",
 CellID->581916673,ExpressionUUID->"14b5f864-8b99-43f7-9a3b-131efd8b9bec"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[285]//MatrixForm=",
 CellID->1144829008,ExpressionUUID->"db4bca16-7227-4237-97cc-b5a8f1774e07"]
}, Open  ]],

Cell["\<\
and is expressed in terms of the Pauli operators on the control and target \
qubit as\
\>", "TechNoteText",
 CellID->107481873,ExpressionUUID->"c78acd03-2f0b-48e2-9368-e08eb5619005"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "op", "]"}]], "Input",
 CellLabel->"In[286]:=",
 CellID->414092384,ExpressionUUID->"399f2e2f-bd7c-4874-9424-8b112b1bdaad"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]]}]}]], "Output",
 CellLabel->"Out[286]=",
 CellID->1835143983,ExpressionUUID->"dc983a8d-300f-436a-a59c-0a2cf9a19d56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", "op", "]"}], "//", "PauliForm"}]], "Input",
 CellLabel->"In[287]:=",
 CellID->597624604,ExpressionUUID->"4f1e6910-19b8-4ee8-a2dd-3c06c2e18d8b"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   FractionBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"],
   Rational[1, 2]], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", 
     TemplateBox[{"\"X\""},
      "RowDefault"]}],
    $CellContext`S[2, 1]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{
     TemplateBox[{"\"Z\""},
      "RowDefault"], "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[1, 3]], "2"], "-", 
  FractionBox[
   InterpretationBox[
    RowBox[{
     TemplateBox[{"\"Z\""},
      "RowDefault"], "\[CircleTimes]", 
     TemplateBox[{"\"X\""},
      "RowDefault"]}],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]], "2"]}]], "Output",
 CellLabel->"Out[287]=",
 CellID->1104784067,ExpressionUUID->"1ee01e3a-d7b9-43f1-ba5e-297ca3f4ac49"]
}, Open  ]],

Cell["\<\
In quantum circuit model, it is represented as the following circuit element\
\>", "TechNoteText",
 CellID->1181321350,ExpressionUUID->"bd2d625f-2855-4f92-b0b0-daae3470f9c8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[288]:=",
 CellID->981612935,ExpressionUUID->"29c0ab2b-9221-4b58-8009-9540ba01fbc2"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[288]=",
 CellID->962202107,ExpressionUUID->"b9c9cbc3-c3b3-4169-ab4e-cca19c3b3584"]
}, Open  ]],

Cell["\<\
where the smaller filled circle indicates the dependence on the state of the \
control qubit and the circled-plus sign denotes the conditional NOT action on \
the target qubit.\
\>", "TechNoteText",
 CellID->606925297,ExpressionUUID->"5be56b4e-37ab-40fa-938a-61dbf2e5528b"],

Cell[TextData[{
 "A simple yet important feature of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:QuantumMob/Q3/ref/CNOT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "9128182c-4457-40e1-84d3-7f68ff94419e"],
 " is to copy the logical state of the control qubit to the target bit \
provided that the target bit is initially set to |0\:27e9; or the reversed \
state when the target qubit is in |1\:27e9. A vital implication is that CNOT \
generates an entangled state when the control qubit is in a superposition:"
}], "TechNoteText",
 CellID->46143429,ExpressionUUID->"2b5ea56e-b744-4536-86c2-7e43a7de8ce7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", "]"}], 
      RowBox[{"c", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "->", "1"}], "]"}], 
      RowBox[{"c", "[", "1", "]"}]}]}], "//", "KetRegulate"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "->", "out"}], "//", "KetFactor"}]}], "Input",
 CellLabel->"In[289]:=",
 CellID->291014636,ExpressionUUID->"e46eb775-b112-4de5-9356-b10be02e106a"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`c[0]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["0", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`c[1]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}],
    HoldForm],
   QuantumMob`Q3`OTimes[$CellContext`c[0] 
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>] + $CellContext`c[1] 
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]], "\[Rule]", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "0"},
       "RowWithSeparators"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}]}]], "Output",
 CellLabel->"Out[291]=",
 CellID->1178950439,ExpressionUUID->"14607b55-e19e-4b64-832e-0796a54182b6"]
}, Open  ]],

Cell[TextData[{
 "Applying a single qubit rotation such the Hadamard gate on the control \
qubit prior to CNOT, one can thus generate entangled states from logical \
states. In this sense, such a circuit is called a ",
 StyleBox["quantum entangler circuit",
  FontSlant->"Italic"],
 ".  In general, the different product states in the logical basis are \
transformed to different ",
 StyleBox[ButtonBox["Bell states",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/BellState"],
  FontSlant->"Italic"],
 "."
}], "TechNoteText",
 CellID->1152615977,ExpressionUUID->"4e7e106d-7cc0-44b4-9b62-51e33eb1c426"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "op"}], "]"}]}]], "Input",
 CellLabel->"In[292]:=",
 CellID->1714229499,ExpressionUUID->"7b33a6df-0190-4731-9f82-0ffe6bc30832"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->154.79999999999998`,
   PlotRange->{{0, 3}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[292]=",
 CellID->1935901051,ExpressionUUID->"bdc3c0ab-b415-4809-8dcb-6ba1060d85d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[293]:=",
 CellID->1435008719,ExpressionUUID->"9e37efb4-f54e-4e9f-ad39-25d7ac3e57f6"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], 
         SqrtBox["2"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[295]//TableForm=",
 CellID->164228460,ExpressionUUID->"919e7c3f-6257-4574-a5cb-975708b65a5f"]
}, Open  ]],

Cell[TextData[{
 "One can further generalize the above procedure to generate maximally \
entangled states between larger systems: Consider two quantum registers, each \
consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "e372922f-848a-4971-a7fe-8dae2bcfcc33"],
 " qubits. We respectively call them the \[OpenCurlyQuote]control\
\[CloseCurlyQuote] and \[OpenCurlyQuote]target\[CloseCurlyQuote] register for \
the reason that will be clear below. Upon applying the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:QuantumMob/Q3/ref/CNOT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e6dfc8b5-63b9-4fa8-92bc-dc9c6496bbb4"],
 " gate on each pair of the corresponding qubits in the two registers as in \
the quantum circuit,"
}], "TechNoteText",
 CellID->1854176847,ExpressionUUID->"f33602ad-6980-4531-b3bc-b28a0eb8ddeb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"$n", "+", "1"}], ",", 
     RowBox[{"2", "$n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"MapThread", "[", 
      RowBox[{"CNOT", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"S", "@", "cc"}], ",", 
         RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[296]:=",
 CellID->1015065912,ExpressionUUID->"856f9dfe-2fce-476e-98c7-3974342ae90f"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}, {{0, -6}, {4, -6}}, {{0, -7}, {4, -7}}}], {
     LineBox[{{1, -1}, {1, -5}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, {
     LineBox[{{2, -2}, {2, -6}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -3}, {3, -7}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-7.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[4, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[5, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[6, QuantumMob`Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[299]=",
 CellID->671240825,ExpressionUUID->"00c812d4-75ef-47d3-9df3-4b05ad7477a5"]
}, Open  ]],

Cell["the logical basis states are transformed as", "TechNoteText",
 CellID->1898388060,ExpressionUUID->"fbbb7ff4-0ba2-4a90-8966-33095cd07874"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       RowBox[{"c", "\[CirclePlus]", "t"}]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "e4624335-bc9f-47bb-9eab-d7c59fd09ea5"],
 " ."
}], "TechNoteText",
 CellID->1043580941,ExpressionUUID->"5c7e2d4e-fdc8-46bb-8b73-618fe769133f"],

Cell[TextData[{
 "The above association rule is formally the same as the one in (2.29) for a \
single pair of qubits. Here, however, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"c"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["c", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "d515b590-447d-45d3-af08-aa6046d0f64e"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"t"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["t", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "a4d3943b-b034-4c9f-ad61-004143414e77"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[CirclePlus]", " ", "t"}], TraditionalForm]],
  ExpressionUUID->"4b57a215-0686-4545-993e-91fb349d9217"],
 " denotes the bit-wise exclusive OR (or XOR),"
}], "TechNoteText",
 CellID->965930338,ExpressionUUID->"16c8e6d9-9c72-4024-ae0f-b5710d96f837"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", "\[CirclePlus]", "t"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["t", "1"]}], ",", 
      RowBox[{
       SubscriptBox["c", "2"], "\[CirclePlus]", 
       SubscriptBox["t", "2"]}], ",", "\[Ellipsis]", ",", 
      RowBox[{
       SubscriptBox["c", "n"], "\[CirclePlus]", 
       SubscriptBox["t", "n"]}]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "7bfecb9a-5798-4c68-ae4f-062ff595ed55"],
 " ,"
}], "TechNoteText",
 CellID->1562303093,ExpressionUUID->"298b4c2d-b221-473f-af53-a7e920e89ddc"],

Cell[TextData[{
 "for the n-bit strings ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["c", "1"], ",", 
      SubscriptBox["c", "2"], ",", "...", ",", 
      SubscriptBox["c", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "2f883156-fe2b-40f4-90a9-098c35135f5c"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["t", "1"], ",", 
      SubscriptBox["t", "2"], ",", "...", ",", 
      SubscriptBox["t", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "2235e422-b950-401f-9625-29656c26d4b0"],
 ". When the target register is prepared in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "80dc95d2-87a0-4976-b169-0cba43241b24"],
 ", the logical basis state of the control register is copied to the target \
register,"
}], "TechNoteText",
 CellID->345532182,ExpressionUUID->"057301b5-b268-4215-a283-f49107385f65"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "1a9a61b6-d37c-4201-b05a-55248d61cc16"]
}], "TechNoteText",
 CellID->563601386,ExpressionUUID->"0f42e6df-cc40-4147-a9b9-1965033c7ffc"],

Cell[TextData[{
 "under the set of CNOT gates on paired qubits. More interestingly, when the \
control register is prepared in a superposition, say, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "623c8cab-6146-4e8b-90fb-aa8f30484ffa"],
 ", and the target register x=0 is in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "3f337cb8-d58f-4853-8e40-3d98e896d3f4"],
 ", the CNOT gate makes a copy of each logical state of the control register \
to the target register, leading to a maximally entangled state,"
}], "TechNoteText",
 CellID->2045611232,ExpressionUUID->"a0bf3808-a9e0-4fd4-8a98-f61023572a12"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["2", 
          RowBox[{"n", "/", "2"}]]], 
        RowBox[{
         SubsuperscriptBox["\[Sum]", 
          RowBox[{"x", "=", "0"}], 
          RowBox[{
           SuperscriptBox["2", "n"], "-", "1"}]], 
         TemplateBox[{"x"},
          "Ket"]}]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"0"},
       "Ket"]}], "\[RightTeeArrow]", 
     TemplateBox[{"\[CapitalPhi]"},
      "Ket"]}], ":=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "5e9aea70-2030-454d-aa15-52f87c8e0f62"]
}], "TechNoteText",
 CellID->1522271401,ExpressionUUID->"4bcac4ce-d9cf-49c9-9ed6-7b3246444362"],

Cell[TextData[{
 "between the two registers (rather than single qubits). Since the \
superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "ad4b44c6-fa9d-4add-a2f0-286bae0a7c3b"],
 " is obtained just by the ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/Hadamard"],
 ", the maximally entangled state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[CapitalPhi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "915697c7-1e3f-4ca2-80e5-a73a14dacff6"],
 " can be generated from the logical state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "dba04ea6-9f13-4f5f-8d4b-5434faba108e"],
 " through the following quantum circuit."
}], "TechNoteText",
 CellID->1842749896,ExpressionUUID->"07954a3e-5712-4e37-86d4-3530c34888c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qce", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", "qc"}], "]"}]}]], "Input",
 CellLabel->"In[300]:=",
 CellID->88345038,ExpressionUUID->"3352681a-282c-4f62-beaa-889bfbfc806b"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
     0, -5}, {5, -5}}, {{0, -6}, {5, -6}}, {{0, -7}, {5, -7}}}], {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -3.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -5}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -5}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
         2, -5.266666666666667}, {2, -4.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -6}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
         3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -7}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
         4, -7.266666666666667}, {4, -6.733333333333333}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->226.79999999999998`,
   PlotRange->{{0, 5}, {-7.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[4, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[5, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[6, QuantumMob`Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[300]=",
 CellID->812948084,ExpressionUUID->"9e62e056-5edf-40ea-82a0-d1be9d7b9c71"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qce", "**", 
    RowBox[{"Ket", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SimpleForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "@", "cc"}], ",", 
     RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[301]:=",
 CellID->1915435092,ExpressionUUID->"ec26f09f-6016-46f8-a4bd-3b75951f1395"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`S[4, QuantumMob`Q3`$] -> 
      0, $CellContext`S[5, QuantumMob`Q3`$] -> 
      0, $CellContext`S[6, QuantumMob`Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      1, $CellContext`S[4, QuantumMob`Q3`$] -> 
      0, $CellContext`S[5, QuantumMob`Q3`$] -> 
      0, $CellContext`S[6, QuantumMob`Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`S[4, QuantumMob`Q3`$] -> 
      0, $CellContext`S[5, QuantumMob`Q3`$] -> 
      1, $CellContext`S[6, QuantumMob`Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 
      1, $CellContext`S[4, QuantumMob`Q3`$] -> 
      0, $CellContext`S[5, QuantumMob`Q3`$] -> 
      1, $CellContext`S[6, QuantumMob`Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`S[4, QuantumMob`Q3`$] -> 
      1, $CellContext`S[5, QuantumMob`Q3`$] -> 
      0, $CellContext`S[6, QuantumMob`Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      1, $CellContext`S[4, QuantumMob`Q3`$] -> 
      1, $CellContext`S[5, QuantumMob`Q3`$] -> 
      0, $CellContext`S[6, QuantumMob`Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`S[4, QuantumMob`Q3`$] -> 
      1, $CellContext`S[5, QuantumMob`Q3`$] -> 
      1, $CellContext`S[6, QuantumMob`Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 
      1, $CellContext`S[4, QuantumMob`Q3`$] -> 
      1, $CellContext`S[5, QuantumMob`Q3`$] -> 
      1, $CellContext`S[6, QuantumMob`Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[302]=",
 CellID->927485574,ExpressionUUID->"1815e982-15fd-48f1-81e2-0e21d6abe683"]
}, Open  ]],

Cell["\<\
It is also interesting to note that even though |\[CapitalPhi]\:27e9 is a \
maximally entangled state between the control and target registers, it is a \
product state of n maximally entangled pairs\
\>", "TechNoteText",
 CellID->716147443,ExpressionUUID->"db19d742-0848-45cc-a5e7-1538a6110818"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}], "=", 
    RowBox[{
     SubsuperscriptBox["\[CircleTimes]", 
      RowBox[{"k", "=", "1"}], "n"], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}]}], 
       SqrtBox["2"]], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "48f15fa6-0d8a-42d0-bbb0-12f912b148c3"],
 " ."
}], "TechNoteText",
 CellID->1791716713,ExpressionUUID->"f66674b2-ec20-41a2-a0e3-89fa52024498"],

Cell["\<\
The entanglement strongly depends on how you partition the system.\
\>", "TechNoteText",
 CellID->1367097157,ExpressionUUID->"ca5d04e8-3c24-4359-9dbe-a4f2abbe4b83"],

Cell["\<\
Another generalization of copying logical basis states to a series of qubits \
by consecutively applying CNOT gates with a single control qubit on multiple \
target qubits is shown in the following quantum circuit,\
\>", "TechNoteText",
 CellID->874378446,ExpressionUUID->"fc97e9ac-bddc-4e1d-bda6-f0fc4159a83c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"Distribute", "[", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "]"}], ",", "List"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[303]:=",
 CellID->447945501,ExpressionUUID->"b975ba42-853e-43fe-8f1f-80f07a32aed9"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -4}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[307]=",
 CellID->1813732292,ExpressionUUID->"98a2a273-1324-4ef8-a6df-ac5a261be21a"]
}, Open  ]],

Cell["or equivalently,", "TechNoteText",
 CellID->880946029,ExpressionUUID->"76e52d19-3329-47b0-b355-dcad76b53056"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"$n", "-", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"CNOT", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[308]:=",
 CellID->1307646985,ExpressionUUID->"94d9170e-8b29-437e-8fa3-2bcce2cd44ea"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[311]=",
 CellID->2015746126,ExpressionUUID->"50886f84-f784-4a6b-9a76-6d99a6c1bbca"]
}, Open  ]],

Cell["\<\
When the target qubits are all prepared in the logical basis state |0\:27e9, \
the series of CNOT gates makes the transformation\
\>", "TechNoteText",
 CellID->169608441,ExpressionUUID->"4855d8e7-5a8c-4d9d-af29-96946b1bc773"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "beccf2c4-2247-4c33-96df-3e220c7d5028"]
}], "TechNoteText",
 CellID->898268318,ExpressionUUID->"1dc34e28-5c24-44b9-bb98-8e9be6df6746"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", "=", "0"}], ",", "1"}], TraditionalForm]],ExpressionUUID->
  "7f790fd0-f5d5-4222-8e57-72645c6cbdd9"],
 ". Therefore, a simple application of the Hadamard gate in the control qubit \
before the CNOT gates, "
}], "TechNoteText",
 CellID->385582216,ExpressionUUID->"00aed608-116f-43f7-945c-94adef8a4f07"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
      0, -4}, {5, -4}}}], {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, 0.5}]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, 0.5}]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, 0.5}]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, 0.5}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, ImageScaled[{0.5, 0.5}]]}, {
      LineBox[{{2, -1}, {2, -2}}], 
      DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
       LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
          2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
      LineBox[{{3, -1}, {3, -3}}], 
      DiskBox[{3, -1}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
       LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
          3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}, {
      LineBox[{{4, -1}, {4, -4}}], 
      DiskBox[{4, -1}, 0.09], {CircleBox[{4, -4}, 0.26666666666666666], 
       LineBox[{{{3.7333333333333334`, -4}, {4.266666666666667, -4}}, {{
          4, -4.266666666666667}, {4, -3.7333333333333334`}}}]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->226.79999999999998`,
    PlotRangePadding->Scaled[0.025]], ","}]}]], "TechNoteText",
 CellID->1620101282,ExpressionUUID->"90c866c1-8925-4533-af23-e20ecfec794f"],

Cell["can generate a state of the form", "TechNoteText",
 CellID->712578174,ExpressionUUID->"882a63f2-400c-4f52-a2db-4d9d15ca2c0a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"GHZ"},
     "Ket"], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"]}]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "94c38aaa-88af-4581-8f57-87db0ab4674d"],
 " ."
}], "TechNoteText",
 CellID->1522141313,ExpressionUUID->"5b3668e4-9ff6-4f14-bf9e-13a1d5d067af"],

Cell["\<\
The above state, which is known as the Greenberger-Horne-Zeilinger (GHZ) \
state (Greenberger et al., 1989), exhibits a quantum entanglement of more \
than two particles. It has stimulated tests of non-locality of quantum \
mechanics beyond Bell inequalities (Bouwmeester et al., 1999; Pan et al., \
2000).\
\>", "TechNoteText",
 CellID->1803844527,ExpressionUUID->"b4da5cde-f9d5-42d9-a215-6a7e55c3c704"],

Cell[TextData[{
 "Quantum entanglement is a valuable resource in quantum information \
processing and in quantum communication. The most popular example of such is ",
 ButtonBox["quantum teleportation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/QuantumTeleportation"],
 "."
}], "TechNoteText",
 CellID->1188320590,ExpressionUUID->"70f17a1e-4652-4179-ac0f-978f0971a16f"],

Cell["\<\
In the above consideration, CNOT gates with the same control qubit are \
applied on different target qubits. The opposite setting brings forth \
additional applications of CNOT as illustrated in the following quantum \
circuit.\
\>", "TechNoteText",
 CellID->506239030,ExpressionUUID->"65e002e4-3f9d-4fdf-85b7-af4eed401371"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, 0.5}]]}, {
     LineBox[{{1, -1}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
         1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
         2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, InsetBox[
     StyleBox[
      TemplateBox[{
        RowBox[{
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, 0.5}]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->1226753413,ExpressionUUID->"daa55a50-ce87-49cd-8223-ccb09088bfe6"],

Cell["\<\
 In this quantum circuit, the successive application of the CNOT gates on the \
same target qubit with different control qubits results in the accumulation \
of the logical bit values of all qubits. The same goal may be achieved by \
applying the CNOT gates on the consecutive pairs of qubits as\
\>", "TechNoteText",
 CellID->365203462,ExpressionUUID->"d808a335-037c-4809-a16b-7ba1c659651b"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, 0.5}]]}, {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -1}, ImageScaled[{0, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -2}, ImageScaled[{0, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -3}, ImageScaled[{0, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->977674470,ExpressionUUID->"082b3b69-a3bc-4c4d-9a49-eef39fedbe44"],

Cell[TextData[{
 "In this case, not only the last qubit but also the qubits in the middle are \
modified. However, this makes little difference since the quantum circuit \
block is mostly used to conditionally control the operation of an unitary \
gate on a different qubit and the whole block must be undone anyway (see, for \
example, the ",
 ButtonBox["quantum circuit of conditional unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1379525988"],
 ")."
}], "TechNoteText",
 CellID->833871357,ExpressionUUID->"a616f49d-6c4b-4f58-96ee-06b454353457"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Z Gate (CZ)", "TechNoteSection",
 CellTags->"Section12",
 CellID->29167796,ExpressionUUID->"b80279f3-54b1-45e4-baa2-22a100383ef9"],

Cell["\<\
An interesting variant of CNOT gates is the so-called controlled-Z or CZ \
gate. This is a quantum logic gate on two qubits that maps the logical basis \
states as\
\>", "TechNoteText",
 CellID->596875856,ExpressionUUID->"5a0d3cbf-db97-4077-bc47-de54f809924b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CZ", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      SuperscriptBox[
       RowBox[{
        TemplateBox[{"t"},
         "Ket"], "(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"c", " ", "t"}]]}]}]}], TraditionalForm]],ExpressionUUID->
  "d4adc8e1-f8e8-4e3b-b61e-3e395275ac3f"]
}], "TechNoteText",
 CellID->796396655,ExpressionUUID->"1cbe9b43-0303-4099-9a04-6b9bdf65158d"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "f5abd38d-bc84-429f-9c67-bfc017626466"],
 "."
}], "TechNoteText",
 CellID->1920492481,ExpressionUUID->"76f49f1c-cd80-4575-a809-d8c18ed2d383"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[312]:=",
 CellID->754200946,ExpressionUUID->"9ccd3b55-5b89-429b-a953-5a0510565566"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[313]:=",
 CellID->1406814828,ExpressionUUID->"2438ad00-4ba9-4a7a-902f-60be6a28bdbf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[314]:=",
 CellID->1037913757,ExpressionUUID->"fa97d88a-b46c-4073-be5e-ac30d982b761"],

Cell[BoxData[
 RowBox[{"CZ", "[", 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`S[1, QuantumMob`Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], "]"}]], "Output",
 CellLabel->"Out[314]=",
 CellID->2090608257,ExpressionUUID->"4bbca41d-5710-4f3b-b45b-5fbdfd946750"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[315]:=",
 CellID->1887946780,ExpressionUUID->"701f91d2-30b2-4deb-a397-8570fa7a4ca6"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{"-", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
             
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                 $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[317]//TableForm=",
 CellID->1873026832,ExpressionUUID->"0bbbb211-98be-449a-891e-51a657dbf030"]
}, Open  ]],

Cell["\<\
The matrix representation of the CZ gate in the logical basis is given by\
\>", "TechNoteText",
 CellID->1230965299,ExpressionUUID->"1903632e-f1bb-43a1-abdb-bd0efda2b87f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[318]:=",
 CellID->2123808742,ExpressionUUID->"afcc2329-947d-4e9a-ac3c-5c2ca8becc2f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, -1}}]]]]], "Output",\

 CellLabel->"Out[318]//MatrixForm=",
 CellID->2146667698,ExpressionUUID->"2aa203bd-8eda-4869-a8a7-ee1b61480c94"]
}, Open  ]],

Cell["\<\
Since it is symmetric for the two qubits, a distinction of the control and \
target qubit is meaningless. Accordingly, in quantum circuit model, the gate \
is depicted by the following quantum circuit element\
\>", "TechNoteText",
 CellID->776960470,ExpressionUUID->"ca3c5e20-f0b2-4fc3-a1ca-a1fe158fc943"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "op", "]"}]], "Input",
 CellLabel->"In[319]:=",
 CellID->1674045530,ExpressionUUID->"9e40ce2d-aab1-4ff0-84b3-2a638314960c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CZ[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[319]=",
 CellID->1318730686,ExpressionUUID->"01bd0cfd-eeca-4524-8d4d-9c7a6c498b15"]
}, Open  ]],

Cell["\<\
The filled circles on both qubit lines (rather than a square box on either \
qubit) indicate that the bit values of both qubits remain unchanged.\
\>", "TechNoteText",
 CellID->573709808,ExpressionUUID->"3db4828c-30c8-4ac6-9222-99f7384acac8"],

Cell[TextData[{
 "Noting the identity ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", " ", "Z", " ", "H"}], "=", "X"}], TraditionalForm]],
  ExpressionUUID->"d3f3ed41-c49a-4d78-9b0a-b15949e87b62"],
 ", one can regard that the CZ gate is equal to the CNOT gate up to the \
Hadamard gate on the target qubit. The relation between the CNOT and CZ gate \
is illustrated in the following quantum circuits"
}], "TechNoteText",
 CellID->139168026,ExpressionUUID->"ec0119fe-f187-45cc-a189-f2edbb753e4d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}]}], "]"}]}]}], "Input",\

 CellLabel->"In[320]:=",
 CellID->387321399,ExpressionUUID->"df450589-9017-4874-b4f5-009850c458a8"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[320]=",
 CellID->1875402562,ExpressionUUID->"93dcaf67-d542-4db2-a6a6-6919929ab699"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[2, 6], 
   QuantumMob`Q3`CZ[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   $CellContext`S[2, 6]]]], "Output",
 CellLabel->"Out[321]=",
 CellID->1273372515,ExpressionUUID->"8f488823-6418-4dfa-be76-6be15e6d91f0"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}]]], "Output",
 CellLabel->"Out[322]=",
 CellID->1897317250,ExpressionUUID->"ba42b5ca-cd00-4c2c-b1e6-e06f7b54f7d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cnot", "==", "cz1", "==", "cz2"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[323]:=",
 CellID->1606586072,ExpressionUUID->"060ceb89-ce90-4339-b3d6-225b3fa553ba"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[323]=",
 CellID->226346447,ExpressionUUID->"e3448c47-a563-4b66-8eff-cbf8c262bbb1"]
}, Open  ]],

Cell["\<\
Depending on the Hamiltonian of a particular physical system, direct \
realization of the CNOT gate may be considerably difficult while the CZ gate \
is relatively easier to implement. In such a case, the above identity offers \
a straightforward workaround for a physical implementation of the CNOT gate.\
\>", "TechNoteText",
 CellID->799932562,ExpressionUUID->"c2e15cbd-c9b6-4f97-b3f8-bf9d0129594a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SWAP Gate", "TechNoteSection",
 CellTags->"Section13",
 CellID->1218939314,ExpressionUUID->"e7ecdaea-2089-4845-9b9a-fbbc412cd62d"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[324]:=",
 CellID->1843914595,ExpressionUUID->"46cf70a9-8ec0-4b19-9b14-a3d83e9e8aa9"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[325]:=",
 CellID->336088308,ExpressionUUID->"55171845-bd8c-4269-9082-869c7a0145d6"],

Cell[TextData[{
 "Another interesting two-qubit gate is the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["SWAP"]], "paclet:QuantumMob/Q3/ref/SWAP", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7bb465ff-2e51-43be-ad3a-57f6aaf37acc"],
 " gate that \[OpenCurlyQuote]swaps\[CloseCurlyQuote] the states of the two \
qubits and maps the logical basis states as"
}], "TechNoteText",
 CellID->1866541665,ExpressionUUID->"61705282-ab2d-46f6-9e0b-82203cddfce8"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"SWAP", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "3680c46b-a9ad-455c-bae3-91719c119fab"]
}], "TechNoteText",
 CellID->524648279,ExpressionUUID->"42f35a37-0469-434e-b5b5-0477f3ab2500"],

Cell[BoxData[
 RowBox[{"for", " ", 
  RowBox[{Cell[TextData[Cell[BoxData[
    FormBox[
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      RowBox[{
       SubscriptBox["x", "2"], "\[Element]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
    "db58ab71-c4c0-4e34-97fa-1860e5820b3e"]],ExpressionUUID->
    "2bd43c5d-56c9-4620-8cb5-5889b0dc656a"], "."}]}]], "TechNoteText",
 CellID->195770571,ExpressionUUID->"b9cddf77-b976-4e89-82c6-f406153f3f46"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[326]:=",
 CellID->371039593,ExpressionUUID->"455bd4cf-4d88-40cf-8b74-5f29ae73f288"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[329]//TableForm=",
 CellID->1011195892,ExpressionUUID->"99a03bc9-cd61-49a3-ac6a-4ad63dc565a9"]
}, Open  ]],

Cell[TextData[{
 "Given that the states ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "3f117af4-7cf2-4ba8-b276-13c8eaae08bb"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"1"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "2a3d04b8-189b-4b1b-85e3-b4179f5c61ac"],
 " are not altered by the operation, the\nmatrix representation is given by"
}], "TechNoteText",
 CellID->809087288,ExpressionUUID->"6053e80e-7dbe-44cd-8901-9e869b3e9278"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[330]:=",
 CellID->463596612,ExpressionUUID->"126b6c62-4087-4cbd-8077-31c75d1da045"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 0,
       1, 0, 1, 1, 0}}]]]]], "Output",
 CellLabel->"Out[330]//MatrixForm=",
 CellID->2131258133,ExpressionUUID->"8d7d1be0-13d3-4f1b-bb50-2e714f83a19d"]
}, Open  ]],

Cell["In quantum circuit model, it is depicted as", "TechNoteText",
 CellID->2003915004,ExpressionUUID->"b1d20def-6c50-485c-9aa8-d9840ae7f7f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[331]:=",
 CellID->813436327,ExpressionUUID->"c66b9aaf-b659-4078-a3cd-70bbc19fafe8"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.8200000000000001, -1.18}, {1.18, -0.8200000000000001}}, {{
      0.8200000000000001, -0.8200000000000001}, {1.18, -1.18}}}], 
     LineBox[{{{0.8200000000000001, -2.18}, {1.18, -1.82}}, {{
      0.8200000000000001, -1.82}, {1.18, -2.18}}}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`SWAP[
    $CellContext`S[1, QuantumMob`Q3`$], 
    $CellContext`S[2, QuantumMob`Q3`$]]]]], "Output",
 CellLabel->"Out[331]=",
 CellID->28209371,ExpressionUUID->"11189dcf-d528-4ee4-a010-bf83e2c03bac"]
}, Open  ]],

Cell[TextData[{
 "The SWAP gate can be implemented using the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/CNOT"],
 ". To see this, first note that a simultaneous exchange of the second and \
fourth columns and rows of the above matrix leads to"
}], "TechNoteText",
 CellID->534468518,ExpressionUUID->"cfc6d714-409b-4ae9-ba0a-62f624bea04e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[332]:=",
 CellID->2035770272,ExpressionUUID->"e95bb36d-aa47-4949-844e-4c92e7b64a05"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[332]//MatrixForm=",
 CellID->1668496057,ExpressionUUID->"b9a012de-f03f-4043-a31f-d57399161e42"]
}, Open  ]],

Cell[TextData[{
 "which is nothing other than the matrix representation of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/CNOT"],
 ". On the other hand, the exchange of the second and fourth columns and rows \
is equivalent to flipping the bit values of the first qubit only when the \
second qubit is set to |1\:27e9. Hence, it corresponds to the CNOT gate with \
the second and first qubit as the control and target qubit, respectively. In \
short, the ",
 ButtonBox["SWAP gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/SWAP"],
 " can be achieved by a combination of the CNOT gates as follows"
}], "TechNoteText",
 CellID->1603079182,ExpressionUUID->"b210e0f5-d8ac-4f72-891d-f2ff818455e1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"swap", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[333]:=",
 CellID->621976612,ExpressionUUID->"00aa3743-c94f-4169-81ec-5bcaaf435812"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.8200000000000001, -1.18}, {1.18, -0.8200000000000001}}, {{
      0.8200000000000001, -0.8200000000000001}, {1.18, -1.18}}}], 
     LineBox[{{{0.8200000000000001, -2.18}, {1.18, -1.82}}, {{
      0.8200000000000001, -1.82}, {1.18, -2.18}}}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`SWAP[
    $CellContext`S[1, QuantumMob`Q3`$], 
    $CellContext`S[2, QuantumMob`Q3`$]]]]], "Output",
 CellLabel->"Out[333]=",
 CellID->571767473,ExpressionUUID->"4f78d93d-ebef-420a-8a7e-d3964f3d4941"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[334]=",
 CellID->1854082033,ExpressionUUID->"edcb0a2e-a45e-4a20-8b78-2df53121f9e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"swap", "==", "cnot"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[335]:=",
 CellID->661500490,ExpressionUUID->"a65a4b56-0ac8-4cb5-b8c8-40a0d5ebc600"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[335]=",
 CellID->1569010661,ExpressionUUID->"f4cbc7a0-55f5-49d9-b7f0-e2a9b196260f"]
}, Open  ]],

Cell[TextData[{
 "Interestingly, the SWAP gate itself is not universal, but the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "9baff10e-c335-41f6-94b7-fef0252edfab"],
 " gate\[LongDash]the gate that equals SWAP when squared\[LongDash]is \
universal. That is, any quantum gate on a multi-qubit system can be \
implemented by combining ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "21a9da17-12c7-4e98-b40e-35f829732119"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/SingleQubitGates"],
 ". Indeed, one can combine the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "696b406a-eccc-49b8-9dc6-f70742fd10c9"],
 " gate with single-qubit rotations to construct the CZ gate (see the \
demonstration below). As discussed above, the CZ gate requires just two more ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/SingleQubitGates#347838345"],
 " to implement the CNOT gate, and it is hence universal."
}], "TechNoteText",
 CellID->666193793,ExpressionUUID->"f1ae24c1-b180-413a-b3f0-83b6c49ebf5a"],

Cell[TextData[{
 "Let us construct the CZ gate with the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "c90fce09-ce58-4614-9b1e-c7ff80a574b2"],
 "gate. Here is the matrix representation of the the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "93626b24-0147-4900-9e80-1c01bd047b1a"],
 "gate."
}], "TechNoteText",
 CellID->1938247085,ExpressionUUID->"094acab2-3846-4e97-aa52-866e8321f39b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"Matrix", "@", 
      RowBox[{"Elaborate", "@", 
       RowBox[{"SWAP", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "2", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[336]:=",
 CellID->1040933486,ExpressionUUID->"b2314c77-9ba3-4e8b-a24d-02aabac758dc"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[337]//MatrixForm=",
 CellID->1410477914,ExpressionUUID->"48ad963b-8b37-4d3f-961b-2ec4d710aedc"]
}, Open  ]],

Cell[TextData[{
 "This is an explicit operator expression of the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "c2c03427-8541-49e8-9ec5-3e807d7a7b08"],
 "gate in terms of the Pauli operators."
}], "TechNoteText",
 CellID->771058470,ExpressionUUID->"f7fb8d2f-d20f-486f-b0ec-4fed8e8ae2bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sqrtSWAP", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Elaborate", "@", 
     RowBox[{"ExpressionFor", "[", 
      RowBox[{"mat", ",", 
       RowBox[{"S", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<\!\(\*SqrtBox[\(U\)]\)\>\""}]}], 
   "}"}]}]], "Input",
 CellLabel->"In[338]:=",
 CellID->1895203240,ExpressionUUID->"f593fefa-4def-49e6-8537-b3101a177981"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 1]], 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 1]]}, "RowWithSeparators"]},
       "RowDefault"],
      QuantumMob`Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 2]], 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 2]]}, "RowWithSeparators"]},
       "RowDefault"],
      QuantumMob`Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 3]], 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 3]]}, "RowWithSeparators"]},
       "RowDefault"],
      QuantumMob`Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]]]}]}], ",", 
   RowBox[{"\<\"Label\"\>", 
    "\[Rule]", "\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>"}]}], "}"}]], "Output",
 CellLabel->"Out[338]=",
 CellID->1977805012,ExpressionUUID->"8b1e3e03-6582-407a-96d2-f6e98e6a4eb5"]
}, Open  ]],

Cell[TextData[{
 "This is a quantum circuit model to construct the CZ gate from the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "453ebfae-7b87-45e1-9734-37fb5371f1da"],
 " gate and single-qubit rotation gates. In this diagram, ",
 Cell[BoxData[
  FormBox[
   SqrtBox["U"], TraditionalForm]],ExpressionUUID->
  "21ae2278-772b-435e-a557-33beb35cd339"],
 " denotes the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "3c80a1e5-03fb-4068-a284-d98d6c9d0a7e"],
 "gate and ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "687fbf3c-9392-47ae-a821-72ee9bc72d1f"],
 " the quadrant phase gate (or, equivalently, the rotation around the z-axis \
by angle \[Pi]/2)."
}], "TechNoteText",
 CellID->27233292,ExpressionUUID->"d76b44f2-3965-439f-a911-bb18d10fd59b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"sqrtSWAP", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "sqrtSWAP", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "7"}], "]"}], ",", 
      RowBox[{"Dagger", "@", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "7"}], "]"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[339]:=",
 CellID->1505230369,ExpressionUUID->"73f05abb-31b9-4572-a38e-2e97dec77b7a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
       StyleBox["\<\"S\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"S\"", "\"\[Dagger]\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->226.79999999999998`,
   PlotRange->{{0, 5}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, 
   $CellContext`S[1, 3], {Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, {
    $CellContext`S[1, 7], 
    $CellContext`S[2, -7]}]]], "Output",
 CellLabel->"Out[339]=",
 CellID->69464771,ExpressionUUID->"4e1bd2a0-5e1f-42f9-b1f6-f4c2e267df69"]
}, Open  ]],

Cell["\<\
To check if it indeed implements the CZ gate, take a look at the matrix \
representation of the quantum circuit model.\
\>", "TechNoteText",
 CellID->535686806,ExpressionUUID->"532487e8-395b-4a41-a554-49da4ff26789"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "qc", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[340]:=",
 CellID->851721286,ExpressionUUID->"44cf5b60-1adc-4655-9026-d7a344585d71"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 1,
       0, 1, 0, -1, 0}}]]]]], "Output",
 CellLabel->"Out[340]//MatrixForm=",
 CellID->1410785876,ExpressionUUID->"fe415f9b-bce0-421f-b11e-3a10f3b41691"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Unitary Gates", "TechNoteSection",
 CellTags->"Section14",
 CellID->1455445268,ExpressionUUID->"b6d8aacc-df24-42df-9403-1d9e2ad0efdf"],

Cell[CellGroupData[{

Cell["Definition", "Subsection",
 CellTags->"Section15",
 CellID->1829879946,ExpressionUUID->"3fad6138-e0f1-4fea-b6e1-6173aa86077c"],

Cell[TextData[{
 "Consider two qubits that are once again called control and target qubits. \
Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "9c3479fd-70eb-428a-b749-15fe7043b4cd"],
 " be a unitary operator on the target qubit. The controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "2e519594-0a7a-46c8-af32-5d2915085898"],
 " gate is a unitary operator on the two-qubit Hilbert space defined, \
analogously to CNOT, by"
}], "TechNoteText",
 CellID->678943735,ExpressionUUID->"02ee0171-6de3-4c0b-82b6-540ca27e07ff"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["U", "c"], 
        TemplateBox[{"t"},
         "Ket"]}], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "49d79127-fce0-4d52-b86a-4b55e3ab1589"],
 "."
}], "TechNoteText",
 CellID->1426737634,ExpressionUUID->"3aea296a-364e-4b36-aa5f-6b4ceb679fba"],

Cell["or equivalently,", "TechNoteText",
 CellID->377012236,ExpressionUUID->"5a816043-167c-448b-a963-31d68083e60b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"0"},
        "Bra"], "\[CircleTimes]", "I"}]}], "+", 
     RowBox[{
      TemplateBox[{"1"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"1"},
        "Bra"], "\[CircleTimes]", "U"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"fdc53bef-3dcc-4482-a160-318c49783a77"],
 "."
}], "TechNoteText",
 CellID->1367891802,ExpressionUUID->"4c7b2476-458b-4a8e-9418-a684abdb0042"],

Cell[TextData[{
 "If the control qubit is in |0\:27e9, then it does nothing. On the other \
hand, if the control qubit is in |1\:27e9, then it operates unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "db114179-0de5-4501-980f-d632526fd743"],
 " on the target qubit."
}], "TechNoteText",
 CellID->1345075079,ExpressionUUID->"8a510a09-9f33-4224-adac-2b0ec5212093"],

Cell["\<\
Analogously to the CNOT gate, the matrix representation of the \
controlled-unitary gate is thus given by\
\>", "TechNoteText",
 CellID->819163313,ExpressionUUID->"aa5f40c3-c7ec-40b2-a8b9-aabe10c141f2"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"]},
       {"0", "0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "e91b97cd-69b5-4b30-8385-b1f644a5fab4"],
 " ."
}], "TechNoteText",
 CellID->116500784,ExpressionUUID->"c0f92d2f-9d35-4cea-a3cb-67b8732c9c28"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"i", " ", "j"}]], TraditionalForm]],ExpressionUUID->
  "01757782-2239-4626-9e2f-f1e7a9987377"],
 " are the elements of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "050dffcf-0074-40eb-8e2a-0a0805ab304c"],
 "."
}], "TechNoteText",
 CellID->1671074271,ExpressionUUID->"aacc74a4-849d-468d-b578-7b3eaa244f63"],

Cell["\<\
In quantum circuit model, a controlled-unitary gate is depicted as\
\>", "TechNoteText",
 CellID->1953344721,ExpressionUUID->"d9b0f9bb-8585-481e-889e-30bd55b879c6"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
      LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"U\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->118.8,
    PlotRangePadding->Scaled[0.025]], "."}]}]], "Picture",
 CellID->954137231,ExpressionUUID->"4833314f-b458-4cee-ac6b-3b3ad3913f20"],

Cell["\<\
The filled circle connected to the quantum circuit element on the target \
qubit indicates the conditional operation of the element conditioned on the \
state of the control qubit.\
\>", "TechNoteText",
 CellID->924049268,ExpressionUUID->"50861721-bd1e-40cc-8723-c50a9f44a0ca"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[341]:=",
 CellID->214055128,ExpressionUUID->"2ce31d33-aee4-4d72-a2b3-b4642c66f708"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[342]:=",
 CellID->167122186,ExpressionUUID->"554ff151-7af9-4fbc-bdae-03c77de47d23"],

Cell[TextData[{
 "For demonstration, consider a single-qubit rotation acting on the qubit ",
 StyleBox["S[2,$]", "Input"],
 ". It is a rotation around the y-axis by angle \[Phi]."
}], "TechNoteMathCaption",
 CellID->2041795819,ExpressionUUID->"f035c9a4-0e4d-41b8-9705-2619d2952e5f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U", "//", "Elaborate"}], "//", "Matrix"}], "//", "ExpToTrig"}], "//",
   "MatrixForm"}]}], "Input",
 CellLabel->"In[343]:=",
 CellID->1821134520,ExpressionUUID->"da9628bc-d3ee-4aad-a9a8-e5fdaebb496d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[345]//MatrixForm=",
 CellID->711271405,ExpressionUUID->"5d47c128-e7f0-4c2f-88f9-bd34567ea278"]
}, Open  ]],

Cell["\<\
This is a quantum circuit featuring the controlled-unitary gate.\
\>", "TechNoteMathCaption",
 CellID->1443037598,ExpressionUUID->"92ec6682-30c0-49c3-b669-d01d99b8e86d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}], "]"}]}]], "Input",
 CellLabel->"In[346]:=",
 CellID->1600084015,ExpressionUUID->"4be3a71b-b59b-4b36-a105-ee37dcf338d6"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[2, QuantumMob`Q3`$], "Label" -> "U"]]]]], "Output",
 CellLabel->"Out[346]=",
 CellID->1444524633,ExpressionUUID->"650e9aa4-f4fa-4366-a2c8-7f12f2600486"]
}, Open  ]],

Cell["\<\
This is the explicit expression of the controlled-U gate  in terms of the \
Pauli operators.\
\>", "TechNoteMathCaption",
 CellID->378680471,ExpressionUUID->"67a631c8-74cb-482e-9a5d-70b267b93a9e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "qc", "]"}]], "Input",
 CellLabel->"In[347]:=",
 CellID->1488630036,ExpressionUUID->"ad0db6be-43ee-46a5-86bb-60c481d75309"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "4"], "]"}], "2"], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "4"], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2]]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 2]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[347]=",
 CellID->822877496,ExpressionUUID->"3f391c49-a4b1-48d4-8252-191e71e048fe"]
}, Open  ]],

Cell["\<\
The controlled-U gate maps the logical basis states as follows.\
\>", "TechNoteMathCaption",
 CellID->641929970,ExpressionUUID->"d01cfc43-d43e-4989-ae93-b13de89210a7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[348]:=",
 CellID->2106646909,ExpressionUUID->"110b3eaa-d8bb-4ea2-b982-b7959a14fbe4"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}], "-", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[350]//TableForm=",
 CellID->307388592,ExpressionUUID->"c340ba3c-075b-45ca-a0de-61072a968f4d"]
}, Open  ]],

Cell["\<\
When the control qubit  is in a superposition, the resulting state is an \
entangled state in general.\
\>", "TechNoteMathCaption",
 CellID->1736236263,ExpressionUUID->"25063834-76a6-4d00-a4ef-9f7f3a6f1424"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], "//", 
   RowBox[{
    RowBox[{"KetRegulate", "[", 
     RowBox[{"#", ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "&"}]}]}]], "Input",
 CellLabel->"In[351]:=",
 CellID->915076805,ExpressionUUID->"dac7df16-662e-418c-ab2d-20e99ee9663d"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
     0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["1", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]], "Output",
 CellLabel->"Out[351]=",
 CellID->1581894709,ExpressionUUID->"75a1dc23-b6bd-45cf-a116-5aeee7d6d2fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"qc", "**", "in"}]}]], "Input",
 CellLabel->"In[352]:=",
 CellID->1955961279,ExpressionUUID->"efce65c1-6d10-470d-841f-e57f21852d75"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
     0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[352]=",
 CellID->1056824303,ExpressionUUID->"812f3e40-d717-4f10-a70b-0d79eb3ee49c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase Acquisition", "Subsection",
 CellTags->"Section16",
 CellID->715838931,ExpressionUUID->"ee3a3a70-5ac3-4f8f-82ed-96846c8b81f4"],

Cell[TextData[{
 "An important aspect of a controlled-unitary operator is that it induces \
relative phase shifts on the control qubit when the target qubit has been \
prepared in an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "3cfa4b48-e062-4dfb-8fb4-4014eb64cded"],
 ". At first glace, it may sound counterintuitive since the definition given \
above seems to indicate that it changes only the target qubit depending on \
the state of the control qubit and keeps the latter intact. This is another \
feature distinguishing quantum gates from their classical counterparts."
}], "TechNoteText",
 CellID->901522823,ExpressionUUID->"983b5da1-7e14-4340-a570-2bd235b21b85"],

Cell[TextData[{
 "Let us take a closer look to see how this works. Prepare the control qubit \
in a superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Psi]"},
     "Ket"], "=", 
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], "+", 
     TemplateBox[{"1"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "becb29ae-4ca2-4316-8c09-a02d55820ac6"],
 " and the target qubit in an eigenstate ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "90665593-883d-4928-af0c-1cb784bff7dd"],
 " of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "b963fef7-253b-4c2d-8024-e9cdace24dd0"],
 " with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"051f7041-e539-4265-b6a1-c244eb4c51f7"],
 ". The controlled-unitary gate transforms the state to"
}], "TechNoteText",
 CellID->1396956576,ExpressionUUID->"e321a1c9-ef77-4f3e-b287-72d7ea61f3f1"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"\[Psi]"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"\[Phi]"},
      "Ket"]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Phi]"},
          "Ket"]}], ")"}]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], "\[CircleTimes]", 
        TemplateBox[{"\[Phi]"},
         "Ket"]}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "e9a06461-a74e-4a49-9ca4-afed795009d8"],
 " ."
}], "TechNoteText",
 CellID->210460181,ExpressionUUID->"6137c837-ce76-4e3f-b112-d0cd6ffdf4b5"],

Cell[TextData[{
 "This feature is extended to multi-control unitary gates and plays a crucial \
role in many quantum algorithms. In particular, the ",
 ButtonBox["quantum phase estimation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/QuantumPhaseEstimation"],
 " algorithm is a direct consequence of this feature."
}], "TechNoteText",
 CellID->298695458,ExpressionUUID->"87454076-b53e-4ef8-9022-9b16bc1f49ae"],

Cell[TextData[{
 "For demonstration, consider the phase gate. Recall that state ",
 Cell[BoxData[
  TemplateBox[{"1"},
   "Ket"]],ExpressionUUID->"187820f7-6d3e-4aca-8ebc-2dbaa4ae9f2b"],
 " is an eigenstate of it with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"b34b286b-943e-4ec3-abfd-53285b44cf4f"],
 "."
}], "TechNoteMathCaption",
 CellID->1505279567,ExpressionUUID->"d41f111e-20d0-46c4-94cc-a6680c90ac13"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"U", "=", 
  RowBox[{"Phase", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "U", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[353]:=",
 CellID->1876320909,ExpressionUUID->"093693c8-b3dc-44d3-abe0-7d6fcbb37e52"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FormBox[
    TagBox[
     RowBox[{
      FormBox[
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
         "Subsuperscript"],
        $CellContext`S[2, 3]],
       TraditionalForm], "\[InvisibleApplication]", 
      RowBox[{"(", "\[Phi]", ")"}]}],
     HoldForm],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  QuantumMob`Q3`Phase[$CellContext`\[Phi], 
   $CellContext`S[2, 3]]]], "Output",
 CellLabel->"Out[353]=",
 CellID->208816184,ExpressionUUID->"4bd5f35d-2c7d-43f3-93ca-5ca3092b61f6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      1, E^(Complex[0, 1] $CellContext`\[Phi])}}]]]]], "Output",
 CellLabel->"Out[354]//MatrixForm=",
 CellID->585325290,ExpressionUUID->"b8ba9e82-e902-4efb-9c4f-558323530eb0"]
}, Open  ]],

Cell["We are interested in the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->774865820,ExpressionUUID->"871eedc7-2ada-4b32-af4a-b72fe55df6ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "op", "]"}]}], "Input",
 CellLabel->"In[355]:=",
 CellID->2117896949,ExpressionUUID->"b5151aff-9501-41e3-a614-00e95f8f9118"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[2, 3]]]]]], "Output",
 CellLabel->"Out[356]=",
 CellID->2087045770,ExpressionUUID->"728dc750-a2be-4f4c-81d5-7774d281ddb3"]
}, Open  ]],

Cell["\<\
Prepare the target qubit in the eigenstate with a finite phase shift. In \
addition, prepare the control qubit in a linear superposition of the \
computational basis states in order to pick up the phase shift.\
\>", "TechNoteMathCaption",
 CellID->193224567,ExpressionUUID->"54ac56b4-e4ae-4509-956d-a6ee07e01cf4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "->", "1"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "op"}], 
   "]"}]}]], "Input",
 CellLabel->"In[357]:=",
 CellID->1062235589,ExpressionUUID->"99f2ed23-6293-4053-9546-7edd46ea658b"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"1"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-5, 2]}, {2, Rational[-1, 2]}}, {{
        2, -2.5}, {2, -0.5}}]]}, {LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`PortIn[
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
   $CellContext`S[1, 6], "Separator", 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[2, 3]]]]]], "Output",
 CellLabel->"Out[357]=",
 CellID->2127849939,ExpressionUUID->"dbe35559-2592-4b39-a75a-65a9328c1131"]
}, Open  ]],

Cell["\<\
Observe that the state does not change on the target qubit while the phase \
shift induced by the phase gate has been picked up by the state in the \
control qubit.\
\>", "TechNoteMathCaption",
 CellID->581406343,ExpressionUUID->"bc2370cd-0d62-4845-8745-09709f1e7a64"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "KetFactor"}]}], "Input",
 CellLabel->"In[358]:=",
 CellID->1127477995,ExpressionUUID->"7186d264-9499-4d83-b2d2-93db4d811b7d"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}],
    HoldForm],
   QuantumMob`Q3`OTimes[
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>] + 
    E^(Complex[0, 1] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[359]=",
 CellID->728751282,ExpressionUUID->"90a129b6-c22a-43c6-a900-8d3714a12376"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application: Controlled Power", "Subsection",
 CellTags->"Section17",
 CellID->616090041,ExpressionUUID->"f97445f0-5cd0-4cef-bedf-4bd9675ea58f"],

Cell["\<\
An interesting variation of the controlled-unitary gate is the controlled \
power of a unitary gate, typically depicted by the quantum circuit element in \
Figure 1.\
\>", "TechNoteText",
 CellID->1275497408,ExpressionUUID->"aa46d6c2-22ba-4bb1-aaf2-de4eeae37079"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
      0, -4}, {2, -4}}, {{0, -6}, {2, -6}}}], {{InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`x[1]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -1}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`x[2]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -2}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`x[3]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -3}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`x[4]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -4}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"\[Psi]\""},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.16000000000000003`],
        FontWeight->"Light"], {-0.2, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
      LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -6}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -4.4}, {1.4, -0.6},
        RoundingRadius->0.4]}, InsetBox[
       StyleBox["\<\"x\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", "\"x\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{
          
          TemplateBox[{
           "\"\\!\\(\\*StyleBox[\\\"U\\\",FontSlant->\\\"Italic\\\"]\\)\"", 
            "\"\\!\\(\\*StyleBox[\\\"x\\\",FontSlant->\\\"Italic\\\"]\\)\""}, 
           "Superscript", SyntaxForm -> SuperscriptBox], 
          TemplateBox[{"\"\[Psi]\""}, "Ket"]},
         "RowDefault"],
        StripOnInput->False,
        FontSize->Scaled[0.16000000000000003`],
        FontWeight->"Light"], {2.2, -6}, NCache[
       ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], {InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`x[1]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -1}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`x[2]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -2}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`x[3]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -3}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`x[4]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -4}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{36, 46.800000000000004`}, {1, 1}},
    ImageSize->154.79999999999998`,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`QuantumCircuitIn[
     Ket[<|$CellContext`S[1, Q3`$] -> $CellContext`x[1], $CellContext`S[
        2, Q3`$] -> $CellContext`x[2], $CellContext`S[
        3, Q3`$] -> $CellContext`x[3], $CellContext`S[
        4, Q3`$] -> $CellContext`x[4]|>], 
     Q3`ProductState[<|$CellContext`T[Q3`$] -> {1, 1}|>, "Label" -> 
      Ket[{"\[Psi]"}]]], 
    Q3`ControlledPower[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$], 
      $CellContext`S[4, Q3`$]}, 
     $CellContext`T[3]], 
    Q3`QuantumCircuitOut[
     Q3`ProductState[<|$CellContext`T[Q3`$] -> {1, 1}|>, "Label" -> Row[{
         Superscript[
         "\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)", 
          "\!\(\*StyleBox[\"x\",FontSlant->\"Italic\"]\)"], 
         Ket[{"\[Psi]"}]}]], 
     Ket[<|$CellContext`S[1, Q3`$] -> $CellContext`x[1], $CellContext`S[
        2, Q3`$] -> $CellContext`x[2], $CellContext`S[
        3, Q3`$] -> $CellContext`x[3], $CellContext`S[
        4, Q3`$] -> $CellContext`x[4]|>]], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}, "PortSize" -> {1, 1.3}]]],ExpressionUUID->
  "606729bc-c9bc-46b3-93f9-eac3bde0ac36"]
}], "Picture",
 CellID->2084184000,ExpressionUUID->"40ee9fad-de40-4105-8e75-2bdba38c3d58"],

Cell[TextData[{
 StyleBox["Figure 1",
  FontWeight->"Bold"],
 ". A quantum circuit for the controlled power of unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "317c4485-f774-47ce-bf37-8fd343a6059f"],
 "."
}], "TechNoteCaption",
 CellID->1283463500,ExpressionUUID->"cdcae4da-a687-4eb6-9687-ee2f93dae7ff"],

Cell[TextData[{
 "Consider a system consisting of a control register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "46a6bf47-19b4-4ad4-8102-d8f3d27d9b32"],
 " qubits and a target register. Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "5fa6b8a0-2db4-4f5d-9ac1-e8787a5ede9f"],
 " be a unitary operator acting on the target register. The controlled power \
(or controlled exponentiation) of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "ede5d39b-562c-4e28-bd28-51fdd154e4c9"],
 " is defined by"
}], "TechNoteText",
 CellID->1036421782,ExpressionUUID->"3f231e50-5313-40bb-a195-da8bb49950e4"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["x", "1"], 
         SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["x", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"y"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["x", "1"], 
         SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["x", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["U", "x"], 
       TemplateBox[{"y"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "0e874314-958c-419c-88df-9ec8cbf0cc01"],
 " ,"
}], "TechNoteText",
 CellID->1390517433,ExpressionUUID->"7f7a32c1-8f17-4bd5-b0ce-3ad21e20c2e9"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", ":=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "1"], 
       SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["x", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"ae29f9dc-7f43-4e85-9fa2-e6752f9e94cd"],
 ". Like the controlled-unitary gate, the controlled-power gate induces \
relative phase shifts on the control register leaving the target register \
intact when the target register is prepared in an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d502fa6d-299b-4eb7-be61-c5eff3e4f5cb"],
 ". More explicitly, let ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "48e3d3f4-5a8f-4493-a31c-7fb383fb6278"],
 " be an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "09f93ea2-fb08-46c8-a383-5046c600642a"],
 " belonging to eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", "\[Phi]"}]], 
   TraditionalForm]],ExpressionUUID->"433238a4-1f20-4493-8ccc-e2574c69e945"],
 ". Then, the controlled-power gate makes a transformation such that"
}], "TechNoteText",
 CellID->357932788,ExpressionUUID->"577a0554-ed89-4f76-9b20-7e941eb79543"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        UnderoverscriptBox["\[CapitalSigma]", 
         RowBox[{"x", "=", "0"}], 
         RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]], 
        TemplateBox[{"x"},
         "Ket"]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Phi]"},
          "Ket"]}], ")"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
       "\[ImaginaryI]", "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
        "\[Phi]"}]]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        UnderoverscriptBox["\[CapitalSigma]", 
         RowBox[{"x", "=", "0"}], 
         RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]], 
        TemplateBox[{"x"},
         "Ket"], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
         "\[ImaginaryI]", "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
          "\[Phi]"}]]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "0c6e24c5-9594-4e00-b517-8c448816fde1"],
 " ."
}], "TechNoteText",
 CellID->232871499,ExpressionUUID->"d34bc158-a1b4-417c-ba1e-511b2506c9d0"],

Cell[TextData[{
 "This is a straightforward generalization of the ",
 ButtonBox["phase-acquisition property",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#715838931"],
 " of the controlled-unitary gate discussed above."
}], "TechNoteText",
 CellID->531662691,ExpressionUUID->"9c328a15-1860-4f9f-b9ed-55bc31a2f544"],

Cell[TextData[{
 "Note that for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "1"], 
       SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["x", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"5605cfaa-7e1c-436f-98c9-52259addffb8"],
 ","
}], "TechNoteText",
 CellID->1514408200,ExpressionUUID->"393d68d9-f5d1-4adc-bb3c-92307f4e09b4"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["U", "x"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", 
         RowBox[{"n", "-", "1"}]]], ")"}], 
      SubscriptBox["x", "1"]], 
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", 
         RowBox[{"n", "-", "2"}]]], ")"}], 
      SubscriptBox["x", "1"]], 
     SuperscriptBox[
      RowBox[{"\[Ellipsis]", "(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", "0"]], ")"}], 
      SubscriptBox["x", "n"]]}]}], TraditionalForm]],ExpressionUUID->
  "0c003c83-6893-4a76-9faa-1a0a4dc6b178"],
 " ."
}], "TechNoteText",
 CellID->2034215257,ExpressionUUID->"829473a8-f9bf-4e9a-9187-606e3cdabc88"],

Cell["\<\
This implies that the controlled-power gate is a combination of the usual \
controlled-unitary gates as in Figure 2.\
\>", "TechNoteText",
 CellID->1368761109,ExpressionUUID->"2a8b67c2-fbfa-4946-a9f4-6218c6dd3a9e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
      0, -4}, {2, -4}}, {{0, -6}, {2, -6}}}], {
      LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -6}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -4.4}, {1.4, -0.6},
        RoundingRadius->0.4]}, InsetBox[
       StyleBox["\<\"x\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", "\"x\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
    ImageSize->118.8,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`ControlledPower[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$], 
      $CellContext`S[4, Q3`$]}, 
     $CellContext`T[3]], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}]]],ExpressionUUID->
  "b50f8301-7c5f-47a3-8d78-4d176de668cf"],
 "=",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
      0, -4}, {5, -4}}, {{0, -6}, {5, -6}}}], {LineBox[{{1, -1}, {1, -6}}], 
      DiskBox[{1, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "3"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -6}}], 
      DiskBox[{2, -2}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{1.6, -6.4}, {2.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -3}, {3, -6}}], 
      DiskBox[{3, -3}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -6.4}, {3.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {3, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -4}, {4, -6}}], 
      DiskBox[{4, -4}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -6.4}, {4.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {4, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
    ImageSize->226.79999999999998`,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 3]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 2]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 1]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
     Q3`ActOn[
      $CellContext`T[3], {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 0]], "LabelSize" -> 0.65], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}]]],ExpressionUUID->
  "df9f7b3c-30ad-4cff-80e5-ba48d79a1309"]
}], "Picture",
 CellID->757238962,ExpressionUUID->"d400d369-35fd-4813-8174-d70d455e5635"],

Cell[TextData[{
 StyleBox["Figure 2",
  FontWeight->"Bold"],
 ". A equivalent quantum circuit (right) of the controlled power of unitary \
operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "1a9d9b35-00c8-4ff2-bd50-fc41bdac3e8a"],
 " (left). "
}], "TechNoteCaption",
 CellID->927142212,ExpressionUUID->"85204f84-4f91-4ce6-a006-3254530e122c"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->305516076,ExpressionUUID->"4d5b5e58-ead5-4591-9b3a-3235314adb8d"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[360]:=",
 CellID->1535052485,ExpressionUUID->"130f06b3-a3a7-40f0-923f-091d98ae0694"],

Cell[TextData[{
 "Consider a control register consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "fdcb873b-8627-458b-9fc1-61a901487452"],
 " qubits."
}], "TechNoteMathCaption",
 CellID->1475887768,ExpressionUUID->"741562df-21d4-42e5-bc8d-8b01625dc287"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "$"}], "]"}]}]}], "Input",
 CellLabel->"In[361]:=",
 CellID->1092408791,ExpressionUUID->"25260ebd-ee67-43b8-9df1-23d249e70e48"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[363]=",
 CellID->1023557733,ExpressionUUID->"be1f702b-8e22-4601-8c0d-aa2bd26c3b34"]
}, Open  ]],

Cell["\<\
Consider a single-qubit unitary gate acting on the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1519843333,ExpressionUUID->"17f0301b-e2eb-4eb1-8447-296de283abbf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"opU", "=", 
  RowBox[{"Phase", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"T", "[", "3", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[364]:=",
 CellID->21384525,ExpressionUUID->"4ce5a21c-bb4b-41b1-ac0c-619c6ffc52ee"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FormBox[
    TagBox[
     RowBox[{
      FormBox[
       InterpretationBox[
        TemplateBox[{"T", 
          
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", "\"Z\""}, 
           "RowWithSeparators"]},
         "Superscript"],
        $CellContext`T[3]],
       TraditionalForm], "\[InvisibleApplication]", 
      RowBox[{"(", "\[Phi]", ")"}]}],
     HoldForm],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  QuantumMob`Q3`Phase[$CellContext`\[Phi], 
   $CellContext`T[3]]]], "Output",
 CellLabel->"Out[365]=",
 CellID->1590806061,ExpressionUUID->"6bdcacbc-b9f9-4a0c-aeed-ada5f2b77095"]
}, Open  ]],

Cell[TextData[{
 "Construct the controlled-power of ",
 StyleBox["opU", "Input"],
 " defined above."
}], "TechNoteMathCaption",
 CellID->978050365,ExpressionUUID->"781482ae-645f-4385-8083-6151835ecb94"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cop", "=", 
  RowBox[{"ControlledPower", "[", 
   RowBox[{"SS", ",", "opU"}], "]"}]}]], "Input",
 CellLabel->"In[366]:=",
 CellID->2127797723,ExpressionUUID->"162671fa-5c26-4d2e-99cb-b0bf6a51adb2"],

Cell[BoxData[
 RowBox[{"ControlledPower", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}], ",", 
   InterpretationBox[
    TagBox[
     FormBox[
      TagBox[
       RowBox[{
        FormBox[
         InterpretationBox[
          TemplateBox[{"T", 
            
            TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", "\"Z\""}, 
             "RowWithSeparators"]},
           "Superscript"],
          $CellContext`T[3]],
         TraditionalForm], "\[InvisibleApplication]", 
        RowBox[{"(", "\[Phi]", ")"}]}],
       HoldForm],
      TraditionalForm],
     TraditionalForm,
     Editable->True],
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]]}], "]"}]], "Output",
 CellLabel->"Out[366]=",
 CellID->506062077,ExpressionUUID->"389111d4-111d-4ebc-bcc5-f6ccbb1fa190"]
}, Open  ]],

Cell["\<\
Construct a simple quantum circuit to demonstrate how the controlled-power \
gate works.\
\>", "TechNoteMathCaption",
 CellID->1664622810,ExpressionUUID->"be02ff39-64d3-4725-bbe0-d951173093fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductState", "[", 
     RowBox[{"T", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    "cop", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[367]:=",
 CellID->2027335310,ExpressionUUID->"62935618-6633-496f-bc8b-405b740c0cd9"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -5}, {2, -5}}}], InsetBox[
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], "+", 
      TemplateBox[{"1"},
       "Ket"]}], {-0.2, -5.}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1, 
     0}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -5}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{74.16, 38.160000000000004`}, {7.2, 7.2}},
   ImageSize->180,
   PlotRange->{{0, 2}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`PortIn[
    QuantumMob`Q3`ProductState[<|$CellContext`T[QuantumMob`Q3`$] -> {1, 
       1}|>]], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}, 
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]], "PortSize" -> {2, 1}]]], "Output",
 CellLabel->"Out[367]=",
 CellID->1350086019,ExpressionUUID->"c8a29faf-02f2-4b31-b6a4-6bb375ef354c"]
}, Open  ]],

Cell["Take computational basis states as inputs.", "TechNoteMathCaption",
 CellID->1320057003,ExpressionUUID->"2e1511e0-e24f-4143-877b-31acddecd1cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"Basis", "[", "SS", "]"}]}]], "Input",
 CellLabel->"In[368]:=",
 CellID->856233533,ExpressionUUID->"f0819f18-561a-4eb6-8e89-554000492100"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "}"}]], "Output",
 CellLabel->"Out[368]=",
 CellID->583507131,ExpressionUUID->"2c188cda-33b3-4827-b70b-7ac7cf45ef39"]
}, Open  ]],

Cell["Calculate the output for each input state.", "TechNoteMathCaption",
 CellID->1095734201,ExpressionUUID->"cbbf7dd1-eb77-4361-ace8-ef86a4cd8046"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"qc", "**", "in"}]}]], "Input",
 CellLabel->"In[369]:=",
 CellID->1234389837,ExpressionUUID->"8924814e-b530-4164-9dea-b77ec7a6a7e7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        0, $CellContext`S[2, QuantumMob`Q3`$] -> 
        0, $CellContext`S[3, QuantumMob`Q3`$] -> 
        1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        0, $CellContext`S[2, QuantumMob`Q3`$] -> 
        1, $CellContext`S[3, QuantumMob`Q3`$] -> 
        0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        0, $CellContext`S[2, QuantumMob`Q3`$] -> 
        1, $CellContext`S[3, QuantumMob`Q3`$] -> 
        1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        1, $CellContext`S[2, QuantumMob`Q3`$] -> 
        0, $CellContext`S[3, QuantumMob`Q3`$] -> 
        0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        1, $CellContext`S[2, QuantumMob`Q3`$] -> 
        0, $CellContext`S[3, QuantumMob`Q3`$] -> 
        1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        1, $CellContext`S[2, QuantumMob`Q3`$] -> 
        1, $CellContext`S[3, QuantumMob`Q3`$] -> 
        0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        1, $CellContext`S[2, QuantumMob`Q3`$] -> 
        1, $CellContext`S[3, QuantumMob`Q3`$] -> 
        1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}]}], "}"}]], "Output",
 CellLabel->"Out[369]=",
 CellID->1594018515,ExpressionUUID->"98f5a840-ea8f-46d8-be60-5f66fa632fb8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", 
    RowBox[{"KetFactor", "[", "out", "]"}]}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellLabel->"In[370]:=",
 CellID->273770455,ExpressionUUID->"0cae4d1e-63a6-45c3-90e6-00f8f1b32c67"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             0, $CellContext`S[2, QuantumMob`Q3`$] -> 
             0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["1", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           0, $CellContext`S[2, QuantumMob`Q3`$] -> 
           0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             0, $CellContext`S[2, QuantumMob`Q3`$] -> 
             0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           0, $CellContext`S[2, QuantumMob`Q3`$] -> 
           0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 1] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             0, $CellContext`S[2, QuantumMob`Q3`$] -> 
             1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           0, $CellContext`S[2, QuantumMob`Q3`$] -> 
           1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 2] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             0, $CellContext`S[2, QuantumMob`Q3`$] -> 
             1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           0, $CellContext`S[2, QuantumMob`Q3`$] -> 
           1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 3] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             1, $CellContext`S[2, QuantumMob`Q3`$] -> 
             0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           1, $CellContext`S[2, QuantumMob`Q3`$] -> 
           0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 4] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             1, $CellContext`S[2, QuantumMob`Q3`$] -> 
             0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           1, $CellContext`S[2, QuantumMob`Q3`$] -> 
           0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 5] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             1, $CellContext`S[2, QuantumMob`Q3`$] -> 
             1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           1, $CellContext`S[2, QuantumMob`Q3`$] -> 
           1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 6] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             1, $CellContext`S[2, QuantumMob`Q3`$] -> 
             1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           1, $CellContext`S[2, QuantumMob`Q3`$] -> 
           1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 7] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[370]//TableForm=",
 CellID->810685280,ExpressionUUID->"7faf95c7-3c71-4e94-8ed1-eb3a024219b8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->1362282140,ExpressionUUID->"bcc1081e-c154-4988-b5e6-5a9167d6eceb"],

Cell["\<\
Construct a simple quantum circuit to demonstrate how the controlled-power \
gate works.\
\>", "TechNoteMathCaption",
 CellID->523520144,ExpressionUUID->"b850bbd9-090e-4901-b35e-4b30a16a39f1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"SS", "->", "0"}], ",", 
      RowBox[{"T", "->", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"kk", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "cop", ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[371]:=",
 CellID->770533652,ExpressionUUID->"b7e3e908-772f-45f0-b869-922b7302046c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}}], {InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -3.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"1"},
       "Ket"], {-0.2, -5.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -3.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
        2, -5.5}, {2, -0.5}}]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}, {3, -5}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{74.16, 38.160000000000004`}, {7.2, 7.2}},
   ImageSize->252,
   PlotRange->{{0, 4}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`PortIn[
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}, "Separator", 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}, 
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]], "PortSize" -> {2, 1}]]], "Output",
 CellLabel->"Out[371]=",
 CellID->1551244392,ExpressionUUID->"a3929786-57ea-407a-b307-594595a2701f"]
}, Open  ]],

Cell["Calculate the output state.", "TechNoteMathCaption",
 CellID->363088131,ExpressionUUID->"9f0cce57-7994-41bc-a39b-c6c391b32236"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[372]:=",
 CellID->1079016412,ExpressionUUID->"20936cc3-ce7b-48a1-abc1-fd93239a9952"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox["T", 
            $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[372]=",
 CellID->1313021764,ExpressionUUID->"23114038-0444-4004-927b-a1e05db38cc1"]
}, Open  ]],

Cell["Check that the target qubit is factorized.", "TechNoteMathCaption",
 CellID->942690207,ExpressionUUID->"81da99aa-cee3-4c6c-a2e5-7c1e86b16d8d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetFactor", "[", 
  RowBox[{"out", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[373]:=",
 CellID->473086067,ExpressionUUID->"8741da48-63ee-49af-b16e-7ed680688fdf"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                 $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                 $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}],
    HoldForm],
   QuantumMob`Q3`OTimes[
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>] + 
    E^(Complex[0, 4] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 0|>] + 
    E^(Complex[0, 2] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[3, QuantumMob`Q3`$] -> 0|>] + 
    E^(Complex[0, 1] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[3, QuantumMob`Q3`$] -> 1|>], 
    Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]], 
  RowBox[{"2", " ", 
   SqrtBox["2"]}]]], "Output",
 CellLabel->"Out[373]=",
 CellID->414830976,ExpressionUUID->"2a81acc7-655c-4ac9-8d10-dcbab5f17c85"]
}, Open  ]],

Cell["\<\
To focus on the state of the control register, ignore the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1762048567,ExpressionUUID->"90653e60-9b4e-438d-b8cc-9be50dfe6ccc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetDrop", "[", 
  RowBox[{"out", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[374]:=",
 CellID->1674087129,ExpressionUUID->"b5f5899c-d700-447a-8471-02e150757100"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[374]=",
 CellID->1332295470,ExpressionUUID->"129e1961-f292-42cb-8098-6019ab07be95"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->1016485255,ExpressionUUID->"a5feaf41-276b-40cb-9c8d-eda33b2c3700"],

Cell["\<\
Consider again  the quantum circuit for controlled-power gate.\
\>", "TechNoteMathCaption",
 CellID->1235189013,ExpressionUUID->"657c84c5-489b-424a-aa62-5fb3ad79f96a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"cop", ",", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[375]:=",
 CellID->1297582908,ExpressionUUID->"1ce58a0a-1ce9-4d96-b95d-c473acb169ba"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -5}, {2, -5}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -5}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}, 
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[375]=",
 CellID->77977021,ExpressionUUID->"cdb8416e-33ed-4c31-a66e-97c36dd5227b"]
}, Open  ]],

Cell["\<\
Expand the controlled-power gate in terms of elementary gates (in this case, \
the controlled-unitary gates).\
\>", "TechNoteMathCaption",
 CellID->331049159,ExpressionUUID->"f7bc0d70-cae6-4044-84ae-bed1991c9bdf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Unfold", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[376]:=",
 CellID->1888208538,ExpressionUUID->"5ebf39db-17bb-4b0e-99bf-15233e4bbb5e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}}], {LineBox[{{1, -1}, {1, -5}}], DiskBox[{1, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], 
         TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {1., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -5}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {2., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -5}}], 
     DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {3., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     QuantumMob`Q3`Phase[4 $CellContext`\[Phi], 
      $CellContext`T[3]], {
      $CellContext`T[QuantumMob`Q3`$]}], "Label" -> Superscript[
      Superscript["Z", $CellContext`\[Phi]], 
      Superscript[2, 2]], "LabelSize" -> 0.65], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     QuantumMob`Q3`Phase[2 $CellContext`\[Phi], 
      $CellContext`T[3]], {
      $CellContext`T[QuantumMob`Q3`$]}], "Label" -> Superscript[
      Superscript["Z", $CellContext`\[Phi]], 
      Superscript[2, 1]], "LabelSize" -> 0.65], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     QuantumMob`Q3`Phase[$CellContext`\[Phi], 
      $CellContext`T[3]], {
      $CellContext`T[QuantumMob`Q3`$]}], "Label" -> Superscript[
      Superscript["Z", $CellContext`\[Phi]], 
      Superscript[2, 0]], "LabelSize" -> 0.65], 
   "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[376]=",
 CellID->594767277,ExpressionUUID->"40c54c32-e021-41df-85f7-9ee9784728bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "qc", "]"}], "-", 
   RowBox[{"Matrix", "[", "new", "]"}]}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[377]:=",
 CellID->1871953819,ExpressionUUID->"b21760a9-847a-428e-97c3-0e7dfd73b276"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{1}, {
       2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {
       15}, {16}}}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0}}]]]]], "Output",
 CellLabel->"Out[377]//MatrixForm=",
 CellID->1864731401,ExpressionUUID->"334f3f36-c27d-413c-9627-00d1e67802a6"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application: Conditional Operation", "Subsection",
 CellTags->"Section17",
 CellID->1379525988,ExpressionUUID->"282e3190-83e3-43ce-9673-7331e03347e4"],

Cell[TextData[{
 "The CNOT gate and the controlled-unitary gate can be combined to achieve a \
variety of conditional gate operations. For example, consider a system \
consisting of a control register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "4b76bd22-2c2a-43a0-b9f0-664c0037f8b0"],
 " qubits and a target register of a single qubit. Suppose that you want to \
operate a unitary gate ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "e7c45187-6aa7-481e-b2bd-e176ee3e2f21"],
 " on the target qubit only when an odd number of the control qubits is set \
to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"1"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "0a5db31d-a5e5-4dba-b56e-8085cc94fda4"],
 ","
}], "TechNoteText",
 CellID->1459827304,ExpressionUUID->"bc953bfd-3400-4d11-beb1-d14ede8c1a3a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["U", 
        RowBox[{
         SubscriptBox["c", "1"], "\[CirclePlus]", 
         SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", "\[CirclePlus]", 
         SubscriptBox["c", "n"]}]], 
       TemplateBox[{"t"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "3dded531-5c7b-4f68-a524-d46d2577fec8"],
 " ."
}], "TechNoteText",
 CellID->316831353,ExpressionUUID->"ceb6d8d9-d7f6-4938-8174-7b09693b43ca"],

Cell[TextData[{
 "First, operate the CNOT gates consecutively with the first ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", " ", "\[Minus]", " ", "1"}], ")"}], TraditionalForm]],
  ExpressionUUID->"48c4a95f-a35d-4ecd-97e2-41f170a97008"],
 " qubits in the control register as the control qubit and the last qubit in \
the control register as the target qubit. This transforms the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "ec039187-35be-439c-bdf5-665f63bc73f8"],
 " qubit to",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", 
       "\[CirclePlus]", 
       SubscriptBox["c", "n"]}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "3d413d15-9190-424f-b638-600b1664238a"],
 ". Then, the desired operation is implemented by applying the controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d3d099fb-08c9-4743-aafa-48c9d80c3061"],
 " gate controlled by the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "3565ec91-da29-44a9-b2cc-88d0da18f215"],
 " qubit. To get the control qubits back to the original state, operate the \
CNOT gates in the reverse order. Overall, the two equivalent quantum circuits \
in Figure 3 below implement the conditional operation."
}], "TechNoteText",
 CellID->1372588958,ExpressionUUID->"e89f5db1-6c7e-429f-b0f3-782981a28c78"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -3}, {10, -3}}, {{0, -4}, {10, -4}}, {{
     0, -5}, {10, -5}}, {{0, -7}, {10, -7}}}], {LineBox[{{1, -1}, {1, -5}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, {
     LineBox[{{3, -3}, {3, -5}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -5}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -5}, {3.2666666666666666`, -5}}, {{
         3, -5.266666666666667}, {3, -4.733333333333333}}}]}}, {
     LineBox[{{4, -4}, {4, -5}}], 
     DiskBox[{4, -4}, 0.09], {CircleBox[{4, -5}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -5}, {4.266666666666667, -5}}, {{
         4, -5.266666666666667}, {4, -4.733333333333333}}}]}}, {
     LineBox[{{5, -5}, {5, -7}}], DiskBox[{5, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -7.4}, {5.4, -6.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -7}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -4}, {6, -5}}], 
     DiskBox[{6, -4}, 0.09], {CircleBox[{6, -5}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -5}, {6.266666666666667, -5}}, {{
         6, -5.266666666666667}, {6, -4.733333333333333}}}]}}, {
     LineBox[{{7, -3}, {7, -5}}], 
     DiskBox[{7, -3}, 0.09], {CircleBox[{7, -5}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -5}, {7.266666666666667, -5}}, {{
         7, -5.266666666666667}, {7, -4.733333333333333}}}]}}, {
     LineBox[{{9, -1}, {9, -5}}], 
     DiskBox[{9, -1}, 0.09], {CircleBox[{9, -5}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -5}, {9.266666666666667, -5}}, {{
         9, -5.266666666666667}, {9, -4.733333333333333}}}]}}, InsetBox[
     StyleBox["\<\"\[DescendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {2, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]],
     InsetBox[
     StyleBox["\<\"\[AscendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {8, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]], 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -3}, {10, -3}}, {{0, -4}, {10, -4}}, {{
     0, -5}, {10, -5}}, {{0, -7}, {10, -7}}}], {LineBox[{{1, -1}, {1, -3}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, {
     LineBox[{{4, -4}, {4, -5}}], 
     DiskBox[{4, -4}, 0.09], {CircleBox[{4, -5}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -5}, {4.266666666666667, -5}}, {{
         4, -5.266666666666667}, {4, -4.733333333333333}}}]}}, {
     LineBox[{{5, -5}, {5, -7}}], DiskBox[{5, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -7.4}, {5.4, -6.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -7}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -4}, {6, -5}}], 
     DiskBox[{6, -4}, 0.09], {CircleBox[{6, -5}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -5}, {6.266666666666667, -5}}, {{
         6, -5.266666666666667}, {6, -4.733333333333333}}}]}}, {
     LineBox[{{7, -3}, {7, -4}}], 
     DiskBox[{7, -3}, 0.09], {CircleBox[{7, -4}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -4}, {7.266666666666667, -4}}, {{
         7, -4.266666666666667}, {7, -3.7333333333333334`}}}]}}, {
     LineBox[{{9, -1}, {9, -3}}], 
     DiskBox[{9, -1}, 0.09], {CircleBox[{9, -3}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -3}, {9.266666666666667, -3}}, {{
         9, -3.2666666666666666`}, {9, -2.7333333333333334`}}}]}}, InsetBox[
     StyleBox["\<\"\[DescendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {2, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]],
     InsetBox[
     StyleBox["\<\"\[AscendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {8, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]]}]], "Picture",
 CellID->833281032,ExpressionUUID->"997e28bc-5d86-43d0-b09e-940ef797358f"],

Cell[TextData[{
 StyleBox["Figure 3",
  FontWeight->"Bold"],
 ". Two equivalent quantum circuits for a conditional unitary gate based on \
sequences of CNOT gates. In principle, the two quantum circuits give the same \
result, but one quantum circuit may be more useful than the other depending \
on the physical connectivity of qubits in a particular quantum computer."
}], "TechNoteCaption",
 CellID->571282978,ExpressionUUID->"d6ce27f4-6f28-4029-b312-97a001c71d6e"],

Cell["\<\
This method is used to implement a multi-control unitary gate based on the \
Gray code.\
\>", "TechNoteText",
 CellID->1213442737,ExpressionUUID->"b1507fe8-1973-49ca-b3f9-07feeef90ebe"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->780471724,ExpressionUUID->"90098754-2b29-422e-835c-49da245541bb"],

Cell["\<\
As a demonstration, consider a three-qubit control register. Suppose that we \
want to operate a rotation around the y-axis on the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1827368847,ExpressionUUID->"9d9f2bda-9afe-4cf2-9313-c77760065c93"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{
    RowBox[{"Distribute", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "[", "CNOT", "]"}], "[", 
       RowBox[{
        RowBox[{"Most", "[", "ss", "]"}], ",", 
        RowBox[{"Last", "@", "ss"}]}], "]"}], ",", "List"}], "]"}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"$n", "+", "1"}], ",", "2"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sequence", "@@", "cnot"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "$n", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Reverse", "[", "cnot", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[378]:=",
 CellID->1424575782,ExpressionUUID->"891c96d7-4c9f-4f1f-bf6e-482a69ca8ce0"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
     0, -4}, {6, -4}}}], {LineBox[{{1, -1}, {1, -3}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"R\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -3}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -3}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -3}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -3}, {5.266666666666667, -3}}, {{
         5, -3.2666666666666666`}, {5, -2.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->262.8,
   PlotRange->{{0, 6}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[4, QuantumMob`Q3`$]]], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[382]=",
 CellID->164312289,ExpressionUUID->"f2f170e3-e872-4071-9ea0-6a9bb9faa9a0"]
}, Open  ]],

Cell["\<\
Note the way the logical basis states are transformed through the above \
quantum circuit.\
\>", "TechNoteMathCaption",
 CellID->873169809,ExpressionUUID->"218f2ae3-6825-47e9-bd24-6bbba10bd8b7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "ss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[383]:=",
 CellID->1609219912,ExpressionUUID->"004fad44-f1d1-4afc-b61c-19ee119f57a9"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 
            0, $CellContext`S[3, QuantumMob`Q3`$] -> 
            1, $CellContext`S[4, QuantumMob`Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 
            0, $CellContext`S[3, QuantumMob`Q3`$] -> 
            1, $CellContext`S[4, QuantumMob`Q3`$] -> 1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 
            1, $CellContext`S[3, QuantumMob`Q3`$] -> 
            0, $CellContext`S[4, QuantumMob`Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 
            1, $CellContext`S[3, QuantumMob`Q3`$] -> 
            0, $CellContext`S[4, QuantumMob`Q3`$] -> 1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 
            0, $CellContext`S[3, QuantumMob`Q3`$] -> 
            0, $CellContext`S[4, QuantumMob`Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 
            0, $CellContext`S[3, QuantumMob`Q3`$] -> 
            0, $CellContext`S[4, QuantumMob`Q3`$] -> 1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 
            1, $CellContext`S[3, QuantumMob`Q3`$] -> 
            1, $CellContext`S[4, QuantumMob`Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 
            1, $CellContext`S[3, QuantumMob`Q3`$] -> 
            1, $CellContext`S[4, QuantumMob`Q3`$] -> 1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[385]//TableForm=",
 CellID->2080154828,ExpressionUUID->"fdfd36d8-e979-4e7d-92fb-6af37eb4251f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition into Elementary Gates", "Subsection",
 CellTags->"Section18",
 CellID->1847739219,ExpressionUUID->"900f392e-121c-4b94-bdff-e941f10868f0"],

Cell["\<\
How can you implement a controlled-unitary gate? The operation involves only \
two qubits, and in principle, it should be possible to implement any specific \
controlled-unitary gate. However, the requirements for a physical \
implementation of two-qubit gates is far more difficult to fulfill on \
realistic systems than for single-qubit gates. Fortunately, any \
controlled-unitary gate can be implemented using only the CNOT gate and \
single-qubit gates. This is one of the basic steps in establishing universal \
quantum computation.\
\>", "TechNoteText",
 CellID->192034466,ExpressionUUID->"e4b51dcd-71db-4cc5-9c42-42664e1d0a0e"],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "945c37eb-4a01-4125-a805-671b598769a7"],
 " be a unitary gate on the second (target) qubit controlled by the first \
(control) qubit. Suppose that ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "0b6ee1b9-792b-4fea-a7ef-439a3ea19c87"],
 " has Euler angles \[Alpha], \[Beta], and \[Gamma] and an additional phase \
factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], TraditionalForm]],
  ExpressionUUID->"e1dc8f72-d46f-4447-a5ae-b55c4f208de5"],
 ", "
}], "TechNoteText",
 CellID->2002832268,ExpressionUUID->"23516c3d-6b6c-45ef-8a69-df05d3877881"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", "\[Beta]", ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Gamma]", ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"3dcc2528-83a7-443f-9c16-3955cf56095b"],
 " ."
}], "TechNoteText",
 CellID->1943245198,ExpressionUUID->"4bb6a7a1-3ef2-4a89-86c6-8a01145c1acf"],

Cell[TextData[{
 "Then one can always find three unitary operators ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "5ee2a65e-b970-48d2-9136-2b62258683e1"],
 ", ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "474ce7ad-bd1a-4759-91cf-8b53dfec6dca"],
 ", and ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "2506b642-cd44-44d2-b4f3-661f26c5ce9a"],
 " such that"
}], "TechNoteText",
 CellID->1190739210,ExpressionUUID->"8f2d8621-21e0-4b26-a4f4-1d5dbf6a610b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], "A", " ", "X", " ", "B",
      " ", "X", " ", "C"}]}], TraditionalForm]],ExpressionUUID->
  "63298962-fd15-46a6-a9f0-9b11274dd7f7"],
 " ,\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "B", " ", "C"}], "=", "I"}], TraditionalForm]],
  ExpressionUUID->"7e157292-8087-4579-bf8f-8286f6c0f463"],
 " ,"
}], "TechNoteText",
 CellID->353796077,ExpressionUUID->"e725f510-b374-4331-a239-c4c03e2d8b8d"],

Cell["\<\
where X is the Pauli X operator. More explicitly, a common choice is\
\>", "TechNoteText",
 CellID->2015931243,ExpressionUUID->"edcb0f60-ddf4-4815-9491-f057f90e2304"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{"\[Beta]", "/", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"5323cf5a-a9d1-456b-96ee-5e5683ce627f"],
 " ,"
}], "TechNoteText",
 CellID->906902382,ExpressionUUID->"25607c2a-0336-4a69-947a-77dd4a7e3a04"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{
       RowBox[{"-", "\[Beta]"}], "/", "2"}], ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Gamma]"}], ")"}]}], "/", "2"}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "ed6bfa4c-3687-4e75-a22b-e2ef15a5cca5"],
 " ,"
}], "TechNoteText",
 CellID->1616891515,ExpressionUUID->"78bc411e-6739-42f3-b9c2-a5ca4fe43344"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"C", "=", 
    RowBox[{
     SubscriptBox["U", "z"], "(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "-", "\[Gamma]"}], ")"}]}], "/", "2"}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"f1091f24-2407-4ea4-b0d5-b55c0b752369"],
 " ."
}], "TechNoteText",
 CellID->837623467,ExpressionUUID->"0ba96b1d-deb9-4594-b7aa-1cb9b38ce456"],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      RowBox[{"y", "/", "z"}]], "(", "\[Phi]", ")"}], "=", 
    RowBox[{"X", " ", 
     RowBox[{
      SubscriptBox["U", 
       RowBox[{"y", "/", "z"}]], "(", 
      RowBox[{"-", "\[Phi]"}], ")"}], "X"}]}], TraditionalForm]],
  ExpressionUUID->"17f91b7f-eca2-4841-a6b9-f1e67f21852c"],
 " for any \[Phi], the above choice satisfies the desired properties. These \
properties imply that the controlled-unitary gate can be implemented as in \
the following quantum circuit"
}], "TechNoteText",
 CellID->1182303784,ExpressionUUID->"46706b95-1247-4363-b542-accbbb43f4b0"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->118.8,
   PlotRangePadding->Scaled[0.025]], "=", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
       StyleBox["\<\"A\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -2}, ImageScaled[{0.5, 0.5}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
       StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[ExponentialE]\\), \\(\
\[ImaginaryI]\\\\ \[CurlyPhi]\\)]\\)\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -1}, ImageScaled[{0.5, 0.5}]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->262.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->313511997,ExpressionUUID->"1fdb1c62-21c2-47cb-973c-46d6d5683386"],

Cell[TextData[{
 "where the last gate on the first qubit is the relative phase shift by \
\[CurlyPhi], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], 
     TemplateBox[{"0"},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{"1"},
      "Ket"], 
     TemplateBox[{"1"},
      "Bra"], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}]}], TraditionalForm]],
  ExpressionUUID->"e8ab7512-cc08-4f17-abb8-18ab958cafdc"],
 ". Indeed, when the control qubit is in |0\:27e9, the two CNOT gates in the \
middle do nothing, and the combined operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", " ", "B", " ", "C"}], TraditionalForm]],ExpressionUUID->
  "1cf3fb5e-1bdc-4fc6-a40e-e8f600623583"],
 " on the target qubit ends up with the identity operator. With the control \
qubit in |1\:27e9, on the other hand, the two CNOT gates are operational and \
the overall operator on the target qubit becomes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "X", " ", "B", " ", "X", " ", "C"}], "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], "U"}]}], 
   TraditionalForm]],ExpressionUUID->"8f2f11a8-402d-4020-b160-d8d5689a7b20"],
 ", where the phase factor is canceled by the opposite phase from the control \
qubit."
}], "TechNoteText",
 CellID->1418747488,ExpressionUUID->"7a8f3e40-6901-4ef4-9d28-010014fefc29"],

Cell["\<\
For demonstration, consider a unitary matrix to be applied conditionally on \
the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1378098175,ExpressionUUID->"4c102618-c16d-4d10-9333-d0d254652296"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"I", "*", 
     RowBox[{"TheRotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[386]:=",
 CellID->1028095504,ExpressionUUID->"5a505ed7-cfec-4878-9605-43d162d52130"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"3", "/", "4"}]]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"1", "/", "4"}]]}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[387]//MatrixForm=",
 CellID->128421036,ExpressionUUID->"535d05fe-e3d1-49a1-bb21-cc0bdfebfd4c"]
}, Open  ]],

Cell["We want to implement the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->1646790355,ExpressionUUID->"a9a65c61-5c1b-405a-8301-3acb1bc598eb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[388]:=",
 CellID->1153761970,ExpressionUUID->"4639707b-214d-45da-b1af-33bb180b45b0"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[0, 
       Rational[1, 2]] 3^Rational[1, 2] + 
    Rational[-1, 2] (-1)^Rational[3, 4] $CellContext`S[2, 4] + 
    Rational[1, 2] (-1)^Rational[1, 4] $CellContext`S[2, 5], "Label" -> 
    "U"]]]], "Output",
 CellLabel->"Out[389]=",
 CellID->151286817,ExpressionUUID->"d2d2f2bd-2400-4571-a8e0-ec4c100d4a47"]
}, Open  ]],

Cell["\<\
First, find the Euler angles of the unitary operator and the global phase \
factor.\
\>", "TechNoteMathCaption",
 CellID->1240176371,ExpressionUUID->"b447d22a-032c-4179-8289-cbc66ec4d97a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"det", "=", 
   RowBox[{"Det", "[", "mat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{
    RowBox[{"Arg", "[", "det", "]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
  RowBox[{"TheEulerAngles", "[", 
   RowBox[{"mat", "/", 
    RowBox[{"Sqrt", "[", "det", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[390]:=",
 CellID->167989615,ExpressionUUID->"c689b6d4-fc1e-4bbe-9092-e40e136bbf3c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["\[Pi]", "4"]}], ",", 
   FractionBox["\[Pi]", "3"], ",", 
   FractionBox["\[Pi]", "4"]}], "}"}]], "Output",
 CellLabel->"Out[392]=",
 CellID->56895271,ExpressionUUID->"e9cad8c3-beec-4e93-a323-89d111128661"]
}, Open  ]],

Cell["From the Euler angles, choose the component operators.", \
"TechNoteMathCaption",
 CellID->833485781,ExpressionUUID->"6fa973de-10ea-42c2-bc4d-279c477d744d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opA", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"b", "/", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opB", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "b"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "+", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<B\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opC", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opD", "=", 
   RowBox[{"Phase", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[393]:=",
 CellID->359691886,ExpressionUUID->"c5729727-d6cf-45ea-a8d0-5b20871e6cf1"],

Cell["Finally, construct the equivalent quantum circuit model.", \
"TechNoteMathCaption",
 CellID->175061697,ExpressionUUID->"37a7d2c7-0878-4653-8a81-e1cc4d0e9e32"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"opC", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opB", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opA", ",", "opD"}], 
   "]"}]}]], "Input",
 CellLabel->"In[397]:=",
 CellID->209345089,ExpressionUUID->"9660bb75-2cc2-4f03-ae64-a0fbc403d05a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", 
         FractionBox["\[Pi]", "2"]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->298.8,
   PlotRange->{{0, 7}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`EulerRotation[{0, 0, Rational[1, 4] Pi}, 
    $CellContext`S[2, QuantumMob`Q3`$], "Label" -> "C"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`EulerRotation[{0, Rational[-1, 6] Pi, 0}, 
    $CellContext`S[2, QuantumMob`Q3`$], "Label" -> "B"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`EulerRotation[{Rational[-1, 4] Pi, Rational[1, 6] Pi, 0}, 
    $CellContext`S[2, QuantumMob`Q3`$], "Label" -> "A"], 
   QuantumMob`Q3`Phase[Rational[1, 2] Pi, 
    $CellContext`S[1, 3]]]]], "Output",
 CellLabel->"Out[397]=",
 CellID->608596782,ExpressionUUID->"6d0c2e37-b8d8-491f-9f6c-83daf491c8a3"]
}, Open  ]],

Cell["Check the result.", "TechNoteMathCaption",
 CellID->2073812678,ExpressionUUID->"400e1caa-8d97-4cf9-a57a-c4cf6e9eaf40"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", 
   RowBox[{"qc", "-", "new"}], "]"}], "//", "Chop"}]], "Input",
 CellLabel->"In[398]:=",
 CellID->1395051790,ExpressionUUID->"3f7b2ce6-ce49-4a64-a96d-22f6f3210f75"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[398]=",
 CellID->221504413,ExpressionUUID->"17edf40d-4dea-4dfe-a040-11f0e23a1822"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Unitary Gates", "TechNoteSection",
 CellTags->"Section19",
 CellID->1476129218,ExpressionUUID->"bab3cb3d-55ef-48a2-a0d4-f66516f39293"],

Cell[TextData[{
 "Here, we ",
 ButtonBox["decompose",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/GivensFactor"],
 " an arbitrary two-qubit unitary gate into factors of controlled-unitary \
gates only. This is a remarkable advantage when one tries to build a quantum \
computer as you can just focus on how to implement the CNOT gate and \
single-qubit gates. Moreover, the same idea eventually leads to the proof of \
universal quantum computation on a larger system."
}], "TechNoteText",
 CellID->1572676782,ExpressionUUID->"3787eaec-a2d5-4d94-a0aa-3e4cc90ca6b7"],

Cell[CellGroupData[{

Cell["Two-Level Unitary Transforms", "Subsection",
 CellTags->"Section20",
 CellID->749947798,ExpressionUUID->"0cf2bed3-7f30-4aa3-97c7-e74fea477450"],

Cell[TextData[{
 "Consider an arbitrary two-qubit unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "1f393b65-ec43-4020-b4f4-f4a31d003111"],
 ". In the logical basis, it is represented by a unitary matrix"
}], "TechNoteText",
 CellID->791116743,ExpressionUUID->"32b8f6bd-9688-4c73-9088-6bc0cba16ddf"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "13"], 
        SubscriptBox["U", "14"]},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "23"], 
        SubscriptBox["U", "24"]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubscriptBox["U", "33"], 
        SubscriptBox["U", "34"]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubscriptBox["U", "43"], 
        SubscriptBox["U", "44"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "5f59a1b1-223d-4084-a351-a63a22217211"],
 " ."
}], "TechNoteText",
 CellID->1227841024,ExpressionUUID->"9854e45a-d278-48fb-9e9f-1c9f0977256a"],

Cell[TextData[{
 "To break the unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d26cfe4b-65a8-413b-b0b2-f2c2cb9835cf"],
 " down into more elementary quantum logic gates, we make use of ",
 StyleBox[ButtonBox["two-level unitary transformations",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/GivensRotation"],
  FontSlant->"Italic"],
 ". A two-level unitary transformation is a unitary operation with matrix \
representation that acts only on the two columns and rows of other matrices \
or column or row vectors. The descriptive word \
\[OpenCurlyDoubleQuote]two-level\[CloseCurlyDoubleQuote] should not be \
confused with \[OpenCurlyDoubleQuote]two-qubit\[CloseCurlyDoubleQuote]. A \
two-level transformation acts on multiple qubits, but it just transforms only \
two rows or columns at a time in the representation."
}], "TechNoteText",
 CellID->1153726345,ExpressionUUID->"253b2a1e-4a8b-44c2-9e16-1bda955fb0f8"],

Cell["\<\
Let us start with a two-level unitary transformation of the form\
\>", "TechNoteText",
 CellID->1048831652,ExpressionUUID->"d3d3abee-7472-4d61-bd44-0e0a3ea40ffd"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "1"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "13", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         SubscriptBox["U", "14"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "14", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "13"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "6f1c28a9-fdcc-4674-9934-375640193ed4"],
 " "
}], "TechNoteText",
 CellID->1167800588,ExpressionUUID->"aea5ecaf-ab9b-44d2-89f2-5b1fc52cac5e"],

Cell[TextData[{
 "with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalN]", "1"], ":=", 
    SqrtBox[
     RowBox[{"|", 
      SubscriptBox["U", "13"], 
      SuperscriptBox["|", "2"], 
      RowBox[{"+", 
       RowBox[{"|", 
        SubscriptBox["U", "14"], 
        SuperscriptBox["|", "2"]}]}]}]]}], TraditionalForm]],ExpressionUUID->
  "637b051b-38dd-45b4-bd03-98e41f1f2168"],
 " such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "1"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "1", "\[Dagger]"], 
      SubscriptBox["T", "1"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"d6348b11-10d8-4664-88ab-d7081d5399a0"],
 ". When it multiplies ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "7d4142c0-2ab2-4d1f-8831-35b5029b7b99"],
 " from the right, it does not change the first two columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "2d17db0e-e97b-4724-83f5-ada0e3b0a2ec"],
 ". It only alters the last two columns, and hence the name \
\[OpenCurlyQuote]two-level transformation\[CloseCurlyQuote]. The elements in \
the lower-right sub-block of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "1"], TraditionalForm]],ExpressionUUID->
  "91da0280-7cc3-4407-8679-58e52b62c4f7"],
 " have been chosen so that the first element of the last column is \
canceled:"
}], "TechNoteText",
 CellID->1371432583,ExpressionUUID->"794c40e4-4c03-4a86-89ea-dd086772f43b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubsuperscriptBox["U", "13", 
         RowBox[{" ", "\[Prime]"}]], "0"},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubsuperscriptBox["U", "23", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubsuperscriptBox["U", "33", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubsuperscriptBox["U", "43", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "a17186bb-e548-403f-bb72-65391dbc72dd"],
 " ."
}], "TechNoteText",
 CellID->725439230,ExpressionUUID->"1bfccbf4-4479-4558-bc17-a88c286ead0a"],

Cell["\<\
Now take another two-level unitary transformation, this time, of the form\
\>", "TechNoteText",
 CellID->1192474591,ExpressionUUID->"c062f23f-e60a-40e3-8005-f91f4c0c27b1"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "2"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "12", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", "\[Prime]"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", 
           RowBox[{"\[Prime]", "*"}]}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "12"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "839cf663-1366-4f0e-959d-ab60b0fafdaf"],
 " ,"
}], "TechNoteText",
 CellID->1603057133,ExpressionUUID->"69d2618e-c983-4dd8-af3c-4db73a1b2111"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "2"], TraditionalForm]],ExpressionUUID->
  "efff6e52-574a-402a-b7ff-04577db709ce"],
 " is a normalization factor like ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "1"], TraditionalForm]],ExpressionUUID->
  "2f9cc418-cc85-49fc-acb1-31a422838c02"],
 " so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "2"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "2", "\[Dagger]"], 
      SubscriptBox["T", "2"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"7e8f61c9-d398-4e14-a463-bb3770cfbc30"],
 ". It removes ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "13", 
    RowBox[{" ", "\[Prime]"}]], TraditionalForm]],ExpressionUUID->
  "62000e4a-2e5a-49e2-96c3-4beb40e4a6c5"],
 " while keeping the first and last column as they are:"
}], "TechNoteText",
 CellID->251399069,ExpressionUUID->"b09ff867-54c1-4bcd-8fd8-173a68afee6f"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubsuperscriptBox["U", "12", "\[DoublePrime]"], "0", "0"},
       {
        SubscriptBox["U", "21"], 
        SubsuperscriptBox["U", "22", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubsuperscriptBox["U", "32", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubsuperscriptBox["U", "42", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "874ac1c0-431e-4d7c-a454-81605f326814"],
 " ."
}], "TechNoteText",
 CellID->1163819034,ExpressionUUID->"9b9860b0-a4a8-4729-be64-8c9f8f690234"],

Cell["Similarly, we go further with the two-level unitary matrix", \
"TechNoteText",
 CellID->1025447562,ExpressionUUID->"0dedeb00-1a84-44b6-99f2-6478d873bc74"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "3"], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubsuperscriptBox["U", "11", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         SubsuperscriptBox["U", "12", "\[DoublePrime]"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {
        RowBox[{
         SubsuperscriptBox["U", "12", 
          RowBox[{"\[DoublePrime]", "*"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "11"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "4fa3c628-8e6b-4357-9eed-1f91d7394101"],
 " "
}], "TechNoteText",
 CellID->1140907359,ExpressionUUID->"21a30013-27a6-485b-9ec2-7e6cb606b6ce"],

Cell[TextData[{
 "to remove element ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "12", "\[DoublePrime]"], TraditionalForm]],
  ExpressionUUID->"3bd19a70-7492-45c7-815c-2cd3f64cd5d4"],
 " and get"
}], "TechNoteText",
 CellID->348498650,ExpressionUUID->"d558fe98-82b2-49d3-995f-78bd3cf37ce3"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "3"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["U", "11", "\[Prime]\[Prime]\[Prime]"], "0", "0", 
        "0"},
       {"0", 
        SubsuperscriptBox["U", "22", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "32", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "42", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "cdf75236-477e-4bd9-9b0a-b43e6d14c1fe"],
 " ."
}], "TechNoteText",
 CellID->1028905181,ExpressionUUID->"f2bff34c-1a84-42de-970f-f421264ade5a"],

Cell[TextData[{
 "At this stage, all elements except for the first of the first column vanish \
(",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["U", "21", "\[Prime]\[Prime]\[Prime]"], "=", 
    RowBox[{
     SubsuperscriptBox["U", "31", "\[Prime]\[Prime]\[Prime]"], "=", 
     RowBox[{
      SubsuperscriptBox["U", "41", "\[Prime]\[Prime]\[Prime]"], "=", 
      "0"}]}]}], TraditionalForm]],ExpressionUUID->
  "8fdf8653-d393-479c-89df-b37c3a25ea9b"],
 ") the product ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", 
    SubscriptBox["T", "1"], 
    SubscriptBox["T", "2"], 
    SubscriptBox["T", "3"]}], TraditionalForm]],ExpressionUUID->
  "1d472b0e-599c-4350-a797-4ef506617a2c"],
 " is a unitary matrix. "
}], "TechNoteText",
 CellID->1271051423,ExpressionUUID->"d47a7c75-99b1-45c0-90e9-8e4d3ac14600"],

Cell["\<\
Repeating the procedure, we can remove all off-diagonal elements to get\
\>", "TechNoteText",
 CellID->1541429652,ExpressionUUID->"632a4ba5-ec57-4e9c-aa91-7bdaa5813c89"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "L"]}], "=", "I"}], TraditionalForm]],ExpressionUUID->
  "8802b565-4602-487a-8b97-6d00b19fa5a8"],
 " ."
}], "TechNoteText",
 CellID->1712927403,ExpressionUUID->"58943f58-80e3-4270-b505-f8a7900186c4"],

Cell[TextData[{
 "As Tj are all unitary, it enables us to rewrite ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "242841c0-e39a-4e98-92b5-63a017956792"],
 " in a combination of two-level unitary transformations, that is,"
}], "TechNoteText",
 CellID->5090539,ExpressionUUID->"f556f7f9-5af0-4c86-adcb-9614113bea2e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", "=", 
    RowBox[{
     SubsuperscriptBox["T", "L", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "2", "\[Dagger]"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}]}], TraditionalForm]],
  ExpressionUUID->"6f1d3597-bd01-49a2-b103-0c19f7b99a11"],
 " ."
}], "TechNoteText",
 CellID->1804826740,ExpressionUUID->"522d1de5-fc54-48ab-ae7f-1d7067dd8abe"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText",
 Editable->False,
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {
   "ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 FontColor->GrayLevel[0.85],
 CellID->315955750,ExpressionUUID->"f13ae6ff-ddae-43b5-bc61-acad1df4f046"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[399]:=",
 CellID->384188579,ExpressionUUID->"e3a5de42-97cf-45d8-8155-4f8ec6c894b6"],

Cell["\<\
For demonstration, consider a Hermitian operator on a two-qubit system. \
Physically, it corresponds to a transverse-field Ising model.\
\>", "TechNoteMathCaption",
 CellID->516505305,ExpressionUUID->"6cbc18ec-3a2d-4f5c-a72e-6d32ecac671b"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[400]:=",
 CellID->1721604371,ExpressionUUID->"1a51d5bb-9948-495c-b6c5-4d498064427d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "H", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[401]:=",
 CellID->775759961,ExpressionUUID->"28f859e2-9fcc-4006-b537-3ce3f21cdc7a"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowWithSeparators"]},
    "RowDefault"],
   QuantumMob`Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellLabel->"Out[401]=",
 CellID->1235509040,ExpressionUUID->"7906e074-2f41-475c-89d7-a15fcb4d8ec3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", 
      RowBox[{"-", "\[ImaginaryI]"}], 
      RowBox[{"-", "\[ImaginaryI]"}], "1"},
     {"\[ImaginaryI]", "0", "1", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"\[ImaginaryI]", "1", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"1", "\[ImaginaryI]", "\[ImaginaryI]", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {4}, {3}, {3}, {
       4}, {1}, {2}, {4}, {3}, {2}, {1}}}, {
      2, Complex[0, -1], Complex[0, -1], 1, 0, Complex[0, 1], Complex[0, -1], 
       1, 0, Complex[0, -1], Complex[0, 1], 1, -2, Complex[0, 1], Complex[
       0, 1], 1}}]]]]], "Output",
 CellLabel->"Out[402]//MatrixForm=",
 CellID->1181052437,ExpressionUUID->"106710c5-d8b2-4c77-a0a6-606f09f327c0"]
}, Open  ]],

Cell["\<\
This is the unitary operator generated by the above Hermitian operator.\
\>", "TechNoteMathCaption",
 CellID->595736468,ExpressionUUID->"41b0544d-efe6-4018-bda3-52c7cd855b63"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", " ", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[403]:=",
 CellID->974055362,ExpressionUUID->"01fb972e-032c-4fca-b01d-92a2e2059c87"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  QuantumMob`Q3`MultiplyExp[Complex[0, 
     Rational[-1, 4]] Pi (QuantumMob`Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellLabel->"Out[403]=",
 CellID->756959438,ExpressionUUID->"4f1b41c7-f298-4e39-99ee-60d46a91a6ab"]
}, Open  ]],

Cell[TextData[{
 "This shows the matrix representation of ",
 StyleBox["U", "Input"],
 " in the logical basis."
}], "TechNoteMathCaption",
 CellID->1817782849,ExpressionUUID->"62e71134-ee0e-479d-b8d1-71da1c7460f5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "U", "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[404]:=",
 CellID->1373980921,ExpressionUUID->"5303768a-8b59-4d4a-a345-7d6e10ced45b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[405]//MatrixForm=",
 CellID->524149638,ExpressionUUID->"823d995e-26da-41bf-98e3-55b13e5229c4"]
}, Open  ]],

Cell[TextData[{
 "This shows the decomposition of the unitary matrix into two-level matrices \
(displaying the first three elements). For the purpose of efficiency, the \
resulting list is given in terms of ",
 StyleBox["GivensRotation", "Input"],
 "."
}], "TechNoteMathCaption",
 CellID->642635412,ExpressionUUID->"207181ae-beba-4925-a8a8-2fd300e0354c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"GivensFactor", "[", 
     RowBox[{
      RowBox[{"N", "@", "mat"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "//", "Chop"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"twl", "[", 
  RowBox[{"[", 
   RowBox[{";;", "4"}], "]"}], "]"}]}], "Input",
 CellLabel->"In[406]:=",
 CellID->1078108721,ExpressionUUID->"f5f91959-a81a-4491-bf6f-7492da57083b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.18898223650461365`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"-", "0.566946709513841`"}], "-", 
                    RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.566946709513841`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"0.18898223650461365`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}],
                     "}"}]}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    QuantumMob`Q3`GivensRotation[{{Complex[
      0.18898223650461365`, -0.5669467095138409], 
      Complex[-0.566946709513841, -0.566946709513841]}, {Complex[
      0.566946709513841, -0.566946709513841], Complex[0.18898223650461365`, 
      0.5669467095138409]}}, {3, 4}, {
      $CellContext`S[1, QuantumMob`Q3`$], 
      $CellContext`S[2, QuantumMob`Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.1622214211307625`"}], "+", 
                    RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
                    ",", "0.8583950752789522`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.8583950752789522`"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.1622214211307625`"}], "-", 
                    RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}]}],
                     "}"}]}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    QuantumMob`Q3`GivensRotation[{{
       Complex[-0.1622214211307625, 0.4866642633922876], 
       0.8583950752789522}, {-0.8583950752789522, 
       Complex[-0.1622214211307625, -0.4866642633922876]}}, {2, 3}, {
      $CellContext`S[1, QuantumMob`Q3`$], 
      $CellContext`S[2, QuantumMob`Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.2525381361380527`"}], "-", 
                    RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}], 
                    ",", "0.9340497736158587`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.9340497736158587`"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.2525381361380527`"}], "+", 
                    
                    RowBox[{"0.25253813613805276`", " ", 
                    "\[ImaginaryI]"}]}]}], "}"}]}], "}"}], "SummaryItem"]}]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    QuantumMob`Q3`GivensRotation[{{
       Complex[-0.2525381361380527, -0.25253813613805276`], 
       0.9340497736158587}, {-0.9340497736158587, 
       Complex[-0.2525381361380527, 0.25253813613805276`]}}, {3, 4}, {
      $CellContext`S[1, QuantumMob`Q3`$], 
      $CellContext`S[2, QuantumMob`Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], "}"}]], "Output",
 CellLabel->"Out[407]=",
 CellID->405045872,ExpressionUUID->"66521806-ceee-477a-bcd6-1dcd00d9a55b"]
}, Open  ]],

Cell[TextData[{
 "For a more intuitive form, you can convert ",
 StyleBox["GivensRotation", "Input"],
 " into the normal matrix form using ",
 StyleBox["Matrix", "Input"],
 ". Here the first three are shown."
}], "TechNoteMathCaption",
 CellID->1155771237,ExpressionUUID->"2fe65439-eb54-4b2b-8d2b-173343d2bb80"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Chop", "[", 
   RowBox[{"Matrix", "/@", 
    RowBox[{"twl", "[", 
     RowBox[{"[", 
      RowBox[{";;", "3"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[408]:=",
 CellID->1057593144,ExpressionUUID->"bde05cd5-0906-4d58-984c-1355dcf61ebc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0"},
       {"0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {2, 2}, 0, {1, {{0, 1, 2}, {{1}, {2}}}, {1., 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.18898223650461365`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.566946709513841`"}], "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.566946709513841`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.18898223650461365`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.18898223650461365`, -0.5669467095138409], 
         Complex[-0.566946709513841, -0.566946709513841], Complex[
         0.18898223650461365`, 0.5669467095138409], Complex[
         0.566946709513841, -0.566946709513841]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.1622214211307625`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789522`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789522`"}], 
        RowBox[{
         RowBox[{"-", "0.1622214211307625`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-0.1622214211307625, 0.4866642633922876], 
         0.8583950752789522, 
         Complex[-0.1622214211307625, -0.4866642633922876], \
-0.8583950752789522, 1}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[408]=",
 CellID->82809714,ExpressionUUID->"14edabea-c7b6-424e-ae13-a5c069219a6a"]
}, Open  ]],

Cell["Indeed, they reconstruct the original matrix.", "TechNoteMathCaption",
 CellID->1969536942,ExpressionUUID->"5b9f9e8e-288b-4aea-9f8a-1c9e9018782b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "[", "twl", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[409]:=",
 CellID->694449336,ExpressionUUID->"35c8cadf-9bed-415b-9142-2c12673fbe5f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[410]//MatrixForm=",
 CellID->213459942,ExpressionUUID->"1c4dd79e-3d9b-4170-9f4b-f806cedf3f6b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Two-Level Unitary Transformations with Controlled-Unitary Gates\
\>", "Subsection",
 CellTags->"Section22",
 CellID->1363502801,ExpressionUUID->"e5b542f4-32cf-4ea2-a7d6-d4680c28b41e"],

Cell["\<\
We are still to express the two-level unitary transformations in terms of \
controlled-unitary gates. The two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->593579270,ExpressionUUID->"5699f043-f014-468c-a3b8-e42798947365"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "a93c7c33-6456-4370-bb8e-4be21329f131"],
 " "
}], "TechNoteText",
 CellID->1225250575,ExpressionUUID->"53230fa2-e29d-45cd-b98c-b6730cddbf77"],

Cell["\<\
is already in the form of the matrix representation of a controlled-unitary \
gate, and just corresponds to a single controlled-unitary\
\>", "TechNoteText",
 CellID->565722942,ExpressionUUID->"77bb9670-ae0e-4f59-9725-9e019871301e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "6b5f435d-aa2e-419f-9da3-2b91c1967ded"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "2daf1fd0-1fe2-4824-be14-4ad3f34634a0"],
 "."
}], "TechNoteText",
 CellID->1195380925,ExpressionUUID->"1312d770-4d7c-43ff-b0e2-2c39f70e0d11"],

Cell["A two-level unitary matrix of the form", "TechNoteText",
 CellID->1057688790,ExpressionUUID->"b880b490-c4eb-475e-9bec-c03214fabf17"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "920bbfa5-6cb5-4efd-966d-66394f14b1a3"],
 " "
}], "TechNoteText",
 CellID->1853347311,ExpressionUUID->"51d508b0-8b2e-4035-8ce4-0b696215aad5"],

Cell["\<\
also corresponds to a single controlled-unitary gate with the control and \
target qubit exchanged. Here, the first qubit is the target qubit and the \
second the control qubit:\
\>", "TechNoteText",
 CellID->2105439889,ExpressionUUID->"04171f2f-2b0f-4539-9b47-0e9d0a0334ac"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "b1a5bd3d-551d-4939-a886-f34be5b62d1f"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "b1739996-27f7-4676-a8ef-b0334dff2a37"],
 "."
}], "TechNoteText",
 CellID->2040162804,ExpressionUUID->"3b9ce46d-ee93-462e-ad8f-9a48450510b4"],

Cell["\<\
\tMore complicated is the two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->144855179,ExpressionUUID->"3f7cd82f-449c-48fe-bb36-5df6ae90bd77"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "6782a228-ce3c-4913-8c62-7fe3bfb1616f"],
 " . "
}], "TechNoteText",
 CellID->1482021402,ExpressionUUID->"f3821380-6dd0-40a7-ad3b-f11d8bda8773"],

Cell["\<\
As it affects both qubits, it cannot be represented by a single \
controlled-unitary gate. However, it is possible to bring it to the second of \
the above two forms by simultaneously exchanging the last two columns and \
rows.\
\>", "TechNoteText",
 CellID->1818365508,ExpressionUUID->"a9ace18d-06ea-43f7-8656-010150f3bc8c"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], "0", 
        SubscriptBox["U", "12"]},
       {"0", "0", "1", "0"},
       {"0", 
        SubscriptBox["U", "21"], "0", 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "7ac909a3-4e6d-4d89-8812-d64f295d6503"],
 " . "
}], "TechNoteText",
 CellID->429312499,ExpressionUUID->"eb5dac6c-0ead-414c-8b33-c58af9397e08"],

Cell["\<\
The specified exchanges correspond to flipping the bit values of the second \
qubit only when the first qubit has a value of 1, and they can be implemented \
by applying the CNOT gate with the first qubit as the control qubit and the \
second qubit as the target qubit. These observations lead to the following \
equivalence,\
\>", "TechNoteText",
 CellID->2057600420,ExpressionUUID->"6e82bdbc-31d7-4fef-8b1f-a6688a9b3870"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "4e8d8b88-abb4-460b-bf72-5effd30c0753"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "66cd9750-9d53-4204-8edf-bcb0882cb433"],
 ". "
}], "TechNoteText",
 CellID->1161091299,ExpressionUUID->"b10f498f-09e3-4dd0-a957-d99905c4fd60"],

Cell["\<\
which allows us to implement the two-level unitary transformation with two \
CNOT gates and a controlled-unitary gate.\
\>", "TechNoteText",
 CellID->277562004,ExpressionUUID->"ca4bf9a9-e3e3-4f0d-b7d4-c9c746bc75af"],

Cell["\<\
Of course, the way is not unique. For example, it is also possible to bring \
the same two-level unitary matrix to the first two-level unitary form, this \
time, by simultaneously exchanging the second and fourth columns and rows.\
\>", "TechNoteText",
 CellID->650119944,ExpressionUUID->"7c2c3129-4a4f-4334-8fa6-b1b9d0abfb10"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "21"]},
       {"0", "0", 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "11"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "dd2467f9-ae64-48d7-a536-ca8ee47147a9"],
 " . "
}], "TechNoteText",
 CellID->169102872,ExpressionUUID->"ccd6c297-7555-4905-8498-97fdb836a2e5"],

Cell[TextData[{
 "These exchanges correspond to flipping the bit values of the first qubit \
only when the second qubit has a value of 1, that is, to applying the CNOT \
gate with the second qubit as the control qubit and the first qubit as the \
target qubit. Note that in this case, unitary matrix ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "8932526a-f0f2-4fc5-8ffb-4209c80b9e7f"],
 " itself is modified through the exchanges, and the rows and columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "9fbf240d-faf3-4cb4-9228-f94020692a91"],
 " are exchanged. This is equivalent to the basis change by the Pauli X \
matrix, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", "\[RightArrow]", " ", 
     SuperscriptBox[
      RowBox[{"U", " "}], "\[Prime]"]}], " ", "=", " ", 
    RowBox[{"X", " ", "U", " ", "X"}]}], TraditionalForm]],ExpressionUUID->
  "d0e3efa1-288c-4a31-9ee5-1cfb8d622f4d"],
 ". Putting all together, the two-level unitary matrix is implemented as"
}], "TechNoteText",
 CellID->991104723,ExpressionUUID->"30b7ca33-a12f-4351-a439-12f92195d21f"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "f863e7ef-6368-4149-b212-9e1497e0ebc8"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U'\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "a0ed6a95-eedc-4e0b-86d5-9cd74cd47178"],
 ". "
}], "TechNoteText",
 CellID->1613913329,ExpressionUUID->"6d19a9a3-f985-4dd3-b485-358bcacf6716"],

Cell["\<\
\tIn a similar manner, we can implement another form of two-level unitary \
matrix as\
\>", "TechNoteText",
 CellID->175375246,ExpressionUUID->"3591cb85-2f23-4f49-8906-73360b0a409c"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["U", "11"], "0", "0", 
       SubscriptBox["U", "12"]},
      {"0", "1", "0", "0"},
      {"0", "0", "1", "0"},
      {
       SubscriptBox["U", "21"], "0", "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "8e6bbb24-aa6d-4752-ac40-4ef4cf8be467"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{4, -2}, {4, -1}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, ImageScaled[{0.5, 0.5}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->295.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "35f43011-35bf-4891-861e-6f10c0aa5967"],
 "= ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{5, -2}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -1}, ImageScaled[{0.5, 0.5}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -1}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->367.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "7b26aade-9cdd-41e7-becf-b066d5ab8c8a"],
 "."
}], "TechNoteText",
 CellID->1184195838,ExpressionUUID->"76241642-3c09-4df2-8cd1-627d66b03f08"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText",
 Editable->False,
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {
   "ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 FontColor->GrayLevel[0.85],
 CellID->1989239018,ExpressionUUID->"5b45388d-8805-481c-831d-2e02d83dca39"],

Cell["\<\
For a demonstration, consider a single-qubit rotation around the y-axis.\
\>", "TechNoteText",
 CellID->2048492517,ExpressionUUID->"57f0c43b-0449-4888-814c-357c5908d90c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "U", "]"}], "//", "ExpToTrig"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[411]:=",
 CellID->555904515,ExpressionUUID->"d709d77c-e9a4-499f-aed9-5135318edf27"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[412]//MatrixForm=",
 CellID->1323554704,ExpressionUUID->"9f21d901-4e7a-4e7e-9288-9a0b9bb9fe4f"]
}, Open  ]],

Cell["\<\
This is the two-level unitary transformation to be implemented with \
elementary gates.\
\>", "TechNoteMathCaption",
 CellID->691274085,ExpressionUUID->"7999b5ad-f279-457b-a539-9b4c9e06a7da"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"GivensRotation", "[", 
    RowBox[{
     RowBox[{"Matrix", "[", "U", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "op", "]"}], "//", "ExpToTrig"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[413]:=",
 CellID->357016325,ExpressionUUID->"37598014-6a16-41c4-beba-823d0101130a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 3, 4, 6}, {{1}, {4}, {2}, {3}, {4}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], 1, 1, Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[414]//MatrixForm=",
 CellID->1348294502,ExpressionUUID->"f00a382a-3464-4e9a-9cec-c6e35e862782"]
}, Open  ]],

Cell["This quantum circuit shows one implementation.", "TechNoteMathCaption",
 CellID->1549413286,ExpressionUUID->"0fea9c36-89f2-4b42-a217-1f5529fb8d13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Spacer\>\"", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[415]:=",
 CellID->602394280,ExpressionUUID->"fcad81b4-a9b5-47b6-86f6-6b594928cc17"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   ImagePadding->{{5.76, 5.76}, {7.2, 7.2}},
   ImageSize->295.2,
   PlotRange->{{0, 8}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], "Spacer", 
   $CellContext`S[2, 1], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$], "Label" -> "U"]], 
   $CellContext`S[2, 1], "Spacer", 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], "PortSize" -> 0.1]]], "Output",
 CellLabel->"Out[415]=",
 CellID->538251970,ExpressionUUID->"ede612c6-e94f-4fac-98bf-c9f2934d589f"]
}, Open  ]],

Cell["This is another implementation.", "TechNoteMathCaption",
 CellID->389328403,ExpressionUUID->"c0745d03-b529-44dd-a05c-30f7f268ad08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Spacer\>\"", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[416]:=",
 CellID->59796812,ExpressionUUID->"fa2b6155-b557-4676-9f52-693d004c214b"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -1}}], 
     DiskBox[{5, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{5.76, 5.76}, {7.2, 7.2}},
   ImageSize->367.2,
   PlotRange->{{0, 10}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 1], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   $CellContext`S[1, 1], "Spacer", 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$], "Label" -> "U"]], "Spacer", 
   $CellContext`S[1, 1], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   $CellContext`S[1, 1], "PortSize" -> 0.1]]], "Output",
 CellLabel->"Out[416]=",
 CellID->1199738626,ExpressionUUID->"63b015a4-5259-437d-99a9-948e532cc435"]
}, Open  ]],

Cell["\<\
Check the equivalence of the two-level unitary matrix and the implementations\
\
\>", "TechNoteMathCaption",
 CellID->834281808,ExpressionUUID->"46edec55-f6d6-4e04-a64a-611c8037eac0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc1", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc2", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[417]:=",
 CellID->853615793,ExpressionUUID->"c16b3430-1ffd-4251-a73c-9e27af2564e7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[417]//MatrixForm=",
 CellID->1283125499,ExpressionUUID->"1eafba99-8037-4658-9d67-a8ed458d570f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[418]//MatrixForm=",
 CellID->459478519,ExpressionUUID->"5f6fa7a0-2fe8-4af3-827b-43fedecabc05"]
}, Open  ]],

Cell[TextData[{
 "So far, we have determined the implementations of 4 \[Times] 4 two-level \
unitary matrices of different forms just by inspection, that is, in an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " manner. For more than two qubits, the size of the two-level unitary \
matrices is much larger, and it is difficult to find proper implementations \
in such a way. Fortunately, there is a ",
 ButtonBox["systematic way based on the Gray code",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/GivensFactor"],
 "."
}], "TechNoteText",
 CellID->645391397,ExpressionUUID->"392931d9-f2c6-4835-929d-d418d52876ce"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demonstration", "Subsection",
 CellTags->"Section23",
 CellID->153308382,ExpressionUUID->"84d4768a-6ac3-4991-af7e-eef9db27ba4d"],

Cell["\<\
In the above, we have shown that an arbitrary two-qubit unitary gate can be \
carried out by first decomposing its matrix representation into two-level \
unitary matrices and then implementing the two-level unitary matrices by \
means of the CNOT and controlled-unitary gates. Here we demonstrate the whole \
procedure.\
\>", "TechNoteText",
 CellID->1821083521,ExpressionUUID->"1e1c2310-c205-4cd3-b451-324b912811cb"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[419]:=",
 CellID->255167231,ExpressionUUID->"41570c88-cec2-45f7-9c8f-485217848933"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[420]:=",
 CellID->370132468,ExpressionUUID->"bb6de47f-7689-426a-a695-da292aef2098"],

Cell["\<\
Consider a two-qubit model. Physically, it describes two qubits coupled with \
each other through an Ising-type couping and subject to an external magnetic \
field..\
\>", "TechNoteMathCaption",
 CellID->1013800403,ExpressionUUID->"3c80b063-2ef0-4e91-9eab-5449efcf733a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}]], "Input",
 CellLabel->"In[421]:=",
 CellID->808117923,ExpressionUUID->"a00ba718-7d35-4961-952b-969eb43e0fd0"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowWithSeparators"]},
    "RowDefault"],
   QuantumMob`Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellLabel->"Out[421]=",
 CellID->104274221,ExpressionUUID->"a4b2cdbf-2ec1-46f2-aeba-9f6ff6b9ab0e"]
}, Open  ]],

Cell["\<\
We are interested in simulating the time-evolution operator governed by the \
above Hamiltonian.\
\>", "TechNoteMathCaption",
 CellID->322701359,ExpressionUUID->"13b9a43d-1a35-4c2a-af69-c3b03875667c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", "*", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[422]:=",
 CellID->1245532038,ExpressionUUID->"f1dfab23-28d3-4727-bd08-55bf9c2ff2a8"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  QuantumMob`Q3`MultiplyExp[Complex[0, 
     Rational[-1, 4]] Pi (QuantumMob`Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellLabel->"Out[422]=",
 CellID->190176395,ExpressionUUID->"a34a9d44-2533-452d-96ac-b59164e0f869"]
}, Open  ]],

Cell["\<\
This is the 4\[Times]4 unitary matrix to implement in terms of elementary \
gates.\
\>", "TechNoteMathCaption",
 CellID->730080199,ExpressionUUID->"a1e463bb-57e9-4904-8798-e618ec0350e3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"U", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[423]:=",
 CellID->1883829282,ExpressionUUID->"6ce9e8e8-bef0-4aab-a87c-bba10811b866"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[424]//MatrixForm=",
 CellID->839004029,ExpressionUUID->"557013e5-d705-4ae5-9c7a-eb746e5cedd4"]
}, Open  ]],

Cell["\<\
First, decompose the 4\[Times]4 unitary matrix into the two-level unitary \
matrices.\
\>", "TechNoteMathCaption",
 CellID->2133759026,ExpressionUUID->"aeab08d5-1b15-46d3-a855-34ac171902ef"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"GivensFactor", "[", 
     RowBox[{
      RowBox[{"N", "@", "mat"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Chop", "@", 
   RowBox[{"Matrix", "[", "twl", "]"}]}]}]}], "Input",
 CellLabel->"In[425]:=",
 CellID->1258528729,ExpressionUUID->"ef23ceed-1e4b-453f-bbca-0fce029b38fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", "1.`", "0", "0"},
       {"0", "0", "1.`", "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1., 1., 1., 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.9999999999999999`", "0", "0", "0"},
       {"0", "0.9999999999999999`", "0", "0"},
       {"0", "0", 
        RowBox[{"0.18898223650461354`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.566946709513841`"}], "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.566946709513841`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.18898223650461354`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        0.9999999999999999, 0.9999999999999999, Complex[
         0.18898223650461354`, -0.5669467095138409], 
         Complex[-0.566946709513841, -0.566946709513841], Complex[
         0.566946709513841, -0.566946709513841], Complex[
         0.18898223650461354`, 0.5669467095138409]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789522`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789522`"}], 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {
        1., Complex[-0.16222142113076243`, 0.4866642633922876], 
         0.8583950752789522, -0.8583950752789522, 
         Complex[-0.16222142113076243`, -0.4866642633922876], 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", "1.`", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.25253813613805276`"}], "-", 
         RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}], 
        "0.9340497736158587`"},
       {"0", "0", 
        RowBox[{"-", "0.9340497736158587`"}], 
        RowBox[{
         RowBox[{"-", "0.25253813613805276`"}], "+", 
         RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        1., 1., Complex[-0.25253813613805276`, -0.25253813613805276`], 
         0.9340497736158587, -0.9340497736158587, 
         Complex[-0.25253813613805276`, 0.25253813613805276`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.35355339059327384`"}], "-", 
         RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], 
        "0.7264831572567789`", "0", "0"},
       {
        RowBox[{"-", "0.7264831572567789`"}], 
        RowBox[{
         RowBox[{"-", "0.35355339059327384`"}], "+", 
         RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1.`", "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {1}, {2}, {3}, {4}}}, {
        Complex[-0.35355339059327384`, -0.5892556509887896], 
         0.7264831572567789, -0.7264831572567789, 
         Complex[-0.35355339059327384`, 0.5892556509887896], 1., 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789521`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789521`"}], 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {
        1., Complex[-0.16222142113076243`, 0.4866642633922876], 
         0.8583950752789521, -0.8583950752789521, 
         Complex[-0.16222142113076243`, -0.4866642633922876], 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.9999999999999999`", "0", "0", "0"},
       {"0", "0.9999999999999999`", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.18898223650461354`"}], "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.5669467095138409`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.5669467095138409`"}], "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.18898223650461354`"}], "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        0.9999999999999999, 0.9999999999999999, 
         Complex[-0.18898223650461354`, 0.5669467095138409], Complex[
         0.5669467095138409, -0.5669467095138409], 
         Complex[-0.5669467095138409, -0.5669467095138409], 
         Complex[-0.18898223650461354`, -0.5669467095138409]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[426]=",
 CellID->763089201,ExpressionUUID->"c54571ce-4921-48f0-9080-1585378f6494"]
}, Open  ]],

Cell[TextData[{
 "Next, rewrite the two-level unitary matrices in terms of the CNOT and \
controlled-unitary gates. The first element of list ",
 StyleBox["twl", "Input"],
 " happens to be the identity matrix in this case, and it is excluded in the \
further analysis."
}], "TechNoteMathCaption",
 CellID->702850526,ExpressionUUID->"cd61ad7c-5883-43f9-a3c0-fb2aae181b15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Unfold", "/@", 
   RowBox[{"Rest", "[", "twl", "]"}]}]}]], "Input",
 CellLabel->"In[427]:=",
 CellID->1648731982,ExpressionUUID->"a020634d-7149-4527-834e-be7fa1f547fd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
      Complex[0.18898223650461365`, 0.] + 
      Complex[0., -0.566946709513841] $CellContext`S[2, 1] + 
      Complex[0., -0.566946709513841] $CellContext`S[2, 2] + 
      Complex[0., -0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
       LineBox[{{1, -2}, {1, -1}}], 
       DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
        LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
           1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
       LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.1],
         FontWeight->"Light",
         FontSlant->Italic], {2., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{3, -2}, {3, -1}}], 
       DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
        LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
           3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->190.79999999999998`,
     PlotRange->{{0, 4}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
       $CellContext`S[1, QuantumMob`Q3`$]}], 
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
      Complex[-0.1622214211307625, 0.] + 
      Complex[0., -0.8583950752789522] $CellContext`S[2, 2] + 
      Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
     
     QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
       $CellContext`S[1, QuantumMob`Q3`$]}]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
      Complex[-0.2525381361380527, 0.] + 
      Complex[0., 6.466853413996861*^-17] $CellContext`S[2, 1] + 
      Complex[0., 0.9340497736158587] $CellContext`S[2, 2] + 
      Complex[0., -0.25253813613805276`] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{1, -1}, 0.09]}, 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 0}, 
      Complex[-0.35355339059327373`, 0.] + 
      Complex[0., 0.7264831572567789] $CellContext`S[2, 2] + 
      Complex[0., -0.5892556509887896] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
       LineBox[{{1, -2}, {1, -1}}], 
       DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
        LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
           1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
       LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.1],
         FontWeight->"Light",
         FontSlant->Italic], {2., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{3, -2}, {3, -1}}], 
       DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
        LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
           3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->190.79999999999998`,
     PlotRange->{{0, 4}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
       $CellContext`S[1, QuantumMob`Q3`$]}], 
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
      Complex[-0.1622214211307625, 0.] + 
      Complex[0., 1.910269724657813*^-17] $CellContext`S[2, 1] + 
      Complex[0., -0.8583950752789521] $CellContext`S[2, 2] + 
      Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
     
     QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
       $CellContext`S[1, QuantumMob`Q3`$]}]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
      Complex[-0.18898223650461357`, 0.] + 
      Complex[0., -0.5669467095138409] $CellContext`S[2, 1] + 
      Complex[0., 0.5669467095138409] $CellContext`S[2, 2] + 
      Complex[0., 0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
      "U"]]]}], "}"}]], "Output",
 CellLabel->"Out[427]=",
 CellID->467861323,ExpressionUUID->"b28b6d43-bc4a-4a54-8ca9-4446ef249bef"]
}, Open  ]],

Cell["\<\
This shows the overall quantum circuit model. Here the same label \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] has been used for different \
controlled-unitary gates just for convenience. Do not forget to reverse the \
order before plugging the gates in the quantum circuit model.\
\>", "TechNoteMathCaption",
 CellID->328948492,ExpressionUUID->"b12c4f67-9ba3-46b1-b433-4e6a70b751b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"Reverse", "@", "gates"}]}]}]], "Input",
 CellLabel->"In[428]:=",
 CellID->1014397666,ExpressionUUID->"d4d00fba-0612-47a6-8ec6-506cf26f6e16"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
     LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
         4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
     LineBox[{{5, -1}, {5, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{5, -1}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -1}, {6, -2}}], 
     DiskBox[{6, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -1}}], 
     DiskBox[{7, -2}, 0.09], {CircleBox[{7, -1}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -1}, {7.266666666666667, -1}}, {{
         7, -1.2666666666666666`}, {7, -0.7333333333333334}}}]}}, {
     LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -2}, {9, -1}}], 
     DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
         9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
     LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->442.8,
   PlotRange->{{0, 11}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[-0.18898223650461357`, 0.] + 
    Complex[0., -0.5669467095138409] $CellContext`S[2, 1] + 
    Complex[0., 0.5669467095138409] $CellContext`S[2, 2] + 
    Complex[0., 0.5669467095138409] $CellContext`S[2, 3], "Label" -> "U"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[-0.1622214211307625, 0.] + 
    Complex[0., 1.910269724657813*^-17] $CellContext`S[2, 1] + 
    Complex[0., -0.8583950752789521] $CellContext`S[2, 2] + 
    Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 0}, 
    Complex[-0.35355339059327373`, 0.] + 
    Complex[0., 0.7264831572567789] $CellContext`S[2, 2] + 
    Complex[0., -0.5892556509887896] $CellContext`S[2, 3], "Label" -> "U"], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[-0.2525381361380527, 0.] + 
    Complex[0., 6.466853413996861*^-17] $CellContext`S[2, 1] + 
    Complex[0., 0.9340497736158587] $CellContext`S[2, 2] + 
    Complex[0., -0.25253813613805276`] $CellContext`S[2, 3], "Label" -> "U"], 
   
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[-0.1622214211307625, 0.] + 
    Complex[0., -0.8583950752789522] $CellContext`S[2, 2] + 
    Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[0.18898223650461365`, 0.] + 
    Complex[0., -0.566946709513841] $CellContext`S[2, 1] + 
    Complex[0., -0.566946709513841] $CellContext`S[2, 2] + 
    Complex[0., -0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
    "U"]]]], "Output",
 CellLabel->"Out[428]=",
 CellID->1407623994,ExpressionUUID->"3be05fe6-e4c7-431c-9f1d-1a3aff15d392"]
}, Open  ]],

Cell["\<\
Check the above quantum circuit by converting it into the matrix \
representation.\
\>", "TechNoteMathCaption",
 CellID->608232459,ExpressionUUID->"9441bd59-b757-4b03-9637-ee3d8a1ef6d5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[429]:=",
 CellID->540778693,ExpressionUUID->"8b6c88d2-b159-4e99-8104-96d7b10b991b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "-", 
       RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11785113019775788`"}], "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1178511301977579`"}], "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.11785113019775788`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11785113019775796`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "-", 
       RowBox[{"0.5892556509887898`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3535533905932737`"}], "-", 
       RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.11785113019775796`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "-", 
       RowBox[{"0.5892556509887897`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3535533905932737`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1178511301977579`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3535533905932739`"}], "-", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327384`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327395`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327384`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "+", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[430]//MatrixForm=",
 CellID->1256611806,ExpressionUUID->"c201cc3a-5148-4c5a-a254-03db620e840d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "mat"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellLabel->"In[431]:=",
 CellID->326787606,ExpressionUUID->"84631015-a5ca-4e18-8dd0-3515c7860694"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[431]//MatrixForm=",
 CellID->1520438844,ExpressionUUID->"a921c1d3-4143-477f-b958-24cb263ab471"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]],
          "TutorialMoreAbout",ExpressionUUID->
         "58efc310-0ecf-4045-8bb7-b0677afa09e8"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"d380ba9b-fa51-4bff-adcf-\
522775847f6c"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "ee0d7138-5924-44a4-a6f5-09213ec40109"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "d2f63214-d78c-4fe2-8659-60a6280140ae"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"c54abde4-d7f3-4853-aaf6-\
bd2b1bc52814"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. M. Greenberger, M. A. Horne, and A. Zeilinger \
(1989)"}]]]], "http://arxiv.org/abs/0712.0921"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "bfac43cb-fbae-4d05-816b-a3f4be9f9195"]}]],ExpressionUUID->
         "e2f85d8d-b9c5-473a-96e9-598efac7f810"],
        " , \[OpenCurlyDoubleQuote]Going beyond Bell\[CloseCurlyQuote]s \
theorem,\[CloseCurlyDoubleQuote] in Bell\[CloseCurlyQuote]s Theorem, Quantum \
Theory, and Conceptions of the Universe, edited by Kafatos, M. (Kluwer \
Academic, Dordrecht, The Netherlands, 1989)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "30cc8583-e1c3-4e48-8237-3e359a29f3c3"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. Bouwmeester, J.-W. Pan, M. Daniell, H. Weinfurter, and \
A. Zeilinger (1999)"}]]]], "https://doi.org/10.1103/PhysRevLett.82.1345"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "8db7f2a8-f17e-49a6-9a55-07005d8237c4"]}]],ExpressionUUID->
         "e0739c72-82cf-4fc4-a543-09a4031de7d2"],
        ", Phys. Rev. Lett. 82, 1345 (1999), \
\[OpenCurlyDoubleQuote]Observation of Three-Photon Greenberger- \
Horne-Zeilinger Entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "44eb5b59-b122-492e-ac58-6f1fb1b7bd70"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J.-W. Pan, D. Bouwmeester, M. Daniell, H. Weinfurter, and \
A. Zeilinger (2000)"}]]]], "https://doi.org/10.1038/35000514"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "bd493533-03d0-4c12-87ca-f791d40515cb"]}]],ExpressionUUID->
         "d8a8f457-09ab-48a4-b2bd-4119c7ebd3ee"],
        ", Nature 403, 515 (2000), \[OpenCurlyDoubleQuote]Experimental test \
of quantum nonlocality in three-photon Greenberger-Horne-Zeilinger \
entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "ccaedfc0-9c7b-4aba-9b7d-0b8f27663a03"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "925d9a27-69f6-4aa1-9f8f-0b35b9937765"]}]],ExpressionUUID->
         "bff4a5a3-9467-477b-ab83-e0b20af7263d"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "5027770d-f315-4ad9-a2ad-10aa51e52dcd"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "ae8cca28-ac4d-4e70-95ac-63f55b658f2d"]}]],ExpressionUUID->
         "b6e37a00-45e8-41cc-90b9-81e6faa89427"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "0ee2c31c-6e62-4aeb-820e-f93f7525798a"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"e69f9396-44e8-4441-a467-\
19264a7cf0bc"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"7d64f766-f332-431b-aa24-d818260b4690"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Two-Qubit Gates",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 9, 1, 20, 56, 29.271023}", 
    "history" -> {"12", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {"quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Tech Note", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3", "status" -> "None", "summary" -> 
    "This document introduces quantum logic gate operations acting on two \
qubits. Such operations are represented by 4*4 unitary matrices. We will see \
that any two-qubit gate operations can be decomposed into controlled-unitary \
gates. A controlled-unitary gate acts a unitary operator on one qubit \
depending on the logical state of the other qubit. A controlled-unitary gate \
on two qubits can be further decomposed into factors including only the CNOT \
gate and single-qubit rotation gates. In this sense, the CNOT gate alone is \
sufficient for any two-qubit gate. The controlled-unitary and CNOT gates have \
various interesting properties that make them useful in implementing quantum \
algorithms. In this document, we first examine the basic properties of the \
CNOT gate, and in particular, how it is used to generate an entanglement \
between two qubits. Then, we discuss the properties of the controlled-unitary \
gate and describe how to implement a controlled-unitary gate in terms of the \
CNOT gate and single-qubit rotations. Finally, we discuss how an arbitrary \
two-qubit unitary operation can be decomposed into controlled-unitary gates. \
See also Section 2.2 of the Quantum Workbook (2022).", "synonyms" -> {}, 
    "tabletags" -> {}, "title" -> "Two-Qubit Gates", "titlemodifier" -> "", 
    "metadescription" -> "", "windowtitle" -> "Two-Qubit Gates", "type" -> 
    "Tech Note", "uri" -> "QuantumMob/Q3/tutorial/TwoQubitGates"}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"7504b473-7513-4ef5-af2b-7adec2c37fd8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Section11"->{
  Cell[18043, 449, 153, 2, 70, "TechNoteSection",ExpressionUUID->"201818e8-83ff-4057-9d12-ec58bd170abf",
   CellTags->"Section11",
   CellID->1585062394]},
 "Section12"->{
  Cell[98974, 2632, 147, 2, 70, "TechNoteSection",ExpressionUUID->"b80279f3-54b1-45e4-baa2-22a100383ef9",
   CellTags->"Section12",
   CellID->29167796]},
 "Section13"->{
  Cell[119761, 3196, 136, 2, 70, "TechNoteSection",ExpressionUUID->"e7ecdaea-2089-4845-9b9a-fbbc412cd62d",
   CellTags->"Section13",
   CellID->1218939314]},
 "Section14"->{
  Cell[153122, 4112, 151, 2, 70, "TechNoteSection",ExpressionUUID->"b6d8aacc-df24-42df-9403-1d9e2ad0efdf",
   CellTags->"Section14",
   CellID->1455445268]},
 "Section15"->{
  Cell[153298, 4118, 132, 2, 70, "Subsection",ExpressionUUID->"3fad6138-e0f1-4fea-b6e1-6173aa86077c",
   CellTags->"Section15",
   CellID->1829879946]},
 "Section16"->{
  Cell[180647, 4864, 138, 2, 70, "Subsection",ExpressionUUID->"ee3a3a70-5ac3-4f8f-82ed-96846c8b81f4",
   CellTags->"Section16",
   CellID->715838931]},
 "Section17"->{
  Cell[194390, 5263, 150, 2, 70, "Subsection",ExpressionUUID->"f97445f0-5cd0-4cef-bedf-4bd9675ea58f",
   CellTags->"Section17",
   CellID->616090041],
  Cell[333804, 8735, 156, 2, 70, "Subsection",ExpressionUUID->"282e3190-83e3-43ce-9673-7331e03347e4",
   CellTags->"Section17",
   CellID->1379525988]},
 "Section18"->{
  Cell[378355, 9745, 157, 2, 70, "Subsection",ExpressionUUID->"900f392e-121c-4b94-bdff-e941f10868f0",
   CellTags->"Section18",
   CellID->1847739219]},
 "Section19"->{
  Cell[399241, 10342, 148, 2, 70, "TechNoteSection",ExpressionUUID->"bab3cb3d-55ef-48a2-a0d4-f66516f39293",
   CellTags->"Section19",
   CellID->1476129218]},
 "Section20"->{
  Cell[399999, 10361, 149, 2, 70, "Subsection",ExpressionUUID->"0cf2bed3-7f30-4aa3-97c7-e74fea477450",
   CellTags->"Section20",
   CellID->749947798]},
 "Section22"->{
  Cell[451662, 11746, 193, 4, 70, "Subsection",ExpressionUUID->"e5b542f4-32cf-4ea2-a7d6-d4680c28b41e",
   CellTags->"Section22",
   CellID->1363502801]},
 "Section23"->{
  Cell[484857, 12670, 134, 2, 70, "Subsection",ExpressionUUID->"84d4768a-6ac3-4991-af7e-eef9db27ba4d",
   CellTags->"Section23",
   CellID->153308382]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Section11", 535751, 13953},
 {"Section12", 535923, 13957},
 {"Section13", 536094, 13961},
 {"Section14", 536268, 13965},
 {"Section15", 536442, 13969},
 {"Section16", 536611, 13973},
 {"Section17", 536779, 13977},
 {"Section18", 537099, 13984},
 {"Section19", 537268, 13988},
 {"Section20", 537443, 13992},
 {"Section22", 537612, 13996},
 {"Section23", 537782, 14000}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[583, 21, 7029, 168, 70, "AnchorBarGrid",ExpressionUUID->"9deb9064-470a-4b2d-b63b-68e9665b171b",
 CellID->1],
Cell[CellGroupData[{
Cell[7637, 193, 116, 1, 70, "TechNoteTitle",ExpressionUUID->"44311607-c44b-4382-9057-66a7165354fc",
 CellID->1379112571],
Cell[7756, 196, 4843, 110, 70, "TechNoteJumpBox",ExpressionUUID->"dccd8606-d5cd-4fd3-835a-b368ec5a0e4a"],
Cell[12602, 308, 1143, 23, 70, "TechNoteText",ExpressionUUID->"3cf54b08-c705-4f32-b93c-f922d2a87c4e",
 CellID->1465929903],
Cell[13748, 333, 1384, 31, 70, "TechNoteText",ExpressionUUID->"f2af2e41-344c-44d1-bd2c-87cb27084240",
 CellID->1951481337],
Cell[15135, 366, 383, 12, 70, "TechNoteText",ExpressionUUID->"266407f1-63fc-4ddb-82d6-6a6d289e0ea5",
 CellID->1308734266],
Cell[15521, 380, 1846, 48, 70, "DefinitionBox",ExpressionUUID->"e879472c-14ea-4028-972f-05f6e839ebee",
 CellID->407539380],
Cell[17370, 430, 135, 1, 70, "TechNoteCaption",ExpressionUUID->"696c7ce7-5226-4070-9f9b-a04caf2d8d52",
 CellID->1189009377],
Cell[17508, 433, 328, 7, 70, "TechNoteMathCaption",ExpressionUUID->"952f0792-fa6d-4b1c-af51-24e763c51f5c",
 CellID->1428640008],
Cell[17839, 442, 179, 3, 70, "Input",ExpressionUUID->"29bf024d-0b65-436e-bae7-5cae742a3ed7",
 CellID->853967906],
Cell[CellGroupData[{
Cell[18043, 449, 153, 2, 70, "TechNoteSection",ExpressionUUID->"201818e8-83ff-4057-9d12-ec58bd170abf",
 CellTags->"Section11",
 CellID->1585062394],
Cell[18199, 453, 518, 14, 70, "TechNoteText",ExpressionUUID->"7a488d6c-8fe0-42f7-80b7-32369eeee3d1",
 CellID->609014923],
Cell[18720, 469, 554, 19, 70, "TechNoteText",ExpressionUUID->"676ca9b2-02fe-4489-b16d-f0eba457679d",
 CellID->806749259],
Cell[19277, 490, 537, 17, 70, "TechNoteText",ExpressionUUID->"38367914-92e0-4943-9620-ab5d87b08c35",
 CellID->1970532502],
Cell[19817, 509, 183, 4, 70, "Input",ExpressionUUID->"bfa5bfca-3973-4137-9473-c2f239cfeb03",
 CellID->861826122],
Cell[CellGroupData[{
Cell[20025, 517, 265, 7, 70, "Input",ExpressionUUID->"8b2b2475-ada6-4332-ad8a-24057ccb8955",
 CellID->246957080],
Cell[20293, 526, 574, 17, 70, "Output",ExpressionUUID->"603d1ea8-90a4-46a5-9dea-3bdf281c84c2",
 CellID->1268158967]
}, Open  ]],
Cell[CellGroupData[{
Cell[20904, 548, 498, 14, 70, "Input",ExpressionUUID->"ecdb17d2-5b14-4caa-956e-2f83899896ff",
 CellID->149239284],
Cell[21405, 564, 7610, 176, 70, "Output",ExpressionUUID->"2f9f6079-7384-404d-8254-c04e68577312",
 CellID->172561894]
}, Open  ]],
Cell[29030, 743, 170, 3, 70, "TechNoteText",ExpressionUUID->"cd49cafb-b787-4c04-b794-ddd254e34bed",
 CellID->690265281],
Cell[CellGroupData[{
Cell[29225, 750, 272, 6, 70, "Input",ExpressionUUID->"14b5f864-8b99-43f7-9a3b-131efd8b9bec",
 CellID->581916673],
Cell[29500, 758, 806, 23, 70, "Output",ExpressionUUID->"db4bca16-7227-4237-97cc-b5a8f1774e07",
 CellID->1144829008]
}, Open  ]],
Cell[30321, 784, 192, 4, 70, "TechNoteText",ExpressionUUID->"c78acd03-2f0b-48e2-9368-e08eb5619005",
 CellID->107481873],
Cell[CellGroupData[{
Cell[30538, 792, 163, 3, 70, "Input",ExpressionUUID->"399f2e2f-bd7c-4874-9424-8b112b1bdaad",
 CellID->414092384],
Cell[30704, 797, 1575, 41, 70, "Output",ExpressionUUID->"dc983a8d-300f-436a-a59c-0a2cf9a19d56",
 CellID->1835143983]
}, Open  ]],
Cell[CellGroupData[{
Cell[32316, 843, 195, 4, 70, "Input",ExpressionUUID->"4f1e6910-19b8-4ee8-a2dd-3c06c2e18d8b",
 CellID->597624604],
Cell[32514, 849, 866, 29, 70, "Output",ExpressionUUID->"1ee01e3a-d7b9-43f1-ba5e-297ca3f4ac49",
 CellID->1104784067]
}, Open  ]],
Cell[33395, 881, 184, 3, 70, "TechNoteText",ExpressionUUID->"bd2d625f-2855-4f92-b0b0-daae3470f9c8",
 CellID->1181321350],
Cell[CellGroupData[{
Cell[33604, 888, 192, 4, 70, "Input",ExpressionUUID->"29c0ab2b-9221-4b58-8009-9540ba01fbc2",
 CellID->981612935],
Cell[33799, 894, 797, 17, 70, "Output",ExpressionUUID->"b9c9cbc3-c3b3-4169-ab4e-cca19c3b3584",
 CellID->962202107]
}, Open  ]],
Cell[34611, 914, 283, 5, 70, "TechNoteText",ExpressionUUID->"5be56b4e-37ab-40fa-938a-61dbf2e5528b",
 CellID->606925297],
Cell[34897, 921, 746, 16, 70, "TechNoteText",ExpressionUUID->"2b5ea56e-b744-4536-86c2-7e43a7de8ce7",
 CellID->46143429],
Cell[CellGroupData[{
Cell[35668, 941, 645, 19, 70, "Input",ExpressionUUID->"e46eb775-b112-4de5-9356-b10be02e106a",
 CellID->291014636],
Cell[36316, 962, 4396, 112, 70, "Output",ExpressionUUID->"14607b55-e19e-4b64-832e-0796a54182b6",
 CellID->1178950439]
}, Open  ]],
Cell[40727, 1077, 616, 14, 70, "TechNoteText",ExpressionUUID->"4e7e106d-7cc0-44b4-9b62-51e33eb1c426",
 CellID->1152615977],
Cell[CellGroupData[{
Cell[41368, 1095, 273, 7, 70, "Input",ExpressionUUID->"7b33a6df-0190-4731-9f82-0ffe6bc30832",
 CellID->1714229499],
Cell[41644, 1104, 1246, 27, 70, "Output",ExpressionUUID->"bdc3c0ab-b415-4809-8dcb-6ba1060d85d6",
 CellID->1935901051]
}, Open  ]],
Cell[CellGroupData[{
Cell[42927, 1136, 499, 14, 70, "Input",ExpressionUUID->"9e37efb4-f54e-4e9f-ad39-25d7ac3e57f6",
 CellID->1435008719],
Cell[43429, 1152, 11950, 280, 70, "Output",ExpressionUUID->"919e7c3f-6257-4574-a5cb-975708b65a5f",
 CellID->164228460]
}, Open  ]],
Cell[55394, 1435, 987, 22, 70, "TechNoteText",ExpressionUUID->"f33602ad-6980-4531-b3bc-b28a0eb8ddeb",
 CellID->1854176847],
Cell[CellGroupData[{
Cell[56406, 1461, 944, 28, 70, "Input",ExpressionUUID->"856f9dfe-2fce-476e-98c7-3974342ae90f",
 CellID->1015065912],
Cell[57353, 1491, 1660, 31, 70, "Output",ExpressionUUID->"00c812d4-75ef-47d3-9df3-4b05ad7477a5",
 CellID->671240825]
}, Open  ]],
Cell[59028, 1525, 143, 1, 70, "TechNoteText",ExpressionUUID->"fbbb7ff4-0ba2-4a90-8966-33095cd07874",
 CellID->1898388060],
Cell[59174, 1528, 523, 19, 70, "TechNoteText",ExpressionUUID->"5c7e2d4e-fdc8-46bb-8b73-618fe769133f",
 CellID->1043580941],
Cell[59700, 1549, 1369, 43, 70, "TechNoteText",ExpressionUUID->"16c8e6d9-9c72-4024-ae0f-b5710d96f837",
 CellID->965930338],
Cell[61072, 1594, 654, 20, 70, "TechNoteText",ExpressionUUID->"298b4c2d-b221-473f-af53-a7e920e89ddc",
 CellID->1562303093],
Cell[61729, 1616, 1170, 35, 70, "TechNoteText",ExpressionUUID->"057301b5-b268-4215-a283-f49107385f65",
 CellID->345532182],
Cell[62902, 1653, 475, 17, 70, "TechNoteText",ExpressionUUID->"0f42e6df-cc40-4147-a9b9-1965033c7ffc",
 CellID->563601386],
Cell[63380, 1672, 1089, 31, 70, "TechNoteText",ExpressionUUID->"a0bf3808-a9e0-4fd4-8a98-f61023572a12",
 CellID->2045611232],
Cell[64472, 1705, 1119, 39, 70, "TechNoteText",ExpressionUUID->"4bcac4ce-d9cf-49c9-9ed6-7b3246444362",
 CellID->1522271401],
Cell[65594, 1746, 1192, 38, 70, "TechNoteText",ExpressionUUID->"07954a3e-5712-4e37-86d4-3530c34888c1",
 CellID->1842749896],
Cell[CellGroupData[{
Cell[66811, 1788, 273, 7, 70, "Input",ExpressionUUID->"3352681a-282c-4f62-beaa-889bfbfc806b",
 CellID->88345038],
Cell[67087, 1797, 3013, 64, 70, "Output",ExpressionUUID->"9e62e056-5edf-40ea-82a0-d1be9d7b9c71",
 CellID->812948084]
}, Open  ]],
Cell[CellGroupData[{
Cell[70137, 1866, 418, 12, 70, "Input",ExpressionUUID->"ec26f09f-6016-46f8-a4bd-3b75951f1395",
 CellID->1915435092],
Cell[70558, 1880, 5874, 155, 70, "Output",ExpressionUUID->"1815e982-15fd-48f1-81e2-0e21d6abe683",
 CellID->927485574]
}, Open  ]],
Cell[76447, 2038, 305, 5, 70, "TechNoteText",ExpressionUUID->"db19d742-0848-45cc-a5e7-1538a6110818",
 CellID->716147443],
Cell[76755, 2045, 1249, 45, 70, "TechNoteText",ExpressionUUID->"f66674b2-ec20-41a2-a0e3-89fa52024498",
 CellID->1791716713],
Cell[78007, 2092, 174, 3, 70, "TechNoteText",ExpressionUUID->"ca5d04e8-3c24-4359-9dbe-a4f2abbe4b83",
 CellID->1367097157],
Cell[78184, 2097, 321, 5, 70, "TechNoteText",ExpressionUUID->"fc97e9ac-bddc-4e1d-bda6-f0fc4159a83c",
 CellID->874378446],
Cell[CellGroupData[{
Cell[78530, 2106, 774, 22, 70, "Input",ExpressionUUID->"b975ba42-853e-43fe-8f1f-80f07a32aed9",
 CellID->447945501],
Cell[79307, 2130, 1572, 29, 70, "Output",ExpressionUUID->"98a2a273-1324-4ef8-a6df-ac5a261be21a",
 CellID->1813732292]
}, Open  ]],
Cell[80894, 2162, 115, 1, 70, "TechNoteText",ExpressionUUID->"76e52d19-3329-47b0-b355-dcad76b53056",
 CellID->880946029],
Cell[CellGroupData[{
Cell[81034, 2167, 732, 21, 70, "Input",ExpressionUUID->"94d9170e-8b29-437e-8fa3-2bcce2cd44ea",
 CellID->1307646985],
Cell[81769, 2190, 1572, 29, 70, "Output",ExpressionUUID->"50886f84-f784-4a6b-9a76-6d99a6c1bbca",
 CellID->2015746126]
}, Open  ]],
Cell[83356, 2222, 235, 4, 70, "TechNoteText",ExpressionUUID->"4855d8e7-5a8c-4d9d-af29-96946b1bc773",
 CellID->169608441],
Cell[83594, 2228, 667, 21, 70, "TechNoteText",ExpressionUUID->"1dc34e28-5c24-44b9-bb98-8e9be6df6746",
 CellID->898268318],
Cell[84264, 2251, 381, 10, 70, "TechNoteText",ExpressionUUID->"00aed608-116f-43f7-945c-94adef8a4f07",
 CellID->385582216],
Cell[84648, 2263, 2416, 55, 70, "TechNoteText",ExpressionUUID->"90c866c1-8925-4533-af23-e20ecfec794f",
 CellID->1620101282],
Cell[87067, 2320, 131, 1, 70, "TechNoteText",ExpressionUUID->"882a63f2-400c-4f52-a2db-4d9d15ca2c0a",
 CellID->712578174],
Cell[87201, 2323, 787, 27, 70, "TechNoteText",ExpressionUUID->"5b3668e4-9ff6-4f14-bf9e-13a1d5d067af",
 CellID->1522141313],
Cell[87991, 2352, 414, 7, 70, "TechNoteText",ExpressionUUID->"b4da5cde-f9d5-42d9-a215-6a7e55c3c704",
 CellID->1803844527],
Cell[88408, 2361, 393, 8, 70, "TechNoteText",ExpressionUUID->"70f17a1e-4652-4179-ac0f-978f0971a16f",
 CellID->1188320590],
Cell[88804, 2371, 334, 6, 70, "TechNoteText",ExpressionUUID->"65e002e4-3f9d-4fdf-85b7-af4eed401371",
 CellID->506239030],
Cell[89141, 2379, 3535, 89, 70, "TechNoteText",ExpressionUUID->"daa55a50-ce87-49cd-8223-ccb09088bfe6",
 CellID->1226753413],
Cell[92679, 2470, 402, 6, 70, "TechNoteText",ExpressionUUID->"d808a335-037c-4809-a16b-7ba1c659651b",
 CellID->365203462],
Cell[93084, 2478, 5254, 136, 70, "TechNoteText",ExpressionUUID->"082b3b69-a3bc-4c4d-9a49-eef39fedbe44",
 CellID->977674470],
Cell[98341, 2616, 596, 11, 70, "TechNoteText",ExpressionUUID->"a616f49d-6c4b-4f58-96ee-06b454353457",
 CellID->833871357]
}, Open  ]],
Cell[CellGroupData[{
Cell[98974, 2632, 147, 2, 70, "TechNoteSection",ExpressionUUID->"b80279f3-54b1-45e4-baa2-22a100383ef9",
 CellTags->"Section12",
 CellID->29167796],
Cell[99124, 2636, 270, 5, 70, "TechNoteText",ExpressionUUID->"5a0d3cbf-db97-4077-bc47-de54f809924b",
 CellID->596875856],
Cell[99397, 2643, 628, 22, 70, "TechNoteText",ExpressionUUID->"1cbe9b43-0303-4099-9a04-6b9bdf65158d",
 CellID->796396655],
Cell[100028, 2667, 344, 11, 70, "TechNoteText",ExpressionUUID->"76f49f1c-cd80-4575-a809-d8c18ed2d383",
 CellID->1920492481],
Cell[100375, 2680, 179, 3, 70, "Input",ExpressionUUID->"9ccd3b55-5b89-429b-a953-5a0510565566",
 CellID->754200946],
Cell[100557, 2685, 184, 4, 70, "Input",ExpressionUUID->"2438ad00-4ba9-4a7a-902f-60be6a28bdbf",
 CellID->1406814828],
Cell[CellGroupData[{
Cell[100766, 2693, 264, 7, 70, "Input",ExpressionUUID->"fa97d88a-b46c-4073-be5e-ac30d982b761",
 CellID->1037913757],
Cell[101033, 2702, 512, 15, 70, "Output",ExpressionUUID->"4bbca41d-5710-4f3b-b45b-5fbdfd946750",
 CellID->2090608257]
}, Open  ]],
Cell[CellGroupData[{
Cell[101582, 2722, 499, 14, 70, "Input",ExpressionUUID->"701f91d2-30b2-4deb-a397-8570fa7a4ca6",
 CellID->1887946780],
Cell[102084, 2738, 7667, 178, 70, "Output",ExpressionUUID->"0bbbb211-98be-449a-891e-51a657dbf030",
 CellID->1873026832]
}, Open  ]],
Cell[109766, 2919, 181, 3, 70, "TechNoteText",ExpressionUUID->"1903632e-f1bb-43a1-abdb-bd0efda2b87f",
 CellID->1230965299],
Cell[CellGroupData[{
Cell[109972, 2926, 194, 4, 70, "Input",ExpressionUUID->"afcc2329-947d-4e9a-ac3c-5c2ca8becc2f",
 CellID->2123808742],
Cell[110169, 2932, 792, 24, 70, "Output",ExpressionUUID->"2aa203bd-8eda-4869-a8a7-ee1b61480c94",
 CellID->2146667698]
}, Open  ]],
Cell[110976, 2959, 315, 5, 70, "TechNoteText",ExpressionUUID->"ca3c5e20-f0b2-4fc3-a1ca-a1fe158fc943",
 CellID->776960470],
Cell[CellGroupData[{
Cell[111316, 2968, 169, 3, 70, "Input",ExpressionUUID->"9e40ce2d-aab1-4ff0-84b3-2a638314960c",
 CellID->1674045530],
Cell[111488, 2973, 637, 16, 70, "Output",ExpressionUUID->"01bd0cfd-eeca-4524-8d4d-9c7a6c498b15",
 CellID->1318730686]
}, Open  ]],
Cell[112140, 2992, 252, 4, 70, "TechNoteText",ExpressionUUID->"3db4828c-30c8-4ac6-9222-99f7384acac8",
 CellID->573709808],
Cell[112395, 2998, 505, 11, 70, "TechNoteText",ExpressionUUID->"ec0119fe-f187-45cc-a189-f2edbb753e4d",
 CellID->139168026],
Cell[CellGroupData[{
Cell[112925, 3013, 1148, 35, 70, "Input",ExpressionUUID->"df450589-9017-4874-b4f5-009850c458a8",
 CellID->387321399],
Cell[114076, 3050, 798, 17, 70, "Output",ExpressionUUID->"93dcaf67-d542-4db2-a6a6-6919929ab699",
 CellID->1875402562],
Cell[114877, 3069, 1489, 37, 70, "Output",ExpressionUUID->"8f488823-6418-4dfa-be76-6be15e6d91f0",
 CellID->1273372515],
Cell[116369, 3108, 2556, 61, 70, "Output",ExpressionUUID->"ba42b5ca-cd00-4c2c-b1e6-e06f7b54f7d9",
 CellID->1897317250]
}, Open  ]],
Cell[CellGroupData[{
Cell[118962, 3174, 201, 4, 70, "Input",ExpressionUUID->"060ceb89-ce90-4339-b3d6-225b3fa553ba",
 CellID->1606586072],
Cell[119166, 3180, 131, 2, 70, "Output",ExpressionUUID->"e3448c47-a563-4b66-8eff-cbf8c262bbb1",
 CellID->226346447]
}, Open  ]],
Cell[119312, 3185, 412, 6, 70, "TechNoteText",ExpressionUUID->"c2e15cbd-c9b6-4f97-b3f8-bf9d0129594a",
 CellID->799932562]
}, Open  ]],
Cell[CellGroupData[{
Cell[119761, 3196, 136, 2, 70, "TechNoteSection",ExpressionUUID->"e7ecdaea-2089-4845-9b9a-fbbc412cd62d",
 CellTags->"Section13",
 CellID->1218939314],
Cell[119900, 3200, 180, 3, 70, "Input",ExpressionUUID->"46cf70a9-8ec0-4b19-9b14-a3d83e9e8aa9",
 CellID->1843914595],
Cell[120083, 3205, 183, 4, 70, "Input",ExpressionUUID->"55171845-bd8c-4269-9082-869c7a0145d6",
 CellID->336088308],
Cell[120269, 3211, 574, 14, 70, "TechNoteText",ExpressionUUID->"61705282-ab2d-46f6-9e0b-82203cddfce8",
 CellID->1866541665],
Cell[120846, 3227, 625, 22, 70, "TechNoteText",ExpressionUUID->"42f35a37-0469-434e-b5b5-0477f3ab2500",
 CellID->524648279],
Cell[121474, 3251, 505, 12, 70, "TechNoteText",ExpressionUUID->"b9cddf77-b976-4e89-82c6-f406153f3f46",
 CellID->195770571],
Cell[CellGroupData[{
Cell[122004, 3267, 686, 20, 70, "Input",ExpressionUUID->"455bd4cf-4d88-40cf-8b74-5f29ae73f288",
 CellID->371039593],
Cell[122693, 3289, 7611, 176, 70, "Output",ExpressionUUID->"99a03bc9-cd61-49a3-ac6a-4ad63dc565a9",
 CellID->1011195892]
}, Open  ]],
Cell[130319, 3468, 642, 21, 70, "TechNoteText",ExpressionUUID->"6053e80e-7dbe-44cd-8901-9e869b3e9278",
 CellID->809087288],
Cell[CellGroupData[{
Cell[130986, 3493, 193, 4, 70, "Input",ExpressionUUID->"126b6c62-4087-4cbd-8077-31c75d1da045",
 CellID->463596612],
Cell[131182, 3499, 806, 23, 70, "Output",ExpressionUUID->"8d7d1be0-13d3-4f1b-bb50-2e714f83a19d",
 CellID->2131258133]
}, Open  ]],
Cell[132003, 3525, 143, 1, 70, "TechNoteText",ExpressionUUID->"b1d20def-6c50-485c-9aa8-d9840ae7f7f0",
 CellID->2003915004],
Cell[CellGroupData[{
Cell[132171, 3530, 192, 4, 70, "Input",ExpressionUUID->"c66b9aaf-b659-4078-a3cd-70bbc19fafe8",
 CellID->813436327],
Cell[132366, 3536, 839, 19, 70, "Output",ExpressionUUID->"11189dcf-d528-4ee4-a010-bf83e2c03bac",
 CellID->28209371]
}, Open  ]],
Cell[133220, 3558, 382, 8, 70, "TechNoteText",ExpressionUUID->"cfc6d714-409b-4ae9-ba0a-62f624bea04e",
 CellID->534468518],
Cell[CellGroupData[{
Cell[133627, 3570, 311, 9, 70, "Input",ExpressionUUID->"e95bb36d-aa47-4949-844e-4c92e7b64a05",
 CellID->2035770272],
Cell[133941, 3581, 806, 23, 70, "Output",ExpressionUUID->"b9a012de-f03f-4043-a31f-d57399161e42",
 CellID->1668496057]
}, Open  ]],
Cell[134762, 3607, 757, 15, 70, "TechNoteText",ExpressionUUID->"b210e0f5-d8ac-4f72-891d-f2ff818455e1",
 CellID->1603079182],
Cell[CellGroupData[{
Cell[135544, 3626, 811, 23, 70, "Input",ExpressionUUID->"00aa3743-c94f-4169-81ec-5bcaaf435812",
 CellID->621976612],
Cell[136358, 3651, 840, 19, 70, "Output",ExpressionUUID->"4f78d93d-ebef-420a-8a7e-d3964f3d4941",
 CellID->571767473],
Cell[137201, 3672, 1532, 29, 70, "Output",ExpressionUUID->"edcb0a2e-a45e-4a20-8b78-2df53121f9e5",
 CellID->1854082033]
}, Open  ]],
Cell[CellGroupData[{
Cell[138770, 3706, 188, 4, 70, "Input",ExpressionUUID->"a65a4b56-0ac8-4cb5-b8c8-40a0d5ebc600",
 CellID->661500490],
Cell[138961, 3712, 132, 2, 70, "Output",ExpressionUUID->"f4cbc7a0-55f5-49d9-b7f0-e2a9b196260f",
 CellID->1569010661]
}, Open  ]],
Cell[139108, 3717, 1223, 29, 70, "TechNoteText",ExpressionUUID->"f1ae24c1-b180-413a-b3f0-83b6c49ebf5a",
 CellID->666193793],
Cell[140334, 3748, 467, 13, 70, "TechNoteText",ExpressionUUID->"094acab2-3846-4e97-aa52-866e8321f39b",
 CellID->1938247085],
Cell[CellGroupData[{
Cell[140826, 3765, 525, 14, 70, "Input",ExpressionUUID->"b2314c77-9ba3-4e8b-a24d-02aabac758dc",
 CellID->1040933486],
Cell[141354, 3781, 1033, 31, 70, "Output",ExpressionUUID->"48ad963b-8b37-4d3f-961b-2ec4d710aedc",
 CellID->1410477914]
}, Open  ]],
Cell[142402, 3815, 327, 8, 70, "TechNoteText",ExpressionUUID->"f7fb8d2f-d20f-486f-b0ec-4fed8e8ae2bf",
 CellID->771058470],
Cell[CellGroupData[{
Cell[142754, 3827, 472, 13, 70, "Input",ExpressionUUID->"f593fefa-4def-49e6-8537-b3101a177981",
 CellID->1895203240],
Cell[143229, 3842, 3377, 83, 70, "Output",ExpressionUUID->"8b1e3e03-6582-407a-96d2-f6e98e6a4eb5",
 CellID->1977805012]
}, Open  ]],
Cell[146621, 3928, 849, 23, 70, "TechNoteText",ExpressionUUID->"d76b44f2-3965-439f-a911-bb18d10fd59b",
 CellID->27233292],
Cell[CellGroupData[{
Cell[147495, 3955, 511, 14, 70, "Input",ExpressionUUID->"73f05abb-31b9-4572-a38e-2e97dec77b7a",
 CellID->1505230369],
Cell[148009, 3971, 3774, 94, 70, "Output",ExpressionUUID->"4e1bd2a0-5e1f-42f9-b1f6-f4c2e267df69",
 CellID->69464771]
}, Open  ]],
Cell[151798, 4068, 225, 4, 70, "TechNoteText",ExpressionUUID->"532487e8-395b-4a41-a554-49da4ff26789",
 CellID->535686806],
Cell[CellGroupData[{
Cell[152048, 4076, 193, 4, 70, "Input",ExpressionUUID->"44cf5b60-1adc-4655-9026-d7a344585d71",
 CellID->851721286],
Cell[152244, 4082, 829, 24, 70, "Output",ExpressionUUID->"fe415f9b-bce0-421f-b11e-3a10f3b41691",
 CellID->1410785876]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[153122, 4112, 151, 2, 70, "TechNoteSection",ExpressionUUID->"b6d8aacc-df24-42df-9403-1d9e2ad0efdf",
 CellTags->"Section14",
 CellID->1455445268],
Cell[CellGroupData[{
Cell[153298, 4118, 132, 2, 70, "Subsection",ExpressionUUID->"3fad6138-e0f1-4fea-b6e1-6173aa86077c",
 CellTags->"Section15",
 CellID->1829879946],
Cell[153433, 4122, 572, 13, 70, "TechNoteText",ExpressionUUID->"02ee0171-6de3-4c0b-82b6-540ca27e07ff",
 CellID->678943735],
Cell[154008, 4137, 634, 23, 70, "TechNoteText",ExpressionUUID->"3aea296a-364e-4b36-aa5f-6b4ceb679fba",
 CellID->1426737634],
Cell[154645, 4162, 115, 1, 70, "TechNoteText",ExpressionUUID->"5a816043-167c-448b-a963-31d68083e60b",
 CellID->377012236],
Cell[154763, 4165, 584, 22, 70, "TechNoteText",ExpressionUUID->"4c7b2476-458b-4a8e-9418-a684abdb0042",
 CellID->1367891802],
Cell[155350, 4189, 400, 8, 70, "TechNoteText",ExpressionUUID->"8a510a09-9f33-4224-adac-2b0ec5212093",
 CellID->1345075079],
Cell[155753, 4199, 212, 4, 70, "TechNoteText",ExpressionUUID->"aa5f40c3-c7ec-40b2-a8b9-aabe10c141f2",
 CellID->819163313],
Cell[155968, 4205, 569, 19, 70, "TechNoteText",ExpressionUUID->"c0f92d2f-9d35-4cea-a3cb-67b8732c9c28",
 CellID->116500784],
Cell[156540, 4226, 446, 13, 70, "TechNoteText",ExpressionUUID->"aacc74a4-849d-468d-b578-7b3eaa244f63",
 CellID->1671074271],
Cell[156989, 4241, 174, 3, 70, "TechNoteText",ExpressionUUID->"d9b0f9bb-8585-481e-889e-30bd55b879c6",
 CellID->1953344721],
Cell[157166, 4246, 781, 19, 70, "Picture",ExpressionUUID->"4833314f-b458-4cee-ac6b-3b3ad3913f20",
 CellID->954137231],
Cell[157950, 4267, 287, 5, 70, "TechNoteText",ExpressionUUID->"50861721-bd1e-40cc-8723-c50a9f44a0ca",
 CellID->924049268],
Cell[158240, 4274, 179, 3, 70, "Input",ExpressionUUID->"2ce31d33-aee4-4d72-a2b3-b4642c66f708",
 CellID->214055128],
Cell[158422, 4279, 183, 4, 70, "Input",ExpressionUUID->"554ff151-7af9-4fbc-bdae-03c77de47d23",
 CellID->167122186],
Cell[158608, 4285, 282, 5, 70, "TechNoteMathCaption",ExpressionUUID->"f035c9a4-0e4d-41b8-9705-2619d2952e5f",
 CellID->2041795819],
Cell[CellGroupData[{
Cell[158915, 4294, 603, 16, 70, "Input",ExpressionUUID->"da9628bc-d3ee-4aad-a9a8-e5fdaebb496d",
 CellID->1821134520],
Cell[159521, 4312, 1154, 33, 70, "Output",ExpressionUUID->"5d47c128-e7f0-4c2f-88f9-bd34567ea278",
 CellID->711271405]
}, Open  ]],
Cell[160690, 4348, 179, 3, 70, "TechNoteMathCaption",ExpressionUUID->"92ec6682-30c0-49c3-b669-d01d99b8e86d",
 CellID->1443037598],
Cell[CellGroupData[{
Cell[160894, 4355, 290, 7, 70, "Input",ExpressionUUID->"4be3a71b-b59b-4b36-a105-ee37dcf338d6",
 CellID->1600084015],
Cell[161187, 4364, 1089, 25, 70, "Output",ExpressionUUID->"650e9aa4-f4fa-4366-a2c8-7f12f2600486",
 CellID->1444524633]
}, Open  ]],
Cell[162291, 4392, 206, 4, 70, "TechNoteMathCaption",ExpressionUUID->"67a631c8-74cb-482e-9a5d-70b267b93a9e",
 CellID->378680471],
Cell[CellGroupData[{
Cell[162522, 4400, 164, 3, 70, "Input",ExpressionUUID->"ad0db6be-43ee-46a5-86bb-60c481d75309",
 CellID->1488630036],
Cell[162689, 4405, 1882, 49, 70, "Output",ExpressionUUID->"3f391c49-a4b1-48d4-8252-191e71e048fe",
 CellID->822877496]
}, Open  ]],
Cell[164586, 4457, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"d01cfc43-d43e-4989-ae93-b13de89210a7",
 CellID->641929970],
Cell[CellGroupData[{
Cell[164788, 4464, 499, 14, 70, "Input",ExpressionUUID->"110b3eaa-d8bb-4ea2-b982-b7959a14fbe4",
 CellID->2106646909],
Cell[165290, 4480, 9996, 232, 70, "Output",ExpressionUUID->"c340ba3c-075b-45ca-a0de-61072a968f4d",
 CellID->307388592]
}, Open  ]],
Cell[175301, 4715, 217, 4, 70, "TechNoteMathCaption",ExpressionUUID->"25063834-76a6-4d00-a4ef-9f7f3a6f1424",
 CellID->1736236263],
Cell[CellGroupData[{
Cell[175543, 4723, 490, 15, 70, "Input",ExpressionUUID->"dac7df16-662e-418c-ab2d-20e99ee9663d",
 CellID->915076805],
Cell[176036, 4740, 1683, 41, 70, "Output",ExpressionUUID->"75a1dc23-b6bd-45cf-a116-5aeee7d6d2fb",
 CellID->1581894709]
}, Open  ]],
Cell[CellGroupData[{
Cell[177756, 4786, 178, 4, 70, "Input",ExpressionUUID->"efce65c1-6d10-470d-841f-e57f21852d75",
 CellID->1955961279],
Cell[177937, 4792, 2661, 66, 70, "Output",ExpressionUUID->"812f3e40-d717-4f10-a70b-0d79eb3ee49c",
 CellID->1056824303]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[180647, 4864, 138, 2, 70, "Subsection",ExpressionUUID->"ee3a3a70-5ac3-4f8f-82ed-96846c8b81f4",
 CellTags->"Section16",
 CellID->715838931],
Cell[180788, 4868, 709, 12, 70, "TechNoteText",ExpressionUUID->"983b5da1-7e14-4340-a570-2bd235b21b85",
 CellID->901522823],
Cell[181500, 4882, 1046, 32, 70, "TechNoteText",ExpressionUUID->"e321a1c9-ef77-4f3e-b287-72d7ea61f3f1",
 CellID->1396956576],
Cell[182549, 4916, 1478, 53, 70, "TechNoteText",ExpressionUUID->"6137c837-ce76-4e3f-b112-d0cd6ffdf4b5",
 CellID->210460181],
Cell[184030, 4971, 431, 8, 70, "TechNoteText",ExpressionUUID->"87454076-b53e-4ef8-9022-9b16bc1f49ae",
 CellID->298695458],
Cell[184464, 4981, 528, 13, 70, "TechNoteMathCaption",ExpressionUUID->"d41f111e-20d0-46c4-94cc-a6680c90ac13",
 CellID->1505279567],
Cell[CellGroupData[{
Cell[185017, 4998, 362, 9, 70, "Input",ExpressionUUID->"093693c8-b3dc-44d3-abe0-7d6fcbb37e52",
 CellID->1876320909],
Cell[185382, 5009, 695, 22, 70, "Output",ExpressionUUID->"4bd5f35d-2c7d-43f3-93ca-5ca3092b61f6",
 CellID->208816184],
Cell[186080, 5033, 800, 23, 70, "Output",ExpressionUUID->"b8ba9e82-e902-4efb-9c4f-558323530eb0",
 CellID->585325290]
}, Open  ]],
Cell[186895, 5059, 167, 2, 70, "TechNoteMathCaption",ExpressionUUID->"871eedc7-2ada-4b32-af4a-b72fe55df6ac",
 CellID->774865820],
Cell[CellGroupData[{
Cell[187087, 5065, 338, 8, 70, "Input",ExpressionUUID->"b5151aff-9501-41e3-a614-00e95f8f9118",
 CellID->2117896949],
Cell[187428, 5075, 1097, 27, 70, "Output",ExpressionUUID->"728dc750-a2be-4f4c-81d5-7774d281ddb3",
 CellID->2087045770]
}, Open  ]],
Cell[188540, 5105, 323, 5, 70, "TechNoteMathCaption",ExpressionUUID->"54ac56b4-e4ae-4509-956d-a6ee07e01cf4",
 CellID->193224567],
Cell[CellGroupData[{
Cell[188888, 5114, 539, 15, 70, "Input",ExpressionUUID->"99f2ed23-6293-4053-9546-7edd46ea658b",
 CellID->1062235589],
Cell[189430, 5131, 2131, 52, 70, "Output",ExpressionUUID->"dbe35559-2592-4b39-a75a-65a9328c1131",
 CellID->2127849939]
}, Open  ]],
Cell[191576, 5186, 278, 5, 70, "TechNoteMathCaption",ExpressionUUID->"bc2370cd-0d62-4845-8745-09709f1e7a64",
 CellID->581406343],
Cell[CellGroupData[{
Cell[191879, 5195, 271, 6, 70, "Input",ExpressionUUID->"7186d264-9499-4d83-b2d2-93db4d811b7d",
 CellID->1127477995],
Cell[192153, 5203, 2188, 54, 70, "Output",ExpressionUUID->"90a129b6-c22a-43c6-a900-8d3714a12376",
 CellID->728751282]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[194390, 5263, 150, 2, 70, "Subsection",ExpressionUUID->"f97445f0-5cd0-4cef-bedf-4bd9675ea58f",
 CellTags->"Section17",
 CellID->616090041],
Cell[194543, 5267, 273, 5, 70, "TechNoteText",ExpressionUUID->"aa46d6c2-22ba-4bb1-aaf2-de4eeae37079",
 CellID->1275497408],
Cell[194819, 5274, 7318, 182, 70, "Picture",ExpressionUUID->"40ee9fad-de40-4105-8e75-2bdba38c3d58",
 CellID->2084184000],
Cell[202140, 5458, 342, 9, 70, "TechNoteCaption",ExpressionUUID->"cdcae4da-a687-4eb6-9687-ee2f93dae7ff",
 CellID->1283463500],
Cell[202485, 5469, 668, 16, 70, "TechNoteText",ExpressionUUID->"3f231e50-5313-40bb-a195-da8bb49950e4",
 CellID->1036421782],
Cell[203156, 5487, 864, 29, 70, "TechNoteText",ExpressionUUID->"7f7a32c1-8f17-4bd5-b0ce-3ad21e20c2e9",
 CellID->1390517433],
Cell[204023, 5518, 1382, 36, 70, "TechNoteText",ExpressionUUID->"577a0554-ed89-4f76-9b20-7e941eb79543",
 CellID->357932788],
Cell[205408, 5556, 1870, 62, 70, "TechNoteText",ExpressionUUID->"d34bc158-a1b4-417c-ba1e-511b2506c9d0",
 CellID->232871499],
Cell[207281, 5620, 349, 7, 70, "TechNoteText",ExpressionUUID->"9c328a15-1860-4f9f-b9ed-55bc31a2f544",
 CellID->531662691],
Cell[207633, 5629, 460, 14, 70, "TechNoteText",ExpressionUUID->"393d68d9-f5d1-4adc-bb3c-92307f4e09b4",
 CellID->1514408200],
Cell[208096, 5645, 799, 27, 70, "TechNoteText",ExpressionUUID->"829473a8-f9bf-4e9a-9187-606e3cdabc88",
 CellID->2034215257],
Cell[208898, 5674, 224, 4, 70, "TechNoteText",ExpressionUUID->"2a8b67c2-fbfa-4946-a9f4-6218c6dd3a9e",
 CellID->1368761109],
Cell[209125, 5680, 5599, 145, 70, "Picture",ExpressionUUID->"d400d369-35fd-4813-8174-d70d455e5635",
 CellID->757238962],
Cell[214727, 5827, 369, 10, 70, "TechNoteCaption",ExpressionUUID->"85204f84-4f91-4ce6-a006-3254530e122c",
 CellID->927142212],
Cell[CellGroupData[{
Cell[215121, 5841, 357, 7, 70, "TechNoteText",ExpressionUUID->"4d5b5e58-ead5-4591-9b3a-3235314adb8d",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->305516076],
Cell[215481, 5850, 194, 4, 70, "Input",ExpressionUUID->"130f06b3-a3a7-40f0-923f-091d98ae0694",
 CellID->1535052485],
Cell[215678, 5856, 285, 7, 70, "TechNoteMathCaption",ExpressionUUID->"741562df-21d4-42e5-bc8d-8b01625dc287",
 CellID->1475887768],
Cell[CellGroupData[{
Cell[215988, 5867, 378, 10, 70, "Input",ExpressionUUID->"25260ebd-ee67-43b8-9df1-23d249e70e48",
 CellID->1092408791],
Cell[216369, 5879, 631, 19, 70, "Output",ExpressionUUID->"be1f702b-8e22-4601-8c0d-aa2bd26c3b34",
 CellID->1023557733]
}, Open  ]],
Cell[217015, 5901, 179, 3, 70, "TechNoteMathCaption",ExpressionUUID->"17f0301b-e2eb-4eb1-8447-296de283abbf",
 CellID->1519843333],
Cell[CellGroupData[{
Cell[217219, 5908, 331, 8, 70, "Input",ExpressionUUID->"4ce5a21c-bb4b-41b1-ac0c-619c6ffc52ee",
 CellID->21384525],
Cell[217553, 5918, 666, 23, 70, "Output",ExpressionUUID->"6bdcacbc-b9f9-4a0c-aeed-ada5f2b77095",
 CellID->1590806061]
}, Open  ]],
Cell[218234, 5944, 202, 5, 70, "TechNoteMathCaption",ExpressionUUID->"781482ae-645f-4385-8083-6151835ecb94",
 CellID->978050365],
Cell[CellGroupData[{
Cell[218461, 5953, 221, 5, 70, "Input",ExpressionUUID->"162671fa-5c26-4d2e-99cb-b0bf6a51adb2",
 CellID->2127797723],
Cell[218685, 5960, 1307, 42, 70, "Output",ExpressionUUID->"389111d4-111d-4ebc-bcc5-f6ccbb1fa190",
 CellID->506062077]
}, Open  ]],
Cell[220007, 6005, 203, 4, 70, "TechNoteMathCaption",ExpressionUUID->"be02ff39-64d3-4725-bbe0-d951173093fb",
 CellID->1664622810],
Cell[CellGroupData[{
Cell[220235, 6013, 708, 18, 70, "Input",ExpressionUUID->"62935618-6633-496f-bc8b-405b740c0cd9",
 CellID->2027335310],
Cell[220946, 6033, 2149, 54, 70, "Output",ExpressionUUID->"c8a29faf-02f2-4b31-b6a4-6bb375ef354c",
 CellID->1350086019]
}, Open  ]],
Cell[223110, 6090, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"2e1511e0-e24f-4143-877b-31acddecd1cd",
 CellID->1320057003],
Cell[CellGroupData[{
Cell[223284, 6095, 183, 4, 70, "Input",ExpressionUUID->"f0819f18-561a-4eb6-8e89-554000492100",
 CellID->856233533],
Cell[223470, 6101, 9049, 212, 70, "Output",ExpressionUUID->"2c188cda-33b3-4827-b70b-7ac7cf45ef39",
 CellID->583507131]
}, Open  ]],
Cell[232534, 6316, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"cbbf7dd1-eb77-4361-ace8-ef86a4cd8046",
 CellID->1095734201],
Cell[CellGroupData[{
Cell[232708, 6321, 178, 4, 70, "Input",ExpressionUUID->"8924814e-b530-4164-9dea-b77ec7a6a7e7",
 CellID->1234389837],
Cell[232889, 6327, 23041, 529, 70, "Output",ExpressionUUID->"98f5a840-ea8f-46d8-be60-5f66fa632fb8",
 CellID->1594018515]
}, Open  ]],
Cell[CellGroupData[{
Cell[255967, 6861, 260, 7, 70, "Input",ExpressionUUID->"0cae4d1e-63a6-45c3-90e6-00f8f1b32c67",
 CellID->273770455],
Cell[256230, 6870, 33747, 756, 70, "Output",ExpressionUUID->"7faf95c7-3c71-4e94-8ed1-eb3a024219b8",
 CellID->810685280]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[290026, 7632, 358, 7, 70, "TechNoteText",ExpressionUUID->"bcc1081e-c154-4988-b5e6-5a9167d6eceb",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->1362282140],
Cell[290387, 7641, 202, 4, 70, "TechNoteMathCaption",ExpressionUUID->"b850bbd9-090e-4901-b35e-4b30a16a39f1",
 CellID->523520144],
Cell[CellGroupData[{
Cell[290614, 7649, 792, 20, 70, "Input",ExpressionUUID->"b7e3e908-772f-45f0-b869-922b7302046c",
 CellID->770533652],
Cell[291409, 7671, 4141, 102, 70, "Output",ExpressionUUID->"a3929786-57ea-407a-b307-594595a2701f",
 CellID->1551244392]
}, Open  ]],
Cell[295565, 7776, 133, 1, 70, "TechNoteMathCaption",ExpressionUUID->"9f0cce57-7994-41bc-a39b-c6c391b32236",
 CellID->363088131],
Cell[CellGroupData[{
Cell[295723, 7781, 189, 4, 70, "Input",ExpressionUUID->"20936cc3-ce7b-48a1-abc1-fd93239a9952",
 CellID->1079016412],
Cell[295915, 7787, 12245, 296, 70, "Output",ExpressionUUID->"23114038-0444-4004-927b-a1e05db38cc1",
 CellID->1313021764]
}, Open  ]],
Cell[308175, 8086, 148, 1, 70, "TechNoteMathCaption",ExpressionUUID->"81da99aa-cee3-4c6c-a2e5-7c1e86b16d8d",
 CellID->942690207],
Cell[CellGroupData[{
Cell[308348, 8091, 187, 4, 70, "Input",ExpressionUUID->"8741da48-63ee-49af-b16e-7ed680688fdf",
 CellID->473086067],
Cell[308538, 8097, 4911, 117, 70, "Output",ExpressionUUID->"2a81acc7-655c-4ac9-8d10-dcbab5f17c85",
 CellID->414830976]
}, Open  ]],
Cell[313464, 8217, 186, 3, 70, "TechNoteMathCaption",ExpressionUUID->"90653e60-9b4e-438d-b8cc-9be50dfe6ccc",
 CellID->1762048567],
Cell[CellGroupData[{
Cell[313675, 8224, 186, 4, 70, "Input",ExpressionUUID->"b5f5899c-d700-447a-8471-02e150757100",
 CellID->1674087129],
Cell[313864, 8230, 10490, 256, 70, "Output",ExpressionUUID->"129e1961-f292-42cb-8098-6019ab07be95",
 CellID->1332295470]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[324403, 8492, 358, 7, 70, "TechNoteText",ExpressionUUID->"a5feaf41-276b-40cb-9c8d-eda33b2c3700",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->1016485255],
Cell[324764, 8501, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"657c84c5-489b-424a-aa62-5fb3ad79f96a",
 CellID->1235189013],
Cell[CellGroupData[{
Cell[324966, 8508, 347, 9, 70, "Input",ExpressionUUID->"1ce58a0a-1ce9-4d96-b95d-c473acb169ba",
 CellID->1297582908],
Cell[325316, 8519, 1777, 44, 70, "Output",ExpressionUUID->"cdb8416e-33ed-4c31-a66e-97c36dd5227b",
 CellID->77977021]
}, Open  ]],
Cell[327108, 8566, 223, 4, 70, "TechNoteMathCaption",ExpressionUUID->"f7bc0d70-cae6-4044-84ae-bed1991c9bdf",
 CellID->331049159],
Cell[CellGroupData[{
Cell[327356, 8574, 186, 4, 70, "Input",ExpressionUUID->"5ebf39db-17bb-4b0e-99bf-15233e4bbb5e",
 CellID->1888208538],
Cell[327545, 8580, 3570, 82, 70, "Output",ExpressionUUID->"40c54c32-e021-41df-85f7-9ee9784728bc",
 CellID->594767277]
}, Open  ]],
Cell[CellGroupData[{
Cell[331152, 8667, 254, 6, 70, "Input",ExpressionUUID->"b21760a9-847a-428e-97c3-0e7dfd73b276",
 CellID->1871953819],
Cell[331409, 8675, 2334, 53, 70, "Output",ExpressionUUID->"334f3f36-c27d-413c-9627-00d1e67802a6",
 CellID->1864731401]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[333804, 8735, 156, 2, 70, "Subsection",ExpressionUUID->"282e3190-83e3-43ce-9673-7331e03347e4",
 CellTags->"Section17",
 CellID->1379525988],
Cell[333963, 8739, 849, 21, 70, "TechNoteText",ExpressionUUID->"bc953bfd-3400-4d11-beb1-d14ede8c1a3a",
 CellID->1459827304],
Cell[334815, 8762, 751, 25, 70, "TechNoteText",ExpressionUUID->"ceb6d8d9-d7f6-4938-8174-7b09693b43ca",
 CellID->316831353],
Cell[335569, 8789, 1528, 37, 70, "TechNoteText",ExpressionUUID->"e89f5db1-6c7e-429f-b0f3-782981a28c78",
 CellID->1372588958],
Cell[337100, 8828, 5917, 116, 70, "Picture",ExpressionUUID->"997e28bc-5d86-43d0-b09e-940ef797358f",
 CellID->833281032],
Cell[343020, 8946, 468, 8, 70, "TechNoteCaption",ExpressionUUID->"d6ce27f4-6f28-4029-b312-97a001c71d6e",
 CellID->571282978],
Cell[343491, 8956, 195, 4, 70, "TechNoteText",ExpressionUUID->"b1507fe8-1973-49ca-b3f9-07feeef90ebe",
 CellID->1213442737],
Cell[CellGroupData[{
Cell[343711, 8964, 357, 7, 70, "TechNoteText",ExpressionUUID->"90098754-2b29-422e-835c-49da245541bb",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->780471724],
Cell[344071, 8973, 259, 4, 70, "TechNoteMathCaption",ExpressionUUID->"9d9f2bda-9afe-4cf2-9313-c77760065c93",
 CellID->1827368847],
Cell[CellGroupData[{
Cell[344355, 8981, 1338, 38, 70, "Input",ExpressionUUID->"891c96d7-4c9f-4f1f-bf6e-482a69ca8ce0",
 CellID->1424575782],
Cell[345696, 9021, 2594, 49, 70, "Output",ExpressionUUID->"f2f170e3-e872-4071-9ea0-6a9bb9faa9a0",
 CellID->164312289]
}, Open  ]],
Cell[348305, 9073, 204, 4, 70, "TechNoteMathCaption",ExpressionUUID->"218f2ae3-6825-47e9-bd24-6bbba10bd8b7",
 CellID->873169809],
Cell[CellGroupData[{
Cell[348534, 9081, 422, 11, 70, "Input",ExpressionUUID->"004fad44-f1d1-4afc-b61c-19ee119f57a9",
 CellID->1609219912],
Cell[348959, 9094, 29335, 644, 70, "Output",ExpressionUUID->"fdfd36d8-e979-4e7d-92fb-6af37eb4251f",
 CellID->2080154828]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[378355, 9745, 157, 2, 70, "Subsection",ExpressionUUID->"900f392e-121c-4b94-bdff-e941f10868f0",
 CellTags->"Section18",
 CellID->1847739219],
Cell[378515, 9749, 645, 10, 70, "TechNoteText",ExpressionUUID->"e4b51dcd-71db-4cc5-9c42-42664e1d0a0e",
 CellID->192034466],
Cell[379163, 9761, 733, 19, 70, "TechNoteText",ExpressionUUID->"23516c3d-6b6c-45ef-8a69-df05d3877881",
 CellID->2002832268],
Cell[379899, 9782, 567, 17, 70, "TechNoteText",ExpressionUUID->"4bb6a7a1-3ef2-4a89-86c6-8a01145c1acf",
 CellID->1943245198],
Cell[380469, 9801, 521, 15, 70, "TechNoteText",ExpressionUUID->"8f2d8621-21e0-4b26-a4f4-1d5dbf6a610b",
 CellID->1190739210],
Cell[380993, 9818, 587, 18, 70, "TechNoteText",ExpressionUUID->"e725f510-b374-4331-a239-c4c03e2d8b8d",
 CellID->353796077],
Cell[381583, 9838, 176, 3, 70, "TechNoteText",ExpressionUUID->"edcb0f60-ddf4-4815-9491-f057f90e2304",
 CellID->2015931243],
Cell[381762, 9843, 429, 14, 70, "TechNoteText",ExpressionUUID->"25607c2a-0336-4a69-947a-77dd4a7e3a04",
 CellID->906902382],
Cell[382194, 9859, 576, 20, 70, "TechNoteText",ExpressionUUID->"78bc411e-6739-42f3-b9c2-a5ca4fe43344",
 CellID->1616891515],
Cell[382773, 9881, 430, 14, 70, "TechNoteText",ExpressionUUID->"0ba96b1d-deb9-4594-b7aa-1cb9b38ce456",
 CellID->837623467],
Cell[383206, 9897, 669, 18, 70, "TechNoteText",ExpressionUUID->"46706b95-1247-4363-b542-accbbb43f4b0",
 CellID->1182303784],
Cell[383878, 9917, 2830, 63, 70, "TechNoteText",ExpressionUUID->"1fdb1c62-21c2-47cb-973c-46d6d5683386",
 CellID->313511997],
Cell[386711, 9982, 1491, 40, 70, "TechNoteText",ExpressionUUID->"7a8f3e40-6901-4ef4-9d28-010014fefc29",
 CellID->1418747488],
Cell[388205, 10024, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"4c102618-c16d-4d10-9333-d0d254652296",
 CellID->1378098175],
Cell[CellGroupData[{
Cell[388440, 10032, 464, 13, 70, "Input",ExpressionUUID->"5a505ed7-cfec-4878-9605-43d162d52130",
 CellID->1028095504],
Cell[388907, 10047, 1114, 36, 70, "Output",ExpressionUUID->"535d05fe-e3d1-49a1-bb21-cc0bdfebfd4c",
 CellID->128421036]
}, Open  ]],
Cell[390036, 10086, 168, 2, 70, "TechNoteMathCaption",ExpressionUUID->"a9a65c61-5c1b-405a-8301-3acb1bc598eb",
 CellID->1646790355],
Cell[CellGroupData[{
Cell[390229, 10092, 527, 14, 70, "Input",ExpressionUUID->"4639707b-214d-45da-b1af-33bb180b45b0",
 CellID->1153761970],
Cell[390759, 10108, 1175, 28, 70, "Output",ExpressionUUID->"d2d2f2bd-2400-4571-a8e0-ec4c100d4a47",
 CellID->151286817]
}, Open  ]],
Cell[391949, 10139, 198, 4, 70, "TechNoteMathCaption",ExpressionUUID->"b447d22a-032c-4179-8289-cbc66ec4d97a",
 CellID->1240176371],
Cell[CellGroupData[{
Cell[392172, 10147, 541, 15, 70, "Input",ExpressionUUID->"c689b6d4-fc1e-4bbe-9092-e40e136bbf3c",
 CellID->167989615],
Cell[392716, 10164, 280, 8, 70, "Output",ExpressionUUID->"e9cad8c3-beec-4e93-a323-89d111128661",
 CellID->56895271]
}, Open  ]],
Cell[393011, 10175, 162, 2, 70, "TechNoteMathCaption",ExpressionUUID->"6fa973de-10ea-42c2-bc4d-279c477d744d",
 CellID->833485781],
Cell[393176, 10179, 1471, 43, 70, "Input",ExpressionUUID->"c5729727-d6cf-45ea-a8d0-5b20871e6cf1",
 CellID->359691886],
Cell[394650, 10224, 164, 2, 70, "TechNoteMathCaption",ExpressionUUID->"37a7d2c7-0878-4653-8a81-e1cc4d0e9e32",
 CellID->175061697],
Cell[CellGroupData[{
Cell[394839, 10230, 514, 14, 70, "Input",ExpressionUUID->"9660bb75-2cc2-4f03-ae64-a0fbc403d05a",
 CellID->209345089],
Cell[395356, 10246, 3312, 72, 70, "Output",ExpressionUUID->"6d0c2e37-b8d8-491f-9f6c-83daf491c8a3",
 CellID->608596782]
}, Open  ]],
Cell[398683, 10321, 124, 1, 70, "TechNoteMathCaption",ExpressionUUID->"400e1caa-8d97-4cf9-a57a-c4cf6e9eaf40",
 CellID->2073812678],
Cell[CellGroupData[{
Cell[398832, 10326, 217, 5, 70, "Input",ExpressionUUID->"3f7b2ce6-ce49-4a64-a96d-22f6f3210f75",
 CellID->1395051790],
Cell[399052, 10333, 128, 2, 70, "Output",ExpressionUUID->"17edf40d-4dea-4dfe-a040-11f0e23a1822",
 CellID->221504413]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[399241, 10342, 148, 2, 70, "TechNoteSection",ExpressionUUID->"bab3cb3d-55ef-48a2-a0d4-f66516f39293",
 CellTags->"Section19",
 CellID->1476129218],
Cell[399392, 10346, 582, 11, 70, "TechNoteText",ExpressionUUID->"3787eaec-a2d5-4d94-a0aa-3e4cc90ca6b7",
 CellID->1572676782],
Cell[CellGroupData[{
Cell[399999, 10361, 149, 2, 70, "Subsection",ExpressionUUID->"0cf2bed3-7f30-4aa3-97c7-e74fea477450",
 CellTags->"Section20",
 CellID->749947798],
Cell[400151, 10365, 337, 7, 70, "TechNoteText",ExpressionUUID->"32b8f6bd-9688-4c73-9088-6bc0cba16ddf",
 CellID->791116743],
Cell[400491, 10374, 875, 30, 70, "TechNoteText",ExpressionUUID->"9854e45a-d278-48fb-9e9f-1c9f0977256a",
 CellID->1227841024],
Cell[401369, 10406, 969, 18, 70, "TechNoteText",ExpressionUUID->"253b2a1e-4a8b-44c2-9e16-1bda955fb0f8",
 CellID->1153726345],
Cell[402341, 10426, 172, 3, 70, "TechNoteText",ExpressionUUID->"d3d3abee-7472-4d61-bd44-0e0a3ea40ffd",
 CellID->1048831652],
Cell[402516, 10431, 896, 28, 70, "TechNoteText",ExpressionUUID->"aea5ecaf-ab9b-44d2-89f2-5b1fc52cac5e",
 CellID->1167800588],
Cell[403415, 10461, 1548, 45, 70, "TechNoteText",ExpressionUUID->"794c40e4-4c03-4a86-89ea-dd086772f43b",
 CellID->1371432583],
Cell[404966, 10508, 1189, 38, 70, "TechNoteText",ExpressionUUID->"1bfccbf4-4479-4558-bc17-a88c286ead0a",
 CellID->725439230],
Cell[406158, 10548, 181, 3, 70, "TechNoteText",ExpressionUUID->"c062f23f-e60a-40e3-8005-f91f4c0c27b1",
 CellID->1192474591],
Cell[406342, 10553, 1000, 31, 70, "TechNoteText",ExpressionUUID->"69d2618e-c983-4dd8-af3c-4db73a1b2111",
 CellID->1603057133],
Cell[407345, 10586, 1046, 31, 70, "TechNoteText",ExpressionUUID->"b09ff867-54c1-4bcd-8fd8-173a68afee6f",
 CellID->251399069],
Cell[408394, 10619, 1184, 34, 70, "TechNoteText",ExpressionUUID->"9b9860b0-a4a8-4729-be64-8c9f8f690234",
 CellID->1163819034],
Cell[409581, 10655, 160, 2, 70, "TechNoteText",ExpressionUUID->"0dedeb00-1a84-44b6-99f2-6478d873bc74",
 CellID->1025447562],
Cell[409744, 10659, 958, 29, 70, "TechNoteText",ExpressionUUID->"21a30013-27a6-485b-9ec2-7e6cb606b6ce",
 CellID->1140907359],
Cell[410705, 10690, 300, 8, 70, "TechNoteText",ExpressionUUID->"d558fe98-82b2-49d3-995f-78bd3cf37ce3",
 CellID->348498650],
Cell[411008, 10700, 1147, 32, 70, "TechNoteText",ExpressionUUID->"f2bff34c-1a84-42de-970f-f421264ade5a",
 CellID->1028905181],
Cell[412158, 10734, 821, 23, 70, "TechNoteText",ExpressionUUID->"d47a7c75-99b1-45c0-90e9-8e4d3ac14600",
 CellID->1271051423],
Cell[412982, 10759, 179, 3, 70, "TechNoteText",ExpressionUUID->"632a4ba5-ec57-4e9c-aa91-7bdaa5813c89",
 CellID->1541429652],
Cell[413164, 10764, 392, 12, 70, "TechNoteText",ExpressionUUID->"58943f58-80e3-4270-b505-f8a7900186c4",
 CellID->1712927403],
Cell[413559, 10778, 337, 7, 70, "TechNoteText",ExpressionUUID->"f556f7f9-5af0-4c86-adcb-9614113bea2e",
 CellID->5090539],
Cell[413899, 10787, 441, 12, 70, "TechNoteText",ExpressionUUID->"522d1de5-fc54-48ab-ae7f-1d7067dd8abe",
 CellID->1804826740],
Cell[CellGroupData[{
Cell[414365, 10803, 521, 11, 70, "TechNoteText",ExpressionUUID->"f13ae6ff-ddae-43b5-bc61-acad1df4f046",
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {"ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 CellID->315955750],
Cell[414889, 10816, 179, 3, 70, "Input",ExpressionUUID->"e3a5de42-97cf-45d8-8155-4f8ec6c894b6",
 CellID->384188579],
Cell[415071, 10821, 249, 4, 70, "TechNoteMathCaption",ExpressionUUID->"6cbc18ec-3a2d-4f5c-a72e-6d32ecac671b",
 CellID->516505305],
Cell[415323, 10827, 184, 4, 70, "Input",ExpressionUUID->"1a51d5bb-9948-495c-b6c5-4d498064427d",
 CellID->1721604371],
Cell[CellGroupData[{
Cell[415532, 10835, 650, 19, 70, "Input",ExpressionUUID->"28f859e2-9fcc-4006-b537-3ce3f21cdc7a",
 CellID->775759961],
Cell[416185, 10856, 1826, 46, 70, "Output",ExpressionUUID->"7906e074-2f41-475c-89d7-a15fcb4d8ec3",
 CellID->1235509040],
Cell[418014, 10904, 1203, 31, 70, "Output",ExpressionUUID->"106710c5-d8b2-4c77-a0a6-606f09f327c0",
 CellID->1181052437]
}, Open  ]],
Cell[419232, 10938, 185, 3, 70, "TechNoteMathCaption",ExpressionUUID->"41b0544d-efe6-4018-bda3-52c7cd855b63",
 CellID->595736468],
Cell[CellGroupData[{
Cell[419442, 10945, 268, 7, 70, "Input",ExpressionUUID->"01fb972e-032c-4fca-b01d-92a2e2059c87",
 CellID->974055362],
Cell[419713, 10954, 2437, 57, 70, "Output",ExpressionUUID->"4f1b41c7-f298-4e39-99ee-60d46a91a6ab",
 CellID->756959438]
}, Open  ]],
Cell[422165, 11014, 214, 5, 70, "TechNoteMathCaption",ExpressionUUID->"62e71134-ee0e-479d-b8d1-71da1c7460f5",
 CellID->1817782849],
Cell[CellGroupData[{
Cell[422404, 11023, 301, 7, 70, "Input",ExpressionUUID->"5303768a-8b59-4d4a-a345-7d6e10ced45b",
 CellID->1373980921],
Cell[422708, 11032, 3153, 110, 70, "Output",ExpressionUUID->"823d995e-26da-41bf-98e3-55b13e5229c4",
 CellID->524149638]
}, Open  ]],
Cell[425876, 11145, 354, 7, 70, "TechNoteMathCaption",ExpressionUUID->"207181ae-beba-4925-a8a8-2fd300e0354c",
 CellID->642635412],
Cell[CellGroupData[{
Cell[426255, 11156, 480, 14, 70, "Input",ExpressionUUID->"f5f91959-a81a-4491-bf6f-7492da57083b",
 CellID->1078108721],
Cell[426738, 11172, 19649, 418, 70, "Output",ExpressionUUID->"66521806-ceee-477a-bcd6-1dcd00d9a55b",
 CellID->405045872]
}, Open  ]],
Cell[446402, 11593, 311, 7, 70, "TechNoteMathCaption",ExpressionUUID->"2fe65439-eb54-4b2b-8d2b-173343d2bb80",
 CellID->1155771237],
Cell[CellGroupData[{
Cell[446738, 11604, 302, 8, 70, "Input",ExpressionUUID->"bde05cd5-0906-4d58-984c-1355dcf61ebc",
 CellID->1057593144],
Cell[447043, 11614, 3342, 86, 70, "Output",ExpressionUUID->"14edabea-c7b6-424e-ae13-a5c069219a6a",
 CellID->82809714]
}, Open  ]],
Cell[450400, 11703, 152, 1, 70, "TechNoteMathCaption",ExpressionUUID->"5b9f9e8e-288b-4aea-9f8a-1c9e9018782b",
 CellID->1969536942],
Cell[CellGroupData[{
Cell[450577, 11708, 353, 10, 70, "Input",ExpressionUUID->"35c8cadf-9bed-415b-9142-2c12673fbe5f",
 CellID->694449336],
Cell[450933, 11720, 668, 19, 70, "Output",ExpressionUUID->"1c4dd79e-3d9b-4170-9f4b-f806cedf3f6b",
 CellID->213459942]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[451662, 11746, 193, 4, 70, "Subsection",ExpressionUUID->"e5b542f4-32cf-4ea2-a7d6-d4680c28b41e",
 CellTags->"Section22",
 CellID->1363502801],
Cell[451858, 11752, 249, 4, 70, "TechNoteText",ExpressionUUID->"5699f043-f014-468c-a3b8-e42798947365",
 CellID->593579270],
Cell[452110, 11758, 492, 17, 70, "TechNoteText",ExpressionUUID->"53230fa2-e29d-45cd-b98c-b6730cddbf77",
 CellID->1225250575],
Cell[452605, 11777, 242, 4, 70, "TechNoteText",ExpressionUUID->"77bb9670-ae0e-4f59-9725-9e019871301e",
 CellID->565722942],
Cell[452850, 11783, 1185, 36, 70, "TechNoteText",ExpressionUUID->"1312d770-4d7c-43ff-b0e2-2c39f70e0d11",
 CellID->1195380925],
Cell[454038, 11821, 138, 1, 70, "TechNoteText",ExpressionUUID->"b880b490-c4eb-475e-9bec-c03214fabf17",
 CellID->1057688790],
Cell[454179, 11824, 492, 17, 70, "TechNoteText",ExpressionUUID->"51d508b0-8b2e-4035-8ce4-0b696215aad5",
 CellID->1853347311],
Cell[454674, 11843, 285, 5, 70, "TechNoteText",ExpressionUUID->"04171f2f-2b0f-4539-9b47-0e9d0a0334ac",
 CellID->2105439889],
Cell[454962, 11850, 1185, 36, 70, "TechNoteText",ExpressionUUID->"3b9ce46d-ee93-462e-ad8f-9a48450510b4",
 CellID->2040162804],
Cell[456150, 11888, 169, 3, 70, "TechNoteText",ExpressionUUID->"3f7cd82f-449c-48fe-bb36-5df6ae90bd77",
 CellID->144855179],
Cell[456322, 11893, 494, 17, 70, "TechNoteText",ExpressionUUID->"f3821380-6dd0-40a7-ad3b-f11d8bda8773",
 CellID->1482021402],
Cell[456819, 11912, 335, 6, 70, "TechNoteText",ExpressionUUID->"a9ace18d-06ea-43f7-8656-010150f3bc8c",
 CellID->1818365508],
Cell[457157, 11920, 810, 28, 70, "TechNoteText",ExpressionUUID->"eb5dac6c-0ead-414c-8b33-c58af9397e08",
 CellID->429312499],
Cell[457970, 11950, 433, 7, 70, "TechNoteText",ExpressionUUID->"6e82bdbc-31d7-4fef-8b1f-a6688a9b3870",
 CellID->2057600420],
Cell[458406, 11959, 1672, 44, 70, "TechNoteText",ExpressionUUID->"b10f498f-09e3-4dd0-a957-d99905c4fd60",
 CellID->1161091299],
Cell[460081, 12005, 225, 4, 70, "TechNoteText",ExpressionUUID->"ca4bf9a9-e3e3-4f0d-b7d4-c9c746bc75af",
 CellID->277562004],
Cell[460309, 12011, 337, 5, 70, "TechNoteText",ExpressionUUID->"7c2c3129-4a4f-4334-8fa6-b1b9d0abfb10",
 CellID->650119944],
Cell[460649, 12018, 810, 28, 70, "TechNoteText",ExpressionUUID->"ccd6c297-7555-4905-8498-97fdb836a2e5",
 CellID->169102872],
Cell[461462, 12048, 1128, 24, 70, "TechNoteText",ExpressionUUID->"30b7ca33-a12f-4351-a439-12f92195d21f",
 CellID->991104723],
Cell[462593, 12074, 1671, 44, 70, "TechNoteText",ExpressionUUID->"6d19a9a3-f985-4dd3-b485-358bcacf6716",
 CellID->1613913329],
Cell[464267, 12120, 192, 4, 70, "TechNoteText",ExpressionUUID->"3591cb85-2f23-4f49-8906-73360b0a409c",
 CellID->175375246],
Cell[464462, 12126, 4614, 113, 70, "TechNoteText",ExpressionUUID->"76241642-3c09-4df2-8cd1-627d66b03f08",
 CellID->1184195838],
Cell[CellGroupData[{
Cell[469101, 12243, 522, 11, 70, "TechNoteText",ExpressionUUID->"5b45388d-8805-481c-831d-2e02d83dca39",
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {"ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 CellID->1989239018],
Cell[469626, 12256, 180, 3, 70, "TechNoteText",ExpressionUUID->"57f0c43b-0449-4888-814c-357c5908d90c",
 CellID->2048492517],
Cell[CellGroupData[{
Cell[469831, 12263, 479, 13, 70, "Input",ExpressionUUID->"d709d77c-e9a4-499f-aed9-5135318edf27",
 CellID->555904515],
Cell[470313, 12278, 1155, 33, 70, "Output",ExpressionUUID->"9f21d901-4e7a-4e7e-9288-9a0b9bb9fe4f",
 CellID->1323554704]
}, Open  ]],
Cell[471483, 12314, 201, 4, 70, "TechNoteMathCaption",ExpressionUUID->"7999b5ad-f279-457b-a539-9b4c9e06a7da",
 CellID->691274085],
Cell[CellGroupData[{
Cell[471709, 12322, 466, 13, 70, "Input",ExpressionUUID->"37598014-6a16-41c4-beba-823d0101130a",
 CellID->357016325],
Cell[472178, 12337, 1251, 35, 70, "Output",ExpressionUUID->"f00a382a-3464-4e9a-9cec-c6e35e862782",
 CellID->1348294502]
}, Open  ]],
Cell[473444, 12375, 153, 1, 70, "TechNoteMathCaption",ExpressionUUID->"0fea9c36-89f2-4b42-a217-1f5529fb8d13",
 CellID->1549413286],
Cell[CellGroupData[{
Cell[473622, 12380, 906, 23, 70, "Input",ExpressionUUID->"fcad81b4-a9b5-47b6-86f6-6b594928cc17",
 CellID->602394280],
Cell[474531, 12405, 2683, 58, 70, "Output",ExpressionUUID->"ede612c6-e94f-4fac-98bf-c9f2934d589f",
 CellID->538251970]
}, Open  ]],
Cell[477229, 12466, 137, 1, 70, "TechNoteMathCaption",ExpressionUUID->"c0745d03-b529-44dd-a05c-30f7f268ad08",
 CellID->389328403],
Cell[CellGroupData[{
Cell[477391, 12471, 1037, 27, 70, "Input",ExpressionUUID->"fa2b6155-b557-4676-9f52-693d004c214b",
 CellID->59796812],
Cell[478431, 12500, 3603, 79, 70, "Output",ExpressionUUID->"63b015a4-5259-437d-99a9-948e532cc435",
 CellID->1199738626]
}, Open  ]],
Cell[482049, 12582, 193, 4, 70, "TechNoteMathCaption",ExpressionUUID->"46edec55-f6d6-4e04-a64a-611c8037eac0",
 CellID->834281808],
Cell[CellGroupData[{
Cell[482267, 12590, 551, 16, 70, "Input",ExpressionUUID->"c16b3430-1ffd-4251-a73c-9e27af2564e7",
 CellID->853615793],
Cell[482821, 12608, 669, 19, 70, "Output",ExpressionUUID->"1eafba99-8037-4658-9d67-a8ed458d570f",
 CellID->1283125499],
Cell[483493, 12629, 668, 19, 70, "Output",ExpressionUUID->"5f6fa7a0-2fe8-4af3-827b-43fedecabc05",
 CellID->459478519]
}, Open  ]],
Cell[484176, 12651, 632, 13, 70, "TechNoteText",ExpressionUUID->"392931d9-f2c6-4835-929d-d418d52876ce",
 CellID->645391397]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[484857, 12670, 134, 2, 70, "Subsection",ExpressionUUID->"84d4768a-6ac3-4991-af7e-eef9db27ba4d",
 CellTags->"Section23",
 CellID->153308382],
Cell[484994, 12674, 427, 7, 70, "TechNoteText",ExpressionUUID->"1e1c2310-c205-4cd3-b451-324b912811cb",
 CellID->1821083521],
Cell[485424, 12683, 179, 3, 70, "Input",ExpressionUUID->"41570c88-cec2-45f7-9c8f-485217848933",
 CellID->255167231],
Cell[485606, 12688, 183, 4, 70, "Input",ExpressionUUID->"bb6de47f-7689-426a-a695-da292aef2098",
 CellID->370132468],
Cell[485792, 12694, 280, 5, 70, "TechNoteMathCaption",ExpressionUUID->"3c80b063-2ef0-4e91-9eab-5449efcf733a",
 CellID->1013800403],
Cell[CellGroupData[{
Cell[486097, 12703, 555, 17, 70, "Input",ExpressionUUID->"a00ba718-7d35-4961-952b-969eb43e0fd0",
 CellID->808117923],
Cell[486655, 12722, 1825, 46, 70, "Output",ExpressionUUID->"a4b2cdbf-2ec1-46f2-aeba-9f6ff6b9ab0e",
 CellID->104274221]
}, Open  ]],
Cell[488495, 12771, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"13b9a43d-1a35-4c2a-af69-c3b03875667c",
 CellID->322701359],
Cell[CellGroupData[{
Cell[488730, 12779, 269, 7, 70, "Input",ExpressionUUID->"f1dfab23-28d3-4727-bd08-55bf9c2ff2a8",
 CellID->1245532038],
Cell[489002, 12788, 2437, 57, 70, "Output",ExpressionUUID->"a34a9d44-2533-452d-96ac-b59164e0f869",
 CellID->190176395]
}, Open  ]],
Cell[491454, 12848, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"a1e463bb-57e9-4904-8798-e618ec0350e3",
 CellID->730080199],
Cell[CellGroupData[{
Cell[491675, 12856, 374, 10, 70, "Input",ExpressionUUID->"6ce9e8e8-bef0-4aab-a87c-bba10811b866",
 CellID->1883829282],
Cell[492052, 12868, 3153, 110, 70, "Output",ExpressionUUID->"557013e5-d705-4ae5-9c7a-eb746e5cedd4",
 CellID->839004029]
}, Open  ]],
Cell[495220, 12981, 200, 4, 70, "TechNoteMathCaption",ExpressionUUID->"aeab08d5-1b15-46d3-a855-34ac171902ef",
 CellID->2133759026],
Cell[CellGroupData[{
Cell[495445, 12989, 509, 15, 70, "Input",ExpressionUUID->"ef23ceed-1e4b-453f-bbca-0fce029b38fc",
 CellID->1258528729],
Cell[495957, 13006, 8674, 219, 70, "Output",ExpressionUUID->"c54571ce-4921-48f0-9080-1585378f6494",
 CellID->763089201]
}, Open  ]],
Cell[504646, 13228, 371, 7, 70, "TechNoteMathCaption",ExpressionUUID->"cd61ad7c-5883-43f9-a3c0-fb2aae181b15",
 CellID->702850526],
Cell[CellGroupData[{
Cell[505042, 13239, 217, 5, 70, "Input",ExpressionUUID->"a020634d-7149-4527-834e-be7fa1f547fd",
 CellID->1648731982],
Cell[505262, 13246, 8503, 184, 70, "Output",ExpressionUUID->"b28b6d43-bc4a-4a54-8ca9-4446ef249bef",
 CellID->467861323]
}, Open  ]],
Cell[513780, 13433, 400, 6, 70, "TechNoteMathCaption",ExpressionUUID->"b12c4f67-9ba3-46b1-b433-4e6a70b751b5",
 CellID->328948492],
Cell[CellGroupData[{
Cell[514205, 13443, 222, 5, 70, "Input",ExpressionUUID->"d4d00fba-0612-47a6-8ec6-506cf26f6e16",
 CellID->1014397666],
Cell[514430, 13450, 6533, 129, 70, "Output",ExpressionUUID->"3be05fe6-e4c7-431c-9f1d-1a3aff15d392",
 CellID->1407623994]
}, Open  ]],
Cell[520978, 13582, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"9441bd59-b757-4b03-9637-ee3d8a1ef6d5",
 CellID->608232459],
Cell[CellGroupData[{
Cell[521199, 13590, 338, 9, 70, "Input",ExpressionUUID->"8b6c88d2-b159-4e99-8104-96d7b10b991b",
 CellID->540778693],
Cell[521540, 13601, 2683, 59, 70, "Output",ExpressionUUID->"c201cc3a-5148-4c5a-a254-03db620e840d",
 CellID->1256611806]
}, Open  ]],
Cell[CellGroupData[{
Cell[524260, 13665, 216, 6, 70, "Input",ExpressionUUID->"84631015-a5ca-4e18-8dd0-3515c7860694",
 CellID->326787606],
Cell[524479, 13673, 669, 19, 70, "Output",ExpressionUUID->"a921c1d3-4143-477f-b958-24cb263ab471",
 CellID->1520438844]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[525187, 13697, 741, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"d380ba9b-fa51-4bff-adcf-522775847f6c"],
Cell[525931, 13717, 1138, 30, 70, "RelatedTutorialsSection",ExpressionUUID->"c54abde4-d7f3-4853-aaf6-bd2b1bc52814"],
Cell[527072, 13749, 5258, 133, 70, "TutorialRelatedLinksSection",ExpressionUUID->"e69f9396-44e8-4441-a467-19264a7cf0bc"]
}, Open  ]],
Cell[532345, 13885, 78, 0, 70, "FooterCell",ExpressionUUID->"7d64f766-f332-431b-aa24-d818260b4690"]
}
]
*)

(* End of internal cache information *)
