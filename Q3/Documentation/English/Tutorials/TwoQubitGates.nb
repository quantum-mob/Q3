(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    592042,      15050]
NotebookOptionsPosition[    532427,      13887]
NotebookOutlinePosition[    538375,      14023]
CellTagsIndexPosition[    537959,      14007]
WindowTitle->Two-Qubit Gates
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "416282e9-8d37-441d-93a9-90dcf3cd3b85"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "56bbb3dd-d389-44f2-bd7f-bc65de3b6844"],
        Background->LightDarkSwitched[
          RGBColor[
          0.3843137254901961, 0.4627450980392157, 0.7019607843137254]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "536c0270-0e55-458f-8489-584e4622c308"]
         }],ExpressionUUID->"123edb65-1cbb-4588-af6d-b02c55f8d931"],
         StripOnInput->False],{
        StyleBox["\"CNOT\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/CNOT"], 
         StyleBox[
          "\"ControlledGate\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ControlledGate"], 
         StyleBox["\"CZ\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/CZ"], 
         StyleBox[
          "\"GivensRotation\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/GivensRotation"], 
         StyleBox["\"SWAP\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/SWAP"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "19bc233a-3746-4295-8c77-2a6de2ac9507"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "6a56db26-41b9-4cf4-9bad-a20ea52e6810"]
         }],ExpressionUUID->"cbfc59be-d966-404e-bb96-c0ec8a5117b4"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "870b9847-41d4-40a2-9504-11f42c20d1f1"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "ba8adfd5-510a-44d9-bad7-5aad92cb4ba5"]
         }],ExpressionUUID->"997a840f-bb53-4e61-880d-8c6f141a63ad"],
         StripOnInput->False],{
        "\"Quantum Computation: Overview\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "89230213-8dbd-431c-bce8-6b32c860da4d"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "959e7401-15e3-408a-a02e-3da7b3c4536f"]
         }],ExpressionUUID->"bb06e7dc-65c3-412a-9413-287e2a758068"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/tutorial/TwoQubitGates\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/tutorial/TwoQubitGates"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/\
tutorial/TwoQubitGates.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/tutorial/TwoQubitGates") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "2ac7884b-85f8-446d-a333-9cea45a9dc5a"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "f28606d2-a239-4a05-9e25-d6aeb1f92ba2"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"d440a8b3-d87f-478a-bfe7-fd516ff06b59"],

Cell[CellGroupData[{

Cell["Two-Qubit Gates", "TechNoteTitle",
 CellID->1379112571,ExpressionUUID->"5abd8b83-3067-453c-815f-a95eedaec825"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Controlled-NOT Gate (CNOT)"], 
      "paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1585062394", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Controlled-Unitary Gates"], 
      "paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Controlled-Z Gate (CZ)"], 
      "paclet:QuantumMob/Q3/tutorial/TwoQubitGates#29167796", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["General Unitary Gates"], 
      "paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1476129218", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["SWAP Gate"], 
      "paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1218939314", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], ""}
  }]], "TechNoteJumpBox",ExpressionUUID->"71101875-292e-4fd0-8e49-\
73a0261b8a38"],

Cell[TextData[{
 "This document introduces quantum logic gate operations acting on two \
qubits. Such operations are represented by 4\[Times]4 unitary matrices. We \
will see that any two-qubit gate operations can be decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268"],
 ". A ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268"],
 " acts a unitary operator on one qubit depending on the logical state of the \
other qubit. A controlled-unitary gate on two qubits can be further \
decomposed into factors including only the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1585062394"],
 " and single-qubit rotation gates. In this sense, the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1585062394"],
 " alone is sufficient for any two-qubit gate."
}], "TechNoteText",
 CellID->1465929903,ExpressionUUID->"f4a1890f-0595-48c6-93d9-bb2db2e854a0"],

Cell[TextData[{
 "The ",
 ButtonBox["controlled-unitary",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268"],
 " and ",
 ButtonBox["CNOT gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1585062394"],
 " have various interesting properties that make them useful in implementing \
quantum algorithms. In this document, we first examine the basic properties \
of the CNOT gate, and in particular, how it is used to generate an \
entanglement between two qubits. Then, we discuss the properties of the ",
 ButtonBox["controlled-unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268"],
 " and describe how to implement a controlled-unitary gate in terms of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1585062394"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/SingleQubitGates#1113797362"],
 ". Finally, we discuss how an arbitrary two-qubit unitary operation can be \
decomposed into ",
 ButtonBox["controlled-unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1455445268"],
 "."
}], "TechNoteText",
 CellID->1951481337,ExpressionUUID->"aea1b5f6-7256-476e-9e2a-3d1b0d2aaef8"],

Cell[TextData[{
 "See also Section 2.2 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"Text"}]],ExpressionUUID->
  "a5e0eb7d-6ad5-4259-8a34-e2a360b0bfa6"],
 "."
}], "TechNoteText",
 CellID->1308734266,ExpressionUUID->"3a853e07-f4e2-4d83-b093-af2b487a3b48"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["CNOT"]], "paclet:QuantumMob/Q3/ref/CNOT", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-NOT or CNOT gate", "TechNoteTableText",ExpressionUUID->
     "e7c3205e-af29-4ad6-955c-dd213ee5112e"]},
   {
    TemplateBox[{
      Cell[
       TextData["CZ"]], "paclet:QuantumMob/Q3/ref/CZ", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The controlled-Z or CZ gate", "TechNoteTableText",ExpressionUUID->
     "a2c0b3c5-fa0b-4476-95f2-bc2aa45c7bc9"]},
   {
    TemplateBox[{
      Cell[
       TextData["SWAP"]], "paclet:QuantumMob/Q3/ref/SWAP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "The SWAP gate exchanging the states between two qubits", 
     "TechNoteTableText",ExpressionUUID->
     "8161457a-4110-4934-b34d-9bebcc9c114b"]},
   {
    TemplateBox[{
      Cell[
       TextData["ControlledGate"]], "paclet:QuantumMob/Q3/ref/ControlledGate",
       "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Controlled-unitary gates", "TechNoteTableText",ExpressionUUID->
     "3de67797-8ba6-4483-9112-43c0d73fa557"]},
   {
    TemplateBox[{
      Cell[
       TextData["GivensRotation"]], "paclet:QuantumMob/Q3/ref/GivensRotation",
       "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents two-level unitary transformation", "TechNoteTableText",
     ExpressionUUID->"c019d10e-176d-49e5-8f39-f649627f2a29"]}
  }]], "DefinitionBox",
 CellID->407539380,ExpressionUUID->"71d627c7-c171-4fe3-a0f1-530909fcf15a"],

Cell["Two-qubit gates available in Q3.", "TechNoteCaption",
 CellID->1189009377,ExpressionUUID->"842d905e-fd35-4aee-9e84-3c8141133e8f"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3: Symbolic Quantum Simulation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation:"
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"a8aea9aa-746b-4819-8668-3339dfa7f348"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[278]:=",
 CellID->853967906,ExpressionUUID->"fcf81024-77cc-4876-9394-52cdb5813a06"],

Cell[CellGroupData[{

Cell["Controlled-NOT Gate (CNOT)", "TechNoteSection",
 CellTags->"Section11",
 CellID->1585062394,ExpressionUUID->"ef2d7eed-98b4-48fa-8dba-f39d81ed4b1a"],

Cell[TextData[{
 "The  controlled-NOT or ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:QuantumMob/Q3/ref/CNOT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "507aa0ad-f9a1-4d13-8788-69b608cc13bc"],
 " gate is a quantum logic gate on two qubits that maps the logical basis \
states as"
}], "TechNoteText",
 CellID->609014923,ExpressionUUID->"8d149f78-3667-4a47-ba1a-8fe2c3d83143"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CNOT", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        RowBox[{"c", "\[CirclePlus]", "t"}]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "df97894a-29f6-4bd3-ba8d-a526591c2b82"]
}], "TechNoteText",
 CellID->806749259,ExpressionUUID->"de484052-348f-4a89-bb3f-48ab2ccf0be5"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "2290f4c4-fc60-4095-8ac9-bed41c17ac23"],
 ", where the first qubit is typically called the ",
 StyleBox["control qubit",
  FontSlant->"Italic"],
 " (c) and the second qubit the ",
 StyleBox["target qubit",
  FontSlant->"Italic"],
 " (t)."
}], "TechNoteText",
 CellID->1970532502,ExpressionUUID->"987051b7-41e0-46f0-91bd-dde81ec869e7"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[279]:=",
 CellID->861826122,ExpressionUUID->"cdf3edc4-d1a9-45d5-82b0-fdedd1fa73fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CNOT", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[280]:=",
 CellID->246957080,ExpressionUUID->"d0115030-88e8-4f31-9388-db03be61338e"],

Cell[BoxData[
 RowBox[{"CNOT", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`S[2, QuantumMob`Q3`$]], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[280]=",
 CellID->1268158967,ExpressionUUID->"fdc52139-b456-46d8-af4a-5dc00ba2125e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[281]:=",
 CellID->149239284,ExpressionUUID->"594b7fed-3202-4297-9e01-b9c0e5db9bc3"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[283]//TableForm=",
 CellID->172561894,ExpressionUUID->"10204f55-8d37-4833-bb14-403d0edadd75"]
}, Open  ]],

Cell["\<\
It has the following matrix representation in the logical basis\
\>", "TechNoteText",
 CellID->690265281,ExpressionUUID->"cd886714-d8be-445f-acb6-ec76e65df686"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mat", "]"}]}], "Input",
 CellLabel->"In[284]:=",
 CellID->581916673,ExpressionUUID->"ae117149-30d6-4d4f-b70b-ff40e1f52aed"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[285]//MatrixForm=",
 CellID->1144829008,ExpressionUUID->"1d00c304-6e70-45ed-a038-5e526fdc4dba"]
}, Open  ]],

Cell["\<\
and is expressed in terms of the Pauli operators on the control and target \
qubit as\
\>", "TechNoteText",
 CellID->107481873,ExpressionUUID->"11f2b0cd-659f-4675-91af-2ea7ac5ee11d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "op", "]"}]], "Input",
 CellLabel->"In[286]:=",
 CellID->414092384,ExpressionUUID->"99b61477-0318-4a75-a81c-a9d45db4b66b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]]}]}]], "Output",
 CellLabel->"Out[286]=",
 CellID->1835143983,ExpressionUUID->"8c866d4c-901f-4541-95f6-9a9354ff0a2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", "op", "]"}], "//", "PauliForm"}]], "Input",
 CellLabel->"In[287]:=",
 CellID->597624604,ExpressionUUID->"4a31359a-7547-4136-b769-f63c6d0deea9"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   FractionBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"],
   Rational[1, 2]], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", 
     TemplateBox[{"\"X\""},
      "RowDefault"]}],
    $CellContext`S[2, 1]], "2"], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{
     TemplateBox[{"\"Z\""},
      "RowDefault"], "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[1, 3]], "2"], "-", 
  FractionBox[
   InterpretationBox[
    RowBox[{
     TemplateBox[{"\"Z\""},
      "RowDefault"], "\[CircleTimes]", 
     TemplateBox[{"\"X\""},
      "RowDefault"]}],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1]]], "2"]}]], "Output",
 CellLabel->"Out[287]=",
 CellID->1104784067,ExpressionUUID->"54e7111c-ef9f-4824-9ebe-afdf8994ab71"]
}, Open  ]],

Cell["\<\
In quantum circuit model, it is represented as the following circuit element\
\>", "TechNoteText",
 CellID->1181321350,ExpressionUUID->"ee1b6efa-6586-40ea-9dc5-d20e0d9e203a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[288]:=",
 CellID->981612935,ExpressionUUID->"a69715ef-960d-4561-964e-bccf141a87ec"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[288]=",
 CellID->962202107,ExpressionUUID->"d0f1382f-0b96-4846-8273-f2431f8f6d6f"]
}, Open  ]],

Cell["\<\
where the smaller filled circle indicates the dependence on the state of the \
control qubit and the circled-plus sign denotes the conditional NOT action on \
the target qubit.\
\>", "TechNoteText",
 CellID->606925297,ExpressionUUID->"873a7d5e-4d8e-496b-bc87-2f14662b9204"],

Cell[TextData[{
 "A simple yet important feature of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:QuantumMob/Q3/ref/CNOT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "86bf5651-b57a-48ef-a0e4-87c5c01e0e66"],
 " is to copy the logical state of the control qubit to the target bit \
provided that the target bit is initially set to |0\:27e9; or the reversed \
state when the target qubit is in |1\:27e9. A vital implication is that CNOT \
generates an entangled state when the control qubit is in a superposition:"
}], "TechNoteText",
 CellID->46143429,ExpressionUUID->"e5a6b1f7-4003-4926-89fa-7dfe1d6dec75"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Ket", "[", "]"}], 
      RowBox[{"c", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{
        RowBox[{"S", "[", "1", "]"}], "->", "1"}], "]"}], 
      RowBox[{"c", "[", "1", "]"}]}]}], "//", "KetRegulate"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "->", "out"}], "//", "KetFactor"}]}], "Input",
 CellLabel->"In[289]:=",
 CellID->291014636,ExpressionUUID->"0a8d6244-eb27-4d8e-a834-1d09822aeb4d"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`c[0]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["0", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>]]}], "+", 
       RowBox[{
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`c[1]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}],
    HoldForm],
   QuantumMob`Q3`OTimes[$CellContext`c[0] 
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>] + $CellContext`c[1] 
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]], "\[Rule]", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "0"},
       "RowWithSeparators"]],
     $CellContext`c[0]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["c", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`c[1]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}]}]], "Output",
 CellLabel->"Out[291]=",
 CellID->1178950439,ExpressionUUID->"d1f22758-36e5-4775-8197-29ee5dba6caa"]
}, Open  ]],

Cell[TextData[{
 "Applying a single qubit rotation such the Hadamard gate on the control \
qubit prior to CNOT, one can thus generate entangled states from logical \
states. In this sense, such a circuit is called a ",
 StyleBox["quantum entangler circuit",
  FontSlant->"Italic"],
 ".  In general, the different product states in the logical basis are \
transformed to different ",
 StyleBox[ButtonBox["Bell states",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/BellState"],
  FontSlant->"Italic"],
 "."
}], "TechNoteText",
 CellID->1152615977,ExpressionUUID->"0dde469d-778a-42f0-a1e0-dde6f9ad17f7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "op"}], "]"}]}]], "Input",
 CellLabel->"In[292]:=",
 CellID->1714229499,ExpressionUUID->"567df8ef-0372-408c-a8c0-98c9d7790b08"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->154.79999999999998`,
   PlotRange->{{0, 3}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[292]=",
 CellID->1935901051,ExpressionUUID->"5bc72b0e-3494-41ae-9f1f-23b4dfae92e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[293]:=",
 CellID->1435008719,ExpressionUUID->"da8da86a-e2fe-467f-a3ce-c2e2e0eaea30"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
         SqrtBox["2"]], "+", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
         SqrtBox["2"]]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
         SqrtBox["2"]], "-", 
        FractionBox[
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], 
         SqrtBox["2"]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[295]//TableForm=",
 CellID->164228460,ExpressionUUID->"39eb1317-bfc4-4599-8dec-792d09fa12c8"]
}, Open  ]],

Cell[TextData[{
 "One can further generalize the above procedure to generate maximally \
entangled states between larger systems: Consider two quantum registers, each \
consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "81314ce4-21db-4d74-ae95-4b82869d0b7a"],
 " qubits. We respectively call them the \[OpenCurlyQuote]control\
\[CloseCurlyQuote] and \[OpenCurlyQuote]target\[CloseCurlyQuote] register for \
the reason that will be clear below. Upon applying the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["CNOT"]], "paclet:QuantumMob/Q3/ref/CNOT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "fc187a64-ab66-4e2c-9009-87f31181b8e4"],
 " gate on each pair of the corresponding qubits in the two registers as in \
the quantum circuit,"
}], "TechNoteText",
 CellID->1854176847,ExpressionUUID->"a8ec5281-be83-4b9a-9b49-40aa60093263"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"$n", "+", "1"}], ",", 
     RowBox[{"2", "$n"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Sequence", "@@", 
     RowBox[{"MapThread", "[", 
      RowBox[{"CNOT", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"S", "@", "cc"}], ",", 
         RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[296]:=",
 CellID->1015065912,ExpressionUUID->"1d55f05f-8eb5-42c4-a7a3-9d7e35833bcb"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}, {{0, -6}, {4, -6}}, {{0, -7}, {4, -7}}}], {
     LineBox[{{1, -1}, {1, -5}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, {
     LineBox[{{2, -2}, {2, -6}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -6}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -6}, {2.2666666666666666`, -6}}, {{
         2, -6.266666666666667}, {2, -5.733333333333333}}}]}}, {
     LineBox[{{3, -3}, {3, -7}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -7}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -7}, {3.2666666666666666`, -7}}, {{
         3, -7.266666666666667}, {3, -6.733333333333333}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-7.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[4, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[5, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[6, QuantumMob`Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[299]=",
 CellID->671240825,ExpressionUUID->"152f4a8c-f269-4975-8052-0ff386308d4a"]
}, Open  ]],

Cell["the logical basis states are transformed as", "TechNoteText",
 CellID->1898388060,ExpressionUUID->"aafa1906-984a-4ecc-9540-56cbea4d81fa"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       RowBox[{"c", "\[CirclePlus]", "t"}]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "6603d8be-1d5c-4104-9ac7-4333a5a39f81"],
 " ."
}], "TechNoteText",
 CellID->1043580941,ExpressionUUID->"78123947-cac1-4dd1-9096-b7ceaf4e092b"],

Cell[TextData[{
 "The above association rule is formally the same as the one in (2.29) for a \
single pair of qubits. Here, however, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"c"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["c", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["c", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "4d9c57bc-7687-4d21-9acf-c9e5efe85a98"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"t"},
     "Ket"], " ", ":=", " ", 
    RowBox[{
     TemplateBox[{
       SubscriptBox["t", "1"]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "2"]},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{
       SubscriptBox["t", "n"]},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "cbee5776-cfdf-4324-abe2-7323e87d92e3"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[CirclePlus]", " ", "t"}], TraditionalForm]],
  ExpressionUUID->"dbaf9e7b-4940-4b39-a11c-b107c2d3e5f5"],
 " denotes the bit-wise exclusive OR (or XOR),"
}], "TechNoteText",
 CellID->965930338,ExpressionUUID->"1c094848-45ef-4ee7-ac3f-babdd0585392"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", "\[CirclePlus]", "t"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["t", "1"]}], ",", 
      RowBox[{
       SubscriptBox["c", "2"], "\[CirclePlus]", 
       SubscriptBox["t", "2"]}], ",", "\[Ellipsis]", ",", 
      RowBox[{
       SubscriptBox["c", "n"], "\[CirclePlus]", 
       SubscriptBox["t", "n"]}]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "70d7e50b-a5d6-484c-86b9-2640bc528e14"],
 " ,"
}], "TechNoteText",
 CellID->1562303093,ExpressionUUID->"d41670cb-3828-4e77-a2da-28e3f1d64991"],

Cell[TextData[{
 "for the n-bit strings ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["c", "1"], ",", 
      SubscriptBox["c", "2"], ",", "...", ",", 
      SubscriptBox["c", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "19344cd8-ecbc-49d6-afe5-d447c511b895"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", " ", "\[Congruent]", " ", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["t", "1"], ",", 
      SubscriptBox["t", "2"], ",", "...", ",", 
      SubscriptBox["t", "n"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "51290b5f-edad-4235-8911-4e44d8f9f266"],
 ". When the target register is prepared in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "f79e9118-1034-4fc7-9180-798655435231"],
 ", the logical basis state of the control register is copied to the target \
register,"
}], "TechNoteText",
 CellID->345532182,ExpressionUUID->"8b25d741-bebc-4566-bc67-a427ccf5f690"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "3fea0e5b-6d18-4a85-b9e8-9fefdbf14df2"]
}], "TechNoteText",
 CellID->563601386,ExpressionUUID->"ead3dbf6-b5c6-4f9a-99bb-018c961b5fe4"],

Cell[TextData[{
 "under the set of CNOT gates on paired qubits. More interestingly, when the \
control register is prepared in a superposition, say, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "12876f40-9399-43c8-aa11-4a43733e9d01"],
 ", and the target register x=0 is in the state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[Congruent]", 
    SuperscriptBox[
     TemplateBox[{"0"},
      "Ket"], 
     RowBox[{"\[CircleTimes]", "n"}]]}], TraditionalForm]],ExpressionUUID->
  "b982ad13-36b2-4bf5-b2a3-a02d4132e4c6"],
 ", the CNOT gate makes a copy of each logical state of the control register \
to the target register, leading to a maximally entangled state,"
}], "TechNoteText",
 CellID->2045611232,ExpressionUUID->"03cc6698-77ef-43b7-8292-aca01611a78f"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["2", 
          RowBox[{"n", "/", "2"}]]], 
        RowBox[{
         SubsuperscriptBox["\[Sum]", 
          RowBox[{"x", "=", "0"}], 
          RowBox[{
           SuperscriptBox["2", "n"], "-", "1"}]], 
         TemplateBox[{"x"},
          "Ket"]}]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"0"},
       "Ket"]}], "\[RightTeeArrow]", 
     TemplateBox[{"\[CapitalPhi]"},
      "Ket"]}], ":=", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "74832451-00b5-4d5f-8bbb-03cbda78ba41"]
}], "TechNoteText",
 CellID->1522271401,ExpressionUUID->"c670a09c-1c42-42b7-95e9-40a3d2ea495f"],

Cell[TextData[{
 "between the two registers (rather than single qubits). Since the \
superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["2", 
     RowBox[{
      RowBox[{"-", "n"}], "/", "2"}]], 
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{
       SuperscriptBox["2", "n"], "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "00bfb8e4-284c-42e9-a135-d85fe13b7acc"],
 " is obtained just by the ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/Hadamard"],
 ", the maximally entangled state ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[CapitalPhi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "811ee30f-3465-4913-8855-4d06f0f1f787"],
 " can be generated from the logical state ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "3ca5e1f5-5396-405d-a882-3373934795eb"],
 " through the following quantum circuit."
}], "TechNoteText",
 CellID->1842749896,ExpressionUUID->"36eec8b3-b38d-41e8-aa8b-bd734ed484b8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qce", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"cc", ",", "6"}], "]"}], ",", "qc"}], "]"}]}]], "Input",
 CellLabel->"In[300]:=",
 CellID->88345038,ExpressionUUID->"46bdb5a1-2fe7-4be0-acf7-671c5fdd6c75"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
     0, -5}, {5, -5}}, {{0, -6}, {5, -6}}, {{0, -7}, {5, -7}}}], {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1., -3.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -1}, {2, -5}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -5}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -5}, {2.2666666666666666`, -5}}, {{
         2, -5.266666666666667}, {2, -4.733333333333333}}}]}}, {
     LineBox[{{3, -2}, {3, -6}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -6}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -6}, {3.2666666666666666`, -6}}, {{
         3, -6.266666666666667}, {3, -5.733333333333333}}}]}}, {
     LineBox[{{4, -3}, {4, -7}}], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -7}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -7}, {4.266666666666667, -7}}, {{
         4, -7.266666666666667}, {4, -6.733333333333333}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->226.79999999999998`,
   PlotRange->{{0, 5}, {-7.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[4, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[5, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[6, QuantumMob`Q3`$]}], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[300]=",
 CellID->812948084,ExpressionUUID->"8e28fe73-2eac-4c5d-854e-6225d56ded50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qce", "**", 
    RowBox[{"Ket", "[", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SimpleForm", "[", 
  RowBox[{"out", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "@", "cc"}], ",", 
     RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], "Input",
 CellLabel->"In[301]:=",
 CellID->1915435092,ExpressionUUID->"10a7ad12-932a-4ea6-a706-217a180f5164"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`S[4, QuantumMob`Q3`$] -> 
      0, $CellContext`S[5, QuantumMob`Q3`$] -> 
      0, $CellContext`S[6, QuantumMob`Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "0", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      1, $CellContext`S[4, QuantumMob`Q3`$] -> 
      0, $CellContext`S[5, QuantumMob`Q3`$] -> 
      0, $CellContext`S[6, QuantumMob`Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`S[4, QuantumMob`Q3`$] -> 
      0, $CellContext`S[5, QuantumMob`Q3`$] -> 
      1, $CellContext`S[6, QuantumMob`Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "0", "1", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 
      1, $CellContext`S[4, QuantumMob`Q3`$] -> 
      0, $CellContext`S[5, QuantumMob`Q3`$] -> 
      1, $CellContext`S[6, QuantumMob`Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`S[4, QuantumMob`Q3`$] -> 
      1, $CellContext`S[5, QuantumMob`Q3`$] -> 
      0, $CellContext`S[6, QuantumMob`Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "0", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      1, $CellContext`S[4, QuantumMob`Q3`$] -> 
      1, $CellContext`S[5, QuantumMob`Q3`$] -> 
      0, $CellContext`S[6, QuantumMob`Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "0"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "0"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`S[4, QuantumMob`Q3`$] -> 
      1, $CellContext`S[5, QuantumMob`Q3`$] -> 
      1, $CellContext`S[6, QuantumMob`Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{";", "\";\"", 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "1"}, 
         "RowWithSeparators"], 
        TemplateBox[{
         "\[VeryThinSpace]", "\"\[VeryThinSpace]\"", "1", "1", "1"}, 
         "RowWithSeparators"]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 
      1, $CellContext`S[4, QuantumMob`Q3`$] -> 
      1, $CellContext`S[5, QuantumMob`Q3`$] -> 
      1, $CellContext`S[6, QuantumMob`Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[302]=",
 CellID->927485574,ExpressionUUID->"c218bd49-0628-4daf-8c1e-6e4a2f630cad"]
}, Open  ]],

Cell["\<\
It is also interesting to note that even though |\[CapitalPhi]\:27e9 is a \
maximally entangled state between the control and target registers, it is a \
product state of n maximally entangled pairs\
\>", "TechNoteText",
 CellID->716147443,ExpressionUUID->"f25c67f6-d459-45bf-b3ce-a0a1e78133e9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", 
      SuperscriptBox["2", 
       RowBox[{"n", "/", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"x"},
        "Ket"]}]}]}], "=", 
    RowBox[{
     SubsuperscriptBox["\[CircleTimes]", 
      RowBox[{"k", "=", "1"}], "n"], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"0"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}], "+", 
        RowBox[{
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], "k"], "\[CircleTimes]", 
         SubscriptBox[
          TemplateBox[{"1"},
           "Ket"], 
          RowBox[{"n", "+", "k"}]]}]}], 
       SqrtBox["2"]], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "112d5382-7323-497c-9c82-679ce595ecdf"],
 " ."
}], "TechNoteText",
 CellID->1791716713,ExpressionUUID->"fa0a218d-7caf-48cb-b46c-44b8cd03f4ad"],

Cell["\<\
The entanglement strongly depends on how you partition the system.\
\>", "TechNoteText",
 CellID->1367097157,ExpressionUUID->"382dfd14-ed06-4bed-88f0-a3a2a6f8f294"],

Cell["\<\
Another generalization of copying logical basis states to a series of qubits \
by consecutively applying CNOT gates with a single control qubit on multiple \
target qubits is shown in the following quantum circuit,\
\>", "TechNoteText",
 CellID->874378446,ExpressionUUID->"2b645087-fbaf-446a-86c1-2db08b00e9b6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"Distribute", "[", 
    RowBox[{
     RowBox[{"CNOT", "[", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "]"}], ",", "List"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[303]:=",
 CellID->447945501,ExpressionUUID->"459bfa87-f754-438b-b52a-6337d7c96ef2"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -4}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[307]=",
 CellID->1813732292,ExpressionUUID->"94efc6d9-ea81-4f4c-8400-1be6b5d4067c"]
}, Open  ]],

Cell["or equivalently,", "TechNoteText",
 CellID->880946029,ExpressionUUID->"b6b4e097-f32c-465a-8bf5-40142d46f540"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"$n", "-", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tt", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"CNOT", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "@", "cc"}], ",", 
       RowBox[{"S", "@", "tt"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Sequence", "@@", "cnot"}], "]"}]}]}], "Input",
 CellLabel->"In[308]:=",
 CellID->1307646985,ExpressionUUID->"9191fedb-5666-4311-9425-1eb92858985c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[311]=",
 CellID->2015746126,ExpressionUUID->"aae04722-12ee-4801-b372-0bf6a687549a"]
}, Open  ]],

Cell["\<\
When the target qubits are all prepared in the logical basis state |0\:27e9, \
the series of CNOT gates makes the transformation\
\>", "TechNoteText",
 CellID->169608441,ExpressionUUID->"d325e5f5-0af6-4c94-a753-a3ee604cbf5c"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"0"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
     TemplateBox[{"x"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "6e62b8c7-0b83-45ea-afaf-9332bd928289"]
}], "TechNoteText",
 CellID->898268318,ExpressionUUID->"c79313af-8140-487c-bb59-81320c461600"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"x", "=", "0"}], ",", "1"}], TraditionalForm]],ExpressionUUID->
  "a3c35a55-0671-4d64-bf0f-0cac112318bd"],
 ". Therefore, a simple application of the Hadamard gate in the control qubit \
before the CNOT gates, "
}], "TechNoteText",
 CellID->385582216,ExpressionUUID->"43bc5cca-2f0a-4b46-91a5-5edc36aa8425"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
      0, -4}, {5, -4}}}], {InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, 0.5}]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, 0.5}]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, 0.5}]], InsetBox[
       StyleBox[
        TemplateBox[{"0"},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.06400000000000002],
        FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, 0.5}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {1, -1}, ImageScaled[{0.5, 0.5}]]}, {
      LineBox[{{2, -1}, {2, -2}}], 
      DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
       LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
          2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
      LineBox[{{3, -1}, {3, -3}}], 
      DiskBox[{3, -1}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
       LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
          3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}, {
      LineBox[{{4, -1}, {4, -4}}], 
      DiskBox[{4, -1}, 0.09], {CircleBox[{4, -4}, 0.26666666666666666], 
       LineBox[{{{3.7333333333333334`, -4}, {4.266666666666667, -4}}, {{
          4, -4.266666666666667}, {4, -3.7333333333333334`}}}]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->226.79999999999998`,
    PlotRangePadding->Scaled[0.025]], ","}]}]], "TechNoteText",
 CellID->1620101282,ExpressionUUID->"ef0fd21d-2944-42bd-97e4-2616566b7fae"],

Cell["can generate a state of the form", "TechNoteText",
 CellID->712578174,ExpressionUUID->"5b91374c-6991-4212-8308-d845db220cae"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"GHZ"},
     "Ket"], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"0"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", "\[CenterEllipsis]", "\[CircleTimes]", 
       TemplateBox[{"1"},
        "Ket"]}]}], 
     SqrtBox["2"]]}], TraditionalForm]],ExpressionUUID->
  "57afee82-9c76-4648-8400-f47a9e2b02b8"],
 " ."
}], "TechNoteText",
 CellID->1522141313,ExpressionUUID->"a69f0138-9d11-4935-bb3a-e61f3f632f12"],

Cell["\<\
The above state, which is known as the Greenberger-Horne-Zeilinger (GHZ) \
state (Greenberger et al., 1989), exhibits a quantum entanglement of more \
than two particles. It has stimulated tests of non-locality of quantum \
mechanics beyond Bell inequalities (Bouwmeester et al., 1999; Pan et al., \
2000).\
\>", "TechNoteText",
 CellID->1803844527,ExpressionUUID->"3265e1c4-5b06-443a-a38b-be08481e421d"],

Cell[TextData[{
 "Quantum entanglement is a valuable resource in quantum information \
processing and in quantum communication. The most popular example of such is ",
 ButtonBox["quantum teleportation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/QuantumTeleportation"],
 "."
}], "TechNoteText",
 CellID->1188320590,ExpressionUUID->"05c0873c-180b-4b31-b7a9-38d5ddb3c83b"],

Cell["\<\
In the above consideration, CNOT gates with the same control qubit are \
applied on different target qubits. The opposite setting brings forth \
additional applications of CNOT as illustrated in the following quantum \
circuit.\
\>", "TechNoteText",
 CellID->506239030,ExpressionUUID->"7937a04d-c0d5-4864-a726-3b318ec03988"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, 0.5}]]}, {
     LineBox[{{1, -1}, {1, -4}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -4}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -4}, {1.2666666666666666`, -4}}, {{
         1, -4.266666666666667}, {1, -3.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -4}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -4}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -4}, {2.2666666666666666`, -4}}, {{
         2, -4.266666666666667}, {2, -3.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, InsetBox[
     StyleBox[
      TemplateBox[{
        RowBox[{
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
          "\[CirclePlus]", 
          FormBox[
           SubscriptBox[
            TemplateBox[{"x"}, "RowDefault"], 
            TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
       "Ket"],
      StripOnInput->False,
      FontSize->Scaled[0.08000000000000002],
      FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, 0.5}]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->1226753413,ExpressionUUID->"4a7a1b8f-be18-4f04-8573-b4dca518fd45"],

Cell["\<\
 In this quantum circuit, the successive application of the CNOT gates on the \
same target qubit with different control qubits results in the accumulation \
of the logical bit values of all qubits. The same goal may be achieved by \
applying the CNOT gates on the consecutive pairs of qubits as\
\>", "TechNoteText",
 CellID->365203462,ExpressionUUID->"819170f0-e2c5-4564-a4a5-67da3b308aef"],

Cell[BoxData[
 RowBox[{"\t", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -1}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -2}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -3}, ImageScaled[{1, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {-0.1, -4}, ImageScaled[{1, 0.5}]]}, {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, {InsetBox[
      StyleBox[
       TemplateBox[{
         FormBox[
          SubscriptBox[
           TemplateBox[{"x"}, "RowDefault"], 
           TemplateBox[{"1"}, "RowDefault"]], TraditionalForm]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -1}, ImageScaled[{0, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -2}, ImageScaled[{0, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -3}, ImageScaled[{0, 0.5}]], InsetBox[
      StyleBox[
       TemplateBox[{
         RowBox[{
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"1"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"2"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"3"}, "RowDefault"]], TraditionalForm], 
           "\[CirclePlus]", 
           FormBox[
            SubscriptBox[
             TemplateBox[{"x"}, "RowDefault"], 
             TemplateBox[{"4"}, "RowDefault"]], TraditionalForm]}]},
        "Ket"],
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light"], {4.1, -4}, ImageScaled[{0, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.2, 102.60000000000001`}, {5, 5}},
   ImageSize->271.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->977674470,ExpressionUUID->"373f366c-7413-4792-9220-219fdb55500d"],

Cell[TextData[{
 "In this case, not only the last qubit but also the qubits in the middle are \
modified. However, this makes little difference since the quantum circuit \
block is mostly used to conditionally control the operation of an unitary \
gate on a different qubit and the whole block must be undone anyway (see, for \
example, the ",
 ButtonBox["quantum circuit of conditional unitary gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1379525988"],
 ")."
}], "TechNoteText",
 CellID->833871357,ExpressionUUID->"b8f2ca1d-fe95-4f76-82be-8d50fc84dc39"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Z Gate (CZ)", "TechNoteSection",
 CellTags->"Section12",
 CellID->29167796,ExpressionUUID->"d19f8df7-8585-487f-bc79-cbc9368fc2e4"],

Cell["\<\
An interesting variant of CNOT gates is the so-called controlled-Z or CZ \
gate. This is a quantum logic gate on two qubits that maps the logical basis \
states as\
\>", "TechNoteText",
 CellID->596875856,ExpressionUUID->"07f46add-f0ee-4c55-b1c0-8e0be22cbe6b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"CZ", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      SuperscriptBox[
       RowBox[{
        TemplateBox[{"t"},
         "Ket"], "(", 
        RowBox[{"-", "1"}], ")"}], 
       RowBox[{"c", " ", "t"}]]}]}]}], TraditionalForm]],ExpressionUUID->
  "778f4e21-a253-4182-8a9b-aca87a1a7265"]
}], "TechNoteText",
 CellID->796396655,ExpressionUUID->"f4f1e32c-bdd0-4ed8-bb89-0f03070fb06c"],

Cell[TextData[{
 "for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", ",", 
    RowBox[{"t", "\[Element]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
  "395e5698-9995-46e3-81ff-43f718b7c1a4"],
 "."
}], "TechNoteText",
 CellID->1920492481,ExpressionUUID->"8edc9c6f-35ea-4127-a01f-509f4a8928ff"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[312]:=",
 CellID->754200946,ExpressionUUID->"8925cbcf-23e3-4655-ad27-7ef486a591f6"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[313]:=",
 CellID->1406814828,ExpressionUUID->"e65e8100-31b9-4038-ade9-99045740b9ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"CZ", "[", 
   RowBox[{
    RowBox[{"S", "[", "1", "]"}], ",", 
    RowBox[{"S", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[314]:=",
 CellID->1037913757,ExpressionUUID->"8e5860bf-e840-489f-8170-9c07873f4145"],

Cell[BoxData[
 RowBox[{"CZ", "[", 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`S[1, QuantumMob`Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], "]"}]], "Output",
 CellLabel->"Out[314]=",
 CellID->2090608257,ExpressionUUID->"dda7132b-ce91-43f4-813e-eddb549b6fc1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[315]:=",
 CellID->1887946780,ExpressionUUID->"f7411456-275c-477e-b45d-7bc3a2f257a3"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{"-", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
             
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                 $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[317]//TableForm=",
 CellID->1873026832,ExpressionUUID->"ea322d9f-53b4-4cc7-a330-3e54e7b932d6"]
}, Open  ]],

Cell["\<\
The matrix representation of the CZ gate in the logical basis is given by\
\>", "TechNoteText",
 CellID->1230965299,ExpressionUUID->"d51f44bb-eefa-44ee-88a0-d2901f250fce"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[318]:=",
 CellID->2123808742,ExpressionUUID->"c642b11c-0f6e-479a-997b-662cdae9ec69"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1, 1, 1, -1}}]]]]], "Output",\

 CellLabel->"Out[318]//MatrixForm=",
 CellID->2146667698,ExpressionUUID->"ddb4ffcf-881e-4f83-b619-60ba8419b907"]
}, Open  ]],

Cell["\<\
Since it is symmetric for the two qubits, a distinction of the control and \
target qubit is meaningless. Accordingly, in quantum circuit model, the gate \
is depicted by the following quantum circuit element\
\>", "TechNoteText",
 CellID->776960470,ExpressionUUID->"923e65fd-290f-4df3-874d-b5214432233f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "op", "]"}]], "Input",
 CellLabel->"In[319]:=",
 CellID->1674045530,ExpressionUUID->"cfb30244-a68a-4591-8476-000d354c072d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CZ[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[319]=",
 CellID->1318730686,ExpressionUUID->"59ed12d6-0fb4-4b24-b782-337fd4a0fc38"]
}, Open  ]],

Cell["\<\
The filled circles on both qubit lines (rather than a square box on either \
qubit) indicate that the bit values of both qubits remain unchanged.\
\>", "TechNoteText",
 CellID->573709808,ExpressionUUID->"4850fc89-615b-4959-ac9e-85d2a61872a4"],

Cell[TextData[{
 "Noting the identity ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"H", " ", "Z", " ", "H"}], "=", "X"}], TraditionalForm]],
  ExpressionUUID->"81e4486e-2ecc-4ba7-bee4-18e4c5671105"],
 ", one can regard that the CZ gate is equal to the CNOT gate up to the \
Hadamard gate on the target qubit. The relation between the CNOT and CZ gate \
is illustrated in the following quantum circuits"
}], "TechNoteText",
 CellID->139168026,ExpressionUUID->"fb88aa80-38c5-4cdd-a89f-71524c35e053"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz1", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}], ",", 
    RowBox[{"CZ", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "6"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cz2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "6"}], "]"}]}], "]"}]}]}], "Input",\

 CellLabel->"In[320]:=",
 CellID->387321399,ExpressionUUID->"45057138-bd46-4162-a43c-b221864d1bac"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[320]=",
 CellID->1875402562,ExpressionUUID->"86848a9e-8be8-41cc-a713-7b826ca70ad7"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], DiskBox[{2, -2}, 0.09]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[2, 6], 
   QuantumMob`Q3`CZ[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   $CellContext`S[2, 6]]]], "Output",
 CellLabel->"Out[321]=",
 CellID->1273372515,ExpressionUUID->"fc395e28-3617-4570-aaca-9dab7a78b907"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {3., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}, 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6]}]]], "Output",
 CellLabel->"Out[322]=",
 CellID->1897317250,ExpressionUUID->"c7de34ca-c998-44c1-8d3b-036e7b300717"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cnot", "==", "cz1", "==", "cz2"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[323]:=",
 CellID->1606586072,ExpressionUUID->"a5c62cfd-83c5-4448-a6cd-e79a7df3fb06"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[323]=",
 CellID->226346447,ExpressionUUID->"16724a0f-d201-4865-b7fe-1ddd30a5a541"]
}, Open  ]],

Cell["\<\
Depending on the Hamiltonian of a particular physical system, direct \
realization of the CNOT gate may be considerably difficult while the CZ gate \
is relatively easier to implement. In such a case, the above identity offers \
a straightforward workaround for a physical implementation of the CNOT gate.\
\>", "TechNoteText",
 CellID->799932562,ExpressionUUID->"3aeb97d8-c6ee-4847-8666-184a6f44eb44"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SWAP Gate", "TechNoteSection",
 CellTags->"Section13",
 CellID->1218939314,ExpressionUUID->"f2662b15-9f86-4e39-b643-ce888942a406"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[324]:=",
 CellID->1843914595,ExpressionUUID->"c404b418-b44b-4e9a-b4a9-63bc986cbe27"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[325]:=",
 CellID->336088308,ExpressionUUID->"80c74cc8-777b-4c52-9045-7bd41b690042"],

Cell[TextData[{
 "Another interesting two-qubit gate is the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["SWAP"]], "paclet:QuantumMob/Q3/ref/SWAP", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "d711e5d7-616d-4d57-bb78-fd0579b13b35"],
 " gate that \[OpenCurlyQuote]swaps\[CloseCurlyQuote] the states of the two \
qubits and maps the logical basis states as"
}], "TechNoteText",
 CellID->1866541665,ExpressionUUID->"9187829a-3718-4002-85ae-d2cf65439e83"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"SWAP", ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["x", "2"]},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{
        SubscriptBox["x", "1"]},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "fb007307-e25b-4215-b080-17cabf5c7358"]
}], "TechNoteText",
 CellID->524648279,ExpressionUUID->"578760b0-6f66-4703-a17a-615b1f5c03ef"],

Cell[BoxData[
 RowBox[{"for", " ", 
  RowBox[{Cell[TextData[Cell[BoxData[
    FormBox[
     RowBox[{
      SubscriptBox["x", "1"], ",", 
      RowBox[{
       SubscriptBox["x", "2"], "\[Element]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}]}], TraditionalForm]],ExpressionUUID->
    "c26fef9c-a504-4d5f-a4fd-7ecfafda7e59"]],ExpressionUUID->
    "d880c4ad-ee9d-48ca-892a-72ffd864e786"], "."}]}]], "TechNoteText",
 CellID->195770571,ExpressionUUID->"e1a955ff-10c9-4f87-9b49-ed2d658f4750"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"op", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[326]:=",
 CellID->371039593,ExpressionUUID->"d159e4bf-65a0-4f7e-9b9e-fe6d6b26dc0c"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[329]//TableForm=",
 CellID->1011195892,ExpressionUUID->"aef58851-ec9a-4987-88db-f44f42231320"]
}, Open  ]],

Cell[TextData[{
 "Given that the states ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"0"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"0"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "40afedc1-ed77-4c0a-b33c-a1ad8abc8463"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"1"},
     "Ket"], "\[CircleTimes]", 
    TemplateBox[{"1"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "3570f1c1-2955-4ed4-91df-a6e6a9a24e9d"],
 " are not altered by the operation, the\nmatrix representation is given by"
}], "TechNoteText",
 CellID->809087288,ExpressionUUID->"b4879f5a-69cf-40d1-bbd0-433d483763d0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "op", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[330]:=",
 CellID->463596612,ExpressionUUID->"5d124695-7db0-4395-9ac5-93983e872b02"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 0,
       1, 0, 1, 1, 0}}]]]]], "Output",
 CellLabel->"Out[330]//MatrixForm=",
 CellID->2131258133,ExpressionUUID->"5ee1737d-38e7-4a71-b35e-0bd0bf40be87"]
}, Open  ]],

Cell["In quantum circuit model, it is depicted as", "TechNoteText",
 CellID->2003915004,ExpressionUUID->"bdb870de-7431-4284-a7a6-85a0a1d1577f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellLabel->"In[331]:=",
 CellID->813436327,ExpressionUUID->"b980104c-2e73-4e80-bc56-0fe42fd8d0ab"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.8200000000000001, -1.18}, {1.18, -0.8200000000000001}}, {{
      0.8200000000000001, -0.8200000000000001}, {1.18, -1.18}}}], 
     LineBox[{{{0.8200000000000001, -2.18}, {1.18, -1.82}}, {{
      0.8200000000000001, -1.82}, {1.18, -2.18}}}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`SWAP[
    $CellContext`S[1, QuantumMob`Q3`$], 
    $CellContext`S[2, QuantumMob`Q3`$]]]]], "Output",
 CellLabel->"Out[331]=",
 CellID->28209371,ExpressionUUID->"d6522264-3156-4c80-9e94-9b1dbd785ba4"]
}, Open  ]],

Cell[TextData[{
 "The SWAP gate can be implemented using the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/CNOT"],
 ". To see this, first note that a simultaneous exchange of the second and \
fourth columns and rows of the above matrix leads to"
}], "TechNoteText",
 CellID->534468518,ExpressionUUID->"70435642-b7f7-4a4c-92ce-d298002eb893"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "//", "Matrix"}], "//", 
  "MatrixForm"}]], "Input",
 CellLabel->"In[332]:=",
 CellID->2035770272,ExpressionUUID->"3082a6de-1b24-44e3-82ab-b7464d648995"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"},
     {"0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {2}, {2}, {1}, {3}, {4}, {4}, {3}}}, {1, 0, 1,
       0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[332]//MatrixForm=",
 CellID->1668496057,ExpressionUUID->"b775c061-3041-46ac-9333-1d2a1a140cc5"]
}, Open  ]],

Cell[TextData[{
 "which is nothing other than the matrix representation of the ",
 ButtonBox["CNOT gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/CNOT"],
 ". On the other hand, the exchange of the second and fourth columns and rows \
is equivalent to flipping the bit values of the first qubit only when the \
second qubit is set to |1\:27e9. Hence, it corresponds to the CNOT gate with \
the second and first qubit as the control and target qubit, respectively. In \
short, the ",
 ButtonBox["SWAP gate",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/SWAP"],
 " can be achieved by a combination of the CNOT gates as follows"
}], "TechNoteText",
 CellID->1603079182,ExpressionUUID->"99971c80-2296-45b0-b89b-99c2b306aee3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"swap", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"SWAP", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cnot", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", 
      RowBox[{"S", "[", "1", "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[333]:=",
 CellID->621976612,ExpressionUUID->"10b93dab-9d21-4ede-8b12-be500fe7aefa"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     LineBox[{{{0.8200000000000001, -1.18}, {1.18, -0.8200000000000001}}, {{
      0.8200000000000001, -0.8200000000000001}, {1.18, -1.18}}}], 
     LineBox[{{{0.8200000000000001, -2.18}, {1.18, -1.82}}, {{
      0.8200000000000001, -1.82}, {1.18, -2.18}}}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`SWAP[
    $CellContext`S[1, QuantumMob`Q3`$], 
    $CellContext`S[2, QuantumMob`Q3`$]]]]], "Output",
 CellLabel->"Out[333]=",
 CellID->571767473,ExpressionUUID->"a7ce4fda-9244-47f9-bc77-d10b1b1501dc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[334]=",
 CellID->1854082033,ExpressionUUID->"a3d03b7d-0d38-4210-b881-dd7988959dec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"swap", "==", "cnot"}], "//", "Elaborate"}]], "Input",
 CellLabel->"In[335]:=",
 CellID->661500490,ExpressionUUID->"ffb66605-bd3e-4b46-85c9-e1285c382683"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[335]=",
 CellID->1569010661,ExpressionUUID->"1cb786be-729f-404d-afdb-c03fdee57084"]
}, Open  ]],

Cell[TextData[{
 "Interestingly, the SWAP gate itself is not universal, but the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "325964f5-c5ba-48e9-a272-7895927ece07"],
 " gate\[LongDash]the gate that equals SWAP when squared\[LongDash]is \
universal. That is, any quantum gate on a multi-qubit system can be \
implemented by combining ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "084b7a9c-bba3-4841-aa74-7e6302973247"],
 " and ",
 ButtonBox["single-qubit rotations",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/SingleQubitGates"],
 ". Indeed, one can combine the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "68eb3aad-6da3-4bb8-8b8c-511763c6dc47"],
 " gate with single-qubit rotations to construct the CZ gate (see the \
demonstration below). As discussed above, the CZ gate requires just two more ",
 ButtonBox["Hadamard gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/SingleQubitGates#347838345"],
 " to implement the CNOT gate, and it is hence universal."
}], "TechNoteText",
 CellID->666193793,ExpressionUUID->"3001a539-c9ee-4be7-8832-4376e3eea3c7"],

Cell[TextData[{
 "Let us construct the CZ gate with the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "6f43f407-eefb-42f3-bc6a-a1eb5fa54bdb"],
 "gate. Here is the matrix representation of the the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "82c72724-71a9-411e-8b22-e045f9592c16"],
 "gate."
}], "TechNoteText",
 CellID->1938247085,ExpressionUUID->"502550c5-81cd-4851-8754-743e331dcc53"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"MatrixPower", "[", 
    RowBox[{
     RowBox[{"Matrix", "@", 
      RowBox[{"Elaborate", "@", 
       RowBox[{"SWAP", "[", 
        RowBox[{
         RowBox[{"S", "[", "1", "]"}], ",", 
         RowBox[{"S", "[", "2", "]"}]}], "]"}]}]}], ",", 
     RowBox[{"1", "/", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[336]:=",
 CellID->1040933486,ExpressionUUID->"c4917538-1e9b-487b-a1ee-2580d1856191"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", 
      RowBox[{
       FractionBox["1", "2"], "-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      RowBox[{
       FractionBox["1", "2"], "+", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[337]//MatrixForm=",
 CellID->1410477914,ExpressionUUID->"f749889d-9807-452e-96c7-077c9f9aa2a3"]
}, Open  ]],

Cell[TextData[{
 "This is an explicit operator expression of the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "1fe5b98c-d5ff-47af-921c-6aa4b2fd97e5"],
 "gate in terms of the Pauli operators."
}], "TechNoteText",
 CellID->771058470,ExpressionUUID->"2dacfd62-b8d8-477b-baa9-661dd0707f6d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sqrtSWAP", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Elaborate", "@", 
     RowBox[{"ExpressionFor", "[", 
      RowBox[{"mat", ",", 
       RowBox[{"S", "@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], ",", 
    RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<\!\(\*SqrtBox[\(U\)]\)\>\""}]}], 
   "}"}]}]], "Input",
 CellLabel->"In[338]:=",
 CellID->1895203240,ExpressionUUID->"4bdfb9ec-f47a-46a1-b233-a2960358d7c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 1]], 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 1]]}, "RowWithSeparators"]},
       "RowDefault"],
      QuantumMob`Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 2]], 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 2]]}, "RowWithSeparators"]},
       "RowDefault"],
      QuantumMob`Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "4"], "-", 
       FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[1, 3]], 
          InterpretationBox[
           TemplateBox[{"S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
             TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
            "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
           $CellContext`S[2, 3]]}, "RowWithSeparators"]},
       "RowDefault"],
      QuantumMob`Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]]]}]}], ",", 
   RowBox[{"\<\"Label\"\>", 
    "\[Rule]", "\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>"}]}], "}"}]], "Output",
 CellLabel->"Out[338]=",
 CellID->1977805012,ExpressionUUID->"4e37c223-f0f8-4b58-904a-dec1ad714b5e"]
}, Open  ]],

Cell[TextData[{
 "This is a quantum circuit model to construct the CZ gate from the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "dada284d-0887-4500-8389-cb2c61247461"],
 " gate and single-qubit rotation gates. In this diagram, ",
 Cell[BoxData[
  FormBox[
   SqrtBox["U"], TraditionalForm]],ExpressionUUID->
  "180cb431-88c2-47ce-a8e1-21cc04e5c151"],
 " denotes the ",
 Cell[BoxData[
  FormBox[
   SqrtBox["SWAP"], TraditionalForm]],ExpressionUUID->
  "fa5e3b82-77ce-43fd-9c09-d6706a8df51c"],
 "gate and ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "d93f8ff5-23ab-4795-9235-da8de973d577"],
 " the quadrant phase gate (or, equivalently, the rotation around the z-axis \
by angle \[Pi]/2)."
}], "TechNoteText",
 CellID->27233292,ExpressionUUID->"89efed25-aa02-4d73-8076-bd6e0e5adaba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"sqrtSWAP", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "3"}], "]"}], ",", "sqrtSWAP", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"1", ",", "7"}], "]"}], ",", 
      RowBox[{"Dagger", "@", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "7"}], "]"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[339]:=",
 CellID->1505230369,ExpressionUUID->"78d7047b-a09e-4476-99eb-49f39538427f"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"Z\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"\\!\\(\\*SqrtBox[\\(U\\)]\\)\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.08000000000000002],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
       StyleBox["\<\"S\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"S\"", "\"\[Dagger]\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.08000000000000002],
        FontWeight->"Light",
        FontSlant->Italic], {4., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->226.79999999999998`,
   PlotRange->{{0, 5}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, 
   $CellContext`S[1, 3], {Complex[
      Rational[3, 4], 
      Rational[1, 4]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 1], 
       $CellContext`S[2, 1]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 2], 
       $CellContext`S[2, 2]] + Complex[
       Rational[1, 4], 
       Rational[-1, 4]] QuantumMob`Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3]], "Label" -> "\!\(\*SqrtBox[\(U\)]\)"}, {
    $CellContext`S[1, 7], 
    $CellContext`S[2, -7]}]]], "Output",
 CellLabel->"Out[339]=",
 CellID->69464771,ExpressionUUID->"66aafe18-2791-4cf6-a2da-7d0fd4151082"]
}, Open  ]],

Cell["\<\
To check if it indeed implements the CZ gate, take a look at the matrix \
representation of the quantum circuit model.\
\>", "TechNoteText",
 CellID->535686806,ExpressionUUID->"0c0b3cd4-0772-484d-95bb-692703f51798"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "qc", "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[340]:=",
 CellID->851721286,ExpressionUUID->"cf896aef-fa8c-4c6e-8f4d-dd7caf618fc0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {3}, {2}, {4}, {1}}}, {1, 0, 1,
       0, 1, 0, -1, 0}}]]]]], "Output",
 CellLabel->"Out[340]//MatrixForm=",
 CellID->1410785876,ExpressionUUID->"a0552d96-0a37-4629-9b60-c5a6c2ec7579"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Controlled-Unitary Gates", "TechNoteSection",
 CellTags->"Section14",
 CellID->1455445268,ExpressionUUID->"855d9a1c-73ec-46d1-b3b7-48c2039a9bec"],

Cell[CellGroupData[{

Cell["Definition", "Subsection",
 CellTags->"Section15",
 CellID->1829879946,ExpressionUUID->"c24f344f-bb76-4122-b226-ee4db4ca152e"],

Cell[TextData[{
 "Consider two qubits that are once again called control and target qubits. \
Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "8132d3dc-d34f-4e6e-8431-0a586ff615ac"],
 " be a unitary operator on the target qubit. The controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "15cfa6d5-2ce6-4da2-9101-21f29bb7fe52"],
 " gate is a unitary operator on the two-qubit Hilbert space defined, \
analogously to CNOT, by"
}], "TechNoteText",
 CellID->678943735,ExpressionUUID->"7192843b-6194-4d90-b182-78697bac4535"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":", 
    RowBox[{
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      TemplateBox[{"t"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      TemplateBox[{"c"},
       "Ket"], "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["U", "c"], 
        TemplateBox[{"t"},
         "Ket"]}], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "a5172d02-78b0-4293-93d5-f9cf02438758"],
 "."
}], "TechNoteText",
 CellID->1426737634,ExpressionUUID->"50533c8d-f64a-4d98-a15d-dc815117b2e3"],

Cell["or equivalently,", "TechNoteText",
 CellID->377012236,ExpressionUUID->"c73eeefe-447b-4a23-b9bc-2a9e4f895ad3"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], ":=", 
    RowBox[{
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"0"},
        "Bra"], "\[CircleTimes]", "I"}]}], "+", 
     RowBox[{
      TemplateBox[{"1"},
       "Ket"], 
      RowBox[{
       TemplateBox[{"1"},
        "Bra"], "\[CircleTimes]", "U"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"5725bf1e-6aac-43d1-854b-b114ee88a16a"],
 "."
}], "TechNoteText",
 CellID->1367891802,ExpressionUUID->"7061d130-2459-4d92-9662-58a1088c46c1"],

Cell[TextData[{
 "If the control qubit is in |0\:27e9, then it does nothing. On the other \
hand, if the control qubit is in |1\:27e9, then it operates unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "80f588bb-be2d-4626-845b-99fb1b719b97"],
 " on the target qubit."
}], "TechNoteText",
 CellID->1345075079,ExpressionUUID->"b63e26c8-ddb1-42e7-8fb2-e0b2f6816819"],

Cell["\<\
Analogously to the CNOT gate, the matrix representation of the \
controlled-unitary gate is thus given by\
\>", "TechNoteText",
 CellID->819163313,ExpressionUUID->"5f61fe94-3860-4359-98f4-475c09a17230"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Ctrl", "(", "U", ")"}], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"]},
       {"0", "0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "ce9b75aa-45aa-4b52-8f0b-ea0a9aa2d0df"],
 " ."
}], "TechNoteText",
 CellID->116500784,ExpressionUUID->"0a583872-875d-4b2d-8263-c40f8fcc8b2d"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"i", " ", "j"}]], TraditionalForm]],ExpressionUUID->
  "6421c2a7-8408-40ac-906a-80bec95b1c2d"],
 " are the elements of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "c35b231d-6a4f-484f-b8fb-21cff483b5ae"],
 "."
}], "TechNoteText",
 CellID->1671074271,ExpressionUUID->"5f964ec9-f328-431f-aa37-19abd8eef982"],

Cell["\<\
In quantum circuit model, a controlled-unitary gate is depicted as\
\>", "TechNoteText",
 CellID->1953344721,ExpressionUUID->"dd2f74e1-a2b3-45f6-8849-50805601c3ba"],

Cell[BoxData[
 RowBox[{"\t", 
  RowBox[{
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
      LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"U\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
    ImageSize->118.8,
    PlotRangePadding->Scaled[0.025]], "."}]}]], "Picture",
 CellID->954137231,ExpressionUUID->"806a1b87-5e95-4e7d-ae39-1bd5768a7124"],

Cell["\<\
The filled circle connected to the quantum circuit element on the target \
qubit indicates the conditional operation of the element conditioned on the \
state of the control qubit.\
\>", "TechNoteText",
 CellID->924049268,ExpressionUUID->"f2472d1e-696e-496d-a18c-e8dee37c9d81"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[341]:=",
 CellID->214055128,ExpressionUUID->"41a0e7d6-5e6f-4bf9-b972-12198c464b55"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[342]:=",
 CellID->167122186,ExpressionUUID->"8ca197dd-abd1-4d87-8dff-44c5f4bed890"],

Cell[TextData[{
 "For demonstration, consider a single-qubit rotation acting on the qubit ",
 StyleBox["S[2,$]", "Input"],
 ". It is a rotation around the y-axis by angle \[Phi]."
}], "TechNoteMathCaption",
 CellID->2041795819,ExpressionUUID->"d712ebb6-2db2-415b-9c10-08b497a8ce94"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U", "//", "Elaborate"}], "//", "Matrix"}], "//", "ExpToTrig"}], "//",
   "MatrixForm"}]}], "Input",
 CellLabel->"In[343]:=",
 CellID->1821134520,ExpressionUUID->"8c0e436b-ad01-41fc-998a-122305e7c0b2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[345]//MatrixForm=",
 CellID->711271405,ExpressionUUID->"71fcf94d-dab0-4f61-ae26-cf9d57319a1a"]
}, Open  ]],

Cell["\<\
This is a quantum circuit featuring the controlled-unitary gate.\
\>", "TechNoteMathCaption",
 CellID->1443037598,ExpressionUUID->"997caa12-2155-4df4-94cc-71be13e3fee9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}], "]"}]}]], "Input",
 CellLabel->"In[346]:=",
 CellID->1600084015,ExpressionUUID->"50801df1-91d0-4cfb-816f-ae90114b41af"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[2, QuantumMob`Q3`$], "Label" -> "U"]]]]], "Output",
 CellLabel->"Out[346]=",
 CellID->1444524633,ExpressionUUID->"2c110a8f-be0e-4b28-afd7-ef94d0cd3c0d"]
}, Open  ]],

Cell["\<\
This is the explicit expression of the controlled-U gate  in terms of the \
Pauli operators.\
\>", "TechNoteMathCaption",
 CellID->378680471,ExpressionUUID->"a896f672-68eb-4d54-a1a5-a14de3f5845b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "qc", "]"}]], "Input",
 CellLabel->"In[347]:=",
 CellID->1488630036,ExpressionUUID->"431d3f2b-93f0-401f-824a-5fb0b3ee0133"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "4"], "]"}], "2"], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 3]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Phi]", "4"], "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2]]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 2]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[347]=",
 CellID->822877496,ExpressionUUID->"a57baec4-595e-4e83-baae-79dd2a2538a5"]
}, Open  ]],

Cell["\<\
The controlled-U gate maps the logical basis states as follows.\
\>", "TechNoteMathCaption",
 CellID->641929970,ExpressionUUID->"56ea20bf-5f72-4577-a3f9-5b78cff4371b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", 
    RowBox[{"S", "@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[348]:=",
 CellID->2106646909,ExpressionUUID->"78ace93e-d180-455b-b0b0-1c989f51ddf8"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}], "-", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[350]//TableForm=",
 CellID->307388592,ExpressionUUID->"875d57d2-934f-4fda-963a-7b321458d3d6"]
}, Open  ]],

Cell["\<\
When the control qubit  is in a superposition, the resulting state is an \
entangled state in general.\
\>", "TechNoteMathCaption",
 CellID->1736236263,ExpressionUUID->"3b90748e-e0a1-4c10-8359-85dac3bb4709"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Ket", "[", "]"}], "+", 
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], "\[Rule]", "1"}], "]"}]}], "//", 
   RowBox[{
    RowBox[{"KetRegulate", "[", 
     RowBox[{"#", ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "&"}]}]}]], "Input",
 CellLabel->"In[351]:=",
 CellID->915076805,ExpressionUUID->"8b5b68f0-0a8c-42e4-ac08-1eb3db430669"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
     0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["1", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}]], "Output",
 CellLabel->"Out[351]=",
 CellID->1581894709,ExpressionUUID->"def8a750-30ef-4b94-a254-395025746f30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"qc", "**", "in"}]}]], "Input",
 CellLabel->"In[352]:=",
 CellID->1955961279,ExpressionUUID->"a96b45f2-938e-4bab-a523-1bde4a4e08ac"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
     0, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "+", 
  RowBox[{
   RowBox[{"Cos", "[", 
    FractionBox["\[Phi]", "2"], "]"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Phi]", "2"], "]"}]}]}]], "Output",
 CellLabel->"Out[352]=",
 CellID->1056824303,ExpressionUUID->"e761ba8b-6578-4e95-87a5-1d6c7e7ac65f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phase Acquisition", "Subsection",
 CellTags->"Section16",
 CellID->715838931,ExpressionUUID->"c6e75770-6043-490f-a91c-bfdeacb71686"],

Cell[TextData[{
 "An important aspect of a controlled-unitary operator is that it induces \
relative phase shifts on the control qubit when the target qubit has been \
prepared in an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "238949bd-162c-4d30-8be9-532330c643c1"],
 ". At first glace, it may sound counterintuitive since the definition given \
above seems to indicate that it changes only the target qubit depending on \
the state of the control qubit and keeps the latter intact. This is another \
feature distinguishing quantum gates from their classical counterparts."
}], "TechNoteText",
 CellID->901522823,ExpressionUUID->"5a788fb0-2fee-406a-beb0-b296e0a7b266"],

Cell[TextData[{
 "Let us take a closer look to see how this works. Prepare the control qubit \
in a superposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"\[Psi]"},
     "Ket"], "=", 
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], "+", 
     TemplateBox[{"1"},
      "Ket"]}]}], TraditionalForm]],ExpressionUUID->
  "c7cea5b1-5949-456f-a02f-b7428d392c55"],
 " and the target qubit in an eigenstate ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "6db7a8e8-2c1f-4234-8811-77ab7b8ac05a"],
 " of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "56ab542d-b280-4876-8e7d-b8a5a3cfb2b0"],
 " with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"f25ed43d-b0ab-469b-8e2e-d0361d8a38dc"],
 ". The controlled-unitary gate transforms the state to"
}], "TechNoteText",
 CellID->1396956576,ExpressionUUID->"8c950313-7fb6-48b7-8045-883e0a7726d4"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"\[Psi]"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"\[Phi]"},
      "Ket"]}], "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       TemplateBox[{"1"},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Phi]"},
          "Ket"]}], ")"}]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{
       TemplateBox[{"0"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], "+", 
      RowBox[{
       RowBox[{
        TemplateBox[{"1"},
         "Ket"], "\[CircleTimes]", 
        TemplateBox[{"\[Phi]"},
         "Ket"]}], 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], "\[RightArrow]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{"0"},
         "Ket"], "+", 
        RowBox[{
         TemplateBox[{"1"},
          "Ket"], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "6f0e326e-7a10-45f8-adad-a77bd6520f5f"],
 " ."
}], "TechNoteText",
 CellID->210460181,ExpressionUUID->"04ba55bf-2583-4387-8b48-ebcdb9d6442c"],

Cell[TextData[{
 "This feature is extended to multi-control unitary gates and plays a crucial \
role in many quantum algorithms. In particular, the ",
 ButtonBox["quantum phase estimation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/QuantumPhaseEstimation"],
 " algorithm is a direct consequence of this feature."
}], "TechNoteText",
 CellID->298695458,ExpressionUUID->"62affa69-952a-4562-bb73-268cf3c47b08"],

Cell[TextData[{
 "For demonstration, consider the phase gate. Recall that state ",
 Cell[BoxData[
  TemplateBox[{"1"},
   "Ket"]],ExpressionUUID->"967b3af0-73c8-44a7-b8d2-21515e289ff1"],
 " is an eigenstate of it with eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], TraditionalForm]],
  ExpressionUUID->"491fe1ae-e70b-4dca-a9bf-1d22e19d4555"],
 "."
}], "TechNoteMathCaption",
 CellID->1505279567,ExpressionUUID->"1cd31bff-0ca0-469d-9b1f-6c8f3c7a2b0f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"U", "=", 
  RowBox[{"Phase", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "3"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "U", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[353]:=",
 CellID->1876320909,ExpressionUUID->"a6792a75-2db4-4415-afc1-7cd1239812ca"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FormBox[
    TagBox[
     RowBox[{
      FormBox[
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
         "Subsuperscript"],
        $CellContext`S[2, 3]],
       TraditionalForm], "\[InvisibleApplication]", 
      RowBox[{"(", "\[Phi]", ")"}]}],
     HoldForm],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  QuantumMob`Q3`Phase[$CellContext`\[Phi], 
   $CellContext`S[2, 3]]]], "Output",
 CellLabel->"Out[353]=",
 CellID->208816184,ExpressionUUID->"ae27fa30-1ba8-4077-8722-0bcf26a6eb38"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      1, E^(Complex[0, 1] $CellContext`\[Phi])}}]]]]], "Output",
 CellLabel->"Out[354]//MatrixForm=",
 CellID->585325290,ExpressionUUID->"eea28e46-7d6e-4467-88d8-3508bf2bd583"]
}, Open  ]],

Cell["We are interested in the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->774865820,ExpressionUUID->"a3e36419-cb2c-49f9-9b2f-393fe81980c9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "U"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "op", "]"}]}], "Input",
 CellLabel->"In[355]:=",
 CellID->2117896949,ExpressionUUID->"2ccc41f3-faea-4485-ab61-812568260f5f"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[2, 3]]]]]], "Output",
 CellLabel->"Out[356]=",
 CellID->2087045770,ExpressionUUID->"b081a6eb-3b83-4fe9-9fec-652057024dbd"]
}, Open  ]],

Cell["\<\
Prepare the target qubit in the eigenstate with a finite phase shift. In \
addition, prepare the control qubit in a linear superposition of the \
computational basis states in order to pick up the phase shift.\
\>", "TechNoteMathCaption",
 CellID->193224567,ExpressionUUID->"2d8245d1-cc9a-4957-9eaf-624cd4ef29c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"S", "[", "2", "]"}], "->", "1"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "op"}], 
   "]"}]}]], "Input",
 CellLabel->"In[357]:=",
 CellID->1062235589,ExpressionUUID->"8b7dce94-eb45-412e-a82b-0e1c6b057406"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"1"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-5, 2]}, {2, Rational[-1, 2]}}, {{
        2, -2.5}, {2, -0.5}}]]}, {LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "\[Phi]"},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`PortIn[
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 1|>]], 
   $CellContext`S[1, 6], "Separator", 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`S[2, 3]]]]]], "Output",
 CellLabel->"Out[357]=",
 CellID->2127849939,ExpressionUUID->"c5d6b1a0-95fd-4f78-9447-45091beabd8d"]
}, Open  ]],

Cell["\<\
Observe that the state does not change on the target qubit while the phase \
shift induced by the phase gate has been picked up by the state in the \
control qubit.\
\>", "TechNoteMathCaption",
 CellID->581406343,ExpressionUUID->"a8ce1562-b0c2-4c0c-b076-875cec92febb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"out", "//", "KetFactor"}]}], "Input",
 CellLabel->"In[358]:=",
 CellID->1127477995,ExpressionUUID->"95a67ac8-3229-49a4-b90f-9070934ee4f0"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}],
    HoldForm],
   QuantumMob`Q3`OTimes[
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>] + 
    E^(Complex[0, 1] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[359]=",
 CellID->728751282,ExpressionUUID->"40d6c845-a210-4e16-b6a2-9649f2933691"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application: Controlled Power", "Subsection",
 CellTags->"Section17",
 CellID->616090041,ExpressionUUID->"b347b255-1de6-4725-a2c3-a15a494551eb"],

Cell["\<\
An interesting variation of the controlled-unitary gate is the controlled \
power of a unitary gate, typically depicted by the quantum circuit element in \
Figure 1.\
\>", "TechNoteText",
 CellID->1275497408,ExpressionUUID->"1382b792-a31d-479a-bed6-1c04248e3ba5"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
      0, -4}, {2, -4}}, {{0, -6}, {2, -6}}}], {{InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`x[1]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -1}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`x[2]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -2}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`x[3]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -3}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`x[4]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {-0.2, -4}, NCache[
        ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"\[Psi]\""},
         "Ket"],
        StripOnInput->False,
        FontSize->Scaled[0.16000000000000003`],
        FontWeight->"Light"], {-0.2, -6}, NCache[
       ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]]]}, {
      LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -6}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -4.4}, {1.4, -0.6},
        RoundingRadius->0.4]}, InsetBox[
       StyleBox["\<\"x\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", "\"x\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {InsetBox[
       StyleBox[
        TemplateBox[{
          
          TemplateBox[{
           "\"\\!\\(\\*StyleBox[\\\"U\\\",FontSlant->\\\"Italic\\\"]\\)\"", 
            "\"\\!\\(\\*StyleBox[\\\"x\\\",FontSlant->\\\"Italic\\\"]\\)\""}, 
           "Superscript", SyntaxForm -> SuperscriptBox], 
          TemplateBox[{"\"\[Psi]\""}, "Ket"]},
         "RowDefault"],
        StripOnInput->False,
        FontSize->Scaled[0.16000000000000003`],
        FontWeight->"Light"], {2.2, -6}, NCache[
       ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], {InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`x[1]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -1}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`x[2]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -2}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`x[3]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -3}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]], InsetBox[
        StyleBox[
         TemplateBox[{
           FormBox[
            InterpretationBox[
             SubscriptBox["x", 
              TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
             $CellContext`x[4]], TraditionalForm]},
          "Ket"],
         StripOnInput->False,
         FontSize->Scaled[0.16000000000000003`],
         FontWeight->"Light"], {2.2, -4}, NCache[
        ImageScaled[{0, Rational[1, 2]}], ImageScaled[{0, 0.5}]]]}}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{36, 46.800000000000004`}, {1, 1}},
    ImageSize->154.79999999999998`,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`QuantumCircuitIn[
     Ket[<|$CellContext`S[1, Q3`$] -> $CellContext`x[1], $CellContext`S[
        2, Q3`$] -> $CellContext`x[2], $CellContext`S[
        3, Q3`$] -> $CellContext`x[3], $CellContext`S[
        4, Q3`$] -> $CellContext`x[4]|>], 
     Q3`ProductState[<|$CellContext`T[Q3`$] -> {1, 1}|>, "Label" -> 
      Ket[{"\[Psi]"}]]], 
    Q3`ControlledPower[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$], 
      $CellContext`S[4, Q3`$]}, 
     $CellContext`T[3]], 
    Q3`QuantumCircuitOut[
     Q3`ProductState[<|$CellContext`T[Q3`$] -> {1, 1}|>, "Label" -> Row[{
         Superscript[
         "\!\(\*StyleBox[\"U\",FontSlant->\"Italic\"]\)", 
          "\!\(\*StyleBox[\"x\",FontSlant->\"Italic\"]\)"], 
         Ket[{"\[Psi]"}]}]], 
     Ket[<|$CellContext`S[1, Q3`$] -> $CellContext`x[1], $CellContext`S[
        2, Q3`$] -> $CellContext`x[2], $CellContext`S[
        3, Q3`$] -> $CellContext`x[3], $CellContext`S[
        4, Q3`$] -> $CellContext`x[4]|>]], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}, "PortSize" -> {1, 1.3}]]],ExpressionUUID->
  "c609f6cd-fa31-4ee3-8dc1-fec225658b8b"]
}], "Picture",
 CellID->2084184000,ExpressionUUID->"81645160-a80c-44ac-a289-24097d475b00"],

Cell[TextData[{
 StyleBox["Figure 1",
  FontWeight->"Bold"],
 ". A quantum circuit for the controlled power of unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "a10cfd8c-8557-4f3b-bcba-6ff2b8ad333e"],
 "."
}], "TechNoteCaption",
 CellID->1283463500,ExpressionUUID->"4ca829b6-1ac3-409c-a500-0b7edeb23c97"],

Cell[TextData[{
 "Consider a system consisting of a control register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "8d01e988-ad1c-41a1-b1d8-d5fd6b895780"],
 " qubits and a target register. Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "bbcc4b09-0b10-4dc5-801f-67c3427c2903"],
 " be a unitary operator acting on the target register. The controlled power \
(or controlled exponentiation) of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "33c00452-570d-4633-a8b2-c2a3aa6b7b3e"],
 " is defined by"
}], "TechNoteText",
 CellID->1036421782,ExpressionUUID->"cac313b9-1ac8-42f0-911f-9d0994c75b41"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["x", "1"], 
         SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["x", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"y"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{
       RowBox[{
         SubscriptBox["x", "1"], 
         SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["x", "n"]}]},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["U", "x"], 
       TemplateBox[{"y"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "08a9642c-d515-4b23-9190-93cb75e55937"],
 " ,"
}], "TechNoteText",
 CellID->1390517433,ExpressionUUID->"e40dbc71-b877-4656-8505-437e4abaa560"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", ":=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "1"], 
       SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["x", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"52aa6d6a-1dee-420b-ad1d-fb7ec8ce4fbc"],
 ". Like the controlled-unitary gate, the controlled-power gate induces \
relative phase shifts on the control register leaving the target register \
intact when the target register is prepared in an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "8101ad99-2896-43e0-8f41-52289cba02ba"],
 ". More explicitly, let ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"\[Phi]"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "4c84bff6-c09f-4735-b7e4-e76b370b41ed"],
 " be an eigenstate of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "ee206ae7-15f9-4662-b48c-ebec7979fb39"],
 " belonging to eigenvalue ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", "\[Phi]"}]], 
   TraditionalForm]],ExpressionUUID->"768fdaa1-2f40-4bb3-be8d-63626656b40b"],
 ". Then, the controlled-power gate makes a transformation such that"
}], "TechNoteText",
 CellID->357932788,ExpressionUUID->"07c72a78-9ac9-499e-9d12-dc4c233e148a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        UnderoverscriptBox["\[CapitalSigma]", 
         RowBox[{"x", "=", "0"}], 
         RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]], 
        TemplateBox[{"x"},
         "Ket"]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}], "\[RightTeeArrow]", 
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       RowBox[{"(", 
        RowBox[{"U", 
         TemplateBox[{"\[Phi]"},
          "Ket"]}], ")"}]}]}]}], "=", 
    RowBox[{
     RowBox[{
      UnderoverscriptBox["\[CapitalSigma]", 
       RowBox[{"x", "=", "0"}], 
       RowBox[{
        SuperscriptBox["2", "n"], "-", "1"}]], 
      RowBox[{
       TemplateBox[{"x"},
        "Ket"], "\[CircleTimes]", 
       TemplateBox[{"\[Phi]"},
        "Ket"]}], 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
       "\[ImaginaryI]", "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
        "\[Phi]"}]]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        UnderoverscriptBox["\[CapitalSigma]", 
         RowBox[{"x", "=", "0"}], 
         RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]], 
        TemplateBox[{"x"},
         "Ket"], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
         "\[ImaginaryI]", "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
          "\[Phi]"}]]}], ")"}], "\[CircleTimes]", 
      TemplateBox[{"\[Phi]"},
       "Ket"]}]}]}], TraditionalForm]],ExpressionUUID->
  "ef8ebe94-084a-4762-afd0-a146f2b047b5"],
 " ."
}], "TechNoteText",
 CellID->232871499,ExpressionUUID->"25a7a02f-a839-43cb-a4e4-01f3fe6c2639"],

Cell[TextData[{
 "This is a straightforward generalization of the ",
 ButtonBox["phase-acquisition property",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#715838931"],
 " of the controlled-unitary gate discussed above."
}], "TechNoteText",
 CellID->531662691,ExpressionUUID->"0a3ae1d9-fb18-43c9-9c05-87b01e8d5274"],

Cell[TextData[{
 "Note that for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "1"], 
       SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
       SubscriptBox["x", "n"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"50643fbc-9b8d-450c-83a5-03128ecdbc32"],
 ","
}], "TechNoteText",
 CellID->1514408200,ExpressionUUID->"e4ae4e93-e659-4fe4-89ed-2518887ee33d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["U", "x"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", 
         RowBox[{"n", "-", "1"}]]], ")"}], 
      SubscriptBox["x", "1"]], 
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", 
         RowBox[{"n", "-", "2"}]]], ")"}], 
      SubscriptBox["x", "1"]], 
     SuperscriptBox[
      RowBox[{"\[Ellipsis]", "(", 
       SuperscriptBox["U", 
        SuperscriptBox["2", "0"]], ")"}], 
      SubscriptBox["x", "n"]]}]}], TraditionalForm]],ExpressionUUID->
  "85f8da71-d3b2-4a7c-b00d-185e3a6b7473"],
 " ."
}], "TechNoteText",
 CellID->2034215257,ExpressionUUID->"1413859f-390e-42fb-bc75-ea25acfadaee"],

Cell["\<\
This implies that the controlled-power gate is a combination of the usual \
controlled-unitary gates as in Figure 2.\
\>", "TechNoteText",
 CellID->1368761109,ExpressionUUID->"0428de57-4ef5-4a76-a3e7-9fcb5ec40469"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
      0, -4}, {2, -4}}, {{0, -6}, {2, -6}}}], {
      LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -6}}], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -4.4}, {1.4, -0.6},
        RoundingRadius->0.4]}, InsetBox[
       StyleBox["\<\"x\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], NCache[{1, Rational[-5, 2]}, {1, -2.5}], NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", "\"x\""},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.2],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
    ImageSize->118.8,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`ControlledPower[{
      $CellContext`S[1, Q3`$], 
      $CellContext`S[2, Q3`$], 
      $CellContext`S[3, Q3`$], 
      $CellContext`S[4, Q3`$]}, 
     $CellContext`T[3]], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}]]],ExpressionUUID->
  "7bfd3aef-de6f-4a7a-81aa-cc267636d071"],
 "=",
 Cell[BoxData[
  InterpretationBox[
   GraphicsBox[{
     {Dashing[{Small, Small}], LineBox[{}]}, 
     LineBox[{{{0, -1}, {5, -1}}, {{0, -2}, {5, -2}}, {{0, -3}, {5, -3}}, {{
      0, -4}, {5, -4}}, {{0, -6}, {5, -6}}}], {LineBox[{{1, -1}, {1, -6}}], 
      DiskBox[{1, -1}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -6.4}, {1.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "3"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {1, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{2, -2}, {2, -6}}], 
      DiskBox[{2, -2}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{1.6, -6.4}, {2.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {2, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{3, -3}, {3, -6}}], 
      DiskBox[{3, -3}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{2.6, -6.4}, {3.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {3, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{4, -4}, {4, -6}}], 
      DiskBox[{4, -4}, 0.09], 
      {GrayLevel[1], EdgeForm[Opacity[1]], 
       RectangleBox[{3.6, -6.4}, {4.4, -5.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", 
          
          TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> 
           SuperscriptBox]},
         "Superscript"],
        StripOnInput->False,
        FontSize->Scaled[0.05200000000000001],
        FontWeight->"Light",
        FontSlant->Italic], {4, -6}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]]]}},
    AxesStyle->Large,
    FrameStyle->Large,
    ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
    ImageSize->226.79999999999998`,
    PlotRange->NCache[{Full, {
        Rational[-13, 2], 
        Rational[-1, 2]}}, {Full, {-6.5, -0.5}}],
    PlotRangePadding->Scaled[0.025]],
   Q3`QuantumCircuit[
    Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 3]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 2]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
     Q3`ActOn[1, {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 1]], "LabelSize" -> 0.65], 
    Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
     Q3`ActOn[
      $CellContext`T[3], {
       $CellContext`T[Q3`$]}], "Label" -> Superscript["U", 
       Superscript[2, 0]], "LabelSize" -> 0.65], "Invisible" -> {
      $CellContext`S[
       Rational[9, 2]]}]]],ExpressionUUID->
  "98bf7f37-ab51-4d82-816f-48fd5e2aab54"]
}], "Picture",
 CellID->757238962,ExpressionUUID->"4de32f7e-5f61-49fb-bb84-d5a1f024c2bf"],

Cell[TextData[{
 StyleBox["Figure 2",
  FontWeight->"Bold"],
 ". A equivalent quantum circuit (right) of the controlled power of unitary \
operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "7da20182-ef36-4e45-94ed-ca33b7ce67b5"],
 " (left). "
}], "TechNoteCaption",
 CellID->927142212,ExpressionUUID->"964389f2-7ee8-4ec8-a120-598c2abe9d63"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->305516076,ExpressionUUID->"49c22d66-58ac-4cc1-bdc5-dfdd5d14a7e7"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[360]:=",
 CellID->1535052485,ExpressionUUID->"f82d7927-1031-46c2-b59a-4255fdddd6bb"],

Cell[TextData[{
 "Consider a control register consisting of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "067d9ed0-8a52-4bc9-b904-6a85e0a2d2f8"],
 " qubits."
}], "TechNoteMathCaption",
 CellID->1475887768,ExpressionUUID->"2de1ce76-9e27-4e63-9612-d55f2e1822b0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"Range", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{"kk", ",", "$"}], "]"}]}]}], "Input",
 CellLabel->"In[361]:=",
 CellID->1092408791,ExpressionUUID->"6b5e0832-8891-4e7d-80a5-644d629247b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[363]=",
 CellID->1023557733,ExpressionUUID->"66d571dd-df5e-44f2-b7d8-b7cf32bd71c1"]
}, Open  ]],

Cell["\<\
Consider a single-qubit unitary gate acting on the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1519843333,ExpressionUUID->"3a14d37a-71ba-4de0-8fb3-eafcd7ed9fbb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"opU", "=", 
  RowBox[{"Phase", "[", 
   RowBox[{"\[Phi]", ",", 
    RowBox[{"T", "[", "3", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[364]:=",
 CellID->21384525,ExpressionUUID->"98c6e220-04c2-43d7-b99d-66a4e49b7956"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FormBox[
    TagBox[
     RowBox[{
      FormBox[
       InterpretationBox[
        TemplateBox[{"T", 
          
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", "\"Z\""}, 
           "RowWithSeparators"]},
         "Superscript"],
        $CellContext`T[3]],
       TraditionalForm], "\[InvisibleApplication]", 
      RowBox[{"(", "\[Phi]", ")"}]}],
     HoldForm],
    TraditionalForm],
   TraditionalForm,
   Editable->True],
  QuantumMob`Q3`Phase[$CellContext`\[Phi], 
   $CellContext`T[3]]]], "Output",
 CellLabel->"Out[365]=",
 CellID->1590806061,ExpressionUUID->"947f7caf-0e2e-4b96-b0af-2dde158a3471"]
}, Open  ]],

Cell[TextData[{
 "Construct the controlled-power of ",
 StyleBox["opU", "Input"],
 " defined above."
}], "TechNoteMathCaption",
 CellID->978050365,ExpressionUUID->"2dbb5c23-4211-4310-9890-0df3769e8183"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cop", "=", 
  RowBox[{"ControlledPower", "[", 
   RowBox[{"SS", ",", "opU"}], "]"}]}]], "Input",
 CellLabel->"In[366]:=",
 CellID->2127797723,ExpressionUUID->"99e4abc9-aba2-4564-b59f-1274833eb67f"],

Cell[BoxData[
 RowBox[{"ControlledPower", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}], ",", 
   InterpretationBox[
    TagBox[
     FormBox[
      TagBox[
       RowBox[{
        FormBox[
         InterpretationBox[
          TemplateBox[{"T", 
            
            TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", "\"Z\""}, 
             "RowWithSeparators"]},
           "Superscript"],
          $CellContext`T[3]],
         TraditionalForm], "\[InvisibleApplication]", 
        RowBox[{"(", "\[Phi]", ")"}]}],
       HoldForm],
      TraditionalForm],
     TraditionalForm,
     Editable->True],
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]]}], "]"}]], "Output",
 CellLabel->"Out[366]=",
 CellID->506062077,ExpressionUUID->"7e4d890e-d549-4adc-b4b4-47a25ab6f827"]
}, Open  ]],

Cell["\<\
Construct a simple quantum circuit to demonstrate how the controlled-power \
gate works.\
\>", "TechNoteMathCaption",
 CellID->1664622810,ExpressionUUID->"d9850ee9-4384-47c5-a1e4-480f42dbfb2c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductState", "[", 
     RowBox[{"T", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    "cop", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[367]:=",
 CellID->2027335310,ExpressionUUID->"41f8bd21-00c1-4e41-a814-7cdc5098477b"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -5}, {2, -5}}}], InsetBox[
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], "+", 
      TemplateBox[{"1"},
       "Ket"]}], {-0.2, -5.}, NCache[
     ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1, 
     0}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -5}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{74.16, 38.160000000000004`}, {7.2, 7.2}},
   ImageSize->180,
   PlotRange->{{0, 2}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`PortIn[
    QuantumMob`Q3`ProductState[<|$CellContext`T[QuantumMob`Q3`$] -> {1, 
       1}|>]], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}, 
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]], "PortSize" -> {2, 1}]]], "Output",
 CellLabel->"Out[367]=",
 CellID->1350086019,ExpressionUUID->"7f7aacd4-4553-4d2a-ba64-c492dff4c42b"]
}, Open  ]],

Cell["Take computational basis states as inputs.", "TechNoteMathCaption",
 CellID->1320057003,ExpressionUUID->"396bc7d3-9a7b-4376-8f9e-2b89fe69e685"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"Basis", "[", "SS", "]"}]}]], "Input",
 CellLabel->"In[368]:=",
 CellID->856233533,ExpressionUUID->"b860a1e2-6eb3-494b-896c-37fabe79f75b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], ",", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "}"}]], "Output",
 CellLabel->"Out[368]=",
 CellID->583507131,ExpressionUUID->"dcbed030-68f5-4710-9527-aabdc018d965"]
}, Open  ]],

Cell["Calculate the output for each input state.", "TechNoteMathCaption",
 CellID->1095734201,ExpressionUUID->"73ab1d95-a563-4dca-8d87-17adaef7d704"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"qc", "**", "in"}]}]], "Input",
 CellLabel->"In[369]:=",
 CellID->1234389837,ExpressionUUID->"8cd4f483-5214-4b8a-96e0-ed549e592d85"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        0, $CellContext`S[2, QuantumMob`Q3`$] -> 
        0, $CellContext`S[3, QuantumMob`Q3`$] -> 
        1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        0, $CellContext`S[2, QuantumMob`Q3`$] -> 
        1, $CellContext`S[3, QuantumMob`Q3`$] -> 
        0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        0, $CellContext`S[2, QuantumMob`Q3`$] -> 
        1, $CellContext`S[3, QuantumMob`Q3`$] -> 
        1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        1, $CellContext`S[2, QuantumMob`Q3`$] -> 
        0, $CellContext`S[3, QuantumMob`Q3`$] -> 
        0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        1, $CellContext`S[2, QuantumMob`Q3`$] -> 
        0, $CellContext`S[3, QuantumMob`Q3`$] -> 
        1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["0", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        1, $CellContext`S[2, QuantumMob`Q3`$] -> 
        1, $CellContext`S[3, QuantumMob`Q3`$] -> 
        0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ",", 
   RowBox[{
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
              $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
              $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox[
              SubscriptBox["S", 
               TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
              $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
        1, $CellContext`S[2, QuantumMob`Q3`$] -> 
        1, $CellContext`S[3, QuantumMob`Q3`$] -> 
        1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}]}], "}"}]], "Output",
 CellLabel->"Out[369]=",
 CellID->1594018515,ExpressionUUID->"c7309bf6-a280-497a-bf40-1881a77b37f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", 
    RowBox[{"KetFactor", "[", "out", "]"}]}], "]"}], "//", 
  "TableForm"}]], "Input",
 CellLabel->"In[370]:=",
 CellID->273770455,ExpressionUUID->"1e278ea8-d0b9-4f23-b1ba-abbe95ac065a"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             0, $CellContext`S[2, QuantumMob`Q3`$] -> 
             0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["1", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           0, $CellContext`S[2, QuantumMob`Q3`$] -> 
           0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             0, $CellContext`S[2, QuantumMob`Q3`$] -> 
             0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           0, $CellContext`S[2, QuantumMob`Q3`$] -> 
           0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 1] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             0, $CellContext`S[2, QuantumMob`Q3`$] -> 
             1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           0, $CellContext`S[2, QuantumMob`Q3`$] -> 
           1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 2] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             0, $CellContext`S[2, QuantumMob`Q3`$] -> 
             1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           0, $CellContext`S[2, QuantumMob`Q3`$] -> 
           1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 3] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             1, $CellContext`S[2, QuantumMob`Q3`$] -> 
             0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           1, $CellContext`S[2, QuantumMob`Q3`$] -> 
           0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 4] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             1, $CellContext`S[2, QuantumMob`Q3`$] -> 
             0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           1, $CellContext`S[2, QuantumMob`Q3`$] -> 
           0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 5] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["0", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             1, $CellContext`S[2, QuantumMob`Q3`$] -> 
             1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           1, $CellContext`S[2, QuantumMob`Q3`$] -> 
           1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 6] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TagBox[
         RowBox[{
          InterpretationBox[
           TemplateBox[{
             TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                   $CellContext`S[1, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                   $CellContext`S[2, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]], 
               SubscriptBox["1", 
                TemplateBox[{",", "\",\"", 
                  InterpretationBox[
                   SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                   $CellContext`S[3, QuantumMob`Q3`$]]}, 
                 "RowWithSeparators"]]}, "RowWithSeparators"]},
            "Ket"],
           
           Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
             1, $CellContext`S[2, QuantumMob`Q3`$] -> 
             1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[CircleTimes]", 
          RowBox[{"(", 
           RowBox[{
            InterpretationBox[
             TemplateBox[{
               TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                 SubscriptBox["0", 
                  TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                 "RowWithSeparators"]},
              "Ket"],
             Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>]], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
             InterpretationBox[
              TemplateBox[{
                TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
                  SubscriptBox["1", 
                   TemplateBox[{",", "\",\"", 
                    InterpretationBox["T", 
                    $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
                  "RowWithSeparators"]},
               "Ket"],
              Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}]}], ")"}]}],
         HoldForm],
        QuantumMob`Q3`OTimes[
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
           1, $CellContext`S[2, QuantumMob`Q3`$] -> 
           1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>], 
         Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 0|>] + 
         E^(Complex[0, 7] $CellContext`\[Phi]) 
          Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[370]//TableForm=",
 CellID->810685280,ExpressionUUID->"e933660f-ece3-47e8-ba6c-1376edce7dbb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->1362282140,ExpressionUUID->"78db1dee-be9e-4731-8534-efcdba0c7de7"],

Cell["\<\
Construct a simple quantum circuit to demonstrate how the controlled-power \
gate works.\
\>", "TechNoteMathCaption",
 CellID->523520144,ExpressionUUID->"35ac246b-cba0-4d1e-9014-cbd65c048bd4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ket", "[", 
     RowBox[{
      RowBox[{"SS", "->", "0"}], ",", 
      RowBox[{"T", "->", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"kk", ",", "6"}], "]"}], ",", "\"\<Separator\>\"", ",", "cop", ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[371]:=",
 CellID->770533652,ExpressionUUID->"b1b5d5e1-b435-4235-a070-6b59b5ac8762"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}}], {InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -1.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -2.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"0"},
       "Ket"], {-0.2, -3.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}], InsetBox[
      TemplateBox[{"1"},
       "Ket"], {-0.2, -5.}, NCache[
      ImageScaled[{1, Rational[1, 2]}], ImageScaled[{1, 0.5}]], Automatic, {1,
       0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -2.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
       StyleBox["\<\"H\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.1],
        FontWeight->"Light",
        FontSlant->Italic], {1., -3.}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, 
    {Dashing[{0, Small}], 
     LineBox[NCache[{{2, Rational[-11, 2]}, {2, Rational[-1, 2]}}, {{
        2, -5.5}, {2, -0.5}}]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}, {3, -5}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{74.16, 38.160000000000004`}, {7.2, 7.2}},
   ImageSize->252,
   PlotRange->{{0, 4}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`PortIn[
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]], {
    $CellContext`S[1, 6], 
    $CellContext`S[2, 6], 
    $CellContext`S[3, 6]}, "Separator", 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}, 
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]], "PortSize" -> {2, 1}]]], "Output",
 CellLabel->"Out[371]=",
 CellID->1551244392,ExpressionUUID->"50e01534-063b-43df-a7b4-bfb6f273ec28"]
}, Open  ]],

Cell["Calculate the output state.", "TechNoteMathCaption",
 CellID->363088131,ExpressionUUID->"03678f0c-6872-423a-8374-2509a795d126"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"Elaborate", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[372]:=",
 CellID->1079016412,ExpressionUUID->"bb94ac2e-b494-497e-9dc4-8aa8bca378fa"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox["T", 
            $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 
      0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       0, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox["T", 
             $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 
       1, $CellContext`T[QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[372]=",
 CellID->1313021764,ExpressionUUID->"558ef95f-0c72-4dfd-a8ec-e987a5a80233"]
}, Open  ]],

Cell["Check that the target qubit is factorized.", "TechNoteMathCaption",
 CellID->942690207,ExpressionUUID->"f93179b4-bc1b-4d78-9302-622f7a86ce35"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetFactor", "[", 
  RowBox[{"out", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[373]:=",
 CellID->473086067,ExpressionUUID->"650f74c1-ca49-439f-bd29-e97bbe93480d"],

Cell[BoxData[
 FractionBox[
  InterpretationBox[
   TagBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                 $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                 $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
        InterpretationBox[
         TemplateBox[{
           TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
             SubscriptBox["1", 
              TemplateBox[{",", "\",\"", 
                InterpretationBox[
                 SubscriptBox["S", 
                  TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                 $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]},
             "RowWithSeparators"]},
          "Ket"],
         Ket[<|$CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]}], ")"}], "\[CircleTimes]", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          SubscriptBox["1", 
           TemplateBox[{",", "\",\"", 
             InterpretationBox["T", 
              $CellContext`T[QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
         "RowWithSeparators"]},
       "Ket"],
      Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]}],
    HoldForm],
   QuantumMob`Q3`OTimes[
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 0|>] + 
    E^(Complex[0, 4] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 0|>] + 
    E^(Complex[0, 2] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[2, QuantumMob`Q3`$] -> 1|>], 
    Ket[<|$CellContext`S[3, QuantumMob`Q3`$] -> 0|>] + 
    E^(Complex[0, 1] $CellContext`\[Phi]) 
     Ket[<|$CellContext`S[3, QuantumMob`Q3`$] -> 1|>], 
    Ket[<|$CellContext`T[QuantumMob`Q3`$] -> 1|>]]], 
  RowBox[{"2", " ", 
   SqrtBox["2"]}]]], "Output",
 CellLabel->"Out[373]=",
 CellID->414830976,ExpressionUUID->"1ffac07e-346e-4fb7-a77d-4a50804a556d"]
}, Open  ]],

Cell["\<\
To focus on the state of the control register, ignore the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1762048567,ExpressionUUID->"a45f030d-fc10-4784-992e-0b2d6f1e56e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KetDrop", "[", 
  RowBox[{"out", ",", "T"}], "]"}]], "Input",
 CellLabel->"In[374]:=",
 CellID->1674087129,ExpressionUUID->"06aa6155-e95d-46f7-bdc9-3ef9cac21450"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"6", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"7", " ", "\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]]}]], "Output",
 CellLabel->"Out[374]=",
 CellID->1332295470,ExpressionUUID->"64706d6a-e9eb-4317-89a6-6eab2b706805"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->1016485255,ExpressionUUID->"381c72f7-2b4a-4717-b87d-07ea7f5e8c30"],

Cell["\<\
Consider again  the quantum circuit for controlled-power gate.\
\>", "TechNoteMathCaption",
 CellID->1235189013,ExpressionUUID->"26800d3e-d8db-4b64-afd9-7071e564bb93"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"cop", ",", 
    RowBox[{"\"\<Invisible\>\"", "->", 
     RowBox[{"S", "[", 
      RowBox[{"$n", "+", 
       RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellLabel->"In[375]:=",
 CellID->1297582908,ExpressionUUID->"354ccb8d-084a-455b-a289-8c9c16254c93"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -5}, {2, -5}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -5}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], "\"x\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}, 
    QuantumMob`Q3`Phase[$CellContext`\[Phi], 
     $CellContext`T[3]]], "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[375]=",
 CellID->77977021,ExpressionUUID->"11750bf0-5b72-4ecd-8945-0406abcaf2a5"]
}, Open  ]],

Cell["\<\
Expand the controlled-power gate in terms of elementary gates (in this case, \
the controlled-unitary gates).\
\>", "TechNoteMathCaption",
 CellID->331049159,ExpressionUUID->"5b58eee5-6911-4ead-be99-0513446b5fff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Unfold", "[", "qc", "]"}]}]], "Input",
 CellLabel->"In[376]:=",
 CellID->1888208538,ExpressionUUID->"9b573f5e-97c0-4126-9af2-61b7292d1b54"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -5}, {4, -5}}}], {LineBox[{{1, -1}, {1, -5}}], DiskBox[{1, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], 
         TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {1., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -5}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -5.4}, {2.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {2., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -5}}], 
     DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -5.4}, {3.4, -4.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{
         TemplateBox[{"\"Z\"", "\[Phi]"}, "Superscript", SyntaxForm -> 
          SuperscriptBox], 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.065],
       FontWeight->"Light",
       FontSlant->Italic], {3., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     QuantumMob`Q3`Phase[4 $CellContext`\[Phi], 
      $CellContext`T[3]], {
      $CellContext`T[QuantumMob`Q3`$]}], "Label" -> Superscript[
      Superscript["Z", $CellContext`\[Phi]], 
      Superscript[2, 2]], "LabelSize" -> 0.65], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     QuantumMob`Q3`Phase[2 $CellContext`\[Phi], 
      $CellContext`T[3]], {
      $CellContext`T[QuantumMob`Q3`$]}], "Label" -> Superscript[
      Superscript["Z", $CellContext`\[Phi]], 
      Superscript[2, 1]], "LabelSize" -> 0.65], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     QuantumMob`Q3`Phase[$CellContext`\[Phi], 
      $CellContext`T[3]], {
      $CellContext`T[QuantumMob`Q3`$]}], "Label" -> Superscript[
      Superscript["Z", $CellContext`\[Phi]], 
      Superscript[2, 0]], "LabelSize" -> 0.65], 
   "Invisible" -> $CellContext`S[
     Rational[7, 2]]]]], "Output",
 CellLabel->"Out[376]=",
 CellID->594767277,ExpressionUUID->"617fd5a0-73b9-420e-9cfa-6a25da68be56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "qc", "]"}], "-", 
   RowBox[{"Matrix", "[", "new", "]"}]}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[377]:=",
 CellID->1871953819,ExpressionUUID->"84fed716-cece-4fba-b57b-50d4827c85de"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16}, {{1}, {
       2}, {3}, {4}, {5}, {6}, {7}, {8}, {9}, {10}, {11}, {12}, {13}, {14}, {
       15}, {16}}}, {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0}}]]]]], "Output",
 CellLabel->"Out[377]//MatrixForm=",
 CellID->1864731401,ExpressionUUID->"4d0fcb3d-7303-4e12-9f24-40616ca4f702"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Application: Conditional Operation", "Subsection",
 CellTags->"Section17",
 CellID->1379525988,ExpressionUUID->"4827f088-cd4f-4c7a-821e-f9fbb525c1ae"],

Cell[TextData[{
 "The CNOT gate and the controlled-unitary gate can be combined to achieve a \
variety of conditional gate operations. For example, consider a system \
consisting of a control register of ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "402aa3d5-dbd6-4552-8827-6848f21d7d2b"],
 " qubits and a target register of a single qubit. Suppose that you want to \
operate a unitary gate ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "cea2fbf9-2600-4a6b-b3ae-0dcf8951abfe"],
 " on the target qubit only when an odd number of the control qubits is set \
to ",
 Cell[BoxData[
  FormBox[
   TemplateBox[{"1"},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "554ccb5b-2a53-4798-9a13-45cf44434479"],
 ","
}], "TechNoteText",
 CellID->1459827304,ExpressionUUID->"d6cd5522-f530-4159-b589-9c6dff23a6bc"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     TemplateBox[{"t"},
      "Ket"]}], "\[RightTeeArrow]", 
    RowBox[{
     TemplateBox[{"c"},
      "Ket"], "\[CircleTimes]", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["U", 
        RowBox[{
         SubscriptBox["c", "1"], "\[CirclePlus]", 
         SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", "\[CirclePlus]", 
         SubscriptBox["c", "n"]}]], 
       TemplateBox[{"t"},
        "Ket"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "80de3bd4-c4bd-45fd-8ca6-1138369badff"],
 " ."
}], "TechNoteText",
 CellID->316831353,ExpressionUUID->"f1ba2f7c-7213-48f3-bf5a-35750896837b"],

Cell[TextData[{
 "First, operate the CNOT gates consecutively with the first ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"n", " ", "\[Minus]", " ", "1"}], ")"}], TraditionalForm]],
  ExpressionUUID->"f0e397e4-d07b-4562-a773-531b6aba2972"],
 " qubits in the control register as the control qubit and the last qubit in \
the control register as the target qubit. This transforms the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "527009ad-77a8-49c6-9389-0779f9593a3d"],
 " qubit to",
 Cell[BoxData[
  FormBox[
   TemplateBox[{
     RowBox[{
       SubscriptBox["c", "1"], "\[CirclePlus]", 
       SubscriptBox["c", "2"], "\[CirclePlus]", "\[CenterEllipsis]", 
       "\[CirclePlus]", 
       SubscriptBox["c", "n"]}]},
    "Ket"], TraditionalForm]],ExpressionUUID->
  "d68f77be-66bf-4d97-b367-9b7fa5514406"],
 ". Then, the desired operation is implemented by applying the controlled-",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "f5ae9131-b95c-4305-8abb-8cd51d9558b7"],
 " gate controlled by the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]],ExpressionUUID->
  "40a36348-ae88-4b46-b1b8-c85b943f374a"],
 " qubit. To get the control qubits back to the original state, operate the \
CNOT gates in the reverse order. Overall, the two equivalent quantum circuits \
in Figure 3 below implement the conditional operation."
}], "TechNoteText",
 CellID->1372588958,ExpressionUUID->"d01e49f9-1528-4b0d-ae61-3cabc28c7da2"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -3}, {10, -3}}, {{0, -4}, {10, -4}}, {{
     0, -5}, {10, -5}}, {{0, -7}, {10, -7}}}], {LineBox[{{1, -1}, {1, -5}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -5}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -5}, {1.2666666666666666`, -5}}, {{
         1, -5.266666666666667}, {1, -4.733333333333333}}}]}}, {
     LineBox[{{3, -3}, {3, -5}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -5}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -5}, {3.2666666666666666`, -5}}, {{
         3, -5.266666666666667}, {3, -4.733333333333333}}}]}}, {
     LineBox[{{4, -4}, {4, -5}}], 
     DiskBox[{4, -4}, 0.09], {CircleBox[{4, -5}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -5}, {4.266666666666667, -5}}, {{
         4, -5.266666666666667}, {4, -4.733333333333333}}}]}}, {
     LineBox[{{5, -5}, {5, -7}}], DiskBox[{5, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -7.4}, {5.4, -6.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -7}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -4}, {6, -5}}], 
     DiskBox[{6, -4}, 0.09], {CircleBox[{6, -5}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -5}, {6.266666666666667, -5}}, {{
         6, -5.266666666666667}, {6, -4.733333333333333}}}]}}, {
     LineBox[{{7, -3}, {7, -5}}], 
     DiskBox[{7, -3}, 0.09], {CircleBox[{7, -5}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -5}, {7.266666666666667, -5}}, {{
         7, -5.266666666666667}, {7, -4.733333333333333}}}]}}, {
     LineBox[{{9, -1}, {9, -5}}], 
     DiskBox[{9, -1}, 0.09], {CircleBox[{9, -5}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -5}, {9.266666666666667, -5}}, {{
         9, -5.266666666666667}, {9, -4.733333333333333}}}]}}, InsetBox[
     StyleBox["\<\"\[DescendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {2, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]],
     InsetBox[
     StyleBox["\<\"\[AscendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {8, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]], 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -3}, {10, -3}}, {{0, -4}, {10, -4}}, {{
     0, -5}, {10, -5}}, {{0, -7}, {10, -7}}}], {LineBox[{{1, -1}, {1, -3}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], {CircleBox[{3, -4}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -4}, {3.2666666666666666`, -4}}, {{
         3, -4.266666666666667}, {3, -3.7333333333333334`}}}]}}, {
     LineBox[{{4, -4}, {4, -5}}], 
     DiskBox[{4, -4}, 0.09], {CircleBox[{4, -5}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -5}, {4.266666666666667, -5}}, {{
         4, -5.266666666666667}, {4, -4.733333333333333}}}]}}, {
     LineBox[{{5, -5}, {5, -7}}], DiskBox[{5, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -7.4}, {5.4, -6.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -7}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
       ImageScaled[{0.5, 0.5}]]]}, {LineBox[{{6, -4}, {6, -5}}], 
     DiskBox[{6, -4}, 0.09], {CircleBox[{6, -5}, 0.26666666666666666], 
      LineBox[{{{5.733333333333333, -5}, {6.266666666666667, -5}}, {{
         6, -5.266666666666667}, {6, -4.733333333333333}}}]}}, {
     LineBox[{{7, -3}, {7, -4}}], 
     DiskBox[{7, -3}, 0.09], {CircleBox[{7, -4}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -4}, {7.266666666666667, -4}}, {{
         7, -4.266666666666667}, {7, -3.7333333333333334`}}}]}}, {
     LineBox[{{9, -1}, {9, -3}}], 
     DiskBox[{9, -1}, 0.09], {CircleBox[{9, -3}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -3}, {9.266666666666667, -3}}, {{
         9, -3.2666666666666666`}, {9, -2.7333333333333334`}}}]}}, InsetBox[
     StyleBox["\<\"\[DescendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {2, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]],
     InsetBox[
     StyleBox["\<\"\[AscendingEllipsis]\"\>",
      StripOnInput->False,
      FontSize->Scaled[0.04000000000000001],
      FontWeight->"Light",
      FontSlant->Plain], {8, -2}, NCache[
     ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]]]},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {1, 1}},
   ImageSize->406.8,
   PlotRange->NCache[{Full, {
       Rational[-15, 2], 
       Rational[-1, 2]}}, {Full, {-7.5, -0.5}}],
   PlotRangePadding->Scaled[0.025]]}]], "Picture",
 CellID->833281032,ExpressionUUID->"8cc59939-a44c-40c3-ba87-900fe43740bb"],

Cell[TextData[{
 StyleBox["Figure 3",
  FontWeight->"Bold"],
 ". Two equivalent quantum circuits for a conditional unitary gate based on \
sequences of CNOT gates. In principle, the two quantum circuits give the same \
result, but one quantum circuit may be more useful than the other depending \
on the physical connectivity of qubits in a particular quantum computer."
}], "TechNoteCaption",
 CellID->571282978,ExpressionUUID->"d5b13171-fde1-478e-b6b5-4cd00413054a"],

Cell["\<\
This method is used to implement a multi-control unitary gate based on the \
Gray code.\
\>", "TechNoteText",
 CellID->1213442737,ExpressionUUID->"76b28a95-27e7-46a5-afb0-f51de46f61e0"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText", "ParagraphDelimiter",
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 FontColor->GrayLevel[0.85],
 CellID->780471724,ExpressionUUID->"e05b40b1-c225-4eb2-a2a4-562f0c01b507"],

Cell["\<\
As a demonstration, consider a three-qubit control register. Suppose that we \
want to operate a rotation around the y-axis on the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1827368847,ExpressionUUID->"add8f0df-d114-4c59-a0a5-a15d6332376e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ss", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cnot", "=", 
   RowBox[{
    RowBox[{"Distribute", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "[", "CNOT", "]"}], "[", 
       RowBox[{
        RowBox[{"Most", "[", "ss", "]"}], ",", 
        RowBox[{"Last", "@", "ss"}]}], "]"}], ",", "List"}], "]"}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{
       RowBox[{"$n", "+", "1"}], ",", "2"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sequence", "@@", "cnot"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "$n", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sequence", "@@", 
     RowBox[{"Reverse", "[", "cnot", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[378]:=",
 CellID->1424575782,ExpressionUUID->"bf45bda2-84a6-4495-a0ea-8eb7b3eea380"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}, {{
     0, -4}, {6, -4}}}], {LineBox[{{1, -1}, {1, -3}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -3}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -3}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -3}, {2.2666666666666666`, -3}}, {{
         2, -3.2666666666666666`}, {2, -2.7333333333333334`}}}]}}, {
     LineBox[{{3, -3}, {3, -4}}], DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"R\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -3}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -3}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -3}, {4.266666666666667, -3}}, {{
         4, -3.2666666666666666`}, {4, -2.7333333333333334`}}}]}}, {
     LineBox[{{5, -1}, {5, -3}}], 
     DiskBox[{5, -1}, 0.09], {CircleBox[{5, -3}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -3}, {5.266666666666667, -3}}, {{
         5, -3.2666666666666666`}, {5, -2.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->262.8,
   PlotRange->{{0, 6}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[4, QuantumMob`Q3`$]]], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[382]=",
 CellID->164312289,ExpressionUUID->"3dad95e0-9fc9-4d1d-8a6b-7da50e69805e"]
}, Open  ]],

Cell["\<\
Note the way the logical basis states are transformed through the above \
quantum circuit.\
\>", "TechNoteMathCaption",
 CellID->873169809,ExpressionUUID->"c4056e44-b755-4443-9acc-34a1096a7c84"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{"Basis", "[", "ss", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Thread", "[", 
   RowBox[{"in", "->", "out"}], "]"}], "//", "TableForm"}]}], "Input",
 CellLabel->"In[383]:=",
 CellID->1609219912,ExpressionUUID->"e34b0148-6143-46ac-998c-fe090102418e"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 
            0, $CellContext`S[3, QuantumMob`Q3`$] -> 
            1, $CellContext`S[4, QuantumMob`Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 
            0, $CellContext`S[3, QuantumMob`Q3`$] -> 
            1, $CellContext`S[4, QuantumMob`Q3`$] -> 1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 
            1, $CellContext`S[3, QuantumMob`Q3`$] -> 
            0, $CellContext`S[4, QuantumMob`Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            0, $CellContext`S[2, QuantumMob`Q3`$] -> 
            1, $CellContext`S[3, QuantumMob`Q3`$] -> 
            0, $CellContext`S[4, QuantumMob`Q3`$] -> 1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          0, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 
            0, $CellContext`S[3, QuantumMob`Q3`$] -> 
            0, $CellContext`S[4, QuantumMob`Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 
            0, $CellContext`S[3, QuantumMob`Q3`$] -> 
            0, $CellContext`S[4, QuantumMob`Q3`$] -> 1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "\[Rule]", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["0", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}]},
     {
      RowBox[{
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
            SubscriptBox["1", 
             TemplateBox[{",", "\",\"", 
               InterpretationBox[
                SubscriptBox["S", 
                 TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
           "RowWithSeparators"]},
         "Ket"],
        Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
          1, $CellContext`S[2, QuantumMob`Q3`$] -> 
          1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          FractionBox["\[Phi]", "2"], "]"}], " ", 
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["0", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 
            1, $CellContext`S[3, QuantumMob`Q3`$] -> 
            1, $CellContext`S[4, QuantumMob`Q3`$] -> 0|>]]}], "+", 
        RowBox[{
         InterpretationBox[
          TemplateBox[{
            TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                  $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                  $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                  $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
              SubscriptBox["1", 
               TemplateBox[{",", "\",\"", 
                 InterpretationBox[
                  SubscriptBox["S", 
                   TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
                  $CellContext`S[4, QuantumMob`Q3`$]]}, 
                "RowWithSeparators"]]}, "RowWithSeparators"]},
           "Ket"],
          
          Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
            1, $CellContext`S[2, QuantumMob`Q3`$] -> 
            1, $CellContext`S[3, QuantumMob`Q3`$] -> 
            1, $CellContext`S[4, QuantumMob`Q3`$] -> 1|>]], " ", 
         RowBox[{"Sin", "[", 
          FractionBox["\[Phi]", "2"], "]"}]}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[385]//TableForm=",
 CellID->2080154828,ExpressionUUID->"0144bf1e-abf3-4bec-9b00-3e864e6c685e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decomposition into Elementary Gates", "Subsection",
 CellTags->"Section18",
 CellID->1847739219,ExpressionUUID->"bbef1a7e-5d6e-4b49-ab22-9b109853447d"],

Cell["\<\
How can you implement a controlled-unitary gate? The operation involves only \
two qubits, and in principle, it should be possible to implement any specific \
controlled-unitary gate. However, the requirements for a physical \
implementation of two-qubit gates is far more difficult to fulfill on \
realistic systems than for single-qubit gates. Fortunately, any \
controlled-unitary gate can be implemented using only the CNOT gate and \
single-qubit gates. This is one of the basic steps in establishing universal \
quantum computation.\
\>", "TechNoteText",
 CellID->192034466,ExpressionUUID->"8defbe4f-f80d-42e4-90b4-340330ce8cdf"],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "2a678aef-e09d-47a7-bcc1-09c3b7b53eef"],
 " be a unitary gate on the second (target) qubit controlled by the first \
(control) qubit. Suppose that ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "ab509767-e597-471d-b820-4bfe7e40ea5e"],
 " has Euler angles \[Alpha], \[Beta], and \[Gamma] and an additional phase \
factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], TraditionalForm]],
  ExpressionUUID->"9eae11a7-d206-41c9-9bbe-fcecf8cf3846"],
 ", "
}], "TechNoteText",
 CellID->2002832268,ExpressionUUID->"b30c27d9-361f-4948-ae02-ed6d30bd6751"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", "\[Beta]", ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Gamma]", ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"9a17d23e-dfbb-40ed-a745-677641e8794c"],
 " ."
}], "TechNoteText",
 CellID->1943245198,ExpressionUUID->"29fea7c0-3854-4f18-adc0-4d1cc3471b6b"],

Cell[TextData[{
 "Then one can always find three unitary operators ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "0dc520fa-9938-4de5-ad9e-cbcaf6e9a888"],
 ", ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "73cc5f64-cefe-40ef-bcad-3e3a4bcd9cfc"],
 ", and ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "35d4fead-a3c6-4ea3-b6d5-80dbb0b79d10"],
 " such that"
}], "TechNoteText",
 CellID->1190739210,ExpressionUUID->"0e6254e4-42c4-4b81-a0ae-aa88726d0450"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]], "A", " ", "X", " ", "B",
      " ", "X", " ", "C"}]}], TraditionalForm]],ExpressionUUID->
  "f7d08f13-b0ba-4925-8cee-1330628db946"],
 " ,\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "B", " ", "C"}], "=", "I"}], TraditionalForm]],
  ExpressionUUID->"44f45ded-ffda-4046-9300-67f815639d59"],
 " ,"
}], "TechNoteText",
 CellID->353796077,ExpressionUUID->"192836b0-8e60-4caf-801a-8e6e6b23dbe3"],

Cell["\<\
where X is the Pauli X operator. More explicitly, a common choice is\
\>", "TechNoteText",
 CellID->2015931243,ExpressionUUID->"912f0ddd-216e-45a7-8778-433c0b4a5c1d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "z"], "(", "\[Alpha]", ")"}], 
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{"\[Beta]", "/", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"1b9d7c9d-8748-4f07-97fc-2f03b08815be"],
 " ,"
}], "TechNoteText",
 CellID->906902382,ExpressionUUID->"d8961ef8-0286-42c0-a02a-7e154ba96349"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["U", "y"], "(", 
      RowBox[{
       RowBox[{"-", "\[Beta]"}], "/", "2"}], ")"}], 
     RowBox[{
      SubscriptBox["U", "z"], "(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Gamma]"}], ")"}]}], "/", "2"}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "417cedd1-d58d-48fb-801c-b602ff8cc26a"],
 " ,"
}], "TechNoteText",
 CellID->1616891515,ExpressionUUID->"9c7354ad-c92d-4144-953d-9dd229ed7d9e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"C", "=", 
    RowBox[{
     SubscriptBox["U", "z"], "(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "-", "\[Gamma]"}], ")"}]}], "/", "2"}], ")"}]}], 
   TraditionalForm]],ExpressionUUID->"ab41e124-f2b5-4620-bbc6-a6a42b3fd757"],
 " ."
}], "TechNoteText",
 CellID->837623467,ExpressionUUID->"456356a1-a5fc-41e8-8b35-bcfacf168dc0"],

Cell[TextData[{
 "Since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      RowBox[{"y", "/", "z"}]], "(", "\[Phi]", ")"}], "=", 
    RowBox[{"X", " ", 
     RowBox[{
      SubscriptBox["U", 
       RowBox[{"y", "/", "z"}]], "(", 
      RowBox[{"-", "\[Phi]"}], ")"}], "X"}]}], TraditionalForm]],
  ExpressionUUID->"0546f53d-210b-4438-b1b6-f93e5f7ec303"],
 " for any \[Phi], the above choice satisfies the desired properties. These \
properties imply that the controlled-unitary gate can be implemented as in \
the following quantum circuit"
}], "TechNoteText",
 CellID->1182303784,ExpressionUUID->"2c715fb6-5735-41ab-97f3-1e93b5a95585"],

Cell[BoxData[
 RowBox[{
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->118.8,
   PlotRangePadding->Scaled[0.025]], "=", 
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {{
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
       StyleBox["\<\"A\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -2}, ImageScaled[{0.5, 0.5}]]}, {
      {GrayLevel[1], EdgeForm[GrayLevel[0]], 
       RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
       StyleBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[ExponentialE]\\), \\(\
\[ImaginaryI]\\\\ \[CurlyPhi]\\)]\\)\"\>",
        StripOnInput->False,
        FontSize->Scaled[0.06666666666666667],
        FontWeight->"Light",
        FontSlant->Italic], {5, -1}, ImageScaled[{0.5, 0.5}]]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {5, 5}},
   ImageSize->262.8,
   PlotRangePadding->Scaled[0.025]]}]], "TechNoteText",
 CellID->313511997,ExpressionUUID->"42175e9a-d41a-4182-aa74-cb32fc0ac028"],

Cell[TextData[{
 "where the last gate on the first qubit is the relative phase shift by \
\[CurlyPhi], ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], 
     TemplateBox[{"0"},
      "Bra"]}], "+", 
    RowBox[{
     TemplateBox[{"1"},
      "Ket"], 
     TemplateBox[{"1"},
      "Bra"], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", "\[CurlyPhi]"}]]}]}], TraditionalForm]],
  ExpressionUUID->"6b9d164f-b224-413c-83a4-03ac5770baf7"],
 ". Indeed, when the control qubit is in |0\:27e9, the two CNOT gates in the \
middle do nothing, and the combined operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", " ", "B", " ", "C"}], TraditionalForm]],ExpressionUUID->
  "d65e3cf7-c5c0-4def-9cac-997f09fc4489"],
 " on the target qubit ends up with the identity operator. With the control \
qubit in |1\:27e9, on the other hand, the two CNOT gates are operational and \
the overall operator on the target qubit becomes ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", " ", "X", " ", "B", " ", "X", " ", "C"}], "=", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[CurlyPhi]"}]], "U"}]}], 
   TraditionalForm]],ExpressionUUID->"fef011b9-9a7a-485e-bdb9-2d24991e1baa"],
 ", where the phase factor is canceled by the opposite phase from the control \
qubit."
}], "TechNoteText",
 CellID->1418747488,ExpressionUUID->"8c4e1b22-9fda-4186-8cc9-48ad6db14206"],

Cell["\<\
For demonstration, consider a unitary matrix to be applied conditionally on \
the target qubit.\
\>", "TechNoteMathCaption",
 CellID->1378098175,ExpressionUUID->"54d3469f-4dd0-491d-b15d-d41655405e8d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"I", "*", 
     RowBox[{"TheRotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[386]:=",
 CellID->1028095504,ExpressionUUID->"d4902394-63f7-4446-9998-34c7a1e8b9f2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"3", "/", "4"}]]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"1", "/", "4"}]]}], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[387]//MatrixForm=",
 CellID->128421036,ExpressionUUID->"b6e398fc-970b-4828-80b9-03460833bd2a"]
}, Open  ]],

Cell["We want to implement the following controlled-unitary gate.", \
"TechNoteMathCaption",
 CellID->1646790355,ExpressionUUID->"bd0335ce-da9c-45d4-bf1a-c11b60e18bd6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", 
     RowBox[{"S", "[", "2", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "[", "1", "]"}], ",", "op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "]"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[388]:=",
 CellID->1153761970,ExpressionUUID->"eab13205-8709-48c6-9d3c-5930a55353df"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[0, 
       Rational[1, 2]] 3^Rational[1, 2] + 
    Rational[-1, 2] (-1)^Rational[3, 4] $CellContext`S[2, 4] + 
    Rational[1, 2] (-1)^Rational[1, 4] $CellContext`S[2, 5], "Label" -> 
    "U"]]]], "Output",
 CellLabel->"Out[389]=",
 CellID->151286817,ExpressionUUID->"d9776173-6fda-4ac5-8297-3ea789d197ae"]
}, Open  ]],

Cell["\<\
First, find the Euler angles of the unitary operator and the global phase \
factor.\
\>", "TechNoteMathCaption",
 CellID->1240176371,ExpressionUUID->"f31cd194-d6f9-4c3e-921e-88282dfa16c5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"det", "=", 
   RowBox[{"Det", "[", "mat", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi", "=", 
   RowBox[{
    RowBox[{"Arg", "[", "det", "]"}], "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
  RowBox[{"TheEulerAngles", "[", 
   RowBox[{"mat", "/", 
    RowBox[{"Sqrt", "[", "det", "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[390]:=",
 CellID->167989615,ExpressionUUID->"d78d0c56-37f2-4945-8e88-876c2e6682cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["\[Pi]", "4"]}], ",", 
   FractionBox["\[Pi]", "3"], ",", 
   FractionBox["\[Pi]", "4"]}], "}"}]], "Output",
 CellLabel->"Out[392]=",
 CellID->56895271,ExpressionUUID->"f4e290af-b12a-478e-a8e6-9297c8f42a86"]
}, Open  ]],

Cell["From the Euler angles, choose the component operators.", \
"TechNoteMathCaption",
 CellID->833485781,ExpressionUUID->"4033d34d-8c24-430e-858a-90dbd8bdf8e4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"opA", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"b", "/", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<A\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opB", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "b"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "+", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<B\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opC", "=", 
   RowBox[{"EulerRotation", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "-", "c"}], ")"}]}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"S", "[", "2", "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<C\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opD", "=", 
   RowBox[{"Phase", "[", 
    RowBox[{"phi", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[393]:=",
 CellID->359691886,ExpressionUUID->"b8f11594-02c1-41e4-91b7-404504f3f129"],

Cell["Finally, construct the equivalent quantum circuit model.", \
"TechNoteMathCaption",
 CellID->175061697,ExpressionUUID->"2057ded5-06eb-4421-8a2b-6fd83726b179"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"opC", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opB", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "opA", ",", "opD"}], 
   "]"}]}]], "Input",
 CellLabel->"In[397]:=",
 CellID->209345089,ExpressionUUID->"83131d44-7501-4d27-b28f-4e788b5a184a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"C\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"B\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", 
         FractionBox["\[Pi]", "2"]},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->298.8,
   PlotRange->{{0, 7}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`EulerRotation[{0, 0, Rational[1, 4] Pi}, 
    $CellContext`S[2, QuantumMob`Q3`$], "Label" -> "C"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`EulerRotation[{0, Rational[-1, 6] Pi, 0}, 
    $CellContext`S[2, QuantumMob`Q3`$], "Label" -> "B"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`EulerRotation[{Rational[-1, 4] Pi, Rational[1, 6] Pi, 0}, 
    $CellContext`S[2, QuantumMob`Q3`$], "Label" -> "A"], 
   QuantumMob`Q3`Phase[Rational[1, 2] Pi, 
    $CellContext`S[1, 3]]]]], "Output",
 CellLabel->"Out[397]=",
 CellID->608596782,ExpressionUUID->"a059706b-78b4-4b3e-b2e4-d75eb5f7cc06"]
}, Open  ]],

Cell["Check the result.", "TechNoteMathCaption",
 CellID->2073812678,ExpressionUUID->"203cec84-20f0-4775-af7a-dd368e5c6ca8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Elaborate", "[", 
   RowBox[{"qc", "-", "new"}], "]"}], "//", "Chop"}]], "Input",
 CellLabel->"In[398]:=",
 CellID->1395051790,ExpressionUUID->"8dfdd40d-7cf7-42ee-a5a4-fa555e41f25f"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[398]=",
 CellID->221504413,ExpressionUUID->"53948569-a235-4790-a963-0a1c4ceba369"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["General Unitary Gates", "TechNoteSection",
 CellTags->"Section19",
 CellID->1476129218,ExpressionUUID->"b1940ebc-2ea0-46a2-a0d4-82b4494f8792"],

Cell[TextData[{
 "Here, we ",
 ButtonBox["decompose",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/GivensFactor"],
 " an arbitrary two-qubit unitary gate into factors of controlled-unitary \
gates only. This is a remarkable advantage when one tries to build a quantum \
computer as you can just focus on how to implement the CNOT gate and \
single-qubit gates. Moreover, the same idea eventually leads to the proof of \
universal quantum computation on a larger system."
}], "TechNoteText",
 CellID->1572676782,ExpressionUUID->"8ecdb45c-941d-4d28-9dc1-e627b69bccd6"],

Cell[CellGroupData[{

Cell["Two-Level Unitary Transforms", "Subsection",
 CellTags->"Section20",
 CellID->749947798,ExpressionUUID->"6200b313-4a25-4f21-90b7-acf702fe167a"],

Cell[TextData[{
 "Consider an arbitrary two-qubit unitary operator ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "a24059aa-22d2-416c-bf44-1d379637b442"],
 ". In the logical basis, it is represented by a unitary matrix"
}], "TechNoteText",
 CellID->791116743,ExpressionUUID->"bdcc100f-deb6-425b-9782-bde5b9639ab6"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "13"], 
        SubscriptBox["U", "14"]},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "23"], 
        SubscriptBox["U", "24"]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubscriptBox["U", "33"], 
        SubscriptBox["U", "34"]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubscriptBox["U", "43"], 
        SubscriptBox["U", "44"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "a089f274-4338-4465-b7f5-e0680459eb77"],
 " ."
}], "TechNoteText",
 CellID->1227841024,ExpressionUUID->"7fabced5-9b2f-4652-896b-ca5f802d04a7"],

Cell[TextData[{
 "To break the unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "9bdf5d2f-f3e6-4691-8d65-3a9d28923b36"],
 " down into more elementary quantum logic gates, we make use of ",
 StyleBox[ButtonBox["two-level unitary transformations",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/GivensRotation"],
  FontSlant->"Italic"],
 ". A two-level unitary transformation is a unitary operation with matrix \
representation that acts only on the two columns and rows of other matrices \
or column or row vectors. The descriptive word \
\[OpenCurlyDoubleQuote]two-level\[CloseCurlyDoubleQuote] should not be \
confused with \[OpenCurlyDoubleQuote]two-qubit\[CloseCurlyDoubleQuote]. A \
two-level transformation acts on multiple qubits, but it just transforms only \
two rows or columns at a time in the representation."
}], "TechNoteText",
 CellID->1153726345,ExpressionUUID->"2fa7631e-568b-4012-b8b7-d31c917be3e9"],

Cell["\<\
Let us start with a two-level unitary transformation of the form\
\>", "TechNoteText",
 CellID->1048831652,ExpressionUUID->"24ef0a13-6300-4620-ab83-8a6095253fa4"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "1"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "13", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         SubscriptBox["U", "14"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]},
       {"0", "0", 
        RowBox[{
         SubsuperscriptBox["U", "14", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "13"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "1"]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "70b5a932-175c-48c1-ac9d-13d4c100e223"],
 " "
}], "TechNoteText",
 CellID->1167800588,ExpressionUUID->"e0b37456-5ee9-47f5-ba49-991e21ede70f"],

Cell[TextData[{
 "with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalN]", "1"], ":=", 
    SqrtBox[
     RowBox[{"|", 
      SubscriptBox["U", "13"], 
      SuperscriptBox["|", "2"], 
      RowBox[{"+", 
       RowBox[{"|", 
        SubscriptBox["U", "14"], 
        SuperscriptBox["|", "2"]}]}]}]]}], TraditionalForm]],ExpressionUUID->
  "b47ebe23-11f4-48e3-b4fc-38df6df96487"],
 " such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "1"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "1", "\[Dagger]"], 
      SubscriptBox["T", "1"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"16d630d2-30fb-4458-b877-578a559e4f8c"],
 ". When it multiplies ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "09e39983-50c4-44bf-876c-1c238af670e3"],
 " from the right, it does not change the first two columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "f97c3020-0ffd-4368-8949-5df74ab29b86"],
 ". It only alters the last two columns, and hence the name \
\[OpenCurlyQuote]two-level transformation\[CloseCurlyQuote]. The elements in \
the lower-right sub-block of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "1"], TraditionalForm]],ExpressionUUID->
  "e5a12b59-95f7-4d3c-8c77-9fc6b1611625"],
 " have been chosen so that the first element of the last column is \
canceled:"
}], "TechNoteText",
 CellID->1371432583,ExpressionUUID->"b9b23467-be1b-4d9e-9518-4666e97398ad"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], 
        SubsuperscriptBox["U", "13", 
         RowBox[{" ", "\[Prime]"}]], "0"},
       {
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], 
        SubsuperscriptBox["U", "23", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubscriptBox["U", "32"], 
        SubsuperscriptBox["U", "33", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubscriptBox["U", "42"], 
        SubsuperscriptBox["U", "43", 
         RowBox[{" ", "\[Prime]"}]], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "6f7c3b22-3acc-4dba-8b6e-153d3efc2941"],
 " ."
}], "TechNoteText",
 CellID->725439230,ExpressionUUID->"fd55c566-d5d8-4076-ba36-fd0c72d89c2e"],

Cell["\<\
Now take another two-level unitary transformation, this time, of the form\
\>", "TechNoteText",
 CellID->1192474591,ExpressionUUID->"b2fa45df-a424-41d1-b2d9-08cec47cf29d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "2"], "=", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "12", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", "\[Prime]"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", 
        RowBox[{
         SubsuperscriptBox["U", "13", 
          RowBox[{" ", 
           RowBox[{"\[Prime]", "*"}]}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "12"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "2"]}], "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "55f33e0e-1f37-444f-b276-fe7096a1aebf"],
 " ,"
}], "TechNoteText",
 CellID->1603057133,ExpressionUUID->"6ee010df-ea7b-4a5a-a26c-47bcbe8f4d11"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "2"], TraditionalForm]],ExpressionUUID->
  "149b7428-c865-4321-bc5d-cc91afce6854"],
 " is a normalization factor like ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[ScriptCapitalN]", "1"], TraditionalForm]],ExpressionUUID->
  "dd98e0d5-c7d0-485d-9c88-5ed7d226efd5"],
 " so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", "2"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"]}], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["T", "2", "\[Dagger]"], 
      SubscriptBox["T", "2"]}], "=", "I"}]}], TraditionalForm]],
  ExpressionUUID->"abf88000-517e-486c-84a8-0d1f7d772781"],
 ". It removes ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "13", 
    RowBox[{" ", "\[Prime]"}]], TraditionalForm]],ExpressionUUID->
  "f71796fa-2353-493a-abbf-5b0b7aa16e5b"],
 " while keeping the first and last column as they are:"
}], "TechNoteText",
 CellID->251399069,ExpressionUUID->"70a7d455-ad9d-4352-90f2-21dfe3b7d561"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["U", "11"], 
        SubsuperscriptBox["U", "12", "\[DoublePrime]"], "0", "0"},
       {
        SubscriptBox["U", "21"], 
        SubsuperscriptBox["U", "22", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "31"], 
        SubsuperscriptBox["U", "32", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {
        SubscriptBox["U", "41"], 
        SubsuperscriptBox["U", "42", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "825ee70f-38e3-486c-94fa-f7256ac54a39"],
 " ."
}], "TechNoteText",
 CellID->1163819034,ExpressionUUID->"c5a3ceb2-633f-4453-be32-fab28cb1d480"],

Cell["Similarly, we go further with the two-level unitary matrix", \
"TechNoteText",
 CellID->1025447562,ExpressionUUID->"7d4ef1da-5f1e-4585-9a88-e495de35de99"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "3"], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubsuperscriptBox["U", "11", "*"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         SubsuperscriptBox["U", "12", "\[DoublePrime]"], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {
        RowBox[{
         SubsuperscriptBox["U", "12", 
          RowBox[{"\[DoublePrime]", "*"}]], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["U", "11"]}], "/", 
         SubscriptBox["\[ScriptCapitalN]", "3"]}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "19d5ba49-e121-440d-bfbd-0640bb06e3b5"],
 " "
}], "TechNoteText",
 CellID->1140907359,ExpressionUUID->"2f678d90-8ce5-4043-8ca9-8dd5f2d5c74f"],

Cell[TextData[{
 "to remove element ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["U", "12", "\[DoublePrime]"], TraditionalForm]],
  ExpressionUUID->"1bded71f-1adb-4b33-a8f3-997325fb6437"],
 " and get"
}], "TechNoteText",
 CellID->348498650,ExpressionUUID->"85689eda-cb00-486d-9f21-5f0c452fac64"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "3"]}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["U", "11", "\[Prime]\[Prime]\[Prime]"], "0", "0", 
        "0"},
       {"0", 
        SubsuperscriptBox["U", "22", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "23", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "24", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "32", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "33", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "34", 
         RowBox[{" ", "\[Prime]"}]]},
       {"0", 
        SubsuperscriptBox["U", "42", "\[Prime]\[Prime]\[Prime]"], 
        SubsuperscriptBox["U", "43", "\[DoublePrime]"], 
        SubsuperscriptBox["U", "44", 
         RowBox[{" ", "\[Prime]"}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "1c3c0450-5da0-4066-a68f-37351fe9fb25"],
 " ."
}], "TechNoteText",
 CellID->1028905181,ExpressionUUID->"4a6214ca-1a0b-486a-86fb-97213ef1f55c"],

Cell[TextData[{
 "At this stage, all elements except for the first of the first column vanish \
(",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["U", "21", "\[Prime]\[Prime]\[Prime]"], "=", 
    RowBox[{
     SubsuperscriptBox["U", "31", "\[Prime]\[Prime]\[Prime]"], "=", 
     RowBox[{
      SubsuperscriptBox["U", "41", "\[Prime]\[Prime]\[Prime]"], "=", 
      "0"}]}]}], TraditionalForm]],ExpressionUUID->
  "17e88a84-fece-4048-86a3-c492aa69e083"],
 ") the product ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", 
    SubscriptBox["T", "1"], 
    SubscriptBox["T", "2"], 
    SubscriptBox["T", "3"]}], TraditionalForm]],ExpressionUUID->
  "f5930073-51d9-4031-9487-c85d01a7be17"],
 " is a unitary matrix. "
}], "TechNoteText",
 CellID->1271051423,ExpressionUUID->"edd83d6b-e299-4e04-b566-40297189934a"],

Cell["\<\
Repeating the procedure, we can remove all off-diagonal elements to get\
\>", "TechNoteText",
 CellID->1541429652,ExpressionUUID->"51b65adb-55df-4d59-8039-fd5c2bde3725"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubscriptBox["T", "1"], 
     SubscriptBox["T", "2"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "L"]}], "=", "I"}], TraditionalForm]],ExpressionUUID->
  "b053d365-fd0e-4b11-91c6-7b6960464107"],
 " ."
}], "TechNoteText",
 CellID->1712927403,ExpressionUUID->"cec64346-7d4c-4247-870c-ca1e4939f494"],

Cell[TextData[{
 "As Tj are all unitary, it enables us to rewrite ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "580e903c-6b04-4057-b3e1-78e41c990190"],
 " in a combination of two-level unitary transformations, that is,"
}], "TechNoteText",
 CellID->5090539,ExpressionUUID->"484be3ba-1543-4f18-b00f-3e57f1b64920"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", " ", "=", 
    RowBox[{
     SubsuperscriptBox["T", "L", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "2", "\[Dagger]"], 
     SubsuperscriptBox["T", "1", "\[Dagger]"]}]}], TraditionalForm]],
  ExpressionUUID->"ab456dfe-b5d3-4456-93e3-f154092fb8c0"],
 " ."
}], "TechNoteText",
 CellID->1804826740,ExpressionUUID->"025fd1b5-d234-4465-9d64-13f1da1ef074"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText",
 Editable->False,
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {
   "ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 FontColor->GrayLevel[0.85],
 CellID->315955750,ExpressionUUID->"a52f3b5d-9187-4ebb-bad2-a1cf6ade1091"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[399]:=",
 CellID->384188579,ExpressionUUID->"bd741a9a-0f91-4969-91f8-5d1a3e357d89"],

Cell["\<\
For demonstration, consider a Hermitian operator on a two-qubit system. \
Physically, it corresponds to a transverse-field Ising model.\
\>", "TechNoteMathCaption",
 CellID->516505305,ExpressionUUID->"c9d54857-7c0b-4959-993c-d64f99c54eb7"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[400]:=",
 CellID->1721604371,ExpressionUUID->"75067fbe-56c3-4963-a7b9-e3c2e612ee87"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Matrix", "[", "H", "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[401]:=",
 CellID->775759961,ExpressionUUID->"3958f2c8-904d-4ba1-9114-e9c876e6b08e"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowWithSeparators"]},
    "RowDefault"],
   QuantumMob`Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellLabel->"Out[401]=",
 CellID->1235509040,ExpressionUUID->"c2f4398e-7956-4cbc-95c5-60d35b3098cb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", 
      RowBox[{"-", "\[ImaginaryI]"}], 
      RowBox[{"-", "\[ImaginaryI]"}], "1"},
     {"\[ImaginaryI]", "0", "1", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"\[ImaginaryI]", "1", "0", 
      RowBox[{"-", "\[ImaginaryI]"}]},
     {"1", "\[ImaginaryI]", "\[ImaginaryI]", 
      RowBox[{"-", "2"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 4, 8, 12, 16}, {{1}, {2}, {3}, {4}, {2}, {1}, {4}, {3}, {3}, {
       4}, {1}, {2}, {4}, {3}, {2}, {1}}}, {
      2, Complex[0, -1], Complex[0, -1], 1, 0, Complex[0, 1], Complex[0, -1], 
       1, 0, Complex[0, -1], Complex[0, 1], 1, -2, Complex[0, 1], Complex[
       0, 1], 1}}]]]]], "Output",
 CellLabel->"Out[402]//MatrixForm=",
 CellID->1181052437,ExpressionUUID->"a58136e8-e11c-4136-9476-8e9da824255c"]
}, Open  ]],

Cell["\<\
This is the unitary operator generated by the above Hermitian operator.\
\>", "TechNoteMathCaption",
 CellID->595736468,ExpressionUUID->"42d3119d-e662-4e87-89bc-2c3830755c35"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", " ", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[403]:=",
 CellID->974055362,ExpressionUUID->"cea7db7b-f754-47d3-9e7b-2f4b6180cf11"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  QuantumMob`Q3`MultiplyExp[Complex[0, 
     Rational[-1, 4]] Pi (QuantumMob`Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellLabel->"Out[403]=",
 CellID->756959438,ExpressionUUID->"38acbffc-20b6-4a54-b3d8-614803f571e8"]
}, Open  ]],

Cell[TextData[{
 "This shows the matrix representation of ",
 StyleBox["U", "Input"],
 " in the logical basis."
}], "TechNoteMathCaption",
 CellID->1817782849,ExpressionUUID->"bc6262c4-50d3-4965-9d14-3bc0994e6e2b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", "U", "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[404]:=",
 CellID->1373980921,ExpressionUUID->"510304c2-5379-402a-be19-dddefe529ddd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[405]//MatrixForm=",
 CellID->524149638,ExpressionUUID->"eca5c853-63be-4cd6-91e7-935c1d59e733"]
}, Open  ]],

Cell[TextData[{
 "This shows the decomposition of the unitary matrix into two-level matrices \
(displaying the first three elements). For the purpose of efficiency, the \
resulting list is given in terms of ",
 StyleBox["GivensRotation", "Input"],
 "."
}], "TechNoteMathCaption",
 CellID->642635412,ExpressionUUID->"406c828c-9761-476c-aeb8-ce8dcfa61bf8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"GivensFactor", "[", 
     RowBox[{
      RowBox[{"N", "@", "mat"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "//", "Chop"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"twl", "[", 
  RowBox[{"[", 
   RowBox[{";;", "4"}], "]"}], "]"}]}], "Input",
 CellLabel->"In[406]:=",
 CellID->1078108721,ExpressionUUID->"7dff0186-e5ea-4132-b07f-1c026c741671"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.18898223650461365`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"-", "0.566946709513841`"}], "-", 
                    RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.566946709513841`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
                    ",", 
                    RowBox[{
                    RowBox[{"0.18898223650461365`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}],
                     "}"}]}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    QuantumMob`Q3`GivensRotation[{{Complex[
      0.18898223650461365`, -0.5669467095138409], 
      Complex[-0.566946709513841, -0.566946709513841]}, {Complex[
      0.566946709513841, -0.566946709513841], Complex[0.18898223650461365`, 
      0.5669467095138409]}}, {3, 4}, {
      $CellContext`S[1, QuantumMob`Q3`$], 
      $CellContext`S[2, QuantumMob`Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.1622214211307625`"}], "+", 
                    RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
                    ",", "0.8583950752789522`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.8583950752789522`"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.1622214211307625`"}], "-", 
                    RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}]}],
                     "}"}]}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    QuantumMob`Q3`GivensRotation[{{
       Complex[-0.1622214211307625, 0.4866642633922876], 
       0.8583950752789522}, {-0.8583950752789522, 
       Complex[-0.1622214211307625, -0.4866642633922876]}}, {2, 3}, {
      $CellContext`S[1, QuantumMob`Q3`$], 
      $CellContext`S[2, QuantumMob`Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False], ",", 
   InterpretationBox[
    RowBox[{
     TagBox["GivensRotation",
      "SummaryHead"], "[", 
     DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = 
      "Ready"}, 
      TemplateBox[{
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]],
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]],
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, QuantumMob`Q3`$]]}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox[
                   "\"Affected columns and rows: \"", 
                    "SummaryItemAnnotation"], "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.2525381361380527`"}], "-", 
                    RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}], 
                    ",", "0.9340497736158587`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.9340497736158587`"}], ",", 
                    RowBox[{
                    RowBox[{"-", "0.2525381361380527`"}], "+", 
                    
                    RowBox[{"0.25253813613805276`", " ", 
                    "\[ImaginaryI]"}]}]}], "}"}]}], "}"}], "SummaryItem"]}]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
            AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic]},
       "SummaryPanel"],
      DynamicModuleValues:>{}], "]"}],
    QuantumMob`Q3`GivensRotation[{{
       Complex[-0.2525381361380527, -0.25253813613805276`], 
       0.9340497736158587}, {-0.9340497736158587, 
       Complex[-0.2525381361380527, 0.25253813613805276`]}}, {3, 4}, {
      $CellContext`S[1, QuantumMob`Q3`$], 
      $CellContext`S[2, QuantumMob`Q3`$]}],
    Editable->False,
    SelectWithContents->True,
    Selectable->False]}], "}"}]], "Output",
 CellLabel->"Out[407]=",
 CellID->405045872,ExpressionUUID->"8b5c63cf-5de3-414b-992a-a242debea30e"]
}, Open  ]],

Cell[TextData[{
 "For a more intuitive form, you can convert ",
 StyleBox["GivensRotation", "Input"],
 " into the normal matrix form using ",
 StyleBox["Matrix", "Input"],
 ". Here the first three are shown."
}], "TechNoteMathCaption",
 CellID->1155771237,ExpressionUUID->"342bc3c2-fb32-4e52-80cb-329a27fe372f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Chop", "[", 
   RowBox[{"Matrix", "/@", 
    RowBox[{"twl", "[", 
     RowBox[{"[", 
      RowBox[{";;", "3"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[408]:=",
 CellID->1057593144,ExpressionUUID->"b3fc5557-e1fa-4603-be3a-b24c0c112df6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0"},
       {"0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {2, 2}, 0, {1, {{0, 1, 2}, {{1}, {2}}}, {1., 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"0.18898223650461365`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.566946709513841`"}], "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.566946709513841`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.18898223650461365`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {4}, {3}}}, {
        1, 1, Complex[0.18898223650461365`, -0.5669467095138409], 
         Complex[-0.566946709513841, -0.566946709513841], Complex[
         0.18898223650461365`, 0.5669467095138409], Complex[
         0.566946709513841, -0.566946709513841]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.1622214211307625`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789522`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789522`"}], 
        RowBox[{
         RowBox[{"-", "0.1622214211307625`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {3}, {2}, {4}}}, {
        1, Complex[-0.1622214211307625, 0.4866642633922876], 
         0.8583950752789522, 
         Complex[-0.1622214211307625, -0.4866642633922876], \
-0.8583950752789522, 1}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[408]=",
 CellID->82809714,ExpressionUUID->"a01347e9-1962-4893-9a06-17fe61b84fdc"]
}, Open  ]],

Cell["Indeed, they reconstruct the original matrix.", "TechNoteMathCaption",
 CellID->1969536942,ExpressionUUID->"fef8d9e6-b704-441e-b1e0-fc22f16830d7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"Dot", "@@", 
    RowBox[{"Matrix", "[", "twl", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "new"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[409]:=",
 CellID->694449336,ExpressionUUID->"b1e68e8b-3e31-4944-8777-816d7d5e907e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[410]//MatrixForm=",
 CellID->213459942,ExpressionUUID->"5d9d9ee9-7827-4a0c-adef-aaa52cefa7e2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Two-Level Unitary Transformations with Controlled-Unitary Gates\
\>", "Subsection",
 CellTags->"Section22",
 CellID->1363502801,ExpressionUUID->"893066a5-63e0-45c1-bed7-17c0c17761d5"],

Cell["\<\
We are still to express the two-level unitary transformations in terms of \
controlled-unitary gates. The two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->593579270,ExpressionUUID->"b3e0da64-c0b8-4f72-965f-f9a4624cb140"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "7be6a6c5-e92c-45af-8ccf-c3c9752c7613"],
 " "
}], "TechNoteText",
 CellID->1225250575,ExpressionUUID->"5251ed6a-5059-45c6-bbc2-ed267c6c227a"],

Cell["\<\
is already in the form of the matrix representation of a controlled-unitary \
gate, and just corresponds to a single controlled-unitary\
\>", "TechNoteText",
 CellID->565722942,ExpressionUUID->"ae6de79b-c23f-4d85-9eb3-74c5eebea12c"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "8616cdfc-3d86-45c2-af9b-f85add3cf3c8"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "b42a702c-cc1e-4141-a857-6ece02e65074"],
 "."
}], "TechNoteText",
 CellID->1195380925,ExpressionUUID->"203b4578-711d-4e82-88cd-11d233dc1bf7"],

Cell["A two-level unitary matrix of the form", "TechNoteText",
 CellID->1057688790,ExpressionUUID->"44dd7125-4f09-42ba-932a-27b38b44251b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "eb6015e3-a8ba-425e-a6e5-9422adab0370"],
 " "
}], "TechNoteText",
 CellID->1853347311,ExpressionUUID->"85f067c4-6922-4f5f-ad58-b805a896a8a4"],

Cell["\<\
also corresponds to a single controlled-unitary gate with the control and \
target qubit exchanged. Here, the first qubit is the target qubit and the \
second the control qubit:\
\>", "TechNoteText",
 CellID->2105439889,ExpressionUUID->"6b9eaa58-c7d0-4971-a3e4-aa4bd310ec6b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], "0", 
       SubscriptBox["U", "12"]},
      {"0", "0", "1", "0"},
      {"0", 
       SubscriptBox["U", "21"], "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "4efb7b7b-dbf2-4d2c-a262-ded9b3234238"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "e3bf2cff-fa36-4282-98da-cb704a28eb71"],
 "."
}], "TechNoteText",
 CellID->2040162804,ExpressionUUID->"daee65f4-d46b-4895-b63b-7e1f3333e9c0"],

Cell["\<\
\tMore complicated is the two-level unitary matrix of the form\
\>", "TechNoteText",
 CellID->144855179,ExpressionUUID->"a6431117-6549-4964-a8b1-a2eb2e6a0ed3"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "5d9ac5db-6df2-45c5-ba58-ede7f344fb83"],
 " . "
}], "TechNoteText",
 CellID->1482021402,ExpressionUUID->"950337e3-678a-4a27-b360-48c45076b1b6"],

Cell["\<\
As it affects both qubits, it cannot be represented by a single \
controlled-unitary gate. However, it is possible to bring it to the second of \
the above two forms by simultaneously exchanging the last two columns and \
rows.\
\>", "TechNoteText",
 CellID->1818365508,ExpressionUUID->"4e696a26-ef6c-4714-b84f-d05e52d4f53b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], "0", 
        SubscriptBox["U", "12"]},
       {"0", "0", "1", "0"},
       {"0", 
        SubscriptBox["U", "21"], "0", 
        SubscriptBox["U", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "e170edd7-78b1-4603-beef-7a60eef9de80"],
 " . "
}], "TechNoteText",
 CellID->429312499,ExpressionUUID->"64ee8cf9-b5cc-4309-9a76-8470d2cfc3b1"],

Cell["\<\
The specified exchanges correspond to flipping the bit values of the second \
qubit only when the first qubit has a value of 1, and they can be implemented \
by applying the CNOT gate with the first qubit as the control qubit and the \
second qubit as the target qubit. These observations lead to the following \
equivalence,\
\>", "TechNoteText",
 CellID->2057600420,ExpressionUUID->"94dc0dfe-85b1-461f-8c50-236d48fdd1c0"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "3507fcfc-23b0-4361-9491-ca4665fa61d2"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     LineBox[{{2, -2}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{3, -1}, {3, -2}}], 
     DiskBox[{3, -1}, 0.09], {CircleBox[{3, -2}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -2}, {3.2666666666666666`, -2}}, {{
         3, -2.2666666666666666`}, {3, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "d1f45504-34c2-48e0-8dff-4a2c1233c850"],
 ". "
}], "TechNoteText",
 CellID->1161091299,ExpressionUUID->"b494d82e-42fa-486c-be9f-5a2e582656ce"],

Cell["\<\
which allows us to implement the two-level unitary transformation with two \
CNOT gates and a controlled-unitary gate.\
\>", "TechNoteText",
 CellID->277562004,ExpressionUUID->"5e3d07fe-01ec-4ab6-b8b8-f064a1d4762b"],

Cell["\<\
Of course, the way is not unique. For example, it is also possible to bring \
the same two-level unitary matrix to the first two-level unitary form, this \
time, by simultaneously exchanging the second and fourth columns and rows.\
\>", "TechNoteText",
 CellID->650119944,ExpressionUUID->"ad7617a0-c4b1-42e2-83a0-96f3c248dd9d"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        SubscriptBox["U", "11"], 
        SubscriptBox["U", "12"], "0"},
       {"0", 
        SubscriptBox["U", "21"], 
        SubscriptBox["U", "22"], "0"},
       {"0", "0", "0", "1"}
      }], ")"}], "\[RightArrow]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        SubscriptBox["U", "22"], 
        SubscriptBox["U", "21"]},
       {"0", "0", 
        SubscriptBox["U", "12"], 
        SubscriptBox["U", "11"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "917dd7d6-0734-46c5-a7f9-a8aa8f9b1aae"],
 " . "
}], "TechNoteText",
 CellID->169102872,ExpressionUUID->"0ef54e05-3c54-44ae-80e2-91675c984c69"],

Cell[TextData[{
 "These exchanges correspond to flipping the bit values of the first qubit \
only when the second qubit has a value of 1, that is, to applying the CNOT \
gate with the second qubit as the control qubit and the first qubit as the \
target qubit. Note that in this case, unitary matrix ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "d85427fd-fb92-4d81-b872-70dd5cdfd4a0"],
 " itself is modified through the exchanges, and the rows and columns of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "026cd1fd-1988-44bf-810c-c42b56ccd51f"],
 " are exchanged. This is equivalent to the basis change by the Pauli X \
matrix, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", "\[RightArrow]", " ", 
     SuperscriptBox[
      RowBox[{"U", " "}], "\[Prime]"]}], " ", "=", " ", 
    RowBox[{"X", " ", "U", " ", "X"}]}], TraditionalForm]],ExpressionUUID->
  "45d64aa0-131b-4a6b-b7e5-f673a9f8e9b0"],
 ". Putting all together, the two-level unitary matrix is implemented as"
}], "TechNoteText",
 CellID->991104723,ExpressionUUID->"c5f8bbc4-98c6-471c-bcdf-455b059cc32c"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0"},
      {"0", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"], "0"},
      {"0", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"], "0"},
      {"0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "0a909432-92ac-46b4-8e05-a59e95912c0e"],
 " = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
     LineBox[{{1, -2}, {1, -1}}], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U'\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{3, -2}, {3, -1}}], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
         3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "c8f43195-da4b-480b-aa4d-b66a217b175a"],
 ". "
}], "TechNoteText",
 CellID->1613913329,ExpressionUUID->"a6464db9-1860-4f35-afbe-d202d60a16ea"],

Cell["\<\
\tIn a similar manner, we can implement another form of two-level unitary \
matrix as\
\>", "TechNoteText",
 CellID->175375246,ExpressionUUID->"019c8388-df53-47c4-9658-1c2e666df214"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {
       SubscriptBox["U", "11"], "0", "0", 
       SubscriptBox["U", "12"]},
      {"0", "1", "0", "0"},
      {"0", "0", "1", "0"},
      {
       SubscriptBox["U", "21"], "0", "0", 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "9756c34d-5445-4db8-a7fb-ab5e8b5b3b4b"],
 "  = ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{4, -2}, {4, -1}}], DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4, -1}, ImageScaled[{0.5, 0.5}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->295.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "bc241a44-0aed-4cc0-8730-e835c867e20a"],
 "= ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{5, -2}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5, -1}, ImageScaled[{0.5, 0.5}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7, -1}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9, -1}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{3.6, 3.6}, {5, 5}},
   ImageSize->367.2,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "f629fd70-a722-4496-a3e9-16f1395a9d7b"],
 "."
}], "TechNoteText",
 CellID->1184195838,ExpressionUUID->"548b2c25-51b4-4d26-af5a-aeb7424d2b17"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText",
 Editable->False,
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {
   "ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 FontColor->GrayLevel[0.85],
 CellID->1989239018,ExpressionUUID->"9fc1a979-7604-42d5-800a-cd9f095b45c9"],

Cell["\<\
For a demonstration, consider a single-qubit rotation around the y-axis.\
\>", "TechNoteText",
 CellID->2048492517,ExpressionUUID->"a72ec13b-b9fe-4ae6-9e0e-a666b9925e5c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Rotation", "[", 
    RowBox[{"\[Phi]", ",", 
     RowBox[{"S", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<U\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "U", "]"}], "//", "ExpToTrig"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[411]:=",
 CellID->555904515,ExpressionUUID->"104e20a1-411e-4516-81e4-916d1b93a505"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[412]//MatrixForm=",
 CellID->1323554704,ExpressionUUID->"6c759e38-4597-46f9-a52d-d4cca17ee1d8"]
}, Open  ]],

Cell["\<\
This is the two-level unitary transformation to be implemented with \
elementary gates.\
\>", "TechNoteMathCaption",
 CellID->691274085,ExpressionUUID->"2e9e94a2-cae9-4d6f-947a-f6fe0faa5bfc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"GivensRotation", "[", 
    RowBox[{
     RowBox[{"Matrix", "[", "U", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "op", "]"}], "//", "ExpToTrig"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[413]:=",
 CellID->357016325,ExpressionUUID->"345217f7-8dcb-4d3a-a2b3-1e48872ab5af"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Phi]", "2"], "]"}]}]},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "0"},
     {
      RowBox[{"Sin", "[", 
       FractionBox["\[Phi]", "2"], "]"}], "0", "0", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Phi]", "2"], "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 3, 4, 6}, {{1}, {4}, {2}, {3}, {4}, {1}}}, {
      Cos[Rational[1, 2] $CellContext`\[Phi]], -
       Sin[Rational[1, 2] $CellContext`\[Phi]], 1, 1, Cos[
       Rational[1, 2] $CellContext`\[Phi]], Sin[
       Rational[1, 2] $CellContext`\[Phi]]}}]]]]], "Output",
 CellLabel->"Out[414]//MatrixForm=",
 CellID->1348294502,ExpressionUUID->"0e15bb5c-15c1-4cbd-9bd9-b597129f939b"]
}, Open  ]],

Cell["This quantum circuit shows one implementation.", "TechNoteMathCaption",
 CellID->1549413286,ExpressionUUID->"e40b8ac0-8e97-492d-90eb-923a1bdfe3e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc1", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Spacer\>\"", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[415]:=",
 CellID->602394280,ExpressionUUID->"847ee677-ccda-473b-8f4e-8477c35936af"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], 
     DiskBox[{1, -1}, 0.09], {CircleBox[{1, -2}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -2}, {1.2666666666666666`, -2}}, {{
         1, -2.2666666666666666`}, {1, -1.7333333333333334`}}}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -2}}], 
     DiskBox[{7, -1}, 0.09], {CircleBox[{7, -2}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -2}, {7.266666666666667, -2}}, {{
         7, -2.2666666666666666`}, {7, -1.7333333333333334`}}}]}}},
   ImagePadding->{{5.76, 5.76}, {7.2, 7.2}},
   ImageSize->295.2,
   PlotRange->{{0, 8}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], "Spacer", 
   $CellContext`S[2, 1], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$], "Label" -> "U"]], 
   $CellContext`S[2, 1], "Spacer", 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], "PortSize" -> 0.1]]], "Output",
 CellLabel->"Out[415]=",
 CellID->538251970,ExpressionUUID->"91edb497-e615-480f-9d18-ba738dfb079d"]
}, Open  ]],

Cell["This is another implementation.", "TechNoteMathCaption",
 CellID->389328403,ExpressionUUID->"ff10ff60-4c52-4bc7-a622-cd5346b67ebd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\"\<Spacer\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ControlledGate", "[", 
     RowBox[{
      RowBox[{"S", "[", "2", "]"}], ",", "U"}], "]"}], ",", 
    "\[IndentingNewLine]", "\"\<Spacer\>\"", ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "[", "1", "]"}], ",", 
      RowBox[{"S", "[", "2", "]"}]}], "]"}], ",", 
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<PortSize\>\"", "->", "0.1"}]}], "]"}]}]], "Input",
 CellLabel->"In[416]:=",
 CellID->59796812,ExpressionUUID->"1072adec-52ec-4121-8287-8aeb531968bf"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {10, -1}}, {{0, -2}, {10, -2}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -1}}], 
     DiskBox[{5, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {5., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {7., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -1}, {8, -2}}], 
     DiskBox[{8, -1}, 0.09], {CircleBox[{8, -2}, 0.26666666666666666], 
      LineBox[{{{7.733333333333333, -2}, {8.266666666666667, -2}}, {{
         8, -2.2666666666666666`}, {8, -1.7333333333333334`}}}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.04000000000000001],
       FontWeight->"Light",
       FontSlant->Italic], {9., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{5.76, 5.76}, {7.2, 7.2}},
   ImageSize->367.2,
   PlotRange->{{0, 10}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 1], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   $CellContext`S[1, 1], "Spacer", 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[$CellContext`\[Phi], {0, 1, 0}, 
     $CellContext`S[1, QuantumMob`Q3`$], "Label" -> "U"]], "Spacer", 
   $CellContext`S[1, 1], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   $CellContext`S[1, 1], "PortSize" -> 0.1]]], "Output",
 CellLabel->"Out[416]=",
 CellID->1199738626,ExpressionUUID->"460951b4-a928-416f-8cac-bf2bea7350ef"]
}, Open  ]],

Cell["\<\
Check the equivalence of the two-level unitary matrix and the implementations\
\
\>", "TechNoteMathCaption",
 CellID->834281808,ExpressionUUID->"5148c4d2-8e61-47dd-bb6f-7eebe59629d4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc1", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "op", "]"}], "-", 
     RowBox[{"Matrix", "[", "qc2", "]"}]}], "//", "Normal"}], "//", 
   "Simplify"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[417]:=",
 CellID->853615793,ExpressionUUID->"e58b3d63-e8e5-40e5-9149-650e22614ac8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[417]//MatrixForm=",
 CellID->1283125499,ExpressionUUID->"e1f16f56-fa11-4380-9433-3fc21e730133"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[418]//MatrixForm=",
 CellID->459478519,ExpressionUUID->"da9afeb2-231e-4fde-acdf-67631c3e8f90"]
}, Open  ]],

Cell[TextData[{
 "So far, we have determined the implementations of 4 \[Times] 4 two-level \
unitary matrices of different forms just by inspection, that is, in an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " manner. For more than two qubits, the size of the two-level unitary \
matrices is much larger, and it is difficult to find proper implementations \
in such a way. Fortunately, there is a ",
 ButtonBox["systematic way based on the Gray code",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/GivensFactor"],
 "."
}], "TechNoteText",
 CellID->645391397,ExpressionUUID->"7b806c39-d1f1-4271-af31-bbe29595ff75"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demonstration", "Subsection",
 CellTags->"Section23",
 CellID->153308382,ExpressionUUID->"70b1fc81-e7a3-4281-babb-e58d4eabe3b4"],

Cell["\<\
In the above, we have shown that an arbitrary two-qubit unitary gate can be \
carried out by first decomposing its matrix representation into two-level \
unitary matrices and then implementing the two-level unitary matrices by \
means of the CNOT and controlled-unitary gates. Here we demonstrate the whole \
procedure.\
\>", "TechNoteText",
 CellID->1821083521,ExpressionUUID->"f0c1f8e3-bdb3-4100-bef1-6d2d0c5d1c46"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[419]:=",
 CellID->255167231,ExpressionUUID->"e3722511-5c20-4787-a562-69dcd4c0e16c"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[420]:=",
 CellID->370132468,ExpressionUUID->"ec807c0e-8daf-402f-88fc-bf653fb82f91"],

Cell["\<\
Consider a two-qubit model. Physically, it describes two qubits coupled with \
each other through an Ising-type couping and subject to an external magnetic \
field..\
\>", "TechNoteMathCaption",
 CellID->1013800403,ExpressionUUID->"205a2093-686c-47f8-b726-b350e30e3b55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "**", 
    RowBox[{"S", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "+", 
   RowBox[{"S", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}]}]], "Input",
 CellLabel->"In[421]:=",
 CellID->808117923,ExpressionUUID->"50f05c2a-d4cb-425b-a195-6753c7a72cf5"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[1, 1]], 
       InterpretationBox[
        TemplateBox[{"S", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        $CellContext`S[2, 1]]}, "RowWithSeparators"]},
    "RowDefault"],
   QuantumMob`Q3`Multiply[
    $CellContext`S[1, 1], 
    $CellContext`S[2, 1]]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[1, 3]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 2]], "+", 
  InterpretationBox[
   TemplateBox[{"S", 
     TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
     TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
    "Subsuperscript"],
   $CellContext`S[2, 3]]}]], "Output",
 CellLabel->"Out[421]=",
 CellID->104274221,ExpressionUUID->"7662303a-42bd-4025-8b2c-fc23fdf941a6"]
}, Open  ]],

Cell["\<\
We are interested in simulating the time-evolution operator governed by the \
above Hamiltonian.\
\>", "TechNoteMathCaption",
 CellID->322701359,ExpressionUUID->"63b08de7-5ea6-4115-a9d5-a369788f66ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "=", 
  RowBox[{"MultiplyExp", "[", 
   RowBox[{
    RowBox[{"-", "I"}], "  ", "H", "*", 
    RowBox[{"Pi", "/", "4"}]}], "]"}]}]], "Input",
 CellLabel->"In[422]:=",
 CellID->1245532038,ExpressionUUID->"8c9ed290-4a80-4137-930f-7b7ae025a19a"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[1, 1]], 
           InterpretationBox[
            TemplateBox[{"S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
             "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
            $CellContext`S[2, 1]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        $CellContext`S[1, 1], 
        $CellContext`S[2, 1]]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[1, 3]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 2]], "+", 
      InterpretationBox[
       TemplateBox[{"S", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
         TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
        "Subsuperscript"],
       $CellContext`S[2, 3]]}], ")"}]}]],
  QuantumMob`Q3`MultiplyExp[Complex[0, 
     Rational[-1, 4]] Pi (QuantumMob`Q3`Multiply[
      $CellContext`S[1, 1], 
      $CellContext`S[2, 1]] + $CellContext`S[1, 2] + $CellContext`S[
     1, 3] + $CellContext`S[2, 2] + $CellContext`S[2, 3])]]], "Output",
 CellLabel->"Out[422]=",
 CellID->190176395,ExpressionUUID->"6e1edca6-b254-4352-9b28-d8a6883d785e"]
}, Open  ]],

Cell["\<\
This is the 4\[Times]4 unitary matrix to implement in terms of elementary \
gates.\
\>", "TechNoteMathCaption",
 CellID->730080199,ExpressionUUID->"653d3eb7-35e7-4ab7-9e2f-1f844e8dae39"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"U", ",", 
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[423]:=",
 CellID->1883829282,ExpressionUUID->"a03e67cb-d77e-4ec0-968d-7b334e7e8015"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "6"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "6"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox[
          RowBox[{"5", " ", "\[ImaginaryI]"}], "6"]}], 
        SqrtBox["2"]]}], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "6"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "+", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]},
     {
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      FractionBox[
       RowBox[{
        FractionBox["1", "2"], "+", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         FractionBox["1", "2"], "-", 
         FractionBox["\[ImaginaryI]", "2"]}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[424]//MatrixForm=",
 CellID->839004029,ExpressionUUID->"659238ab-7356-412b-856f-90380bb9b265"]
}, Open  ]],

Cell["\<\
First, decompose the 4\[Times]4 unitary matrix into the two-level unitary \
matrices.\
\>", "TechNoteMathCaption",
 CellID->2133759026,ExpressionUUID->"a898af87-92df-4dbe-abc6-4460d13149eb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{
    RowBox[{"GivensFactor", "[", 
     RowBox[{
      RowBox[{"N", "@", "mat"}], ",", 
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Chop", "@", 
   RowBox[{"Matrix", "[", "twl", "]"}]}]}]}], "Input",
 CellLabel->"In[425]:=",
 CellID->1258528729,ExpressionUUID->"70b9f7ee-3542-4199-a05e-a52e86472199"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", "1.`", "0", "0"},
       {"0", "0", "1.`", "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 3, 4}, {{1}, {2}, {3}, {4}}}, {1., 1., 1., 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.9999999999999999`", "0", "0", "0"},
       {"0", "0.9999999999999999`", "0", "0"},
       {"0", "0", 
        RowBox[{"0.18898223650461354`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.566946709513841`"}], "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{"0.566946709513841`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.566946709513841`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.18898223650461354`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        0.9999999999999999, 0.9999999999999999, Complex[
         0.18898223650461354`, -0.5669467095138409], 
         Complex[-0.566946709513841, -0.566946709513841], Complex[
         0.566946709513841, -0.566946709513841], Complex[
         0.18898223650461354`, 0.5669467095138409]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789522`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789522`"}], 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {
        1., Complex[-0.16222142113076243`, 0.4866642633922876], 
         0.8583950752789522, -0.8583950752789522, 
         Complex[-0.16222142113076243`, -0.4866642633922876], 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", "1.`", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.25253813613805276`"}], "-", 
         RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}], 
        "0.9340497736158587`"},
       {"0", "0", 
        RowBox[{"-", "0.9340497736158587`"}], 
        RowBox[{
         RowBox[{"-", "0.25253813613805276`"}], "+", 
         RowBox[{"0.25253813613805276`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        1., 1., Complex[-0.25253813613805276`, -0.25253813613805276`], 
         0.9340497736158587, -0.9340497736158587, 
         Complex[-0.25253813613805276`, 0.25253813613805276`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "0.35355339059327384`"}], "-", 
         RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], 
        "0.7264831572567789`", "0", "0"},
       {
        RowBox[{"-", "0.7264831572567789`"}], 
        RowBox[{
         RowBox[{"-", "0.35355339059327384`"}], "+", 
         RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "1.`", "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 2, 4, 5, 6}, {{1}, {2}, {1}, {2}, {3}, {4}}}, {
        Complex[-0.35355339059327384`, -0.5892556509887896], 
         0.7264831572567789, -0.7264831572567789, 
         Complex[-0.35355339059327384`, 0.5892556509887896], 1., 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "+", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], 
        "0.8583950752789521`", "0"},
       {"0", 
        RowBox[{"-", "0.8583950752789521`"}], 
        RowBox[{
         RowBox[{"-", "0.16222142113076243`"}], "-", 
         RowBox[{"0.4866642633922876`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 3, 5, 6}, {{1}, {2}, {3}, {2}, {3}, {4}}}, {
        1., Complex[-0.16222142113076243`, 0.4866642633922876], 
         0.8583950752789521, -0.8583950752789521, 
         Complex[-0.16222142113076243`, -0.4866642633922876], 1.}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.9999999999999999`", "0", "0", "0"},
       {"0", "0.9999999999999999`", "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.18898223650461354`"}], "+", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.5669467095138409`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", "0.5669467095138409`"}], "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.18898223650461354`"}], "-", 
         RowBox[{"0.5669467095138409`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {4, 4}, 0, {
       1, {{0, 1, 2, 4, 6}, {{1}, {2}, {3}, {4}, {3}, {4}}}, {
        0.9999999999999999, 0.9999999999999999, 
         Complex[-0.18898223650461354`, 0.5669467095138409], Complex[
         0.5669467095138409, -0.5669467095138409], 
         Complex[-0.5669467095138409, -0.5669467095138409], 
         Complex[-0.18898223650461354`, -0.5669467095138409]}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[426]=",
 CellID->763089201,ExpressionUUID->"7b977f28-dd96-4398-86f1-c9c15b74f2d3"]
}, Open  ]],

Cell[TextData[{
 "Next, rewrite the two-level unitary matrices in terms of the CNOT and \
controlled-unitary gates. The first element of list ",
 StyleBox["twl", "Input"],
 " happens to be the identity matrix in this case, and it is excluded in the \
further analysis."
}], "TechNoteMathCaption",
 CellID->702850526,ExpressionUUID->"8ba0fd97-0719-4ddd-ae2e-4bcd35c9bd77"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Unfold", "/@", 
   RowBox[{"Rest", "[", "twl", "]"}]}]}]], "Input",
 CellLabel->"In[427]:=",
 CellID->1648731982,ExpressionUUID->"b262345f-cd83-45a7-8c6d-ecf28ae84317"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
      Complex[0.18898223650461365`, 0.] + 
      Complex[0., -0.566946709513841] $CellContext`S[2, 1] + 
      Complex[0., -0.566946709513841] $CellContext`S[2, 2] + 
      Complex[0., -0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
       LineBox[{{1, -2}, {1, -1}}], 
       DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
        LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
           1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
       LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.1],
         FontWeight->"Light",
         FontSlant->Italic], {2., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{3, -2}, {3, -1}}], 
       DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
        LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
           3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->190.79999999999998`,
     PlotRange->{{0, 4}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
       $CellContext`S[1, QuantumMob`Q3`$]}], 
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
      Complex[-0.1622214211307625, 0.] + 
      Complex[0., -0.8583950752789522] $CellContext`S[2, 2] + 
      Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
     
     QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
       $CellContext`S[1, QuantumMob`Q3`$]}]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
      Complex[-0.2525381361380527, 0.] + 
      Complex[0., 6.466853413996861*^-17] $CellContext`S[2, 1] + 
      Complex[0., 0.9340497736158587] $CellContext`S[2, 2] + 
      Complex[0., -0.25253813613805276`] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{1, -1}, 0.09]}, 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 0}, 
      Complex[-0.35355339059327373`, 0.] + 
      Complex[0., 0.7264831572567789] $CellContext`S[2, 2] + 
      Complex[0., -0.5892556509887896] $CellContext`S[2, 3], "Label" -> 
      "U"]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}}], {
       LineBox[{{1, -2}, {1, -1}}], 
       DiskBox[{1, -2}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
        LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
           1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
       LineBox[{{2, -1}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.1],
         FontWeight->"Light",
         FontSlant->Italic], {2., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
       LineBox[{{3, -2}, {3, -1}}], 
       DiskBox[{3, -2}, 0.09], {CircleBox[{3, -1}, 0.26666666666666666], 
        LineBox[{{{2.7333333333333334`, -1}, {3.2666666666666666`, -1}}, {{
           3, -1.2666666666666666`}, {3, -0.7333333333333334}}}]}}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->190.79999999999998`,
     PlotRange->{{0, 4}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
       $CellContext`S[1, QuantumMob`Q3`$]}], 
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
      Complex[-0.1622214211307625, 0.] + 
      Complex[0., 1.910269724657813*^-17] $CellContext`S[2, 1] + 
      Complex[0., -0.8583950752789521] $CellContext`S[2, 2] + 
      Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
     
     QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
       $CellContext`S[1, QuantumMob`Q3`$]}]]], ",", 
   InterpretationBox[
    GraphicsBox[{
      {Dashing[{Small, Small}], LineBox[{}]}, 
      LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}}], {
       LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
       {LightDarkSwitched[
         GrayLevel[1]], EdgeForm[Opacity[1]], 
        RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
        StyleBox["\<\"U\"\>",
         StripOnInput->False,
         FontSize->Scaled[0.2],
         FontWeight->"Light",
         FontSlant->Italic], {1., -2.}, NCache[
        ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
         ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}},
     ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
     ImageSize->118.8,
     PlotRange->{{0, 2}, {-2.5, -0.5}},
     PlotRangePadding->Scaled[0.025]],
    QuantumMob`Q3`QuantumCircuit[
     QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
      Complex[-0.18898223650461357`, 0.] + 
      Complex[0., -0.5669467095138409] $CellContext`S[2, 1] + 
      Complex[0., 0.5669467095138409] $CellContext`S[2, 2] + 
      Complex[0., 0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
      "U"]]]}], "}"}]], "Output",
 CellLabel->"Out[427]=",
 CellID->467861323,ExpressionUUID->"70d5e0b6-9363-4840-bbba-02488c812c5d"]
}, Open  ]],

Cell["\<\
This shows the overall quantum circuit model. Here the same label \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote] has been used for different \
controlled-unitary gates just for convenience. Do not forget to reverse the \
order before plugging the gates in the quantum circuit model.\
\>", "TechNoteMathCaption",
 CellID->328948492,ExpressionUUID->"586c24f5-d71d-45fb-a621-955329e9a695"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", 
   RowBox[{"Reverse", "@", "gates"}]}]}]], "Input",
 CellLabel->"In[428]:=",
 CellID->1014397666,ExpressionUUID->"3b5cb395-9a8c-40f5-a076-2c7bb6744c9e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}}], {
     LineBox[{{1, -1}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], {CircleBox[{2, -1}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -1}, {2.2666666666666666`, -1}}, {{
         2, -1.2666666666666666`}, {2, -0.7333333333333334}}}]}}, {
     LineBox[{{3, -1}, {3, -2}}], DiskBox[{3, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}}], 
     DiskBox[{4, -2}, 0.09], {CircleBox[{4, -1}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -1}, {4.266666666666667, -1}}, {{
         4, -1.2666666666666666`}, {4, -0.7333333333333334}}}]}}, {
     LineBox[{{5, -1}, {5, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{5, -1}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -1}, {6, -2}}], 
     DiskBox[{6, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -1}}], 
     DiskBox[{7, -2}, 0.09], {CircleBox[{7, -1}, 0.26666666666666666], 
      LineBox[{{{6.733333333333333, -1}, {7.266666666666667, -1}}, {{
         7, -1.2666666666666666`}, {7, -0.7333333333333334}}}]}}, {
     LineBox[{{8, -1}, {8, -2}}], DiskBox[{8, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -2}, {9, -1}}], 
     DiskBox[{9, -2}, 0.09], {CircleBox[{9, -1}, 0.26666666666666666], 
      LineBox[{{{8.733333333333333, -1}, {9.266666666666667, -1}}, {{
         9, -1.2666666666666666`}, {9, -0.7333333333333334}}}]}}, {
     LineBox[{{10, -1}, {10, -2}}], DiskBox[{10, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->442.8,
   PlotRange->{{0, 11}, {-2.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[-0.18898223650461357`, 0.] + 
    Complex[0., -0.5669467095138409] $CellContext`S[2, 1] + 
    Complex[0., 0.5669467095138409] $CellContext`S[2, 2] + 
    Complex[0., 0.5669467095138409] $CellContext`S[2, 3], "Label" -> "U"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[-0.1622214211307625, 0.] + 
    Complex[0., 1.910269724657813*^-17] $CellContext`S[2, 1] + 
    Complex[0., -0.8583950752789521] $CellContext`S[2, 2] + 
    Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 0}, 
    Complex[-0.35355339059327373`, 0.] + 
    Complex[0., 0.7264831572567789] $CellContext`S[2, 2] + 
    Complex[0., -0.5892556509887896] $CellContext`S[2, 3], "Label" -> "U"], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[-0.2525381361380527, 0.] + 
    Complex[0., 6.466853413996861*^-17] $CellContext`S[2, 1] + 
    Complex[0., 0.9340497736158587] $CellContext`S[2, 2] + 
    Complex[0., -0.25253813613805276`] $CellContext`S[2, 3], "Label" -> "U"], 
   
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[-0.1622214211307625, 0.] + 
    Complex[0., -0.8583950752789522] $CellContext`S[2, 2] + 
    Complex[0., -0.4866642633922876] $CellContext`S[2, 3], "Label" -> "U"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    Complex[0.18898223650461365`, 0.] + 
    Complex[0., -0.566946709513841] $CellContext`S[2, 1] + 
    Complex[0., -0.566946709513841] $CellContext`S[2, 2] + 
    Complex[0., -0.5669467095138409] $CellContext`S[2, 3], "Label" -> 
    "U"]]]], "Output",
 CellLabel->"Out[428]=",
 CellID->1407623994,ExpressionUUID->"59fda8c6-d8a1-448f-980c-4a1354d38852"]
}, Open  ]],

Cell["\<\
Check the above quantum circuit by converting it into the matrix \
representation.\
\>", "TechNoteMathCaption",
 CellID->608232459,ExpressionUUID->"d6ccdb04-61f0-4bfd-961a-b1bcd1dd0db7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[429]:=",
 CellID->540778693,ExpressionUUID->"a8731c35-1334-4d76-8147-a5520d3b75a7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "-", 
       RowBox[{"0.5892556509887896`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11785113019775788`"}], "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1178511301977579`"}], "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.11785113019775788`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11785113019775796`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "-", 
       RowBox[{"0.5892556509887898`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3535533905932737`"}], "-", 
       RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.11785113019775796`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3535533905932738`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "-", 
       RowBox[{"0.5892556509887897`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3535533905932737`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.1178511301977579`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3535533905932739`"}], "-", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327384`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327395`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327384`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327384`"}], "+", 
       RowBox[{"0.35355339059327384`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[430]//MatrixForm=",
 CellID->1256611806,ExpressionUUID->"dfa4b88d-48ff-4825-ab58-c6d92c39c8a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "mat"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellLabel->"In[431]:=",
 CellID->326787606,ExpressionUUID->"82e245c2-0c75-4c7a-9de2-61049103dc49"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[431]//MatrixForm=",
 CellID->1520438844,ExpressionUUID->"c9bf27ea-69a1-4ed5-b01f-f397b9ccbdfb"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]],
          "TutorialMoreAbout",ExpressionUUID->
         "a1ee7f6b-7e64-4e86-b23e-fc89ee5fed55"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"8a788bd9-76bd-44a4-ab95-\
98f9ce9aa753"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "81fb697e-55e3-40d5-9b56-0641d4bdda13"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "221f15d7-0d6c-4a5c-b81b-b150f11d8b43"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"701cb65d-4b2c-4299-9aba-\
04502403875e"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. M. Greenberger, M. A. Horne, and A. Zeilinger \
(1989)"}]]]], "http://arxiv.org/abs/0712.0921"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "e2833b71-8ec6-4259-9cf5-f5c5c091d980"]}]],ExpressionUUID->
         "26fe737c-1136-4d75-8475-14693b91eb10"],
        " , \[OpenCurlyDoubleQuote]Going beyond Bell\[CloseCurlyQuote]s \
theorem,\[CloseCurlyDoubleQuote] in Bell\[CloseCurlyQuote]s Theorem, Quantum \
Theory, and Conceptions of the Universe, edited by Kafatos, M. (Kluwer \
Academic, Dordrecht, The Netherlands, 1989)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "70137a5d-c487-459e-bb17-929e649ff31f"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. Bouwmeester, J.-W. Pan, M. Daniell, H. Weinfurter, and \
A. Zeilinger (1999)"}]]]], "https://doi.org/10.1103/PhysRevLett.82.1345"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "1ee632db-d069-44c3-b3fe-66bfe58a5947"]}]],ExpressionUUID->
         "3a110d8c-9a4d-44d8-b726-8882e025a308"],
        ", Phys. Rev. Lett. 82, 1345 (1999), \
\[OpenCurlyDoubleQuote]Observation of Three-Photon Greenberger- \
Horne-Zeilinger Entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "4f603146-9124-485f-af1a-8efe60a49114"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J.-W. Pan, D. Bouwmeester, M. Daniell, H. Weinfurter, and \
A. Zeilinger (2000)"}]]]], "https://doi.org/10.1038/35000514"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "0589e063-bfaa-48fa-bd5b-69f88d83d51d"]}]],ExpressionUUID->
         "fc8a50a2-1a0b-4af3-9d11-0048c43d0b7a"],
        ", Nature 403, 515 (2000), \[OpenCurlyDoubleQuote]Experimental test \
of quantum nonlocality in three-photon Greenberger-Horne-Zeilinger \
entanglement.\[CloseCurlyDoubleQuote]"
       }], "TutorialRelatedLinks",ExpressionUUID->
        "77fbe59a-c431-48a2-a0df-9faaab90f783"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "26bec867-c7a3-4b1b-9af7-82bab486a7bb"]}]],ExpressionUUID->
         "dd6ffaf4-2bf1-4855-a2fe-7413111998a1"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "ac6bbc51-2974-483c-b8b6-b332d43f8ff5"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "fa4bf893-d127-4cb1-8c13-e23d613ac774"]}]],ExpressionUUID->
         "617957de-fcd4-43b1-b8c7-2b9f48e2320a"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "fa26c203-19d6-4d5f-992b-2091f59497fe"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"ebe4a2e1-a55a-46d4-aaed-\
6ef94ba24974"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"ff119bdd-c928-43ac-b2dc-4a4d200d7b8b"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Two-Qubit Gates",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2019", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 10, 14, 30, 22.102834}", 
    "history" -> {"12", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {"quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Tech Note", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3", "status" -> "None", "summary" -> 
    "This document introduces quantum logic gate operations acting on two \
qubits. Such operations are represented by 4*4 unitary matrices. We will see \
that any two-qubit gate operations can be decomposed into controlled-unitary \
gates. A controlled-unitary gate acts a unitary operator on one qubit \
depending on the logical state of the other qubit. A controlled-unitary gate \
on two qubits can be further decomposed into factors including only the CNOT \
gate and single-qubit rotation gates. In this sense, the CNOT gate alone is \
sufficient for any two-qubit gate. The controlled-unitary and CNOT gates have \
various interesting properties that make them useful in implementing quantum \
algorithms. In this document, we first examine the basic properties of the \
CNOT gate, and in particular, how it is used to generate an entanglement \
between two qubits. Then, we discuss the properties of the controlled-unitary \
gate and describe how to implement a controlled-unitary gate in terms of the \
CNOT gate and single-qubit rotations. Finally, we discuss how an arbitrary \
two-qubit unitary operation can be decomposed into controlled-unitary gates. \
See also Section 2.2 of the Quantum Workbook (2022).", "synonyms" -> {}, 
    "tabletags" -> {}, "title" -> "Two-Qubit Gates", "titlemodifier" -> "", 
    "metadescription" -> "", "windowtitle" -> "Two-Qubit Gates", "type" -> 
    "Tech Note", "uri" -> "QuantumMob/Q3/tutorial/TwoQubitGates"}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"cdfec8b4-82b8-44c2-99ac-807d0dee53a6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Section11"->{
  Cell[18043, 449, 153, 2, 70, "TechNoteSection",ExpressionUUID->"ef2d7eed-98b4-48fa-8dba-f39d81ed4b1a",
   CellTags->"Section11",
   CellID->1585062394]},
 "Section12"->{
  Cell[98974, 2632, 147, 2, 70, "TechNoteSection",ExpressionUUID->"d19f8df7-8585-487f-bc79-cbc9368fc2e4",
   CellTags->"Section12",
   CellID->29167796]},
 "Section13"->{
  Cell[119761, 3196, 136, 2, 70, "TechNoteSection",ExpressionUUID->"f2662b15-9f86-4e39-b643-ce888942a406",
   CellTags->"Section13",
   CellID->1218939314]},
 "Section14"->{
  Cell[153122, 4112, 151, 2, 70, "TechNoteSection",ExpressionUUID->"855d9a1c-73ec-46d1-b3b7-48c2039a9bec",
   CellTags->"Section14",
   CellID->1455445268]},
 "Section15"->{
  Cell[153298, 4118, 132, 2, 70, "Subsection",ExpressionUUID->"c24f344f-bb76-4122-b226-ee4db4ca152e",
   CellTags->"Section15",
   CellID->1829879946]},
 "Section16"->{
  Cell[180647, 4864, 138, 2, 70, "Subsection",ExpressionUUID->"c6e75770-6043-490f-a91c-bfdeacb71686",
   CellTags->"Section16",
   CellID->715838931]},
 "Section17"->{
  Cell[194390, 5263, 150, 2, 70, "Subsection",ExpressionUUID->"b347b255-1de6-4725-a2c3-a15a494551eb",
   CellTags->"Section17",
   CellID->616090041],
  Cell[333804, 8735, 156, 2, 70, "Subsection",ExpressionUUID->"4827f088-cd4f-4c7a-821e-f9fbb525c1ae",
   CellTags->"Section17",
   CellID->1379525988]},
 "Section18"->{
  Cell[378355, 9745, 157, 2, 70, "Subsection",ExpressionUUID->"bbef1a7e-5d6e-4b49-ab22-9b109853447d",
   CellTags->"Section18",
   CellID->1847739219]},
 "Section19"->{
  Cell[399241, 10342, 148, 2, 70, "TechNoteSection",ExpressionUUID->"b1940ebc-2ea0-46a2-a0d4-82b4494f8792",
   CellTags->"Section19",
   CellID->1476129218]},
 "Section20"->{
  Cell[399999, 10361, 149, 2, 70, "Subsection",ExpressionUUID->"6200b313-4a25-4f21-90b7-acf702fe167a",
   CellTags->"Section20",
   CellID->749947798]},
 "Section22"->{
  Cell[451662, 11746, 193, 4, 70, "Subsection",ExpressionUUID->"893066a5-63e0-45c1-bed7-17c0c17761d5",
   CellTags->"Section22",
   CellID->1363502801]},
 "Section23"->{
  Cell[484857, 12670, 134, 2, 70, "Subsection",ExpressionUUID->"70b1fc81-e7a3-4281-babb-e58d4eabe3b4",
   CellTags->"Section23",
   CellID->153308382]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Section11", 535752, 13953},
 {"Section12", 535924, 13957},
 {"Section13", 536095, 13961},
 {"Section14", 536269, 13965},
 {"Section15", 536443, 13969},
 {"Section16", 536612, 13973},
 {"Section17", 536780, 13977},
 {"Section18", 537100, 13984},
 {"Section19", 537269, 13988},
 {"Section20", 537444, 13992},
 {"Section22", 537613, 13996},
 {"Section23", 537783, 14000}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[583, 21, 7029, 168, 70, "AnchorBarGrid",ExpressionUUID->"d440a8b3-d87f-478a-bfe7-fd516ff06b59",
 CellID->1],
Cell[CellGroupData[{
Cell[7637, 193, 116, 1, 70, "TechNoteTitle",ExpressionUUID->"5abd8b83-3067-453c-815f-a95eedaec825",
 CellID->1379112571],
Cell[7756, 196, 4843, 110, 70, "TechNoteJumpBox",ExpressionUUID->"71101875-292e-4fd0-8e49-73a0261b8a38"],
Cell[12602, 308, 1143, 23, 70, "TechNoteText",ExpressionUUID->"f4a1890f-0595-48c6-93d9-bb2db2e854a0",
 CellID->1465929903],
Cell[13748, 333, 1384, 31, 70, "TechNoteText",ExpressionUUID->"aea1b5f6-7256-476e-9e2a-3d1b0d2aaef8",
 CellID->1951481337],
Cell[15135, 366, 383, 12, 70, "TechNoteText",ExpressionUUID->"3a853e07-f4e2-4d83-b093-af2b487a3b48",
 CellID->1308734266],
Cell[15521, 380, 1846, 48, 70, "DefinitionBox",ExpressionUUID->"71d627c7-c171-4fe3-a0f1-530909fcf15a",
 CellID->407539380],
Cell[17370, 430, 135, 1, 70, "TechNoteCaption",ExpressionUUID->"842d905e-fd35-4aee-9e84-3c8141133e8f",
 CellID->1189009377],
Cell[17508, 433, 328, 7, 70, "TechNoteMathCaption",ExpressionUUID->"a8aea9aa-746b-4819-8668-3339dfa7f348",
 CellID->1428640008],
Cell[17839, 442, 179, 3, 70, "Input",ExpressionUUID->"fcf81024-77cc-4876-9394-52cdb5813a06",
 CellID->853967906],
Cell[CellGroupData[{
Cell[18043, 449, 153, 2, 70, "TechNoteSection",ExpressionUUID->"ef2d7eed-98b4-48fa-8dba-f39d81ed4b1a",
 CellTags->"Section11",
 CellID->1585062394],
Cell[18199, 453, 518, 14, 70, "TechNoteText",ExpressionUUID->"8d149f78-3667-4a47-ba1a-8fe2c3d83143",
 CellID->609014923],
Cell[18720, 469, 554, 19, 70, "TechNoteText",ExpressionUUID->"de484052-348f-4a89-bb3f-48ab2ccf0be5",
 CellID->806749259],
Cell[19277, 490, 537, 17, 70, "TechNoteText",ExpressionUUID->"987051b7-41e0-46f0-91bd-dde81ec869e7",
 CellID->1970532502],
Cell[19817, 509, 183, 4, 70, "Input",ExpressionUUID->"cdf3edc4-d1a9-45d5-82b0-fdedd1fa73fd",
 CellID->861826122],
Cell[CellGroupData[{
Cell[20025, 517, 265, 7, 70, "Input",ExpressionUUID->"d0115030-88e8-4f31-9388-db03be61338e",
 CellID->246957080],
Cell[20293, 526, 574, 17, 70, "Output",ExpressionUUID->"fdc52139-b456-46d8-af4a-5dc00ba2125e",
 CellID->1268158967]
}, Open  ]],
Cell[CellGroupData[{
Cell[20904, 548, 498, 14, 70, "Input",ExpressionUUID->"594b7fed-3202-4297-9e01-b9c0e5db9bc3",
 CellID->149239284],
Cell[21405, 564, 7610, 176, 70, "Output",ExpressionUUID->"10204f55-8d37-4833-bb14-403d0edadd75",
 CellID->172561894]
}, Open  ]],
Cell[29030, 743, 170, 3, 70, "TechNoteText",ExpressionUUID->"cd886714-d8be-445f-acb6-ec76e65df686",
 CellID->690265281],
Cell[CellGroupData[{
Cell[29225, 750, 272, 6, 70, "Input",ExpressionUUID->"ae117149-30d6-4d4f-b70b-ff40e1f52aed",
 CellID->581916673],
Cell[29500, 758, 806, 23, 70, "Output",ExpressionUUID->"1d00c304-6e70-45ed-a038-5e526fdc4dba",
 CellID->1144829008]
}, Open  ]],
Cell[30321, 784, 192, 4, 70, "TechNoteText",ExpressionUUID->"11f2b0cd-659f-4675-91af-2ea7ac5ee11d",
 CellID->107481873],
Cell[CellGroupData[{
Cell[30538, 792, 163, 3, 70, "Input",ExpressionUUID->"99b61477-0318-4a75-a81c-a9d45db4b66b",
 CellID->414092384],
Cell[30704, 797, 1575, 41, 70, "Output",ExpressionUUID->"8c866d4c-901f-4541-95f6-9a9354ff0a2d",
 CellID->1835143983]
}, Open  ]],
Cell[CellGroupData[{
Cell[32316, 843, 195, 4, 70, "Input",ExpressionUUID->"4a31359a-7547-4136-b769-f63c6d0deea9",
 CellID->597624604],
Cell[32514, 849, 866, 29, 70, "Output",ExpressionUUID->"54e7111c-ef9f-4824-9ebe-afdf8994ab71",
 CellID->1104784067]
}, Open  ]],
Cell[33395, 881, 184, 3, 70, "TechNoteText",ExpressionUUID->"ee1b6efa-6586-40ea-9dc5-d20e0d9e203a",
 CellID->1181321350],
Cell[CellGroupData[{
Cell[33604, 888, 192, 4, 70, "Input",ExpressionUUID->"a69715ef-960d-4561-964e-bccf141a87ec",
 CellID->981612935],
Cell[33799, 894, 797, 17, 70, "Output",ExpressionUUID->"d0f1382f-0b96-4846-8273-f2431f8f6d6f",
 CellID->962202107]
}, Open  ]],
Cell[34611, 914, 283, 5, 70, "TechNoteText",ExpressionUUID->"873a7d5e-4d8e-496b-bc87-2f14662b9204",
 CellID->606925297],
Cell[34897, 921, 746, 16, 70, "TechNoteText",ExpressionUUID->"e5a6b1f7-4003-4926-89fa-7dfe1d6dec75",
 CellID->46143429],
Cell[CellGroupData[{
Cell[35668, 941, 645, 19, 70, "Input",ExpressionUUID->"0a8d6244-eb27-4d8e-a834-1d09822aeb4d",
 CellID->291014636],
Cell[36316, 962, 4396, 112, 70, "Output",ExpressionUUID->"d1f22758-36e5-4775-8197-29ee5dba6caa",
 CellID->1178950439]
}, Open  ]],
Cell[40727, 1077, 616, 14, 70, "TechNoteText",ExpressionUUID->"0dde469d-778a-42f0-a1e0-dde6f9ad17f7",
 CellID->1152615977],
Cell[CellGroupData[{
Cell[41368, 1095, 273, 7, 70, "Input",ExpressionUUID->"567df8ef-0372-408c-a8c0-98c9d7790b08",
 CellID->1714229499],
Cell[41644, 1104, 1246, 27, 70, "Output",ExpressionUUID->"5bc72b0e-3494-41ae-9f1f-23b4dfae92e3",
 CellID->1935901051]
}, Open  ]],
Cell[CellGroupData[{
Cell[42927, 1136, 499, 14, 70, "Input",ExpressionUUID->"da8da86a-e2fe-467f-a3ce-c2e2e0eaea30",
 CellID->1435008719],
Cell[43429, 1152, 11950, 280, 70, "Output",ExpressionUUID->"39eb1317-bfc4-4599-8dec-792d09fa12c8",
 CellID->164228460]
}, Open  ]],
Cell[55394, 1435, 987, 22, 70, "TechNoteText",ExpressionUUID->"a8ec5281-be83-4b9a-9b49-40aa60093263",
 CellID->1854176847],
Cell[CellGroupData[{
Cell[56406, 1461, 944, 28, 70, "Input",ExpressionUUID->"1d55f05f-8eb5-42c4-a7a3-9d7e35833bcb",
 CellID->1015065912],
Cell[57353, 1491, 1660, 31, 70, "Output",ExpressionUUID->"152f4a8c-f269-4975-8052-0ff386308d4a",
 CellID->671240825]
}, Open  ]],
Cell[59028, 1525, 143, 1, 70, "TechNoteText",ExpressionUUID->"aafa1906-984a-4ecc-9540-56cbea4d81fa",
 CellID->1898388060],
Cell[59174, 1528, 523, 19, 70, "TechNoteText",ExpressionUUID->"78123947-cac1-4dd1-9096-b7ceaf4e092b",
 CellID->1043580941],
Cell[59700, 1549, 1369, 43, 70, "TechNoteText",ExpressionUUID->"1c094848-45ef-4ee7-ac3f-babdd0585392",
 CellID->965930338],
Cell[61072, 1594, 654, 20, 70, "TechNoteText",ExpressionUUID->"d41670cb-3828-4e77-a2da-28e3f1d64991",
 CellID->1562303093],
Cell[61729, 1616, 1170, 35, 70, "TechNoteText",ExpressionUUID->"8b25d741-bebc-4566-bc67-a427ccf5f690",
 CellID->345532182],
Cell[62902, 1653, 475, 17, 70, "TechNoteText",ExpressionUUID->"ead3dbf6-b5c6-4f9a-99bb-018c961b5fe4",
 CellID->563601386],
Cell[63380, 1672, 1089, 31, 70, "TechNoteText",ExpressionUUID->"03cc6698-77ef-43b7-8292-aca01611a78f",
 CellID->2045611232],
Cell[64472, 1705, 1119, 39, 70, "TechNoteText",ExpressionUUID->"c670a09c-1c42-42b7-95e9-40a3d2ea495f",
 CellID->1522271401],
Cell[65594, 1746, 1192, 38, 70, "TechNoteText",ExpressionUUID->"36eec8b3-b38d-41e8-aa8b-bd734ed484b8",
 CellID->1842749896],
Cell[CellGroupData[{
Cell[66811, 1788, 273, 7, 70, "Input",ExpressionUUID->"46bdb5a1-2fe7-4be0-acf7-671c5fdd6c75",
 CellID->88345038],
Cell[67087, 1797, 3013, 64, 70, "Output",ExpressionUUID->"8e28fe73-2eac-4c5d-854e-6225d56ded50",
 CellID->812948084]
}, Open  ]],
Cell[CellGroupData[{
Cell[70137, 1866, 418, 12, 70, "Input",ExpressionUUID->"10a7ad12-932a-4ea6-a706-217a180f5164",
 CellID->1915435092],
Cell[70558, 1880, 5874, 155, 70, "Output",ExpressionUUID->"c218bd49-0628-4daf-8c1e-6e4a2f630cad",
 CellID->927485574]
}, Open  ]],
Cell[76447, 2038, 305, 5, 70, "TechNoteText",ExpressionUUID->"f25c67f6-d459-45bf-b3ce-a0a1e78133e9",
 CellID->716147443],
Cell[76755, 2045, 1249, 45, 70, "TechNoteText",ExpressionUUID->"fa0a218d-7caf-48cb-b46c-44b8cd03f4ad",
 CellID->1791716713],
Cell[78007, 2092, 174, 3, 70, "TechNoteText",ExpressionUUID->"382dfd14-ed06-4bed-88f0-a3a2a6f8f294",
 CellID->1367097157],
Cell[78184, 2097, 321, 5, 70, "TechNoteText",ExpressionUUID->"2b645087-fbaf-446a-86c1-2db08b00e9b6",
 CellID->874378446],
Cell[CellGroupData[{
Cell[78530, 2106, 774, 22, 70, "Input",ExpressionUUID->"459bfa87-f754-438b-b52a-6337d7c96ef2",
 CellID->447945501],
Cell[79307, 2130, 1572, 29, 70, "Output",ExpressionUUID->"94efc6d9-ea81-4f4c-8400-1be6b5d4067c",
 CellID->1813732292]
}, Open  ]],
Cell[80894, 2162, 115, 1, 70, "TechNoteText",ExpressionUUID->"b6b4e097-f32c-465a-8bf5-40142d46f540",
 CellID->880946029],
Cell[CellGroupData[{
Cell[81034, 2167, 732, 21, 70, "Input",ExpressionUUID->"9191fedb-5666-4311-9425-1eb92858985c",
 CellID->1307646985],
Cell[81769, 2190, 1572, 29, 70, "Output",ExpressionUUID->"aae04722-12ee-4801-b372-0bf6a687549a",
 CellID->2015746126]
}, Open  ]],
Cell[83356, 2222, 235, 4, 70, "TechNoteText",ExpressionUUID->"d325e5f5-0af6-4c94-a753-a3ee604cbf5c",
 CellID->169608441],
Cell[83594, 2228, 667, 21, 70, "TechNoteText",ExpressionUUID->"c79313af-8140-487c-bb59-81320c461600",
 CellID->898268318],
Cell[84264, 2251, 381, 10, 70, "TechNoteText",ExpressionUUID->"43bc5cca-2f0a-4b46-91a5-5edc36aa8425",
 CellID->385582216],
Cell[84648, 2263, 2416, 55, 70, "TechNoteText",ExpressionUUID->"ef0fd21d-2944-42bd-97e4-2616566b7fae",
 CellID->1620101282],
Cell[87067, 2320, 131, 1, 70, "TechNoteText",ExpressionUUID->"5b91374c-6991-4212-8308-d845db220cae",
 CellID->712578174],
Cell[87201, 2323, 787, 27, 70, "TechNoteText",ExpressionUUID->"a69f0138-9d11-4935-bb3a-e61f3f632f12",
 CellID->1522141313],
Cell[87991, 2352, 414, 7, 70, "TechNoteText",ExpressionUUID->"3265e1c4-5b06-443a-a38b-be08481e421d",
 CellID->1803844527],
Cell[88408, 2361, 393, 8, 70, "TechNoteText",ExpressionUUID->"05c0873c-180b-4b31-b7a9-38d5ddb3c83b",
 CellID->1188320590],
Cell[88804, 2371, 334, 6, 70, "TechNoteText",ExpressionUUID->"7937a04d-c0d5-4864-a726-3b318ec03988",
 CellID->506239030],
Cell[89141, 2379, 3535, 89, 70, "TechNoteText",ExpressionUUID->"4a7a1b8f-be18-4f04-8573-b4dca518fd45",
 CellID->1226753413],
Cell[92679, 2470, 402, 6, 70, "TechNoteText",ExpressionUUID->"819170f0-e2c5-4564-a4a5-67da3b308aef",
 CellID->365203462],
Cell[93084, 2478, 5254, 136, 70, "TechNoteText",ExpressionUUID->"373f366c-7413-4792-9220-219fdb55500d",
 CellID->977674470],
Cell[98341, 2616, 596, 11, 70, "TechNoteText",ExpressionUUID->"b8f2ca1d-fe95-4f76-82be-8d50fc84dc39",
 CellID->833871357]
}, Open  ]],
Cell[CellGroupData[{
Cell[98974, 2632, 147, 2, 70, "TechNoteSection",ExpressionUUID->"d19f8df7-8585-487f-bc79-cbc9368fc2e4",
 CellTags->"Section12",
 CellID->29167796],
Cell[99124, 2636, 270, 5, 70, "TechNoteText",ExpressionUUID->"07f46add-f0ee-4c55-b1c0-8e0be22cbe6b",
 CellID->596875856],
Cell[99397, 2643, 628, 22, 70, "TechNoteText",ExpressionUUID->"f4f1e32c-bdd0-4ed8-bb89-0f03070fb06c",
 CellID->796396655],
Cell[100028, 2667, 344, 11, 70, "TechNoteText",ExpressionUUID->"8edc9c6f-35ea-4127-a01f-509f4a8928ff",
 CellID->1920492481],
Cell[100375, 2680, 179, 3, 70, "Input",ExpressionUUID->"8925cbcf-23e3-4655-ad27-7ef486a591f6",
 CellID->754200946],
Cell[100557, 2685, 184, 4, 70, "Input",ExpressionUUID->"e65e8100-31b9-4038-ade9-99045740b9ec",
 CellID->1406814828],
Cell[CellGroupData[{
Cell[100766, 2693, 264, 7, 70, "Input",ExpressionUUID->"8e5860bf-e840-489f-8170-9c07873f4145",
 CellID->1037913757],
Cell[101033, 2702, 512, 15, 70, "Output",ExpressionUUID->"dda7132b-ce91-43f4-813e-eddb549b6fc1",
 CellID->2090608257]
}, Open  ]],
Cell[CellGroupData[{
Cell[101582, 2722, 499, 14, 70, "Input",ExpressionUUID->"f7411456-275c-477e-b45d-7bc3a2f257a3",
 CellID->1887946780],
Cell[102084, 2738, 7667, 178, 70, "Output",ExpressionUUID->"ea322d9f-53b4-4cc7-a330-3e54e7b932d6",
 CellID->1873026832]
}, Open  ]],
Cell[109766, 2919, 181, 3, 70, "TechNoteText",ExpressionUUID->"d51f44bb-eefa-44ee-88a0-d2901f250fce",
 CellID->1230965299],
Cell[CellGroupData[{
Cell[109972, 2926, 194, 4, 70, "Input",ExpressionUUID->"c642b11c-0f6e-479a-997b-662cdae9ec69",
 CellID->2123808742],
Cell[110169, 2932, 792, 24, 70, "Output",ExpressionUUID->"ddb4ffcf-881e-4f83-b619-60ba8419b907",
 CellID->2146667698]
}, Open  ]],
Cell[110976, 2959, 315, 5, 70, "TechNoteText",ExpressionUUID->"923e65fd-290f-4df3-874d-b5214432233f",
 CellID->776960470],
Cell[CellGroupData[{
Cell[111316, 2968, 169, 3, 70, "Input",ExpressionUUID->"cfb30244-a68a-4591-8476-000d354c072d",
 CellID->1674045530],
Cell[111488, 2973, 637, 16, 70, "Output",ExpressionUUID->"59ed12d6-0fb4-4b24-b782-337fd4a0fc38",
 CellID->1318730686]
}, Open  ]],
Cell[112140, 2992, 252, 4, 70, "TechNoteText",ExpressionUUID->"4850fc89-615b-4959-ac9e-85d2a61872a4",
 CellID->573709808],
Cell[112395, 2998, 505, 11, 70, "TechNoteText",ExpressionUUID->"fb88aa80-38c5-4cdd-a89f-71524c35e053",
 CellID->139168026],
Cell[CellGroupData[{
Cell[112925, 3013, 1148, 35, 70, "Input",ExpressionUUID->"45057138-bd46-4162-a43c-b221864d1bac",
 CellID->387321399],
Cell[114076, 3050, 798, 17, 70, "Output",ExpressionUUID->"86848a9e-8be8-41cc-a713-7b826ca70ad7",
 CellID->1875402562],
Cell[114877, 3069, 1489, 37, 70, "Output",ExpressionUUID->"fc395e28-3617-4570-aaca-9dab7a78b907",
 CellID->1273372515],
Cell[116369, 3108, 2556, 61, 70, "Output",ExpressionUUID->"c7de34ca-c998-44c1-8d3b-036e7b300717",
 CellID->1897317250]
}, Open  ]],
Cell[CellGroupData[{
Cell[118962, 3174, 201, 4, 70, "Input",ExpressionUUID->"a5c62cfd-83c5-4448-a6cd-e79a7df3fb06",
 CellID->1606586072],
Cell[119166, 3180, 131, 2, 70, "Output",ExpressionUUID->"16724a0f-d201-4865-b7fe-1ddd30a5a541",
 CellID->226346447]
}, Open  ]],
Cell[119312, 3185, 412, 6, 70, "TechNoteText",ExpressionUUID->"3aeb97d8-c6ee-4847-8666-184a6f44eb44",
 CellID->799932562]
}, Open  ]],
Cell[CellGroupData[{
Cell[119761, 3196, 136, 2, 70, "TechNoteSection",ExpressionUUID->"f2662b15-9f86-4e39-b643-ce888942a406",
 CellTags->"Section13",
 CellID->1218939314],
Cell[119900, 3200, 180, 3, 70, "Input",ExpressionUUID->"c404b418-b44b-4e9a-b4a9-63bc986cbe27",
 CellID->1843914595],
Cell[120083, 3205, 183, 4, 70, "Input",ExpressionUUID->"80c74cc8-777b-4c52-9045-7bd41b690042",
 CellID->336088308],
Cell[120269, 3211, 574, 14, 70, "TechNoteText",ExpressionUUID->"9187829a-3718-4002-85ae-d2cf65439e83",
 CellID->1866541665],
Cell[120846, 3227, 625, 22, 70, "TechNoteText",ExpressionUUID->"578760b0-6f66-4703-a17a-615b1f5c03ef",
 CellID->524648279],
Cell[121474, 3251, 505, 12, 70, "TechNoteText",ExpressionUUID->"e1a955ff-10c9-4f87-9b49-ed2d658f4750",
 CellID->195770571],
Cell[CellGroupData[{
Cell[122004, 3267, 686, 20, 70, "Input",ExpressionUUID->"d159e4bf-65a0-4f7e-9b9e-fe6d6b26dc0c",
 CellID->371039593],
Cell[122693, 3289, 7611, 176, 70, "Output",ExpressionUUID->"aef58851-ec9a-4987-88db-f44f42231320",
 CellID->1011195892]
}, Open  ]],
Cell[130319, 3468, 642, 21, 70, "TechNoteText",ExpressionUUID->"b4879f5a-69cf-40d1-bbd0-433d483763d0",
 CellID->809087288],
Cell[CellGroupData[{
Cell[130986, 3493, 193, 4, 70, "Input",ExpressionUUID->"5d124695-7db0-4395-9ac5-93983e872b02",
 CellID->463596612],
Cell[131182, 3499, 806, 23, 70, "Output",ExpressionUUID->"5ee1737d-38e7-4a71-b35e-0bd0bf40be87",
 CellID->2131258133]
}, Open  ]],
Cell[132003, 3525, 143, 1, 70, "TechNoteText",ExpressionUUID->"bdb870de-7431-4284-a7a6-85a0a1d1577f",
 CellID->2003915004],
Cell[CellGroupData[{
Cell[132171, 3530, 192, 4, 70, "Input",ExpressionUUID->"b980104c-2e73-4e80-bc56-0fe42fd8d0ab",
 CellID->813436327],
Cell[132366, 3536, 839, 19, 70, "Output",ExpressionUUID->"d6522264-3156-4c80-9e94-9b1dbd785ba4",
 CellID->28209371]
}, Open  ]],
Cell[133220, 3558, 382, 8, 70, "TechNoteText",ExpressionUUID->"70435642-b7f7-4a4c-92ce-d298002eb893",
 CellID->534468518],
Cell[CellGroupData[{
Cell[133627, 3570, 311, 9, 70, "Input",ExpressionUUID->"3082a6de-1b24-44e3-82ab-b7464d648995",
 CellID->2035770272],
Cell[133941, 3581, 806, 23, 70, "Output",ExpressionUUID->"b775c061-3041-46ac-9333-1d2a1a140cc5",
 CellID->1668496057]
}, Open  ]],
Cell[134762, 3607, 757, 15, 70, "TechNoteText",ExpressionUUID->"99971c80-2296-45b0-b89b-99c2b306aee3",
 CellID->1603079182],
Cell[CellGroupData[{
Cell[135544, 3626, 811, 23, 70, "Input",ExpressionUUID->"10b93dab-9d21-4ede-8b12-be500fe7aefa",
 CellID->621976612],
Cell[136358, 3651, 840, 19, 70, "Output",ExpressionUUID->"a7ce4fda-9244-47f9-bc77-d10b1b1501dc",
 CellID->571767473],
Cell[137201, 3672, 1532, 29, 70, "Output",ExpressionUUID->"a3d03b7d-0d38-4210-b881-dd7988959dec",
 CellID->1854082033]
}, Open  ]],
Cell[CellGroupData[{
Cell[138770, 3706, 188, 4, 70, "Input",ExpressionUUID->"ffb66605-bd3e-4b46-85c9-e1285c382683",
 CellID->661500490],
Cell[138961, 3712, 132, 2, 70, "Output",ExpressionUUID->"1cb786be-729f-404d-afdb-c03fdee57084",
 CellID->1569010661]
}, Open  ]],
Cell[139108, 3717, 1223, 29, 70, "TechNoteText",ExpressionUUID->"3001a539-c9ee-4be7-8832-4376e3eea3c7",
 CellID->666193793],
Cell[140334, 3748, 467, 13, 70, "TechNoteText",ExpressionUUID->"502550c5-81cd-4851-8754-743e331dcc53",
 CellID->1938247085],
Cell[CellGroupData[{
Cell[140826, 3765, 525, 14, 70, "Input",ExpressionUUID->"c4917538-1e9b-487b-a1ee-2580d1856191",
 CellID->1040933486],
Cell[141354, 3781, 1033, 31, 70, "Output",ExpressionUUID->"f749889d-9807-452e-96c7-077c9f9aa2a3",
 CellID->1410477914]
}, Open  ]],
Cell[142402, 3815, 327, 8, 70, "TechNoteText",ExpressionUUID->"2dacfd62-b8d8-477b-baa9-661dd0707f6d",
 CellID->771058470],
Cell[CellGroupData[{
Cell[142754, 3827, 472, 13, 70, "Input",ExpressionUUID->"4bdfb9ec-f47a-46a1-b233-a2960358d7c8",
 CellID->1895203240],
Cell[143229, 3842, 3377, 83, 70, "Output",ExpressionUUID->"4e37c223-f0f8-4b58-904a-dec1ad714b5e",
 CellID->1977805012]
}, Open  ]],
Cell[146621, 3928, 849, 23, 70, "TechNoteText",ExpressionUUID->"89efed25-aa02-4d73-8076-bd6e0e5adaba",
 CellID->27233292],
Cell[CellGroupData[{
Cell[147495, 3955, 511, 14, 70, "Input",ExpressionUUID->"78d7047b-a09e-4476-99eb-49f39538427f",
 CellID->1505230369],
Cell[148009, 3971, 3774, 94, 70, "Output",ExpressionUUID->"66aafe18-2791-4cf6-a2da-7d0fd4151082",
 CellID->69464771]
}, Open  ]],
Cell[151798, 4068, 225, 4, 70, "TechNoteText",ExpressionUUID->"0c0b3cd4-0772-484d-95bb-692703f51798",
 CellID->535686806],
Cell[CellGroupData[{
Cell[152048, 4076, 193, 4, 70, "Input",ExpressionUUID->"cf896aef-fa8c-4c6e-8f4d-dd7caf618fc0",
 CellID->851721286],
Cell[152244, 4082, 829, 24, 70, "Output",ExpressionUUID->"a0552d96-0a37-4629-9b60-c5a6c2ec7579",
 CellID->1410785876]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[153122, 4112, 151, 2, 70, "TechNoteSection",ExpressionUUID->"855d9a1c-73ec-46d1-b3b7-48c2039a9bec",
 CellTags->"Section14",
 CellID->1455445268],
Cell[CellGroupData[{
Cell[153298, 4118, 132, 2, 70, "Subsection",ExpressionUUID->"c24f344f-bb76-4122-b226-ee4db4ca152e",
 CellTags->"Section15",
 CellID->1829879946],
Cell[153433, 4122, 572, 13, 70, "TechNoteText",ExpressionUUID->"7192843b-6194-4d90-b182-78697bac4535",
 CellID->678943735],
Cell[154008, 4137, 634, 23, 70, "TechNoteText",ExpressionUUID->"50533c8d-f64a-4d98-a15d-dc815117b2e3",
 CellID->1426737634],
Cell[154645, 4162, 115, 1, 70, "TechNoteText",ExpressionUUID->"c73eeefe-447b-4a23-b9bc-2a9e4f895ad3",
 CellID->377012236],
Cell[154763, 4165, 584, 22, 70, "TechNoteText",ExpressionUUID->"7061d130-2459-4d92-9662-58a1088c46c1",
 CellID->1367891802],
Cell[155350, 4189, 400, 8, 70, "TechNoteText",ExpressionUUID->"b63e26c8-ddb1-42e7-8fb2-e0b2f6816819",
 CellID->1345075079],
Cell[155753, 4199, 212, 4, 70, "TechNoteText",ExpressionUUID->"5f61fe94-3860-4359-98f4-475c09a17230",
 CellID->819163313],
Cell[155968, 4205, 569, 19, 70, "TechNoteText",ExpressionUUID->"0a583872-875d-4b2d-8263-c40f8fcc8b2d",
 CellID->116500784],
Cell[156540, 4226, 446, 13, 70, "TechNoteText",ExpressionUUID->"5f964ec9-f328-431f-aa37-19abd8eef982",
 CellID->1671074271],
Cell[156989, 4241, 174, 3, 70, "TechNoteText",ExpressionUUID->"dd2f74e1-a2b3-45f6-8849-50805601c3ba",
 CellID->1953344721],
Cell[157166, 4246, 781, 19, 70, "Picture",ExpressionUUID->"806a1b87-5e95-4e7d-ae39-1bd5768a7124",
 CellID->954137231],
Cell[157950, 4267, 287, 5, 70, "TechNoteText",ExpressionUUID->"f2472d1e-696e-496d-a18c-e8dee37c9d81",
 CellID->924049268],
Cell[158240, 4274, 179, 3, 70, "Input",ExpressionUUID->"41a0e7d6-5e6f-4bf9-b972-12198c464b55",
 CellID->214055128],
Cell[158422, 4279, 183, 4, 70, "Input",ExpressionUUID->"8ca197dd-abd1-4d87-8dff-44c5f4bed890",
 CellID->167122186],
Cell[158608, 4285, 282, 5, 70, "TechNoteMathCaption",ExpressionUUID->"d712ebb6-2db2-415b-9c10-08b497a8ce94",
 CellID->2041795819],
Cell[CellGroupData[{
Cell[158915, 4294, 603, 16, 70, "Input",ExpressionUUID->"8c0e436b-ad01-41fc-998a-122305e7c0b2",
 CellID->1821134520],
Cell[159521, 4312, 1154, 33, 70, "Output",ExpressionUUID->"71fcf94d-dab0-4f61-ae26-cf9d57319a1a",
 CellID->711271405]
}, Open  ]],
Cell[160690, 4348, 179, 3, 70, "TechNoteMathCaption",ExpressionUUID->"997caa12-2155-4df4-94cc-71be13e3fee9",
 CellID->1443037598],
Cell[CellGroupData[{
Cell[160894, 4355, 290, 7, 70, "Input",ExpressionUUID->"50801df1-91d0-4cfb-816f-ae90114b41af",
 CellID->1600084015],
Cell[161187, 4364, 1089, 25, 70, "Output",ExpressionUUID->"2c110a8f-be0e-4b28-afd7-ef94d0cd3c0d",
 CellID->1444524633]
}, Open  ]],
Cell[162291, 4392, 206, 4, 70, "TechNoteMathCaption",ExpressionUUID->"a896f672-68eb-4d54-a1a5-a14de3f5845b",
 CellID->378680471],
Cell[CellGroupData[{
Cell[162522, 4400, 164, 3, 70, "Input",ExpressionUUID->"431d3f2b-93f0-401f-824a-5fb0b3ee0133",
 CellID->1488630036],
Cell[162689, 4405, 1882, 49, 70, "Output",ExpressionUUID->"a57baec4-595e-4e83-baae-79dd2a2538a5",
 CellID->822877496]
}, Open  ]],
Cell[164586, 4457, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"56ea20bf-5f72-4577-a3f9-5b78cff4371b",
 CellID->641929970],
Cell[CellGroupData[{
Cell[164788, 4464, 499, 14, 70, "Input",ExpressionUUID->"78ace93e-d180-455b-b0b0-1c989f51ddf8",
 CellID->2106646909],
Cell[165290, 4480, 9996, 232, 70, "Output",ExpressionUUID->"875d57d2-934f-4fda-963a-7b321458d3d6",
 CellID->307388592]
}, Open  ]],
Cell[175301, 4715, 217, 4, 70, "TechNoteMathCaption",ExpressionUUID->"3b90748e-e0a1-4c10-8359-85dac3bb4709",
 CellID->1736236263],
Cell[CellGroupData[{
Cell[175543, 4723, 490, 15, 70, "Input",ExpressionUUID->"8b5b68f0-0a8c-42e4-ac08-1eb3db430669",
 CellID->915076805],
Cell[176036, 4740, 1683, 41, 70, "Output",ExpressionUUID->"def8a750-30ef-4b94-a254-395025746f30",
 CellID->1581894709]
}, Open  ]],
Cell[CellGroupData[{
Cell[177756, 4786, 178, 4, 70, "Input",ExpressionUUID->"a96b45f2-938e-4bab-a523-1bde4a4e08ac",
 CellID->1955961279],
Cell[177937, 4792, 2661, 66, 70, "Output",ExpressionUUID->"e761ba8b-6578-4e95-87a5-1d6c7e7ac65f",
 CellID->1056824303]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[180647, 4864, 138, 2, 70, "Subsection",ExpressionUUID->"c6e75770-6043-490f-a91c-bfdeacb71686",
 CellTags->"Section16",
 CellID->715838931],
Cell[180788, 4868, 709, 12, 70, "TechNoteText",ExpressionUUID->"5a788fb0-2fee-406a-beb0-b296e0a7b266",
 CellID->901522823],
Cell[181500, 4882, 1046, 32, 70, "TechNoteText",ExpressionUUID->"8c950313-7fb6-48b7-8045-883e0a7726d4",
 CellID->1396956576],
Cell[182549, 4916, 1478, 53, 70, "TechNoteText",ExpressionUUID->"04ba55bf-2583-4387-8b48-ebcdb9d6442c",
 CellID->210460181],
Cell[184030, 4971, 431, 8, 70, "TechNoteText",ExpressionUUID->"62affa69-952a-4562-bb73-268cf3c47b08",
 CellID->298695458],
Cell[184464, 4981, 528, 13, 70, "TechNoteMathCaption",ExpressionUUID->"1cd31bff-0ca0-469d-9b1f-6c8f3c7a2b0f",
 CellID->1505279567],
Cell[CellGroupData[{
Cell[185017, 4998, 362, 9, 70, "Input",ExpressionUUID->"a6792a75-2db4-4415-afc1-7cd1239812ca",
 CellID->1876320909],
Cell[185382, 5009, 695, 22, 70, "Output",ExpressionUUID->"ae27fa30-1ba8-4077-8722-0bcf26a6eb38",
 CellID->208816184],
Cell[186080, 5033, 800, 23, 70, "Output",ExpressionUUID->"eea28e46-7d6e-4467-88d8-3508bf2bd583",
 CellID->585325290]
}, Open  ]],
Cell[186895, 5059, 167, 2, 70, "TechNoteMathCaption",ExpressionUUID->"a3e36419-cb2c-49f9-9b2f-393fe81980c9",
 CellID->774865820],
Cell[CellGroupData[{
Cell[187087, 5065, 338, 8, 70, "Input",ExpressionUUID->"2ccc41f3-faea-4485-ab61-812568260f5f",
 CellID->2117896949],
Cell[187428, 5075, 1097, 27, 70, "Output",ExpressionUUID->"b081a6eb-3b83-4fe9-9fec-652057024dbd",
 CellID->2087045770]
}, Open  ]],
Cell[188540, 5105, 323, 5, 70, "TechNoteMathCaption",ExpressionUUID->"2d8245d1-cc9a-4957-9eaf-624cd4ef29c4",
 CellID->193224567],
Cell[CellGroupData[{
Cell[188888, 5114, 539, 15, 70, "Input",ExpressionUUID->"8b7dce94-eb45-412e-a82b-0e1c6b057406",
 CellID->1062235589],
Cell[189430, 5131, 2131, 52, 70, "Output",ExpressionUUID->"c5d6b1a0-95fd-4f78-9447-45091beabd8d",
 CellID->2127849939]
}, Open  ]],
Cell[191576, 5186, 278, 5, 70, "TechNoteMathCaption",ExpressionUUID->"a8ce1562-b0c2-4c0c-b076-875cec92febb",
 CellID->581406343],
Cell[CellGroupData[{
Cell[191879, 5195, 271, 6, 70, "Input",ExpressionUUID->"95a67ac8-3229-49a4-b90f-9070934ee4f0",
 CellID->1127477995],
Cell[192153, 5203, 2188, 54, 70, "Output",ExpressionUUID->"40d6c845-a210-4e16-b6a2-9649f2933691",
 CellID->728751282]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[194390, 5263, 150, 2, 70, "Subsection",ExpressionUUID->"b347b255-1de6-4725-a2c3-a15a494551eb",
 CellTags->"Section17",
 CellID->616090041],
Cell[194543, 5267, 273, 5, 70, "TechNoteText",ExpressionUUID->"1382b792-a31d-479a-bed6-1c04248e3ba5",
 CellID->1275497408],
Cell[194819, 5274, 7318, 182, 70, "Picture",ExpressionUUID->"81645160-a80c-44ac-a289-24097d475b00",
 CellID->2084184000],
Cell[202140, 5458, 342, 9, 70, "TechNoteCaption",ExpressionUUID->"4ca829b6-1ac3-409c-a500-0b7edeb23c97",
 CellID->1283463500],
Cell[202485, 5469, 668, 16, 70, "TechNoteText",ExpressionUUID->"cac313b9-1ac8-42f0-911f-9d0994c75b41",
 CellID->1036421782],
Cell[203156, 5487, 864, 29, 70, "TechNoteText",ExpressionUUID->"e40dbc71-b877-4656-8505-437e4abaa560",
 CellID->1390517433],
Cell[204023, 5518, 1382, 36, 70, "TechNoteText",ExpressionUUID->"07c72a78-9ac9-499e-9d12-dc4c233e148a",
 CellID->357932788],
Cell[205408, 5556, 1870, 62, 70, "TechNoteText",ExpressionUUID->"25a7a02f-a839-43cb-a4e4-01f3fe6c2639",
 CellID->232871499],
Cell[207281, 5620, 349, 7, 70, "TechNoteText",ExpressionUUID->"0a3ae1d9-fb18-43c9-9c05-87b01e8d5274",
 CellID->531662691],
Cell[207633, 5629, 460, 14, 70, "TechNoteText",ExpressionUUID->"e4ae4e93-e659-4fe4-89ed-2518887ee33d",
 CellID->1514408200],
Cell[208096, 5645, 799, 27, 70, "TechNoteText",ExpressionUUID->"1413859f-390e-42fb-bc75-ea25acfadaee",
 CellID->2034215257],
Cell[208898, 5674, 224, 4, 70, "TechNoteText",ExpressionUUID->"0428de57-4ef5-4a76-a3e7-9fcb5ec40469",
 CellID->1368761109],
Cell[209125, 5680, 5599, 145, 70, "Picture",ExpressionUUID->"4de32f7e-5f61-49fb-bb84-d5a1f024c2bf",
 CellID->757238962],
Cell[214727, 5827, 369, 10, 70, "TechNoteCaption",ExpressionUUID->"964389f2-7ee8-4ec8-a120-598c2abe9d63",
 CellID->927142212],
Cell[CellGroupData[{
Cell[215121, 5841, 357, 7, 70, "TechNoteText",ExpressionUUID->"49c22d66-58ac-4cc1-bdc5-dfdd5d14a7e7",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->305516076],
Cell[215481, 5850, 194, 4, 70, "Input",ExpressionUUID->"f82d7927-1031-46c2-b59a-4255fdddd6bb",
 CellID->1535052485],
Cell[215678, 5856, 285, 7, 70, "TechNoteMathCaption",ExpressionUUID->"2de1ce76-9e27-4e63-9612-d55f2e1822b0",
 CellID->1475887768],
Cell[CellGroupData[{
Cell[215988, 5867, 378, 10, 70, "Input",ExpressionUUID->"6b5e0832-8891-4e7d-80a5-644d629247b1",
 CellID->1092408791],
Cell[216369, 5879, 631, 19, 70, "Output",ExpressionUUID->"66d571dd-df5e-44f2-b7d8-b7cf32bd71c1",
 CellID->1023557733]
}, Open  ]],
Cell[217015, 5901, 179, 3, 70, "TechNoteMathCaption",ExpressionUUID->"3a14d37a-71ba-4de0-8fb3-eafcd7ed9fbb",
 CellID->1519843333],
Cell[CellGroupData[{
Cell[217219, 5908, 331, 8, 70, "Input",ExpressionUUID->"98c6e220-04c2-43d7-b99d-66a4e49b7956",
 CellID->21384525],
Cell[217553, 5918, 666, 23, 70, "Output",ExpressionUUID->"947f7caf-0e2e-4b96-b0af-2dde158a3471",
 CellID->1590806061]
}, Open  ]],
Cell[218234, 5944, 202, 5, 70, "TechNoteMathCaption",ExpressionUUID->"2dbb5c23-4211-4310-9890-0df3769e8183",
 CellID->978050365],
Cell[CellGroupData[{
Cell[218461, 5953, 221, 5, 70, "Input",ExpressionUUID->"99e4abc9-aba2-4564-b59f-1274833eb67f",
 CellID->2127797723],
Cell[218685, 5960, 1307, 42, 70, "Output",ExpressionUUID->"7e4d890e-d549-4adc-b4b4-47a25ab6f827",
 CellID->506062077]
}, Open  ]],
Cell[220007, 6005, 203, 4, 70, "TechNoteMathCaption",ExpressionUUID->"d9850ee9-4384-47c5-a1e4-480f42dbfb2c",
 CellID->1664622810],
Cell[CellGroupData[{
Cell[220235, 6013, 708, 18, 70, "Input",ExpressionUUID->"41f8bd21-00c1-4e41-a814-7cdc5098477b",
 CellID->2027335310],
Cell[220946, 6033, 2149, 54, 70, "Output",ExpressionUUID->"7f7aacd4-4553-4d2a-ba64-c492dff4c42b",
 CellID->1350086019]
}, Open  ]],
Cell[223110, 6090, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"396bc7d3-9a7b-4376-8f9e-2b89fe69e685",
 CellID->1320057003],
Cell[CellGroupData[{
Cell[223284, 6095, 183, 4, 70, "Input",ExpressionUUID->"b860a1e2-6eb3-494b-896c-37fabe79f75b",
 CellID->856233533],
Cell[223470, 6101, 9049, 212, 70, "Output",ExpressionUUID->"dcbed030-68f5-4710-9527-aabdc018d965",
 CellID->583507131]
}, Open  ]],
Cell[232534, 6316, 149, 1, 70, "TechNoteMathCaption",ExpressionUUID->"73ab1d95-a563-4dca-8d87-17adaef7d704",
 CellID->1095734201],
Cell[CellGroupData[{
Cell[232708, 6321, 178, 4, 70, "Input",ExpressionUUID->"8cd4f483-5214-4b8a-96e0-ed549e592d85",
 CellID->1234389837],
Cell[232889, 6327, 23041, 529, 70, "Output",ExpressionUUID->"c7309bf6-a280-497a-bf40-1881a77b37f6",
 CellID->1594018515]
}, Open  ]],
Cell[CellGroupData[{
Cell[255967, 6861, 260, 7, 70, "Input",ExpressionUUID->"1e278ea8-d0b9-4f23-b1ba-abbe95ac065a",
 CellID->273770455],
Cell[256230, 6870, 33747, 756, 70, "Output",ExpressionUUID->"e933660f-ece3-47e8-ba6c-1376edce7dbb",
 CellID->810685280]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[290026, 7632, 358, 7, 70, "TechNoteText",ExpressionUUID->"78db1dee-be9e-4731-8534-efcdba0c7de7",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->1362282140],
Cell[290387, 7641, 202, 4, 70, "TechNoteMathCaption",ExpressionUUID->"35ac246b-cba0-4d1e-9014-cbd65c048bd4",
 CellID->523520144],
Cell[CellGroupData[{
Cell[290614, 7649, 792, 20, 70, "Input",ExpressionUUID->"b1b5d5e1-b435-4235-a070-6b59b5ac8762",
 CellID->770533652],
Cell[291409, 7671, 4141, 102, 70, "Output",ExpressionUUID->"50e01534-063b-43df-a7b4-bfb6f273ec28",
 CellID->1551244392]
}, Open  ]],
Cell[295565, 7776, 133, 1, 70, "TechNoteMathCaption",ExpressionUUID->"03678f0c-6872-423a-8374-2509a795d126",
 CellID->363088131],
Cell[CellGroupData[{
Cell[295723, 7781, 189, 4, 70, "Input",ExpressionUUID->"bb94ac2e-b494-497e-9dc4-8aa8bca378fa",
 CellID->1079016412],
Cell[295915, 7787, 12245, 296, 70, "Output",ExpressionUUID->"558ef95f-0c72-4dfd-a8ec-e987a5a80233",
 CellID->1313021764]
}, Open  ]],
Cell[308175, 8086, 148, 1, 70, "TechNoteMathCaption",ExpressionUUID->"f93179b4-bc1b-4d78-9302-622f7a86ce35",
 CellID->942690207],
Cell[CellGroupData[{
Cell[308348, 8091, 187, 4, 70, "Input",ExpressionUUID->"650f74c1-ca49-439f-bd29-e97bbe93480d",
 CellID->473086067],
Cell[308538, 8097, 4911, 117, 70, "Output",ExpressionUUID->"1ffac07e-346e-4fb7-a77d-4a50804a556d",
 CellID->414830976]
}, Open  ]],
Cell[313464, 8217, 186, 3, 70, "TechNoteMathCaption",ExpressionUUID->"a45f030d-fc10-4784-992e-0b2d6f1e56e8",
 CellID->1762048567],
Cell[CellGroupData[{
Cell[313675, 8224, 186, 4, 70, "Input",ExpressionUUID->"06aa6155-e95d-46f7-bdc9-3ef9cac21450",
 CellID->1674087129],
Cell[313864, 8230, 10490, 256, 70, "Output",ExpressionUUID->"64706d6a-e9eb-4317-89a6-6eab2b706805",
 CellID->1332295470]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[324403, 8492, 358, 7, 70, "TechNoteText",ExpressionUUID->"381c72f7-2b4a-4717-b87d-07ea7f5e8c30",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->1016485255],
Cell[324764, 8501, 177, 3, 70, "TechNoteMathCaption",ExpressionUUID->"26800d3e-d8db-4b64-afd9-7071e564bb93",
 CellID->1235189013],
Cell[CellGroupData[{
Cell[324966, 8508, 347, 9, 70, "Input",ExpressionUUID->"354ccb8d-084a-455b-a289-8c9c16254c93",
 CellID->1297582908],
Cell[325316, 8519, 1777, 44, 70, "Output",ExpressionUUID->"11750bf0-5b72-4ecd-8945-0406abcaf2a5",
 CellID->77977021]
}, Open  ]],
Cell[327108, 8566, 223, 4, 70, "TechNoteMathCaption",ExpressionUUID->"5b58eee5-6911-4ead-be99-0513446b5fff",
 CellID->331049159],
Cell[CellGroupData[{
Cell[327356, 8574, 186, 4, 70, "Input",ExpressionUUID->"9b573f5e-97c0-4126-9af2-61b7292d1b54",
 CellID->1888208538],
Cell[327545, 8580, 3570, 82, 70, "Output",ExpressionUUID->"617fd5a0-73b9-420e-9cfa-6a25da68be56",
 CellID->594767277]
}, Open  ]],
Cell[CellGroupData[{
Cell[331152, 8667, 254, 6, 70, "Input",ExpressionUUID->"84fed716-cece-4fba-b57b-50d4827c85de",
 CellID->1871953819],
Cell[331409, 8675, 2334, 53, 70, "Output",ExpressionUUID->"4d0fcb3d-7303-4e12-9f24-40616ca4f702",
 CellID->1864731401]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[333804, 8735, 156, 2, 70, "Subsection",ExpressionUUID->"4827f088-cd4f-4c7a-821e-f9fbb525c1ae",
 CellTags->"Section17",
 CellID->1379525988],
Cell[333963, 8739, 849, 21, 70, "TechNoteText",ExpressionUUID->"d6cd5522-f530-4159-b589-9c6dff23a6bc",
 CellID->1459827304],
Cell[334815, 8762, 751, 25, 70, "TechNoteText",ExpressionUUID->"f1ba2f7c-7213-48f3-bf5a-35750896837b",
 CellID->316831353],
Cell[335569, 8789, 1528, 37, 70, "TechNoteText",ExpressionUUID->"d01e49f9-1528-4b0d-ae61-3cabc28c7da2",
 CellID->1372588958],
Cell[337100, 8828, 5917, 116, 70, "Picture",ExpressionUUID->"8cc59939-a44c-40c3-ba87-900fe43740bb",
 CellID->833281032],
Cell[343020, 8946, 468, 8, 70, "TechNoteCaption",ExpressionUUID->"d5b13171-fde1-478e-b6b5-4cd00413054a",
 CellID->571282978],
Cell[343491, 8956, 195, 4, 70, "TechNoteText",ExpressionUUID->"76b28a95-27e7-46a5-afb0-f51de46f61e0",
 CellID->1213442737],
Cell[CellGroupData[{
Cell[343711, 8964, 357, 7, 70, "TechNoteText",ExpressionUUID->"e05b40b1-c225-4eb2-a2a4-562f0c01b507",
 CellGroupingRules->{"SectionGrouping", 70},
 CellID->780471724],
Cell[344071, 8973, 259, 4, 70, "TechNoteMathCaption",ExpressionUUID->"add8f0df-d114-4c59-a0a5-a15d6332376e",
 CellID->1827368847],
Cell[CellGroupData[{
Cell[344355, 8981, 1338, 38, 70, "Input",ExpressionUUID->"bf45bda2-84a6-4495-a0ea-8eb7b3eea380",
 CellID->1424575782],
Cell[345696, 9021, 2594, 49, 70, "Output",ExpressionUUID->"3dad95e0-9fc9-4d1d-8a6b-7da50e69805e",
 CellID->164312289]
}, Open  ]],
Cell[348305, 9073, 204, 4, 70, "TechNoteMathCaption",ExpressionUUID->"c4056e44-b755-4443-9acc-34a1096a7c84",
 CellID->873169809],
Cell[CellGroupData[{
Cell[348534, 9081, 422, 11, 70, "Input",ExpressionUUID->"e34b0148-6143-46ac-998c-fe090102418e",
 CellID->1609219912],
Cell[348959, 9094, 29335, 644, 70, "Output",ExpressionUUID->"0144bf1e-abf3-4bec-9b00-3e864e6c685e",
 CellID->2080154828]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[378355, 9745, 157, 2, 70, "Subsection",ExpressionUUID->"bbef1a7e-5d6e-4b49-ab22-9b109853447d",
 CellTags->"Section18",
 CellID->1847739219],
Cell[378515, 9749, 645, 10, 70, "TechNoteText",ExpressionUUID->"8defbe4f-f80d-42e4-90b4-340330ce8cdf",
 CellID->192034466],
Cell[379163, 9761, 733, 19, 70, "TechNoteText",ExpressionUUID->"b30c27d9-361f-4948-ae02-ed6d30bd6751",
 CellID->2002832268],
Cell[379899, 9782, 567, 17, 70, "TechNoteText",ExpressionUUID->"29fea7c0-3854-4f18-adc0-4d1cc3471b6b",
 CellID->1943245198],
Cell[380469, 9801, 521, 15, 70, "TechNoteText",ExpressionUUID->"0e6254e4-42c4-4b81-a0ae-aa88726d0450",
 CellID->1190739210],
Cell[380993, 9818, 587, 18, 70, "TechNoteText",ExpressionUUID->"192836b0-8e60-4caf-801a-8e6e6b23dbe3",
 CellID->353796077],
Cell[381583, 9838, 176, 3, 70, "TechNoteText",ExpressionUUID->"912f0ddd-216e-45a7-8778-433c0b4a5c1d",
 CellID->2015931243],
Cell[381762, 9843, 429, 14, 70, "TechNoteText",ExpressionUUID->"d8961ef8-0286-42c0-a02a-7e154ba96349",
 CellID->906902382],
Cell[382194, 9859, 576, 20, 70, "TechNoteText",ExpressionUUID->"9c7354ad-c92d-4144-953d-9dd229ed7d9e",
 CellID->1616891515],
Cell[382773, 9881, 430, 14, 70, "TechNoteText",ExpressionUUID->"456356a1-a5fc-41e8-8b35-bcfacf168dc0",
 CellID->837623467],
Cell[383206, 9897, 669, 18, 70, "TechNoteText",ExpressionUUID->"2c715fb6-5735-41ab-97f3-1e93b5a95585",
 CellID->1182303784],
Cell[383878, 9917, 2830, 63, 70, "TechNoteText",ExpressionUUID->"42175e9a-d41a-4182-aa74-cb32fc0ac028",
 CellID->313511997],
Cell[386711, 9982, 1491, 40, 70, "TechNoteText",ExpressionUUID->"8c4e1b22-9fda-4186-8cc9-48ad6db14206",
 CellID->1418747488],
Cell[388205, 10024, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"54d3469f-4dd0-491d-b15d-d41655405e8d",
 CellID->1378098175],
Cell[CellGroupData[{
Cell[388440, 10032, 464, 13, 70, "Input",ExpressionUUID->"d4902394-63f7-4446-9998-34c7a1e8b9f2",
 CellID->1028095504],
Cell[388907, 10047, 1114, 36, 70, "Output",ExpressionUUID->"b6e398fc-970b-4828-80b9-03460833bd2a",
 CellID->128421036]
}, Open  ]],
Cell[390036, 10086, 168, 2, 70, "TechNoteMathCaption",ExpressionUUID->"bd0335ce-da9c-45d4-bf1a-c11b60e18bd6",
 CellID->1646790355],
Cell[CellGroupData[{
Cell[390229, 10092, 527, 14, 70, "Input",ExpressionUUID->"eab13205-8709-48c6-9d3c-5930a55353df",
 CellID->1153761970],
Cell[390759, 10108, 1175, 28, 70, "Output",ExpressionUUID->"d9776173-6fda-4ac5-8297-3ea789d197ae",
 CellID->151286817]
}, Open  ]],
Cell[391949, 10139, 198, 4, 70, "TechNoteMathCaption",ExpressionUUID->"f31cd194-d6f9-4c3e-921e-88282dfa16c5",
 CellID->1240176371],
Cell[CellGroupData[{
Cell[392172, 10147, 541, 15, 70, "Input",ExpressionUUID->"d78d0c56-37f2-4945-8e88-876c2e6682cf",
 CellID->167989615],
Cell[392716, 10164, 280, 8, 70, "Output",ExpressionUUID->"f4e290af-b12a-478e-a8e6-9297c8f42a86",
 CellID->56895271]
}, Open  ]],
Cell[393011, 10175, 162, 2, 70, "TechNoteMathCaption",ExpressionUUID->"4033d34d-8c24-430e-858a-90dbd8bdf8e4",
 CellID->833485781],
Cell[393176, 10179, 1471, 43, 70, "Input",ExpressionUUID->"b8f11594-02c1-41e4-91b7-404504f3f129",
 CellID->359691886],
Cell[394650, 10224, 164, 2, 70, "TechNoteMathCaption",ExpressionUUID->"2057ded5-06eb-4421-8a2b-6fd83726b179",
 CellID->175061697],
Cell[CellGroupData[{
Cell[394839, 10230, 514, 14, 70, "Input",ExpressionUUID->"83131d44-7501-4d27-b28f-4e788b5a184a",
 CellID->209345089],
Cell[395356, 10246, 3312, 72, 70, "Output",ExpressionUUID->"a059706b-78b4-4b3e-b2e4-d75eb5f7cc06",
 CellID->608596782]
}, Open  ]],
Cell[398683, 10321, 124, 1, 70, "TechNoteMathCaption",ExpressionUUID->"203cec84-20f0-4775-af7a-dd368e5c6ca8",
 CellID->2073812678],
Cell[CellGroupData[{
Cell[398832, 10326, 217, 5, 70, "Input",ExpressionUUID->"8dfdd40d-7cf7-42ee-a5a4-fa555e41f25f",
 CellID->1395051790],
Cell[399052, 10333, 128, 2, 70, "Output",ExpressionUUID->"53948569-a235-4790-a963-0a1c4ceba369",
 CellID->221504413]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[399241, 10342, 148, 2, 70, "TechNoteSection",ExpressionUUID->"b1940ebc-2ea0-46a2-a0d4-82b4494f8792",
 CellTags->"Section19",
 CellID->1476129218],
Cell[399392, 10346, 582, 11, 70, "TechNoteText",ExpressionUUID->"8ecdb45c-941d-4d28-9dc1-e627b69bccd6",
 CellID->1572676782],
Cell[CellGroupData[{
Cell[399999, 10361, 149, 2, 70, "Subsection",ExpressionUUID->"6200b313-4a25-4f21-90b7-acf702fe167a",
 CellTags->"Section20",
 CellID->749947798],
Cell[400151, 10365, 337, 7, 70, "TechNoteText",ExpressionUUID->"bdcc100f-deb6-425b-9782-bde5b9639ab6",
 CellID->791116743],
Cell[400491, 10374, 875, 30, 70, "TechNoteText",ExpressionUUID->"7fabced5-9b2f-4652-896b-ca5f802d04a7",
 CellID->1227841024],
Cell[401369, 10406, 969, 18, 70, "TechNoteText",ExpressionUUID->"2fa7631e-568b-4012-b8b7-d31c917be3e9",
 CellID->1153726345],
Cell[402341, 10426, 172, 3, 70, "TechNoteText",ExpressionUUID->"24ef0a13-6300-4620-ab83-8a6095253fa4",
 CellID->1048831652],
Cell[402516, 10431, 896, 28, 70, "TechNoteText",ExpressionUUID->"e0b37456-5ee9-47f5-ba49-991e21ede70f",
 CellID->1167800588],
Cell[403415, 10461, 1548, 45, 70, "TechNoteText",ExpressionUUID->"b9b23467-be1b-4d9e-9518-4666e97398ad",
 CellID->1371432583],
Cell[404966, 10508, 1189, 38, 70, "TechNoteText",ExpressionUUID->"fd55c566-d5d8-4076-ba36-fd0c72d89c2e",
 CellID->725439230],
Cell[406158, 10548, 181, 3, 70, "TechNoteText",ExpressionUUID->"b2fa45df-a424-41d1-b2d9-08cec47cf29d",
 CellID->1192474591],
Cell[406342, 10553, 1000, 31, 70, "TechNoteText",ExpressionUUID->"6ee010df-ea7b-4a5a-a26c-47bcbe8f4d11",
 CellID->1603057133],
Cell[407345, 10586, 1046, 31, 70, "TechNoteText",ExpressionUUID->"70a7d455-ad9d-4352-90f2-21dfe3b7d561",
 CellID->251399069],
Cell[408394, 10619, 1184, 34, 70, "TechNoteText",ExpressionUUID->"c5a3ceb2-633f-4453-be32-fab28cb1d480",
 CellID->1163819034],
Cell[409581, 10655, 160, 2, 70, "TechNoteText",ExpressionUUID->"7d4ef1da-5f1e-4585-9a88-e495de35de99",
 CellID->1025447562],
Cell[409744, 10659, 958, 29, 70, "TechNoteText",ExpressionUUID->"2f678d90-8ce5-4043-8ca9-8dd5f2d5c74f",
 CellID->1140907359],
Cell[410705, 10690, 300, 8, 70, "TechNoteText",ExpressionUUID->"85689eda-cb00-486d-9f21-5f0c452fac64",
 CellID->348498650],
Cell[411008, 10700, 1147, 32, 70, "TechNoteText",ExpressionUUID->"4a6214ca-1a0b-486a-86fb-97213ef1f55c",
 CellID->1028905181],
Cell[412158, 10734, 821, 23, 70, "TechNoteText",ExpressionUUID->"edd83d6b-e299-4e04-b566-40297189934a",
 CellID->1271051423],
Cell[412982, 10759, 179, 3, 70, "TechNoteText",ExpressionUUID->"51b65adb-55df-4d59-8039-fd5c2bde3725",
 CellID->1541429652],
Cell[413164, 10764, 392, 12, 70, "TechNoteText",ExpressionUUID->"cec64346-7d4c-4247-870c-ca1e4939f494",
 CellID->1712927403],
Cell[413559, 10778, 337, 7, 70, "TechNoteText",ExpressionUUID->"484be3ba-1543-4f18-b00f-3e57f1b64920",
 CellID->5090539],
Cell[413899, 10787, 441, 12, 70, "TechNoteText",ExpressionUUID->"025fd1b5-d234-4465-9d64-13f1da1ef074",
 CellID->1804826740],
Cell[CellGroupData[{
Cell[414365, 10803, 521, 11, 70, "TechNoteText",ExpressionUUID->"a52f3b5d-9187-4ebb-bad2-a1cf6ade1091",
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {"ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 CellID->315955750],
Cell[414889, 10816, 179, 3, 70, "Input",ExpressionUUID->"bd741a9a-0f91-4969-91f8-5d1a3e357d89",
 CellID->384188579],
Cell[415071, 10821, 249, 4, 70, "TechNoteMathCaption",ExpressionUUID->"c9d54857-7c0b-4959-993c-d64f99c54eb7",
 CellID->516505305],
Cell[415323, 10827, 184, 4, 70, "Input",ExpressionUUID->"75067fbe-56c3-4963-a7b9-e3c2e612ee87",
 CellID->1721604371],
Cell[CellGroupData[{
Cell[415532, 10835, 650, 19, 70, "Input",ExpressionUUID->"3958f2c8-904d-4ba1-9114-e9c876e6b08e",
 CellID->775759961],
Cell[416185, 10856, 1826, 46, 70, "Output",ExpressionUUID->"c2f4398e-7956-4cbc-95c5-60d35b3098cb",
 CellID->1235509040],
Cell[418014, 10904, 1203, 31, 70, "Output",ExpressionUUID->"a58136e8-e11c-4136-9476-8e9da824255c",
 CellID->1181052437]
}, Open  ]],
Cell[419232, 10938, 185, 3, 70, "TechNoteMathCaption",ExpressionUUID->"42d3119d-e662-4e87-89bc-2c3830755c35",
 CellID->595736468],
Cell[CellGroupData[{
Cell[419442, 10945, 268, 7, 70, "Input",ExpressionUUID->"cea7db7b-f754-47d3-9e7b-2f4b6180cf11",
 CellID->974055362],
Cell[419713, 10954, 2437, 57, 70, "Output",ExpressionUUID->"38acbffc-20b6-4a54-b3d8-614803f571e8",
 CellID->756959438]
}, Open  ]],
Cell[422165, 11014, 214, 5, 70, "TechNoteMathCaption",ExpressionUUID->"bc6262c4-50d3-4965-9d14-3bc0994e6e2b",
 CellID->1817782849],
Cell[CellGroupData[{
Cell[422404, 11023, 301, 7, 70, "Input",ExpressionUUID->"510304c2-5379-402a-be19-dddefe529ddd",
 CellID->1373980921],
Cell[422708, 11032, 3153, 110, 70, "Output",ExpressionUUID->"eca5c853-63be-4cd6-91e7-935c1d59e733",
 CellID->524149638]
}, Open  ]],
Cell[425876, 11145, 354, 7, 70, "TechNoteMathCaption",ExpressionUUID->"406c828c-9761-476c-aeb8-ce8dcfa61bf8",
 CellID->642635412],
Cell[CellGroupData[{
Cell[426255, 11156, 480, 14, 70, "Input",ExpressionUUID->"7dff0186-e5ea-4132-b07f-1c026c741671",
 CellID->1078108721],
Cell[426738, 11172, 19649, 418, 70, "Output",ExpressionUUID->"8b5c63cf-5de3-414b-992a-a242debea30e",
 CellID->405045872]
}, Open  ]],
Cell[446402, 11593, 311, 7, 70, "TechNoteMathCaption",ExpressionUUID->"342bc3c2-fb32-4e52-80cb-329a27fe372f",
 CellID->1155771237],
Cell[CellGroupData[{
Cell[446738, 11604, 302, 8, 70, "Input",ExpressionUUID->"b3fc5557-e1fa-4603-be3a-b24c0c112df6",
 CellID->1057593144],
Cell[447043, 11614, 3342, 86, 70, "Output",ExpressionUUID->"a01347e9-1962-4893-9a06-17fe61b84fdc",
 CellID->82809714]
}, Open  ]],
Cell[450400, 11703, 152, 1, 70, "TechNoteMathCaption",ExpressionUUID->"fef8d9e6-b704-441e-b1e0-fc22f16830d7",
 CellID->1969536942],
Cell[CellGroupData[{
Cell[450577, 11708, 353, 10, 70, "Input",ExpressionUUID->"b1e68e8b-3e31-4944-8777-816d7d5e907e",
 CellID->694449336],
Cell[450933, 11720, 668, 19, 70, "Output",ExpressionUUID->"5d9d9ee9-7827-4a0c-adef-aaa52cefa7e2",
 CellID->213459942]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[451662, 11746, 193, 4, 70, "Subsection",ExpressionUUID->"893066a5-63e0-45c1-bed7-17c0c17761d5",
 CellTags->"Section22",
 CellID->1363502801],
Cell[451858, 11752, 249, 4, 70, "TechNoteText",ExpressionUUID->"b3e0da64-c0b8-4f72-965f-f9a4624cb140",
 CellID->593579270],
Cell[452110, 11758, 492, 17, 70, "TechNoteText",ExpressionUUID->"5251ed6a-5059-45c6-bbc2-ed267c6c227a",
 CellID->1225250575],
Cell[452605, 11777, 242, 4, 70, "TechNoteText",ExpressionUUID->"ae6de79b-c23f-4d85-9eb3-74c5eebea12c",
 CellID->565722942],
Cell[452850, 11783, 1185, 36, 70, "TechNoteText",ExpressionUUID->"203b4578-711d-4e82-88cd-11d233dc1bf7",
 CellID->1195380925],
Cell[454038, 11821, 138, 1, 70, "TechNoteText",ExpressionUUID->"44dd7125-4f09-42ba-932a-27b38b44251b",
 CellID->1057688790],
Cell[454179, 11824, 492, 17, 70, "TechNoteText",ExpressionUUID->"85f067c4-6922-4f5f-ad58-b805a896a8a4",
 CellID->1853347311],
Cell[454674, 11843, 285, 5, 70, "TechNoteText",ExpressionUUID->"6b9eaa58-c7d0-4971-a3e4-aa4bd310ec6b",
 CellID->2105439889],
Cell[454962, 11850, 1185, 36, 70, "TechNoteText",ExpressionUUID->"daee65f4-d46b-4895-b63b-7e1f3333e9c0",
 CellID->2040162804],
Cell[456150, 11888, 169, 3, 70, "TechNoteText",ExpressionUUID->"a6431117-6549-4964-a8b1-a2eb2e6a0ed3",
 CellID->144855179],
Cell[456322, 11893, 494, 17, 70, "TechNoteText",ExpressionUUID->"950337e3-678a-4a27-b360-48c45076b1b6",
 CellID->1482021402],
Cell[456819, 11912, 335, 6, 70, "TechNoteText",ExpressionUUID->"4e696a26-ef6c-4714-b84f-d05e52d4f53b",
 CellID->1818365508],
Cell[457157, 11920, 810, 28, 70, "TechNoteText",ExpressionUUID->"64ee8cf9-b5cc-4309-9a76-8470d2cfc3b1",
 CellID->429312499],
Cell[457970, 11950, 433, 7, 70, "TechNoteText",ExpressionUUID->"94dc0dfe-85b1-461f-8c50-236d48fdd1c0",
 CellID->2057600420],
Cell[458406, 11959, 1672, 44, 70, "TechNoteText",ExpressionUUID->"b494d82e-42fa-486c-be9f-5a2e582656ce",
 CellID->1161091299],
Cell[460081, 12005, 225, 4, 70, "TechNoteText",ExpressionUUID->"5e3d07fe-01ec-4ab6-b8b8-f064a1d4762b",
 CellID->277562004],
Cell[460309, 12011, 337, 5, 70, "TechNoteText",ExpressionUUID->"ad7617a0-c4b1-42e2-83a0-96f3c248dd9d",
 CellID->650119944],
Cell[460649, 12018, 810, 28, 70, "TechNoteText",ExpressionUUID->"0ef54e05-3c54-44ae-80e2-91675c984c69",
 CellID->169102872],
Cell[461462, 12048, 1128, 24, 70, "TechNoteText",ExpressionUUID->"c5f8bbc4-98c6-471c-bcdf-455b059cc32c",
 CellID->991104723],
Cell[462593, 12074, 1671, 44, 70, "TechNoteText",ExpressionUUID->"a6464db9-1860-4f35-afbe-d202d60a16ea",
 CellID->1613913329],
Cell[464267, 12120, 192, 4, 70, "TechNoteText",ExpressionUUID->"019c8388-df53-47c4-9658-1c2e666df214",
 CellID->175375246],
Cell[464462, 12126, 4614, 113, 70, "TechNoteText",ExpressionUUID->"548b2c25-51b4-4d26-af5a-aeb7424d2b17",
 CellID->1184195838],
Cell[CellGroupData[{
Cell[469101, 12243, 522, 11, 70, "TechNoteText",ExpressionUUID->"9fc1a979-7604-42d5-800a-cd9f095b45c9",
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {"ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 CellID->1989239018],
Cell[469626, 12256, 180, 3, 70, "TechNoteText",ExpressionUUID->"a72ec13b-b9fe-4ae6-9e0e-a666b9925e5c",
 CellID->2048492517],
Cell[CellGroupData[{
Cell[469831, 12263, 479, 13, 70, "Input",ExpressionUUID->"104e20a1-411e-4516-81e4-916d1b93a505",
 CellID->555904515],
Cell[470313, 12278, 1155, 33, 70, "Output",ExpressionUUID->"6c759e38-4597-46f9-a52d-d4cca17ee1d8",
 CellID->1323554704]
}, Open  ]],
Cell[471483, 12314, 201, 4, 70, "TechNoteMathCaption",ExpressionUUID->"2e9e94a2-cae9-4d6f-947a-f6fe0faa5bfc",
 CellID->691274085],
Cell[CellGroupData[{
Cell[471709, 12322, 466, 13, 70, "Input",ExpressionUUID->"345217f7-8dcb-4d3a-a2b3-1e48872ab5af",
 CellID->357016325],
Cell[472178, 12337, 1251, 35, 70, "Output",ExpressionUUID->"0e15bb5c-15c1-4cbd-9bd9-b597129f939b",
 CellID->1348294502]
}, Open  ]],
Cell[473444, 12375, 153, 1, 70, "TechNoteMathCaption",ExpressionUUID->"e40b8ac0-8e97-492d-90eb-923a1bdfe3e8",
 CellID->1549413286],
Cell[CellGroupData[{
Cell[473622, 12380, 906, 23, 70, "Input",ExpressionUUID->"847ee677-ccda-473b-8f4e-8477c35936af",
 CellID->602394280],
Cell[474531, 12405, 2683, 58, 70, "Output",ExpressionUUID->"91edb497-e615-480f-9d18-ba738dfb079d",
 CellID->538251970]
}, Open  ]],
Cell[477229, 12466, 137, 1, 70, "TechNoteMathCaption",ExpressionUUID->"ff10ff60-4c52-4bc7-a622-cd5346b67ebd",
 CellID->389328403],
Cell[CellGroupData[{
Cell[477391, 12471, 1037, 27, 70, "Input",ExpressionUUID->"1072adec-52ec-4121-8287-8aeb531968bf",
 CellID->59796812],
Cell[478431, 12500, 3603, 79, 70, "Output",ExpressionUUID->"460951b4-a928-416f-8cac-bf2bea7350ef",
 CellID->1199738626]
}, Open  ]],
Cell[482049, 12582, 193, 4, 70, "TechNoteMathCaption",ExpressionUUID->"5148c4d2-8e61-47dd-bb6f-7eebe59629d4",
 CellID->834281808],
Cell[CellGroupData[{
Cell[482267, 12590, 551, 16, 70, "Input",ExpressionUUID->"e58b3d63-e8e5-40e5-9149-650e22614ac8",
 CellID->853615793],
Cell[482821, 12608, 669, 19, 70, "Output",ExpressionUUID->"e1f16f56-fa11-4380-9433-3fc21e730133",
 CellID->1283125499],
Cell[483493, 12629, 668, 19, 70, "Output",ExpressionUUID->"da9afeb2-231e-4fde-acdf-67631c3e8f90",
 CellID->459478519]
}, Open  ]],
Cell[484176, 12651, 632, 13, 70, "TechNoteText",ExpressionUUID->"7b806c39-d1f1-4271-af31-bbe29595ff75",
 CellID->645391397]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[484857, 12670, 134, 2, 70, "Subsection",ExpressionUUID->"70b1fc81-e7a3-4281-babb-e58d4eabe3b4",
 CellTags->"Section23",
 CellID->153308382],
Cell[484994, 12674, 427, 7, 70, "TechNoteText",ExpressionUUID->"f0c1f8e3-bdb3-4100-bef1-6d2d0c5d1c46",
 CellID->1821083521],
Cell[485424, 12683, 179, 3, 70, "Input",ExpressionUUID->"e3722511-5c20-4787-a562-69dcd4c0e16c",
 CellID->255167231],
Cell[485606, 12688, 183, 4, 70, "Input",ExpressionUUID->"ec807c0e-8daf-402f-88fc-bf653fb82f91",
 CellID->370132468],
Cell[485792, 12694, 280, 5, 70, "TechNoteMathCaption",ExpressionUUID->"205a2093-686c-47f8-b726-b350e30e3b55",
 CellID->1013800403],
Cell[CellGroupData[{
Cell[486097, 12703, 555, 17, 70, "Input",ExpressionUUID->"50f05c2a-d4cb-425b-a195-6753c7a72cf5",
 CellID->808117923],
Cell[486655, 12722, 1825, 46, 70, "Output",ExpressionUUID->"7662303a-42bd-4025-8b2c-fc23fdf941a6",
 CellID->104274221]
}, Open  ]],
Cell[488495, 12771, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"63b08de7-5ea6-4115-a9d5-a369788f66ac",
 CellID->322701359],
Cell[CellGroupData[{
Cell[488730, 12779, 269, 7, 70, "Input",ExpressionUUID->"8c9ed290-4a80-4137-930f-7b7ae025a19a",
 CellID->1245532038],
Cell[489002, 12788, 2437, 57, 70, "Output",ExpressionUUID->"6e1edca6-b254-4352-9b28-d8a6883d785e",
 CellID->190176395]
}, Open  ]],
Cell[491454, 12848, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"653d3eb7-35e7-4ab7-9e2f-1f844e8dae39",
 CellID->730080199],
Cell[CellGroupData[{
Cell[491675, 12856, 374, 10, 70, "Input",ExpressionUUID->"a03e67cb-d77e-4ec0-968d-7b334e7e8015",
 CellID->1883829282],
Cell[492052, 12868, 3153, 110, 70, "Output",ExpressionUUID->"659238ab-7356-412b-856f-90380bb9b265",
 CellID->839004029]
}, Open  ]],
Cell[495220, 12981, 200, 4, 70, "TechNoteMathCaption",ExpressionUUID->"a898af87-92df-4dbe-abc6-4460d13149eb",
 CellID->2133759026],
Cell[CellGroupData[{
Cell[495445, 12989, 509, 15, 70, "Input",ExpressionUUID->"70b9f7ee-3542-4199-a05e-a52e86472199",
 CellID->1258528729],
Cell[495957, 13006, 8674, 219, 70, "Output",ExpressionUUID->"7b977f28-dd96-4398-86f1-c9c15b74f2d3",
 CellID->763089201]
}, Open  ]],
Cell[504646, 13228, 371, 7, 70, "TechNoteMathCaption",ExpressionUUID->"8ba0fd97-0719-4ddd-ae2e-4bcd35c9bd77",
 CellID->702850526],
Cell[CellGroupData[{
Cell[505042, 13239, 217, 5, 70, "Input",ExpressionUUID->"b262345f-cd83-45a7-8c6d-ecf28ae84317",
 CellID->1648731982],
Cell[505262, 13246, 8503, 184, 70, "Output",ExpressionUUID->"70d5e0b6-9363-4840-bbba-02488c812c5d",
 CellID->467861323]
}, Open  ]],
Cell[513780, 13433, 400, 6, 70, "TechNoteMathCaption",ExpressionUUID->"586c24f5-d71d-45fb-a621-955329e9a695",
 CellID->328948492],
Cell[CellGroupData[{
Cell[514205, 13443, 222, 5, 70, "Input",ExpressionUUID->"3b5cb395-9a8c-40f5-a076-2c7bb6744c9e",
 CellID->1014397666],
Cell[514430, 13450, 6533, 129, 70, "Output",ExpressionUUID->"59fda8c6-d8a1-448f-980c-4a1354d38852",
 CellID->1407623994]
}, Open  ]],
Cell[520978, 13582, 196, 4, 70, "TechNoteMathCaption",ExpressionUUID->"d6ccdb04-61f0-4bfd-961a-b1bcd1dd0db7",
 CellID->608232459],
Cell[CellGroupData[{
Cell[521199, 13590, 338, 9, 70, "Input",ExpressionUUID->"a8731c35-1334-4d76-8147-a5520d3b75a7",
 CellID->540778693],
Cell[521540, 13601, 2683, 59, 70, "Output",ExpressionUUID->"dfa4b88d-48ff-4825-ab58-c6d92c39c8a5",
 CellID->1256611806]
}, Open  ]],
Cell[CellGroupData[{
Cell[524260, 13665, 216, 6, 70, "Input",ExpressionUUID->"82e245c2-0c75-4c7a-9de2-61049103dc49",
 CellID->326787606],
Cell[524479, 13673, 669, 19, 70, "Output",ExpressionUUID->"c9bf27ea-69a1-4ed5-b01f-f397b9ccbdfb",
 CellID->1520438844]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[525187, 13697, 741, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"8a788bd9-76bd-44a4-ab95-98f9ce9aa753"],
Cell[525931, 13717, 1138, 30, 70, "RelatedTutorialsSection",ExpressionUUID->"701cb65d-4b2c-4299-9aba-04502403875e"],
Cell[527072, 13749, 5258, 133, 70, "TutorialRelatedLinksSection",ExpressionUUID->"ebe4a2e1-a55a-46d4-aaed-6ef94ba24974"]
}, Open  ]],
Cell[532345, 13885, 78, 0, 70, "FooterCell",ExpressionUUID->"ff119bdd-c928-43ac-b2dc-4a4d200d7b8b"]
}
]
*)

(* End of internal cache information *)
