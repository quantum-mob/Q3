(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    116872,       2887]
NotebookOptionsPosition[     99894,       2553]
NotebookOutlinePosition[    102984,       2625]
CellTagsIndexPosition[    102903,       2620]
WindowTitle->Universal Quantum Computation
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "cd0e7182-1cd6-4a57-9801-c5ac94b0e853"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "c98eb88e-0bc4-4843-b756-3be25515cba5"],
        Background->LightDarkSwitched[
          RGBColor[
          0.3843137254901961, 0.4627450980392157, 0.7019607843137254]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "c9654d03-8df8-468b-943c-815c31216c77"]
         }],ExpressionUUID->"fa853a51-676e-4911-ae9c-d518228a14af"],
         StripOnInput->False],{
        StyleBox["\"GivensFactor\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/GivensFactor"], 
         StyleBox[
          "\"GivensRotation\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/GivensRotation"]},
        
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "7dbb9164-40f7-496c-919b-cce0b3e59d85"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "a6c66c32-de5c-48ce-abc7-07af862106c4"]
         }],ExpressionUUID->"f1ef9876-ee5d-40a1-acf8-8bf8322460af"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "a12b5653-b50e-4cb9-92a7-93ef1d2dbf5b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "cf07ea02-647d-42b0-ba6c-80b44a3514ab"]
         }],ExpressionUUID->"4a3355a9-959d-47b9-9dfb-24ce9ab9edb6"],
         StripOnInput->False],{
        "\"Quantum Computation: Overview\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "497bc9fb-0f66-4c4e-95bd-a7b271873580"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "58b7e3a7-e2a6-49ae-8af3-2639fc3cd0ce"]
         }],ExpressionUUID->"4b30515f-07ef-4995-9654-50bc88aaed04"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/tutorial/UniversalQuantumComputation\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard[
          "QuantumMob/Q3/tutorial/UniversalQuantumComputation"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/\
tutorial/UniversalQuantumComputation.html"], StandardForm]], "Input", 
                 TextClipboardType -> "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/tutorial/UniversalQuantumComputation") <> 
               ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "1b8c003a-6a1a-4ce8-9d8d-583fdb8da99b"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "f51f6d96-38af-40c7-ade4-7ba333f322e1"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"c17208a9-833f-4963-a002-5a929101745f"],

Cell[CellGroupData[{

Cell["Universal Quantum Computation", "TechNoteTitle",
 CellID->1902776493,ExpressionUUID->"ecfb7b7b-a3f6-482a-ada1-278b5e75fac7"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Decomposition into Two-Level Unitary Matrices"], 
      "paclet:QuantumMob/Q3/tutorial/UniversalQuantumComputation#1255432361", 
      
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell[
      "Implementation of Two-Level Unitary Matrices: Gray Code Sequence"], 
      "paclet:QuantumMob/Q3/tutorial/UniversalQuantumComputation#1829642645", 
      
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Implementation of Two-Level Unitary Matrices: Idea"], 
      "paclet:QuantumMob/Q3/tutorial/UniversalQuantumComputation#1012467270", 
      
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Universal Quantum Computation Theorem"], 
      "paclet:QuantumMob/Q3/tutorial/UniversalQuantumComputation#205503201", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TechNoteJumpBox",ExpressionUUID->"fa951ce3-cd0a-4733-90eb-\
85be3bf231de"],

Cell["\<\
In classical computation, it is known that a finite set of logic gates\
\[LongDash]typically including AND, OR, and NOT\[LongDash]is sufficient to \
calculate any binary function. The set is said to be universal for classical \
computation. Does there exist a universal set of elementary quantum logic \
gates for quantum computation that enables to implement any arbitrary quantum \
unitary operation?\
\>", "TechNoteText",
 CellID->1061332761,ExpressionUUID->"84f3faf3-7fac-4b96-9f9e-1c1088755a1a"],

Cell[TextData[{
 "See also Section 2.4 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"TechNoteText"}]],ExpressionUUID->
  "6280ea29-fe05-424e-865f-9a2e07fe89e7"],
 "."
}], "TechNoteText",
 CellID->1308734266,ExpressionUUID->"ae185261-739f-44bc-bb00-1926034badc5"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["GivensFactor"]], "paclet:QuantumMob/Q3/ref/GivensFactor", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Decomposes a unitary operator into a list of two-level unitary operators\
\>", "TechNoteTableText",ExpressionUUID->
     "54115014-7287-40e5-b3c1-96693c24269b"]},
   {
    TemplateBox[{
      Cell[
       TextData["GivensRotation"]], "paclet:QuantumMob/Q3/ref/GivensRotation",
       "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents a two-level unitary operator", "TechNoteTableText",
     ExpressionUUID->"fa666763-da02-48ec-987c-3faa3164ae6b"]}
  }]], "DefinitionBox",
 CellID->472512640,ExpressionUUID->"bd016352-3a0a-4e51-b01f-de0a3aab8fd7"],

Cell["\<\
Q3 functions related to the universal quantum computation theorem.\
\>", "TechNoteCaption",
 CellID->125413874,ExpressionUUID->"dc24c5d1-afb1-4c41-8766-58960349f3db"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3: Symbolic Quantum Simulation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"ab7d658d-5596-436d-9407-472a6cb6e1e6"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[85]:=",
 CellID->853967906,ExpressionUUID->"89685448-5de1-4f86-8ee8-a6459aec4983"],

Cell[CellGroupData[{

Cell["Decomposition into Two-Level Unitary Matrices", "TechNoteSection",
 CellID->1255432361,ExpressionUUID->"4b674737-ebe1-40a4-b8ac-7a61b49366d8"],

Cell[TextData[{
 "Suppose that we want to implement an arbitrary unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "3a7bc8cb-9733-4d6c-a4ab-bc7478470e33"],
 " on an ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "910fd795-090b-46d9-8b25-8f635d3ef4e9"],
 "-qubit register. We start by decomposing ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "07d8cfe6-2ea6-4da4-acf3-302449f9241c"],
 " into a set of two-level unitary transformations ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "k"], TraditionalForm]],ExpressionUUID->
  "67fa4544-4568-4738-8f2e-6390aa158b93"],
 ", that is,"
}], "TechNoteText",
 CellID->2093541217,ExpressionUUID->"ec7ea86a-8a06-415d-baf8-1b6df9fbf61b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["T", "L"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "367aa763-848b-4429-bc6b-c93d1299d95b"],
 " ."
}], "TechNoteText",
 CellID->330293091,ExpressionUUID->"7aedf952-6152-490d-9d04-137b5ecc907a"],

Cell[TextData[{
 "The procedure is detailed for arbitrary two-qubit unitary gates in ",
 ButtonBox["Two-Qubit Gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1476129218"],
 ". To summarize the procedure, first  remove the off-diagonal element ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"1", " ", "n"}]], TraditionalForm]],ExpressionUUID->
  "27eb9dc0-6ff2-43d6-9774-4167110fa170"],
 " at the top-right corner of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "4b1c5a80-d656-4f82-8aa4-73e7f3e62ccf"],
 " by multiplying ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "1e3e4c58-2bd2-418b-b9c8-1033c4d86afb"],
 " with a two-level unitary transformation ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["T", "1", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "913a2a6b-eb98-4912-8c5a-ae66b31bee03"],
 " on the right, and repeat it along the top row and then the next \
consecutive rows to zero all off-diagonal elements and to set every diagonal \
element to unity, so that"
}], "TechNoteText",
 CellID->2138236589,ExpressionUUID->"46cc9fef-fe1b-476b-aeeb-489b1e86368a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubsuperscriptBox["T", "1", "\[Dagger]"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "L", "\[Dagger]"]}], "=", "I"}], 
   TraditionalForm]],ExpressionUUID->"291ec5fd-f150-4387-9aba-024a50ef4f5c"],
 " ."
}], "TechNoteText",
 CellID->1351002425,ExpressionUUID->"c4dbd1a3-1260-4b68-985f-b2681d0c4caa"],

Cell[TextData[{
 "The decomposition of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "98a1f6bf-cfd8-433a-8df0-36b4d1a124f6"],
 " is then given by"
}], "TechNoteText",
 CellID->953157244,ExpressionUUID->"ec98d8a1-136e-491b-a755-98e6ece62c0e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["T", "L"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "6c036d2c-5796-4598-ba8e-72180326b278"],
 " ."
}], "TechNoteText",
 CellID->1633276935,ExpressionUUID->"78b6e818-d38d-4e89-b242-3a3df1996fcd"],

Cell["as desired.", "TechNoteText",
 CellID->1349470591,ExpressionUUID->"e157fa3d-d552-410b-8512-ab0c44407d3b"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText",
 Editable->False,
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {
   "ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 FontColor->GrayLevel[0.85],
 CellID->2035887808,ExpressionUUID->"c117c6c6-0a92-430e-b872-c6cba80dd22c"],

Cell["\<\
For demonstration, consider a three-qubit system, and an arbitrary unitary \
operation on it.\
\>", "TechNoteText",
 CellID->1917505328,ExpressionUUID->"47d31ae5-f82f-44f5-8cd2-55ed544264a4"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[86]:=",
 CellID->591242595,ExpressionUUID->"814fd70e-0df5-4005-a2a4-cec5ac7fc635"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[87]:=",
 CellID->607459496,ExpressionUUID->"fad56d37-c3d8-46f2-8aba-278381462e66"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "3"}], ",", 
     RowBox[{";;", "3"}]}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[88]:=",
 CellID->86358426,ExpressionUUID->"b8a7b957-5fc0-4f95-96f4-7ae4d6ac7a24"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.07609894894523883`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3306554198563423`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06969985768195544`"}], "-", 
       RowBox[{"0.15983662546001443`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5022868852106268`"}], "+", 
       RowBox[{"0.34458405905281997`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.24251794586347464`"}], "-", 
       RowBox[{"0.41989382272280984`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.05223424981769833`"}], "+", 
       RowBox[{"0.540668494100228`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.016709463496944667`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.07355591519407773`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.13824600133925813`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.17819062785183434`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.21535868733134403`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.17565403971434917`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.06055211120401516`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.04355356991296286`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[91]//MatrixForm=",
 CellID->2141573666,ExpressionUUID->"58f25879-49c7-437c-8aaf-1e64b2131347"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"{", 
    RowBox[{"op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[92]:=",
 CellID->1264688223,ExpressionUUID->"675e65f8-5480-4651-bfa6-208e80c25ebf"],

Cell[BoxData[
 PaneSelectorBox[{"Light"->
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJzt3T2IFAkChmF/ThF/4AIRNPLAxEDBQLzAwMtcBIXVDcxmh5sbVsSDWfW4
cMBMUAQxUdHMwEAmEMFARRQHURFBEEwMhF7xDwVHHNS66YYuhLv7une6Zrt9
632gFtytrvJr3mJ3ptX9y/A/f/zHgnnz5v26ZOYvP/78r7+Njf38791/nvnB
Twd+/WX0wMjffzhwcGR0ZOyvwwtn/uZvM8ebmeNPM0chSZIkSZIkSZIkSZIk
SZIkSZIkSZIkSZIkSZIkSZIkSZKkWmv+kdW0Q6Lr9zPmcyv9fqTWSVukhNQ6
aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVukhNQ6
aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVukhNQ6
aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVs0GB4+
fFicO3du4A5S6+0t/X5POx1TU1P9fqvUpfHx8Tn//2v0chD0+z3s9mg0Gv1+
q9SliYmJYmhoaOAO4nPb7/e00/Hu3bt+v1X6zhGfW4mO1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUjIXrV+/fr3YuXNn6zh16lRXrxkaGipf8+HDh1nd1+dWdTEXrR86dKi8
7okTJzqe//Lly/L8NWvWzPq+Preqi7lofdu2beV179y50/H8K1eulOfv2rVr
1vf1uVVdVN36ly9fihUrVrSuuWjRouLjx48dXzM+Pl7+PI4cOTLre/vcqi6q
bv3x48flNTdt2tTVa3bs2FG+5urVq7O+t8+t6qLq1s+fP19ec3R0tKvXrFq1
qnzNmzdvZn1vn1vVRdWt79u3r7zmmTNnOp7/7Nmz8vx169b1dG+fW9VF1a1v
3ry5vOajR486nn/x4sXy/L179/Z0b59b1UWVrX/69KlYvHhx63pLly4tPn/+
3PE1335mdPz48Z7u73Orqk1NTbU+pxy0o8rW7969W15v69atXb3m28+Mbt26
1dP929fp93va6fj69WtPO/XH+fazjkE8qnDy5MnyemNjYx3P//Yzo4ULF876
10m19fs97PZoNBo97dQf5+jRo8XKlSsH7qjyuR0eHi6vd+HChY7nP3jwoDx/
48aNPd+/fa1+v6edjhcvXvS8VfVW5XPb/Ly2fb2nT592PP/YsWPl+fv37+/5
/n59q7qosvVly5a1rtX8dVLdfE9q+/bt5f0nJiZ6vr/Preqiqtab30tuX2v1
6tUdz29+brtgwYLW+UuWLCnev3/f88/B51Z1UWXrza9Rm9eaP39+8erVq/97
3vT0dOv367XvPTIyUsn9fW5VF1W2fvDgwfJ6zefyf/23cvOZbf6en/Z5zc95
nzx5Usn9fW5VF1W2fvv27da/a9vXXL9+fXH69OnW7+W7fPlycfjw4WLDhg3l
P29+PXzjxo1K7t3kc6u6qLr15veI21+3pmP58uXFzZs3K7tvk8+t6mIuWp+c
nCx2795drF279r+e1+b3mvfs2VPcv3+/0ns2+dyqLua69bdv3xbXrl0rLl26
VNy7d6/147nic6u6ILVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtGgxnz54t
tmzZMnAHqfX2ln6/p52O169f9/utUpfGx8fLrgbxIOj3e9jt0Wg0+v1WqUvP
nz8vJicnB+4gPrf9fk87HdPT0/1+q/SdIz63Eh2pddIWKSG1TtoiJaTWSVuk
hNQ6aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVuk
hNQ6aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVuk
hNQ6aYuU9PvPJJ2LQ6Lr9zPmcytJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkvR9+g9pQeV4
     "], {{0, 116.}, {119., 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{144., 144.},
     RasterInterpolation->"High"],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{119., 116.},
   PlotRange->{{0, 119.}, {0, 116.}}], "Dark"->
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJzt3D9oVWkChnHZnWLKaRUVg1jEPwHRwkZlsNCNVrOsoAgycXUQNUFnUbcS
O72d2iqWprQTQVRQS7WxsLJWkPUPFirq2ZzAPZgZ5r0Bz+V8eXw++A3EOffG
9/BcEhPjyMTUL4f+tmjRot9/nPnPL7+e+vnEiV//+8+fZt741+Tvh3+bPPjv
f0z+5+BvB09smvj7zC8+n/G/GT/MWLx4cSVJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkqTvF/F0fU+lYSOeru+pNGyk1klbpITUOmmLlJBaJ22R
ElLrpC1SQmqdtEVKSK2TtkgJqXXSFikhtU7aIiWk1klbpITUOmmLlJBaJ22R
ElLrpC1SQmqdtEVKSK2TtkgJqXXSFikhtU7aIiWk1klbpITUOmmLlJBaJ22R
ElLrpC1SQmqdtEVKSK2TtkgJqXXSFikhtU7aIiWk1klbVIZt27ZVU1NTxSG1
3j9d39NBRkZGOr9Xmp9er1eVfLq+P21YKGdsbKzze6X52b9/fzU9PV2c/un6
/rShf7q+p4OsWrWq83ulhY34uu369yENG6l10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6RkGK1f
uHCh+vjx46y7d+8OvH50dLT68OFD85jt27cXs0Uq0TBav3fvXvO8ly9fHnj9
nj17mus/f/5crVy5spgtUomG0frbt2+b5z169OjA68+dO9dc//Tp06K2SCVq
u/XNmzdXX5/67UGPuXnzZnP99PR0MVukUrXd+rFjx5rnfPPmzbwe8+LFi+Yx
p0+fLmaLVKq2W79y5UrznPWfcwddv2HDhjkfn3fs2FHMFqlUbbf+6NGj5jkv
Xrw48PoDBw4019dfU16+fHkxW6RStdl6/Zp7//5985wTExMDH3Pp0qXm+seP
HxezRSpZm63X33f9+tSfAw96zP3795vrr169WswWqTYyMlKtWbOmOG22furU
qeb56q81Dbp+yZIlc75nNDU19U3vv3+6vqeDdN2i5q/X61UlnzY2Xrt2rXm+
+ns7g67fsmXLnN9D/fa3vP+FcsbGxjrvUfNz9uzZ6uXLl8XpnzY2PnnypHm+
8+fPD7z+5MmTzfXv3r2b/fj7Le+/f7q+p4OsXbu28x61sLX1uq2/JlX/3eL+
2bt378DHXL9+vbn+9u3bxWyRStdW6xs3bpzzueCmTZvi9StWrKhevXrVXH/m
zJlitkila6v1rVu3znndrl69Ol4/OTk55/pv/bNtm1uk0rXV+tKlS+d8bfjQ
oUN/eW39/aKvP9Y+ePCgqC1S6dps/caNG83z1a/LXbt2/emanTt3Vq9fv26u
q39ub/fu3cVtkUrWZuv1z+z98dy5c2f270TV3yN69uzZnP/36dOn6siRI0Vu
kUrWdutf/1xBOvVr9vDhw0VvkUo1jNb37dtX3bp1q3r+/PmfXq9fvnyZ/bdr
2vrceNhbpBINu/V169bN/js09c/9jI+PD/Xv+fm61feC1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7aoDMePH68ePnxYHFLr/dP1PR1kdHS083ul+en1elXJ
p+v704aFcsbGxjq/V5qf9evXV+Pj48Xpn67vTxv6p+t7OsiyZcs6v1da2Iiv
265/H9KwkVonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVuk
hNQ6aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVuk
hNQ6aYuUkFonbZESUuukLVJCap20RUpIrZO2SAnxdH1PpWEjnq7vqSRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ0vfg/w89UFQ=
     "], {{0, 116.}, {119., 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{144., 144.},
     RasterInterpolation->"High"],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{119., 116.},
   PlotRange->{{0, 119.}, {0, 116.}}]}, Dynamic[
   AbsoluteCurrentValue[LightDark]]]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[93]=",
 CellID->620797874,ExpressionUUID->"8b79a35f-1f8b-4be3-b0a2-85334c79f573"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{"GivensFactor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[94]:=",
 CellID->104214177,ExpressionUUID->"1b679a26-c2ba-4def-942d-32dce6f9ee19"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Chop", "@", 
   RowBox[{"Matrix", "@", 
    RowBox[{"twl", "[", 
     RowBox[{"[", 
      RowBox[{";;", "3"}], "]"}], "]"}]}]}]}]], "Input",
 CellLabel->"In[95]:=",
 CellID->1514570623,ExpressionUUID->"0042280d-9310-4fca-a552-6f4f12f14da0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0", 
        "0", "0", "0", "0", "0"},
       {"0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0", 
        "0", "0", "0", "0"},
       {"0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0", 
        "0", "0", "0"},
       {"0", "0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0", 
        "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "0", "0", "0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 6, 7, 8}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         8}}}, {Complex[0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1.`", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1.`", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1.`", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1.`", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1.`", "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.29777433264956565`"}], "-", 
         RowBox[{"0.3826408706938628`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.6484396246289845`"}], "+", 
         RowBox[{"0.58689220824677`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"0.6484396246289845`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.58689220824677`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.29777433264956565`"}], "+", 
         RowBox[{"0.3826408706938628`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 6, 8, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         8}, {7}, {8}}}, {
        1., 1., 1., 1., 1., 1., 
         Complex[-0.29777433264956565`, -0.3826408706938628], 
         Complex[-0.6484396246289845, 0.58689220824677], Complex[
         0.6484396246289845, 0.58689220824677], 
         Complex[-0.29777433264956565`, 0.3826408706938628]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1.`", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1.`", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1.`", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1.`", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.21629434873804554`"}], "+", 
         RowBox[{"0.07259508122558458`", " ", "\[ImaginaryI]"}]}], 
        "0.9736255485995813`", "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{"-", "0.9736255485995813`"}], 
        RowBox[{
         RowBox[{"-", "0.21629434873804554`"}], "-", 
         RowBox[{"0.07259508122558458`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         6}, {7}, {8}}}, {
        1., 1., 1., 1., 1., 
         Complex[-0.21629434873804554`, 0.07259508122558458], 
         0.9736255485995813, -0.9736255485995813, 
         Complex[-0.21629434873804554`, -0.07259508122558458], 1.}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[95]=",
 CellID->367846473,ExpressionUUID->"c6282849-7b0b-4870-9d4b-57bbbedda946"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation of Two-Level Unitary Matrices: Idea", "TechNoteSection",
 CellID->1012467270,ExpressionUUID->"71e00a61-a753-4c7e-9e98-b6fda3981015"],

Cell[TextData[{
 "Some two-level unitary transformations are themselves ",
 ButtonBox["multi-control unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/MultiControlUnitaryGates"],
 ", which can be implemented in terms of elementary gates. The most common \
example is"
}], "TechNoteText",
 CellID->1580628084,ExpressionUUID->"4f83efb3-283b-4987-a1ee-6fb615fcfa50"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0"},
      {"0", "0", "\[DescendingEllipsis]", "\[VerticalEllipsis]", 
       "\[VerticalEllipsis]"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "42bfd181-8060-40c5-8f90-1bb15c425871"],
 " ."
}], "TechNoteText",
 CellID->1243494398,ExpressionUUID->"6b25993a-84c7-4696-b12a-163e78b95ba2"],

Cell["On three qubits, another example is", "TechNoteText",
 CellID->99494582,ExpressionUUID->"e8433b11-4cc9-4758-b81f-56939f56fb3a"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0", "0"},
      {"0", "0", "\[DescendingEllipsis]", "\[VerticalEllipsis]", 
       "\[VerticalEllipsis]", "\[VerticalEllipsis]"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["V", "11"], "0", 
       SubscriptBox["V", "12"]},
      {"0", "0", "\[CenterEllipsis]", "0", "1", "0"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["V", "21"], "0", 
       SubscriptBox["V", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "70c18d72-70ee-4b09-b029-04c99066e783"],
 "     \[DotEqual] ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     LineBox[{{1, -1}, {1, -3}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "bb828b89-e1bb-48aa-a2aa-7b33add41307"],
 ","
}], "TechNoteText",
 CellID->1463162308,ExpressionUUID->"8d54056c-f9de-4079-89ab-bb75808eaa60"],

Cell[TextData[{
 "where the gate with label \[OpenCurlyQuote]",
 StyleBox["V",
  FontSlant->"Italic"],
 " \[CloseCurlyQuote] on the second qubit indicates unitary operator"
}], "TechNoteText",
 CellID->533668759,ExpressionUUID->"fcd9088a-7487-4464-b57e-7a9f59535818"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["V", "11"], 
        SubscriptBox["V", "12"]},
       {
        SubscriptBox["V", "21"], 
        SubscriptBox["V", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "de21c548-d50d-4c4f-971d-bf1c85ee8c36"],
 " ."
}], "TechNoteText",
 CellID->1479122641,ExpressionUUID->"3b97e191-3725-4bb7-a7de-e6771d8cc507"],

Cell["\<\
Some other two-level unitary transformations are not multi-control unitary \
gates and yet simple variants. An example is\
\>", "TechNoteText",
 CellID->343529615,ExpressionUUID->"e807dab0-9872-48a7-8bad-29a3c1aec7f4"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0", "0", "0", "0"},
      {"0", "0", 
       SubscriptBox["V", "11"], "0", "0", "0", 
       SubscriptBox["V", "12"], "0"},
      {"0", "0", "0", "1", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["V", "21"], "0", "0", "0", 
       SubscriptBox["V", "22"], "0"},
      {"0", "0", "0", "0", "0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "ae4b5a83-7421-4ea6-a9a4-6216d9080e68"],
 "     \[DotEqual] ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{2, -2}, {2, -3}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, ImageScaled[{0.5, 0.5}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "094e0fce-5df5-4ab9-a606-dbe07837d01d"],
 ","
}], "TechNoteText",
 CellID->1266196169,ExpressionUUID->"41816679-e3d5-4d5c-b896-bb10d938f117"],

Cell[TextData[{
 "In this case, unitary operator ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "242a75e3-a254-4ff5-92bc-dddd2ae70745"],
 " acts conditioned on the second qubit in |1\:27e9 and the third qubit in |0\
\:27e9 (rather than |1\:27e9), and the above two-level unitary transformation \
is a simple variant of multi-control unitary gate."
}], "TechNoteText",
 CellID->1543554260,ExpressionUUID->"dfe61083-1a75-4cc3-9a18-11f523ef4428"],

Cell["\<\
Through these examples, we see that any two-level unitary gate with the two \
non-trivial columns and rows attributed to two logical basis states differing \
only in one qubit is either a multi- control unitary gate or a simple variant \
of it. It is thus clear that such a two-level unitary transformation can be \
implemented in terms of elementary gates.\
\>", "TechNoteText",
 CellID->913992060,ExpressionUUID->"f3d7f1fb-7cb5-46bc-940a-d894112f6d5f"],

Cell["\<\
Two-level unitary transformations that do not belong to the above class \
requires additional manipulation. The basic idea is to simultaneously \
exchange columns and rows so that the resulting matrix corresponds to a \
controlled-unitary gate such as the one seen above. Furthermore, a series of \
simultaneous exchanges of columns and rows bring any two-level unitary \
transformation to a multi-control unitary gate and that each exchange of \
columns of rows can be carried by the multi-control NOT gate or a simple \
variant of it.\
\>", "TechNoteText",
 CellID->514025429,ExpressionUUID->"e5ebf77c-6cd7-4019-92c8-f061fefd4778"],

Cell[TextData[{
 "For example, consider a two-level unitary transformation ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "f98785db-5395-45bf-9dc1-102a48c3cdf7"],
 " on three qubits of the following form,"
}], "TechNoteText",
 CellID->2046156969,ExpressionUUID->"3a4fdbcb-9ff3-4e2d-9993-632c48558e1e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        SubscriptBox["V", "11"], 
        SubscriptBox["V", "12"], "0"},
       {"0", "0", "0", "0", "0", 
        SubscriptBox["V", "21"], 
        SubscriptBox["V", "22"], "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "bbf7b36f-c863-424c-8a02-7a2dcb9f1ca4"],
 "  ."
}], "TechNoteText",
 CellID->2104538572,ExpressionUUID->"c2f582ca-9863-4cd2-b900-217a57d4c994"],

Cell[TextData[{
 "The simultaneous exchange of the last two columns and rows brings the above \
two-level unitary matrix to the ",
 ButtonBox["form seen at the beginning",
  BaseStyle->"Link",
  ButtonData->
   "paclet:QuantumMob/Q3/tutorial/UniversalQuantumComputation#1463162308"],
 ". On the other hand, given that the last two columns (or rows) in the \
matrix representation correspond to the logical basis states |110\:27e9 and \
|111\:27e9, respectively, the simultaneous exchange of the last two columns \
and rows can be carried out by the multi-control NOT gate with the first two \
qubits as controls and the third qubit as target. Putting these two \
observations together, we find that"
}], "TechNoteText",
 CellID->1924113514,ExpressionUUID->"390fbe96-3045-467e-8dc6-9856b95c554f"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "="}], TraditionalForm]],ExpressionUUID->
  "8e52c0ab-05d2-4624-ab50-fa4322767dcf"],
 " ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "21530649-1760-4739-8021-a2ebb63f989b"],
 "."
}], "TechNoteText",
 CellID->1767073272,ExpressionUUID->"09a9d0a9-7b3a-415d-aef1-ea738e10f82f"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText",
 Editable->False,
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {
   "ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 FontColor->GrayLevel[0.85],
 CellID->2099512760,ExpressionUUID->"288d7077-0f81-45bf-8066-3314fb346358"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[96]:=",
 CellID->1940070093,ExpressionUUID->"2712345a-14a5-4cca-b262-3552e3211c36"],

Cell["For demonstration, consider one of the two above examples.", \
"TechNoteMathCaption",
 CellID->826895218,ExpressionUUID->"503bfb44-25a7-4ce5-92b7-17539c188d15"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[97]:=",
 CellID->651125270,ExpressionUUID->"ef2ba5f0-a4d8-406d-9665-f451e45fa568"],

Cell[TextData[{
 "A two-level unitary matrix is represented in a compact way by ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GivensRotation"]], "paclet:QuantumMob/Q3/ref/GivensRotation", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "df73212f-6eec-4361-ac05-063c04838471"],
 "."
}], "TechNoteMathCaption",
 CellID->735486019,ExpressionUUID->"c5571520-7b22-4b8a-9d99-121c44379250"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"opT", "=", 
  RowBox[{"GivensRotation", "[", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"TheRotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"6", ",", "7"}], "}"}], ",", "8"}], "]"}]}]], "Input",
 CellLabel->"In[98]:=",
 CellID->880800639,ExpressionUUID->"e0b8e09d-c7af-4184-a266-52a72142de42"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["GivensRotation",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox[
                 "\"Affected columns and rows: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox[
                 "\"Affected columns and rows: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox[
                    SqrtBox["3"], "2"], ",", 
                    RowBox[{"-", 
                    FractionBox["1", "2"]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox["1", "2"], ",", 
                    FractionBox[
                    SqrtBox["3"], "2"]}], "}"}]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`GivensRotation[{{Rational[1, 2] 3^Rational[1, 2], 
     Rational[-1, 2]}, {
     Rational[1, 2], Rational[1, 2] 3^Rational[1, 2]}}, {6, 7}, 8],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[98]=",
 CellID->1937735645,ExpressionUUID->"399f6900-56d2-405e-8aef-10b4f020b0ac"]
}, Open  ]],

Cell["\<\
Here is the conventional form of the above two-level unitary matrix.\
\>", "TechNoteMathCaption",
 CellID->1465223655,ExpressionUUID->"149d7078-ecb6-4c2e-bea3-86d7858d7288"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", "opT"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[99]:=",
 CellID->2100283434,ExpressionUUID->"8e171931-20e3-4a02-a4a2-8f00827d3d9a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
       7}, {6}, {8}}}, {
      1, 1, 1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1}}]]]]], "Output",
 CellLabel->"Out[100]//MatrixForm=",
 CellID->933478760,ExpressionUUID->"165cd216-c82d-40ce-95fc-03af301c4760"]
}, Open  ]],

Cell["\<\
We want to exchange the last two columns and rows simultaneously. This may be \
achieved by using the corresponding permutation matrix, which happens to be \
equivalent to the matrix representation of the CNOT gate in this case.\
\>", "TechNoteMathCaption",
 CellID->1663484699,ExpressionUUID->"3a6f03b9-80c7-4bdd-843e-b326ac54b492"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"P", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[101]:=",
 CellID->1579699414,ExpressionUUID->"63aaafe0-b157-4473-a7d1-4c333fca6eca"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{1}, {2}, {2}, {1}, {3}, {4}, {
       4}, {3}, {5}, {6}, {6}, {5}, {7}, {8}, {8}, {7}}}, {1, 0, 1, 0, 1, 0, 
      1, 0, 1, 0, 1, 0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[102]//MatrixForm=",
 CellID->1609477985,ExpressionUUID->"2d27f5da-050c-47ca-a069-b91db0e8d1c8"]
}, Open  ]],

Cell["\<\
Here is the resulting matrix after the simultaneous exchange of the last two \
columns and rows.\
\>", "TechNoteMathCaption",
 CellID->591924919,ExpressionUUID->"dc569704-b98f-4019-99c0-df18e6218ba1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"P", ".", "mat", ".", 
    RowBox[{"Topple", "[", "P", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[103]:=",
 CellID->1560387399,ExpressionUUID->"db5e54b0-3715-4e67-b24d-632b14fd91f6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 12, 16, 20, 24}, {{1}, {2}, {1}, {2}, {3}, {4}, {
       3}, {4}, {5}, {6}, {7}, {8}, {5}, {6}, {7}, {8}, {7}, {8}, {5}, {6}, {
       7}, {8}, {5}, {6}}}, {
      1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, Rational[1, 2] 3^Rational[1, 2], 
       0, Rational[-1, 2], 1, 0, 0, 0, 0, Rational[1, 2] 3^Rational[1, 2], 0, 
       Rational[1, 2]}}]]]]], "Output",
 CellLabel->"Out[104]//MatrixForm=",
 CellID->792476283,ExpressionUUID->"d24d352f-a0a4-4f4c-ab70-271e7bea41c9"]
}, Open  ]],

Cell["\<\
The above matrix is nothing but a multi-control unitary operator with the \
first and third as the control qubits.\
\>", "TechNoteMathCaption",
 CellID->1391660944,ExpressionUUID->"b8d72864-2c40-4714-abbc-7b0165ded818"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], ",", 
     RowBox[{"Rotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "@", 
    RowBox[{"Matrix", "[", "op", "]"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[105]:=",
 CellID->1987632204,ExpressionUUID->"1504f7a7-8ed1-45f0-8523-5967ecf0e78e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[106]//MatrixForm=",
 CellID->455309687,ExpressionUUID->"435447a0-e0b7-466c-b76a-53c55f0155b8"]
}, Open  ]],

Cell["\<\
In summary, the two-level unitary matrix is equivalent to the following \
quantum circuit.\
\>", "TechNoteMathCaption",
 CellID->919087155,ExpressionUUID->"44c487cd-f05b-4200-b006-c915a41be4ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "op", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[107]:=",
 CellID->1230259461,ExpressionUUID->"44734f9f-5e4b-4e40-bd8a-97289b4845f4"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"R\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -1}, {3, -2}, {3, -3}}], 
     DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
     $CellContext`S[2, QuantumMob`Q3`$]]], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[107]=",
 CellID->905675148,ExpressionUUID->"75bcc073-9fe4-4889-8b79-2a91723e0220"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "-", "mat"}], "//", "Normal"}], "//",
    "Simplify"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[108]:=",
 CellID->833756916,ExpressionUUID->"cdb4114a-f9d7-4d4a-a1ef-8fcaabd65c07"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[108]//MatrixForm=",
 CellID->318122500,ExpressionUUID->"763036ff-4a41-43ad-83f2-0d12dc7332bf"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of Two-Level Unitary Matrices: Gray Code Sequence\
\>", "TechNoteSection",
 CellID->1829642645,ExpressionUUID->"98b3899b-63da-4ca5-ae47-f22f51d4fa9e"],

Cell[TextData[{
 "So far, the exchanges of columns and rows have been performed on an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " basis. An irritating issue is that every exchange of columns or rows \
cannot be carried out by a single multi-control NOT gate or a simple variant \
of it. Fortunately, however, one can achieve any desired exchange by \
combining a sequence of other exchanges that can be carried out by a \
multi-control NOT gate (or a simple variant)."
}], "TechNoteText",
 CellID->1649128141,ExpressionUUID->"2df74a7b-9d02-4e2b-870f-8e70c4a22a22"],

Cell["\<\
For example, suppose that we want to exchange the sixth and seventh columns \
and rows. Noting that these columns and rows in the matrix representation \
correspond to logical basis states |101\:27e9 and |110\:27e9, it is clear \
that the exchange cannot be fulfilled by a single multi-control NOT gate. \
However, it can be achieved by first exchanging the sixth and eighth columns \
and rows (respectively corresponding to logical basis states |101\:27e9 and \
|111\:27e9) and then the eighth and seventh columns and rows (respectively \
corresponding to |111\:27e9 and |110\:27e9). The first exchange can be \
carried out by the multi-control NOT gate with the first and third qubit as \
controls and the second qubit as target while the second exchange can be \
implemented by the multi-control NOT gate with the first two qubits as \
controls and the third qubit as target.\
\>", "TechNoteText",
 CellID->1472717605,ExpressionUUID->"b086bcf6-cf01-4613-82c5-49f373ea1b92"],

Cell["\<\
The key point is that each exchange must be between a pair of columns (and \
rows) corresponding to logical basis states that differ in only one qubit. \
For this purpose, a systematic and efficient way is to use the Gray code \
sequence. In terms of classical bits, it is a sequence of bit strings where \
any two successive strings are different only in one bit. As an example, the \
Gray code sequence from |010\:27e9 to |101\:27e9 is given by\
\>", "TechNoteText",
 CellID->68271913,ExpressionUUID->"07f2e0be-92e9-45ef-bf93-989eb116e7d1"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"010"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"110"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"111"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"101"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "537f4f24-13cd-4484-bae0-79db1ec66b3c"],
 "."
}], "TechNoteText",
 CellID->689774293,ExpressionUUID->"6f193101-825e-4633-adb5-9ce7db271db7"],

Cell["\<\
The first step in the above sequence corresponds to the NOT gate on the first \
qubit conditioned on the second qubit in |1\:27e9 and the third qubit in |0\
\:27e9, which is a simple variant of the multi-control NOT gate with the last \
two qubits as control and the first qubit as target\[LongDash]it just needs \
additional NOT gates on the third qubit before and after the multi-control \
NOT gate. The other steps can be carried out simply by multi-control NOT \
gates.\
\>", "TechNoteText",
 CellID->919815945,ExpressionUUID->"ee489860-0a2f-4a47-aa50-ebd4190ed572"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText",
 Editable->False,
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {
   "ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 FontColor->GrayLevel[0.85],
 CellID->488164175,ExpressionUUID->"aea3c068-56d3-482c-9782-99c94271c60d"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[109]:=",
 CellID->1037329788,ExpressionUUID->"44ace676-c757-4d34-a153-656aacf1ed80"],

Cell["\<\
For demonstration, let us consider a particular two-level unitary matrix on a \
three-qubit system. We want to implement it in terms of elementary quantum \
logic gates.\
\>", "TechNoteMathCaption",
 CellID->274114911,ExpressionUUID->"b15012a1-c107-4384-aa7e-a2687dee2eb7"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[110]:=",
 CellID->1129500570,ExpressionUUID->"8544ab62-0526-4780-a5ce-751f87333de6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TheRotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"U", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[111]:=",
 CellID->408162463,ExpressionUUID->"d015c72e-bca8-4e7c-96f6-eeb7777a5344"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], Rational[1, 2] 
       3^Rational[1, 2], Rational[1, 2]}}]]]]], "Output",
 CellLabel->"Out[112]//MatrixForm=",
 CellID->1598060117,ExpressionUUID->"a0da89f1-0997-4189-8ecb-2e24abdb9fd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"GivensRotation", "[", 
     RowBox[{"U", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"2", "^", "$n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[113]:=",
 CellID->140937410,ExpressionUUID->"dafc6369-6411-4591-8615-1c4f245daba9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 5, 7, 8, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {5}, {4}, {
       6}, {7}, {8}}}, {
      1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1, 1, 
       1}}]]]]], "Output",
 CellLabel->"Out[116]//MatrixForm=",
 CellID->18413390,ExpressionUUID->"3ea30f95-2ca9-4268-b539-3aeabc11d6d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}], "//", "Elaborate"}]}]], "Input",
 CellLabel->"In[117]:=",
 CellID->1202374181,ExpressionUUID->"c28f208f-3e6a-4ace-bb96-fa1c6a6f5f33"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}]}]], "Output",
 CellLabel->"Out[117]=",
 CellID->236200562,ExpressionUUID->"c0480052-dfd8-46d5-92ab-be4d54d077ec"]
}, Open  ]],

Cell[TextData[{
 "Our implementation is based on the Gray code sequence. Notice the function ",
 StyleBox["Reverse", "Input"],
 "."
}], "TechNoteMathCaption",
 CellID->671324729,ExpressionUUID->"c5086e79-5652-492f-8d79-a9fa1f33649d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Unfold", "@", 
   RowBox[{"GivensRotation", "[", 
    RowBox[{"U", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", "SS"}], "]"}]}]}]], "Input",
 CellLabel->"In[118]:=",
 CellID->1879517453,ExpressionUUID->"f125e2ba-261c-480d-803f-f4aff248c345"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
     LineBox[{{1, -2}, {1, -3}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     DiskBox[{1, -3}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{3, -2}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
         5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->262.8,
   PlotRange->{{0, 6}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 0}, 
    Rational[1, 2] 3^Rational[1, 2] + Complex[0, 
       Rational[1, 2]] $CellContext`S[3, 2], "Label" -> "U"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[118]=",
 CellID->1273065878,ExpressionUUID->"d5b7580f-0c9c-4833-a85e-d0de64ced350"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Dot", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Matrix", "[", 
          RowBox[{"#", ",", "SS"}], "]"}], "&"}], "/@", 
        RowBox[{"Elaborate", "/@", "gates"}]}]}], "]"}], "//", "Normal"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[119]:=",
 CellID->1607904042,ExpressionUUID->"f798780e-e5e5-4af0-ac2d-5c8db11ab2ad"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[120]//MatrixForm=",
 CellID->1038636485,ExpressionUUID->"fecfccf4-900b-4094-bcfa-6f96e434b67d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", "gates"}]}]], "Input",
 CellLabel->"In[121]:=",
 CellID->1663700242,ExpressionUUID->"53187584-3115-405b-82df-27581e7a7203"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
     LineBox[{{1, -2}, {1, -3}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     DiskBox[{1, -3}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{3, -2}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
         5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->262.8,
   PlotRange->{{0, 6}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 0}, 
    Rational[1, 2] 3^Rational[1, 2] + Complex[0, 
       Rational[1, 2]] $CellContext`S[3, 2], "Label" -> "U"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[121]=",
 CellID->1616320579,ExpressionUUID->"3dec0594-d5f6-47fa-ac93-17d89ca80c36"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[122]:=",
 CellID->722239880,ExpressionUUID->"e9128caa-b619-41ad-9aed-9acd381ba131"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[123]//MatrixForm=",
 CellID->1979320350,ExpressionUUID->"139058f9-2f1d-4615-912c-b95e640266b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<V\>\""}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<PortSize\>\"", "->", "0.2"}]}], "]"}]], "Input",
 CellLabel->"In[124]:=",
 CellID->1008687980,ExpressionUUID->"e4a989d9-c679-4152-bd74-8bef14a23a3d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -1}, {3, -2}, {3, -3}}], 
     DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   ImagePadding->{{9.36, 9.36}, {7.2, 7.2}},
   ImageSize->158.4,
   PlotRange->{{0, 4}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 1], "Label" -> "V"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], "PortSize" -> 0.2]]], "Output",
 CellLabel->"Out[124]=",
 CellID->1915430420,ExpressionUUID->"7bb85ee0-a809-4028-995c-bf799022c123"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Universal Quantum Computation Theorem", "TechNoteSection",
 CellID->205503201,ExpressionUUID->"00971f4f-99f9-4a1c-b5e3-0e8531859337"],

Cell["\<\
We have seen that one can implement any unitary operation combining the CNOT \
and single-qubit gates. \
\>", "TechNoteText",
 CellID->608169919,ExpressionUUID->"c9e6dcbb-366a-4a9b-a121-a874a1a68359"],

Cell["\<\
A subtle issue is that single-qubit gates form a continuum of unitary \
operators. It is impractical to implement them to an infinite accuracy. \
Fortunately, it is known that a discrete set of gates is sufficient to \
perform universal quantum computation. The Hadamard, quadrant phase, octant \
phase, and CNOT gates form a universal set of gates in the sense that an \
arbitrary gate on n qubits can be approximated to arbitrary accuracy using a \
quantum circuit composed of only such gates.\
\>", "TechNoteText",
 CellID->1278444818,ExpressionUUID->"5fbd11af-64bf-4246-b834-8f3accbbe747"],

Cell["\<\
The quadrant phase gate is equal to the square of the octant phase, and it \
may sound redundant to include the quadrant phase. In the context of the \
universal set of elementary gates alone, it is certainly true. However, the \
quadrant phase gate is typically included in the universal set because it is \
required to fault-tolerantly implement the octant phase.\
\>", "TechNoteText",
 CellID->1089412868,ExpressionUUID->"ad9e9a34-cecb-453e-a848-928af9621a5f"],

Cell["\<\
It is also interesting to note that the set remains universal if octant phase \
gates are replaced with Toffoli gates.\
\>", "TechNoteText",
 CellID->123415854,ExpressionUUID->"c3ba4d3d-652b-4edb-a681-51a53757a6b2"]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]],
          "TutorialMoreAbout",ExpressionUUID->
         "ce9fec4d-49e7-4251-891f-8109d4e0e191"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"70800278-7c33-4f91-8e60-\
6a646da58f96"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "4f2f2042-d395-4c71-931f-36beb74f2cad"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "0160c969-6131-47c8-a83c-d6134344eb29"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"c351f49e-218a-43ba-adf6-\
3b158df25649"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "c9165d7f-04a6-43eb-b769-39520b4f4ccd"]}]],ExpressionUUID->
         "40d12b09-f4c0-4069-9b98-742d370c3dfa"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "fe153497-5d3b-47e3-98ba-3dfb5c363e91"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "11918101-6328-471f-babf-6297470557f5"]}]],ExpressionUUID->
         "08f1a831-4039-4f11-9368-0b828b5907d6"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "ae224c6b-115b-464e-8db0-c8c6d48103b2"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"7ed680e8-2467-4030-b8c8-\
48482681b1d4"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"1a9da584-0077-44be-b29c-b61de0dd6adb"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Universal Quantum Computation",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2021", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 10, 14, 30, 24.507601}", 
    "history" -> {"13", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {"universal quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Tech Note", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3", "status" -> "None", "summary" -> 
    "In classical computation, it is known that a finite set of logic \
gates\\[LongDash]typically including AND, OR, and NOT\\[LongDash]is \
sufficient to calculate any binary function. The set is said to be universal \
for classical computation. Does there exist a universal set of elementary \
quantum logic gates for quantum computation that enables to implement any \
arbitrary quantum unitary operation? See also Section 2.4 of the Quantum \
Workbook (2022). Suppose that we want to implement an arbitrary unitary \
operation U on an n-qubit register. We start by decomposing U into a set of \
two-level unitary transformations T_k, that is,", "synonyms" -> {}, 
    "tabletags" -> {}, "title" -> "Universal Quantum Computation", 
    "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "Universal Quantum Computation", "type" -> "Tech Note", "uri" -> 
    "QuantumMob/Q3/tutorial/UniversalQuantumComputation"}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"cdfec8b4-82b8-44c2-99ac-807d0dee53a6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "RasterizedOutput"->{
  Cell[21772, 577, 6419, 117, 70, "Output",ExpressionUUID->"8b79a35f-1f8b-4be3-b0a2-85334c79f573",
   CellTags->"RasterizedOutput",
   CellID->620797874]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"RasterizedOutput", 102724, 2613}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[597, 21, 6678, 164, 70, "AnchorBarGrid",ExpressionUUID->"c17208a9-833f-4963-a002-5a929101745f",
 CellID->1],
Cell[CellGroupData[{
Cell[7300, 189, 130, 1, 70, "TechNoteTitle",ExpressionUUID->"ecfb7b7b-a3f6-482a-ada1-278b5e75fac7",
 CellID->1902776493],
Cell[7433, 192, 4089, 92, 70, "TechNoteJumpBox",ExpressionUUID->"fa951ce3-cd0a-4733-90eb-85be3bf231de"],
Cell[11525, 286, 510, 8, 70, "TechNoteText",ExpressionUUID->"84f3faf3-7fac-4b96-9f9e-1c1088755a1a",
 CellID->1061332761],
Cell[12038, 296, 391, 12, 70, "TechNoteText",ExpressionUUID->"ae185261-739f-44bc-bb00-1926034badc5",
 CellID->1308734266],
Cell[12432, 310, 872, 21, 70, "DefinitionBox",ExpressionUUID->"bd016352-3a0a-4e51-b01f-de0a3aab8fd7",
 CellID->472512640],
Cell[13307, 333, 176, 3, 70, "TechNoteCaption",ExpressionUUID->"dc24c5d1-afb1-4c41-8766-58960349f3db",
 CellID->125413874],
Cell[13486, 338, 328, 7, 70, "TechNoteMathCaption",ExpressionUUID->"ab7d658d-5596-436d-9407-472a6cb6e1e6",
 CellID->1428640008],
Cell[13817, 347, 178, 3, 70, "Input",ExpressionUUID->"89685448-5de1-4f86-8ee8-a6459aec4983",
 CellID->853967906],
Cell[CellGroupData[{
Cell[14020, 354, 148, 1, 70, "TechNoteSection",ExpressionUUID->"4b674737-ebe1-40a4-b8ac-7a61b49366d8",
 CellID->1255432361],
Cell[14171, 357, 762, 20, 70, "TechNoteText",ExpressionUUID->"ec7ea86a-8a06-415d-baf8-1b6df9fbf61b",
 CellID->2093541217],
Cell[14936, 379, 381, 12, 70, "TechNoteText",ExpressionUUID->"7aedf952-6152-490d-9d04-137b5ecc907a",
 CellID->330293091],
Cell[15320, 393, 1206, 28, 70, "TechNoteText",ExpressionUUID->"46cc9fef-fe1b-476b-aeeb-489b1e86368a",
 CellID->2138236589],
Cell[16529, 423, 447, 12, 70, "TechNoteText",ExpressionUUID->"c4dbd1a3-1260-4b68-985f-b2681d0c4caa",
 CellID->1351002425],
Cell[16979, 437, 265, 7, 70, "TechNoteText",ExpressionUUID->"ec98d8a1-136e-491b-a755-98e6ece62c0e",
 CellID->953157244],
Cell[17247, 446, 382, 12, 70, "TechNoteText",ExpressionUUID->"78b6e818-d38d-4e89-b242-3a3df1996fcd",
 CellID->1633276935],
Cell[17632, 460, 111, 1, 70, "TechNoteText",ExpressionUUID->"e157fa3d-d552-410b-8512-ab0c44407d3b",
 CellID->1349470591],
Cell[CellGroupData[{
Cell[17768, 465, 522, 11, 70, "TechNoteText",ExpressionUUID->"c117c6c6-0a92-430e-b872-c6cba80dd22c",
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {"ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 CellID->2035887808],
Cell[18293, 478, 201, 4, 70, "TechNoteText",ExpressionUUID->"47d31ae5-f82f-44f5-8cd2-55ed544264a4",
 CellID->1917505328],
Cell[18497, 484, 178, 3, 70, "Input",ExpressionUUID->"814fd70e-0df5-4005-a2a4-cec5ac7fc635",
 CellID->591242595],
Cell[18678, 489, 182, 4, 70, "Input",ExpressionUUID->"fad56d37-c3d8-46f2-8aba-278381462e66",
 CellID->607459496],
Cell[CellGroupData[{
Cell[18885, 497, 647, 19, 70, "Input",ExpressionUUID->"b8a7b957-5fc0-4f95-96f4-7ae4d6ac7a24",
 CellID->86358426],
Cell[19535, 518, 1760, 40, 70, "Output",ExpressionUUID->"58f25879-49c7-437c-8aaf-1e64b2131347",
 CellID->2141573666]
}, Open  ]],
Cell[CellGroupData[{
Cell[21332, 563, 437, 12, 70, "Input",ExpressionUUID->"675e65f8-5480-4651-bfa6-208e80c25ebf",
 CellID->1264688223],
Cell[21772, 577, 6419, 117, 70, "Output",ExpressionUUID->"8b79a35f-1f8b-4be3-b0a2-85334c79f573",
 CellTags->"RasterizedOutput",
 CellID->620797874]
}, Open  ]],
Cell[28206, 697, 236, 6, 70, "Input",ExpressionUUID->"1b679a26-c2ba-4def-942d-32dce6f9ee19",
 CellID->104214177],
Cell[CellGroupData[{
Cell[28467, 707, 295, 8, 70, "Input",ExpressionUUID->"0042280d-9310-4fca-a552-6f4f12f14da0",
 CellID->1514570623],
Cell[28765, 717, 6021, 136, 70, "Output",ExpressionUUID->"c6282849-7b0b-4870-9d4b-57bbbedda946",
 CellID->367846473]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34847, 860, 153, 1, 70, "TechNoteSection",ExpressionUUID->"71e00a61-a753-4c7e-9e98-b6fda3981015",
 CellID->1012467270],
Cell[35003, 863, 395, 8, 70, "TechNoteText",ExpressionUUID->"4f83efb3-283b-4987-a1ee-6fb615fcfa50",
 CellID->1580628084],
Cell[35401, 873, 642, 19, 70, "TechNoteText",ExpressionUUID->"6b25993a-84c7-4696-b12a-163e78b95ba2",
 CellID->1243494398],
Cell[36046, 894, 133, 1, 70, "TechNoteText",ExpressionUUID->"e8433b11-4cc9-4758-b81f-56939f56fb3a",
 CellID->99494582],
Cell[36182, 897, 1503, 40, 70, "TechNoteText",ExpressionUUID->"8d54056c-f9de-4079-89ab-bb75808eaa60",
 CellID->1463162308],
Cell[37688, 939, 267, 6, 70, "TechNoteText",ExpressionUUID->"fcd9088a-7487-4464-b57e-7a9f59535818",
 CellID->533668759],
Cell[37958, 947, 459, 16, 70, "TechNoteText",ExpressionUUID->"3b97e191-3725-4bb7-a7de-e6771d8cc507",
 CellID->1479122641],
Cell[38420, 965, 228, 4, 70, "TechNoteText",ExpressionUUID->"e807dab0-9872-48a7-8bad-29a3c1aec7f4",
 CellID->343529615],
Cell[38651, 971, 2079, 55, 70, "TechNoteText",ExpressionUUID->"41816679-e3d5-4d5c-b896-bb10d938f117",
 CellID->1266196169],
Cell[40733, 1028, 466, 9, 70, "TechNoteText",ExpressionUUID->"dfe61083-1a75-4cc3-9a18-11f523ef4428",
 CellID->1543554260],
Cell[41202, 1039, 464, 7, 70, "TechNoteText",ExpressionUUID->"f3d7f1fb-7cb5-46bc-940a-d894112f6d5f",
 CellID->913992060],
Cell[41669, 1048, 643, 10, 70, "TechNoteText",ExpressionUUID->"e5ebf77c-6cd7-4019-92c8-f061fefd4778",
 CellID->514025429],
Cell[42315, 1060, 324, 7, 70, "TechNoteText",ExpressionUUID->"3a4fdbcb-9ff3-4e2d-9993-632c48558e1e",
 CellID->2046156969],
Cell[42642, 1069, 814, 22, 70, "TechNoteText",ExpressionUUID->"c2f582ca-9863-4cd2-b900-217a57d4c994",
 CellID->2104538572],
Cell[43459, 1093, 795, 14, 70, "TechNoteText",ExpressionUUID->"390fbe96-3045-467e-8dc6-9856b95c554f",
 CellID->1924113514],
Cell[44257, 1109, 1552, 36, 70, "TechNoteText",ExpressionUUID->"09a9d0a9-7b3a-415d-aef1-ea738e10f82f",
 CellID->1767073272],
Cell[CellGroupData[{
Cell[45834, 1149, 522, 11, 70, "TechNoteText",ExpressionUUID->"288d7077-0f81-45bf-8066-3314fb346358",
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {"ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 CellID->2099512760],
Cell[46359, 1162, 179, 3, 70, "Input",ExpressionUUID->"2712345a-14a5-4cca-b262-3552e3211c36",
 CellID->1940070093],
Cell[46541, 1167, 166, 2, 70, "TechNoteMathCaption",ExpressionUUID->"503bfb44-25a7-4ce5-92b7-17539c188d15",
 CellID->826895218],
Cell[46710, 1171, 182, 4, 70, "Input",ExpressionUUID->"ef2ba5f0-a4d8-406d-9665-f451e45fa568",
 CellID->651125270],
Cell[46895, 1177, 502, 13, 70, "TechNoteMathCaption",ExpressionUUID->"c5571520-7b22-4b8a-9d99-121c44379250",
 CellID->735486019],
Cell[CellGroupData[{
Cell[47422, 1194, 403, 11, 70, "Input",ExpressionUUID->"e0b8e09d-c7af-4184-a266-52a72142de42",
 CellID->880800639],
Cell[47828, 1207, 5042, 112, 70, "Output",ExpressionUUID->"399f6900-56d2-405e-8aef-10b4f020b0ac",
 CellID->1937735645]
}, Open  ]],
Cell[52885, 1322, 183, 3, 70, "TechNoteMathCaption",ExpressionUUID->"149d7078-ecb6-4c2e-bea3-86d7858d7288",
 CellID->1465223655],
Cell[CellGroupData[{
Cell[53093, 1329, 264, 6, 70, "Input",ExpressionUUID->"8e171931-20e3-4a02-a4a2-8f00827d3d9a",
 CellID->2100283434],
Cell[53360, 1337, 1362, 36, 70, "Output",ExpressionUUID->"165cd216-c82d-40ce-95fc-03af301c4760",
 CellID->933478760]
}, Open  ]],
Cell[54737, 1376, 343, 5, 70, "TechNoteMathCaption",ExpressionUUID->"3a6f03b9-80c7-4bdd-843e-b326ac54b492",
 CellID->1663484699],
Cell[CellGroupData[{
Cell[55105, 1385, 439, 12, 70, "Input",ExpressionUUID->"63aaafe0-b157-4473-a7d1-4c333fca6eca",
 CellID->1579699414],
Cell[55547, 1399, 1162, 28, 70, "Output",ExpressionUUID->"2d27f5da-050c-47ca-a069-b91db0e8d1c8",
 CellID->1609477985]
}, Open  ]],
Cell[56724, 1430, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"dc569704-b98f-4019-99c0-df18e6218ba1",
 CellID->591924919],
Cell[CellGroupData[{
Cell[56959, 1438, 305, 7, 70, "Input",ExpressionUUID->"db5e54b0-3715-4e67-b24d-632b14fd91f6",
 CellID->1560387399],
Cell[57267, 1447, 1493, 38, 70, "Output",ExpressionUUID->"d24d352f-a0a4-4f4c-ab70-271e7bea41c9",
 CellID->792476283]
}, Open  ]],
Cell[58775, 1488, 229, 4, 70, "TechNoteMathCaption",ExpressionUUID->"b8d72864-2c40-4714-abbc-7b0165ded818",
 CellID->1391660944],
Cell[CellGroupData[{
Cell[59029, 1496, 634, 19, 70, "Input",ExpressionUUID->"1504f7a7-8ed1-45f0-8523-5967ecf0e78e",
 CellID->1987632204],
Cell[59666, 1517, 1093, 30, 70, "Output",ExpressionUUID->"435447a0-e0b7-466c-b76a-53c55f0155b8",
 CellID->455309687]
}, Open  ]],
Cell[60774, 1550, 204, 4, 70, "TechNoteMathCaption",ExpressionUUID->"44c487cd-f05b-4200-b006-c915a41be4ec",
 CellID->919087155],
Cell[CellGroupData[{
Cell[61003, 1558, 577, 17, 70, "Input",ExpressionUUID->"44734f9f-5e4b-4e40-bd8a-97289b4845f4",
 CellID->1230259461],
Cell[61583, 1577, 2106, 42, 70, "Output",ExpressionUUID->"75bcc073-9fe4-4889-8b79-2a91723e0220",
 CellID->905675148]
}, Open  ]],
Cell[CellGroupData[{
Cell[63726, 1624, 288, 8, 70, "Input",ExpressionUUID->"cdb4114a-f9d7-4d4a-a1ef-8fcaabd65c07",
 CellID->833756916],
Cell[64017, 1634, 936, 23, 70, "Output",ExpressionUUID->"763036ff-4a41-43ad-83f2-0d12dc7332bf",
 CellID->318122500]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65014, 1664, 175, 3, 70, "TechNoteSection",ExpressionUUID->"98b3899b-63da-4ca5-ae47-f22f51d4fa9e",
 CellID->1829642645],
Cell[65192, 1669, 570, 10, 70, "TechNoteText",ExpressionUUID->"2df74a7b-9d02-4e2b-870f-8e70c4a22a22",
 CellID->1649128141],
Cell[65765, 1681, 986, 14, 70, "TechNoteText",ExpressionUUID->"b086bcf6-cf01-4613-82c5-49f373ea1b92",
 CellID->1472717605],
Cell[66754, 1697, 552, 8, 70, "TechNoteText",ExpressionUUID->"07f2e0be-92e9-45ef-bf93-989eb116e7d1",
 CellID->68271913],
Cell[67309, 1707, 446, 16, 70, "TechNoteText",ExpressionUUID->"6f193101-825e-4633-adb5-9ce7db271db7",
 CellID->689774293],
Cell[67758, 1725, 580, 9, 70, "TechNoteText",ExpressionUUID->"ee489860-0a2f-4a47-aa50-ebd4190ed572",
 CellID->919815945],
Cell[CellGroupData[{
Cell[68363, 1738, 521, 11, 70, "TechNoteText",ExpressionUUID->"aea3c068-56d3-482c-9782-99c94271c60d",
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {"ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 CellID->488164175],
Cell[68887, 1751, 180, 3, 70, "Input",ExpressionUUID->"44ace676-c757-4d34-a153-656aacf1ed80",
 CellID->1037329788],
Cell[69070, 1756, 283, 5, 70, "TechNoteMathCaption",ExpressionUUID->"b15012a1-c107-4384-aa7e-a2687dee2eb7",
 CellID->274114911],
Cell[69356, 1763, 184, 4, 70, "Input",ExpressionUUID->"8544ab62-0526-4780-a5ce-751f87333de6",
 CellID->1129500570],
Cell[CellGroupData[{
Cell[69565, 1771, 320, 8, 70, "Input",ExpressionUUID->"d015c72e-bca8-4e7c-96f6-eeb7777a5344",
 CellID->408162463],
Cell[69888, 1781, 946, 29, 70, "Output",ExpressionUUID->"a0da89f1-0997-4189-8ecb-2e24abdb9fd9",
 CellID->1598060117]
}, Open  ]],
Cell[CellGroupData[{
Cell[70871, 1815, 652, 18, 70, "Input",ExpressionUUID->"dafc6369-6411-4591-8615-1c4f245daba9",
 CellID->140937410],
Cell[71526, 1835, 1369, 37, 70, "Output",ExpressionUUID->"3ea30f95-2ca9-4268-b539-3aeabc11d6d0",
 CellID->18413390]
}, Open  ]],
Cell[CellGroupData[{
Cell[72932, 1877, 252, 6, 70, "Input",ExpressionUUID->"c28f208f-3e6a-4ace-bb96-fa1c6a6f5f33",
 CellID->1202374181],
Cell[73187, 1885, 7893, 193, 70, "Output",ExpressionUUID->"c0480052-dfd8-46d5-92ab-be4d54d077ec",
 CellID->236200562]
}, Open  ]],
Cell[81095, 2081, 233, 5, 70, "TechNoteMathCaption",ExpressionUUID->"c5086e79-5652-492f-8d79-a9fa1f33649d",
 CellID->671324729],
Cell[CellGroupData[{
Cell[81353, 2090, 313, 8, 70, "Input",ExpressionUUID->"f125e2ba-261c-480d-803f-f4aff248c345",
 CellID->1879517453],
Cell[81669, 2100, 3024, 56, 70, "Output",ExpressionUUID->"d5b7580f-0c9c-4833-a85e-d0de64ced350",
 CellID->1273065878]
}, Open  ]],
Cell[CellGroupData[{
Cell[84730, 2161, 533, 15, 70, "Input",ExpressionUUID->"f798780e-e5e5-4af0-ac2d-5c8db11ab2ad",
 CellID->1607904042],
Cell[85266, 2178, 1094, 30, 70, "Output",ExpressionUUID->"fecfccf4-900b-4094-bcfa-6f96e434b67d",
 CellID->1038636485]
}, Open  ]],
Cell[CellGroupData[{
Cell[86397, 2213, 192, 4, 70, "Input",ExpressionUUID->"53187584-3115-405b-82df-27581e7a7203",
 CellID->1663700242],
Cell[86592, 2219, 3024, 56, 70, "Output",ExpressionUUID->"3dec0594-d5f6-47fa-ac93-17d89ca80c36",
 CellID->1616320579]
}, Open  ]],
Cell[CellGroupData[{
Cell[89653, 2280, 338, 9, 70, "Input",ExpressionUUID->"e9128caa-b619-41ad-9aed-9acd381ba131",
 CellID->722239880],
Cell[89994, 2291, 1094, 30, 70, "Output",ExpressionUUID->"139058f9-2f1d-4615-912c-b95e640266b4",
 CellID->1979320350]
}, Open  ]],
Cell[CellGroupData[{
Cell[91125, 2326, 877, 25, 70, "Input",ExpressionUUID->"e4a989d9-c679-4152-bd74-8bef14a23a3d",
 CellID->1008687980],
Cell[92005, 2353, 2017, 40, 70, "Output",ExpressionUUID->"7bb85ee0-a809-4028-995c-bf799022c123",
 CellID->1915430420]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94083, 2400, 139, 1, 70, "TechNoteSection",ExpressionUUID->"00971f4f-99f9-4a1c-b5e3-0e8531859337",
 CellID->205503201],
Cell[94225, 2403, 210, 4, 70, "TechNoteText",ExpressionUUID->"c9e6dcbb-366a-4a9b-a121-a874a1a68359",
 CellID->608169919],
Cell[94438, 2409, 603, 9, 70, "TechNoteText",ExpressionUUID->"5fbd11af-64bf-4246-b834-8f3accbbe747",
 CellID->1278444818],
Cell[95044, 2420, 473, 7, 70, "TechNoteText",ExpressionUUID->"ad9e9a34-cecb-453e-a848-928af9621a5f",
 CellID->1089412868],
Cell[95520, 2429, 225, 4, 70, "TechNoteText",ExpressionUUID->"c3ba4d3d-652b-4edb-a681-51a53757a6b2",
 CellID->123415854]
}, Open  ]],
Cell[95760, 2436, 741, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"70800278-7c33-4f91-8e60-6a646da58f96"],
Cell[96504, 2456, 1138, 30, 70, "RelatedTutorialsSection",ExpressionUUID->"c351f49e-218a-43ba-adf6-3b158df25649"],
Cell[97645, 2488, 2152, 60, 70, "TutorialRelatedLinksSection",ExpressionUUID->"7ed680e8-2467-4030-b8c8-48482681b1d4"]
}, Open  ]],
Cell[99812, 2551, 78, 0, 70, "FooterCell",ExpressionUUID->"1a9da584-0077-44be-b29c-b61de0dd6adb"]
}
]
*)

(* End of internal cache information *)
