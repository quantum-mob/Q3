(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    116873,       2887]
NotebookOptionsPosition[     99895,       2553]
NotebookOutlinePosition[    102984,       2625]
CellTagsIndexPosition[    102903,       2620]
WindowTitle->Universal Quantum Computation
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 TECH NOTE", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "7bd22d73-58f3-49e2-95ee-5cc1988ab881"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "6351e8ac-b2f7-4a34-8c3a-2fed3aea5eb4"],
        Background->LightDarkSwitched[
          RGBColor[
          0.3843137254901961, 0.4627450980392157, 0.7019607843137254]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Functions",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "d503a921-0ba5-469b-b14e-198aa3fbcf90"]
         }],ExpressionUUID->"9354ad38-64d6-452f-afeb-941d559e7266"],
         StripOnInput->False],{
        StyleBox["\"GivensFactor\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/GivensFactor"], 
         StyleBox[
          "\"GivensRotation\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/GivensRotation"]},
        
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialFunction"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "16ec229f-5013-4cf3-a731-c612b5bde02e"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "4c11b7dd-5078-4e71-9e9c-3ae3644b8029"]
         }],ExpressionUUID->"233df6ce-e340-4629-a4fe-afd26621b826"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"TutorialMoreAboutSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "0a804fee-c070-4c16-9f28-1c55e400d0fa"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "e5c836a3-c5f5-4587-ad08-cf1d97d9b60f"]
         }],ExpressionUUID->"56bc1aa9-8255-49a9-ab85-a2325d6a9802"],
         StripOnInput->False],{
        "\"Quantum Computation: Overview\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"RelatedTutorialsSection"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "9c3a0eff-8c57-4ac4-9009-913089e764c8"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "2f1d3357-44fb-4905-a417-4561d20d4337"]
         }],ExpressionUUID->"b2926f48-07eb-463e-affc-2016fb920753"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/tutorial/UniversalQuantumComputation\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard[
          "QuantumMob/Q3/tutorial/UniversalQuantumComputation"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/\
tutorial/UniversalQuantumComputation.html"], StandardForm]], "Input", 
                 TextClipboardType -> "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/tutorial/UniversalQuantumComputation") <> 
               ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "e94564a3-a9ca-41bb-bb43-cb51217beece"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "7bc6c11b-4af7-405c-a436-d7533fb8cc92"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"1a49e7fb-d5f8-42df-b70a-c77a98c74e0d"],

Cell[CellGroupData[{

Cell["Universal Quantum Computation", "TechNoteTitle",
 CellID->1902776493,ExpressionUUID->"9e286efb-5bdb-45c8-a87a-b65e1221e8d7"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell["Decomposition into Two-Level Unitary Matrices"], 
      "paclet:QuantumMob/Q3/tutorial/UniversalQuantumComputation#1255432361", 
      
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell[
      "Implementation of Two-Level Unitary Matrices: Gray Code Sequence"], 
      "paclet:QuantumMob/Q3/tutorial/UniversalQuantumComputation#1829642645", 
      
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]},
   {
    TemplateBox[{
      Cell["Implementation of Two-Level Unitary Matrices: Idea"], 
      "paclet:QuantumMob/Q3/tutorial/UniversalQuantumComputation#1012467270", 
      
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}], 
    TemplateBox[{
      Cell["Universal Quantum Computation Theorem"], 
      "paclet:QuantumMob/Q3/tutorial/UniversalQuantumComputation#205503201", 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.3843137254901961, 0.4627450980392157, 0.7019607843137254], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False], 
      StyleBox[
       GraphicsBox[{
         Thickness[0.18], 
         RGBColor[0.9686274509803922, 0.4666666666666667, 0.], 
         LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20, PlotRangePadding -> 
        Scaled[0.025]], Magnification -> 0.68 Inherited, StripOnInput -> 
       False]},
     "GrayLinkWithIcon",
     BaseStyle->{"TutorialJumpBoxLink"}]}
  }]], "TechNoteJumpBox",ExpressionUUID->"108706c5-7772-4221-a825-\
925312578124"],

Cell["\<\
In classical computation, it is known that a finite set of logic gates\
\[LongDash]typically including AND, OR, and NOT\[LongDash]is sufficient to \
calculate any binary function. The set is said to be universal for classical \
computation. Does there exist a universal set of elementary quantum logic \
gates for quantum computation that enables to implement any arbitrary quantum \
unitary operation?\
\>", "TechNoteText",
 CellID->1061332761,ExpressionUUID->"fc96ec10-5ab4-46ab-b1d5-9dece4ebc461"],

Cell[TextData[{
 "See also Section 2.4 of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Quantum Workbook (2022)"]], 
    "https://doi.org/10.1007/978-3-030-91214-7"},
   "WebLink",
   BaseStyle->{"TechNoteText"}]],ExpressionUUID->
  "1f843424-c636-4007-88e9-9ab763abbde9"],
 "."
}], "TechNoteText",
 CellID->1308734266,ExpressionUUID->"d914855e-180f-42c5-a01b-5b747aeb7a3a"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{
      Cell[
       TextData["GivensFactor"]], "paclet:QuantumMob/Q3/ref/GivensFactor", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell["\<\
Decomposes a unitary operator into a list of two-level unitary operators\
\>", "TechNoteTableText",ExpressionUUID->
     "2d6c9dcc-d73c-41f5-b889-eaec7e98913e"]},
   {
    TemplateBox[{
      Cell[
       TextData["GivensRotation"]], "paclet:QuantumMob/Q3/ref/GivensRotation",
       "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->{"DefinitionBox", CellFrame -> 0}], Cell[
    "Represents a two-level unitary operator", "TechNoteTableText",
     ExpressionUUID->"4ce8ee2e-856a-466b-b7b5-2325b289cedd"]}
  }]], "DefinitionBox",
 CellID->472512640,ExpressionUUID->"3a25a11a-0a9d-4d04-9a75-9c8c3b5271e5"],

Cell["\<\
Q3 functions related to the universal quantum computation theorem.\
\>", "TechNoteCaption",
 CellID->125413874,ExpressionUUID->"edf2023f-d994-4e00-b0af-8e4813099ca9"],

Cell[TextData[{
 "Make sure that the ",
 ButtonBox["Q3: Symbolic Quantum Simulation",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/guide/Q3"],
 " package is loaded to use the demonstrations in this documentation."
}], "TechNoteMathCaption",
 CellID->1428640008,ExpressionUUID->"008e4839-e4b9-40a9-86b7-e9bd9be044dd"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[85]:=",
 CellID->853967906,ExpressionUUID->"680265b1-bd07-41ad-9c15-0014b57e456a"],

Cell[CellGroupData[{

Cell["Decomposition into Two-Level Unitary Matrices", "TechNoteSection",
 CellID->1255432361,ExpressionUUID->"a0d2f6b3-7546-46a2-a8d0-1dc3c5c69e58"],

Cell[TextData[{
 "Suppose that we want to implement an arbitrary unitary operation ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "8ec2dd0d-6de3-45bb-badb-0c22d6e3101e"],
 " on an ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "8210db74-4271-4f2a-b3f5-cabebab99da7"],
 "-qubit register. We start by decomposing ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "b56915b0-0b51-42ec-bb9f-0947e5b60e77"],
 " into a set of two-level unitary transformations ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "k"], TraditionalForm]],ExpressionUUID->
  "0d7f7e50-49e6-4946-9e3b-6e602240a5da"],
 ", that is,"
}], "TechNoteText",
 CellID->2093541217,ExpressionUUID->"f0a2637d-dcdf-46e1-bac0-598c87397419"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["T", "L"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "b02ed693-37e2-416e-a538-3667afc5c639"],
 " ."
}], "TechNoteText",
 CellID->330293091,ExpressionUUID->"cf07244a-9d66-44c7-b42c-cdc26e3433d6"],

Cell[TextData[{
 "The procedure is detailed for arbitrary two-qubit unitary gates in ",
 ButtonBox["Two-Qubit Gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/TwoQubitGates#1476129218"],
 ". To summarize the procedure, first  remove the off-diagonal element ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["U", 
    RowBox[{"1", " ", "n"}]], TraditionalForm]],ExpressionUUID->
  "2aecd81b-941b-41ee-a98a-e46eba39a3d9"],
 " at the top-right corner of the matrix representation of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "62524bec-00e9-45bb-8e18-c90e47f08ce0"],
 " by multiplying ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "3c1ad652-b527-4e71-aff1-32e220cfc978"],
 " with a two-level unitary transformation ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["T", "1", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "9cccea69-d628-4f04-8121-8dc0c5c3eb6b"],
 " on the right, and repeat it along the top row and then the next \
consecutive rows to zero all off-diagonal elements and to set every diagonal \
element to unity, so that"
}], "TechNoteText",
 CellID->2138236589,ExpressionUUID->"ff19a7e4-9c68-4037-97af-e78d9a8c82f2"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubsuperscriptBox["T", "1", "\[Dagger]"], 
     SubsuperscriptBox["T", "2", "\[Dagger]"], "\[CenterEllipsis]", " ", 
     SubsuperscriptBox["T", "L", "\[Dagger]"]}], "=", "I"}], 
   TraditionalForm]],ExpressionUUID->"3a0fbd97-989e-4306-961a-d339d9404aac"],
 " ."
}], "TechNoteText",
 CellID->1351002425,ExpressionUUID->"8fa1a525-a907-44a7-bc2c-6fdb90fd96aa"],

Cell[TextData[{
 "The decomposition of ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],ExpressionUUID->
  "2e48902f-314c-4af3-9a0a-9386b87ab826"],
 " is then given by"
}], "TechNoteText",
 CellID->953157244,ExpressionUUID->"c2c6f59b-1a50-4c0a-a9ca-f7a6402444ba"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["T", "L"], "\[CenterEllipsis]", " ", 
     SubscriptBox["T", "2"], 
     SubscriptBox["T", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "f3ee8f36-45c5-42e0-8c5e-83930e822d67"],
 " ."
}], "TechNoteText",
 CellID->1633276935,ExpressionUUID->"cdcca543-8bef-4f88-a614-b4e3154144d4"],

Cell["as desired.", "TechNoteText",
 CellID->1349470591,ExpressionUUID->"c39ff85d-bdfd-43dc-b855-f924321bedd6"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText",
 Editable->False,
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {
   "ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 FontColor->GrayLevel[0.85],
 CellID->2035887808,ExpressionUUID->"fa779613-1c73-4776-80a5-099720fb372e"],

Cell["\<\
For demonstration, consider a three-qubit system, and an arbitrary unitary \
operation on it.\
\>", "TechNoteText",
 CellID->1917505328,ExpressionUUID->"e736ffdc-a5de-4331-b070-8b93429f70e5"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[86]:=",
 CellID->591242595,ExpressionUUID->"087c14f5-013d-4ccf-aeb1-c781d5ebb2f9"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[87]:=",
 CellID->607459496,ExpressionUUID->"f184b26c-afa4-4fe1-b687-9cec31f33401"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"2", "^", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "3"}], ",", 
     RowBox[{";;", "3"}]}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[88]:=",
 CellID->86358426,ExpressionUUID->"a2f3ca68-11f6-41a2-814a-5d0f8a5007ad"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.07609894894523883`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3306554198563423`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06969985768195544`"}], "-", 
       RowBox[{"0.15983662546001443`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5022868852106268`"}], "+", 
       RowBox[{"0.34458405905281997`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.24251794586347464`"}], "-", 
       RowBox[{"0.41989382272280984`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.05223424981769833`"}], "+", 
       RowBox[{"0.540668494100228`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.016709463496944667`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.07355591519407773`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.13824600133925813`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.17819062785183434`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.21535868733134403`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.17565403971434917`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.06055211120401516`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.04355356991296286`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[91]//MatrixForm=",
 CellID->2141573666,ExpressionUUID->"64489961-322a-45f4-b3d2-46d3721fdcc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"{", 
    RowBox[{"op", ",", 
     RowBox[{"\"\<Label\>\"", "\[Rule]", "\"\<U\>\""}]}], "}"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[92]:=",
 CellID->1264688223,ExpressionUUID->"42d81ff7-4d09-486d-8111-1c4ff4e2d500"],

Cell[BoxData[
 PaneSelectorBox[{"Light"->
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJzt3T2IFAkChmF/ThF/4AIRNPLAxEDBQLzAwMtcBIXVDcxmh5sbVsSDWfW4
cMBMUAQxUdHMwEAmEMFARRQHURFBEEwMhF7xDwVHHNS66YYuhLv7une6Zrt9
632gFtytrvJr3mJ3ptX9y/A/f/zHgnnz5v26ZOYvP/78r7+Njf38791/nvnB
Twd+/WX0wMjffzhwcGR0ZOyvwwtn/uZvM8ebmeNPM0chSZIkSZIkSZIkSZIk
SZIkSZIkSZIkSZIkSZIkSZIkSZKkWmv+kdW0Q6Lr9zPmcyv9fqTWSVukhNQ6
aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVukhNQ6
aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVukhNQ6
aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVs0GB4+
fFicO3du4A5S6+0t/X5POx1TU1P9fqvUpfHx8Tn//2v0chD0+z3s9mg0Gv1+
q9SliYmJYmhoaOAO4nPb7/e00/Hu3bt+v1X6zhGfW4mO1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUjIXrV+/fr3YuXNn6zh16lRXrxkaGipf8+HDh1nd1+dWdTEXrR86dKi8
7okTJzqe//Lly/L8NWvWzPq+Preqi7lofdu2beV179y50/H8K1eulOfv2rVr
1vf1uVVdVN36ly9fihUrVrSuuWjRouLjx48dXzM+Pl7+PI4cOTLre/vcqi6q
bv3x48flNTdt2tTVa3bs2FG+5urVq7O+t8+t6qLq1s+fP19ec3R0tKvXrFq1
qnzNmzdvZn1vn1vVRdWt79u3r7zmmTNnOp7/7Nmz8vx169b1dG+fW9VF1a1v
3ry5vOajR486nn/x4sXy/L179/Z0b59b1UWVrX/69KlYvHhx63pLly4tPn/+
3PE1335mdPz48Z7u73Orqk1NTbU+pxy0o8rW7969W15v69atXb3m28+Mbt26
1dP929fp93va6fj69WtPO/XH+fazjkE8qnDy5MnyemNjYx3P//Yzo4ULF876
10m19fs97PZoNBo97dQf5+jRo8XKlSsH7qjyuR0eHi6vd+HChY7nP3jwoDx/
48aNPd+/fa1+v6edjhcvXvS8VfVW5XPb/Ly2fb2nT592PP/YsWPl+fv37+/5
/n59q7qosvVly5a1rtX8dVLdfE9q+/bt5f0nJiZ6vr/Preqiqtab30tuX2v1
6tUdz29+brtgwYLW+UuWLCnev3/f88/B51Z1UWXrza9Rm9eaP39+8erVq/97
3vT0dOv367XvPTIyUsn9fW5VF1W2fvDgwfJ6zefyf/23cvOZbf6en/Z5zc95
nzx5Usn9fW5VF1W2fvv27da/a9vXXL9+fXH69OnW7+W7fPlycfjw4WLDhg3l
P29+PXzjxo1K7t3kc6u6qLr15veI21+3pmP58uXFzZs3K7tvk8+t6mIuWp+c
nCx2795drF279r+e1+b3mvfs2VPcv3+/0ns2+dyqLua69bdv3xbXrl0rLl26
VNy7d6/147nic6u6ILVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtUkJqnbRF
Skitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS66QtGgxnz54t
tmzZMnAHqfX2ln6/p52O169f9/utUpfGx8fLrgbxIOj3e9jt0Wg0+v1WqUvP
nz8vJicnB+4gPrf9fk87HdPT0/1+q/SdIz63Eh2pddIWKSG1TtoiJaTWSVuk
hNQ6aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVuk
hNQ6aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVuk
hNQ6aYuU9PvPJJ2LQ6Lr9zPmcytJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkvR9+g9pQeV4
     "], {{0, 116.}, {119., 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{144., 144.},
     RasterInterpolation->"High"],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{119., 116.},
   PlotRange->{{0, 119.}, {0, 116.}}], "Dark"->
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJzt3D9oVWkChnHZnWLKaRUVg1jEPwHRwkZlsNCNVrOsoAgycXUQNUFnUbcS
O72d2iqWprQTQVRQS7WxsLJWkPUPFirq2ZzAPZgZ5r0Bz+V8eXw++A3EOffG
9/BcEhPjyMTUL4f+tmjRot9/nPnPL7+e+vnEiV//+8+fZt741+Tvh3+bPPjv
f0z+5+BvB09smvj7zC8+n/G/GT/MWLx4cSVJkiRJkiRJkiRJkiRJkiRJkiRJ
kiRJkiRJkiRJkiRJkqTvF/F0fU+lYSOeru+pNGyk1klbpITUOmmLlJBaJ22R
ElLrpC1SQmqdtEVKSK2TtkgJqXXSFikhtU7aIiWk1klbpITUOmmLlJBaJ22R
ElLrpC1SQmqdtEVKSK2TtkgJqXXSFikhtU7aIiWk1klbpITUOmmLlJBaJ22R
ElLrpC1SQmqdtEVKSK2TtkgJqXXSFikhtU7aIiWk1klbVIZt27ZVU1NTxSG1
3j9d39NBRkZGOr9Xmp9er1eVfLq+P21YKGdsbKzze6X52b9/fzU9PV2c/un6
/rShf7q+p4OsWrWq83ulhY34uu369yENG6l10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dpp
i5SQWidtkRJS66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6RkGK1f
uHCh+vjx46y7d+8OvH50dLT68OFD85jt27cXs0Uq0TBav3fvXvO8ly9fHnj9
nj17mus/f/5crVy5spgtUomG0frbt2+b5z169OjA68+dO9dc//Tp06K2SCVq
u/XNmzdXX5/67UGPuXnzZnP99PR0MVukUrXd+rFjx5rnfPPmzbwe8+LFi+Yx
p0+fLmaLVKq2W79y5UrznPWfcwddv2HDhjkfn3fs2FHMFqlUbbf+6NGj5jkv
Xrw48PoDBw4019dfU16+fHkxW6RStdl6/Zp7//5985wTExMDH3Pp0qXm+seP
HxezRSpZm63X33f9+tSfAw96zP3795vrr169WswWqTYyMlKtWbOmOG22furU
qeb56q81Dbp+yZIlc75nNDU19U3vv3+6vqeDdN2i5q/X61UlnzY2Xrt2rXm+
+ns7g67fsmXLnN9D/fa3vP+FcsbGxjrvUfNz9uzZ6uXLl8XpnzY2PnnypHm+
8+fPD7z+5MmTzfXv3r2b/fj7Le+/f7q+p4OsXbu28x61sLX1uq2/JlX/3eL+
2bt378DHXL9+vbn+9u3bxWyRStdW6xs3bpzzueCmTZvi9StWrKhevXrVXH/m
zJlitkila6v1rVu3znndrl69Ol4/OTk55/pv/bNtm1uk0rXV+tKlS+d8bfjQ
oUN/eW39/aKvP9Y+ePCgqC1S6dps/caNG83z1a/LXbt2/emanTt3Vq9fv26u
q39ub/fu3cVtkUrWZuv1z+z98dy5c2f270TV3yN69uzZnP/36dOn6siRI0Vu
kUrWdutf/1xBOvVr9vDhw0VvkUo1jNb37dtX3bp1q3r+/PmfXq9fvnyZ/bdr
2vrceNhbpBINu/V169bN/js09c/9jI+PD/Xv+fm61feC1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7ZICal10hYpIbVO2iIlpNZJW6SE1Dppi5SQWidtkRJS
66QtUkJqnbRFSkitk7aoDMePH68ePnxYHFLr/dP1PR1kdHS083ul+en1elXJ
p+v704aFcsbGxjq/V5qf9evXV+Pj48Xpn67vTxv6p+t7OsiyZcs6v1da2Iiv
265/H9KwkVonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVuk
hNQ6aYuUkFonbZESUuukLVJCap20RUpIrZO2SAmpddIWKSG1TtoiJaTWSVuk
hNQ6aYuUkFonbZESUuukLVJCap20RUpIrZO2SAnxdH1PpWEjnq7vqSRJkiRJ
kiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJ0vfg/w89UFQ=
     "], {{0, 116.}, {119., 0}}, {0, 255},
     ColorFunction->RGBColor,
     ImageResolution->{144., 144.},
     RasterInterpolation->"High"],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{119., 116.},
   PlotRange->{{0, 119.}, {0, 116.}}]}, Dynamic[
   AbsoluteCurrentValue[LightDark]]]], "Output",
 CellTags->"RasterizedOutput",
 CellLabel->"Out[93]=",
 CellID->1314282832,ExpressionUUID->"d00e933b-6a95-4143-b14e-80cc007c481a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"twl", "=", 
   RowBox[{"GivensFactor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}]}], ";"}]], "Input",
 CellLabel->"In[94]:=",
 CellID->104214177,ExpressionUUID->"a59a2617-250e-4c44-89a1-837bb9111570"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Chop", "@", 
   RowBox[{"Matrix", "@", 
    RowBox[{"twl", "[", 
     RowBox[{"[", 
      RowBox[{";;", "3"}], "]"}], "]"}]}]}]}]], "Input",
 CellLabel->"In[95]:=",
 CellID->1514570623,ExpressionUUID->"6ef460f4-6421-4364-ba6b-c263b23bdcbc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0", 
        "0", "0", "0", "0", "0"},
       {"0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0", 
        "0", "0", "0", "0"},
       {"0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0", 
        "0", "0", "0"},
       {"0", "0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0", 
        "0", "0"},
       {"0", "0", "0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0", 
        "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "0", "0", "0", "0", 
        RowBox[{"0.954996662317417`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.29661654532846454`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 6, 7, 8}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         8}}}, {Complex[0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`], Complex[
        0.954996662317417, -0.29661654532846454`]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1.`", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1.`", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1.`", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1.`", "0", "0", "0"},
       {"0", "0", "0", "0", "0", "1.`", "0", "0"},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.29777433264956565`"}], "-", 
         RowBox[{"0.3826408706938628`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.6484396246289845`"}], "+", 
         RowBox[{"0.58689220824677`", " ", "\[ImaginaryI]"}]}]},
       {"0", "0", "0", "0", "0", "0", 
        RowBox[{"0.6484396246289845`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.58689220824677`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.29777433264956565`"}], "+", 
         RowBox[{"0.3826408706938628`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 6, 8, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         8}, {7}, {8}}}, {
        1., 1., 1., 1., 1., 1., 
         Complex[-0.29777433264956565`, -0.3826408706938628], 
         Complex[-0.6484396246289845, 0.58689220824677], Complex[
         0.6484396246289845, 0.58689220824677], 
         Complex[-0.29777433264956565`, 0.3826408706938628]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1.`", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1.`", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1.`", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1.`", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1.`", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{
         RowBox[{"-", "0.21629434873804554`"}], "+", 
         RowBox[{"0.07259508122558458`", " ", "\[ImaginaryI]"}]}], 
        "0.9736255485995813`", "0"},
       {"0", "0", "0", "0", "0", 
        RowBox[{"-", "0.9736255485995813`"}], 
        RowBox[{
         RowBox[{"-", "0.21629434873804554`"}], "-", 
         RowBox[{"0.07259508122558458`", " ", "\[ImaginaryI]"}]}], "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1.`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {8, 8}, 0, {
       1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
         6}, {7}, {8}}}, {
        1., 1., 1., 1., 1., 
         Complex[-0.21629434873804554`, 0.07259508122558458], 
         0.9736255485995813, -0.9736255485995813, 
         Complex[-0.21629434873804554`, -0.07259508122558458], 1.}}]]]]}], 
  "}"}]], "Output",
 CellLabel->"Out[95]=",
 CellID->367846473,ExpressionUUID->"bec87a22-93b3-4cef-9ab9-a9ff59b83d26"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation of Two-Level Unitary Matrices: Idea", "TechNoteSection",
 CellID->1012467270,ExpressionUUID->"b995f5d9-1c7f-4f76-a06d-b39094289d5d"],

Cell[TextData[{
 "Some two-level unitary transformations are themselves ",
 ButtonBox["multi-control unitary gates",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/MultiControlUnitaryGates"],
 ", which can be implemented in terms of elementary gates. The most common \
example is"
}], "TechNoteText",
 CellID->1580628084,ExpressionUUID->"1940c739-7779-4d59-997d-3500f38e66f1"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0"},
      {"0", "0", "\[DescendingEllipsis]", "\[VerticalEllipsis]", 
       "\[VerticalEllipsis]"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["U", "11"], 
       SubscriptBox["U", "12"]},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["U", "21"], 
       SubscriptBox["U", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "a29fdb98-8d10-48bd-8b29-12a389367c54"],
 " ."
}], "TechNoteText",
 CellID->1243494398,ExpressionUUID->"ebb23028-1301-4242-bb63-cc1be683fa41"],

Cell["On three qubits, another example is", "TechNoteText",
 CellID->99494582,ExpressionUUID->"062d444a-6e56-4617-ae9f-a0a2d8f92911"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0", "0"},
      {"0", "0", "\[DescendingEllipsis]", "\[VerticalEllipsis]", 
       "\[VerticalEllipsis]", "\[VerticalEllipsis]"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["V", "11"], "0", 
       SubscriptBox["V", "12"]},
      {"0", "0", "\[CenterEllipsis]", "0", "1", "0"},
      {"0", "0", "\[CenterEllipsis]", 
       SubscriptBox["V", "21"], "0", 
       SubscriptBox["V", "22"]}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "040e1d3f-a04d-40fb-97a9-050885746967"],
 "     \[DotEqual] ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     LineBox[{{1, -1}, {1, -3}, {1, -2}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -2.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1, -2}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->86.39999999999999,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "7bfcb98d-e906-47e7-9e8a-a74d393f823a"],
 ","
}], "TechNoteText",
 CellID->1463162308,ExpressionUUID->"12c5ec5a-c0b6-4447-b4a0-42d76b59d8b3"],

Cell[TextData[{
 "where the gate with label \[OpenCurlyQuote]",
 StyleBox["V",
  FontSlant->"Italic"],
 " \[CloseCurlyQuote] on the second qubit indicates unitary operator"
}], "TechNoteText",
 CellID->533668759,ExpressionUUID->"4b4d7666-3634-47a2-988c-48798a41fd53"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["V", "11"], 
        SubscriptBox["V", "12"]},
       {
        SubscriptBox["V", "21"], 
        SubscriptBox["V", "22"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "3799a18e-9131-4b39-a0c2-a9506dad7ba9"],
 " ."
}], "TechNoteText",
 CellID->1479122641,ExpressionUUID->"04b44847-5185-407a-98a6-d9966bf45712"],

Cell["\<\
Some other two-level unitary transformations are not multi-control unitary \
gates and yet simple variants. An example is\
\>", "TechNoteText",
 CellID->343529615,ExpressionUUID->"47b069b4-09ae-4604-8823-e3ddaf13c123"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", GridBox[{
      {"1", "0", "0", "0", "0", "0", "0", "0"},
      {"0", "1", "0", "0", "0", "0", "0", "0"},
      {"0", "0", 
       SubscriptBox["V", "11"], "0", "0", "0", 
       SubscriptBox["V", "12"], "0"},
      {"0", "0", "0", "1", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "1", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "1", "0", "0"},
      {"0", "0", 
       SubscriptBox["V", "21"], "0", "0", "0", 
       SubscriptBox["V", "22"], "0"},
      {"0", "0", "0", "0", "0", "0", "0", "1"}
     }], ")"}], TraditionalForm]],ExpressionUUID->
  "a44334f1-283e-4bb9-8a37-eb6d83e19a32"],
 "     \[DotEqual] ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{0.6, -3.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1, -3}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{2, -2}, {2, -3}, {2, -1}}], DiskBox[{2, -2}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -1}, ImageScaled[{0.5, 0.5}]]}, {
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"X\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3, -3}, ImageScaled[{0.5, 0.5}]]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "b88eb597-c763-4dae-b7ea-0a876fa72a33"],
 ","
}], "TechNoteText",
 CellID->1266196169,ExpressionUUID->"b83b9e99-1fd7-46f1-b921-78e46b551b9a"],

Cell[TextData[{
 "In this case, unitary operator ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "7a85cb80-2f75-4afb-afeb-726d0b70c1a8"],
 " acts conditioned on the second qubit in |1\:27e9 and the third qubit in |0\
\:27e9 (rather than |1\:27e9), and the above two-level unitary transformation \
is a simple variant of multi-control unitary gate."
}], "TechNoteText",
 CellID->1543554260,ExpressionUUID->"1f892623-8deb-44ba-97f9-64b9f4f82e25"],

Cell["\<\
Through these examples, we see that any two-level unitary gate with the two \
non-trivial columns and rows attributed to two logical basis states differing \
only in one qubit is either a multi- control unitary gate or a simple variant \
of it. It is thus clear that such a two-level unitary transformation can be \
implemented in terms of elementary gates.\
\>", "TechNoteText",
 CellID->913992060,ExpressionUUID->"98adaee5-85a5-4690-93cb-e2642114efed"],

Cell["\<\
Two-level unitary transformations that do not belong to the above class \
requires additional manipulation. The basic idea is to simultaneously \
exchange columns and rows so that the resulting matrix corresponds to a \
controlled-unitary gate such as the one seen above. Furthermore, a series of \
simultaneous exchanges of columns and rows bring any two-level unitary \
transformation to a multi-control unitary gate and that each exchange of \
columns of rows can be carried by the multi-control NOT gate or a simple \
variant of it.\
\>", "TechNoteText",
 CellID->514025429,ExpressionUUID->"d705a50c-0b2e-4340-a091-6607c3d35c68"],

Cell[TextData[{
 "For example, consider a two-level unitary transformation ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],ExpressionUUID->
  "1cf48c7a-f2bf-4eca-8103-dcced16fd326"],
 " on three qubits of the following form,"
}], "TechNoteText",
 CellID->2046156969,ExpressionUUID->"b041b301-e962-4264-a852-a8baf26c2005"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0", "0", "0", "0", "0", "0", "0"},
       {"0", "1", "0", "0", "0", "0", "0", "0"},
       {"0", "0", "1", "0", "0", "0", "0", "0"},
       {"0", "0", "0", "1", "0", "0", "0", "0"},
       {"0", "0", "0", "0", "1", "0", "0", "0"},
       {"0", "0", "0", "0", "0", 
        SubscriptBox["V", "11"], 
        SubscriptBox["V", "12"], "0"},
       {"0", "0", "0", "0", "0", 
        SubscriptBox["V", "21"], 
        SubscriptBox["V", "22"], "0"},
       {"0", "0", "0", "0", "0", "0", "0", "1"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "51c3186b-2cdf-4418-9122-244552c8979e"],
 "  ."
}], "TechNoteText",
 CellID->2104538572,ExpressionUUID->"aa81eca5-4f61-493d-87f7-c3480ef6fef8"],

Cell[TextData[{
 "The simultaneous exchange of the last two columns and rows brings the above \
two-level unitary matrix to the ",
 ButtonBox["form seen at the beginning",
  BaseStyle->"Link",
  ButtonData->
   "paclet:QuantumMob/Q3/tutorial/UniversalQuantumComputation#1463162308"],
 ". On the other hand, given that the last two columns (or rows) in the \
matrix representation correspond to the logical basis states |110\:27e9 and \
|111\:27e9, respectively, the simultaneous exchange of the last two columns \
and rows can be carried out by the multi-control NOT gate with the first two \
qubits as controls and the third qubit as target. Putting these two \
observations together, we find that"
}], "TechNoteText",
 CellID->1924113514,ExpressionUUID->"c2185b03-a7f4-470f-8b1e-93c057155495"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "="}], TraditionalForm]],ExpressionUUID->
  "dca91f2b-5850-42d4-8456-11448e4187e4"],
 " ",
 Cell[BoxData[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[GrayLevel[0]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2, -2}, ImageScaled[{0.5, 0.5}]]}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{7.2, 7.2}, {5, 5}},
   ImageSize->158.4,
   PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
  "8ea7131e-0932-4649-89a9-2452f9c545f5"],
 "."
}], "TechNoteText",
 CellID->1767073272,ExpressionUUID->"5baf1d77-279c-4f5f-a184-74239933c695"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText",
 Editable->False,
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {
   "ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 FontColor->GrayLevel[0.85],
 CellID->2099512760,ExpressionUUID->"c5e3b3fd-4a86-4ba5-8c9d-e947e72e8762"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[96]:=",
 CellID->1940070093,ExpressionUUID->"f8007d2d-0a45-4270-b5ae-cabe14b10506"],

Cell["For demonstration, consider one of the two above examples.", \
"TechNoteMathCaption",
 CellID->826895218,ExpressionUUID->"f2bed318-cb34-4053-913d-08501b8f71bb"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[97]:=",
 CellID->651125270,ExpressionUUID->"c2eb2b0d-67d9-4467-8aaf-8be416539ae6"],

Cell[TextData[{
 "A two-level unitary matrix is represented in a compact way by ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["GivensRotation"]], "paclet:QuantumMob/Q3/ref/GivensRotation", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e21bea74-91de-44ff-af21-b1e36cfc8ce7"],
 "."
}], "TechNoteMathCaption",
 CellID->735486019,ExpressionUUID->"656f5c39-cfc8-4350-a06b-4acb5915acea"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"opT", "=", 
  RowBox[{"GivensRotation", "[", 
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"TheRotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"6", ",", "7"}], "}"}], ",", "8"}], "]"}]}]], "Input",
 CellLabel->"In[98]:=",
 CellID->880800639,ExpressionUUID->"acbd07f4-bb2b-42d8-95ee-82489699327a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["GivensRotation",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox[
                 "\"Affected columns and rows: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox[
                 "\"Affected columns and rows: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"6", ",", "7"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox[
                    SqrtBox["3"], "2"], ",", 
                    RowBox[{"-", 
                    FractionBox["1", "2"]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox["1", "2"], ",", 
                    FractionBox[
                    SqrtBox["3"], "2"]}], "}"}]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`GivensRotation[{{Rational[1, 2] 3^Rational[1, 2], 
     Rational[-1, 2]}, {
     Rational[1, 2], Rational[1, 2] 3^Rational[1, 2]}}, {6, 7}, 8],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[98]=",
 CellID->1937735645,ExpressionUUID->"3982f5d5-5e22-4071-b462-0ab2f9c9baa9"]
}, Open  ]],

Cell["\<\
Here is the conventional form of the above two-level unitary matrix.\
\>", "TechNoteMathCaption",
 CellID->1465223655,ExpressionUUID->"47ab340d-e3a1-418c-9e44-fccb7d080cf6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", "opT"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[99]:=",
 CellID->2100283434,ExpressionUUID->"e1b64f21-381d-41a5-bc79-36c507753460"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 7, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
       7}, {6}, {8}}}, {
      1, 1, 1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1}}]]]]], "Output",
 CellLabel->"Out[100]//MatrixForm=",
 CellID->933478760,ExpressionUUID->"8f5f5bf3-21dc-427e-b166-902ece1f8ab0"]
}, Open  ]],

Cell["\<\
We want to exchange the last two columns and rows simultaneously. This may be \
achieved by using the corresponding permutation matrix, which happens to be \
equivalent to the matrix representation of the CNOT gate in this case.\
\>", "TechNoteMathCaption",
 CellID->1663484699,ExpressionUUID->"7ad04fc2-a597-4cb2-a42f-e230eef0d209"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"P", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[101]:=",
 CellID->1579699414,ExpressionUUID->"4f6155ac-f33a-4990-a510-b6362c2f71ff"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "1", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{1}, {2}, {2}, {1}, {3}, {4}, {
       4}, {3}, {5}, {6}, {6}, {5}, {7}, {8}, {8}, {7}}}, {1, 0, 1, 0, 1, 0, 
      1, 0, 1, 0, 1, 0, 0, 1, 0, 1}}]]]]], "Output",
 CellLabel->"Out[102]//MatrixForm=",
 CellID->1609477985,ExpressionUUID->"5d59aee4-4344-446c-b412-9eb009ecfa65"]
}, Open  ]],

Cell["\<\
Here is the resulting matrix after the simultaneous exchange of the last two \
columns and rows.\
\>", "TechNoteMathCaption",
 CellID->591924919,ExpressionUUID->"12a371d0-554f-4f03-8c65-118f47127d1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"P", ".", "mat", ".", 
    RowBox[{"Topple", "[", "P", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[103]:=",
 CellID->1560387399,ExpressionUUID->"bbe6696e-9b27-434e-bceb-9242014a0c6f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 12, 16, 20, 24}, {{1}, {2}, {1}, {2}, {3}, {4}, {
       3}, {4}, {5}, {6}, {7}, {8}, {5}, {6}, {7}, {8}, {7}, {8}, {5}, {6}, {
       7}, {8}, {5}, {6}}}, {
      1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, Rational[1, 2] 3^Rational[1, 2], 
       0, Rational[-1, 2], 1, 0, 0, 0, 0, Rational[1, 2] 3^Rational[1, 2], 0, 
       Rational[1, 2]}}]]]]], "Output",
 CellLabel->"Out[104]//MatrixForm=",
 CellID->792476283,ExpressionUUID->"879b1ffa-e6fe-442c-b781-c082e95ea432"]
}, Open  ]],

Cell["\<\
The above matrix is nothing but a multi-control unitary operator with the \
first and third as the control qubits.\
\>", "TechNoteMathCaption",
 CellID->1391660944,ExpressionUUID->"e06593d7-f9b8-4bc3-a682-6cd9fe23d3fd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"op", "=", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], ",", 
     RowBox[{"Rotation", "[", 
      RowBox[{
       RowBox[{"Pi", "/", "3"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "@", 
    RowBox[{"Matrix", "[", "op", "]"}]}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[105]:=",
 CellID->1987632204,ExpressionUUID->"6ba50380-1d3f-4283-b882-2d0c977a2a18"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[106]//MatrixForm=",
 CellID->455309687,ExpressionUUID->"39ee4016-18ed-413e-b303-34d11c91e69c"]
}, Open  ]],

Cell["\<\
In summary, the two-level unitary matrix is equivalent to the following \
quantum circuit.\
\>", "TechNoteMathCaption",
 CellID->919087155,ExpressionUUID->"0db200f6-1f90-4b03-8860-ac04f95ad95b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "op", ",", 
    RowBox[{"CNOT", "[", 
     RowBox[{
      RowBox[{"S", "@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], ",", 
      RowBox[{"S", "[", "3", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[107]:=",
 CellID->1230259461,ExpressionUUID->"cfbba708-4bf1-4e43-a308-0e7928c84efc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"R\"\>", "\<\"y\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -1}, {3, -2}, {3, -3}}], 
     DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Rotation[Rational[1, 3] Pi, {0, 1, 0}, 
     $CellContext`S[2, QuantumMob`Q3`$]]], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[107]=",
 CellID->905675148,ExpressionUUID->"b7e8265c-ebbb-441f-a812-3d28ecadf2b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "-", "mat"}], "//", "Normal"}], "//",
    "Simplify"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[108]:=",
 CellID->833756916,ExpressionUUID->"1297ba2d-de33-472a-afd8-19ff4ab97df7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[108]//MatrixForm=",
 CellID->318122500,ExpressionUUID->"a5126f71-8345-4968-aede-9c03ad97154b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of Two-Level Unitary Matrices: Gray Code Sequence\
\>", "TechNoteSection",
 CellID->1829642645,ExpressionUUID->"a6c5d6c4-b015-47d3-8d47-c5c56cb94d3d"],

Cell[TextData[{
 "So far, the exchanges of columns and rows have been performed on an ",
 StyleBox["ad hoc",
  FontSlant->"Italic"],
 " basis. An irritating issue is that every exchange of columns or rows \
cannot be carried out by a single multi-control NOT gate or a simple variant \
of it. Fortunately, however, one can achieve any desired exchange by \
combining a sequence of other exchanges that can be carried out by a \
multi-control NOT gate (or a simple variant)."
}], "TechNoteText",
 CellID->1649128141,ExpressionUUID->"9f6cf7e2-4c45-4b0f-9555-98871406b206"],

Cell["\<\
For example, suppose that we want to exchange the sixth and seventh columns \
and rows. Noting that these columns and rows in the matrix representation \
correspond to logical basis states |101\:27e9 and |110\:27e9, it is clear \
that the exchange cannot be fulfilled by a single multi-control NOT gate. \
However, it can be achieved by first exchanging the sixth and eighth columns \
and rows (respectively corresponding to logical basis states |101\:27e9 and \
|111\:27e9) and then the eighth and seventh columns and rows (respectively \
corresponding to |111\:27e9 and |110\:27e9). The first exchange can be \
carried out by the multi-control NOT gate with the first and third qubit as \
controls and the second qubit as target while the second exchange can be \
implemented by the multi-control NOT gate with the first two qubits as \
controls and the third qubit as target.\
\>", "TechNoteText",
 CellID->1472717605,ExpressionUUID->"8aa6e5ae-4769-4200-9dd3-130577d98a10"],

Cell["\<\
The key point is that each exchange must be between a pair of columns (and \
rows) corresponding to logical basis states that differ in only one qubit. \
For this purpose, a systematic and efficient way is to use the Gray code \
sequence. In terms of classical bits, it is a sequence of bit strings where \
any two successive strings are different only in one bit. As an example, the \
Gray code sequence from |010\:27e9 to |101\:27e9 is given by\
\>", "TechNoteText",
 CellID->68271913,ExpressionUUID->"1a4c6f36-57c0-422c-96ad-dc44043e6dd4"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"010"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"110"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"111"},
     "Ket"], "\[RightArrow]", 
    TemplateBox[{"101"},
     "Ket"]}], TraditionalForm]],ExpressionUUID->
  "97ec2848-6ebe-4494-a8d9-e59b52cea831"],
 "."
}], "TechNoteText",
 CellID->689774293,ExpressionUUID->"6737f75b-5421-4661-bf2f-2f0ac9b6e12d"],

Cell["\<\
The first step in the above sequence corresponds to the NOT gate on the first \
qubit conditioned on the second qubit in |1\:27e9 and the third qubit in |0\
\:27e9, which is a simple variant of the multi-control NOT gate with the last \
two qubits as control and the first qubit as target\[LongDash]it just needs \
additional NOT gates on the third qubit before and after the multi-control \
NOT gate. The other steps can be carried out simply by multi-control NOT \
gates.\
\>", "TechNoteText",
 CellID->919815945,ExpressionUUID->"1812b459-e163-49db-9f47-0c576deaf9cb"],

Cell[CellGroupData[{

Cell["\t", "TechNoteText",
 Editable->False,
 ShowCellBracket->Automatic,
 CellMargins->{{Inherited, Inherited}, {Inherited, 10}},
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 TabFilling->"\[LongDash]\[NegativeThickSpace]",
 TabSpacings->Scaled[1],
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {
   "ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 FontColor->GrayLevel[0.85],
 CellID->488164175,ExpressionUUID->"5c5df471-3453-4740-8460-eda4df01b3d3"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input",
 CellLabel->"In[109]:=",
 CellID->1037329788,ExpressionUUID->"5c02e3c4-29f3-4381-b4fa-a76dd942c0dc"],

Cell["\<\
For demonstration, let us consider a particular two-level unitary matrix on a \
three-qubit system. We want to implement it in terms of elementary quantum \
logic gates.\
\>", "TechNoteMathCaption",
 CellID->274114911,ExpressionUUID->"81a796f0-07e3-4e98-b1c1-ee8dfc24e5bc"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellLabel->"In[110]:=",
 CellID->1129500570,ExpressionUUID->"263ab366-e330-4ad3-bd30-0b3d3392c5e7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TheRotation", "[", 
    RowBox[{
     RowBox[{"Pi", "/", "3"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"U", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[111]:=",
 CellID->408162463,ExpressionUUID->"b18aaa49-8c07-4ffd-a074-5dad8afe779f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], Rational[1, 2] 
       3^Rational[1, 2], Rational[1, 2]}}]]]]], "Output",
 CellLabel->"Out[112]//MatrixForm=",
 CellID->1598060117,ExpressionUUID->"329566ad-0144-4432-a2d8-78afa015b3c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SS", "=", 
   RowBox[{"S", "[", 
    RowBox[{
     RowBox[{"Range", "[", "$n", "]"}], ",", "$"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "@", 
    RowBox[{"GivensRotation", "[", 
     RowBox[{"U", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"2", "^", "$n"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[113]:=",
 CellID->140937410,ExpressionUUID->"fa4ddb39-5b4a-4b95-9bf6-d6c6e088e939"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 5, 7, 8, 9, 10}, {{1}, {2}, {3}, {4}, {5}, {5}, {4}, {
       6}, {7}, {8}}}, {
      1, 1, 1, Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 1, 1, 
       1}}]]]]], "Output",
 CellLabel->"Out[116]//MatrixForm=",
 CellID->18413390,ExpressionUUID->"a8d371e3-d3c8-4103-a75d-df4820a778d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"mat", ",", "SS"}], "]"}], "//", "Elaborate"}]}]], "Input",
 CellLabel->"In[117]:=",
 CellID->1202374181,ExpressionUUID->"f2b79a71-8bc5-473d-a32c-6e4c8e8cb997"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"6", "+", 
     SqrtBox["3"]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SqrtBox["3"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}]}]], "Output",
 CellLabel->"Out[117]=",
 CellID->236200562,ExpressionUUID->"48e2b6dd-109a-4932-828a-3607c429a232"]
}, Open  ]],

Cell[TextData[{
 "Our implementation is based on the Gray code sequence. Notice the function ",
 StyleBox["Reverse", "Input"],
 "."
}], "TechNoteMathCaption",
 CellID->671324729,ExpressionUUID->"3c89fdb2-f4c1-4f39-8c74-66f7d1e38c44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gates", "=", 
  RowBox[{"Unfold", "@", 
   RowBox[{"GivensRotation", "[", 
    RowBox[{"U", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", "SS"}], "]"}]}]}]], "Input",
 CellLabel->"In[118]:=",
 CellID->1879517453,ExpressionUUID->"c91351ce-e926-4d6c-9ef5-0d71007c704a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
     LineBox[{{1, -2}, {1, -3}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     DiskBox[{1, -3}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{3, -2}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
         5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->262.8,
   PlotRange->{{0, 6}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 0}, 
    Rational[1, 2] 3^Rational[1, 2] + Complex[0, 
       Rational[1, 2]] $CellContext`S[3, 2], "Label" -> "U"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[118]=",
 CellID->1273065878,ExpressionUUID->"ca8235d9-8dd5-4fbe-87eb-f99f659a58f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"Dot", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Matrix", "[", 
          RowBox[{"#", ",", "SS"}], "]"}], "&"}], "/@", 
        RowBox[{"Elaborate", "/@", "gates"}]}]}], "]"}], "//", "Normal"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[119]:=",
 CellID->1607904042,ExpressionUUID->"5b216127-afc7-471f-a771-60b45ae8bf68"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[120]//MatrixForm=",
 CellID->1038636485,ExpressionUUID->"e4132ec9-a8bb-468b-8655-cba8d1186b8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "@@", "gates"}]}]], "Input",
 CellLabel->"In[121]:=",
 CellID->1663700242,ExpressionUUID->"fa0bda0b-2ccc-48ba-9872-8bfc5401bd35"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {6, -1}}, {{0, -2}, {6, -2}}, {{0, -3}, {6, -3}}}], {
     LineBox[{{1, -2}, {1, -3}, {1, -1}}], DiskBox[{1, -2}, 0.09], 
     DiskBox[{1, -3}, 0.09], {CircleBox[{1, -1}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -1}, {1.2666666666666666`, -1}}, {{
         1, -1.2666666666666666`}, {1, -0.7333333333333334}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], {CircleBox[{2, -2}, 0.26666666666666666], 
      LineBox[{{{1.7333333333333334`, -2}, {2.2666666666666666`, -2}}, {{
         2, -2.2666666666666666`}, {2, -1.7333333333333334`}}}]}}, {
     LineBox[{{3, -1}, {3, -2}, {3, -3}}], DiskBox[{3, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], DiskBox[{3, -2}, 0.09]}, 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.06666666666666667],
       FontWeight->"Light",
       FontSlant->Italic], {3., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}, {4, -2}}], 
     DiskBox[{4, -1}, 0.09], 
     DiskBox[{4, -3}, 0.09], {CircleBox[{4, -2}, 0.26666666666666666], 
      LineBox[{{{3.7333333333333334`, -2}, {4.266666666666667, -2}}, {{
         4, -2.2666666666666666`}, {4, -1.7333333333333334`}}}]}}, {
     LineBox[{{5, -2}, {5, -3}, {5, -1}}], DiskBox[{5, -2}, 0.09], 
     DiskBox[{5, -3}, 0.09], {CircleBox[{5, -1}, 0.26666666666666666], 
      LineBox[{{{4.733333333333333, -1}, {5.266666666666667, -1}}, {{
         5, -1.2666666666666666`}, {5, -0.7333333333333334}}}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->262.8,
   PlotRange->{{0, 6}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 0}, 
    Rational[1, 2] 3^Rational[1, 2] + Complex[0, 
       Rational[1, 2]] $CellContext`S[3, 2], "Label" -> "U"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[2, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`CNOT[{$CellContext`S[2, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[1, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[121]=",
 CellID->1616320579,ExpressionUUID->"02f54458-bc9a-4cba-986e-c894ec223e72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", "[", "qc", "]"}], "//", "Normal"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellLabel->"In[122]:=",
 CellID->722239880,ExpressionUUID->"4c2713ec-4b00-4560-8056-2ceba942ef3d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox[
       SqrtBox["3"], "2"], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox[
       SqrtBox["3"], "2"], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[123]//MatrixForm=",
 CellID->1979320350,ExpressionUUID->"2f4aa72a-3a6d-4c19-a197-36a1361b1c8b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", 
   RowBox[{"ControlledGate", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], ",", 
     RowBox[{"S", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<V\>\""}]}], "]"}], ",", 
   RowBox[{"CNOT", "[", 
    RowBox[{
     RowBox[{"S", "@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"S", "[", "3", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"\"\<PortSize\>\"", "->", "0.2"}]}], "]"}]], "Input",
 CellLabel->"In[124]:=",
 CellID->1008687980,ExpressionUUID->"51ba4c86-9215-4a1d-b7cb-3f482f359a2e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}}], DiskBox[{1, -1}, 0.09], 
     DiskBox[{1, -2}, 0.09], {CircleBox[{1, -3}, 0.26666666666666666], 
      LineBox[{{{0.7333333333333334, -3}, {1.2666666666666666`, -3}}, {{
         1, -3.2666666666666666`}, {1, -2.7333333333333334`}}}]}}, {
     LineBox[{{2, -1}, {2, -3}, {2, -2}}], DiskBox[{2, -1}, 0.09], 
     DiskBox[{2, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -1}, {3, -2}, {3, -3}}], 
     DiskBox[{3, -1}, 0.09], 
     DiskBox[{3, -2}, 0.09], {CircleBox[{3, -3}, 0.26666666666666666], 
      LineBox[{{{2.7333333333333334`, -3}, {3.2666666666666666`, -3}}, {{
         3, -3.2666666666666666`}, {3, -2.7333333333333334`}}}]}}},
   ImagePadding->{{9.36, 9.36}, {7.2, 7.2}},
   ImageSize->158.4,
   PlotRange->{{0, 4}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 1], "Label" -> "V"], 
   QuantumMob`Q3`CNOT[{$CellContext`S[1, QuantumMob`Q3`$] -> 
     1, $CellContext`S[2, QuantumMob`Q3`$] -> 1}, {
     $CellContext`S[3, QuantumMob`Q3`$]}], "PortSize" -> 0.2]]], "Output",
 CellLabel->"Out[124]=",
 CellID->1915430420,ExpressionUUID->"fefc00e6-f11c-4f4b-982f-a7221b657c9c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Universal Quantum Computation Theorem", "TechNoteSection",
 CellID->205503201,ExpressionUUID->"a0ee080c-bde3-4da3-b055-390a919dbae1"],

Cell["\<\
We have seen that one can implement any unitary operation combining the CNOT \
and single-qubit gates. \
\>", "TechNoteText",
 CellID->608169919,ExpressionUUID->"7901e83e-76ef-4a2a-86c6-5f759b7d1192"],

Cell["\<\
A subtle issue is that single-qubit gates form a continuum of unitary \
operators. It is impractical to implement them to an infinite accuracy. \
Fortunately, it is known that a discrete set of gates is sufficient to \
perform universal quantum computation. The Hadamard, quadrant phase, octant \
phase, and CNOT gates form a universal set of gates in the sense that an \
arbitrary gate on n qubits can be approximated to arbitrary accuracy using a \
quantum circuit composed of only such gates.\
\>", "TechNoteText",
 CellID->1278444818,ExpressionUUID->"07c82f14-0524-4423-ab22-d952fa6aae8a"],

Cell["\<\
The quadrant phase gate is equal to the square of the octant phase, and it \
may sound redundant to include the quadrant phase. In the context of the \
universal set of elementary gates alone, it is certainly true. However, the \
quadrant phase gate is typically included in the universal set because it is \
required to fault-tolerantly implement the octant phase.\
\>", "TechNoteText",
 CellID->1089412868,ExpressionUUID->"e2aa6d83-9288-4179-9f0c-9ba59f8f68a4"],

Cell["\<\
It is also interesting to note that the set remains universal if octant phase \
gates are replaced with Toffoli gates.\
\>", "TechNoteText",
 CellID->123415854,ExpressionUUID->"b39f8a10-da15-4063-b7f5-22705450cfb2"]
}, Open  ]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "TutorialMoreAboutSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]],
          "TutorialMoreAbout",ExpressionUUID->
         "0ea6cecc-f103-4655-9afc-6002aa25508c"]}]}
     }]}
  }]], "TutorialMoreAboutSection",ExpressionUUID->"09d9bcb2-3509-4d6c-9b58-\
aa6634d885c7"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Tech", " ", "Notes"}], 
        "RelatedTutorialsSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Computation: Overview",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumComputationOverview"]], 
         "RelatedTutorials",ExpressionUUID->
         "b926d927-28ff-4adf-aaae-536207838bca"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Information Systems with Q3",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]], 
         "RelatedTutorials",ExpressionUUID->
         "a17c424d-01cd-40f4-a123-ba3ac5479a85"]}]}
     }]}
  }]], "RelatedTutorialsSection",ExpressionUUID->"e0b6aca1-42bc-4d4f-8798-\
4af93d43672f"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], 
         "TutorialRelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "48dab3c4-3493-4706-a90d-cc1aca25351e"]}]],ExpressionUUID->
         "11331803-7ddd-4feb-91b3-cc24f82de520"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "TutorialRelatedLinks",ExpressionUUID->
        "8360a642-3c5f-4945-a3f2-b539fd5384e7"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"TutorialRelatedLinks"}]],ExpressionUUID->
           "12671891-bee1-4157-bb10-b66fd0bdbfd4"]}]],ExpressionUUID->
         "446492f8-dfe2-4816-ab80-b0c7ddd65187"],
        ", A Quantum Computation Workbook (Springer)."
       }], "TutorialRelatedLinks",ExpressionUUID->
        "8764c081-9a29-49da-8805-2880ef8ec4bd"]}
     }]}
  }]], "TutorialRelatedLinksSection",ExpressionUUID->"c5e1cdf7-4494-4459-a7d7-\
a1261206a8bc"]
}, Open  ]],

Cell[" ", "FooterCell",ExpressionUUID->"8bf95abb-938d-4771-9e09-e0f144a63868"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"Universal Quantum Computation",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}}, 
  "NewStyles" -> True, "CitationPopupData" -> {"2021", ""}, "ShowCitation" -> 
  False, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 9, 1, 18, 7, 49.512068}", 
    "history" -> {"13", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {"universal quantum computation"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Tech Note", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3", "status" -> "None", "summary" -> 
    "In classical computation, it is known that a finite set of logic \
gates\\[LongDash]typically including AND, OR, and NOT\\[LongDash]is \
sufficient to calculate any binary function. The set is said to be universal \
for classical computation. Does there exist a universal set of elementary \
quantum logic gates for quantum computation that enables to implement any \
arbitrary quantum unitary operation? See also Section 2.4 of the Quantum \
Workbook (2022). Suppose that we want to implement an arbitrary unitary \
operation U on an n-qubit register. We start by decomposing U into a set of \
two-level unitary transformations T_k, that is,", "synonyms" -> {}, 
    "tabletags" -> {}, "title" -> "Universal Quantum Computation", 
    "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "Universal Quantum Computation", "type" -> "Tech Note", "uri" -> 
    "QuantumMob/Q3/tutorial/UniversalQuantumComputation"}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> Notebook], 
   Cell[
    StyleData["Output"], CellContext -> Notebook], 
   Cell[
    StyleData["TutorialMoreAboutSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["RelatedTutorialsSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}], 
   Cell[
    StyleData["TutorialRelatedLinksSection"], 
    CellGroupingRules -> {"SectionGrouping", 30}]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"e39877be-b55c-41d3-8f2f-77de2ded1bd0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "RasterizedOutput"->{
  Cell[21772, 577, 6420, 117, 70, "Output",ExpressionUUID->"d00e933b-6a95-4143-b14e-80cc007c481a",
   CellTags->"RasterizedOutput",
   CellID->1314282832]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"RasterizedOutput", 102723, 2613}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[597, 21, 6678, 164, 70, "AnchorBarGrid",ExpressionUUID->"1a49e7fb-d5f8-42df-b70a-c77a98c74e0d",
 CellID->1],
Cell[CellGroupData[{
Cell[7300, 189, 130, 1, 70, "TechNoteTitle",ExpressionUUID->"9e286efb-5bdb-45c8-a87a-b65e1221e8d7",
 CellID->1902776493],
Cell[7433, 192, 4089, 92, 70, "TechNoteJumpBox",ExpressionUUID->"108706c5-7772-4221-a825-925312578124"],
Cell[11525, 286, 510, 8, 70, "TechNoteText",ExpressionUUID->"fc96ec10-5ab4-46ab-b1d5-9dece4ebc461",
 CellID->1061332761],
Cell[12038, 296, 391, 12, 70, "TechNoteText",ExpressionUUID->"d914855e-180f-42c5-a01b-5b747aeb7a3a",
 CellID->1308734266],
Cell[12432, 310, 872, 21, 70, "DefinitionBox",ExpressionUUID->"3a25a11a-0a9d-4d04-9a75-9c8c3b5271e5",
 CellID->472512640],
Cell[13307, 333, 176, 3, 70, "TechNoteCaption",ExpressionUUID->"edf2023f-d994-4e00-b0af-8e4813099ca9",
 CellID->125413874],
Cell[13486, 338, 328, 7, 70, "TechNoteMathCaption",ExpressionUUID->"008e4839-e4b9-40a9-86b7-e9bd9be044dd",
 CellID->1428640008],
Cell[13817, 347, 178, 3, 70, "Input",ExpressionUUID->"680265b1-bd07-41ad-9c15-0014b57e456a",
 CellID->853967906],
Cell[CellGroupData[{
Cell[14020, 354, 148, 1, 70, "TechNoteSection",ExpressionUUID->"a0d2f6b3-7546-46a2-a8d0-1dc3c5c69e58",
 CellID->1255432361],
Cell[14171, 357, 762, 20, 70, "TechNoteText",ExpressionUUID->"f0a2637d-dcdf-46e1-bac0-598c87397419",
 CellID->2093541217],
Cell[14936, 379, 381, 12, 70, "TechNoteText",ExpressionUUID->"cf07244a-9d66-44c7-b42c-cdc26e3433d6",
 CellID->330293091],
Cell[15320, 393, 1206, 28, 70, "TechNoteText",ExpressionUUID->"ff19a7e4-9c68-4037-97af-e78d9a8c82f2",
 CellID->2138236589],
Cell[16529, 423, 447, 12, 70, "TechNoteText",ExpressionUUID->"8fa1a525-a907-44a7-bc2c-6fdb90fd96aa",
 CellID->1351002425],
Cell[16979, 437, 265, 7, 70, "TechNoteText",ExpressionUUID->"c2c6f59b-1a50-4c0a-a9ca-f7a6402444ba",
 CellID->953157244],
Cell[17247, 446, 382, 12, 70, "TechNoteText",ExpressionUUID->"cdcca543-8bef-4f88-a614-b4e3154144d4",
 CellID->1633276935],
Cell[17632, 460, 111, 1, 70, "TechNoteText",ExpressionUUID->"c39ff85d-bdfd-43dc-b855-f924321bedd6",
 CellID->1349470591],
Cell[CellGroupData[{
Cell[17768, 465, 522, 11, 70, "TechNoteText",ExpressionUUID->"fa779613-1c73-4776-80a5-099720fb372e",
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {"ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 CellID->2035887808],
Cell[18293, 478, 201, 4, 70, "TechNoteText",ExpressionUUID->"e736ffdc-a5de-4331-b070-8b93429f70e5",
 CellID->1917505328],
Cell[18497, 484, 178, 3, 70, "Input",ExpressionUUID->"087c14f5-013d-4ccf-aeb1-c781d5ebb2f9",
 CellID->591242595],
Cell[18678, 489, 182, 4, 70, "Input",ExpressionUUID->"f184b26c-afa4-4fe1-b687-9cec31f33401",
 CellID->607459496],
Cell[CellGroupData[{
Cell[18885, 497, 647, 19, 70, "Input",ExpressionUUID->"a2f3ca68-11f6-41a2-814a-5d0f8a5007ad",
 CellID->86358426],
Cell[19535, 518, 1760, 40, 70, "Output",ExpressionUUID->"64489961-322a-45f4-b3d2-46d3721fdcc8",
 CellID->2141573666]
}, Open  ]],
Cell[CellGroupData[{
Cell[21332, 563, 437, 12, 70, "Input",ExpressionUUID->"42d81ff7-4d09-486d-8111-1c4ff4e2d500",
 CellID->1264688223],
Cell[21772, 577, 6420, 117, 70, "Output",ExpressionUUID->"d00e933b-6a95-4143-b14e-80cc007c481a",
 CellTags->"RasterizedOutput",
 CellID->1314282832]
}, Open  ]],
Cell[28207, 697, 236, 6, 70, "Input",ExpressionUUID->"a59a2617-250e-4c44-89a1-837bb9111570",
 CellID->104214177],
Cell[CellGroupData[{
Cell[28468, 707, 295, 8, 70, "Input",ExpressionUUID->"6ef460f4-6421-4364-ba6b-c263b23bdcbc",
 CellID->1514570623],
Cell[28766, 717, 6021, 136, 70, "Output",ExpressionUUID->"bec87a22-93b3-4cef-9ab9-a9ff59b83d26",
 CellID->367846473]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34848, 860, 153, 1, 70, "TechNoteSection",ExpressionUUID->"b995f5d9-1c7f-4f76-a06d-b39094289d5d",
 CellID->1012467270],
Cell[35004, 863, 395, 8, 70, "TechNoteText",ExpressionUUID->"1940c739-7779-4d59-997d-3500f38e66f1",
 CellID->1580628084],
Cell[35402, 873, 642, 19, 70, "TechNoteText",ExpressionUUID->"ebb23028-1301-4242-bb63-cc1be683fa41",
 CellID->1243494398],
Cell[36047, 894, 133, 1, 70, "TechNoteText",ExpressionUUID->"062d444a-6e56-4617-ae9f-a0a2d8f92911",
 CellID->99494582],
Cell[36183, 897, 1503, 40, 70, "TechNoteText",ExpressionUUID->"12c5ec5a-c0b6-4447-b4a0-42d76b59d8b3",
 CellID->1463162308],
Cell[37689, 939, 267, 6, 70, "TechNoteText",ExpressionUUID->"4b4d7666-3634-47a2-988c-48798a41fd53",
 CellID->533668759],
Cell[37959, 947, 459, 16, 70, "TechNoteText",ExpressionUUID->"04b44847-5185-407a-98a6-d9966bf45712",
 CellID->1479122641],
Cell[38421, 965, 228, 4, 70, "TechNoteText",ExpressionUUID->"47b069b4-09ae-4604-8823-e3ddaf13c123",
 CellID->343529615],
Cell[38652, 971, 2079, 55, 70, "TechNoteText",ExpressionUUID->"b83b9e99-1fd7-46f1-b921-78e46b551b9a",
 CellID->1266196169],
Cell[40734, 1028, 466, 9, 70, "TechNoteText",ExpressionUUID->"1f892623-8deb-44ba-97f9-64b9f4f82e25",
 CellID->1543554260],
Cell[41203, 1039, 464, 7, 70, "TechNoteText",ExpressionUUID->"98adaee5-85a5-4690-93cb-e2642114efed",
 CellID->913992060],
Cell[41670, 1048, 643, 10, 70, "TechNoteText",ExpressionUUID->"d705a50c-0b2e-4340-a091-6607c3d35c68",
 CellID->514025429],
Cell[42316, 1060, 324, 7, 70, "TechNoteText",ExpressionUUID->"b041b301-e962-4264-a852-a8baf26c2005",
 CellID->2046156969],
Cell[42643, 1069, 814, 22, 70, "TechNoteText",ExpressionUUID->"aa81eca5-4f61-493d-87f7-c3480ef6fef8",
 CellID->2104538572],
Cell[43460, 1093, 795, 14, 70, "TechNoteText",ExpressionUUID->"c2185b03-a7f4-470f-8b1e-93c057155495",
 CellID->1924113514],
Cell[44258, 1109, 1552, 36, 70, "TechNoteText",ExpressionUUID->"5baf1d77-279c-4f5f-a184-74239933c695",
 CellID->1767073272],
Cell[CellGroupData[{
Cell[45835, 1149, 522, 11, 70, "TechNoteText",ExpressionUUID->"c5e3b3fd-4a86-4ba5-8c9d-e947e72e8762",
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {"ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 CellID->2099512760],
Cell[46360, 1162, 179, 3, 70, "Input",ExpressionUUID->"f8007d2d-0a45-4270-b5ae-cabe14b10506",
 CellID->1940070093],
Cell[46542, 1167, 166, 2, 70, "TechNoteMathCaption",ExpressionUUID->"f2bed318-cb34-4053-913d-08501b8f71bb",
 CellID->826895218],
Cell[46711, 1171, 182, 4, 70, "Input",ExpressionUUID->"c2eb2b0d-67d9-4467-8aaf-8be416539ae6",
 CellID->651125270],
Cell[46896, 1177, 502, 13, 70, "TechNoteMathCaption",ExpressionUUID->"656f5c39-cfc8-4350-a06b-4acb5915acea",
 CellID->735486019],
Cell[CellGroupData[{
Cell[47423, 1194, 403, 11, 70, "Input",ExpressionUUID->"acbd07f4-bb2b-42d8-95ee-82489699327a",
 CellID->880800639],
Cell[47829, 1207, 5042, 112, 70, "Output",ExpressionUUID->"3982f5d5-5e22-4071-b462-0ab2f9c9baa9",
 CellID->1937735645]
}, Open  ]],
Cell[52886, 1322, 183, 3, 70, "TechNoteMathCaption",ExpressionUUID->"47ab340d-e3a1-418c-9e44-fccb7d080cf6",
 CellID->1465223655],
Cell[CellGroupData[{
Cell[53094, 1329, 264, 6, 70, "Input",ExpressionUUID->"e1b64f21-381d-41a5-bc79-36c507753460",
 CellID->2100283434],
Cell[53361, 1337, 1362, 36, 70, "Output",ExpressionUUID->"8f5f5bf3-21dc-427e-b166-902ece1f8ab0",
 CellID->933478760]
}, Open  ]],
Cell[54738, 1376, 343, 5, 70, "TechNoteMathCaption",ExpressionUUID->"7ad04fc2-a597-4cb2-a42f-e230eef0d209",
 CellID->1663484699],
Cell[CellGroupData[{
Cell[55106, 1385, 439, 12, 70, "Input",ExpressionUUID->"4f6155ac-f33a-4990-a510-b6362c2f71ff",
 CellID->1579699414],
Cell[55548, 1399, 1162, 28, 70, "Output",ExpressionUUID->"5d59aee4-4344-446c-b412-9eb009ecfa65",
 CellID->1609477985]
}, Open  ]],
Cell[56725, 1430, 210, 4, 70, "TechNoteMathCaption",ExpressionUUID->"12a371d0-554f-4f03-8c65-118f47127d1e",
 CellID->591924919],
Cell[CellGroupData[{
Cell[56960, 1438, 305, 7, 70, "Input",ExpressionUUID->"bbe6696e-9b27-434e-bceb-9242014a0c6f",
 CellID->1560387399],
Cell[57268, 1447, 1493, 38, 70, "Output",ExpressionUUID->"879b1ffa-e6fe-442c-b781-c082e95ea432",
 CellID->792476283]
}, Open  ]],
Cell[58776, 1488, 229, 4, 70, "TechNoteMathCaption",ExpressionUUID->"e06593d7-f9b8-4bc3-a682-6cd9fe23d3fd",
 CellID->1391660944],
Cell[CellGroupData[{
Cell[59030, 1496, 634, 19, 70, "Input",ExpressionUUID->"6ba50380-1d3f-4283-b882-2d0c977a2a18",
 CellID->1987632204],
Cell[59667, 1517, 1093, 30, 70, "Output",ExpressionUUID->"39ee4016-18ed-413e-b303-34d11c91e69c",
 CellID->455309687]
}, Open  ]],
Cell[60775, 1550, 204, 4, 70, "TechNoteMathCaption",ExpressionUUID->"0db200f6-1f90-4b03-8860-ac04f95ad95b",
 CellID->919087155],
Cell[CellGroupData[{
Cell[61004, 1558, 577, 17, 70, "Input",ExpressionUUID->"cfbba708-4bf1-4e43-a308-0e7928c84efc",
 CellID->1230259461],
Cell[61584, 1577, 2106, 42, 70, "Output",ExpressionUUID->"b7e8265c-ebbb-441f-a812-3d28ecadf2b6",
 CellID->905675148]
}, Open  ]],
Cell[CellGroupData[{
Cell[63727, 1624, 288, 8, 70, "Input",ExpressionUUID->"1297ba2d-de33-472a-afd8-19ff4ab97df7",
 CellID->833756916],
Cell[64018, 1634, 936, 23, 70, "Output",ExpressionUUID->"a5126f71-8345-4968-aede-9c03ad97154b",
 CellID->318122500]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65015, 1664, 175, 3, 70, "TechNoteSection",ExpressionUUID->"a6c5d6c4-b015-47d3-8d47-c5c56cb94d3d",
 CellID->1829642645],
Cell[65193, 1669, 570, 10, 70, "TechNoteText",ExpressionUUID->"9f6cf7e2-4c45-4b0f-9555-98871406b206",
 CellID->1649128141],
Cell[65766, 1681, 986, 14, 70, "TechNoteText",ExpressionUUID->"8aa6e5ae-4769-4200-9dd3-130577d98a10",
 CellID->1472717605],
Cell[66755, 1697, 552, 8, 70, "TechNoteText",ExpressionUUID->"1a4c6f36-57c0-422c-96ad-dc44043e6dd4",
 CellID->68271913],
Cell[67310, 1707, 446, 16, 70, "TechNoteText",ExpressionUUID->"6737f75b-5421-4661-bf2f-2f0ac9b6e12d",
 CellID->689774293],
Cell[67759, 1725, 580, 9, 70, "TechNoteText",ExpressionUUID->"1812b459-e163-49db-9f47-0c576deaf9cb",
 CellID->919815945],
Cell[CellGroupData[{
Cell[68364, 1738, 521, 11, 70, "TechNoteText",ExpressionUUID->"5c5df471-3453-4740-8460-eda4df01b3d3",
 Evaluatable->False,
 CellGroupingRules->{"SectionGrouping", 70},
 CounterAssignments->{{"Item", 0}, {"Subitem", 0}, {"Subsubitem", 0}, {"ItemNumbered", 0}, {"SubitemNumbered", 0}, {"SubsubitemNumbered", 0}},
 CellID->488164175],
Cell[68888, 1751, 180, 3, 70, "Input",ExpressionUUID->"5c02e3c4-29f3-4381-b4fa-a76dd942c0dc",
 CellID->1037329788],
Cell[69071, 1756, 283, 5, 70, "TechNoteMathCaption",ExpressionUUID->"81a796f0-07e3-4e98-b1c1-ee8dfc24e5bc",
 CellID->274114911],
Cell[69357, 1763, 184, 4, 70, "Input",ExpressionUUID->"263ab366-e330-4ad3-bd30-0b3d3392c5e7",
 CellID->1129500570],
Cell[CellGroupData[{
Cell[69566, 1771, 320, 8, 70, "Input",ExpressionUUID->"b18aaa49-8c07-4ffd-a074-5dad8afe779f",
 CellID->408162463],
Cell[69889, 1781, 946, 29, 70, "Output",ExpressionUUID->"329566ad-0144-4432-a2d8-78afa015b3c5",
 CellID->1598060117]
}, Open  ]],
Cell[CellGroupData[{
Cell[70872, 1815, 652, 18, 70, "Input",ExpressionUUID->"fa4ddb39-5b4a-4b95-9bf6-d6c6e088e939",
 CellID->140937410],
Cell[71527, 1835, 1369, 37, 70, "Output",ExpressionUUID->"a8d371e3-d3c8-4103-a75d-df4820a778d7",
 CellID->18413390]
}, Open  ]],
Cell[CellGroupData[{
Cell[72933, 1877, 252, 6, 70, "Input",ExpressionUUID->"f2b79a71-8bc5-473d-a32c-6e4c8e8cb997",
 CellID->1202374181],
Cell[73188, 1885, 7893, 193, 70, "Output",ExpressionUUID->"48e2b6dd-109a-4932-828a-3607c429a232",
 CellID->236200562]
}, Open  ]],
Cell[81096, 2081, 233, 5, 70, "TechNoteMathCaption",ExpressionUUID->"3c89fdb2-f4c1-4f39-8c74-66f7d1e38c44",
 CellID->671324729],
Cell[CellGroupData[{
Cell[81354, 2090, 313, 8, 70, "Input",ExpressionUUID->"c91351ce-e926-4d6c-9ef5-0d71007c704a",
 CellID->1879517453],
Cell[81670, 2100, 3024, 56, 70, "Output",ExpressionUUID->"ca8235d9-8dd5-4fbe-87eb-f99f659a58f1",
 CellID->1273065878]
}, Open  ]],
Cell[CellGroupData[{
Cell[84731, 2161, 533, 15, 70, "Input",ExpressionUUID->"5b216127-afc7-471f-a771-60b45ae8bf68",
 CellID->1607904042],
Cell[85267, 2178, 1094, 30, 70, "Output",ExpressionUUID->"e4132ec9-a8bb-468b-8655-cba8d1186b8d",
 CellID->1038636485]
}, Open  ]],
Cell[CellGroupData[{
Cell[86398, 2213, 192, 4, 70, "Input",ExpressionUUID->"fa0bda0b-2ccc-48ba-9872-8bfc5401bd35",
 CellID->1663700242],
Cell[86593, 2219, 3024, 56, 70, "Output",ExpressionUUID->"02f54458-bc9a-4cba-986e-c894ec223e72",
 CellID->1616320579]
}, Open  ]],
Cell[CellGroupData[{
Cell[89654, 2280, 338, 9, 70, "Input",ExpressionUUID->"4c2713ec-4b00-4560-8056-2ceba942ef3d",
 CellID->722239880],
Cell[89995, 2291, 1094, 30, 70, "Output",ExpressionUUID->"2f4aa72a-3a6d-4c19-a197-36a1361b1c8b",
 CellID->1979320350]
}, Open  ]],
Cell[CellGroupData[{
Cell[91126, 2326, 877, 25, 70, "Input",ExpressionUUID->"51ba4c86-9215-4a1d-b7cb-3f482f359a2e",
 CellID->1008687980],
Cell[92006, 2353, 2017, 40, 70, "Output",ExpressionUUID->"fefc00e6-f11c-4f4b-982f-a7221b657c9c",
 CellID->1915430420]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94084, 2400, 139, 1, 70, "TechNoteSection",ExpressionUUID->"a0ee080c-bde3-4da3-b055-390a919dbae1",
 CellID->205503201],
Cell[94226, 2403, 210, 4, 70, "TechNoteText",ExpressionUUID->"7901e83e-76ef-4a2a-86c6-5f759b7d1192",
 CellID->608169919],
Cell[94439, 2409, 603, 9, 70, "TechNoteText",ExpressionUUID->"07c82f14-0524-4423-ab22-d952fa6aae8a",
 CellID->1278444818],
Cell[95045, 2420, 473, 7, 70, "TechNoteText",ExpressionUUID->"e2aa6d83-9288-4179-9f0c-9ba59f8f68a4",
 CellID->1089412868],
Cell[95521, 2429, 225, 4, 70, "TechNoteText",ExpressionUUID->"b39f8a10-da15-4063-b7f5-22705450cfb2",
 CellID->123415854]
}, Open  ]],
Cell[95761, 2436, 741, 18, 70, "TutorialMoreAboutSection",ExpressionUUID->"09d9bcb2-3509-4d6c-9b58-aa6634d885c7"],
Cell[96505, 2456, 1138, 30, 70, "RelatedTutorialsSection",ExpressionUUID->"e0b6aca1-42bc-4d4f-8798-4af93d43672f"],
Cell[97646, 2488, 2152, 60, 70, "TutorialRelatedLinksSection",ExpressionUUID->"c5e1cdf7-4494-4459-a7d7-a1261206a8bc"]
}, Open  ]],
Cell[99813, 2551, 78, 0, 70, "FooterCell",ExpressionUUID->"8bf95abb-938d-4771-9e09-e0f144a63868"]
}
]
*)

(* End of internal cache information *)
