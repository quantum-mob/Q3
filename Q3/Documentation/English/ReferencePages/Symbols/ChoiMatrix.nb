(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    252494,       6525]
NotebookOptionsPosition[    232849,       6120]
NotebookOutlinePosition[    235456,       6183]
CellTagsIndexPosition[    235369,       6178]
WindowTitle->ChoiMatrix
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "46c61173-74fc-498f-971a-2c24ee5900e8"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "11fdb34c-1c25-4f3d-96f8-b543d34403ad"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "87c26be4-0d24-4a88-97ea-62677688c82d"]
         }],ExpressionUUID->"80c34b13-9ca3-4f76-88cf-93671559926b"],
         StripOnInput->False],{
        StyleBox["\"Supermap\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/Supermap"], 
         StyleBox[
          "\"LindbladSupermap\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/LindbladSupermap"], 
         StyleBox["\"LieBasis\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/LieBasis"], 
         StyleBox[
          "\"LieBasisMatrix\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/LieBasisMatrix"], 
         StyleBox[
          "\"ChoiMultiply\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ChoiMultiply"], 
         StyleBox["\"ChoiTopple\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ChoiTopple"], 
         StyleBox[
          "\"ToSuperMatrix\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ToSuperMatrix"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "4d7e1c3d-264b-42aa-b03d-8f5ed61983d8"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "720c15ca-5a6c-48f0-a390-ff4546f4789e"]
         }],ExpressionUUID->"33cd3cb4-f4d4-40bb-90ab-3b783ff38ba1"],
         StripOnInput->False],{
        "\"Dynamical Process of Decoherence\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/DynamicalProcessOfDecoherence"], 
         "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "70d603e7-b1e5-407e-a5e7-8cbd6f1edea6"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "3f19a010-59bd-4908-8aa7-6c739eb1d762"]
         }],ExpressionUUID->"3dd92516-3f4b-403e-a347-7a7af468c37c"],
         StripOnInput->False],{
        "\"Choi Isomorphism\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/ChoiIsomorphism"], 
         "\"Quantum Noise and Decoherence\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumNoiseAndDecoherence"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "92a9b84e-e802-47db-b6ad-574b1fe669c5"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "d679ef14-1e4c-403b-b65d-48563c3f0820"]
         }],ExpressionUUID->"934ae888-aac0-4b19-90f1-41f8ac299383"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/ChoiMatrix\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/ChoiMatrix"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
ChoiMatrix.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/ChoiMatrix") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "d181fddf-a0e0-414b-b943-715995e02743"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "55b29cc0-a7d3-4209-bad3-d2524dbe4a09"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"64ae434f-d0d6-4713-b56d-1aafb6dd648d"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"1592cf99-d271-42f0-8ef5-f02ac914dd80"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "ChoiMatrix", "ObjectName",ExpressionUUID->
      "97f05f4b-272f-422f-8c16-0774dc221043"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"b790afeb-f06b-469a-808b-f7b401cba898"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "474399b9-a723-4b69-af85-a185473b3002"]
    }],ExpressionUUID->"a200ba16-7129-43a2-b427-24bf1d53c00d"], 
    "\[SpanFromLeft]"}
  }]], "ObjectNameGrid",ExpressionUUID->"9ba3bc41-815f-4472-ab11-\
30f9d78bf672"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["spec", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "0b361275-a6e4-418e-a0c6-1120b57dc2b1"],
     "\[LineSeparator]returns the Choi matrix of ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["Supermap"]], "paclet:QuantumMob/Q3/ref/Supermap", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["spec", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "fe15a914-54b6-4eb2-ac4c-529506a8fb11"],
     "."
    }],ExpressionUUID->"f2eec9f3-a617-4b85-bca4-779e6f7b416e"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        TemplateBox[{
          Cell[
           TextData["Supermap"]], "paclet:QuantumMob/Q3/ref/Supermap", 
          "QuantumMob Package Symbol"},
         "PackageLink",
         BaseStyle->"InlineFormula"], "[", 
        StyleBox["spec", "TI"], "]"}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "f932d33e-a34a-4075-9174-cf632133c9de"],
     "\[LineSeparator]is equivalent to ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["spec", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "f96fa486-4f1e-4c62-87b0-457220ca8a1c"],
     "."
    }],ExpressionUUID->"91f4c831-05b5-4c15-94c3-fb3fba91c5b6"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        TemplateBox[{
          Cell[
           TextData["LindbladSupermap"]], 
          "paclet:QuantumMob/Q3/ref/LindbladSupermap", 
          "QuantumMob Package Symbol"},
         "PackageLink",
         BaseStyle->"InlineFormula"], "[", 
        RowBox[{"{", 
         RowBox[{
          StyleBox["a", "TI"], ",", 
          SubscriptBox[
           StyleBox["b", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["b", "TI"], 
           StyleBox["2", "TR"]], ",", 
          StyleBox["\[Ellipsis]", "TR"]}], 
         StyleBox["}", "TR"]}], "]"}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "4000cf96-8801-4b7f-a82f-012a89c0dcc4"],
     "\[LineSeparator]returns the Choi matrix of the Lindblad generator, a \
superoperator generating the Markovian quantum operation associated with the \
effective Hamiltonian ",
     Cell[BoxData[
      StyleBox["a", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "137f0974-9588-4fe8-b3fc-6532b02e4c85"],
     " and the Lindblad operators ",
     Cell[BoxData[
      RowBox[{
       SubscriptBox[
        StyleBox["b", "TI"], 
        StyleBox["1", "TR"]], ",", 
       SubscriptBox[
        StyleBox["b", "TI"], 
        StyleBox["2", "TR"]], ",", 
       StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "fa748b3b-1b52-4955-bb3d-fb1d82a922be"],
     "."
    }],ExpressionUUID->"dd8229e3-b77d-4583-98fa-c06192e7bd19"]}
  }]], "Usage",
 CellID->982511436,ExpressionUUID->"e778ca5e-9eca-465b-b585-a98834eab187"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[CurrentValue[
         EvaluationCell[], "CellGroupOpen"] =!= Closed, 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"2a546222-59e2-4eeb-a6a3-b1ea03b7dcb6"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"fef02e7e-b034-4780-8753-1c3083444dfd"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"0b6fc82b-33fc-4cae-8bfa-754fe76ffe9b"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"dc5f8e6c-3aa6-4f61-aa9e-8e1824100b1b"]], \
"NotesSection",
 ShowGroupOpener->"Thumbnail",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->566420493,ExpressionUUID->"af69d77c-7b9f-4795-ba12-1da889eacb34"],

Cell[TextData[{
 "The allowed forms are the same as for ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Supermap"]], "paclet:QuantumMob/Q3/ref/Supermap", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f74d8626-91a2-43b6-b759-9fab57aa6e3a"],
 ":\[LineSeparator]- ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   StyleBox["a", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "69cd9198-0328-4935-8149-dbf88c34fc07"],
 "\[LineSeparator]- ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    StyleBox["a", "TI"], ",", 
    StyleBox["b", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "55d10a6e-9587-4bcc-8a1d-b69ba14b011b"],
 "\[LineSeparator]- ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      StyleBox["a", "TI"], 
      StyleBox["1", "TR"]], ",", 
     SubscriptBox[
      StyleBox["a", "TI"], 
      StyleBox["2", "TR"]], ",", 
     StyleBox["\[Ellipsis]", "TR"]}], "}"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2eb86a32-ec89-497a-96fe-436b78867617"],
 "\[LineSeparator]- ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["a", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["a", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "6ac65479-8a3c-43bb-9c6a-0d9e5ab01b1a"],
 "\[LineSeparator]- ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["a", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["a", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["11", "TR"]], ",", 
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["12", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["21", "TR"]], ",", 
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["22", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "077d4dba-1844-4748-8ebc-8800d3cd70b5"]
}], "Notes",
 CellID->277061214,ExpressionUUID->"cd98c20c-f225-4d80-8bd9-62f493fd4298"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "176ef1a9-5c39-4684-b0f1-5e9b474400f5"],
 " returns a forth-rank tensor, but is typically called a matrix regarding \
the first two and last two indexes as collective indices."
}], "Notes",
 CellID->1067943069,ExpressionUUID->"fdebe8b2-9d56-40f6-9ab1-6edcb7c99b15"],

Cell[TextData[{
 "Let \[ScriptCapitalV] and \[ScriptCapitalW] be vector spaces, and suppose \
that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{
         SubscriptBox["v", "i"]},
        "Ket"], "|", "i"}], "=", "1"}], ",", "2", ",", "\[Ellipsis]", ",", 
     "m"}], "}"}], TraditionalForm]],ExpressionUUID->
  "8cb0ed30-6b0d-4522-81ad-27ecd1e4d268"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{
         SubscriptBox["w", "j"]},
        "Ket"], "|", "j"}], "=", "1"}], ",", "2", ",", "\[Ellipsis]", ",", 
     "n"}], "}"}], TraditionalForm]],ExpressionUUID->
  "73aba11d-b601-4e46-af89-19d6a4d85ea5"],
 " be their respective orthonormal bases. Let ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalF]", ":", 
    RowBox[{
     RowBox[{"\[ScriptCapitalL]", "(", "\[ScriptCapitalV]", ")"}], "\[RightArrow]", 
     RowBox[{"\[ScriptCapitalL]", "(", "\[ScriptCapitalW]", ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"1bb8da6a-c5bd-4ebf-9350-76f324d4c89e"],
 " be a supermap from linear operators on ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalV]", TraditionalForm]],ExpressionUUID->
  "0d8f8617-ace7-4130-b012-71efe5a2d2be"],
 " to linear operators on ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalW]", TraditionalForm]],ExpressionUUID->
  "3decfbe3-80ae-455b-ad59-2185ee5f7cda"],
 ". The Choi matrix ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "83f9fa2f-07d1-4d5b-91d1-07bd36377123"],
 " of ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalF]", TraditionalForm]],ExpressionUUID->
  "05979433-3af4-47a4-900d-a3c1ba347b7b"],
 " is defined by\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalF]", "(", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["v", "k"]},
       "Ket"], 
      TemplateBox[{
        SubscriptBox["v", "l"]},
       "Bra"]}], ")"}], ":=", 
    RowBox[{
     UnderscriptBox["\[CapitalSigma]", 
      RowBox[{"i", "\[ThinSpace]", "j"}]], 
     TemplateBox[{
       SubscriptBox["w", "i"]},
      "Ket"], 
     SubscriptBox["C", 
      RowBox[{
       RowBox[{"i", "\[VeryThinSpace]", "k"}], ";", 
       RowBox[{"j", "\[VeryThinSpace]", "l"}]}]], 
     TemplateBox[{
       SubscriptBox["w", "j"]},
      "Bra"]}]}], TraditionalForm]],ExpressionUUID->
  "4fb0bf13-85dd-474d-8210-c79cb1837a68"],
 ".\[LineSeparator]More precisely, it is a forth-rank tensor, and yet is \
frequently called a matrix by regarding the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"i", ",", "k"}], ")"}], TraditionalForm]],ExpressionUUID->
  "2a579785-8a08-4ebc-9d1d-4ee15d049acc"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"j", ",", "l"}], ")"}], TraditionalForm]],ExpressionUUID->
  "6638d20a-ee3f-4537-afcf-12c11cbb945f"],
 " as collective indices."
}], "Notes",
 CellID->2071262949,ExpressionUUID->"1a98d20c-b91b-4cf1-a75c-1bb958b70098"],

Cell["\<\
If a supermap is completely positive, then its Choi matrix is positive.\
\>", "Notes",
 CellID->1804368584,ExpressionUUID->"3471f647-0413-4870-ad64-c980ff5092a4"],

Cell[TextData[{
 "The Choi matrix of supermap ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalF]", ":", 
    RowBox[{
     RowBox[{"\[ScriptCapitalL]", "(", "\[ScriptCapitalV]", ")"}], "\[RightArrow]", 
     RowBox[{"\[ScriptCapitalL]", "(", "\[ScriptCapitalW]", ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"5597956d-cd07-4f06-b313-995737ea16c4"],
 " defined by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalF]", "(", "\[Rho]", ")"}], ":=", 
    RowBox[{"A", "\[VeryThinSpace]", "\[Rho]", "\[VeryThinSpace]", 
     SuperscriptBox["B", "\[Dagger]"]}]}], TraditionalForm]],ExpressionUUID->
  "e2d7f9f8-70e8-4880-86b6-a1f73d1616c4"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", ",", 
    RowBox[{"B", "\[Element]", 
     RowBox[{"\[ScriptCapitalL]", "(", 
      RowBox[{"\[ScriptCapitalV]", ",", "\[ScriptCapitalW]"}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"5068ccd2-1d6b-42ef-9d22-5a798bbb9e4b"],
 ", is given by \[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", 
     RowBox[{
      RowBox[{"i", "\[VeryThinSpace]", "k"}], ";", 
      RowBox[{"j", "\[VeryThinSpace]", "l"}]}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["A", 
       RowBox[{"i", "\[VeryThinSpace]", "\[Kappa]"}]], 
      SubsuperscriptBox["B", 
       RowBox[{"j", "\[VeryThinSpace]", "l"}], "*"]}], "\[Congruent]", 
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{"A", "\[CircleTimes]", 
        SuperscriptBox["B", "*"]}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", ",", "j"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"k", ",", "l"}], ")"}]}]]}]}], TraditionalForm]],
  ExpressionUUID->"71a481a6-17c8-4c77-8f3d-ce9ff5f40282"],
 " . \[LineSeparator]The corresponding ",
 StyleBox["super-matrix",
  FontSlant->"Italic"],
 " is given by \[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", ",", "j"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"k", ",", "l"}], ")"}]}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["A", 
       RowBox[{"i", "\[VeryThinSpace]", "k"}]], 
      SubsuperscriptBox["B", 
       RowBox[{"j", "\[VeryThinSpace]", "l"}], "*"]}], "\[Congruent]", 
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{"A", "\[CircleTimes]", 
        SuperscriptBox["B", "*"]}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", ",", "j"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"k", ",", "l"}], ")"}]}]]}]}], TraditionalForm]],
  ExpressionUUID->"2d773efb-a699-4742-aabb-c884ad29bfcf"],
 "; \[LineSeparator]that is, \[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", ",", "j"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"k", ",", "l"}], ")"}]}]], "=", 
    SubscriptBox["C", 
     RowBox[{
      RowBox[{"i", "\[VeryThinSpace]", "k"}], ";", 
      RowBox[{"j", "\[VeryThinSpace]", "l"}]}]]}], TraditionalForm]],
  ExpressionUUID->"65e8325c-0ec9-4015-8420-7e1cbcfe3348"],
 " ."
}], "Notes",
 CellID->544097144,ExpressionUUID->"02c4b273-c793-4797-ad3b-b17044ab7a76"],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalF]", ":", 
    RowBox[{"\[Rho]", "\[RightTeeArrow]", "\[Sigma]"}]}], TraditionalForm]],
  ExpressionUUID->"4d92c6c8-60f7-4fce-9970-3346ab6fd4cd"],
 " be a supermap, and ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "0ab8c233-da18-4669-a6b9-93c67e6f1de6"],
 " its Choi matrix. Then, the components of \[Rho] and \[Sigma] are related \
by the transformation\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"i", "\[VeryThinSpace]", "j"}]], "=", 
    RowBox[{
     RowBox[{
      UnderscriptBox["\[CapitalSigma]", 
       RowBox[{"k", "\[VeryThinSpace]", "l"}]], 
      SubscriptBox["C", 
       RowBox[{
        RowBox[{"i", "\[VeryThinSpace]", "k"}], ";", 
        RowBox[{"j", "\[VeryThinSpace]", "l"}]}]], 
      SubscriptBox["\[Rho]", 
       RowBox[{"k", "\[VeryThinSpace]", "l"}]]}], "=", 
     RowBox[{
      UnderscriptBox["\[CapitalSigma]", 
       RowBox[{"k", "\[VeryThinSpace]", "l"}]], 
      SubscriptBox["M", 
       RowBox[{
        RowBox[{"i", "\[VeryThinSpace]", "j"}], ";", 
        RowBox[{"k", "\[VeryThinSpace]", "l"}]}]], 
      SubscriptBox["\[Rho]", 
       RowBox[{"k", "\[VeryThinSpace]", "l"}]]}]}]}], TraditionalForm]],
  ExpressionUUID->"fe73b9f7-d694-4d12-b80e-aa813c8d9454"],
 " ."
}], "Notes",
 CellID->688867986,ExpressionUUID->"ef667d84-f535-45d5-8509-f83395e28e0c"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"1dde44af-31cd-49c8-aee8-7f9097a1ff58"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"b7e916c3-0c45-40a6-885f-241fc3058a62"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(6)", "ExampleCount",ExpressionUUID->
  "2866cf9c-6bd4-43d2-a69f-f36d0bb89d7d"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->34218700,ExpressionUUID->"667245b0-8ae0-4d31-b2ea-2fb7aa8a1e90"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1927565408,ExpressionUUID->"c22ac42b-a902-4ed1-90b0-18ae171f20d3"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"e18a7d1c-6343-4611-bef5-036b335589b8"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"145dc697-15a1-4588-97bf-afe6d89431a3"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "4f9ed802-d9e9-4321-bb61-19ac016e2148"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1735557151,ExpressionUUID->"9629098a-8912-4468-b12d-9f5b246240ed"],

Cell["Let us consider supermaps transforming matrices of the form.", \
"ExampleText",
 CellID->553412081,ExpressionUUID->"eb59fe33-5349-4dbf-9626-4f5c902ce1c7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "\[Rho]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"\[Rho]", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->445170210,ExpressionUUID->"9be8ea26-3e4d-41b9-a466-05e1f0a944ee"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"1", "\",\"", "1"},
         "RowDefault"]],
       $CellContext`\[Rho][1, 1]], 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"1", "\",\"", "2"},
         "RowDefault"]],
       $CellContext`\[Rho][1, 2]]},
     {
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"2", "\",\"", "1"},
         "RowDefault"]],
       $CellContext`\[Rho][2, 1]], 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"2", "\",\"", "2"},
         "RowDefault"]],
       $CellContext`\[Rho][2, 2]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[1]//MatrixForm=",
 CellID->1409239597,ExpressionUUID->"07d30555-8b79-4d96-83aa-7f82f8640027"]
}, Open  ]],

Cell["Here is a supermap.", "ExampleText",
 CellID->925413985,ExpressionUUID->"04e8e946-6daf-46fc-9225-0cc3a7234a80"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"ThePauli", "[", "4", "]"}]}], ",", 
     RowBox[{"ThePauli", "[", "5", "]"}], ",", 
     RowBox[{"ThePauli", "[", "6", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"spr", "=", 
  RowBox[{"Supermap", "[", "ops", "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1356274321,ExpressionUUID->"21f06609-b715-4ecc-982d-6e7d07e88792"],

Cell[BoxData[
 RowBox[{"Supermap", "[", 
  InterpretationBox[
   RowBox[{
    TagBox["SparseArray",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["16", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["16", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["0", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["1.`", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"\"", "SummaryItem"]}]}, {
                TagBox[
                 TagBox[
                  GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["1", "2"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   DefaultBaseStyle -> "Column", 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                  "Column"], "SummaryItem"]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   SparseArray[
   Automatic, {2, 2, 2, 2}, 0, {
    1, {{0, 8, 16}, {{1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {2, 1, 2}, {
      2, 1, 1}, {2, 2, 1}, {2, 2, 2}, {1, 2, 1}, {1, 1, 1}, {1, 1, 2}, {1, 2, 
      2}, {2, 1, 1}, {2, 1, 2}, {2, 2, 1}, {2, 2, 2}}}, {
     Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], 
      Rational[9, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], 
      Rational[3, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], 
      Rational[-1, 2], Rational[-1, 2], Rational[-1, 2], Rational[1, 2]}}],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1853783995,ExpressionUUID->"f33a0def-6201-443a-804b-1081677fcef1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{"spr", "[", "rho", "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1022965681,ExpressionUUID->"3149bdd5-47e2-48f5-acfe-9b0ab82ee96a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "+", 
         RowBox[{"9", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"\[Rho]"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`\[Rho][2, 2]]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"\[Rho]"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`\[Rho][1, 1]]}], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[3]//MatrixForm=",
 CellID->1934230348,ExpressionUUID->"3313d9e0-f161-4802-97a9-399d71d97559"]
}, Open  ]],

Cell["This gives the Choi matrix corresponding to the supermap.", \
"ExampleText",
 CellID->1016862214,ExpressionUUID->"693dcb76-eb2d-42e0-8ede-4c8a03133229"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tsr", "=", 
  RowBox[{"ChoiMatrix", "[", "ops", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->643632301,ExpressionUUID->"ce220797-11cc-4d1a-a8fd-846038d0a667"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["16", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["16", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1.`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["1", "2"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {2, 2, 2, 2}, 0, {
   1, {{0, 8, 16}, {{1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {2, 1, 2}, {2,
      1, 1}, {2, 2, 1}, {2, 2, 2}, {1, 2, 1}, {1, 1, 1}, {1, 1, 2}, {1, 2, 
     2}, {2, 1, 1}, {2, 1, 2}, {2, 2, 1}, {2, 2, 2}}}, {
    Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], Rational[
     9, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], Rational[3, 2], 
     Rational[1, 2], Rational[1, 2], Rational[-1, 2], Rational[-1, 2], 
     Rational[-1, 2], Rational[-1, 2], Rational[1, 2]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1734096540,ExpressionUUID->"8495b9b1-c400-44bf-beab-14ff79274df2"]
}, Open  ]],

Cell["\<\
The Choi matrix provides a matrix representation of the supermap.\
\>", "ExampleText",
 CellID->1355606217,ExpressionUUID->"4db7730e-ad66-42fd-b5eb-8ae17cf06ed0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", "rho"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"more", "//", "SimplifyThrough"}], "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1592314655,ExpressionUUID->"c052f638-0423-4530-85cf-f7d33b5dabef"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "+", 
         RowBox[{"9", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"\[Rho]"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`\[Rho][2, 2]]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"\[Rho]"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`\[Rho][1, 1]]}], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {1}, {2}}}, {
      Rational[1, 2] ($CellContext`\[Rho][1, 1] + $CellContext`\[Rho][
         1, 2] + $CellContext`\[Rho][2, 1] + 9 $CellContext`\[Rho][2, 2]), 
       Rational[1, 2] ($CellContext`\[Rho][1, 1] - $CellContext`\[Rho][
        1, 2] + $CellContext`\[Rho][2, 1] - $CellContext`\[Rho][2, 2]), 
       Rational[
        1, 2] ($CellContext`\[Rho][1, 1] + $CellContext`\[Rho][
         1, 2] - $CellContext`\[Rho][2, 1] - $CellContext`\[Rho][2, 2]), 
       Rational[1, 2] (3 $CellContext`\[Rho][1, 1] - $CellContext`\[Rho][
        1, 2] - $CellContext`\[Rho][
        2, 1] + $CellContext`\[Rho][2, 2])}}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->2073499931,ExpressionUUID->"7428a18b-53ef-42a7-aff1-43aa1b963c2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "more"}], "//", "SimplifyThrough"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1640340825,ExpressionUUID->"c89cebdc-4ff5-439d-9478-3a5650a3d0c5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1407484755,ExpressionUUID->"206a4747-2955-4218-b0e9-3c0aa353345b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "9e94ba74-3aac-4775-bad6-80832a846594"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1958003159,ExpressionUUID->"c7b62030-ad21-4c75-bda5-2fc3e1d11f51"],

Cell["\<\
The above example with unlabelled qubits can be worked out for labelled \
qubits as well.\
\>", "ExampleText",
 CellID->2112320759,ExpressionUUID->"edc193aa-5534-459d-bcdf-162639fb16ff"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1529421203,ExpressionUUID->"8411f557-502b-4bec-9f40-0eba294c3b7f"],

Cell["We consider supermaps transforming operators of the form", "ExampleText",
 CellID->910124769,ExpressionUUID->"02bb4011-9d6e-43d9-818d-59fb768cf45e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "\[Rho]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "=", 
  RowBox[{
   RowBox[{"\[Rho]", "@", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}]}], ".", 
   RowBox[{"S", "[", "Full", "]"}]}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1171754921,ExpressionUUID->"6880a7f5-1d9e-4442-b480-cd0a05ec200d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"0"}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[0]], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`\[Rho][0]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"X\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[1]], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`\[Rho][1]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"Y\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[2]], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    $CellContext`\[Rho][2]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"Z\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[3]], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"3"},
      "RowDefault"]],
    $CellContext`\[Rho][3]]}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->64790341,ExpressionUUID->"568adbeb-83a8-4173-98be-156ec190b65d"]
}, Open  ]],

Cell["\<\
Here is a supermap, specified by a set of three Kraus elements.\
\>", "ExampleText",
 CellID->659929661,ExpressionUUID->"a5077c8b-26c2-4c70-849e-1461102f7099"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"S", "[", "4", "]"}]}], ",", 
     RowBox[{"S", "[", "5", "]"}], ",", 
     RowBox[{"S", "[", "6", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"spr", "=", 
  RowBox[{"Supermap", "[", "ops", "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2146884351,ExpressionUUID->"82ca9c98-ecd7-40d3-95b3-775fe87f0c40"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["Supermap",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"completely positive\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Kraus elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"completely positive\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Kraus elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Kraus elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    InterpretationBox[
                    TemplateBox[{
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"\"+\""}, "RowDefault"]}, "Superscript", 
                    SyntaxForm -> SuperscriptBox], 
                    $CellContext`S[4]]}], ",", 
                    InterpretationBox[
                    TemplateBox[{
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"\"-\""}, "RowDefault"]}, "Superscript", 
                    SyntaxForm -> SuperscriptBox], 
                    $CellContext`S[5]], ",", 
                    InterpretationBox[
                    TemplateBox[{
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"\"H\""}, "RowDefault"]}, "Superscript", 
                    SyntaxForm -> SuperscriptBox], 
                    $CellContext`S[6]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`Supermap[{2 $CellContext`S[4], 
    $CellContext`S[5], 
    $CellContext`S[6]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1862438804,ExpressionUUID->"a449828b-784e-4d1f-beff-5e55828f06aa"]
}, Open  ]],

Cell[TextData[{
 "Under the supermap, the operator ",
 StyleBox["rho", "Input"],
 " transforms as follows."
}], "ExampleText",
 CellID->1760269154,ExpressionUUID->"9627ec96-3855-4b60-833f-43094787135e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"spr", "[", "rho", "]"}], "//", "Elaborate"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1142711461,ExpressionUUID->"a09de5aa-7686-40aa-9ae0-4e3bc591d9d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"\"Y\""}, "RowDefault"]},
      "Superscript"],
     $CellContext`S[2]]}], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    $CellContext`\[Rho][2]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"7", " ", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"0"},
         "RowDefault"]],
       $CellContext`\[Rho][0]]}], "-", 
     RowBox[{"3", " ", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"3"},
         "RowDefault"]],
       $CellContext`\[Rho][3]]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"Z\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[3]], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"0"},
          "RowDefault"]],
        $CellContext`\[Rho][0]]}], "2"], "+", 
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"\[Rho]"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]],
      $CellContext`\[Rho][1]], "-", 
     FractionBox[
      RowBox[{"5", " ", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"3"},
          "RowDefault"]],
        $CellContext`\[Rho][3]]}], "2"]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"X\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[1]], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"3"},
      "RowDefault"]],
    $CellContext`\[Rho][3]]}]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1934352376,ExpressionUUID->"fcfa8934-4d13-4efc-9ad6-47983e1e22e2"]
}, Open  ]],

Cell["This gives the Choi matrix corresponding to the supermap.", \
"ExampleText",
 CellID->1244330407,ExpressionUUID->"eed6b962-9173-443f-8e93-55d8eeb08227"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tsr", "=", 
   RowBox[{"ChoiMatrix", "[", "spr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "@", "tsr"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1265395963,ExpressionUUID->"6251085c-361a-4a0d-96e0-3cd9126529ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1660482032,ExpressionUUID->"ccf63bfd-b0d6-4108-af3f-d48454a11238"]
}, Open  ]],

Cell["\<\
The Choi matrix provides a matrix representation of the supermap.\
\>", "ExampleText",
 CellID->211123045,ExpressionUUID->"e9a9a458-1e61-4ee5-914e-cd652636cec1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", 
       RowBox[{"Matrix", "@", "rho"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"more", "//", "SimplifyThrough"}], "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->702032471,ExpressionUUID->"077f766e-bf98-434a-a1b3-5a264fe37d74"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"5", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"\[Rho]"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         $CellContext`\[Rho][0]]}], "+", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]],
        $CellContext`\[Rho][1]], "-", 
       RowBox[{"4", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"\[Rho]"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`\[Rho][3]]}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"\[Rho]"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`\[Rho][2]]}], "+", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"3"},
          "RowDefault"]],
        $CellContext`\[Rho][3]]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"\[Rho]"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`\[Rho][2]]}], "+", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"3"},
          "RowDefault"]],
        $CellContext`\[Rho][3]]}], 
      RowBox[{
       RowBox[{"2", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"\[Rho]"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         $CellContext`\[Rho][0]]}], "-", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]],
        $CellContext`\[Rho][1]], "+", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"3"},
          "RowDefault"]],
        $CellContext`\[Rho][3]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {1}, {2}}}, {
      5 $CellContext`\[Rho][0] + $CellContext`\[Rho][1] - 
       4 $CellContext`\[Rho][3], 
       Complex[0, 1] $CellContext`\[Rho][2] + $CellContext`\[Rho][3], 
       Complex[0, -1] $CellContext`\[Rho][2] + $CellContext`\[Rho][3], 
       2 $CellContext`\[Rho][0] - $CellContext`\[Rho][
       1] + $CellContext`\[Rho][3]}}]]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->756947743,ExpressionUUID->"443aeb4f-e50d-4bf1-b370-0291ba3e7588"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "-", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"more", ",", "S"}], "]"}]}], "//", "Elaborate"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->944938973,ExpressionUUID->"dde2246a-b1e5-48d3-a9e3-91055fa704ae"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[7]=",
 CellID->1622060024,ExpressionUUID->"b9686ed8-236f-408c-a674-bf6931517555"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "a9e9681f-c148-4779-bcd6-0251958b51fa"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->104323313,ExpressionUUID->"d7fd4734-f3ea-423b-8860-35d62c1495a6"],

Cell["This is the case of completely positive supermap .", "ExampleText",
 CellID->1003924897,ExpressionUUID->"ee0f46de-50b1-429a-802c-be55f1f14683"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kbs", "=", 
   RowBox[{"LieBasis", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "kbs"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->2047323406,ExpressionUUID->"8a1319c1-ed6a-418b-93b3-1739cc26f829"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["3"]], "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["3"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 3}, {{1}, {2}, {3}}}, {
        3^Rational[-1, 2], 3^Rational[-1, 2], 3^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{2}, {1}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}], "0"},
       {
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0", "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{2}, {1}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["2"]]}], "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{1}, {2}}}, {
        2^Rational[-1, 2], -2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", "0", "0"},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 1, 2}, {{3}, {1}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}]},
       {"0", "0", "0"},
       {
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 1, 2}, {{3}, {1}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 0, 1, 2}, {{3}, {2}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}]},
       {"0", 
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 0, 1, 2}, {{3}, {2}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["6"]], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["6"]], "0"},
       {"0", "0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "3"]]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 3}, {{1}, {2}, {3}}}, {
        6^Rational[-1, 2], 6^Rational[-1, 2], -
         Rational[2, 3]^Rational[1, 2]}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->845187401,ExpressionUUID->"c584abd9-880b-461e-a9c0-2f54c9d1020e"]
}, Open  ]],

Cell["\<\
Consider a quantum operation, i.e., a completely positive supermap.\
\>", "ExampleText",
 CellID->885184976,ExpressionUUID->"00a2e634-703d-457d-8e0c-ce7a4ec19d37"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"$n", "^", "2"}]}], "]"}], "*", "kbs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"superOp", "=", 
  RowBox[{"Supermap", "[", "ops", "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->2044491245,ExpressionUUID->"8e63d876-afb4-43ef-8950-95e3d4e04d9f"],

Cell[BoxData[
 RowBox[{"Supermap", "[", 
  InterpretationBox[
   RowBox[{
    TagBox["SparseArray",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["21", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["21", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["0.25925925925925924`", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"\"", "SummaryItem"]}]}, {
                TagBox[
                 TagBox[
                  GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.1440254998038097`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.1286707741612999`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.2725683347989404`"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.7686726452836881`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   DefaultBaseStyle -> "Column", 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                  "Column"], "SummaryItem"]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   SparseArray[
   Automatic, {3, 3, 3, 3}, Complex[0., 0.], {
    1, {{0, 7, 14, 21}, {{1, 1, 1}, {1, 2, 2}, {1, 3, 3}, {2, 1, 2}, {2, 2, 
      1}, {3, 1, 3}, {3, 3, 1}, {1, 1, 2}, {1, 2, 1}, {2, 1, 1}, {2, 2, 2}, {
      2, 3, 3}, {3, 2, 3}, {3, 3, 2}, {1, 1, 3}, {1, 3, 1}, {2, 2, 3}, {2, 3, 
      2}, {3, 1, 1}, {3, 2, 2}, {3, 3, 3}}}, CompressedData["
1:eJxTTMoPShNlYGAoZgESPpnFJWlMIB47kHDOzy3ISa0o+uayszQ3/5B9EQMU
YCr5s6RmvUfFAXxKmvb9KDlUeHE/HiV8EVIJ32e8wGdKntyiL2w+h/EpcS0+
3VGtvx6fkrOHzh2977oSn1uIsIgI5xIRLkSELhFBdy83++v5NefxmSKX7xht
GYxXCRHhQkToEmEREc4lwtNEKNlz8+Thc0UPERYBAOoqwkw=
     "]}],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->86247225,ExpressionUUID->"6d39fc88-fede-49bf-bf69-ad7dd30faa85"]
}, Open  ]],

Cell["\<\
This is the corresponding Choi matrix. In fact, it is a fourth-rank tensor.\
\>", "ExampleText",
 CellID->404204944,ExpressionUUID->"881295cc-8469-412c-8cfb-f83f1bf6bd50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tsr", "=", 
  RowBox[{"ChoiMatrix", "[", "ops", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->315678790,ExpressionUUID->"8cf17f8f-2f06-4aad-a5e7-6be1c05846ba"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["21", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["21", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.25925925925925924`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.1440254998038097`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.1286707741612999`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.2725683347989404`"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.7686726452836881`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {3, 3, 3, 3}, Complex[0., 0.], {
   1, {{0, 7, 14, 21}, {{1, 1, 1}, {1, 2, 2}, {1, 3, 3}, {2, 1, 2}, {2, 2, 
     1}, {3, 1, 3}, {3, 3, 1}, {1, 1, 2}, {1, 2, 1}, {2, 1, 1}, {2, 2, 2}, {2,
      3, 3}, {3, 2, 3}, {3, 3, 2}, {1, 1, 3}, {1, 3, 1}, {2, 2, 3}, {2, 3, 
     2}, {3, 1, 1}, {3, 2, 2}, {3, 3, 3}}}, CompressedData["
1:eJxTTMoPShNlYGAoZgESPpnFJWlMIB47kHDOzy3ISa0o+uayszQ3/5B9EQMU
YCr5s6RmvUfFAXxKmvb9KDlUeHE/HiV8EVIJ32e8wGdKntyiL2w+h/EpcS0+
3VGtvx6fkrOHzh2977oSn1uIsIgI5xIRLkSELhFBdy83++v5NefxmSKX7xht
GYxXCRHhQkToEmEREc4lwtNEKNlz8+Thc0UPERYBAOoqwkw=
    "]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1875087885,ExpressionUUID->"93bfc7f9-511c-4aed-9cfa-da9131889fcf"]
}, Open  ]],

Cell["\<\
Regarding the first two indices collectively as a single index and similarly \
for the last two indices, the Choi matrix is a positive matrix.\
\>", "ExampleText",
 CellID->905156507,ExpressionUUID->"c0209638-1df9-4417-bd79-89908aac8ef1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"tsr", ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "9"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"HermitianMatrixQ", "@", "mat"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eigenvalues", "[", "mat", "]"}], "//", "TableForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1963657499,ExpressionUUID->"2ebe4856-20f9-427b-b15e-a55879c0b8ac"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[4]=",
 CellID->1544102239,ExpressionUUID->"68c468c3-c4eb-4920-8f78-cec5ee442ecf"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"0.9194303103931724`"},
     {"0.8178329435629903`"},
     {"0.6179149801742043`"},
     {"0.49218861045094525`"},
     {"0.11027036032201566`"},
     {"0.015354725642509824`"},
     {"0.011547915985233564`"},
     {"0.00273401763478465`"},
     {"0.00012793916616904433`"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[4]//TableForm=",
 CellID->1533940525,ExpressionUUID->"1363c1f5-7759-4211-a571-f2f1a7057324"]
}, Open  ]],

Cell["\<\
To illustrate the Choi isomorphism between supermaps and linear maps, let us \
consider an operator (not necessary a density operator) on a vector space.\
\>", "ExampleText",
 CellID->1014268615,ExpressionUUID->"69767926-9e1a-4efc-b47b-b55ea75a6a60"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"RandomMatrix", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->85447438,ExpressionUUID->"ecbf8729-d1a3-4532-b695-62a483bfff9d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.634508885698096`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.7321080884756506`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.9105527080635816`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3418541387717875`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.33778914809844585`"}], "+", 
       RowBox[{"0.041916290186096106`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.022428715837329527`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6389297391427418`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.8629526274129238`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3279304709197146`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3520498658885205`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5104993171125289`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.9651535567787146`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.055257987464413016`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3302697705759021`"}], "-", 
       RowBox[{"0.2758496091490752`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5882479199708461`"}], "-", 
       RowBox[{"0.10721996449655435`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1563663790,ExpressionUUID->"c2f4c050-ab9f-4c5d-8f5b-c58217a432e5"]
}, Open  ]],

Cell["\<\
This is the new linear operator obtained by operating the Supermap on \[Rho]. \
\>", "ExampleText",
 CellID->543923410,ExpressionUUID->"41cca1ef-fc63-42a1-9d07-f11e1b788204"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"superOp", "[", "\[Rho]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->717229906,ExpressionUUID->"9d87a8ae-d51c-4b77-84db-1898cf0d990a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.718883864434541`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.14009827356751792`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.12054282269224906`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.14031019232818173`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04442946646757904`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.014152655212782443`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.14015872045701608`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13374871593942217`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.46644820383675034`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5420539043329988`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.17678367374978182`"}], "+", 
       RowBox[{"0.07163801971907938`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.24639661261108986`"}], "-", 
       RowBox[{"0.01713061693986642`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.17617729328002663`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04974524907441852`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06855599142413676`"}], "-", 
       RowBox[{"0.02190521944877042`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1350554867,ExpressionUUID->"97d8eb2a-517b-4d10-9870-e52d8fbcb325"]
}, Open  ]],

Cell["The same can be achieved by using the Choi matrix as well.", \
"ExampleText",
 CellID->688108930,ExpressionUUID->"f9e117ec-88eb-4e6d-9440-5ef33cdcfcf2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", "\[Rho]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"more", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->30075672,ExpressionUUID->"afb64015-4e08-474c-b4b2-2e7b0cf0b57f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.718883864434541`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.14009827356751792`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.12054282269224906`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.14031019232818173`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04442946646757904`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.014152655212782443`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.14015872045701608`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13374871593942217`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.46644820383675023`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5420539043329987`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.17678367374978182`"}], "+", 
       RowBox[{"0.07163801971907938`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.24639661261108986`"}], "-", 
       RowBox[{"0.01713061693986642`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.17617729328002663`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04974524907441852`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06855599142413679`"}], "-", 
       RowBox[{"0.02190521944877042`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0., {
     1, {{0, 3, 6, 9}, {{1}, {3}, {2}, {2}, {3}, {1}, {3}, {2}, {1}}}, {
      Complex[0.718883864434541, 0.14009827356751792`], Complex[
      0.04442946646757904, -0.014152655212782443`], Complex[
      0.12054282269224906`, 0.14031019232818173`], Complex[
      0.46644820383675023`, -0.5420539043329987], 
      Complex[-0.17678367374978182`, 0.07163801971907938], Complex[
      0.14015872045701608`, 0.13374871593942217`], 
      Complex[-0.06855599142413679, -0.02190521944877042], Complex[
      0.17617729328002663`, -0.04974524907441852], 
      Complex[-0.24639661261108986`, -0.01713061693986642]}}]]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->623842255,ExpressionUUID->"4dfab282-ee2f-420a-9610-df58efac3535"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "more"}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->931479859,ExpressionUUID->"58b52987-097d-4b85-8d40-5c4ee6697708"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->566641342,ExpressionUUID->"883eac4f-ef2a-4c87-88aa-7b971e5dfcf8"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "d3ced670-0683-47c5-9e94-0c37529992dd"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"d100a6d3-dc4e-45ec-a9df-d8986d27565f"],
 "Generalizations & Extensions",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "c6aae083-c56d-4b82-97f6-5505243cbf85"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1020263627,ExpressionUUID->"d146a38a-28e1-4604-b368-1859018d1033"],

Cell["\<\
The Lindblad generator of a Markovian quantum operation is a special \
supermap. Let us examine its Choi matrix. Consider supermaps transforming \
density matrices of the following form.\
\>", "ExampleText",
 CellID->828732181,ExpressionUUID->"fd63970d-c2ad-4e7d-9e44-8791581897f1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "r"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"r", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->333277970,ExpressionUUID->"b8f0815b-297d-42e8-a96d-c838f318ceb6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"r"},
         "RowDefault"], 
        TemplateBox[{"1", "\",\"", "1"},
         "RowDefault"]],
       $CellContext`r[1, 1]], 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"r"},
         "RowDefault"], 
        TemplateBox[{"1", "\",\"", "2"},
         "RowDefault"]],
       $CellContext`r[1, 2]]},
     {
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"r"},
         "RowDefault"], 
        TemplateBox[{"2", "\",\"", "1"},
         "RowDefault"]],
       $CellContext`r[2, 1]], 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"r"},
         "RowDefault"], 
        TemplateBox[{"2", "\",\"", "2"},
         "RowDefault"]],
       $CellContext`r[2, 2]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[1]//MatrixForm=",
 CellID->515710983,ExpressionUUID->"a9626a17-4515-43a1-8707-98ac088f73b8"]
}, Open  ]],

Cell["First, consider the case where there is no dissipative term.", \
"ExampleText",
 CellID->2006817625,ExpressionUUID->"5fa9b57a-d35d-472b-8598-d9ee59346854"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"opH", "=", 
   RowBox[{"ThePauli", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gen", "=", 
  RowBox[{"LindbladSupermap", "[", 
   RowBox[{"opH", ",", "None"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->2123398300,ExpressionUUID->"5db0f017-e5fc-40b2-8033-25278120fa7e"],

Cell[BoxData[
 RowBox[{"Supermap", "[", 
  InterpretationBox[
   RowBox[{
    TagBox["SparseArray",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["8", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["8", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["0", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["0.5`", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"\"", "SummaryItem"]}]}, {
                TagBox[
                 TagBox[
                  GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "\[ImaginaryI]", ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "\[ImaginaryI]", ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "\[ImaginaryI]"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "\[ImaginaryI]"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   DefaultBaseStyle -> "Column", 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                  "Column"], "SummaryItem"]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   SparseArray[
   Automatic, {2, 2, 2, 2}, 0, {
    1, {{0, 4, 8}, {{1, 1, 2}, {1, 2, 1}, {2, 1, 1}, {2, 2, 2}, {2, 1, 2}, {2,
       2, 1}, {1, 1, 1}, {1, 2, 2}}}, {
     Complex[0, 1], Complex[0, 1], Complex[0, -1], Complex[0, -1], Complex[
      0, 1], Complex[0, 1], Complex[0, -1], Complex[0, -1]}}],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->676799938,ExpressionUUID->"58953e99-e438-4c76-93f0-fab175e716c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"gen", "[", "\[Rho]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1152364753,ExpressionUUID->"f1c79568-d370-40c1-a9ac-d4d633c14b1d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[3]//MatrixForm=",
 CellID->616039658,ExpressionUUID->"253d9a8c-1d38-4360-88d9-73849767a8ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tsr", "=", 
  RowBox[{"ChoiMatrix", "[", "gen", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->2118928092,ExpressionUUID->"3b51d49d-b7f5-4309-9c9c-7ebefacef95f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.5`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "\[ImaginaryI]", ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "\[ImaginaryI]", ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "\[ImaginaryI]"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "\[ImaginaryI]"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {2, 2, 2, 2}, 0, {
   1, {{0, 4, 8}, {{1, 1, 2}, {1, 2, 1}, {2, 1, 1}, {2, 2, 2}, {2, 1, 2}, {2, 
     2, 1}, {1, 1, 1}, {1, 2, 2}}}, {
    Complex[0, 1], Complex[0, 1], Complex[0, -1], Complex[0, -1], Complex[
     0, 1], Complex[0, 1], Complex[0, -1], Complex[0, -1]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->72703027,ExpressionUUID->"d1b5bc67-09d0-43fa-85f2-800cb8734f3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", "\[Rho]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"more", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1481207322,ExpressionUUID->"901802b8-81da-454b-9272-eff576a47d62"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Complex[0, 1] $CellContext`r[1, 2] + 
       Complex[0, -1] $CellContext`r[2, 1], 
       Complex[0, 1] $CellContext`r[1, 1] + 
       Complex[0, -1] $CellContext`r[2, 2], 
       Complex[0, -1] $CellContext`r[1, 2] + 
       Complex[0, 1] $CellContext`r[2, 1], 
       Complex[0, -1] $CellContext`r[1, 1] + 
       Complex[0, 1] $CellContext`r[2, 2]}}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1825992849,ExpressionUUID->"a408c13e-c5b6-4bc5-bf55-03422def9a03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "more"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->408110433,ExpressionUUID->"e119d86d-e823-447e-bb06-43d59c6610da"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->944807076,ExpressionUUID->"84f8be71-b3c9-4cf0-8043-9ae60d4bd075"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "836a1339-335a-449c-8ca9-b392928f7826"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1374347092,ExpressionUUID->"5bb03271-d7bb-454b-ad19-443869679fe1"],

Cell["Next, consider a general case with dissipative terms.", "ExampleText",
 CellID->2037101859,ExpressionUUID->"ce5e5c7a-386f-4095-b012-ab97cb210cb5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"opH", "=", 
   RowBox[{"ThePauli", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opL", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"ThePauli", "[", "4", "]"}]}], ",", 
     RowBox[{"ThePauli", "[", "5", "]"}], ",", 
     RowBox[{"ThePauli", "[", "6", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gen", "=", 
  RowBox[{"LindbladSupermap", "[", 
   RowBox[{"opH", ",", "opL"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->239160092,ExpressionUUID->"f18ff2a8-9457-4ab5-a14d-98e3fc550a70"],

Cell[BoxData[
 RowBox[{"Supermap", "[", 
  InterpretationBox[
   RowBox[{
    TagBox["SparseArray",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["16", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["16", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["0", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["1.`", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"\"", "SummaryItem"]}]}, {
                TagBox[
                 TagBox[
                  GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["3", "2"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    FractionBox["1", "2"], "+", "\[ImaginaryI]"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    FractionBox["1", "2"], "+", "\[ImaginaryI]"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "4"}], ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   DefaultBaseStyle -> "Column", 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                  "Column"], "SummaryItem"]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   SparseArray[
   Automatic, {2, 2, 2, 2}, 0, {
    1, {{0, 8, 16}, {{1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {2, 1, 1}, {
      2, 2, 2}, {2, 1, 2}, {2, 2, 1}, {2, 1, 1}, {2, 1, 2}, {2, 2, 1}, {2, 2, 
      2}, {1, 1, 1}, {1, 2, 2}, {1, 2, 1}, {1, 1, 2}}}, {
     Rational[-3, 2], Complex[Rational[1, 2], 1], Complex[
      Rational[1, 2], 1], -4, Complex[Rational[1, 2], -1], Complex[
      Rational[-1, 2], -1], Rational[9, 2], Rational[1, 2], -4, Complex[
      Rational[-1, 2], 1], Complex[Rational[-1, 2], 1], Rational[-9, 2], 
      Complex[Rational[1, 2], -1], Complex[Rational[-1, 2], -1], Rational[
      3, 2], Rational[1, 2]}}],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], "]"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->966871551,ExpressionUUID->"6faee255-d1c4-4df7-89d9-f12b68b2351a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{"gen", "[", "\[Rho]", "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->405914056,ExpressionUUID->"df012044-d7e7-47a2-a7fe-15b41b7b17cb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[1, 1]]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[1, 2]]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[2, 1]]}], "+", 
         RowBox[{"9", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[2, 2]]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[1, 1]]}], "-", 
         RowBox[{"8", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[1, 2]]}], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"r"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`r[2, 1]], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[2, 2]]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[1, 1]]}], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"r"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`r[1, 2]], "-", 
         RowBox[{"8", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[2, 1]]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[2, 2]]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[1, 1]]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[1, 2]]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[2, 1]]}], "-", 
         RowBox[{"9", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[2, 2]]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1541136071,ExpressionUUID->"ec505a8c-05c5-4c62-8395-41ed224cc7f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tsr", "=", 
  RowBox[{"ChoiMatrix", "[", "gen", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1103368825,ExpressionUUID->"d1773a15-9b7e-41cc-a2b9-4d00bc5fe085"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["16", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["16", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1.`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["3", "2"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    FractionBox["1", "2"], "+", "\[ImaginaryI]"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    FractionBox["1", "2"], "+", "\[ImaginaryI]"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "4"}], ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {2, 2, 2, 2}, 0, {
   1, {{0, 8, 16}, {{1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {2, 1, 1}, {2,
      2, 2}, {2, 1, 2}, {2, 2, 1}, {2, 1, 1}, {2, 1, 2}, {2, 2, 1}, {2, 2, 
     2}, {1, 1, 1}, {1, 2, 2}, {1, 2, 1}, {1, 1, 2}}}, {
    Rational[-3, 2], Complex[Rational[1, 2], 1], Complex[
     Rational[1, 2], 1], -4, Complex[Rational[1, 2], -1], Complex[
     Rational[-1, 2], -1], Rational[9, 2], Rational[1, 2], -4, Complex[
     Rational[-1, 2], 1], Complex[Rational[-1, 2], 1], Rational[-9, 2], 
     Complex[Rational[1, 2], -1], Complex[Rational[-1, 2], -1], Rational[
     3, 2], Rational[1, 2]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->664977038,ExpressionUUID->"8937b7b9-ea48-42ca-b7b2-196c4300a7d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", "\[Rho]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"more", "//", "Simplify"}], "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1603363407,ExpressionUUID->"1897938f-9e66-4f0e-ac5f-1343bcaed766"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"3", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[1, 1]]}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "-", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}], "+", 
       FractionBox[
        RowBox[{"9", " ", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"r"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`r[2, 2]]}], "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "-", 
       RowBox[{"4", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "+", 
       FractionBox[
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]], "2"], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "-", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "+", 
       FractionBox[
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]], "2"], "-", 
       RowBox[{"4", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "-", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"r"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`r[1, 1]]}], "2"], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "-", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}], "-", 
       FractionBox[
        RowBox[{"9", " ", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"r"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`r[2, 2]]}], "2"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {1}, {2}}}, {
      Rational[-3, 2] $CellContext`r[1, 1] + 
       Complex[Rational[1, 2], 1] $CellContext`r[1, 2] + 
       Complex[Rational[1, 2], -1] $CellContext`r[2, 1] + 
       Rational[9, 2] $CellContext`r[2, 2], 
       Complex[Rational[1, 2], 1] $CellContext`r[1, 1] - 
       4 $CellContext`r[1, 2] + Rational[1, 2] $CellContext`r[2, 1] + 
       Complex[Rational[-1, 2], -1] $CellContext`r[2, 2], 
       Complex[Rational[1, 2], -1] $CellContext`r[1, 1] + 
       Rational[1, 2] $CellContext`r[1, 2] - 4 $CellContext`r[2, 1] + 
       Complex[Rational[-1, 2], 1] $CellContext`r[2, 2], 
       Rational[3, 2] $CellContext`r[1, 1] + 
       Complex[Rational[-1, 2], -1] $CellContext`r[1, 2] + 
       Complex[Rational[-1, 2], 1] $CellContext`r[2, 1] + 
       Rational[-9, 2] $CellContext`r[2, 2]}}]]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1194115195,ExpressionUUID->"2df32e10-de9c-4ea1-bf2f-425d087f79a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "more"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->314544571,ExpressionUUID->"9438425e-54bb-4408-af76-c208d926028e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->723766283,ExpressionUUID->"2b1807a1-8770-4205-bfce-51f2316e4bec"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "ce5ce797-db9f-439e-a7fc-c8dd2b3c5a88"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1617369706,ExpressionUUID->"0a6454af-3665-4257-8c14-624e8bece1ec"],

Cell["Now, we consider a three-level system.", "ExampleText",
 CellID->1582702043,ExpressionUUID->"374abdb4-379b-4263-8718-4058ef3bc947"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kbs", "=", 
   RowBox[{"LieBasis", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "kbs"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1432904656,ExpressionUUID->"de3ae65c-4dbd-41db-a0e7-d6d70c1d8ed0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["3"]], "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["3"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 3}, {{1}, {2}, {3}}}, {
        3^Rational[-1, 2], 3^Rational[-1, 2], 3^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{2}, {1}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}], "0"},
       {
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0", "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{2}, {1}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["2"]]}], "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{1}, {2}}}, {
        2^Rational[-1, 2], -2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", "0", "0"},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 1, 2}, {{3}, {1}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}]},
       {"0", "0", "0"},
       {
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 1, 2}, {{3}, {1}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 0, 1, 2}, {{3}, {2}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}]},
       {"0", 
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 0, 1, 2}, {{3}, {2}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["6"]], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["6"]], "0"},
       {"0", "0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "3"]]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 3}, {{1}, {2}, {3}}}, {
        6^Rational[-1, 2], 6^Rational[-1, 2], -
         Rational[2, 3]^Rational[1, 2]}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->287616460,ExpressionUUID->"457e3ec9-4abf-4cd9-8aec-9c5684416422"]
}, Open  ]],

Cell["\<\
Let us examine a quantum operation, i.e., a completely positive supermap.\
\>", "ExampleText",
 CellID->150934821,ExpressionUUID->"e83e5976-8670-4246-81be-213e11a051f2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"opH", "=", 
   RowBox[{"RandomHermitian", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"opH", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opL", "=", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{
       RowBox[{"$n", "^", "2"}], "-", "1"}]}], "]"}], "*", 
    RowBox[{"Rest", "[", "kbs", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gen", "=", 
   RowBox[{"LindbladSupermap", "[", 
    RowBox[{"opH", ",", "opL"}], "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->583349440,ExpressionUUID->"6b2e179e-335b-482d-885f-2ed24d291a4c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.35729205999466807`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2554342391188238`"}], "-", 
       RowBox[{"0.13855151045043623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5241520672111932`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.8201149933621064`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.2554342391188238`"}], "+", 
       RowBox[{"0.13855151045043623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.08903928853379561`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.461167317368107`"}], "-", 
       RowBox[{"0.24734539751992535`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.5241520672111932`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.8201149933621064`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.461167317368107`"}], "+", 
       RowBox[{"0.24734539751992535`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6090819745287481`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->142745465,ExpressionUUID->"c26fc7fe-aa22-458a-9bbf-26c984316128"]
}, Open  ]],

Cell["This is the corresponding Choi matrix.", "ExampleText",
 CellID->1091189525,ExpressionUUID->"07c37245-b389-4906-81d8-03836dcec847"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tsr", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ChoiMatrix", "[", "gen", "]"}], "//", "Chop"}], "//", 
   "SparseArray"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->112001295,ExpressionUUID->"723e303f-86d3-424c-a8e4-24f42ecb15ce"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["57", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["57", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.7037037037037037`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "0.5534085489383083`"}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.13855151045043623`"}], "-", 
                    RowBox[{"0.2554342391188238`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "3"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.8201149933621064`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.5241520672111932`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.13855151045043623`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.2554342391188238`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {3, 3, 3, 3}, 0, {
   1, {{0, 19, 38, 57}, {{1, 1, 1}, {1, 1, 2}, {1, 1, 3}, {1, 2, 1}, {1, 2, 
     2}, {1, 2, 3}, {1, 3, 1}, {1, 3, 2}, {1, 3, 3}, {2, 1, 1}, {2, 1, 2}, {2,
      2, 1}, {2, 2, 2}, {2, 3, 3}, {3, 1, 1}, {3, 1, 3}, {3, 2, 2}, {3, 3, 
     1}, {3, 3, 3}, {1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {1, 3, 3}, {2,
      1, 1}, {2, 1, 2}, {2, 1, 3}, {2, 2, 1}, {2, 2, 2}, {2, 2, 3}, {2, 3, 
     1}, {2, 3, 2}, {2, 3, 3}, {3, 1, 1}, {3, 2, 2}, {3, 2, 3}, {3, 3, 2}, {3,
      3, 3}, {1, 1, 1}, {1, 1, 3}, {1, 2, 2}, {1, 3, 1}, {1, 3, 3}, {2, 1, 
     1}, {2, 2, 2}, {2, 2, 3}, {2, 3, 2}, {2, 3, 3}, {3, 1, 1}, {3, 1, 2}, {3,
      1, 3}, {3, 2, 1}, {3, 2, 2}, {3, 2, 3}, {3, 3, 1}, {3, 3, 2}, {3, 3, 
     3}}}, {-0.5534085489383083, 
     Complex[-0.13855151045043623`, -0.2554342391188238], Complex[
     0.8201149933621064, 0.5241520672111932], Complex[
     0.13855151045043623`, -0.2554342391188238], 
     Complex[-1.112155870744646, -0.4463313485284637], 
     Complex[-0.24734539751992535`, -0.461167317368107], 
     Complex[-0.8201149933621064, 0.5241520672111932], Complex[
     0.24734539751992535`, -0.461167317368107], 
     Complex[-1.0059373420579576`, -0.9663740345234162], 
     Complex[-0.13855151045043623`, 0.2554342391188238], 
     0.35072283990826575`, -0.2313059800896236, 
     Complex[-0.13855151045043623`, 0.2554342391188238], 
     Complex[-0.13855151045043623`, 0.2554342391188238], Complex[
     0.8201149933621064, -0.5241520672111932], 0.20268570903004246`, Complex[
     0.8201149933621064, -0.5241520672111932], -0.0046979886683505, Complex[
     0.8201149933621064, -0.5241520672111932], Complex[
     0.13855151045043623`, 0.2554342391188238], -0.2313059800896236, 
     0.35072283990826575`, Complex[0.13855151045043623`, 0.2554342391188238], 
     Complex[0.13855151045043623`, 0.2554342391188238], 
     Complex[-1.112155870744646, 0.4463313485284637], 
     Complex[-0.13855151045043623`, -0.2554342391188238], Complex[
     0.8201149933621064, 0.5241520672111932], Complex[
     0.13855151045043623`, -0.2554342391188238], -0.7990045218948556, 
     Complex[-0.24734539751992535`, -0.461167317368107], 
     Complex[-0.8201149933621064, 0.5241520672111932], Complex[
     0.24734539751992535`, -0.461167317368107], 
     Complex[-1.1287353285362312`, -0.5200426859949525], 
     Complex[-0.24734539751992535`, 0.461167317368107], 
     Complex[-0.24734539751992535`, 0.461167317368107], 0.4482816819865901, 
     0.4470176067864931, Complex[-0.24734539751992535`, 0.461167317368107], 
     Complex[-0.8201149933621064, -0.5241520672111932], -0.0046979886683505, 
     Complex[-0.8201149933621064, -0.5241520672111932], 0.20268570903004246`, 
     Complex[-0.8201149933621064, -0.5241520672111932], Complex[
     0.24734539751992535`, 0.461167317368107], Complex[
     0.24734539751992535`, 0.461167317368107], 0.4470176067864931, 
     0.4482816819865901, Complex[0.24734539751992535`, 0.461167317368107], 
     Complex[-1.0059373420579576`, 0.9663740345234162], 
     Complex[-0.13855151045043623`, -0.2554342391188238], Complex[
     0.8201149933621064, 0.5241520672111932], Complex[
     0.13855151045043623`, -0.2554342391188238], 
     Complex[-1.1287353285362312`, 0.5200426859949525], 
     Complex[-0.24734539751992535`, -0.461167317368107], 
     Complex[-0.8201149933621064, 0.5241520672111932], Complex[
     0.24734539751992535`, -0.461167317368107], -0.6509673910166325}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1360203853,ExpressionUUID->"f2cbcbc0-84bb-4e46-a8fd-9c3718a65687"]
}, Open  ]],

Cell["\<\
Take an arbitrary operator \[Rho] (not necessarily a density operator).\
\>", "ExampleText",
 CellID->861298979,ExpressionUUID->"1fb1abe4-aa82-477a-8652-9903e5439aa1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"RandomMatrix", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->2016058601,ExpressionUUID->"8a822554-96fd-4d38-af81-ae23ebcf48f1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.15202874757268203`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6084939898437796`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1959551231988068`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.9022736994892182`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.88657235412292`"}], "-", 
       RowBox[{"0.6115311915488437`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.1549016402709582`"}], "-", 
       RowBox[{"0.9761926841120672`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7354520126356161`"}], "+", 
       RowBox[{"0.5259912451557396`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4793705877376455`"}], "+", 
       RowBox[{"0.2413284874645063`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.8969249152191598`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.937136282658515`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.15483908528002743`"}], "+", 
       RowBox[{"0.5617227076937845`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2237085982310658`"}], "-", 
       RowBox[{"0.4936541054167489`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1136638058,ExpressionUUID->"c0af4eda-c7b8-400a-bbae-aa22e2ea4485"]
}, Open  ]],

Cell["\<\
This is the new linear operator obtained by operating the Supermap on \[Rho]. \
\>", "ExampleText",
 CellID->306115466,ExpressionUUID->"eda97bba-0d78-4beb-92fa-5c8b2d958251"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"gen", "[", "\[Rho]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1659302497,ExpressionUUID->"1b8aa326-2b94-42b8-ba4c-1d92c8a6775a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.9069477950123263`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9994946719644346`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.4693595530320238`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.021561267636811543`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11984470402468733`"}], "+", 
       RowBox[{"0.737496297823242`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.5091163592227205`"}], "+", 
       RowBox[{"1.1744536539014243`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07564186244261044`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3977411871265488`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.613098204935948`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.1244097778024627`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.9573536019399508`"}], "-", 
       RowBox[{"1.5250628171689014`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.25256913675655457`"}], "-", 
       RowBox[{"1.53241802671845`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.9825896574549369`"}], "+", 
       RowBox[{"1.3972358590909837`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->139214508,ExpressionUUID->"6e70b05b-63e1-4295-9b94-66f275a9e5b6"]
}, Open  ]],

Cell["The same can be achieved by using the Choi matrix as well.", \
"ExampleText",
 CellID->678202693,ExpressionUUID->"6ab2cf85-3c31-439a-a351-586db419db45"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", "\[Rho]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"more", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1856946622,ExpressionUUID->"50e3ae9b-41b4-4bc5-b094-6c42822b85d9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.9069477950123264`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9994946719644345`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.4693595530320238`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.021561267636811543`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11984470402468737`"}], "+", 
       RowBox[{"0.7374962978232418`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.5091163592227206`"}], "+", 
       RowBox[{"1.1744536539014245`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07564186244261045`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.39774118712654877`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6130982049359477`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.1244097778024624`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.9573536019399507`"}], "-", 
       RowBox[{"1.5250628171689011`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.25256913675655446`"}], "-", 
       RowBox[{"1.53241802671845`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.9825896574549369`"}], "+", 
       RowBox[{"1.3972358590909832`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0., {
     1, {{0, 3, 6, 9}, {{1}, {2}, {3}, {3}, {1}, {2}, {1}, {3}, {2}}}, {
      Complex[0.9069477950123264, -0.9994946719644345], Complex[
      0.4693595530320238, 0.021561267636811543`], 
      Complex[-0.11984470402468737`, 0.7374962978232418], Complex[
      1.6130982049359477`, 1.1244097778024624`], Complex[-0.5091163592227206, 
      1.1744536539014245`], Complex[
      0.07564186244261045, -0.39774118712654877`], 
      Complex[-0.9573536019399507, -1.5250628171689011`], 
      Complex[-0.9825896574549369, 1.3972358590909832`], 
      Complex[-0.25256913675655446`, -1.53241802671845]}}]]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->471585551,ExpressionUUID->"9dac1764-1d92-4008-a7f9-94c5bb24ca5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "more"}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->768378681,ExpressionUUID->"e3b7dcbe-9adc-4ea3-af3b-83276df5b9c1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1701506713,ExpressionUUID->"8854a6b2-f937-4c1f-9ed2-2a8affd3e30b"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Supermap"]], "paclet:QuantumMob/Q3/ref/Supermap", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "d8f84e6d-5eb0-426c-ba13-b857adfb184f"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["LindbladSupermap"]], 
           "paclet:QuantumMob/Q3/ref/LindbladSupermap", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "59bbd340-4fe0-4cda-a212-3497826e772a"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["LieBasis"]], "paclet:QuantumMob/Q3/ref/LieBasis", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "be1cb09e-df57-4781-be09-5a1ce53897ff"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["LieBasisMatrix"]], 
           "paclet:QuantumMob/Q3/ref/LieBasisMatrix", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "acc16ca5-8ff2-44cd-86f8-f7a6462c5563"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChoiMultiply"]], 
           "paclet:QuantumMob/Q3/ref/ChoiMultiply", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "1bd86ae5-e7cd-4ebc-9a48-fa039149b267"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChoiTopple"]], "paclet:QuantumMob/Q3/ref/ChoiTopple", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "6bf1ba30-0352-4a4f-9fb0-f607adc0a1e9"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ToSuperMatrix"]], 
           "paclet:QuantumMob/Q3/ref/ToSuperMatrix", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "c9f196ee-48a2-4386-aac6-9ab3c64e6d8d"]
       }], "SeeAlso",ExpressionUUID->"f9a1407f-0434-45bc-bf6b-7129c4a3d934"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"ceb29644-57fb-4637-9a24-\
fea1fc9edf12"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TutorialsSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Choi Isomorphism"]], 
           "paclet:QuantumMob/Q3/tutorial/ChoiIsomorphism"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "b91f4ad2-9013-486b-94dc-a046a9ee25f6"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Noise and Decoherence"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumNoiseAndDecoherence"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "87323a60-d1ff-4c05-9ebe-0e52b0cbc478"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "bc055c70-76f1-49d0-a150-361a65608ee0"]}]}
     }]}
  }]], "TutorialsSection",ExpressionUUID->"712d9976-5771-4898-8d15-\
752d978b22f1"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Dynamical Process of Decoherence"]], 
           "paclet:QuantumMob/Q3/guide/DynamicalProcessOfDecoherence"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "118eb3b7-1c61-4856-a3ab-a229ae786e92"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "1b6d5739-3be9-4c20-a0dc-8e6ff23d6ecf"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"4b70e63a-fd78-4366-8207-\
932f426c6008"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "E. St\[OSlash]rmer (2013)"}]]]], 
             "https://doi.org/10.1007/978-3-642-34369-8"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "36d215a2-6349-4f74-b289-31aa53d92d05"]}]],ExpressionUUID->
         "52f5cbdb-b30d-498f-85c1-6c65844d2e96"],
        ", Positive Linear Maps of Operator Algebras (Springer, 2013)."
       }], "RelatedLinks",ExpressionUUID->
        "5d32eb53-0884-431f-aa49-49e8590656f0"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "ea15da34-fc77-4044-910c-07486f124283"]}]],ExpressionUUID->
         "81fc8042-8beb-463a-ba60-a7eefaeb17c3"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "35f47128-e218-43c7-a799-6fbdc8842123"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"6dc1969e-43d6-4aa5-adac-\
adb65f5b1b96"],

Cell[" ", "FooterCell",ExpressionUUID->"6b4899c1-591b-42b0-b73f-5e5a5c754098"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"ChoiMatrix",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed}, "AllOptsTable" -> 
    Closed, "NotesSection" -> Closed}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 10, 14, 22, 9.576843}", 
    "history" -> {"12", "13.2", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {
     "open quantum systems", "quantum operations", "Choi isomorphism"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3", "status" -> "None", "summary" -> 
    "ChoiMatrix[spec] returns the Choi matrix of Supermap[spec]. \
ChoiMatrix[Supermap[spec]] is equivalent to ChoiMatrix[spec]. \
ChoiMatrix[LindbladSupermap[{a, b1, b2, ...}]] returns the Choi matrix of the \
Lindblad generator, a superoperator generating the Markovian quantum \
operation associated with the effective Hamiltonian a and the Lindblad \
operators b1, b2, ....", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "ChoiMatrix", "titlemodifier" -> "", "metadescription" -> "", 
    "windowtitle" -> "ChoiMatrix", "type" -> "Symbol", "uri" -> 
    "QuantumMob/Q3/ref/ChoiMatrix"}},
CellContext->"Global`",
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"cdfec8b4-82b8-44c2-99ac-807d0dee53a6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[27251, 775, 1439, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"667245b0-8ae0-4d31-b2ea-2fb7aa8a1e90",
   CellTags->"PrimaryExamplesSection",
   CellID->34218700]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 235170, 6171}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[578, 21, 7588, 180, 70, "AnchorBarGrid",ExpressionUUID->"64ae434f-d0d6-4713-b56d-1aafb6dd648d",
 CellID->1],
Cell[8169, 203, 96, 0, 70, "ContextNameCell",ExpressionUUID->"1592cf99-d271-42f0-8ef5-f02ac914dd80"],
Cell[CellGroupData[{
Cell[8290, 207, 553, 14, 70, "ObjectNameGrid",ExpressionUUID->"9ba3bc41-815f-4472-ab11-30f9d78bf672"],
Cell[8846, 223, 4098, 112, 70, "Usage",ExpressionUUID->"e778ca5e-9eca-465b-b585-a98834eab187",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[12981, 340, 1850, 45, 70, "NotesSection",ExpressionUUID->"af69d77c-7b9f-4795-ba12-1da889eacb34",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->566420493],
Cell[14834, 387, 3968, 130, 70, "Notes",ExpressionUUID->"cd98c20c-f225-4d80-8bd9-62f493fd4298",
 CellID->277061214],
Cell[18805, 519, 545, 13, 70, "Notes",ExpressionUUID->"fdebe8b2-9d56-40f6-9ab1-6edcb7c99b15",
 CellID->1067943069],
Cell[19353, 534, 2966, 91, 70, "Notes",ExpressionUUID->"1a98d20c-b91b-4cf1-a75c-1bb958b70098",
 CellID->2071262949],
Cell[22322, 627, 172, 3, 70, "Notes",ExpressionUUID->"3471f647-0413-4870-ad64-c980ff5092a4",
 CellID->1804368584],
Cell[22497, 632, 3170, 95, 70, "Notes",ExpressionUUID->"02c4b273-c793-4797-ad3b-b17044ab7a76",
 CellID->544097144],
Cell[25670, 729, 1454, 40, 70, "Notes",ExpressionUUID->"ef667d84-f535-45d5-8509-f83395e28e0c",
 CellID->688867986]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[27251, 775, 1439, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"667245b0-8ae0-4d31-b2ea-2fb7aa8a1e90",
 CellTags->"PrimaryExamplesSection",
 CellID->34218700],
Cell[28693, 815, 203, 3, 70, "Input",ExpressionUUID->"c22ac42b-a902-4ed1-90b0-18ae171f20d3",
 CellID->1927565408],
Cell[CellGroupData[{
Cell[28921, 822, 1419, 37, 70, "ExampleSection",ExpressionUUID->"9629098a-8912-4468-b12d-9f5b246240ed",
 CellID->1735557151],
Cell[30343, 861, 160, 2, 70, "ExampleText",ExpressionUUID->"eb59fe33-5349-4dbf-9626-4f5c902ce1c7",
 CellID->553412081],
Cell[CellGroupData[{
Cell[30528, 867, 476, 12, 70, "Input",ExpressionUUID->"9be8ea26-3e4d-41b9-a466-05e1f0a944ee",
 CellID->445170210],
Cell[31007, 881, 1393, 45, 70, "Output",ExpressionUUID->"07d30555-8b79-4d96-83aa-7f82f8640027",
 CellID->1409239597]
}, Open  ]],
Cell[32415, 929, 117, 1, 70, "ExampleText",ExpressionUUID->"04e8e946-6daf-46fc-9225-0cc3a7234a80",
 CellID->925413985],
Cell[CellGroupData[{
Cell[32557, 934, 497, 13, 70, "Input",ExpressionUUID->"21f06609-b715-4ecc-982d-6e7d07e88792",
 CellID->1356274321],
Cell[33057, 949, 9969, 205, 70, "Output",ExpressionUUID->"f33a0def-6201-443a-804b-1081677fcef1",
 CellID->1853783995]
}, Open  ]],
Cell[CellGroupData[{
Cell[43063, 1159, 336, 8, 70, "Input",ExpressionUUID->"3149bdd5-47e2-48f5-acfe-9b0ab82ee96a",
 CellID->1022965681],
Cell[43402, 1169, 4723, 147, 70, "Output",ExpressionUUID->"3313d9e0-f161-4802-97a9-399d71d97559",
 CellID->1934230348]
}, Open  ]],
Cell[48140, 1319, 158, 2, 70, "ExampleText",ExpressionUUID->"693dcb76-eb2d-42e0-8ede-4c8a03133229",
 CellID->1016862214],
Cell[CellGroupData[{
Cell[48323, 1325, 226, 5, 70, "Input",ExpressionUUID->"ce220797-11cc-4d1a-a8fd-846038d0a667",
 CellID->643632301],
Cell[48552, 1332, 9754, 203, 70, "Output",ExpressionUUID->"8495b9b1-c400-44bf-beab-14ff79274df2",
 CellID->1734096540]
}, Open  ]],
Cell[58321, 1538, 172, 3, 70, "ExampleText",ExpressionUUID->"4db7730e-ad66-42fd-b5eb-8ae17cf06ed0",
 CellID->1355606217],
Cell[CellGroupData[{
Cell[58518, 1545, 618, 17, 70, "Input",ExpressionUUID->"c052f638-0423-4530-85cf-f7d33b5dabef",
 CellID->1592314655],
Cell[59139, 1564, 5406, 160, 70, "Output",ExpressionUUID->"7428a18b-53ef-42a7-aff1-43aa1b963c2a",
 CellID->2073499931]
}, Open  ]],
Cell[CellGroupData[{
Cell[64582, 1729, 266, 7, 70, "Input",ExpressionUUID->"c89cebdc-4ff5-439d-9478-3a5650a3d0c5",
 CellID->1640340825],
Cell[64851, 1738, 593, 17, 70, "Output",ExpressionUUID->"206a4747-2955-4218-b0e9-3c0aa353345b",
 CellID->1407484755]
}, Open  ]],
Cell[CellGroupData[{
Cell[65481, 1760, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"c7b62030-ad21-4c75-bda5-2fc3e1d11f51",
 CellID->1958003159],
Cell[65727, 1767, 196, 4, 70, "ExampleText",ExpressionUUID->"edc193aa-5534-459d-bcdf-162639fb16ff",
 CellID->2112320759],
Cell[65926, 1773, 220, 5, 70, "Input",ExpressionUUID->"8411f557-502b-4bec-9f40-0eba294c3b7f",
 CellID->1529421203],
Cell[66149, 1780, 154, 1, 70, "ExampleText",ExpressionUUID->"02bb4011-9d6e-43d9-818d-59fb768cf45e",
 CellID->910124769],
Cell[CellGroupData[{
Cell[66328, 1785, 436, 11, 70, "Input",ExpressionUUID->"6880a7f5-1d9e-4442-b480-cd0a05ec200d",
 CellID->1171754921],
Cell[66767, 1798, 1571, 59, 70, "Output",ExpressionUUID->"568adbeb-83a8-4173-98be-156ec190b65d",
 CellID->64790341]
}, Open  ]],
Cell[68353, 1860, 169, 3, 70, "ExampleText",ExpressionUUID->"a5077c8b-26c2-4c70-849e-1461102f7099",
 CellID->659929661],
Cell[CellGroupData[{
Cell[68547, 1867, 476, 13, 70, "Input",ExpressionUUID->"82ca9c98-ecd7-40d3-95b3-775fe87f0c40",
 CellID->2146884351],
Cell[69026, 1882, 5131, 110, 70, "Output",ExpressionUUID->"a449828b-784e-4d1f-beff-5e55828f06aa",
 CellID->1862438804]
}, Open  ]],
Cell[74172, 1995, 202, 5, 70, "ExampleText",ExpressionUUID->"9627ec96-3855-4b60-833f-43094787135e",
 CellID->1760269154],
Cell[CellGroupData[{
Cell[74399, 2004, 253, 6, 70, "Input",ExpressionUUID->"a09de5aa-7686-40aa-9ae0-4e3bc591d9d2",
 CellID->1142711461],
Cell[74655, 2012, 2317, 86, 70, "Output",ExpressionUUID->"fcfa8934-4d13-4efc-9ad6-47983e1e22e2",
 CellID->1934352376]
}, Open  ]],
Cell[76987, 2101, 158, 2, 70, "ExampleText",ExpressionUUID->"eed6b962-9173-443f-8e93-55d8eeb08227",
 CellID->1244330407],
Cell[CellGroupData[{
Cell[77170, 2107, 309, 7, 70, "Input",ExpressionUUID->"6251085c-361a-4a0d-96e0-3cd9126529ee",
 CellID->1265395963],
Cell[77482, 2116, 192, 4, 70, "Output",ExpressionUUID->"ccf63bfd-b0d6-4108-af3f-d48454a11238",
 CellID->1660482032]
}, Open  ]],
Cell[77689, 2123, 171, 3, 70, "ExampleText",ExpressionUUID->"e9a9a458-1e61-4ee5-914e-cd652636cec1",
 CellID->211123045],
Cell[CellGroupData[{
Cell[77885, 2130, 650, 18, 70, "Input",ExpressionUUID->"077f766e-bf98-434a-a1b3-5a264fe37d74",
 CellID->702032471],
Cell[78538, 2150, 3251, 106, 70, "Output",ExpressionUUID->"443aeb4f-e50d-4bf1-b370-0291ba3e7588",
 CellID->756947743]
}, Open  ]],
Cell[CellGroupData[{
Cell[81826, 2261, 288, 7, 70, "Input",ExpressionUUID->"dde2246a-b1e5-48d3-a9e3-91055fa704ae",
 CellID->944938973],
Cell[82117, 2270, 127, 2, 70, "Output",ExpressionUUID->"b9686ed8-236f-408c-a674-bf6931517555",
 CellID->1622060024]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82293, 2278, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"d7fd4734-f3ea-423b-8860-35d62c1495a6",
 CellID->104323313],
Cell[82538, 2285, 149, 1, 70, "ExampleText",ExpressionUUID->"ee0f46de-50b1-429a-802c-be55f1f14683",
 CellID->1003924897],
Cell[CellGroupData[{
Cell[82712, 2290, 376, 9, 70, "Input",ExpressionUUID->"8a1319c1-ed6a-418b-93b3-1739cc26f829",
 CellID->2047323406],
Cell[83091, 2301, 7348, 233, 70, "Output",ExpressionUUID->"c584abd9-880b-461e-a9c0-2f54c9d1020e",
 CellID->845187401]
}, Open  ]],
Cell[90454, 2537, 173, 3, 70, "ExampleText",ExpressionUUID->"00a2e634-703d-457d-8e0c-ce7a4ec19d37",
 CellID->885184976],
Cell[CellGroupData[{
Cell[90652, 2544, 475, 13, 70, "Input",ExpressionUUID->"8e63d876-afb4-43ef-8950-95e3d4e04d9f",
 CellID->2044491245],
Cell[91130, 2559, 10801, 225, 70, "Output",ExpressionUUID->"6d39fc88-fede-49bf-bf69-ad7dd30faa85",
 CellID->86247225]
}, Open  ]],
Cell[101946, 2787, 181, 3, 70, "ExampleText",ExpressionUUID->"881295cc-8469-412c-8cfb-f83f1bf6bd50",
 CellID->404204944],
Cell[CellGroupData[{
Cell[102152, 2794, 226, 5, 70, "Input",ExpressionUUID->"8cf17f8f-2f06-4aad-a5e7-6be1c05846ba",
 CellID->315678790],
Cell[102381, 2801, 10588, 223, 70, "Output",ExpressionUUID->"93bfc7f9-511c-4aed-9cfa-da9131889fcf",
 CellID->1875087885]
}, Open  ]],
Cell[112984, 3027, 248, 4, 70, "ExampleText",ExpressionUUID->"c0209638-1df9-4417-bd79-89908aac8ef1",
 CellID->905156507],
Cell[CellGroupData[{
Cell[113257, 3035, 494, 12, 70, "Input",ExpressionUUID->"2ebe4856-20f9-427b-b15e-a55879c0b8ac",
 CellID->1963657499],
Cell[113754, 3049, 130, 2, 70, "Output",ExpressionUUID->"68c468c3-c4eb-4920-8f78-cec5ee442ecf",
 CellID->1544102239],
Cell[113887, 3053, 822, 25, 70, "Output",ExpressionUUID->"1363c1f5-7759-4211-a571-f2f1a7057324",
 CellID->1533940525]
}, Open  ]],
Cell[114724, 3081, 260, 4, 70, "ExampleText",ExpressionUUID->"69767926-9e1a-4efc-b47b-b55ea75a6a60",
 CellID->1014268615],
Cell[CellGroupData[{
Cell[115009, 3089, 315, 7, 70, "Input",ExpressionUUID->"ecbf8729-d1a3-4532-b695-62a483bfff9d",
 CellID->85447438],
Cell[115327, 3098, 1748, 39, 70, "Output",ExpressionUUID->"c2f4c050-ab9f-4c5d-8f5b-c58217a432e5",
 CellID->1563663790]
}, Open  ]],
Cell[117090, 3140, 184, 3, 70, "ExampleText",ExpressionUUID->"41cca1ef-fc63-42a1-9d07-f11e1b788204",
 CellID->543923410],
Cell[CellGroupData[{
Cell[117299, 3147, 309, 7, 70, "Input",ExpressionUUID->"9d87a8ae-d51c-4b77-84db-1898cf0d990a",
 CellID->717229906],
Cell[117611, 3156, 1757, 39, 70, "Output",ExpressionUUID->"97d8eb2a-517b-4d10-9870-e52d8fbcb325",
 CellID->1350554867]
}, Open  ]],
Cell[119383, 3198, 158, 2, 70, "ExampleText",ExpressionUUID->"f9e117ec-88eb-4e6d-9440-5ef33cdcfcf2",
 CellID->688108930],
Cell[CellGroupData[{
Cell[119566, 3204, 581, 16, 70, "Input",ExpressionUUID->"afb64015-4e08-474c-b4b2-2e7b0cf0b57f",
 CellID->30075672],
Cell[120150, 3222, 2403, 51, 70, "Output",ExpressionUUID->"4dfab282-ee2f-420a-9610-df58efac3535",
 CellID->623842255]
}, Open  ]],
Cell[CellGroupData[{
Cell[122590, 3278, 254, 7, 70, "Input",ExpressionUUID->"58b52987-097d-4b85-8d40-5c4ee6697708",
 CellID->931479859],
Cell[122847, 3287, 624, 18, 70, "Output",ExpressionUUID->"883eac4f-ef2a-4c87-88aa-7b971e5dfcf8",
 CellID->566641342]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[123632, 3314, 1346, 35, 70, "ExampleSection",ExpressionUUID->"d146a38a-28e1-4604-b368-1859018d1033",
 CellID->1020263627],
Cell[124981, 3351, 292, 5, 70, "ExampleText",ExpressionUUID->"fd63970d-c2ad-4e7d-9e44-8791581897f1",
 CellID->828732181],
Cell[CellGroupData[{
Cell[125298, 3360, 469, 12, 70, "Input",ExpressionUUID->"b8f0815b-297d-42e8-a96d-c838f318ceb6",
 CellID->333277970],
Cell[125770, 3374, 1352, 45, 70, "Output",ExpressionUUID->"a9626a17-4515-43a1-8707-98ac088f73b8",
 CellID->515710983]
}, Open  ]],
Cell[127137, 3422, 161, 2, 70, "ExampleText",ExpressionUUID->"5fa9b57a-d35d-472b-8598-d9ee59346854",
 CellID->2006817625],
Cell[CellGroupData[{
Cell[127323, 3428, 368, 9, 70, "Input",ExpressionUUID->"5db0f017-e5fc-40b2-8033-25278120fa7e",
 CellID->2123398300],
Cell[127694, 3439, 9689, 201, 70, "Output",ExpressionUUID->"58953e99-e438-4c76-93f0-fab175e716c1",
 CellID->676799938]
}, Open  ]],
Cell[CellGroupData[{
Cell[137420, 3645, 306, 7, 70, "Input",ExpressionUUID->"f1c79568-d370-40c1-a9ac-d4d633c14b1d",
 CellID->1152364753],
Cell[137729, 3654, 2700, 87, 70, "Output",ExpressionUUID->"253d9a8c-1d38-4360-88d9-73849767a8ec",
 CellID->616039658]
}, Open  ]],
Cell[CellGroupData[{
Cell[140466, 3746, 227, 5, 70, "Input",ExpressionUUID->"3b51d49d-b7f5-4309-9c9c-7ebefacef95f",
 CellID->2118928092],
Cell[140696, 3753, 9476, 199, 70, "Output",ExpressionUUID->"d1b5bc67-09d0-43fa-85f2-800cb8734f3c",
 CellID->72703027]
}, Open  ]],
Cell[CellGroupData[{
Cell[150209, 3957, 583, 16, 70, "Input",ExpressionUUID->"901802b8-81da-454b-9272-eff576a47d62",
 CellID->1481207322],
Cell[150795, 3975, 3140, 98, 70, "Output",ExpressionUUID->"a408c13e-c5b6-4bc5-bf55-03422def9a03",
 CellID->1825992849]
}, Open  ]],
Cell[CellGroupData[{
Cell[153972, 4078, 258, 7, 70, "Input",ExpressionUUID->"e119d86d-e823-447e-bb06-43d59c6610da",
 CellID->408110433],
Cell[154233, 4087, 592, 17, 70, "Output",ExpressionUUID->"84f8be71-b3c9-4cf0-8043-9ae60d4bd075",
 CellID->944807076]
}, Open  ]],
Cell[CellGroupData[{
Cell[154862, 4109, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"5bb03271-d7bb-454b-ad19-443869679fe1",
 CellID->1374347092],
Cell[155108, 4116, 152, 1, 70, "ExampleText",ExpressionUUID->"ce5e5c7a-386f-4095-b012-ab97cb210cb5",
 CellID->2037101859],
Cell[CellGroupData[{
Cell[155285, 4121, 636, 17, 70, "Input",ExpressionUUID->"f18ff2a8-9457-4ab5-a14d-98e3fc550a70",
 CellID->239160092],
Cell[155924, 4140, 10203, 211, 70, "Output",ExpressionUUID->"6faee255-d1c4-4df7-89d9-f12b68b2351a",
 CellID->966871551]
}, Open  ]],
Cell[CellGroupData[{
Cell[166164, 4356, 338, 8, 70, "Input",ExpressionUUID->"df012044-d7e7-47a2-a7fe-15b41b7b17cb",
 CellID->405914056],
Cell[166505, 4366, 5897, 184, 70, "Output",ExpressionUUID->"ec505a8c-05c5-4c62-8395-41ed224cc7f4",
 CellID->1541136071]
}, Open  ]],
Cell[CellGroupData[{
Cell[172439, 4555, 227, 5, 70, "Input",ExpressionUUID->"d1773a15-9b7e-41cc-a2b9-4d00bc5fe085",
 CellID->1103368825],
Cell[172669, 4562, 9986, 209, 70, "Output",ExpressionUUID->"8937b7b9-ea48-42ca-b7b2-196c4300a7d6",
 CellID->664977038]
}, Open  ]],
Cell[CellGroupData[{
Cell[182692, 4776, 614, 17, 70, "Input",ExpressionUUID->"1897938f-9e66-4f0e-ac5f-1343bcaed766",
 CellID->1603363407],
Cell[183309, 4795, 6332, 195, 70, "Output",ExpressionUUID->"2df32e10-de9c-4ea1-bf2f-425d087f79a8",
 CellID->1194115195]
}, Open  ]],
Cell[CellGroupData[{
Cell[189678, 4995, 258, 7, 70, "Input",ExpressionUUID->"9438425e-54bb-4408-af76-c208d926028e",
 CellID->314544571],
Cell[189939, 5004, 592, 17, 70, "Output",ExpressionUUID->"2b1807a1-8770-4205-bfce-51f2316e4bec",
 CellID->723766283]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[190580, 5027, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"0a6454af-3665-4257-8c14-624e8bece1ec",
 CellID->1617369706],
Cell[190826, 5034, 137, 1, 70, "ExampleText",ExpressionUUID->"374abdb4-379b-4263-8718-4058ef3bc947",
 CellID->1582702043],
Cell[CellGroupData[{
Cell[190988, 5039, 376, 9, 70, "Input",ExpressionUUID->"de3ae65c-4dbd-41db-a0e7-d6d70c1d8ed0",
 CellID->1432904656],
Cell[191367, 5050, 7348, 233, 70, "Output",ExpressionUUID->"457e3ec9-4abf-4cd9-8aec-9c5684416422",
 CellID->287616460]
}, Open  ]],
Cell[198730, 5286, 179, 3, 70, "ExampleText",ExpressionUUID->"e83e5976-8670-4246-81be-213e11a051f2",
 CellID->150934821],
Cell[CellGroupData[{
Cell[198934, 5293, 761, 21, 70, "Input",ExpressionUUID->"6b2e179e-335b-482d-885f-2ed24d291a4c",
 CellID->583349440],
Cell[199698, 5316, 1705, 42, 70, "Output",ExpressionUUID->"c26fc7fe-aa22-458a-9bbf-26c984316128",
 CellID->142745465]
}, Open  ]],
Cell[201418, 5361, 137, 1, 70, "ExampleText",ExpressionUUID->"07c37245-b389-4906-81d8-03836dcec847",
 CellID->1091189525],
Cell[CellGroupData[{
Cell[201580, 5366, 294, 8, 70, "Input",ExpressionUUID->"723e303f-86d3-424c-a8e4-24f42ecb15ce",
 CellID->112001295],
Cell[201877, 5376, 13194, 259, 70, "Output",ExpressionUUID->"f2cbcbc0-84bb-4e46-a8fd-9c3718a65687",
 CellID->1360203853]
}, Open  ]],
Cell[215086, 5638, 177, 3, 70, "ExampleText",ExpressionUUID->"1fb1abe4-aa82-477a-8652-9903e5439aa1",
 CellID->861298979],
Cell[CellGroupData[{
Cell[215288, 5645, 317, 7, 70, "Input",ExpressionUUID->"8a822554-96fd-4d38-af81-ae23ebcf48f1",
 CellID->2016058601],
Cell[215608, 5654, 1749, 42, 70, "Output",ExpressionUUID->"c0af4eda-c7b8-400a-bbae-aa22e2ea4485",
 CellID->1136638058]
}, Open  ]],
Cell[217372, 5699, 184, 3, 70, "ExampleText",ExpressionUUID->"eda97bba-0d78-4beb-92fa-5c8b2d958251",
 CellID->306115466],
Cell[CellGroupData[{
Cell[217581, 5706, 306, 7, 70, "Input",ExpressionUUID->"1b8aa326-2b94-42b8-ba4c-1d92c8a6775a",
 CellID->1659302497],
Cell[217890, 5715, 1747, 41, 70, "Output",ExpressionUUID->"6e70b05b-63e1-4295-9b94-66f275a9e5b6",
 CellID->139214508]
}, Open  ]],
Cell[219652, 5759, 158, 2, 70, "ExampleText",ExpressionUUID->"6ab2cf85-3c31-439a-a351-586db419db45",
 CellID->678202693],
Cell[CellGroupData[{
Cell[219835, 5765, 583, 16, 70, "Input",ExpressionUUID->"50e3ae9b-41b4-4bc5-b094-6c42822b85d9",
 CellID->1856946622],
Cell[220421, 5783, 2385, 53, 70, "Output",ExpressionUUID->"9dac1764-1d92-4008-a7f9-94c5bb24ca5d",
 CellID->471585551]
}, Open  ]],
Cell[CellGroupData[{
Cell[222843, 5841, 254, 7, 70, "Input",ExpressionUUID->"e3b7dcbe-9adc-4ea3-af3b-83276df5b9c1",
 CellID->768378681],
Cell[223100, 5850, 625, 18, 70, "Output",ExpressionUUID->"8854a6b2-f937-4c1f-9ed2-2a8affd3e30b",
 CellID->1701506713]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[223979, 5878, 4079, 110, 70, "SeeAlsoSection",ExpressionUUID->"ceb29644-57fb-4637-9a24-fea1fc9edf12"],
Cell[228061, 5990, 1523, 38, 70, "TutorialsSection",ExpressionUUID->"712d9976-5771-4898-8d15-752d978b22f1"],
Cell[229587, 6030, 1152, 28, 70, "MoreAboutSection",ExpressionUUID->"4b70e63a-fd78-4366-8207-932f426c6008"],
Cell[230742, 6060, 2022, 56, 70, "RelatedLinksSection",ExpressionUUID->"6dc1969e-43d6-4aa5-adac-adb65f5b1b96"],
Cell[232767, 6118, 78, 0, 70, "FooterCell",ExpressionUUID->"6b4899c1-591b-42b0-b73f-5e5a5c754098"]
}
]
*)

(* End of internal cache information *)
