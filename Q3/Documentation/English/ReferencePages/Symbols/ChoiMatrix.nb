(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    252871,       6543]
NotebookOptionsPosition[    233223,       6139]
NotebookOutlinePosition[    235826,       6201]
CellTagsIndexPosition[    235739,       6196]
WindowTitle->ChoiMatrix
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "2f752a9b-12d0-44e1-b570-3afba4b7a4aa"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "f4a13f20-d761-4a1a-833d-aa1459ea3d27"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "111fd644-ef5d-4f71-8e8d-bdfb0f73ebcb"]
         }],ExpressionUUID->"3af70815-27b2-4053-b170-76f84d2e802f"],
         StripOnInput->False],{
        StyleBox["\"Supermap\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/Supermap"], 
         StyleBox[
          "\"LindbladSupermap\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/LindbladSupermap"], 
         StyleBox["\"LieBasis\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/LieBasis"], 
         StyleBox[
          "\"LieBasisMatrix\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/LieBasisMatrix"], 
         StyleBox[
          "\"ChoiMultiply\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ChoiMultiply"], 
         StyleBox["\"ChoiTopple\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ChoiTopple"], 
         StyleBox[
          "\"ToSuperMatrix\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ToSuperMatrix"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "660c1430-a92b-446c-9840-f303363bc32c"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "c361f996-5dfe-45c8-b79b-f78cadbdbcfa"]
         }],ExpressionUUID->"5f67a986-fe53-4ca5-8731-e1930803286a"],
         StripOnInput->False],{
        "\"Dynamical Process of Decoherence\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/DynamicalProcessOfDecoherence"], 
         "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "871bb5fa-4c96-401e-86ad-3729a2058ba2"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "d7c97ff8-e8f6-4ca6-86b3-43b2496204fa"]
         }],ExpressionUUID->"ad2b5415-85f4-4e70-8c72-824eada470cd"],
         StripOnInput->False],{
        "\"Choi Isomorphism\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/ChoiIsomorphism"], 
         "\"Quantum Noise and Decoherence\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumNoiseAndDecoherence"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "f08b4998-afe5-4839-9a15-9485c895e17c"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "9b53eebd-0a93-4ea7-895a-06e1c65b227d"]
         }],ExpressionUUID->"083298a2-a3f0-411a-81dd-54a45feeb112"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/ChoiMatrix\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/ChoiMatrix"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
ChoiMatrix.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "QuantumMob/Q3/ref/ChoiMatrix" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "1de026dd-11ec-41b9-9495-a4e0493aeed7"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "09dc2156-b4d4-4d30-92ca-92130a0cfc1b"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"5554f763-4671-4d69-85bd-ec088fbdf0b1"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"9f5e0f3d-52c6-4336-827a-a26d3040144e"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "ChoiMatrix", "ObjectName",ExpressionUUID->
      "4818976e-002a-44cd-accd-4f357b16ee84"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"b08a8d41-7a0c-413c-ac44-93d198f822bd"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "d70f04fb-2b50-40e1-b617-9a746a2815fb"]
    }],ExpressionUUID->"f0f82c1b-faf6-474a-a7bb-7d9416e41b9e"], 
    "\[SpanFromLeft]"}
  }]], "ObjectNameGrid",ExpressionUUID->"920c8e8d-27d7-4c8a-9aa4-\
6a1ba110394d"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["spec", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "200f8e17-c648-4385-a70c-ed4d80518f81"],
     "\[LineSeparator]returns the Choi matrix of ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["Supermap"]], "paclet:QuantumMob/Q3/ref/Supermap", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["spec", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "53582e3f-d9c0-43f1-8143-784ed8c67c25"],
     "."
    }],ExpressionUUID->"cf903a92-3008-4260-a75f-e14d91a7486e"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        TemplateBox[{
          Cell[
           TextData["Supermap"]], "paclet:QuantumMob/Q3/ref/Supermap", 
          "QuantumMob Package Symbol"},
         "PackageLink",
         BaseStyle->"InlineFormula"], "[", 
        StyleBox["spec", "TI"], "]"}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "14d3761b-28b0-49d1-92bf-c8d0bb94c8eb"],
     "\[LineSeparator]is equivalent to ",
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["spec", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "3129ffde-ce3b-40bf-8594-9e4b13006fe9"],
     "."
    }],ExpressionUUID->"5b15287c-26e4-4863-93dc-48ba66fc64c7"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        TemplateBox[{
          Cell[
           TextData["LindbladSupermap"]], 
          "paclet:QuantumMob/Q3/ref/LindbladSupermap", 
          "QuantumMob Package Symbol"},
         "PackageLink",
         BaseStyle->"InlineFormula"], "[", 
        RowBox[{"{", 
         RowBox[{
          StyleBox["a", "TI"], ",", 
          SubscriptBox[
           StyleBox["b", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["b", "TI"], 
           StyleBox["2", "TR"]], ",", 
          StyleBox["\[Ellipsis]", "TR"]}], 
         StyleBox["}", "TR"]}], "]"}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "ad62bc57-a0e5-4889-b121-7283a12a0ad9"],
     "\[LineSeparator]returns the Choi matrix of the Lindblad generator, a \
superoperator generating the Markovian quantum operation associated with the \
effective Hamiltonian ",
     Cell[BoxData[
      StyleBox["a", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "cf61e937-46a4-4bb0-b9c6-d4a58e48d248"],
     " and the Lindblad operators ",
     Cell[BoxData[
      RowBox[{
       SubscriptBox[
        StyleBox["b", "TI"], 
        StyleBox["1", "TR"]], ",", 
       SubscriptBox[
        StyleBox["b", "TI"], 
        StyleBox["2", "TR"]], ",", 
       StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "266a8747-c139-43a3-bf0e-fc7af7b6b036"],
     "."
    }],ExpressionUUID->"02856afd-204a-43d3-8421-2b2c9b7897ab"]}
  }]], "Usage",
 CellID->982511436,ExpressionUUID->"36d294c7-65ad-4677-b95e-6ff5e6e47ce3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[
       MatchQ[
        CurrentValue[
         EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, 
         Closed], 
        Alternatives[Open, True]], 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"423600f7-7954-4623-bd30-f1afc2c12958"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"023aed76-6a85-4e56-a447-dc75fd899a49"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"803775f9-55af-4823-875f-b6ad46ad8e5c"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"2fea4981-e445-4a9f-aaf2-8e7a13378906"]], \
"NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->717055683,ExpressionUUID->"a4f466bb-6eb0-4e7f-8744-1123ad833b6f"],

Cell[TextData[{
 "The allowed forms are the same as for ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Supermap"]], "paclet:QuantumMob/Q3/ref/Supermap", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "6210cb05-40f9-477b-ae92-bf32babc4d11"],
 ":\[LineSeparator]- ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   StyleBox["a", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "5450cf7c-6989-4ecb-b2b6-5640e15c7142"],
 "\[LineSeparator]- ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    StyleBox["a", "TI"], ",", 
    StyleBox["b", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "474aef6f-32a0-4703-92b6-6622b130264f"],
 "\[LineSeparator]- ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      StyleBox["a", "TI"], 
      StyleBox["1", "TR"]], ",", 
     SubscriptBox[
      StyleBox["a", "TI"], 
      StyleBox["2", "TR"]], ",", 
     StyleBox["\[Ellipsis]", "TR"]}], "}"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "44a6d351-45ac-4525-87aa-67e3ae183cc6"],
 "\[LineSeparator]- ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["a", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["a", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "a1d4b502-3392-4344-8e97-360c4c2f6302"],
 "\[LineSeparator]- ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["a", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["a", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["11", "TR"]], ",", 
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["12", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["21", "TR"]], ",", 
        SubscriptBox[
         StyleBox["c", "TI"], 
         StyleBox["22", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "47c2b6da-cd57-48a7-9137-d3eb2324d8c7"]
}], "Notes",
 CellID->277061214,ExpressionUUID->"7f39b5f8-ba5b-41ef-8f7b-489ce2fb4172"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ChoiMatrix"]], "paclet:QuantumMob/Q3/ref/ChoiMatrix", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "92b2e261-c9a0-48e2-82b2-497dcbcead81"],
 " returns a forth-rank tensor, but is typically called a matrix regarding \
the first two and last two indexes as collective indices."
}], "Notes",
 CellID->1067943069,ExpressionUUID->"f9730bf9-a3df-4498-9028-b1614e86f36a"],

Cell[TextData[{
 "Let \[ScriptCapitalV] and \[ScriptCapitalW] be vector spaces, and suppose \
that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{
         SubscriptBox["v", "k"]},
        "Ket"], "|", "k"}], "=", "1"}], ",", "2", ",", "\[Ellipsis]", ",", 
     "m"}], "}"}], TraditionalForm]],ExpressionUUID->
  "18075571-8969-49fc-95b5-e4d5e26ac486"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       TemplateBox[{
         SubscriptBox["w", "j"]},
        "Ket"], "|", "j"}], "=", "1"}], ",", "2", ",", "\[Ellipsis]", ",", 
     "n"}], "}"}], TraditionalForm]],ExpressionUUID->
  "3bcb23c4-16a6-4311-a5a5-99a341be211d"],
 " be their respective orthonormal bases. Let ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", ":", 
    RowBox[{"\[ScriptCapitalL]", 
     RowBox[{"(", "\[ScriptCapitalV]", ")"}]}]}], "\[Rule]", 
   RowBox[{"\[ScriptCapitalL]", 
    RowBox[{"(", "\[ScriptCapitalW]", ")"}]}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "c397eac6-42bf-4026-9fd1-cc79a93a1ab9"],
 " be a supermap from linear operators on ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalV]", TraditionalForm]],ExpressionUUID->
  "2ab0a876-b192-4e73-ade9-88d20a0ec72d"],
 " to linear operators on ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalW]", TraditionalForm]],ExpressionUUID->
  "26f070d5-aeb0-4cb4-8c9d-1a79d6533d3a"],
 ". The Choi matrix ",
 Cell[BoxData[
  FormBox["C", TraditionalForm]],ExpressionUUID->
  "6b8b7a8c-91d3-41ed-a0f1-6c5f789c6cc9"],
 " of ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalF]", TraditionalForm]],ExpressionUUID->
  "ecf0dd8c-7a0d-4b57-8e1e-51037d5ecc5a"],
 " is defined by\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalF]", "(", 
     RowBox[{
      TemplateBox[{
        SubscriptBox["v", "k"]},
       "Ket"], 
      TemplateBox[{
        SubscriptBox["v", "l"]},
       "Bra"]}], ")"}], ":=", 
    RowBox[{
     UnderscriptBox["\[CapitalSigma]", 
      RowBox[{"i", "\[ThinSpace]", "j"}]], 
     TemplateBox[{
       SubscriptBox["w", "i"]},
      "Ket"], 
     SubscriptBox["C", 
      RowBox[{
       RowBox[{"i", "\[VeryThinSpace]", "k"}], ";", 
       RowBox[{"j", "\[VeryThinSpace]", "l"}]}]], 
     TemplateBox[{
       SubscriptBox["w", "j"]},
      "Bra"]}]}], TraditionalForm]],ExpressionUUID->
  "e46e8d53-4fa0-4071-8716-8897a32d455f"],
 ".\[LineSeparator]More precisely, it is a forth-rank tensor, and yet is \
frequently called a matrix by regarding the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"i", ",", "k"}], ")"}], TraditionalForm]],ExpressionUUID->
  "b5317d92-17b2-45ce-8a5e-87bca1a0678a"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"j", ",", "l"}], ")"}], TraditionalForm]],ExpressionUUID->
  "1414dd10-8e66-4f0a-a03c-0c268e045681"],
 " as collective indices."
}], "Notes",
 CellID->2071262949,ExpressionUUID->"9823195d-f928-484d-a525-8ac8f7ffc1b7"],

Cell["\<\
If a supermap is completely positive, then its Choi matrix is positive.\
\>", "Notes",
 CellID->1804368584,ExpressionUUID->"2e41b3c6-f1a7-4e08-aa9a-d1215db33db7"],

Cell[TextData[{
 "The Choi matrix of a supermap ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", ":", 
    RowBox[{"\[ScriptCapitalL]", 
     RowBox[{"(", "\[ScriptCapitalV]", ")"}]}]}], "\[Rule]", 
   RowBox[{"\[ScriptCapitalL]", 
    RowBox[{"(", "\[ScriptCapitalW]", ")"}]}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "10e211a6-413b-497b-b674-3dd7a83f0ed4"],
 " defined by ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", 
    RowBox[{"(", "\[Rho]", ")"}]}], ":=", 
   RowBox[{
    StyleBox["A",
     FontSlant->"Italic"], " ", "\[Rho]", " ", 
    SuperscriptBox[
     StyleBox["B",
      FontSlant->"Italic"], "\[Dagger]"]}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "ac80887c-4ca9-4628-8313-61816ce48868"],
 ", where ",
 Cell[BoxData[
  RowBox[{
   StyleBox["A",
    FontSlant->"Italic"], ",", 
   RowBox[{
    StyleBox["B",
     FontSlant->"Italic"], "\[Element]", 
    RowBox[{"\[ScriptCapitalL]", 
     RowBox[{"(", 
      RowBox[{"\[ScriptCapitalV]", ",", "\[ScriptCapitalW]"}], ")"}]}]}]}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "d7d0caf6-467c-4c2b-9698-ad38ec94b224"],
 ", is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", 
     RowBox[{
      RowBox[{"i", "\[VeryThinSpace]", "k"}], ";", 
      RowBox[{"j", "\[VeryThinSpace]", "l"}]}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["A", 
       RowBox[{"i", "\[VeryThinSpace]", "\[Kappa]"}]], 
      SubsuperscriptBox["B", 
       RowBox[{"j", "\[VeryThinSpace]", "l"}], "*"]}], "\[Congruent]", 
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{"A", "\[CircleTimes]", 
        SuperscriptBox["B", "*"]}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", ",", "j"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"k", ",", "l"}], ")"}]}]]}]}], TraditionalForm]],
  ExpressionUUID->"a746a0fb-feae-4d0f-9954-36c087aef2d0"],
 ". The corresponding ",
 StyleBox["super-matrix",
  FontSlant->"Italic"],
 " is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", ",", "j"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"k", ",", "l"}], ")"}]}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["A", 
       RowBox[{"i", "\[VeryThinSpace]", "k"}]], 
      SubsuperscriptBox["B", 
       RowBox[{"j", "\[VeryThinSpace]", "l"}], "*"]}], "\[Congruent]", 
     SubscriptBox[
      RowBox[{"(", 
       RowBox[{"A", "\[CircleTimes]", 
        SuperscriptBox["B", "*"]}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", ",", "j"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"k", ",", "l"}], ")"}]}]]}]}], TraditionalForm]],
  ExpressionUUID->"470f5a33-5f06-4c2a-81cc-e4c7780cf212"],
 "; that is, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", ",", "j"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"k", ",", "l"}], ")"}]}]], "=", 
    SubscriptBox["C", 
     RowBox[{
      RowBox[{"i", "\[VeryThinSpace]", "k"}], ";", 
      RowBox[{"j", "\[VeryThinSpace]", "l"}]}]]}], TraditionalForm]],
  ExpressionUUID->"581cb94a-50cb-4d30-80bb-ca2b96298f53"],
 " ."
}], "Notes",
 CellID->544097144,ExpressionUUID->"dfc75c5b-33d5-4717-8511-899675075cf9"],

Cell[TextData[{
 "Let ",
 Cell[BoxData[
  RowBox[{"\[ScriptCapitalF]", ":", 
   RowBox[{"\[Rho]", "\[RightTeeArrow]", "\[Sigma]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "3a1b6477-c085-44f2-9807-15f91bcb2d15"],
 " be a supermap, and ",
 Cell[BoxData["C"], "InlineFormula",
  FontFamily->"Source Sans Pro",
  FontSlant->"Italic",ExpressionUUID->
  "ecf1e9e2-05e5-4d2d-84da-6707fc3136ad"],
 " its Choi matrix. Then, the components of \[Rho] and \[Sigma] are related \
by the transformation\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Sigma]", 
     RowBox[{"i", "\[VeryThinSpace]", "j"}]], "=", 
    RowBox[{
     RowBox[{
      UnderscriptBox["\[CapitalSigma]", 
       RowBox[{"k", "\[VeryThinSpace]", "l"}]], 
      SubscriptBox["C", 
       RowBox[{
        RowBox[{"i", "\[VeryThinSpace]", "k"}], ";", 
        RowBox[{"j", "\[VeryThinSpace]", "l"}]}]], 
      SubscriptBox["\[Rho]", 
       RowBox[{"k", "\[VeryThinSpace]", "l"}]]}], "=", 
     RowBox[{
      UnderscriptBox["\[CapitalSigma]", 
       RowBox[{"k", "\[VeryThinSpace]", "l"}]], 
      SubscriptBox["M", 
       RowBox[{
        RowBox[{"i", "\[VeryThinSpace]", "j"}], ";", 
        RowBox[{"k", "\[VeryThinSpace]", "l"}]}]], 
      SubscriptBox["\[Rho]", 
       RowBox[{"k", "\[VeryThinSpace]", "l"}]]}]}]}], TraditionalForm]],
  ExpressionUUID->"46d8343b-ac7c-4bbf-8416-9f101de75b0e"]
}], "Notes",
 CellID->688867986,ExpressionUUID->"9c07e505-f73c-4c6f-9dc9-280cd09c40f1"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"11cb618c-5e07-45f4-ae0f-d92b187633a4"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"76a43307-9019-4721-bd98-1bff688820e4"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(6)", "ExampleCount",ExpressionUUID->
  "b3eb8f61-8566-4bd7-b806-26daada2034e"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->2024120864,ExpressionUUID->"b1936547-362f-46ca-a923-6e255aa23d9b"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1927565408,ExpressionUUID->"96f898a5-69d3-4439-add0-1d637339334e"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"996a935a-1cd5-41ca-8ca4-be0acdf1331d"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"7db897c1-f03d-466f-9af2-7bd4400b22d1"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "62c36b55-4130-4d6f-b65a-ff805e38cfa9"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1110909121,ExpressionUUID->"e817ac22-5e8a-4ff5-a170-bb332ecf1e11"],

Cell["Let us consider supermaps transforming matrices of the form.", \
"ExampleText",
 CellID->553412081,ExpressionUUID->"417dba69-19da-41b4-b8da-76b0a1b88559"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "\[Rho]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"\[Rho]", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->445170210,ExpressionUUID->"3b51679c-47b2-4bfb-a35c-593143aa14b9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"1", "\",\"", "1"},
         "RowDefault"]],
       $CellContext`\[Rho][1, 1]], 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"1", "\",\"", "2"},
         "RowDefault"]],
       $CellContext`\[Rho][1, 2]]},
     {
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"2", "\",\"", "1"},
         "RowDefault"]],
       $CellContext`\[Rho][2, 1]], 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"2", "\",\"", "2"},
         "RowDefault"]],
       $CellContext`\[Rho][2, 2]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[1]//MatrixForm=",
 CellID->1409239597,ExpressionUUID->"66e30877-128b-44e2-9cf3-8985328b2497"]
}, Open  ]],

Cell["Here is a supermap.", "ExampleText",
 CellID->925413985,ExpressionUUID->"fdb5238a-8879-4135-958a-a3b2d809b54c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"ThePauli", "[", "4", "]"}]}], ",", 
     RowBox[{"ThePauli", "[", "5", "]"}], ",", 
     RowBox[{"ThePauli", "[", "6", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"spr", "=", 
  RowBox[{"Supermap", "[", "ops", "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1356274321,ExpressionUUID->"c74aad6b-5e81-43db-b73e-b73c998338e7"],

Cell[BoxData[
 RowBox[{"Supermap", "[", 
  InterpretationBox[
   RowBox[{
    TagBox["SparseArray",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["16", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["16", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["0", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["1.`", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"\"", "SummaryItem"]}]}, {
                TagBox[
                 TagBox[
                  GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["1", "2"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   DefaultBaseStyle -> "Column", 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                  "Column"], "SummaryItem"]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   SparseArray[
   Automatic, {2, 2, 2, 2}, 0, {
    1, {{0, 8, 16}, {{1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {2, 1, 2}, {
      2, 1, 1}, {2, 2, 1}, {2, 2, 2}, {1, 2, 1}, {1, 1, 1}, {1, 1, 2}, {1, 2, 
      2}, {2, 1, 1}, {2, 1, 2}, {2, 2, 1}, {2, 2, 2}}}, {
     Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], 
      Rational[9, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], 
      Rational[3, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], 
      Rational[-1, 2], Rational[-1, 2], Rational[-1, 2], Rational[1, 2]}}],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1853783995,ExpressionUUID->"e0107459-e1f5-4592-8e44-d9ce74c726bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{"spr", "[", "rho", "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1022965681,ExpressionUUID->"2db42770-9c28-4ba9-a1c3-450e290de986"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "+", 
         RowBox[{"9", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"\[Rho]"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`\[Rho][2, 2]]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"\[Rho]"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`\[Rho][1, 1]]}], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[3]//MatrixForm=",
 CellID->1934230348,ExpressionUUID->"a7af81b9-2799-47b3-8de0-d141caaa3748"]
}, Open  ]],

Cell["This gives the Choi matrix corresponding to the supermap.", \
"ExampleText",
 CellID->1016862214,ExpressionUUID->"b39d97e9-9d8c-4276-9787-245754dad782"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tsr", "=", 
  RowBox[{"ChoiMatrix", "[", "ops", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->643632301,ExpressionUUID->"36040567-df7c-4f73-a47a-1c3c3e94aaab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["16", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["16", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1.`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "2"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["1", "2"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {2, 2, 2, 2}, 0, {
   1, {{0, 8, 16}, {{1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {2, 1, 2}, {2,
      1, 1}, {2, 2, 1}, {2, 2, 2}, {1, 2, 1}, {1, 1, 1}, {1, 1, 2}, {1, 2, 
     2}, {2, 1, 1}, {2, 1, 2}, {2, 2, 1}, {2, 2, 2}}}, {
    Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], Rational[
     9, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], Rational[3, 2], 
     Rational[1, 2], Rational[1, 2], Rational[-1, 2], Rational[-1, 2], 
     Rational[-1, 2], Rational[-1, 2], Rational[1, 2]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1734096540,ExpressionUUID->"74de5ce7-4485-463c-9500-1f542899fac8"]
}, Open  ]],

Cell["\<\
The Choi matrix provides a matrix representation of the supermap.\
\>", "ExampleText",
 CellID->1355606217,ExpressionUUID->"06f4021f-e524-41d2-a79d-d8fc6bc64a19"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", "rho"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"more", "//", "SimplifyThrough"}], "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1592314655,ExpressionUUID->"6f19d307-9ce8-4fb9-a066-916bbb9c781f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "+", 
         RowBox[{"9", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"\[Rho]"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`\[Rho][2, 2]]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"\[Rho]"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`\[Rho][1, 1]]}], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][1, 2]], "-", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 1]], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"\[Rho]"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`\[Rho][2, 2]]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {1}, {2}}}, {
      Rational[1, 2] ($CellContext`\[Rho][1, 1] + $CellContext`\[Rho][
         1, 2] + $CellContext`\[Rho][2, 1] + 9 $CellContext`\[Rho][2, 2]), 
       Rational[1, 2] ($CellContext`\[Rho][1, 1] - $CellContext`\[Rho][
        1, 2] + $CellContext`\[Rho][2, 1] - $CellContext`\[Rho][2, 2]), 
       Rational[
        1, 2] ($CellContext`\[Rho][1, 1] + $CellContext`\[Rho][
         1, 2] - $CellContext`\[Rho][2, 1] - $CellContext`\[Rho][2, 2]), 
       Rational[1, 2] (3 $CellContext`\[Rho][1, 1] - $CellContext`\[Rho][
        1, 2] - $CellContext`\[Rho][
        2, 1] + $CellContext`\[Rho][2, 2])}}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->2073499931,ExpressionUUID->"391ca872-e58f-4ffc-b27b-0d03210fc664"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "more"}], "//", "SimplifyThrough"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1640340825,ExpressionUUID->"85420f71-f0fc-4581-bd58-8aecf4b2ecc5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1407484755,ExpressionUUID->"179f0b5d-b3c6-4206-86d3-572d20d4ff3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "8d29034b-ef2d-4d3f-8c45-b59fd0551e06"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1958003159,ExpressionUUID->"7d7269b3-1bb0-4623-a008-03729500d7ef"],

Cell["\<\
The above example with unlabelled qubits can be worked out for labelled \
qubits as well.\
\>", "ExampleText",
 CellID->2112320759,ExpressionUUID->"d3af9b02-b453-423a-8396-0217ec6a98a8"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1529421203,ExpressionUUID->"f3575c0f-948f-49e7-b63c-5460a0b1af10"],

Cell["We consider supermaps transforming operators of the form", "ExampleText",
 CellID->910124769,ExpressionUUID->"1516b434-635c-4acd-87f9-e722b9812895"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Complex", ",", "\[Rho]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "=", 
  RowBox[{
   RowBox[{"\[Rho]", "@", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}]}], ".", 
   RowBox[{"S", "[", "Full", "]"}]}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1171754921,ExpressionUUID->"2465cb0b-7eef-4bd2-bdf3-685d6f02b32b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"0"}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[0]], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"0"},
      "RowDefault"]],
    $CellContext`\[Rho][0]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"X\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[1]], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"1"},
      "RowDefault"]],
    $CellContext`\[Rho][1]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"Y\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[2]], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    $CellContext`\[Rho][2]]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"Z\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[3]], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"3"},
      "RowDefault"]],
    $CellContext`\[Rho][3]]}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->64790341,ExpressionUUID->"f4d4ad36-9e3d-4ea6-9bab-18ce44aeca95"]
}, Open  ]],

Cell["\<\
Here is a supermap, specified by a set of three Kraus elements.\
\>", "ExampleText",
 CellID->659929661,ExpressionUUID->"7d0e01b7-8852-4e6d-bc00-7912497724ad"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"S", "[", "4", "]"}]}], ",", 
     RowBox[{"S", "[", "5", "]"}], ",", 
     RowBox[{"S", "[", "6", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"spr", "=", 
  RowBox[{"Supermap", "[", "ops", "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2146884351,ExpressionUUID->"f0d79fb9-6ab0-43ec-964b-cee142399705"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["Supermap",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"completely positive\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Kraus elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"completely positive\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Kraus elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Kraus elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    InterpretationBox[
                    TemplateBox[{
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"\"+\""}, "RowDefault"]}, "Superscript", 
                    SyntaxForm -> SuperscriptBox], 
                    $CellContext`S[4]]}], ",", 
                    InterpretationBox[
                    TemplateBox[{
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"\"-\""}, "RowDefault"]}, "Superscript", 
                    SyntaxForm -> SuperscriptBox], 
                    $CellContext`S[5]], ",", 
                    InterpretationBox[
                    TemplateBox[{
                    TemplateBox[{"S"}, "RowDefault"], 
                    TemplateBox[{"\"H\""}, "RowDefault"]}, "Superscript", 
                    SyntaxForm -> SuperscriptBox], 
                    $CellContext`S[6]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`Supermap[{2 $CellContext`S[4], 
    $CellContext`S[5], 
    $CellContext`S[6]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1862438804,ExpressionUUID->"9cd22ac7-1d8c-496a-8dc7-f5609211c706"]
}, Open  ]],

Cell[TextData[{
 "Under the supermap, the operator ",
 StyleBox["rho", "Input"],
 " transforms as follows."
}], "ExampleText",
 CellID->1760269154,ExpressionUUID->"7736e5ea-f680-4eab-b479-af1e90cc845e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"spr", "[", "rho", "]"}], "//", "Elaborate"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1142711461,ExpressionUUID->"ad255bc3-8cda-4622-a2fc-9692a2f29ff3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"S"}, "RowDefault"], 
       TemplateBox[{"\"Y\""}, "RowDefault"]},
      "Superscript"],
     $CellContext`S[2]]}], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"2"},
      "RowDefault"]],
    $CellContext`\[Rho][2]]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"7", " ", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"0"},
         "RowDefault"]],
       $CellContext`\[Rho][0]]}], "-", 
     RowBox[{"3", " ", 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"\[Rho]"},
         "RowDefault"], 
        TemplateBox[{"3"},
         "RowDefault"]],
       $CellContext`\[Rho][3]]}]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"Z\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[3]], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"0"},
          "RowDefault"]],
        $CellContext`\[Rho][0]]}], "2"], "+", 
     InterpretationBox[
      SubscriptBox[
       TemplateBox[{"\[Rho]"},
        "RowDefault"], 
       TemplateBox[{"1"},
        "RowDefault"]],
      $CellContext`\[Rho][1]], "-", 
     FractionBox[
      RowBox[{"5", " ", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"3"},
          "RowDefault"]],
        $CellContext`\[Rho][3]]}], "2"]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"S"}, "RowDefault"], 
      TemplateBox[{"\"X\""}, "RowDefault"]},
     "Superscript"],
    $CellContext`S[1]], " ", 
   InterpretationBox[
    SubscriptBox[
     TemplateBox[{"\[Rho]"},
      "RowDefault"], 
     TemplateBox[{"3"},
      "RowDefault"]],
    $CellContext`\[Rho][3]]}]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1934352376,ExpressionUUID->"e812b593-0cd2-45cf-9f81-87040bc6688a"]
}, Open  ]],

Cell["This gives the Choi matrix corresponding to the supermap.", \
"ExampleText",
 CellID->1244330407,ExpressionUUID->"20a97d4d-305a-4f94-bae0-2075d421d790"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tsr", "=", 
   RowBox[{"ChoiMatrix", "[", "spr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "@", "tsr"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1265395963,ExpressionUUID->"c7309177-1df3-4390-9947-d24dba12b1f2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1660482032,ExpressionUUID->"9bc497ec-bd35-4ba3-a9d2-b33c94f9b3b6"]
}, Open  ]],

Cell["\<\
The Choi matrix provides a matrix representation of the supermap.\
\>", "ExampleText",
 CellID->211123045,ExpressionUUID->"e7dabb25-3d53-42d2-85ec-a855b1296f55"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", 
       RowBox[{"Matrix", "@", "rho"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"more", "//", "SimplifyThrough"}], "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->702032471,ExpressionUUID->"ba30f153-3add-4975-baa5-4e65851264ec"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"5", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"\[Rho]"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         $CellContext`\[Rho][0]]}], "+", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]],
        $CellContext`\[Rho][1]], "-", 
       RowBox[{"4", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"\[Rho]"},
           "RowDefault"], 
          TemplateBox[{"3"},
           "RowDefault"]],
         $CellContext`\[Rho][3]]}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"\[Rho]"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`\[Rho][2]]}], "+", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"3"},
          "RowDefault"]],
        $CellContext`\[Rho][3]]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"\[Rho]"},
           "RowDefault"], 
          TemplateBox[{"2"},
           "RowDefault"]],
         $CellContext`\[Rho][2]]}], "+", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"3"},
          "RowDefault"]],
        $CellContext`\[Rho][3]]}], 
      RowBox[{
       RowBox[{"2", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"\[Rho]"},
           "RowDefault"], 
          TemplateBox[{"0"},
           "RowDefault"]],
         $CellContext`\[Rho][0]]}], "-", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"1"},
          "RowDefault"]],
        $CellContext`\[Rho][1]], "+", 
       InterpretationBox[
        SubscriptBox[
         TemplateBox[{"\[Rho]"},
          "RowDefault"], 
         TemplateBox[{"3"},
          "RowDefault"]],
        $CellContext`\[Rho][3]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {1}, {2}}}, {
      5 $CellContext`\[Rho][0] + $CellContext`\[Rho][1] - 
       4 $CellContext`\[Rho][3], 
       Complex[0, 1] $CellContext`\[Rho][2] + $CellContext`\[Rho][3], 
       Complex[0, -1] $CellContext`\[Rho][2] + $CellContext`\[Rho][3], 
       2 $CellContext`\[Rho][0] - $CellContext`\[Rho][
       1] + $CellContext`\[Rho][3]}}]]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->756947743,ExpressionUUID->"2458ceaa-0f61-4a1f-806d-9ff031d6e69d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "-", 
   RowBox[{"ExpressionFor", "[", 
    RowBox[{"more", ",", "S"}], "]"}]}], "//", "Elaborate"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->944938973,ExpressionUUID->"5d7e1bca-d0fd-4291-b076-b6594526117c"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[7]=",
 CellID->1622060024,ExpressionUUID->"f39553ef-f679-434b-9612-026763913271"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "2898a0a5-cd67-4896-a283-79659e37bb4e"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->104323313,ExpressionUUID->"1ee7b784-8d3c-4732-b03d-3d257e867f6b"],

Cell["This is the case of completely positive supermap .", "ExampleText",
 CellID->1003924897,ExpressionUUID->"8aaa76c0-274f-4157-85fc-47da7a1670a6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kbs", "=", 
   RowBox[{"LieBasis", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "kbs"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->2047323406,ExpressionUUID->"385148a4-3896-4ac1-9778-2b2e24f870b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["3"]], "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["3"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 3}, {{1}, {2}, {3}}}, {
        3^Rational[-1, 2], 3^Rational[-1, 2], 3^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{2}, {1}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}], "0"},
       {
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0", "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{2}, {1}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["2"]]}], "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{1}, {2}}}, {
        2^Rational[-1, 2], -2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", "0", "0"},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 1, 2}, {{3}, {1}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}]},
       {"0", "0", "0"},
       {
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 1, 2}, {{3}, {1}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 0, 1, 2}, {{3}, {2}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}]},
       {"0", 
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 0, 1, 2}, {{3}, {2}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["6"]], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["6"]], "0"},
       {"0", "0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "3"]]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 3}, {{1}, {2}, {3}}}, {
        6^Rational[-1, 2], 6^Rational[-1, 2], -
         Rational[2, 3]^Rational[1, 2]}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->845187401,ExpressionUUID->"de9b1377-20f2-48f8-91d2-d82f1643313c"]
}, Open  ]],

Cell["\<\
Consider a quantum operation, i.e., a completely positive supermap.\
\>", "ExampleText",
 CellID->885184976,ExpressionUUID->"e16689e1-05e8-4c43-813d-c60a1bd18c68"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"$n", "^", "2"}]}], "]"}], "*", "kbs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"superOp", "=", 
  RowBox[{"Supermap", "[", "ops", "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->2044491245,ExpressionUUID->"d1e6d360-b899-4d2a-b7f9-d02f613e9021"],

Cell[BoxData[
 RowBox[{"Supermap", "[", 
  InterpretationBox[
   RowBox[{
    TagBox["SparseArray",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["21", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["21", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["0.25925925925925924`", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"\"", "SummaryItem"]}]}, {
                TagBox[
                 TagBox[
                  GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.1440254998038097`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.1286707741612999`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.2725683347989404`"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.7686726452836881`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   DefaultBaseStyle -> "Column", 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                  "Column"], "SummaryItem"]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   SparseArray[
   Automatic, {3, 3, 3, 3}, Complex[0., 0.], {
    1, {{0, 7, 14, 21}, {{1, 1, 1}, {1, 2, 2}, {1, 3, 3}, {2, 1, 2}, {2, 2, 
      1}, {3, 1, 3}, {3, 3, 1}, {1, 1, 2}, {1, 2, 1}, {2, 1, 1}, {2, 2, 2}, {
      2, 3, 3}, {3, 2, 3}, {3, 3, 2}, {1, 1, 3}, {1, 3, 1}, {2, 2, 3}, {2, 3, 
      2}, {3, 1, 1}, {3, 2, 2}, {3, 3, 3}}}, CompressedData["
1:eJxTTMoPShNlYGAoZgESPpnFJWlMIB47kHDOzy3ISa0o+uayszQ3/5B9EQMU
YCr5s6RmvUfFAXxKmvb9KDlUeHE/HiV8EVIJ32e8wGdKntyiL2w+h/EpcS0+
3VGtvx6fkrOHzh2977oSn1uIsIgI5xIRLkSELhFBdy83++v5NefxmSKX7xht
GYxXCRHhQkToEmEREc4lwtNEKNlz8+Thc0UPERYBAOoqwkw=
     "]}],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->86247225,ExpressionUUID->"56ac1ac3-1296-42b5-90d6-f663a17e0f72"]
}, Open  ]],

Cell["\<\
This is the corresponding Choi matrix. In fact, it is a fourth-rank tensor.\
\>", "ExampleText",
 CellID->404204944,ExpressionUUID->"53339261-7b65-41a2-84a4-eb16f4fc6b8f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tsr", "=", 
  RowBox[{"ChoiMatrix", "[", "ops", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->315678790,ExpressionUUID->"bf459910-f69d-4fa5-bfdb-729f5ef785a6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["21", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["21", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.25925925925925924`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.1440254998038097`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.1286707741612999`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "3", ",", "3"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.2725683347989404`"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.7686726452836881`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {3, 3, 3, 3}, Complex[0., 0.], {
   1, {{0, 7, 14, 21}, {{1, 1, 1}, {1, 2, 2}, {1, 3, 3}, {2, 1, 2}, {2, 2, 
     1}, {3, 1, 3}, {3, 3, 1}, {1, 1, 2}, {1, 2, 1}, {2, 1, 1}, {2, 2, 2}, {2,
      3, 3}, {3, 2, 3}, {3, 3, 2}, {1, 1, 3}, {1, 3, 1}, {2, 2, 3}, {2, 3, 
     2}, {3, 1, 1}, {3, 2, 2}, {3, 3, 3}}}, CompressedData["
1:eJxTTMoPShNlYGAoZgESPpnFJWlMIB47kHDOzy3ISa0o+uayszQ3/5B9EQMU
YCr5s6RmvUfFAXxKmvb9KDlUeHE/HiV8EVIJ32e8wGdKntyiL2w+h/EpcS0+
3VGtvx6fkrOHzh2977oSn1uIsIgI5xIRLkSELhFBdy83++v5NefxmSKX7xht
GYxXCRHhQkToEmEREc4lwtNEKNlz8+Thc0UPERYBAOoqwkw=
    "]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1875087885,ExpressionUUID->"0903cad0-e721-4c2b-9f8f-b4c20b61b891"]
}, Open  ]],

Cell["\<\
Regarding the first two indices collectively as a single index and similarly \
for the last two indices, the Choi matrix is a positive matrix.\
\>", "ExampleText",
 CellID->905156507,ExpressionUUID->"44806612-77c1-4ea8-91bf-23daba3909c1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{"tsr", ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "9"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"HermitianMatrixQ", "@", "mat"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eigenvalues", "[", "mat", "]"}], "//", "TableForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1963657499,ExpressionUUID->"99522477-1e66-4371-877e-92377de915c4"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[4]=",
 CellID->1544102239,ExpressionUUID->"77d353b8-6733-4000-8e2f-a3bbe39fef41"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"0.9194303103931724`"},
     {"0.8178329435629903`"},
     {"0.6179149801742043`"},
     {"0.49218861045094525`"},
     {"0.11027036032201566`"},
     {"0.015354725642509824`"},
     {"0.011547915985233564`"},
     {"0.00273401763478465`"},
     {"0.00012793916616904433`"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[4]//TableForm=",
 CellID->1533940525,ExpressionUUID->"7fdcee7c-1512-4504-bfe3-af0a05fa5409"]
}, Open  ]],

Cell["\<\
To illustrate the Choi isomorphism between supermaps and linear maps, let us \
consider an operator (not necessary a density operator) on a vector space.\
\>", "ExampleText",
 CellID->1014268615,ExpressionUUID->"f5131dbf-2319-4574-912c-f98493c9a8f6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"RandomMatrix", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->85447438,ExpressionUUID->"a3219e67-492d-4dc7-b4a2-bc6fe70df1ba"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.634508885698096`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.7321080884756506`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.9105527080635816`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3418541387717875`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.33778914809844585`"}], "+", 
       RowBox[{"0.041916290186096106`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.022428715837329527`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6389297391427418`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.8629526274129238`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3279304709197146`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.3520498658885205`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5104993171125289`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.9651535567787146`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.055257987464413016`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.3302697705759021`"}], "-", 
       RowBox[{"0.2758496091490752`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.5882479199708461`"}], "-", 
       RowBox[{"0.10721996449655435`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1563663790,ExpressionUUID->"ccaafb2e-87c4-4aa3-9f5e-e48124a0f559"]
}, Open  ]],

Cell["\<\
This is the new linear operator obtained by operating the Supermap on \[Rho]. \
\>", "ExampleText",
 CellID->543923410,ExpressionUUID->"b64d644c-0a2f-48a7-a26d-293b3c0b5cf5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"superOp", "[", "\[Rho]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->717229906,ExpressionUUID->"2687ee5f-b00c-443a-82c0-fff5eccac359"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.718883864434541`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.14009827356751792`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.12054282269224906`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.14031019232818173`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04442946646757904`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.014152655212782443`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.14015872045701608`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13374871593942217`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.46644820383675034`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5420539043329988`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.17678367374978182`"}], "+", 
       RowBox[{"0.07163801971907938`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.24639661261108986`"}], "-", 
       RowBox[{"0.01713061693986642`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.17617729328002663`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04974524907441852`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06855599142413676`"}], "-", 
       RowBox[{"0.02190521944877042`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1350554867,ExpressionUUID->"bd8b8ebb-b02e-4940-938c-6236f618b06b"]
}, Open  ]],

Cell["The same can be achieved by using the Choi matrix as well.", \
"ExampleText",
 CellID->688108930,ExpressionUUID->"05f14f28-1e4a-4ce9-936c-01e54dc9d650"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", "\[Rho]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"more", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->30075672,ExpressionUUID->"e47b910d-81aa-4222-b269-0fcfa161898e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.718883864434541`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.14009827356751792`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.12054282269224906`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.14031019232818173`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04442946646757904`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.014152655212782443`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.14015872045701608`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13374871593942217`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.46644820383675023`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5420539043329987`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.17678367374978182`"}], "+", 
       RowBox[{"0.07163801971907938`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.24639661261108986`"}], "-", 
       RowBox[{"0.01713061693986642`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.17617729328002663`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04974524907441852`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.06855599142413679`"}], "-", 
       RowBox[{"0.02190521944877042`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0., {
     1, {{0, 3, 6, 9}, {{1}, {3}, {2}, {2}, {3}, {1}, {3}, {2}, {1}}}, {
      Complex[0.718883864434541, 0.14009827356751792`], Complex[
      0.04442946646757904, -0.014152655212782443`], Complex[
      0.12054282269224906`, 0.14031019232818173`], Complex[
      0.46644820383675023`, -0.5420539043329987], 
      Complex[-0.17678367374978182`, 0.07163801971907938], Complex[
      0.14015872045701608`, 0.13374871593942217`], 
      Complex[-0.06855599142413679, -0.02190521944877042], Complex[
      0.17617729328002663`, -0.04974524907441852], 
      Complex[-0.24639661261108986`, -0.01713061693986642]}}]]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->623842255,ExpressionUUID->"3ce541ba-d792-4202-8d78-afdd8a74eb87"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "more"}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->931479859,ExpressionUUID->"d3d1a45c-5099-40b1-860c-cb1ab40f97e7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->566641342,ExpressionUUID->"240bb4f1-2da7-49bf-9937-7488d9a2fc43"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"8db17343-700f-424e-bb8d-a02f90ee434d"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"20f1abad-d030-4c22-a9a2-de569cbbc891"],
 "Generalizations & Extensions",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "21975fac-423a-4dad-84ab-0040e245123b"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1020263627,ExpressionUUID->"85bb6475-fccb-4f83-9c4c-95411a492aa7"],

Cell["\<\
The Lindblad generator of a Markovian quantum operation is a special \
supermap. Let us examine its Choi matrix. Consider supermaps transforming \
density matrices of the following form.\
\>", "ExampleText",
 CellID->828732181,ExpressionUUID->"a40e061f-1ee7-435c-870f-a7a0d06eb117"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "r"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"r", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->333277970,ExpressionUUID->"a39acba9-bbaa-4395-94ca-43f8746ad81b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"r"},
         "RowDefault"], 
        TemplateBox[{"1", "\",\"", "1"},
         "RowDefault"]],
       $CellContext`r[1, 1]], 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"r"},
         "RowDefault"], 
        TemplateBox[{"1", "\",\"", "2"},
         "RowDefault"]],
       $CellContext`r[1, 2]]},
     {
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"r"},
         "RowDefault"], 
        TemplateBox[{"2", "\",\"", "1"},
         "RowDefault"]],
       $CellContext`r[2, 1]], 
      InterpretationBox[
       SubscriptBox[
        TemplateBox[{"r"},
         "RowDefault"], 
        TemplateBox[{"2", "\",\"", "2"},
         "RowDefault"]],
       $CellContext`r[2, 2]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[1]//MatrixForm=",
 CellID->515710983,ExpressionUUID->"48e25bcf-49b3-458b-919e-46ff498a2dc4"]
}, Open  ]],

Cell["First, consider the case where there is no dissipative term.", \
"ExampleText",
 CellID->2006817625,ExpressionUUID->"3404695b-6320-4500-aacc-a92e1bed4212"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"opH", "=", 
   RowBox[{"ThePauli", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gen", "=", 
  RowBox[{"LindbladSupermap", "[", 
   RowBox[{"opH", ",", "None"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->2123398300,ExpressionUUID->"fb5e7e6a-86ec-491b-9472-324d1e059020"],

Cell[BoxData[
 RowBox[{"Supermap", "[", 
  InterpretationBox[
   RowBox[{
    TagBox["SparseArray",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["8", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["8", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["0", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["0.5`", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"\"", "SummaryItem"]}]}, {
                TagBox[
                 TagBox[
                  GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "\[ImaginaryI]", ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "\[ImaginaryI]", ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "\[ImaginaryI]"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "\[ImaginaryI]"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   DefaultBaseStyle -> "Column", 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                  "Column"], "SummaryItem"]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   SparseArray[
   Automatic, {2, 2, 2, 2}, 0, {
    1, {{0, 4, 8}, {{1, 1, 2}, {1, 2, 1}, {2, 1, 1}, {2, 2, 2}, {2, 1, 2}, {2,
       2, 1}, {1, 1, 1}, {1, 2, 2}}}, {
     Complex[0, 1], Complex[0, 1], Complex[0, -1], Complex[0, -1], Complex[
      0, 1], Complex[0, 1], Complex[0, -1], Complex[0, -1]}}],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->676799938,ExpressionUUID->"a79c979d-b3f7-4be5-8a9f-de90e021d22a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"gen", "[", "\[Rho]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1152364753,ExpressionUUID->"8c8b47da-b0e7-4047-91fa-69f1845e95d4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[3]//MatrixForm=",
 CellID->616039658,ExpressionUUID->"cc36f8bf-adfb-41be-b9d6-a22a5ff07724"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tsr", "=", 
  RowBox[{"ChoiMatrix", "[", "gen", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->2118928092,ExpressionUUID->"5dd552bd-f75b-40c6-8d5f-6800be8210ab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.5`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "\[ImaginaryI]", ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "\[ImaginaryI]", ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "\[ImaginaryI]"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "\[ImaginaryI]"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {2, 2, 2, 2}, 0, {
   1, {{0, 4, 8}, {{1, 1, 2}, {1, 2, 1}, {2, 1, 1}, {2, 2, 2}, {2, 1, 2}, {2, 
     2, 1}, {1, 1, 1}, {1, 2, 2}}}, {
    Complex[0, 1], Complex[0, 1], Complex[0, -1], Complex[0, -1], Complex[
     0, 1], Complex[0, 1], Complex[0, -1], Complex[0, -1]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->72703027,ExpressionUUID->"4117c601-7abb-40af-bc25-84a50b71c2d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", "\[Rho]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"more", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1481207322,ExpressionUUID->"59c1c39a-1d99-4afb-be37-3afde55f74eb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}]}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {2}, {1}}}, {
      Complex[0, 1] $CellContext`r[1, 2] + 
       Complex[0, -1] $CellContext`r[2, 1], 
       Complex[0, 1] $CellContext`r[1, 1] + 
       Complex[0, -1] $CellContext`r[2, 2], 
       Complex[0, -1] $CellContext`r[1, 2] + 
       Complex[0, 1] $CellContext`r[2, 1], 
       Complex[0, -1] $CellContext`r[1, 1] + 
       Complex[0, 1] $CellContext`r[2, 2]}}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1825992849,ExpressionUUID->"9f93a0f5-d5c2-4040-b22c-1c72fe8b2b0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "more"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->408110433,ExpressionUUID->"68261d1a-9596-4de3-946d-2e631a7e0f60"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->944807076,ExpressionUUID->"49e8c5c5-a3a2-40a8-9925-67607390645b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "14aa9df4-cc81-4a46-a1c7-3644b4cd370f"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1374347092,ExpressionUUID->"56e93586-72bd-47c4-936e-4599be6e46be"],

Cell["Next, consider a general case with dissipative terms.", "ExampleText",
 CellID->2037101859,ExpressionUUID->"66cb5d47-eeb1-42f7-9199-1b53f9114fa5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"opH", "=", 
   RowBox[{"ThePauli", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opL", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"ThePauli", "[", "4", "]"}]}], ",", 
     RowBox[{"ThePauli", "[", "5", "]"}], ",", 
     RowBox[{"ThePauli", "[", "6", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gen", "=", 
  RowBox[{"LindbladSupermap", "[", 
   RowBox[{"opH", ",", "opL"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->239160092,ExpressionUUID->"d990bf39-3910-48e8-8f49-3b28c45b2197"],

Cell[BoxData[
 RowBox[{"Supermap", "[", 
  InterpretationBox[
   RowBox[{
    TagBox["SparseArray",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["16", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[
              RasterBox[
              SparseArray[
               Automatic, {10, 10}, 0.93, {
                1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                  10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0.,
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10,
                10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 
              1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Opacity[0.5], 
                Thickness[Tiny], 
                RGBColor[0.368417, 0.506779, 0.709798]], 
              FrameLabel -> {None, None}, 
              FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
              FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
              Scaled[0.025]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Specified elements: \"", "SummaryItemAnnotation"],
                   "\[InvisibleSpace]", 
                  TagBox["16", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["0", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["1.`", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["\"\"", "SummaryItem"]}]}, {
                TagBox[
                 TagBox[
                  GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["3", "2"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    FractionBox["1", "2"], "+", "\[ImaginaryI]"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    FractionBox["1", "2"], "+", "\[ImaginaryI]"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "4"}], ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                   DefaultBaseStyle -> "Column", 
                   GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                  "Column"], "SummaryItem"]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   SparseArray[
   Automatic, {2, 2, 2, 2}, 0, {
    1, {{0, 8, 16}, {{1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {2, 1, 1}, {
      2, 2, 2}, {2, 1, 2}, {2, 2, 1}, {2, 1, 1}, {2, 1, 2}, {2, 2, 1}, {2, 2, 
      2}, {1, 1, 1}, {1, 2, 2}, {1, 2, 1}, {1, 1, 2}}}, {
     Rational[-3, 2], Complex[Rational[1, 2], 1], Complex[
      Rational[1, 2], 1], -4, Complex[Rational[1, 2], -1], Complex[
      Rational[-1, 2], -1], Rational[9, 2], Rational[1, 2], -4, Complex[
      Rational[-1, 2], 1], Complex[Rational[-1, 2], 1], Rational[-9, 2], 
      Complex[Rational[1, 2], -1], Complex[Rational[-1, 2], -1], Rational[
      3, 2], Rational[1, 2]}}],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], "]"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->966871551,ExpressionUUID->"e414e845-75cd-44c9-a80e-bfe7d80d6063"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{
    RowBox[{"gen", "[", "\[Rho]", "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->405914056,ExpressionUUID->"f10035ae-57a8-43cd-a88f-ef30cbdfac1a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[1, 1]]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[1, 2]]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[2, 1]]}], "+", 
         RowBox[{"9", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[2, 2]]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[1, 1]]}], "-", 
         RowBox[{"8", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[1, 2]]}], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"r"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`r[2, 1]], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[2, 2]]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[1, 1]]}], "+", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"r"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`r[1, 2]], "-", 
         RowBox[{"8", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[2, 1]]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[2, 2]]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[1, 1]]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[1, 2]]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[2, 1]]}], "-", 
         RowBox[{"9", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"2", "\",\"", "2"},
             "RowDefault"]],
           $CellContext`r[2, 2]]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1541136071,ExpressionUUID->"5e03714e-ed6c-4db9-9426-d3b8ae73696f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tsr", "=", 
  RowBox[{"ChoiMatrix", "[", "gen", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1103368825,ExpressionUUID->"a4a1e9ec-4c06-402e-92ff-8a8196db9c8b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["16", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["16", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1.`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", 
                    FractionBox["3", "2"]}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    FractionBox["1", "2"], "+", "\[ImaginaryI]"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    FractionBox["1", "2"], "+", "\[ImaginaryI]"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "4"}], ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {2, 2, 2, 2}, 0, {
   1, {{0, 8, 16}, {{1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {2, 1, 1}, {2,
      2, 2}, {2, 1, 2}, {2, 2, 1}, {2, 1, 1}, {2, 1, 2}, {2, 2, 1}, {2, 2, 
     2}, {1, 1, 1}, {1, 2, 2}, {1, 2, 1}, {1, 1, 2}}}, {
    Rational[-3, 2], Complex[Rational[1, 2], 1], Complex[
     Rational[1, 2], 1], -4, Complex[Rational[1, 2], -1], Complex[
     Rational[-1, 2], -1], Rational[9, 2], Rational[1, 2], -4, Complex[
     Rational[-1, 2], 1], Complex[Rational[-1, 2], 1], Rational[-9, 2], 
     Complex[Rational[1, 2], -1], Complex[Rational[-1, 2], -1], Rational[
     3, 2], Rational[1, 2]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->664977038,ExpressionUUID->"da32fd92-62fb-4a60-84a0-c546d399b354"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", "\[Rho]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"more", "//", "Simplify"}], "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1603363407,ExpressionUUID->"8ea6683c-a6a6-4b7a-a105-da3e0f1289d5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"3", " ", 
          InterpretationBox[
           SubscriptBox[
            TemplateBox[{"r"},
             "RowDefault"], 
            TemplateBox[{"1", "\",\"", "1"},
             "RowDefault"]],
           $CellContext`r[1, 1]]}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "-", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}], "+", 
       FractionBox[
        RowBox[{"9", " ", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"r"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`r[2, 2]]}], "2"]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "-", 
       RowBox[{"4", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "+", 
       FractionBox[
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]], "2"], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "-", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[1, 1]]}], "+", 
       FractionBox[
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]], "2"], "-", 
       RowBox[{"4", " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "-", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[2, 2]]}]}], 
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"r"},
            "RowDefault"], 
           TemplateBox[{"1", "\",\"", "1"},
            "RowDefault"]],
          $CellContext`r[1, 1]]}], "2"], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"1", "\",\"", "2"},
           "RowDefault"]],
         $CellContext`r[1, 2]]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "-", "\[ImaginaryI]"}], ")"}], " ", 
        InterpretationBox[
         SubscriptBox[
          TemplateBox[{"r"},
           "RowDefault"], 
          TemplateBox[{"2", "\",\"", "1"},
           "RowDefault"]],
         $CellContext`r[2, 1]]}], "-", 
       FractionBox[
        RowBox[{"9", " ", 
         InterpretationBox[
          SubscriptBox[
           TemplateBox[{"r"},
            "RowDefault"], 
           TemplateBox[{"2", "\",\"", "2"},
            "RowDefault"]],
          $CellContext`r[2, 2]]}], "2"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 4}, {{1}, {2}, {1}, {2}}}, {
      Rational[-3, 2] $CellContext`r[1, 1] + 
       Complex[Rational[1, 2], 1] $CellContext`r[1, 2] + 
       Complex[Rational[1, 2], -1] $CellContext`r[2, 1] + 
       Rational[9, 2] $CellContext`r[2, 2], 
       Complex[Rational[1, 2], 1] $CellContext`r[1, 1] - 
       4 $CellContext`r[1, 2] + Rational[1, 2] $CellContext`r[2, 1] + 
       Complex[Rational[-1, 2], -1] $CellContext`r[2, 2], 
       Complex[Rational[1, 2], -1] $CellContext`r[1, 1] + 
       Rational[1, 2] $CellContext`r[1, 2] - 4 $CellContext`r[2, 1] + 
       Complex[Rational[-1, 2], 1] $CellContext`r[2, 2], 
       Rational[3, 2] $CellContext`r[1, 1] + 
       Complex[Rational[-1, 2], -1] $CellContext`r[1, 2] + 
       Complex[Rational[-1, 2], 1] $CellContext`r[2, 1] + 
       Rational[-9, 2] $CellContext`r[2, 2]}}]]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1194115195,ExpressionUUID->"78bae174-bd34-4a7f-9446-8b78868d6983"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "more"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->314544571,ExpressionUUID->"bb16e7f1-6255-458f-abab-c978ee44e93c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->723766283,ExpressionUUID->"7284ee79-dda2-496e-8d00-c0c11671788f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "f83d0807-d06e-4e6e-86e5-0fdd3ba101f1"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1617369706,ExpressionUUID->"4a74e0d8-5f6a-49f3-9c2a-cff4a656874a"],

Cell["Now, we consider a three-level system.", "ExampleText",
 CellID->1582702043,ExpressionUUID->"0c76d669-33f9-4ecf-9532-54530eef1911"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kbs", "=", 
   RowBox[{"LieBasis", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "/@", "kbs"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1432904656,ExpressionUUID->"fb30d4f5-a49e-4121-b1b8-fe73e751b93c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["3"]], "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["3"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 3}, {{1}, {2}, {3}}}, {
        3^Rational[-1, 2], 3^Rational[-1, 2], 3^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{2}, {1}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}], "0"},
       {
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0", "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{2}, {1}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["2"]]}], "0"},
       {"0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 2}, {{1}, {2}}}, {
        2^Rational[-1, 2], -2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", "0", "0"},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 1, 2}, {{3}, {1}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}]},
       {"0", "0", "0"},
       {
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 1, 2}, {{3}, {1}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 0, 1, 2}, {{3}, {2}}}, {
        2^Rational[-1, 2], 2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}]},
       {"0", 
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 0, 1, 2}, {{3}, {2}}}, {
        Complex[0, -1] 2^Rational[-1, 2], Complex[0, 1] 
         2^Rational[-1, 2]}}]]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["6"]], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["6"]], "0"},
       {"0", "0", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox["2", "3"]]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {3, 3}, 0, {
       1, {{0, 1, 2, 3}, {{1}, {2}, {3}}}, {
        6^Rational[-1, 2], 6^Rational[-1, 2], -
         Rational[2, 3]^Rational[1, 2]}}]]]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->287616460,ExpressionUUID->"bc7f4e46-69cc-4bf3-94a4-0e929d3115c0"]
}, Open  ]],

Cell["\<\
Let us examine a quantum operation, i.e., a completely positive supermap.\
\>", "ExampleText",
 CellID->150934821,ExpressionUUID->"b77266be-259e-48fa-a8ea-7cf1824caaa8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"opH", "=", 
   RowBox[{"RandomHermitian", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"opH", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opL", "=", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{
       RowBox[{"$n", "^", "2"}], "-", "1"}]}], "]"}], "*", 
    RowBox[{"Rest", "[", "kbs", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gen", "=", 
   RowBox[{"LindbladSupermap", "[", 
    RowBox[{"opH", ",", "opL"}], "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->583349440,ExpressionUUID->"f00899d0-10d3-4077-bad6-50fafa30bf2c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.35729205999466807`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2554342391188238`"}], "-", 
       RowBox[{"0.13855151045043623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5241520672111932`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.8201149933621064`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.2554342391188238`"}], "+", 
       RowBox[{"0.13855151045043623`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.08903928853379561`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.461167317368107`"}], "-", 
       RowBox[{"0.24734539751992535`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.5241520672111932`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.8201149933621064`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.461167317368107`"}], "+", 
       RowBox[{"0.24734539751992535`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6090819745287481`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->142745465,ExpressionUUID->"3b9650d1-16be-4435-8d4d-d5435f7c8d12"]
}, Open  ]],

Cell["This is the corresponding Choi matrix.", "ExampleText",
 CellID->1091189525,ExpressionUUID->"03c87a77-8045-4bf4-bd3d-932f8354a429"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tsr", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ChoiMatrix", "[", "gen", "]"}], "//", "Chop"}], "//", 
   "SparseArray"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->112001295,ExpressionUUID->"f37791b4-9a34-416a-9526-0a88bdff0cad"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["57", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[
             SparseArray[
              Automatic, {10, 10}, 0.93, {
               1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                 10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 0., 
                0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 0}, {10, 
              10}}, {0, 1}], Frame -> False, Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameLabel -> {None, None}, 
             FrameTicks -> {{None, None}, {None, None}}, AxesStyle -> Large, 
             FrameStyle -> Large, ImageSize -> Large, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["57", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"3", ",", "3", ",", "3", ",", "3"}], "}"}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.7037037037037037`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "0.5534085489383083`"}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.13855151045043623`"}], "-", 
                    RowBox[{"0.2554342391188238`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "3"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.8201149933621064`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.5241520672111932`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], 
                    "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.13855151045043623`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.2554342391188238`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {3, 3, 3, 3}, 0, {
   1, {{0, 19, 38, 57}, {{1, 1, 1}, {1, 1, 2}, {1, 1, 3}, {1, 2, 1}, {1, 2, 
     2}, {1, 2, 3}, {1, 3, 1}, {1, 3, 2}, {1, 3, 3}, {2, 1, 1}, {2, 1, 2}, {2,
      2, 1}, {2, 2, 2}, {2, 3, 3}, {3, 1, 1}, {3, 1, 3}, {3, 2, 2}, {3, 3, 
     1}, {3, 3, 3}, {1, 1, 1}, {1, 1, 2}, {1, 2, 1}, {1, 2, 2}, {1, 3, 3}, {2,
      1, 1}, {2, 1, 2}, {2, 1, 3}, {2, 2, 1}, {2, 2, 2}, {2, 2, 3}, {2, 3, 
     1}, {2, 3, 2}, {2, 3, 3}, {3, 1, 1}, {3, 2, 2}, {3, 2, 3}, {3, 3, 2}, {3,
      3, 3}, {1, 1, 1}, {1, 1, 3}, {1, 2, 2}, {1, 3, 1}, {1, 3, 3}, {2, 1, 
     1}, {2, 2, 2}, {2, 2, 3}, {2, 3, 2}, {2, 3, 3}, {3, 1, 1}, {3, 1, 2}, {3,
      1, 3}, {3, 2, 1}, {3, 2, 2}, {3, 2, 3}, {3, 3, 1}, {3, 3, 2}, {3, 3, 
     3}}}, {-0.5534085489383083, 
     Complex[-0.13855151045043623`, -0.2554342391188238], Complex[
     0.8201149933621064, 0.5241520672111932], Complex[
     0.13855151045043623`, -0.2554342391188238], 
     Complex[-1.112155870744646, -0.4463313485284637], 
     Complex[-0.24734539751992535`, -0.461167317368107], 
     Complex[-0.8201149933621064, 0.5241520672111932], Complex[
     0.24734539751992535`, -0.461167317368107], 
     Complex[-1.0059373420579576`, -0.9663740345234162], 
     Complex[-0.13855151045043623`, 0.2554342391188238], 
     0.35072283990826575`, -0.2313059800896236, 
     Complex[-0.13855151045043623`, 0.2554342391188238], 
     Complex[-0.13855151045043623`, 0.2554342391188238], Complex[
     0.8201149933621064, -0.5241520672111932], 0.20268570903004246`, Complex[
     0.8201149933621064, -0.5241520672111932], -0.0046979886683505, Complex[
     0.8201149933621064, -0.5241520672111932], Complex[
     0.13855151045043623`, 0.2554342391188238], -0.2313059800896236, 
     0.35072283990826575`, Complex[0.13855151045043623`, 0.2554342391188238], 
     Complex[0.13855151045043623`, 0.2554342391188238], 
     Complex[-1.112155870744646, 0.4463313485284637], 
     Complex[-0.13855151045043623`, -0.2554342391188238], Complex[
     0.8201149933621064, 0.5241520672111932], Complex[
     0.13855151045043623`, -0.2554342391188238], -0.7990045218948556, 
     Complex[-0.24734539751992535`, -0.461167317368107], 
     Complex[-0.8201149933621064, 0.5241520672111932], Complex[
     0.24734539751992535`, -0.461167317368107], 
     Complex[-1.1287353285362312`, -0.5200426859949525], 
     Complex[-0.24734539751992535`, 0.461167317368107], 
     Complex[-0.24734539751992535`, 0.461167317368107], 0.4482816819865901, 
     0.4470176067864931, Complex[-0.24734539751992535`, 0.461167317368107], 
     Complex[-0.8201149933621064, -0.5241520672111932], -0.0046979886683505, 
     Complex[-0.8201149933621064, -0.5241520672111932], 0.20268570903004246`, 
     Complex[-0.8201149933621064, -0.5241520672111932], Complex[
     0.24734539751992535`, 0.461167317368107], Complex[
     0.24734539751992535`, 0.461167317368107], 0.4470176067864931, 
     0.4482816819865901, Complex[0.24734539751992535`, 0.461167317368107], 
     Complex[-1.0059373420579576`, 0.9663740345234162], 
     Complex[-0.13855151045043623`, -0.2554342391188238], Complex[
     0.8201149933621064, 0.5241520672111932], Complex[
     0.13855151045043623`, -0.2554342391188238], 
     Complex[-1.1287353285362312`, 0.5200426859949525], 
     Complex[-0.24734539751992535`, -0.461167317368107], 
     Complex[-0.8201149933621064, 0.5241520672111932], Complex[
     0.24734539751992535`, -0.461167317368107], -0.6509673910166325}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1360203853,ExpressionUUID->"62645087-c728-410c-a449-9a1280833947"]
}, Open  ]],

Cell["\<\
Take an arbitrary operator \[Rho] (not necessarily a density operator).\
\>", "ExampleText",
 CellID->861298979,ExpressionUUID->"4a0b4167-d053-4eb9-b4f9-093c6d8f811d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Rho]", "=", 
   RowBox[{"RandomMatrix", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->2016058601,ExpressionUUID->"20b65eb3-4cdb-445b-a0ba-4d5f431331ee"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.15202874757268203`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6084939898437796`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1959551231988068`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.9022736994892182`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.88657235412292`"}], "-", 
       RowBox[{"0.6115311915488437`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.1549016402709582`"}], "-", 
       RowBox[{"0.9761926841120672`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7354520126356161`"}], "+", 
       RowBox[{"0.5259912451557396`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.4793705877376455`"}], "+", 
       RowBox[{"0.2413284874645063`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.8969249152191598`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.937136282658515`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.15483908528002743`"}], "+", 
       RowBox[{"0.5617227076937845`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2237085982310658`"}], "-", 
       RowBox[{"0.4936541054167489`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1136638058,ExpressionUUID->"ab219fa7-364c-422a-9d61-3285663474f2"]
}, Open  ]],

Cell["\<\
This is the new linear operator obtained by operating the Supermap on \[Rho]. \
\>", "ExampleText",
 CellID->306115466,ExpressionUUID->"13f010bb-1947-42fd-b525-2f0429e66bea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"gen", "[", "\[Rho]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1659302497,ExpressionUUID->"cb5db191-72e3-4a4b-8b68-ea4f84835032"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.9069477950123263`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9994946719644346`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.4693595530320238`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.021561267636811543`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11984470402468733`"}], "+", 
       RowBox[{"0.737496297823242`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.5091163592227205`"}], "+", 
       RowBox[{"1.1744536539014243`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07564186244261044`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.3977411871265488`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.613098204935948`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.1244097778024627`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.9573536019399508`"}], "-", 
       RowBox[{"1.5250628171689014`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.25256913675655457`"}], "-", 
       RowBox[{"1.53241802671845`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.9825896574549369`"}], "+", 
       RowBox[{"1.3972358590909837`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->139214508,ExpressionUUID->"f525c85d-1a94-4ccd-adbd-e3b0194a5506"]
}, Open  ]],

Cell["The same can be achieved by using the Choi matrix as well.", \
"ExampleText",
 CellID->678202693,ExpressionUUID->"5c97a6d0-d038-47e5-9d50-fb87efc062d5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"more", "=", 
   RowBox[{"TensorContract", "[", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"tsr", ",", "\[Rho]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"more", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1856946622,ExpressionUUID->"8a809fcf-4619-4ba6-bea1-912f522f9a52"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.9069477950123264`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9994946719644345`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.4693595530320238`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.021561267636811543`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11984470402468737`"}], "+", 
       RowBox[{"0.7374962978232418`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.5091163592227206`"}], "+", 
       RowBox[{"1.1744536539014245`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.07564186244261045`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.39774118712654877`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6130982049359477`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.1244097778024624`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.9573536019399507`"}], "-", 
       RowBox[{"1.5250628171689011`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.25256913675655446`"}], "-", 
       RowBox[{"1.53241802671845`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.9825896574549369`"}], "+", 
       RowBox[{"1.3972358590909832`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0., {
     1, {{0, 3, 6, 9}, {{1}, {2}, {3}, {3}, {1}, {2}, {1}, {3}, {2}}}, {
      Complex[0.9069477950123264, -0.9994946719644345], Complex[
      0.4693595530320238, 0.021561267636811543`], 
      Complex[-0.11984470402468737`, 0.7374962978232418], Complex[
      1.6130982049359477`, 1.1244097778024624`], Complex[-0.5091163592227206, 
      1.1744536539014245`], Complex[
      0.07564186244261045, -0.39774118712654877`], 
      Complex[-0.9573536019399507, -1.5250628171689011`], 
      Complex[-0.9825896574549369, 1.3972358590909832`], 
      Complex[-0.25256913675655446`, -1.53241802671845]}}]]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->471585551,ExpressionUUID->"f4a83897-3b2e-4e9d-93f7-da89fd55594b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"new", "-", "more"}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->768378681,ExpressionUUID->"428fbb0e-4ba5-4a9e-a804-6b88981f4b51"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1701506713,ExpressionUUID->"a4cedf95-0d67-4699-8e06-eb8c10cef35c"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Supermap"]], "paclet:QuantumMob/Q3/ref/Supermap", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "cc3e5bd3-1dbe-4ed0-8151-c943ca26b016"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["LindbladSupermap"]], 
           "paclet:QuantumMob/Q3/ref/LindbladSupermap", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "d331872a-d25d-4d90-a5a5-e17b95031d7b"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["LieBasis"]], "paclet:QuantumMob/Q3/ref/LieBasis", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "8f6538cb-3a1d-46db-929a-5dd07964bbe1"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["LieBasisMatrix"]], 
           "paclet:QuantumMob/Q3/ref/LieBasisMatrix", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "b49a1f7f-12a7-4d91-ae0b-9118e9889978"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChoiMultiply"]], 
           "paclet:QuantumMob/Q3/ref/ChoiMultiply", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "9fcd1e08-5a6e-46a1-a08e-a72cf70ab4c5"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChoiTopple"]], "paclet:QuantumMob/Q3/ref/ChoiTopple", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "9500faa3-8a59-4e13-a813-47c225e98796"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ToSuperMatrix"]], 
           "paclet:QuantumMob/Q3/ref/ToSuperMatrix", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "364205f8-5b32-40b7-9a85-860e370fcc2f"]
       }], "SeeAlso",ExpressionUUID->"ba4be91f-03d1-47d9-b591-f30ecb5801a6"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"ddbb158e-b24e-4b9a-b609-\
f8f26274febe"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TutorialsSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Choi Isomorphism"]], 
           "paclet:QuantumMob/Q3/tutorial/ChoiIsomorphism"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "d5c11e0b-0b1e-4408-9200-ce71373b3ba0"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Noise and Decoherence"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumNoiseAndDecoherence"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "40c2aa22-a188-4ad0-a27d-5105c46b5c09"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "d829ad1e-4b12-416c-9f9a-f778c6879599"]}]}
     }]}
  }]], "TutorialsSection",ExpressionUUID->"c12ec9bb-b5c0-4523-9d96-\
96b45fe3e494"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Dynamical Process of Decoherence"]], 
           "paclet:QuantumMob/Q3/guide/DynamicalProcessOfDecoherence"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "f1d450cf-4397-4d12-87a6-50c4166d11e2"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "145a927a-730a-4c71-87f7-539e5068387c"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"75449e32-b9e9-4688-b65c-\
e716324996d1"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "E. St\[OSlash]rmer (2013)"}]]]], 
             "https://doi.org/10.1007/978-3-642-34369-8"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "2f81e1c9-14ad-48c9-b599-244cadaa6d9d"]}]],ExpressionUUID->
         "4d9911f1-0b58-44dd-a549-a98c733b2770"],
        ", Positive Linear Maps of Operator Algebras (Springer, 2013)."
       }], "RelatedLinks",ExpressionUUID->
        "e79bda15-1d89-4935-8710-03f50f31eef6"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "beaf489e-073a-48f6-b8a8-a5dd230a721c"]}]],ExpressionUUID->
         "fc2fcb80-2683-4d83-8994-33484f780dd3"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "66c07ac6-7d6f-48bb-917a-2276264ae952"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"b097efe6-e3a7-4980-8fc0-\
9bf82a154f14"],

Cell[" ", "FooterCell",ExpressionUUID->"039ce46b-4c9c-41b8-b621-fe3e6617eb31"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"ChoiMatrix",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed}, "AllOptsTable" -> 
    Closed, "NotesSection" -> Closed}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 3, 8, 15, 24, 7.941139}", 
    "history" -> {"12", "13.2", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {
     "open quantum systems", "quantum operations", "Choi isomorphism"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3", "status" -> "None", "summary" -> 
    "ChoiMatrix[spec] returns the Choi matrix of Supermap[spec]. \
ChoiMatrix[Supermap[spec]] is equivalent to ChoiMatrix[spec]. \
ChoiMatrix[LindbladSupermap[{a, b1, b2, ...}]] returns the Choi matrix of the \
Lindblad generator, a superoperator generating the Markovian quantum \
operation associated with the effective Hamiltonian a and the Lindblad \
operators b1, b2, ....", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "ChoiMatrix", "titlemodifier" -> "", "metadescription" -> "", 
    "windowtitle" -> "ChoiMatrix", "type" -> "Symbol", "uri" -> 
    "QuantumMob/Q3/ref/ChoiMatrix"}},
CellContext->"Global`",
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.2 for Mac OS X ARM (64-bit) (December 26, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"7d4fbe49-00ab-4d00-8349-2822cb374f6b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[27535, 792, 1441, 38, 34, "PrimaryExamplesSection",ExpressionUUID->"b1936547-362f-46ca-a923-6e255aa23d9b",
   CellTags->"PrimaryExamplesSection",
   CellID->2024120864]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 235538, 6189}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[578, 21, 7553, 179, 50, "AnchorBarGrid",ExpressionUUID->"5554f763-4671-4d69-85bd-ec088fbdf0b1",
 CellID->1],
Cell[8134, 202, 96, 0, 22, "ContextNameCell",ExpressionUUID->"9f5e0f3d-52c6-4336-827a-a26d3040144e"],
Cell[CellGroupData[{
Cell[8255, 206, 553, 14, 57, "ObjectNameGrid",ExpressionUUID->"920c8e8d-27d7-4c8a-9aa4-6a1ba110394d"],
Cell[8811, 222, 4098, 112, 273, "Usage",ExpressionUUID->"36d294c7-65ad-4677-b95e-6ff5e6e47ce3",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[12946, 339, 1916, 48, 34, "NotesSection",ExpressionUUID->"a4f466bb-6eb0-4e7f-8744-1123ad833b6f",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->717055683],
Cell[14865, 389, 3968, 130, 70, "Notes",ExpressionUUID->"7f39b5f8-ba5b-41ef-8f7b-489ce2fb4172",
 CellID->277061214],
Cell[18836, 521, 545, 13, 70, "Notes",ExpressionUUID->"f9730bf9-a3df-4498-9028-b1614e86f36a",
 CellID->1067943069],
Cell[19384, 536, 3006, 93, 70, "Notes",ExpressionUUID->"9823195d-f928-484d-a525-8ac8f7ffc1b7",
 CellID->2071262949],
Cell[22393, 631, 172, 3, 70, "Notes",ExpressionUUID->"2e41b3c6-f1a7-4e08-aa9a-d1215db33db7",
 CellID->1804368584],
Cell[22568, 636, 3327, 108, 70, "Notes",ExpressionUUID->"dfc75c5b-33d5-4717-8511-899675075cf9",
 CellID->544097144],
Cell[25898, 746, 1510, 40, 70, "Notes",ExpressionUUID->"9c07e505-f73c-4c6f-9dc9-280cd09c40f1",
 CellID->688867986]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[27535, 792, 1441, 38, 34, "PrimaryExamplesSection",ExpressionUUID->"b1936547-362f-46ca-a923-6e255aa23d9b",
 CellTags->"PrimaryExamplesSection",
 CellID->2024120864],
Cell[28979, 832, 203, 3, 29, "Input",ExpressionUUID->"96f898a5-69d3-4439-add0-1d637339334e",
 CellID->1927565408],
Cell[CellGroupData[{
Cell[29207, 839, 1419, 37, 29, "ExampleSection",ExpressionUUID->"e817ac22-5e8a-4ff5-a170-bb332ecf1e11",
 CellID->1110909121],
Cell[30629, 878, 160, 2, 37, "ExampleText",ExpressionUUID->"417dba69-19da-41b4-b8da-76b0a1b88559",
 CellID->553412081],
Cell[CellGroupData[{
Cell[30814, 884, 476, 12, 63, "Input",ExpressionUUID->"3b51679c-47b2-4bfb-a35c-593143aa14b9",
 CellID->445170210],
Cell[31293, 898, 1393, 45, 63, "Output",ExpressionUUID->"66e30877-128b-44e2-9cf3-8985328b2497",
 CellID->1409239597]
}, Open  ]],
Cell[32701, 946, 117, 1, 37, "ExampleText",ExpressionUUID->"fdb5238a-8879-4135-958a-a3b2d809b54c",
 CellID->925413985],
Cell[CellGroupData[{
Cell[32843, 951, 497, 13, 45, "Input",ExpressionUUID->"c74aad6b-5e81-43db-b73e-b73c998338e7",
 CellID->1356274321],
Cell[33343, 966, 9969, 205, 60, "Output",ExpressionUUID->"e0107459-e1f5-4592-8e44-d9ce74c726bd",
 CellID->1853783995]
}, Open  ]],
Cell[CellGroupData[{
Cell[43349, 1176, 336, 8, 45, "Input",ExpressionUUID->"2db42770-9c28-4ba9-a1c3-450e290de986",
 CellID->1022965681],
Cell[43688, 1186, 4723, 147, 76, "Output",ExpressionUUID->"a7af81b9-2799-47b3-8de0-d141caaa3748",
 CellID->1934230348]
}, Open  ]],
Cell[48426, 1336, 158, 2, 70, "ExampleText",ExpressionUUID->"b39d97e9-9d8c-4276-9787-245754dad782",
 CellID->1016862214],
Cell[CellGroupData[{
Cell[48609, 1342, 226, 5, 70, "Input",ExpressionUUID->"36040567-df7c-4f73-a47a-1c3c3e94aaab",
 CellID->643632301],
Cell[48838, 1349, 9754, 203, 70, "Output",ExpressionUUID->"74de5ce7-4485-463c-9500-1f542899fac8",
 CellID->1734096540]
}, Open  ]],
Cell[58607, 1555, 172, 3, 70, "ExampleText",ExpressionUUID->"06f4021f-e524-41d2-a79d-d8fc6bc64a19",
 CellID->1355606217],
Cell[CellGroupData[{
Cell[58804, 1562, 618, 17, 70, "Input",ExpressionUUID->"6f19d307-9ce8-4fb9-a066-916bbb9c781f",
 CellID->1592314655],
Cell[59425, 1581, 5406, 160, 76, "Output",ExpressionUUID->"391ca872-e58f-4ffc-b27b-0d03210fc664",
 CellID->2073499931]
}, Open  ]],
Cell[CellGroupData[{
Cell[64868, 1746, 266, 7, 70, "Input",ExpressionUUID->"85420f71-f0fc-4581-bd58-8aecf4b2ecc5",
 CellID->1640340825],
Cell[65137, 1755, 593, 17, 59, "Output",ExpressionUUID->"179f0b5d-b3c6-4206-86d3-572d20d4ff3a",
 CellID->1407484755]
}, Open  ]],
Cell[CellGroupData[{
Cell[65767, 1777, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"7d7269b3-1bb0-4623-a008-03729500d7ef",
 CellID->1958003159],
Cell[66013, 1784, 196, 4, 70, "ExampleText",ExpressionUUID->"d3af9b02-b453-423a-8396-0217ec6a98a8",
 CellID->2112320759],
Cell[66212, 1790, 220, 5, 70, "Input",ExpressionUUID->"f3575c0f-948f-49e7-b63c-5460a0b1af10",
 CellID->1529421203],
Cell[66435, 1797, 154, 1, 70, "ExampleText",ExpressionUUID->"1516b434-635c-4acd-87f9-e722b9812895",
 CellID->910124769],
Cell[CellGroupData[{
Cell[66614, 1802, 436, 11, 70, "Input",ExpressionUUID->"2465cb0b-7eef-4bd2-bdf3-685d6f02b32b",
 CellID->1171754921],
Cell[67053, 1815, 1571, 59, 36, "Output",ExpressionUUID->"f4d4ad36-9e3d-4ea6-9bab-18ce44aeca95",
 CellID->64790341]
}, Open  ]],
Cell[68639, 1877, 169, 3, 70, "ExampleText",ExpressionUUID->"7d0e01b7-8852-4e6d-bc00-7912497724ad",
 CellID->659929661],
Cell[CellGroupData[{
Cell[68833, 1884, 476, 13, 70, "Input",ExpressionUUID->"f0d79fb9-6ab0-43ec-964b-cee142399705",
 CellID->2146884351],
Cell[69312, 1899, 5131, 110, 70, "Output",ExpressionUUID->"9cd22ac7-1d8c-496a-8dc7-f5609211c706",
 CellID->1862438804]
}, Open  ]],
Cell[74458, 2012, 202, 5, 70, "ExampleText",ExpressionUUID->"7736e5ea-f680-4eab-b479-af1e90cc845e",
 CellID->1760269154],
Cell[CellGroupData[{
Cell[74685, 2021, 253, 6, 70, "Input",ExpressionUUID->"ad255bc3-8cda-4622-a2fc-9692a2f29ff3",
 CellID->1142711461],
Cell[74941, 2029, 2317, 86, 48, "Output",ExpressionUUID->"e812b593-0cd2-45cf-9f81-87040bc6688a",
 CellID->1934352376]
}, Open  ]],
Cell[77273, 2118, 158, 2, 70, "ExampleText",ExpressionUUID->"20a97d4d-305a-4f94-bae0-2075d421d790",
 CellID->1244330407],
Cell[CellGroupData[{
Cell[77456, 2124, 309, 7, 70, "Input",ExpressionUUID->"c7309177-1df3-4390-9947-d24dba12b1f2",
 CellID->1265395963],
Cell[77768, 2133, 192, 4, 36, "Output",ExpressionUUID->"9bc497ec-bd35-4ba3-a9d2-b33c94f9b3b6",
 CellID->1660482032]
}, Open  ]],
Cell[77975, 2140, 171, 3, 70, "ExampleText",ExpressionUUID->"e7dabb25-3d53-42d2-85ec-a855b1296f55",
 CellID->211123045],
Cell[CellGroupData[{
Cell[78171, 2147, 650, 18, 70, "Input",ExpressionUUID->"ba30f153-3add-4975-baa5-4e65851264ec",
 CellID->702032471],
Cell[78824, 2167, 3251, 106, 59, "Output",ExpressionUUID->"2458ceaa-0f61-4a1f-806d-9ff031d6e69d",
 CellID->756947743]
}, Open  ]],
Cell[CellGroupData[{
Cell[82112, 2278, 288, 7, 70, "Input",ExpressionUUID->"5d7e1bca-d0fd-4291-b076-b6594526117c",
 CellID->944938973],
Cell[82403, 2287, 127, 2, 36, "Output",ExpressionUUID->"f39553ef-f679-434b-9612-026763913271",
 CellID->1622060024]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82579, 2295, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"1ee7b784-8d3c-4732-b03d-3d257e867f6b",
 CellID->104323313],
Cell[82824, 2302, 149, 1, 70, "ExampleText",ExpressionUUID->"8aaa76c0-274f-4157-85fc-47da7a1670a6",
 CellID->1003924897],
Cell[CellGroupData[{
Cell[82998, 2307, 376, 9, 70, "Input",ExpressionUUID->"385148a4-3896-4ac1-9778-2b2e24f870b6",
 CellID->2047323406],
Cell[83377, 2318, 7348, 233, 175, "Output",ExpressionUUID->"de9b1377-20f2-48f8-91d2-d82f1643313c",
 CellID->845187401]
}, Open  ]],
Cell[90740, 2554, 173, 3, 70, "ExampleText",ExpressionUUID->"e16689e1-05e8-4c43-813d-c60a1bd18c68",
 CellID->885184976],
Cell[CellGroupData[{
Cell[90938, 2561, 475, 13, 70, "Input",ExpressionUUID->"d1e6d360-b899-4d2a-b7f9-d02f613e9021",
 CellID->2044491245],
Cell[91416, 2576, 10801, 225, 70, "Output",ExpressionUUID->"56ac1ac3-1296-42b5-90d6-f663a17e0f72",
 CellID->86247225]
}, Open  ]],
Cell[102232, 2804, 181, 3, 70, "ExampleText",ExpressionUUID->"53339261-7b65-41a2-84a4-eb16f4fc6b8f",
 CellID->404204944],
Cell[CellGroupData[{
Cell[102438, 2811, 226, 5, 70, "Input",ExpressionUUID->"bf459910-f69d-4fa5-bfdb-729f5ef785a6",
 CellID->315678790],
Cell[102667, 2818, 10588, 223, 70, "Output",ExpressionUUID->"0903cad0-e721-4c2b-9f8f-b4c20b61b891",
 CellID->1875087885]
}, Open  ]],
Cell[113270, 3044, 248, 4, 70, "ExampleText",ExpressionUUID->"44806612-77c1-4ea8-91bf-23daba3909c1",
 CellID->905156507],
Cell[CellGroupData[{
Cell[113543, 3052, 494, 12, 70, "Input",ExpressionUUID->"99522477-1e66-4371-877e-92377de915c4",
 CellID->1963657499],
Cell[114040, 3066, 130, 2, 36, "Output",ExpressionUUID->"77d353b8-6733-4000-8e2f-a3bbe39fef41",
 CellID->1544102239],
Cell[114173, 3070, 822, 25, 170, "Output",ExpressionUUID->"7fdcee7c-1512-4504-bfe3-af0a05fa5409",
 CellID->1533940525]
}, Open  ]],
Cell[115010, 3098, 260, 4, 70, "ExampleText",ExpressionUUID->"f5131dbf-2319-4574-912c-f98493c9a8f6",
 CellID->1014268615],
Cell[CellGroupData[{
Cell[115295, 3106, 315, 7, 70, "Input",ExpressionUUID->"a3219e67-492d-4dc7-b4a2-bc6fe70df1ba",
 CellID->85447438],
Cell[115613, 3115, 1748, 39, 75, "Output",ExpressionUUID->"ccaafb2e-87c4-4aa3-9f5e-e48124a0f559",
 CellID->1563663790]
}, Open  ]],
Cell[117376, 3157, 184, 3, 70, "ExampleText",ExpressionUUID->"b64d644c-0a2f-48a7-a26d-293b3c0b5cf5",
 CellID->543923410],
Cell[CellGroupData[{
Cell[117585, 3164, 309, 7, 70, "Input",ExpressionUUID->"2687ee5f-b00c-443a-82c0-fff5eccac359",
 CellID->717229906],
Cell[117897, 3173, 1757, 39, 75, "Output",ExpressionUUID->"bd8b8ebb-b02e-4940-938c-6236f618b06b",
 CellID->1350554867]
}, Open  ]],
Cell[119669, 3215, 158, 2, 70, "ExampleText",ExpressionUUID->"05f14f28-1e4a-4ce9-936c-01e54dc9d650",
 CellID->688108930],
Cell[CellGroupData[{
Cell[119852, 3221, 581, 16, 70, "Input",ExpressionUUID->"e47b910d-81aa-4222-b269-0fcfa161898e",
 CellID->30075672],
Cell[120436, 3239, 2403, 51, 75, "Output",ExpressionUUID->"3ce541ba-d792-4202-8d78-afdd8a74eb87",
 CellID->623842255]
}, Open  ]],
Cell[CellGroupData[{
Cell[122876, 3295, 254, 7, 70, "Input",ExpressionUUID->"d3d1a45c-5099-40b1-860c-cb1ab40f97e7",
 CellID->931479859],
Cell[123133, 3304, 624, 18, 75, "Output",ExpressionUUID->"240bb4f1-2da7-49bf-9937-7488d9a2fc43",
 CellID->566641342]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[123918, 3331, 1434, 37, 70, "ExampleSection",ExpressionUUID->"85bb6475-fccb-4f83-9c4c-95411a492aa7",
 CellID->1020263627],
Cell[125355, 3370, 292, 5, 70, "ExampleText",ExpressionUUID->"a40e061f-1ee7-435c-870f-a7a0d06eb117",
 CellID->828732181],
Cell[CellGroupData[{
Cell[125672, 3379, 469, 12, 70, "Input",ExpressionUUID->"a39acba9-bbaa-4395-94ca-43f8746ad81b",
 CellID->333277970],
Cell[126144, 3393, 1352, 45, 63, "Output",ExpressionUUID->"48e25bcf-49b3-458b-919e-46ff498a2dc4",
 CellID->515710983]
}, Open  ]],
Cell[127511, 3441, 161, 2, 70, "ExampleText",ExpressionUUID->"3404695b-6320-4500-aacc-a92e1bed4212",
 CellID->2006817625],
Cell[CellGroupData[{
Cell[127697, 3447, 368, 9, 70, "Input",ExpressionUUID->"fb5e7e6a-86ec-491b-9472-324d1e059020",
 CellID->2123398300],
Cell[128068, 3458, 9689, 201, 70, "Output",ExpressionUUID->"a79c979d-b3f7-4be5-8a9f-de90e021d22a",
 CellID->676799938]
}, Open  ]],
Cell[CellGroupData[{
Cell[137794, 3664, 306, 7, 70, "Input",ExpressionUUID->"8c8b47da-b0e7-4047-91fa-69f1845e95d4",
 CellID->1152364753],
Cell[138103, 3673, 2700, 87, 63, "Output",ExpressionUUID->"cc36f8bf-adfb-41be-b9d6-a22a5ff07724",
 CellID->616039658]
}, Open  ]],
Cell[CellGroupData[{
Cell[140840, 3765, 227, 5, 70, "Input",ExpressionUUID->"5dd552bd-f75b-40c6-8d5f-6800be8210ab",
 CellID->2118928092],
Cell[141070, 3772, 9476, 199, 70, "Output",ExpressionUUID->"4117c601-7abb-40af-bc25-84a50b71c2d9",
 CellID->72703027]
}, Open  ]],
Cell[CellGroupData[{
Cell[150583, 3976, 583, 16, 70, "Input",ExpressionUUID->"59c1c39a-1d99-4afb-be37-3afde55f74eb",
 CellID->1481207322],
Cell[151169, 3994, 3140, 98, 63, "Output",ExpressionUUID->"9f93a0f5-d5c2-4040-b22c-1c72fe8b2b0c",
 CellID->1825992849]
}, Open  ]],
Cell[CellGroupData[{
Cell[154346, 4097, 258, 7, 70, "Input",ExpressionUUID->"68261d1a-9596-4de3-946d-2e631a7e0f60",
 CellID->408110433],
Cell[154607, 4106, 592, 17, 59, "Output",ExpressionUUID->"49e8c5c5-a3a2-40a8-9925-67607390645b",
 CellID->944807076]
}, Open  ]],
Cell[CellGroupData[{
Cell[155236, 4128, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"56e93586-72bd-47c4-936e-4599be6e46be",
 CellID->1374347092],
Cell[155482, 4135, 152, 1, 70, "ExampleText",ExpressionUUID->"66cb5d47-eeb1-42f7-9199-1b53f9114fa5",
 CellID->2037101859],
Cell[CellGroupData[{
Cell[155659, 4140, 636, 17, 70, "Input",ExpressionUUID->"d990bf39-3910-48e8-8f49-3b28c45b2197",
 CellID->239160092],
Cell[156298, 4159, 10203, 211, 70, "Output",ExpressionUUID->"e414e845-75cd-44c9-a80e-bfe7d80d6063",
 CellID->966871551]
}, Open  ]],
Cell[CellGroupData[{
Cell[166538, 4375, 338, 8, 70, "Input",ExpressionUUID->"f10035ae-57a8-43cd-a88f-ef30cbdfac1a",
 CellID->405914056],
Cell[166879, 4385, 5897, 184, 76, "Output",ExpressionUUID->"5e03714e-ed6c-4db9-9426-d3b8ae73696f",
 CellID->1541136071]
}, Open  ]],
Cell[CellGroupData[{
Cell[172813, 4574, 227, 5, 70, "Input",ExpressionUUID->"a4a1e9ec-4c06-402e-92ff-8a8196db9c8b",
 CellID->1103368825],
Cell[173043, 4581, 9986, 209, 70, "Output",ExpressionUUID->"da32fd92-62fb-4a60-84a0-c546d399b354",
 CellID->664977038]
}, Open  ]],
Cell[CellGroupData[{
Cell[183066, 4795, 614, 17, 70, "Input",ExpressionUUID->"8ea6683c-a6a6-4b7a-a105-da3e0f1289d5",
 CellID->1603363407],
Cell[183683, 4814, 6332, 195, 81, "Output",ExpressionUUID->"78bae174-bd34-4a7f-9446-8b78868d6983",
 CellID->1194115195]
}, Open  ]],
Cell[CellGroupData[{
Cell[190052, 5014, 258, 7, 70, "Input",ExpressionUUID->"bb16e7f1-6255-458f-abab-c978ee44e93c",
 CellID->314544571],
Cell[190313, 5023, 592, 17, 59, "Output",ExpressionUUID->"7284ee79-dda2-496e-8d00-c0c11671788f",
 CellID->723766283]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[190954, 5046, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"4a74e0d8-5f6a-49f3-9c2a-cff4a656874a",
 CellID->1617369706],
Cell[191200, 5053, 137, 1, 70, "ExampleText",ExpressionUUID->"0c76d669-33f9-4ecf-9532-54530eef1911",
 CellID->1582702043],
Cell[CellGroupData[{
Cell[191362, 5058, 376, 9, 70, "Input",ExpressionUUID->"fb30d4f5-a49e-4121-b1b8-fe73e751b93c",
 CellID->1432904656],
Cell[191741, 5069, 7348, 233, 175, "Output",ExpressionUUID->"bc7f4e46-69cc-4bf3-94a4-0e929d3115c0",
 CellID->287616460]
}, Open  ]],
Cell[199104, 5305, 179, 3, 70, "ExampleText",ExpressionUUID->"b77266be-259e-48fa-a8ea-7cf1824caaa8",
 CellID->150934821],
Cell[CellGroupData[{
Cell[199308, 5312, 761, 21, 70, "Input",ExpressionUUID->"f00899d0-10d3-4077-bad6-50fafa30bf2c",
 CellID->583349440],
Cell[200072, 5335, 1705, 42, 75, "Output",ExpressionUUID->"3b9650d1-16be-4435-8d4d-d5435f7c8d12",
 CellID->142745465]
}, Open  ]],
Cell[201792, 5380, 137, 1, 70, "ExampleText",ExpressionUUID->"03c87a77-8045-4bf4-bd3d-932f8354a429",
 CellID->1091189525],
Cell[CellGroupData[{
Cell[201954, 5385, 294, 8, 70, "Input",ExpressionUUID->"f37791b4-9a34-416a-9526-0a88bdff0cad",
 CellID->112001295],
Cell[202251, 5395, 13194, 259, 70, "Output",ExpressionUUID->"62645087-c728-410c-a449-9a1280833947",
 CellID->1360203853]
}, Open  ]],
Cell[215460, 5657, 177, 3, 70, "ExampleText",ExpressionUUID->"4a0b4167-d053-4eb9-b4f9-093c6d8f811d",
 CellID->861298979],
Cell[CellGroupData[{
Cell[215662, 5664, 317, 7, 70, "Input",ExpressionUUID->"20b65eb3-4cdb-445b-a0ba-4d5f431331ee",
 CellID->2016058601],
Cell[215982, 5673, 1749, 42, 75, "Output",ExpressionUUID->"ab219fa7-364c-422a-9d61-3285663474f2",
 CellID->1136638058]
}, Open  ]],
Cell[217746, 5718, 184, 3, 70, "ExampleText",ExpressionUUID->"13f010bb-1947-42fd-b525-2f0429e66bea",
 CellID->306115466],
Cell[CellGroupData[{
Cell[217955, 5725, 306, 7, 70, "Input",ExpressionUUID->"cb5db191-72e3-4a4b-8b68-ea4f84835032",
 CellID->1659302497],
Cell[218264, 5734, 1747, 41, 75, "Output",ExpressionUUID->"f525c85d-1a94-4ccd-adbd-e3b0194a5506",
 CellID->139214508]
}, Open  ]],
Cell[220026, 5778, 158, 2, 70, "ExampleText",ExpressionUUID->"5c97a6d0-d038-47e5-9d50-fb87efc062d5",
 CellID->678202693],
Cell[CellGroupData[{
Cell[220209, 5784, 583, 16, 70, "Input",ExpressionUUID->"8a809fcf-4619-4ba6-bea1-912f522f9a52",
 CellID->1856946622],
Cell[220795, 5802, 2385, 53, 75, "Output",ExpressionUUID->"f4a83897-3b2e-4e9d-93f7-da89fd55594b",
 CellID->471585551]
}, Open  ]],
Cell[CellGroupData[{
Cell[223217, 5860, 254, 7, 70, "Input",ExpressionUUID->"428fbb0e-4ba5-4a9e-a804-6b88981f4b51",
 CellID->768378681],
Cell[223474, 5869, 625, 18, 75, "Output",ExpressionUUID->"a4cedf95-0d67-4699-8e06-eb8c10cef35c",
 CellID->1701506713]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[224353, 5897, 4079, 110, 70, "SeeAlsoSection",ExpressionUUID->"ddbb158e-b24e-4b9a-b609-f8f26274febe"],
Cell[228435, 6009, 1523, 38, 70, "TutorialsSection",ExpressionUUID->"c12ec9bb-b5c0-4523-9d96-96b45fe3e494"],
Cell[229961, 6049, 1152, 28, 70, "MoreAboutSection",ExpressionUUID->"75449e32-b9e9-4688-b65c-e716324996d1"],
Cell[231116, 6079, 2022, 56, 70, "RelatedLinksSection",ExpressionUUID->"b097efe6-e3a7-4980-8fc0-9bf82a154f14"],
Cell[233141, 6137, 78, 0, 70, "FooterCell",ExpressionUUID->"039ce46b-4c9c-41b8-b621-fe3e6617eb31"]
}
]
*)

(* End of internal cache information *)

