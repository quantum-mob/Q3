(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    419685,      11170]
NotebookOptionsPosition[    387526,      10503]
NotebookOutlinePosition[    389979,      10562]
CellTagsIndexPosition[    389891,      10557]
WindowTitle->QFT
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "95ecad4e-241a-480b-b4ce-52c665b79bd6"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "241b65a4-b833-4dd3-afe2-a902b1bf52d8"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "c1ca6a43-ffaf-4505-b06c-e8e1e6e7d518"]
         }],ExpressionUUID->"c1ace307-1ef3-4b75-902a-f066d48870be"],
         StripOnInput->False],{
        "\"Fourier\"" :> Documentation`HelpLookup["paclet:ref/Fourier"], 
         "\"FourierMatrix\"" :> 
         Documentation`HelpLookup["paclet:ref/FourierMatrix"], Delimiter, 
         StyleBox[
          "\"Functions\"", "SeeAlsoSection", FontSize -> 14, FontSlant -> 
           "Italic", StripOnInput -> False] :> 
         NotebookFind[EvaluationNotebook[], "SeeAlsoSection", All, CellStyle],
          StyleBox["\"QBR\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/QBR"], 
         StyleBox["\"QCR\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/QCR"], 
         StyleBox[
          "\"ControlledPower\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/ControlledPower"], 
         StyleBox["\"CNOT\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/CNOT"], 
         StyleBox["\"Hadamard\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/Hadamard"], 
         StyleBox[
          "\"MultiplyPower\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:Q3/ref/MultiplyPower"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "1e1622c0-33c0-4307-ad24-c6a5ae69453e"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "324dc5e3-e605-41ec-9c68-49587c35e255"]
         }],ExpressionUUID->"8437680f-9fda-4ccf-80aa-d760de57b9fd"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/guide/QuantumInformationSystems"], "\"Q3\"" :> 
         Documentation`HelpLookup["paclet:Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "1c3ac915-a907-4bb3-ac10-1dc7ca2dc3ff"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "d7589a1f-899c-4890-bca0-0835fe621edb"]
         }],ExpressionUUID->"ccff9eb0-4518-41d0-afe9-e349b80eedc4"],
         StripOnInput->False],{
        "\"Quantum Fourier Transform\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumFourierTransform"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuantumInformationSystems"], 
         "\"Quick Quantum Computing with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:Q3/tutorial/QuickQuantumComputingWithQ3"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup["paclet:Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "421f4377-6588-4efe-8322-461d02b0745b"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            AxesStyle->Large,
            FrameStyle->Large,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "150078bb-bfb4-44ea-92a3-216c1cb0b1b8"]
         }],ExpressionUUID->"09825561-a698-4570-b610-a9f37c0e4b92"],
         StripOnInput->False],{
        "\"Q3/ref/QFT\"" :> None, "\"Copy Wolfram Documentation Center URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[Notebook[{Cell["Q3/ref/QFT"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/Q3/ref/QFT.html"], 
                   StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> "Q3/ref/QFT" <> 
               ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "5cf03d6a-3a7f-4dd6-92c9-316bef135ea1"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "252cd420-ccac-4d0d-8a78-682d328cef64"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"d26352aa-ef40-4e3f-a801-46e228dec5b9"],

Cell["Q3`", "ContextNameCell",ExpressionUUID->"6b92d76a-bb7d-48ba-955f-d4733e2670cc"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "QFT", "ObjectName",ExpressionUUID->
      "d213a43e-dba4-4920-8f31-fca55c4ccc92"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"34a3ea48-51b2-49a2-b334-e70149c8f1ec"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "b0453e69-e275-4276-b662-4252363b15d3"]
    }],ExpressionUUID->"f1e92ec6-511a-4914-87c8-63631cac0452"], Cell[BoxData[
     StyleBox[
      GraphicsBox[InsetBox[
        StyleBox["\<\"UPDATED IN 14.0\"\>",
         StripOnInput->False,
         FontFamily->"Source Sans Pro",
         FontSize->17,
         FontWeight->"Bold",
         FontSlant->"Italic",
         FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
        Right, Center}],
       AxesStyle->Large,
       FrameStyle->Large,
       ImageSize->{125, 24},
       PlotRangePadding->Scaled[0.025]], "NewInGraphic",
      StripOnInput->False]],
     Deployed->True,
     Magnification->1,ExpressionUUID->
     "e41a63d7-9e34-4d66-b2d7-cc9edbb1aae3"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"c618ceb8-2320-4fb6-9d68-b012685ab909"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QFT"]], "paclet:Q3/ref/QFT", "Q3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          StyleBox["s", "TI"], 
          StyleBox["1", "TR"]], ",", 
         SubscriptBox[
          StyleBox["s", "TI"], 
          StyleBox["2", "TR"]], ",", "\[Ellipsis]"}], "}"}], "]"}]], 
      "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "314bcd32-fc09-4de2-a19e-ca772e763048"],
     "\[LineSeparator]represents the quantum Fourier transform on the qubits ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["2", "TR"]], ",", "\[Ellipsis]"}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "ac676695-160f-48b3-8a8b-5e449ea04bd3"],
     "."
    }],ExpressionUUID->"04aa31ca-30b7-4179-8425-b58d7cd10478"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QFT"]], "paclet:Q3/ref/QFT", "Q3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        StyleBox["type", "TI"], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["s", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["s", "TI"], 
           StyleBox["2", "TR"]], ",", 
          StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
        StyleBox["flag", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "9e3e3f1d-fbfe-400d-9809-2c88a860aad8"],
     "\[LineSeparator]is the full form of ",
     Cell[BoxData[
      TemplateBox[{
        Cell[
         TextData["QFT"]], "paclet:Q3/ref/QFT", "Q3 Package Symbol"},
       "PackageLink",
       BaseStyle->"InlineFormula"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "bc158235-19ff-4121-b63a-2724fd3c865e"],
     ", where ",
     Cell[BoxData[
      RowBox[{
       StyleBox["type", "TI"], "=", 
       RowBox[{"\[PlusMinus]", "1"}]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "4aa44cee-825c-41bc-913c-50274aa4b9ab"],
     " indicates the Fourier or inverse Fourier transform and ",
     Cell[BoxData[
      StyleBox["flag", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "bbfa7a4b-2267-4ba7-a9f2-bcbe08546417"],
     " specifies whether the QFT is evaluated by using exact (",
     Cell[BoxData[
      TemplateBox[{
        Cell[
         TextData["False"]], "paclet:ref/False"},
       "RefLink",
       BaseStyle->{"InlineFormula"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "68edee57-8842-4bdc-905a-121c3fe88333"],
     ") or numerical (",
     Cell[BoxData[
      TemplateBox[{
        Cell[
         TextData["True"]], "paclet:ref/True"},
       "RefLink",
       BaseStyle->{"InlineFormula"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "6d8a7d36-cdba-43ca-956a-393a8833101c"],
     ") values."
    }],ExpressionUUID->"09a4bf43-9448-4fa6-9531-18ea5a3a3be7"]}
  }]], "Usage",
 CellID->1825953146,ExpressionUUID->"b7595cb7-c20a-4366-a99c-02ce604eda2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[
       MatchQ[
        CurrentValue[
         EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, 
         Closed], 
        Alternatives[Open, True]], 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{14., {0.45000000000000107`, 13.549999999999999`}}]],
    ExpressionUUID->"619779d1-12e3-4a4a-b678-1927fe00c94b"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"dd35f3e0-5fba-483b-a628-5bf215f653f0"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"aa36ef13-11d0-4145-ab73-d8ace5aa37d6"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"95b49a78-7f2c-4ba8-a23f-f485ff20866a"]], \
"NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->2099433986,ExpressionUUID->"d2e4198b-5e9e-48f2-a779-e5e6957c8bca"],

Cell[TextData[{
 "For a set of orthonormal states ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], ",", 
      TemplateBox[{"1"},
       "Ket"], ",", 
      TemplateBox[{"2"},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        RowBox[{"N", "-", "1"}]},
       "Ket"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "ec2a771f-9bab-4f71-8a86-a28c43452022"],
 ", the quantum Fourier transform on ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalB]", TraditionalForm]],ExpressionUUID->
  "70c008ac-f9ff-4dd0-a0e7-fd1a25c79c3c"],
 " is given by\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"y"},
     "Ket"], "\[RightTeeArrow]", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["N"]], 
     UnderoverscriptBox["\[CapitalSigma]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{"N", "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"], 
     SuperscriptBox["e", 
      RowBox[{
      "2", "\[VeryThinSpace]", "\[Pi]", "\[VeryThinSpace]", "\[ImaginaryI]", 
       "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
       RowBox[{"y", "\[VeryThinSpace]", "/", "\[VeryThinSpace]", "N"}]}]]}]}],
    TraditionalForm]],ExpressionUUID->
  "ff2dda86-4adc-46bb-88af-7991451c374c"],
 " .\[LineSeparator]Typically, the basis \[ScriptCapitalB] is given by the \
computational basis ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], ",", 
      TemplateBox[{"1"},
       "Ket"], ",", 
      TemplateBox[{"2"},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]},
       "Ket"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "a9279613-6230-4c12-af93-92e2cca19e8b"],
 " for ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "bb4a866a-6c32-4b02-9a5f-bf27d6fcf266"],
 " qubits. However, in may applications ",
 Cell[BoxData[
  FormBox[
   RowBox[{"N", "<", 
    SuperscriptBox["2", "n"]}], TraditionalForm]],ExpressionUUID->
  "4227420c-b7ad-46c8-b67a-21b0557bc89b"],
 ". ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QFT"]], "paclet:Q3/ref/QFT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "a66c7fa9-2159-44e4-9f1f-878c2c998e69"],
 " assumes ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], ",", 
      TemplateBox[{"1"},
       "Ket"], ",", 
      TemplateBox[{"2"},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]},
       "Ket"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "bb10d18b-c25e-47f4-95dc-048f8a23b55a"],
 "."
}], "Notes",
 CellID->59811791,ExpressionUUID->"71a33d32-aa75-43aa-94ab-b4c3f3f9e402"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Elaborate"]], "paclet:Q3/ref/Elaborate", "Q3 Package Symbol"},
    
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QFT"]], "paclet:Q3/ref/QFT", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["\[Ellipsis]", "TR"], "]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2ef56cb0-de96-402d-a698-078f9092e933"],
 " returns the explicit expression of the unitary operator in terms of the \
Pauli operators."
}], "Notes",
 CellID->1585121827,ExpressionUUID->"ab33e735-61eb-45e6-a5eb-9d98663e846e"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Expand"]], "paclet:ref/Expand"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QFT"]], "paclet:Q3/ref/QFT", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", "\[Ellipsis]", "]"}], "]"}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e90f6946-9dae-4cec-a15a-fa9fc894a1a7"],
 " decomposes QFT into a sequence of Hadamard gates and controlled powers of  \
the phase gate ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "k"], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], 
         SuperscriptBox["2", "k"]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "4751dc41-662d-47d8-bc8b-8cdaeaa10568"],
 "."
}], "Notes",
 CellID->1475780666,ExpressionUUID->"0544a0f0-e3f1-47cb-94bb-28e579d2c76d"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["ExpandAll"]], "paclet:ref/ExpandAll"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QFT"]], "paclet:Q3/ref/QFT", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", "\[Ellipsis]", "]"}], "]"}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "8351e814-a451-4114-abd6-8972ffd2a37d"],
 " decomposes QFT into a sequence of Hadamard and phase gates ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "k"], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], 
         SuperscriptBox["2", "k"]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "0f324175-95a1-4821-8a80-403724208d43"],
 "."
}], "Notes",
 CellID->2122196282,ExpressionUUID->"6ccc5191-a7f9-4f5e-915b-c3252c64ddfb"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Dagger"]], "paclet:Q3/ref/Dagger", "Q3 Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QFT"]], "paclet:Q3/ref/QFT", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    RowBox[{
     StyleBox["type", "TI"], ",", "\[Ellipsis]"}], "]"}], "]"}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0fac3bdb-f316-42ad-9d83-6ed854c834aa"],
 " switches ",
 Cell[BoxData[
  StyleBox["type", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f043599a-c652-4902-86f6-a978d1c4b0c3"],
 " from 1 to -1 and vice versa."
}], "Notes",
 CellID->1817891589,ExpressionUUID->"3aa52baf-8205-4a7a-b246-ba2149e09c6c"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["N"]], "paclet:ref/N"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QFT"]], "paclet:Q3/ref/QFT", "Q3 Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    RowBox[{"\[Ellipsis]", ",", " ", 
     StyleBox["flag", "TI"]}], "]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "5c5150b8-8362-4328-8f45-67e7a65e1b1d"],
 " sets ",
 Cell[BoxData[
  RowBox[{
   StyleBox["flat", "TI"], "=", 
   TemplateBox[{
     Cell[
      TextData["True"]], "paclet:ref/True"},
    "RefLink",
    BaseStyle->{"InlineFormula"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "301aab7c-cabf-475a-97af-643dd181090c"],
 "."
}], "Notes",
 CellID->1697654462,ExpressionUUID->"d4e38c37-4215-420f-99d3-64f49ad738ce"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "913817f8-a846-4803-a8d2-fd69688a5bca"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"ff4712cf-85a4-42f7-8aa2-bb34024df7b8"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(13)", "ExampleCount",ExpressionUUID->
  "bdf93089-e58f-467c-8369-de9b02c3cbdc"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->2030682492,ExpressionUUID->"52550999-7584-46a9-afd1-ed5e5c5f4b42"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1420320264,ExpressionUUID->"c8547e70-b57a-4fbb-b127-201722c9b802"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {5., 9.}}]],ExpressionUUID->
  "312a03cc-604a-4df7-bd89-da7e8df77fba"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"17d0c0e0-9002-4737-8048-504a7240fd47"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(5)", "ExampleCount",ExpressionUUID->
  "01df0f3e-ce10-49b3-83af-54d2078da4d3"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1870524920,ExpressionUUID->"4069bdf8-4986-43c3-851f-51eadc706919"],

Cell["Pick a symbol to refer to the quantum register with.", "ExampleText",
 CellID->324198160,ExpressionUUID->"4a9d29c2-2995-4456-98e4-7c083afd8e7a"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1417611086,ExpressionUUID->"ab07a624-d961-408f-83b2-a9504e164be7"],

Cell["\<\
Consider the quantum Fourier transformation on a three-qubit register.\
\>", "ExampleText",
 CellID->1975652896,ExpressionUUID->"76847994-3de9-4b1a-b2dc-bdf797e98412"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1538344178,ExpressionUUID->"c4fabfb5-43df-496f-9df6-eb0963679e60"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1761624115,ExpressionUUID->"6085b7cc-9e5b-48bb-ac0d-29f2f2926913"]
}, Open  ]],

Cell["Set the operator.", "ExampleText",
 CellID->1011065769,ExpressionUUID->"84792339-fcf7-4b68-ab68-6e84c4bb3b30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QFT", "[", "SS", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->907845956,ExpressionUUID->"68ac6481-ce27-4155-a91a-cda53486b8ed"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]]}], "}"}], ",", "False"}], "]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1620497082,ExpressionUUID->"7bba8627-f0a3-4d0a-b8a4-0e4b91123933"]
}, Open  ]],

Cell["Express the operator in terms of the Pauli operators.", "ExampleText",
 CellID->532983359,ExpressionUUID->"514fc95d-a9cc-407e-afbb-b581528f5d59"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{"Elaborate", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1463562962,ExpressionUUID->"ebfd7d2c-5acc-4aab-a75b-0cf40d2c45a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", "8"], "+", 
    FractionBox["\[ImaginaryI]", "8"]}], ")"}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[3, 3]]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 1]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 1]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 1]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[3, 3]]}]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1012147265,ExpressionUUID->"d2ac3f52-6607-4484-9d6e-6ac66626fecf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "//", "PauliForm"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1164635486,ExpressionUUID->"63df80e0-9d28-43f4-b98b-bfd9035d8c08"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "8"], "+", 
      FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>", 
     "\[CircleTimes]", "\<\"I\"\>"}]}],
   Complex[
    Rational[1, 8], 
    Rational[1, 8]]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>", 
     "\[CircleTimes]", "\<\"Z\"\>"}],
    $CellContext`S[3, 3]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>", 
     "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[2, 1]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>", 
     "\[CircleTimes]", "\<\"Z\"\>"}],
    Q3`Multiply[
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Z\"\>", 
     "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[2, 3]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Z\"\>", 
     "\[CircleTimes]", "\<\"Z\"\>"}],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"I\"\>", 
     "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[1, 1]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"I\"\>", 
     "\[CircleTimes]", "\<\"Z\"\>"}],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"X\"\>", 
     "\[CircleTimes]", "\<\"I\"\>"}],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"X\"\>", 
     "\[CircleTimes]", "\<\"Z\"\>"}],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Z\"\>", 
     "\[CircleTimes]", "\<\"I\"\>"}],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Z\"\>", 
     "\[CircleTimes]", "\<\"Z\"\>"}],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"I\"\>", 
      "\[CircleTimes]", "\<\"Y\"\>"}],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"X\"\>", 
      "\[CircleTimes]", "\<\"Y\"\>"}],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Y\"\>", 
      "\[CircleTimes]", "\<\"X\"\>"}],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Z\"\>", 
      "\[CircleTimes]", "\<\"Y\"\>"}],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"I\"\>", 
      "\[CircleTimes]", "\<\"X\"\>"}],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"X\"\>", 
      "\[CircleTimes]", "\<\"X\"\>"}],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Y\"\>", 
      "\[CircleTimes]", "\<\"Y\"\>"}],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Z\"\>", 
      "\[CircleTimes]", "\<\"X\"\>"}],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->490340856,ExpressionUUID->"e957407a-e512-401e-af96-5ecec43d7cd5"]
}, Open  ]],

Cell["Take the Hermitian conjugate of the operator.", "ExampleText",
 CellID->1728281487,ExpressionUUID->"bf2bacb1-c641-480a-9132-c95e7823a3b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dag", "=", 
  RowBox[{"Dagger", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->738769794,ExpressionUUID->"6da7d05e-b283-4db4-8bc5-c0019a29c2c6"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]]}], "}"}], ",", "False"}], "]"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->248351781,ExpressionUUID->"9139c06f-edf0-4395-af7c-faa12f711585"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dag", "**", "op"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->697008013,ExpressionUUID->"90056a9e-0c63-462e-bbe4-b9e89807c16d"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[7]=",
 CellID->579309606,ExpressionUUID->"6ba2787e-d315-491f-b457-fd17308f732a"]
}, Open  ]],

Cell["Calculate the matrix representation of the QFT.", "ExampleText",
 CellID->1338994217,ExpressionUUID->"d60b914a-40b7-4474-81ee-328ea7a6ba36"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[8]:=",
 CellID->1065133665,ExpressionUUID->"72b05790-18f2-4966-bff4-ac2fa18751d5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 8, 16, 24, 32, 40, 48, 56, 64}, {{1}, {2}, {3}, {4}, {5}, {6}, {
       7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {
       5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {
       3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {
       1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {
       7}, {8}}}, {
      Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[1, 4]] Pi), Complex[0, Rational[1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[3, 4]] Pi), Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2] E^(Complex[0, Rational[-3, 4]] Pi), 
       Complex[0, Rational[-1, 2]] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2] E^(Complex[0, Rational[-1, 4]] Pi), Rational[1, 2] 
       2^Rational[-1, 2], Complex[0, Rational[1, 2]] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Complex[0, Rational[-1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Complex[0, Rational[1, 2]] 2^Rational[-1, 2], Rational[-1, 2] 
       2^Rational[-1, 2], Complex[0, Rational[-1, 2]] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[3, 4]] Pi), Complex[0, Rational[-1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[1, 4]] Pi), Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2] E^(Complex[0, Rational[-1, 4]] Pi), 
       Complex[0, Rational[1, 2]] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2] E^(Complex[0, Rational[-3, 4]] Pi), Rational[1, 2] 
       2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[-3, 4]] Pi), Complex[0, Rational[1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[-1, 4]] Pi), Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2] E^(Complex[0, Rational[1, 4]] Pi), 
       Complex[0, Rational[-1, 2]] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2] E^(Complex[0, Rational[3, 4]] Pi), Rational[1, 2] 
       2^Rational[-1, 2], Complex[0, Rational[-1, 2]] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Complex[0, Rational[1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Complex[0, Rational[-1, 2]] 2^Rational[-1, 2], Rational[-1, 2] 
       2^Rational[-1, 2], Complex[0, Rational[1, 2]] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[-1, 4]] Pi), Complex[0, Rational[-1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[-3, 4]] Pi), Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2] E^(Complex[0, Rational[3, 4]] Pi), 
       Complex[0, Rational[1, 2]] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2] E^(Complex[0, Rational[1, 4]] Pi)}}]]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->477651687,ExpressionUUID->"3f0a21f1-80fd-4e24-9106-484eb03e9ae9"]
}, Open  ]],

Cell[TextData[{
 "The above matrix representation is equivalent to the result from the \
built-in function ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["FourierMatrix"]], "paclet:ref/FourierMatrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "14338f90-c568-40b2-a5fc-ac6ccac08038"],
 "."
}], "ExampleText",
 CellID->21662866,ExpressionUUID->"8014522f-bb96-456b-8989-4572d7d15d5b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"alt", "=", 
   RowBox[{"FourierMatrix", "[", "8", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"alt", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[9]:=",
 CellID->1935243801,ExpressionUUID->"4294494d-87b9-49c5-ac25-18c8826ca9f4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->474367223,ExpressionUUID->"e3e44e7b-4acf-4915-b553-1decf6ef7b98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", "-", "alt"}], "//", "MatrixForm"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[10]:=",
 CellID->1610672650,ExpressionUUID->"cfecac25-1b32-4bfe-ad59-4e95e3bf5a0e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[10]//MatrixForm=",
 CellID->1354191826,ExpressionUUID->"0d4d3b9e-7d84-4c43-b709-91b57ee61aed"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "bdd44568-c6d9-4429-a04b-4a088c4cfbfe"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->566965640,ExpressionUUID->"5ffa28af-ede9-4f1e-9a39-955a309c658c"],

Cell["Construct an input state.", "ExampleText",
 CellID->916988046,ExpressionUUID->"c1543c27-cf0e-4dc4-b9c3-51e3923ffb07"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", "SS", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"bs", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "-", 
   RowBox[{"I", "*", 
    RowBox[{"bs", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}]}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->512764678,ExpressionUUID->"2fbd3b36-f16b-48cf-94a4-a6da2692cc52"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["1", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0|>]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->847453479,ExpressionUUID->"c4fe0571-f3af-478e-b933-168cd6c95894"]
}, Open  ]],

Cell["Apply the QFT on the input state.", "ExampleText",
 CellID->801708978,ExpressionUUID->"dc6fd1dd-6d2f-4ded-8598-49f2cbda1d2e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"op", "**", "in"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1459809595,ExpressionUUID->"cf09ad5c-bdda-4df4-8307-4cc2efaba726"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "-", 
      FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SqrtBox["2"]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]]}], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0|>]], 
   SqrtBox["2"]], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "+", 
      FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
       0, $CellContext`S[3, Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->855628123,ExpressionUUID->"557a6781-9e4a-4117-abd5-e3066f576909"]
}, Open  ]],

Cell["\<\
Let us check the result by comparing the vector representation of the output \
state with the result from multiplying the matrix representation of the QFT \
on the vector representation of the input state.\
\>", "ExampleText",
 CellID->358410394,ExpressionUUID->"59362261-11a1-4b57-b76c-4f6c8b9e8b78"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"Matrix", "[", "out", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "Normal"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1154479820,ExpressionUUID->"807d78d0-fc68-4d8c-899f-92d0c92f28bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     FractionBox["1", "2"], "-", 
     FractionBox["\[ImaginaryI]", "2"]}], 
    SqrtBox["2"]], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "-", 
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   FractionBox[
    RowBox[{
     FractionBox["1", "2"], "+", 
     FractionBox["\[ImaginaryI]", "2"]}], 
    SqrtBox["2"]], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", "0", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "-", 
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1566050306,ExpressionUUID->"cfa07b1a-2b5e-40e8-a2c5-59e5cca74732"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vin", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"in", ",", "SS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vin", "//", "Normal"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->618910181,ExpressionUUID->"300fe4b3-7285-411c-8b0f-00f95571f4b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->378176715,ExpressionUUID->"669bcc39-f71f-4e55-a386-65a634b7f6b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"mat", ".", "vin"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "Normal"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1134493565,ExpressionUUID->"dceb7ebe-3735-40ce-9abf-07a3cbfd8ef8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     FractionBox["1", "2"], "-", 
     FractionBox["\[ImaginaryI]", "2"]}], 
    SqrtBox["2"]], ",", 
   RowBox[{
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[ImaginaryI]", 
      RowBox[{"2", " ", 
       SqrtBox["2"]}]]}], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   FractionBox[
    RowBox[{
     FractionBox["1", "2"], "+", 
     FractionBox["\[ImaginaryI]", "2"]}], 
    SqrtBox["2"]], ",", 
   RowBox[{
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", "0", ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[ImaginaryI]", 
      RowBox[{"2", " ", 
       SqrtBox["2"]}]]}], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1512170489,ExpressionUUID->"ad228ff3-763e-441a-98d2-1b5672e876db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vec", "-", "new"}], "//", "Normal"}], "//", "Simplify"}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->2095659547,ExpressionUUID->"a777b814-b6db-43a0-bdf9-ecb123309f98"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1977271999,ExpressionUUID->"8268fc87-e105-4b9c-99c8-86a6301384dd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "71d8d66a-3304-4255-b137-51e36c6a55f6"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->633346104,ExpressionUUID->"f6d841c7-487c-413d-8cb0-e0a332da4d74"],

Cell["\<\
For a large number qubits, the evaluation of QFT takes long. In this case, \
setting the numeric evaluation flag helps make it faster. You can set the \
flag either manually or by using N.\
\>", "ExampleText",
 CellID->1225739319,ExpressionUUID->"55f30075-b386-4625-8325-6c02c4b3d49f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", " ", "SS", ",", "True"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1645416489,ExpressionUUID->"eb210030-fade-4798-bc19-6a4e68a7879b"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]]}], "}"}], ",", "True"}], "]"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->2135236142,ExpressionUUID->"e3da8d6f-68ae-4475-8d6d-2e3aab429b81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nop", "=", 
  RowBox[{"N", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->511943956,ExpressionUUID->"424a1c20-28bd-4a4d-8ef0-66bf0b1944ba"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]]}], "}"}], ",", "True"}], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1279810640,ExpressionUUID->"d726f274-831c-4762-bdc3-17bc1a56ac51"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "nop", "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->2120710401,ExpressionUUID->"2056186e-681d-4cee-98fa-18747d721350"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.125`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.12499999999999997`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.30177669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.12499999999999997`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.12499999999999999`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.125`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.30177669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.125`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.051776695296636865`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.12499999999999997`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 2]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.12499999999999999`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.125`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 1]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.05177669529663689`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.125`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.125`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.12499999999999997`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[3, 3]]}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->179315387,ExpressionUUID->"10d0cc1f-2997-4b0f-bb48-e2ecd8a48278"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "nop", "]"}], "//", "MatrixForm"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1149083753,ExpressionUUID->"d6ee0432-7133-46d7-b681-d004efa070cb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "+", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "-", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "+", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "-", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "-", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "+", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "-", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.35355339059327373`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "+", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, Complex[0., 0.], {
     1, {{0, 8, 16, 24, 32, 40, 48, 56, 64}, {{1}, {2}, {3}, {4}, {5}, {6}, {
       7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {
       5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {
       3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {
       1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {
       7}, {8}}}, {
      Complex[0.35355339059327373`, 0.], Complex[0.35355339059327373`, 0.], 
       Complex[0.35355339059327373`, 0.], Complex[0.35355339059327373`, 0.], 
       Complex[0.35355339059327373`, 0.], Complex[0.35355339059327373`, 0.], 
       Complex[0.35355339059327373`, 0.], Complex[0.35355339059327373`, 0.], 
       Complex[0.35355339059327373`, 0.], Complex[0.25, 0.24999999999999994`],
        Complex[0., 0.35355339059327373`], 
       Complex[-0.24999999999999994`, 0.25], 
       Complex[-0.35355339059327373`, 0.], 
       Complex[-0.24999999999999994`, -0.25], Complex[
       0., -0.35355339059327373`], Complex[0.25, -0.24999999999999994`], 
       Complex[0.35355339059327373`, 0.], Complex[0., 0.35355339059327373`], 
       Complex[-0.35355339059327373`, 0.], Complex[0., -0.35355339059327373`],
        Complex[0.35355339059327373`, 0.], Complex[0., 0.35355339059327373`], 
       Complex[-0.35355339059327373`, 0.], Complex[0., -0.35355339059327373`],
        Complex[0.35355339059327373`, 0.], 
       Complex[-0.24999999999999994`, 0.25], Complex[
       0., -0.35355339059327373`], Complex[0.25, 0.24999999999999994`], 
       Complex[-0.35355339059327373`, 0.], Complex[
       0.25, -0.24999999999999994`], Complex[0., 0.35355339059327373`], 
       Complex[-0.24999999999999994`, -0.25], Complex[
       0.35355339059327373`, 0.], Complex[-0.35355339059327373`, 0.], Complex[
       0.35355339059327373`, 0.], Complex[-0.35355339059327373`, 0.], Complex[
       0.35355339059327373`, 0.], Complex[-0.35355339059327373`, 0.], Complex[
       0.35355339059327373`, 0.], Complex[-0.35355339059327373`, 0.], Complex[
       0.35355339059327373`, 0.], Complex[-0.24999999999999994`, -0.25], 
       Complex[0., 0.35355339059327373`], Complex[
       0.25, -0.24999999999999994`], Complex[-0.35355339059327373`, 0.], 
       Complex[0.25, 0.24999999999999994`], Complex[
       0., -0.35355339059327373`], Complex[-0.24999999999999994`, 0.25], 
       Complex[0.35355339059327373`, 0.], Complex[0., -0.35355339059327373`], 
       Complex[-0.35355339059327373`, 0.], Complex[0., 0.35355339059327373`], 
       Complex[0.35355339059327373`, 0.], Complex[0., -0.35355339059327373`], 
       Complex[-0.35355339059327373`, 0.], Complex[0., 0.35355339059327373`], 
       Complex[0.35355339059327373`, 0.], Complex[
       0.25, -0.24999999999999994`], Complex[0., -0.35355339059327373`], 
       Complex[-0.24999999999999994`, -0.25], 
       Complex[-0.35355339059327373`, 0.], 
       Complex[-0.24999999999999994`, 0.25], Complex[
       0., 0.35355339059327373`], Complex[
       0.25, 0.24999999999999994`]}}]]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->767691049,ExpressionUUID->"af2bb6b4-1d8a-4f35-a6fe-b5cac2309b20"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nop", "**", "in"}], "//", "KetChop"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->860433650,ExpressionUUID->"7e425e99-3624-415e-9635-3e1dfb3e4343"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.6035533905932737`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.7071067811865475`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24999999999999994`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.6035533905932737`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24999999999999994`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.10355339059327373`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.10355339059327379`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->776917137,ExpressionUUID->"e3c33ab2-44b3-4251-9e4c-68fa962af1e9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "ff0be096-0983-46fb-8198-e20eff8e264a"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1755184417,ExpressionUUID->"df910006-986f-4e0d-ad2b-d9743935cde1"],

Cell["Let us examine the Hermitian conjugate more closely.", "ExampleText",
 CellID->182857608,ExpressionUUID->"a35cf276-edd4-4a0b-877e-a405cc8fac9f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dag", "=", 
  RowBox[{"Dagger", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->2015855374,ExpressionUUID->"4b4b8c17-bc51-427a-afc1-4ee540e40c1e"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]]}], "}"}], ",", "False"}], "]"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1391211005,ExpressionUUID->"52d600d1-22c2-4e8a-b937-a56009f3b6fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "dag", "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1813718867,ExpressionUUID->"e83f1206-80f2-40c7-8ecc-7bd2dd9fbca7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", "8"], "-", 
    FractionBox["\[ImaginaryI]", "8"]}], ")"}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "-", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[3, 3]]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 1]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 1]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "-", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 1]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "-", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[3, 3]]}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->28807335,ExpressionUUID->"eae98c7f-6b6b-44e4-a5b9-4d3436d10102"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dag", "**", "op"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1457601367,ExpressionUUID->"03e2503c-ff07-43fa-95c8-a89689974a57"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->612369762,ExpressionUUID->"2c398958-c300-43c6-9dce-9b5007b51714"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "**", "dag"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1455047160,ExpressionUUID->"6977030d-3481-4af4-aa84-03550ab9bce1"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[4]=",
 CellID->806353398,ExpressionUUID->"136269e6-0948-457e-824a-ea6f51be339d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"inv", "=", 
   RowBox[{"Matrix", "[", "dag", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"inv", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1456139501,ExpressionUUID->"0fcf4b00-1ac3-451c-ae58-6774e1468bca"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 8, 16, 24, 32, 40, 48, 56, 64}, {{1}, {2}, {3}, {4}, {5}, {6}, {
       7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {
       5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {
       3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {
       1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {5}, {6}, {
       7}, {8}}}, {
      Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[-1, 4]] Pi), Complex[0, Rational[-1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[-3, 4]] Pi), Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2] E^(Complex[0, Rational[3, 4]] Pi), 
       Complex[0, Rational[1, 2]] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2] E^(Complex[0, Rational[1, 4]] Pi), Rational[1, 2] 
       2^Rational[-1, 2], Complex[0, Rational[-1, 2]] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Complex[0, Rational[1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Complex[0, Rational[-1, 2]] 2^Rational[-1, 2], Rational[-1, 2] 
       2^Rational[-1, 2], Complex[0, Rational[1, 2]] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[-3, 4]] Pi), Complex[0, Rational[1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[-1, 4]] Pi), Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2] E^(Complex[0, Rational[1, 4]] Pi), 
       Complex[0, Rational[-1, 2]] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2] E^(Complex[0, Rational[3, 4]] Pi), Rational[1, 2] 
       2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2], Rational[-1, 2] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[3, 4]] Pi), Complex[0, Rational[-1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[1, 4]] Pi), Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2] E^(Complex[0, Rational[-1, 4]] Pi), 
       Complex[0, Rational[1, 2]] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2] E^(Complex[0, Rational[-3, 4]] Pi), Rational[1, 2] 
       2^Rational[-1, 2], Complex[0, Rational[1, 2]] 2^Rational[-1, 2], 
       Rational[-1, 2] 2^Rational[-1, 2], Complex[0, Rational[-1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2], 
       Complex[0, Rational[1, 2]] 2^Rational[-1, 2], Rational[-1, 2] 
       2^Rational[-1, 2], Complex[0, Rational[-1, 2]] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[1, 4]] Pi), Complex[0, Rational[1, 2]] 
       2^Rational[-1, 2], Rational[1, 2] 2^Rational[-1, 2] 
       E^(Complex[0, Rational[3, 4]] Pi), Rational[-1, 2] 2^Rational[-1, 2], 
       Rational[1, 2] 2^Rational[-1, 2] E^(Complex[0, Rational[-3, 4]] Pi), 
       Complex[0, Rational[-1, 2]] 2^Rational[-1, 2], Rational[1, 2] 
       2^Rational[-1, 2] E^(Complex[0, Rational[-1, 4]] Pi)}}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->494727356,ExpressionUUID->"5c291e36-1370-445d-95d9-d4d5c846f422"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"inv", ".", "mat"}], "//", "SimplifyThrough"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->1935546351,ExpressionUUID->"8cdc2857-346c-4198-9e04-1390dd0982c7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 1, 2, 3, 4, 5, 6, 7, 8}, {{1}, {2}, {3}, {4}, {5}, {6}, {7}, {
       8}}}, {1, 1, 1, 1, 1, 1, 1, 1}}]]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1564112758,ExpressionUUID->"8d12d4c3-c595-4529-a786-ab375de4b2cf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "2dcba765-4c88-46f0-9ebc-70e6bc267452"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->16769557,ExpressionUUID->"6c3c447b-1a3f-4b18-ab9d-59402d037e86"],

Cell["\<\
The QFT displays as a rectangular block in the quantum circuit.\
\>", "ExampleText",
 CellID->525586742,ExpressionUUID->"8846e7ce-17b4-4217-8818-fbf582a50496"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->776477862,ExpressionUUID->"e42c1435-6ee1-429b-a3ae-2127427eb28c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QFT\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QFT[1, {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, False]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->666228083,ExpressionUUID->"a1b6a87d-1dac-4d8d-b203-8cc0aeac8c97"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qcd", "=", 
  RowBox[{"QuantumCircuit", "[", "dag", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1626305766,ExpressionUUID->"fb3d1699-eaf2-4080-b63e-5622486d239d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox[
       SuperscriptBox["\<\"QFT\"\>", "\[Dagger]"],
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QFT[-1, {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, False]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->571907925,ExpressionUUID->"18196699-75e4-4775-acb4-9be8ecd1e0b1"]
}, Open  ]],

Cell[TextData[{
 "Decompose the QFT into a sequence of the controlled powers of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "f576504c-aa5b-40c2-bf71-5ece4ab68c7b"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "054f0d49-529c-4050-b9b0-8468c5f1024a"],
 " denotes the phase gate ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "k"], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        FractionBox[
         RowBox[{"2", "\[Pi]"}], 
         SuperscriptBox["2", "k"]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "1cd212ea-d8fe-4218-8e4c-751e9c9b08c0"],
 "."
}], "ExampleText",
 CellID->1382320030,ExpressionUUID->"95449b50-b878-4017-9a61-a733f91d056a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"Expand", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1879716809,ExpressionUUID->"3f3800e5-4732-4c4c-8f41-fb34cffa5f6c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -3.4}, {2.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->298.8,
   PlotRange->{{0, 7}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    $CellContext`S[1, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$]}, 
    $CellContext`S[2, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}]]]], "Output",
 CellLabel->"Out[3]=",
 CellID->1643730571,ExpressionUUID->"e3fb05d8-6c73-4d55-ac19-756d56a7b579"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"newd", "=", 
  RowBox[{"Expand", "[", "dag", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1850064624,ExpressionUUID->"29b4afc6-c272-418d-9259-70838c630197"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -3.4}, {2.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", 
         TemplateBox[{"\"\[Dagger]\"", "\"\[ThinSpace]\"", "\"x\""}, 
          "RowDefault"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", 
         TemplateBox[{"\"\[Dagger]\"", "\"\[ThinSpace]\"", "\"x\""}, 
          "RowDefault"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->298.8,
   PlotRange->{{0, 7}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, 
    $CellContext`S[1, -C[3]], {"ControlLabel" -> "x"}], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$]}, 
    $CellContext`S[2, -C[2]], {"ControlLabel" -> "x"}], 
   $CellContext`S[3, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}]]]], "Output",
 CellLabel->"Out[4]=",
 CellID->776524665,ExpressionUUID->"4fcb9a04-961d-4cae-b6d4-320820146915"]
}, Open  ]],

Cell["\<\
Further decompose the gates into more elementary gates; that is, the \
controlled-unitary gates.\
\>", "ExampleText",
 CellID->1011808894,ExpressionUUID->"d58d3b40-1d0a-4e1b-9534-31c1bd64d849"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mint", "=", 
  RowBox[{"ExpandAll", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->1094389178,ExpressionUUID->"f65281f6-1438-4cd1-9b7e-e32a1fb60363"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -3}, {5, -2}}], 
     DiskBox[{5, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -3.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->334.8,
   PlotRange->{{0, 8}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}]]]], "Output",
 CellLabel->"Out[5]=",
 CellID->2100194584,ExpressionUUID->"1e5bb95d-a875-46f4-9613-a73aa0eb5d8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mintd", "=", 
  RowBox[{"ExpandAll", "[", "dag", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->677643271,ExpressionUUID->"a86a34a4-4d3b-4586-aaaa-c32e47875b2b"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"\[Dagger]\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"\[Dagger]\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -3}, {5, -2}}], 
     DiskBox[{5, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"\[Dagger]\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -3.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->334.8,
   PlotRange->{{0, 8}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[1, -C[2]], {}], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[1, -C[3]], {}], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[2, -C[2]], {}], 
   $CellContext`S[3, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}]]]], "Output",
 CellLabel->"Out[6]=",
 CellID->1171838818,ExpressionUUID->"6f117363-7488-4544-aeca-f4ac258e4729"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "qc", "]"}], "-", 
    RowBox[{"Matrix", "[", "new", "]"}]}], "//", "SimplifyThrough"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "qc", "]"}], "-", 
    RowBox[{"Matrix", "[", "mint", "]"}]}], "//", "SimplifyThrough"}], "//", 
  "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->1034640886,ExpressionUUID->"385adebe-03c0-428c-a451-a56405129d26"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}]]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1628225877,ExpressionUUID->"6fa14693-3de7-4a61-a79d-183d9b8d84cb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}]]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->208201018,ExpressionUUID->"02d495a9-4508-47de-83d9-1cd2163c19a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "qcd", "]"}], "-", 
    RowBox[{"Matrix", "[", "newd", "]"}]}], "//", "SimplifyThrough"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "qcd", "]"}], "-", 
    RowBox[{"Matrix", "[", "mintd", "]"}]}], "//", "SimplifyThrough"}], "//", 
  "MatrixForm"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[8]:=",
 CellID->2104858351,ExpressionUUID->"e3f54f06-86f4-48b1-b542-56bf8c234cdf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}]]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->399993133,ExpressionUUID->"f5724742-5576-4a0f-8016-61951e6b47b5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}]]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->1060771221,ExpressionUUID->"b40fabaa-c40a-41b0-b71b-23f7574fa41e"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {0.45000000000000107`, 13.549999999999999`}}]],
  ExpressionUUID->"faf3de03-b549-449a-b67d-e36a6b103fa0"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"cff6ea78-edb0-4279-aa55-6bd98f2ccd05"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "bff89cd4-8dea-4215-8a64-1040a60f6fdd"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1502926422,ExpressionUUID->"8605156b-ba54-45b3-ab63-339a1b67d03a"],

Cell[TextData[{
 "The evaluation performance of a quantum circuit may vary significantly \
depending on how you evaluate it (that is, either using ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Evaluate"]], "paclet:Q3/ref/Evaluate", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "405a9f74-da00-4dcc-a148-a85bc26480be"],
 "/",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ExpressionFor"]], "paclet:Q3/ref/ExpressionFor", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "ef584b6f-47ef-4705-8bb6-873b85a77acd"],
 " or ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:Q3/ref/Matrix", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "6b336918-93ed-4a32-91dd-eacba1fd34e1"],
 "), whether there is an input or not, or either directly working with \
high-level gates or elementary gates."
}], "ExampleText",
 CellID->1326551885,ExpressionUUID->"8fbf977c-467d-4ba9-8027-a0b5999ddec9"],

Cell[TextData[{
 "For example, consider the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QFT"]], "paclet:Q3/ref/QFT", "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "8b366eca-4536-4c22-a50b-f87933b29570"],
 " gate, which is a high-level gate representing the quantum Fourier \
transform."
}], "ExampleText",
 CellID->1844377872,ExpressionUUID->"f35f4b2a-a6f6-4579-89ad-c8b5c52163da"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->750101519,ExpressionUUID->"a3e1cd74-2155-43db-94c6-e3126ab6052d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`S[4, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->2111656846,ExpressionUUID->"81f4f264-6ad2-4786-a57a-f42c22758eeb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"N", "[", 
   RowBox[{"QFT", "[", "SS", "]"}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1601330061,ExpressionUUID->"592affd6-0d38-4f91-9a0f-8d9884969849"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, Q3`$]]}], "}"}], ",", "True"}], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->442197932,ExpressionUUID->"c2f8ab3b-cf97-4ee5-a072-d8f0590b43b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1749439152,ExpressionUUID->"64489409-331c-4b26-a4fe-12d6c833c973"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QFT\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QFT[1, {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, True]]]], "Output",
 CellLabel->"Out[3]=",
 CellID->1333617970,ExpressionUUID->"a4eb4bfa-b2e5-425b-a8d2-75557913e012"]
}, Open  ]],

Cell["Evaluating the circuit is reasonably fast.", "ExampleText",
 CellID->1188118867,ExpressionUUID->"9a072f1c-b4e9-4ad3-978b-a58092b2b72e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1516752790,ExpressionUUID->"bf7101b2-e1dc-49be-a510-89bb8455b9e5"],

Cell[BoxData["0.770101`"], "EchoTiming",
 CellID->1675292539,ExpressionUUID->"677c3224-834a-48c6-b25f-b2ec7650e4e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"mat", "=", 
    RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->2006007153,ExpressionUUID->"a3a02361-2d16-4016-983d-2187d1090292"],

Cell[BoxData["0.003488`"], "EchoTiming",
 CellID->1847370151,ExpressionUUID->"075a8266-d7c8-4a86-ba6b-b0efb450f118"]
}, Open  ]],

Cell["Operating it on a Ket expression is also fast.", "ExampleText",
 CellID->122037108,ExpressionUUID->"3e26f6c8-32e3-46c5-9070-f8566bb202dd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", "SS", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"bs", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "-", 
   RowBox[{"I", "*", 
    RowBox[{"bs", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}]}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->82863167,ExpressionUUID->"c60a8af0-9a1f-4726-8a15-d13ee548cc12"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["1", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
           $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1769826132,ExpressionUUID->"f1ae284c-d6cd-4fd2-904d-357250d83bce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->1043266157,ExpressionUUID->"e4248438-3c1f-4595-90f1-10b724821956"],

Cell[BoxData["0.029986`"], "EchoTiming",
 CellID->97721547,ExpressionUUID->"f3dd4fbb-afc2-4cb4-ab4c-c6007e057385"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.25`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.4077465784244586`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.0811058372053644`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1767766952966369`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.42677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2724475533879093`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.4077465784244586`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.5`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.2724475533879093`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.4077465784244586`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.42677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.4077465784244586`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.08110583720536443`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 0|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.05419318783118479`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.27244755338790927`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.0732233047033631`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.08110583720536442`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.05419318783118479`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      0, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.08110583720536439`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.05419318783118479`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 0, $CellContext`S[4, Q3`$] -> 1|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.1767766952966369`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.07322330470336313`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 0|>]]}], 
  "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.05419318783118479`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.2724475533879093`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"]], 
            $CellContext`S[4, Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
      1, $CellContext`S[3, Q3`$] -> 1, $CellContext`S[4, Q3`$] -> 
      1|>]]}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1728534121,ExpressionUUID->"23edbf9e-bc49-4d52-b73e-a4462151b46c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "dda9e9b3-fac1-4350-bf8f-971596338c0c"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1166242150,ExpressionUUID->"cb194a6e-aabd-4a8d-a09b-4e99f18f0bf8"],

Cell["\<\
Now, consider the decomposition of the high-level QFT gate into a set of more \
elementary gates.\
\>", "ExampleText",
 CellID->643625537,ExpressionUUID->"a469ee92-71c0-4680-9c9a-899cdf859972"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Expand", "@", "op"}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1791312436,ExpressionUUID->"1240a424-aefc-4450-9dad-7e85e7f2b07c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -4}, {2, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -4}, {4, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -4}, {6, -3}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, 
    Q3`Phase[0.39269908169872414`, 
     $CellContext`S[1, 3], "Label" -> Subscript["Z", 4]], "ControlLabel" -> 
    "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, 
    Q3`Phase[0.7853981633974483, 
     $CellContext`S[2, 3], "Label" -> Subscript["Z", 3]], "ControlLabel" -> 
    "x"], 
   $CellContext`S[3, 6], 
   Q3`ControlledPower[{
     $CellContext`S[4, Q3`$]}, 
    Q3`Phase[1.5707963267948966`, 
     $CellContext`S[3, 3], "Label" -> Subscript["Z", 2]], "ControlLabel" -> 
    "x"], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->265855294,ExpressionUUID->"d670a724-9c2f-4f30-8e46-275b15bfc579"]
}, Open  ]],

Cell["\<\
Since we have to simulate it classically, it is much slower than the above \
quantum circuit that directly uses the high-level feature..\
\>", "ExampleText",
 CellID->562437636,ExpressionUUID->"196d657a-dd2f-43f1-8225-99d58670f207"],

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"expr2", "=", 
    RowBox[{"Elaborate", "[", "qc2", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1949985825,ExpressionUUID->"df9fa6f4-3f97-4203-b939-e43aea81a1ee"],

Cell["This may be overcome by using matrix representations.", "ExampleText",
 CellID->1896345337,ExpressionUUID->"6b2497d0-b553-45df-908c-fc3925e004a6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"mat2", "=", 
    RowBox[{"Matrix", "[", "qc2", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->803044201,ExpressionUUID->"aa5b3dd5-62da-46c7-8943-76fb36bd0905"],

Cell[BoxData["0.008597`"], "EchoTiming",
 CellID->1193236200,ExpressionUUID->"9767a27d-f4f8-4c07-8573-2973382bd95c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "mat2"}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1911716864,ExpressionUUID->"f3e1d4f6-820a-4dcf-b5cd-47d57b20802d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
       0}, {}}, {}}]]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1834369009,ExpressionUUID->"9a07144f-c13c-4299-921c-f8a25fcb54e6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "018eda29-c303-4bdb-afd7-a0126ec55339"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->948568881,ExpressionUUID->"ab79ab20-554f-41bc-b23e-25d5bfab860c"],

Cell["Try with another version of the original quantum circuit.", \
"ExampleText",
 CellID->1538911483,ExpressionUUID->"3a76bcca-06cd-4db7-8ba3-acbf7d37b735"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc3", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"ExpandAll", "@", "op"}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->192250313,ExpressionUUID->"f425ed53-8dd7-41cc-8839-9db6906b2881"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -4}, {4, -1}}], 
     DiskBox[{4, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -2}}], 
     DiskBox[{6, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -4}, {7, -2}}], 
     DiskBox[{7, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -4}, {9, -3}}], 
     DiskBox[{9, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`Phase[1.5707963267948966`, 
     $CellContext`S[1, 3], "Label" -> Subscript["Z", 2]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Q3`Phase[0.7853981633974483, 
     $CellContext`S[1, 3], "Label" -> Subscript["Z", 3]]], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    Q3`Phase[0.39269908169872414`, 
     $CellContext`S[1, 3], "Label" -> Subscript["Z", 4]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Q3`Phase[1.5707963267948966`, 
     $CellContext`S[2, 3], "Label" -> Subscript["Z", 2]]], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    Q3`Phase[0.7853981633974483, 
     $CellContext`S[2, 3], "Label" -> Subscript["Z", 3]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    Q3`Phase[1.5707963267948966`, 
     $CellContext`S[3, 3], "Label" -> Subscript["Z", 2]]], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->991024962,ExpressionUUID->"ea01d912-5f39-4817-9857-9b33f618b7fa"]
}, Open  ]],

Cell[TextData[{
 "This version is slightly better than the second version since some internal \
calculations (",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["MultiplyPower"]], "paclet:Q3/ref/MultiplyPower", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "930ad7f2-673b-40b8-b77e-c6e0c0804a8e"],
 " in this case) have already been incorporated at the time of the \
decomposition."
}], "ExampleText",
 CellID->261653958,ExpressionUUID->"fc6b02e1-af0a-4c1b-b94f-282a11b0187b"],

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"exp3", "=", 
    RowBox[{"Elaborate", "[", "qc3", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1580018662,ExpressionUUID->"f3a0fea0-0f71-4e71-ab7f-322ecf3d4570"],

Cell["Again, evaluating it using matrix representations is fast.", \
"ExampleText",
 CellID->1596247736,ExpressionUUID->"2aa29afc-88b3-48f1-8106-ec1f2b328303"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"mat3", "=", 
    RowBox[{"Matrix", "[", "qc3", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1611158688,ExpressionUUID->"c0643ac6-a5a9-454c-a196-f49f27a65e4c"],

Cell[BoxData["0.008054`"], "EchoTiming",
 CellID->1545275520,ExpressionUUID->"251f82ac-ea79-491f-871c-db6b620a0f41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "mat3"}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1119257192,ExpressionUUID->"dac8a4af-433b-4f60-b91a-a0cdddda5f39"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
       0}, {}}, {}}]]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1784673257,ExpressionUUID->"f652ac02-7d9d-4273-b7c4-1bb5fb728305"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {0.45000000000000107`, 13.549999999999999`}}]],
  ExpressionUUID->"3476a413-ccab-4163-8ccd-323641a9360b"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"7c0ae7ab-edf4-4f30-a799-f81b8764ed16"],
 "Applications",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(4)", "ExampleCount",ExpressionUUID->
  "27f38ebb-e675-4125-8e7b-8f5f10239c9a"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1895575281,ExpressionUUID->"49f3e93e-0637-4c86-ad2f-891c775a38d3"],

Cell["\<\
Here, we exploit the relation between the quantum Fourier transform(QFT) and \
its inverse to get a series of equivalent quantum circuits.\
\>", "ExampleText",
 CellID->1449669344,ExpressionUUID->"24eb90bc-af9e-46cf-bb82-28e65605ef5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->2094919358,ExpressionUUID->"da3aaaae-bd11-4426-9579-ac6172d4d364"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1315257341,ExpressionUUID->"88f9c02a-890e-41c7-82ff-ceda489aecb2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`S[4, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1503440133,ExpressionUUID->"76d5ad56-81a7-4acc-87f6-1eee5ea63e83"]
}, Open  ]],

Cell["Consider the QFT.", "ExampleText",
 CellID->147470073,ExpressionUUID->"b0552d28-46ba-4415-9ee2-5ff69e123db6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QFT", "[", "SS", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1018341382,ExpressionUUID->"2b23a954-aa6a-45c7-8d8a-a43444ffb50a"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1025564886,ExpressionUUID->"ced56cf4-db4e-4d06-948e-9d7df4dfac11"]
}, Open  ]],

Cell["Here is the quantum circuit that Q3 uses.", "ExampleText",
 CellID->271289733,ExpressionUUID->"24e94640-dfef-4692-b140-5e6c4e873cb0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qft", "=", 
  RowBox[{"Expand", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->597018216,ExpressionUUID->"87ae02f0-7200-4973-9b44-9fdaf19d9091"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -4}, {2, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -4}, {4, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -4}, {6, -3}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, 
    $CellContext`S[1, 
     C[4]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, 
    $CellContext`S[2, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   Q3`ControlledPower[{
     $CellContext`S[4, Q3`$]}, 
    $CellContext`S[3, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[4]=",
 CellID->25844751,ExpressionUUID->"aed6267f-d97b-4241-8a12-3c671662044c"]
}, Open  ]],

Cell["Expand the controlled-power gates.", "ExampleText",
 CellID->1395460857,ExpressionUUID->"bd4fdc3c-027d-48c1-a2bd-888654e6bc0f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpandAll", "[", "op", "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->171881754,ExpressionUUID->"2e7e67f8-e682-44a2-b465-4b0ec62641cd"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -4}, {4, -1}}], 
     DiskBox[{4, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -2}}], 
     DiskBox[{6, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -4}, {7, -2}}], 
     DiskBox[{7, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -4}, {9, -3}}], 
     DiskBox[{9, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[4]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[3]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[4, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[5]=",
 CellID->1014137880,ExpressionUUID->"de299af3-d7de-42b6-a030-1e2d25fb1b45"]
}, Open  ]],

Cell["\<\
These two quantum circuits are not appropriate for semiclassical \
implementation of QFT because Hadamard gates are applied on the control \
qubits after the controlled-power or controlled-unitary gates.\
\>", "ExampleText",
 CellID->1535874996,ExpressionUUID->"2e2d4059-91e9-4be0-8dd9-068a4d27c37d"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "7817118f-c6b1-4da2-9471-d80fdd07fbc1"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->158760501,ExpressionUUID->"82a5068f-4f4d-4654-ab26-acab5d9a1406"],

Cell[TextData[{
 "The inverse QFT is another Fourier transform with the factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
    "2", "\[Pi]", "\[VeryThinSpace]", "\[ImaginaryI]", "\[VeryThinSpace]", 
     "x", "\[VeryThinSpace]", 
     RowBox[{"k", "/", "N"}]}]], TraditionalForm]],ExpressionUUID->
  "d075fae6-2122-4fcb-ad9e-bfc35bfc7c4b"],
 "replaced by ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "2"}], "\[Pi]", "\[VeryThinSpace]", "\[ImaginaryI]", 
     "\[VeryThinSpace]", "x", "\[VeryThinSpace]", 
     RowBox[{"k", "/", "N"}]}]], TraditionalForm]],ExpressionUUID->
  "030c47c3-a5a0-4139-86f3-e36266d85764"],
 ". This suggests that the inverse QFT can be achieved simply by replacing \
each phase gate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "297c1d39-e93d-4c1b-92d0-9052429baacc"],
 " by ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["Z", "k", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "0e5be027-5105-4430-bfb5-189168492358"],
 ". This also means that an equivalent quantum circuit may be achieved simply \
reversing the original quantum circuit."
}], "ExampleText",
 CellID->673555027,ExpressionUUID->"8ecde349-6f26-45c6-a379-bb04cda09bab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alt", "=", 
  RowBox[{"Reverse", "[", "qft", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1212258744,ExpressionUUID->"5bfac5ab-7335-41df-a014-9662ab9741cf"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -4}, {3, -3}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -3}, {5, -4}, {5, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -4.4}, {5.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -3}, {7, -4}, {7, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -1.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}], 
   $CellContext`S[4, 6], 
   Q3`ControlledPower[{
     $CellContext`S[4, Q3`$]}, 
    $CellContext`S[3, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, 
    $CellContext`S[2, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}, 
    $CellContext`S[1, 
     C[4]], "ControlLabel" -> "x"], 
   $CellContext`S[1, 6]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->1550834295,ExpressionUUID->"422002f2-6011-4814-9849-074e81f4ad3a"]
}, Open  ]],

Cell["\<\
We can bring the QBR transform at the beginning of the above circuit to the \
end by reversing the qubits in each gate.\
\>", "ExampleText",
 CellID->659314118,ExpressionUUID->"cb7f5049-d166-4df5-a2a0-107f9aab5d5b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"QBR", "[", "SS", "]"}], "/@", 
     RowBox[{"Rest", "[", "alt", "]"}]}], " ", "/.", 
    RowBox[{"OverTilde", "->", "Identity"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"QBR", "@", "SS"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1732368903,ExpressionUUID->"9c8afebd-9b66-4248-8916-ec37b8a10a57"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}, {4, -3}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -2}, {6, -1}, {6, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[2, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[3, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[4, 
     C[4]], "ControlLabel" -> "x"], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->640638142,ExpressionUUID->"44480497-2833-4e27-9b9e-f404ab9ed738"]
}, Open  ]],

Cell[TextData[{
 "For heuristic purposes, Q3 provides a handy way to generate the above \
quantum circuit of the QFT. Note that the tilde accent above the label of \
control qubits to emphasize the bit string is reversed; that is,  ",
 Cell[BoxData[
  FormBox[Cell[TextData[Cell[BoxData[
    FormBox[
     RowBox[{
      OverscriptBox["x", "~"], ":=", 
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", 
          RowBox[{"k", "-", "1"}]], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["x", "2"], 
         SubscriptBox["x", "1"]}], ")"}], "2"]}], TraditionalForm]],
    ExpressionUUID->"dfdc31c1-b3b2-4f6d-9013-b83fb3fb3585"]],ExpressionUUID->
    "07ac19cc-5c48-4fda-99b0-16008b010cda"], TraditionalForm]],ExpressionUUID->
  "e877ac00-ce4e-444d-8541-89bf21b8179b"],
 " rather than ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["x", "1"], 
      SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
      SubscriptBox["x", 
       RowBox[{"k", "-", "1"}]]}], ")"}], "2"], TraditionalForm]],
  ExpressionUUID->"a5b2e783-d53f-4ae3-9fea-92f727b7d4ab"],
 "."
}], "ExampleText",
 CellID->597410564,ExpressionUUID->"de5c0e9a-7a61-46f2-9586-c6735bbfdc7b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mint", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{"op", ",", "\"\<Reversed\>\""}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->810946710,ExpressionUUID->"86e88869-b7d7-4753-9766-a9b22176e431"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}, {4, -3}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -2}, {6, -1}, {6, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[2, 
     C[2]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[3, 
     C[3]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[4, 
     C[4]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[3]=",
 CellID->858591399,ExpressionUUID->"3ff4ecbd-76c5-4504-b687-6e4a8e3bdea8"]
}, Open  ]],

Cell["\<\
Expand further the controlled-power gates in the above quantum circuit to get \
the following conventional quantum circuit which commonly appears in \
textbooks.\
\>", "ExampleText",
 CellID->544880232,ExpressionUUID->"83375dc3-cf1a-41f3-9c51-86e149703fe9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"more", "=", 
  RowBox[{"ExpandAll", "[", 
   RowBox[{"op", ",", "\"\<Reversed\>\""}], "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1131136971,ExpressionUUID->"34d7da68-a58b-4cca-8aa3-4381ed167095"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -4}}], 
     DiskBox[{7, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -2}, {8, -4}}], 
     DiskBox[{8, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -3}, {9, -4}}], 
     DiskBox[{9, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}]]]], "Output",
 CellLabel->"Out[4]=",
 CellID->496981065,ExpressionUUID->"60245bea-6570-45b5-85ae-288041addce9"]
}, Open  ]],

Cell["\<\
These two quantum circuits are suitable for semiclassical implementation of \
the QFT since there is nor Hadamard gate required after the controlled-power \
or controlled-unitary gates.\
\>", "ExampleText",
 CellID->1486864925,ExpressionUUID->"1eeeb869-ec0b-46b4-96f4-fb65ab9daad8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "52fdea78-f881-4a77-97dd-17a0ee810b3f"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->76417801,ExpressionUUID->"4e378bfc-ad4e-4997-9d92-7c7f29d1f9a5"],

Cell[TextData[{
 "Again, yet another equivalent quantum circuit may be constructed by \
reversing the above quantum circuits ",
 StyleBox["mint", "Input"],
 " or ",
 StyleBox["conv", "Input"],
 "."
}], "ExampleText",
 CellID->2137736558,ExpressionUUID->"e312bbdd-1848-4d7b-85e0-60ec554f0a3d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"else", "=", 
  RowBox[{"Reverse", "[", "mint", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1543898210,ExpressionUUID->"4f09c144-7789-4f6e-9aaf-f20e45bb1ab9"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -2}, {3, -1}, {3, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -1}, {5, -3}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -1.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}], 
   $CellContext`S[4, 6], 
   Q3`ControlledPower[{
     $CellContext`S[3, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[4, 
     C[4]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   Q3`ControlledPower[{
     $CellContext`S[2, Q3`$], 
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[3, 
     C[3]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledPower[{
     $CellContext`S[1, Q3`$]}, 
    $CellContext`S[2, 
     C[2]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[1, 6]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->427980299,ExpressionUUID->"b61b6bfc-7263-4424-a5f2-86ea5fb0569d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"QBR", "[", "SS", "]"}], ",", 
   RowBox[{"Expand", "@", 
    RowBox[{"Rest", "[", "else", "]"}]}]}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1371099242,ExpressionUUID->"6453e5fe-d71a-4900-bda9-31e30fabf847"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -4}}], 
     DiskBox[{4, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -1}, {5, -4}}], 
     DiskBox[{5, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -3}}], 
     DiskBox[{7, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -1}, {8, -3}}], 
     DiskBox[{8, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{10, -1}, {10, -2}}], 
     DiskBox[{10, -1}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {10., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -1.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{23.400000000000002`, 23.400000000000002`}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`QBR[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$], 
     $CellContext`S[4, Q3`$]}], 
   $CellContext`S[4, 6], 
   Q3`ControlledGate[{$CellContext`S[3, Q3`$] -> 1}, 
    Q3`ActOn[
    Rational[1, 4] (Complex[1, 1] - (-1)^Rational[1, 8] - (-1)^
       Rational[3, 8]) + 
     Rational[1, 4] (Complex[1, -1] + (-1)^Rational[1, 8] - (-1)^
       Rational[3, 8]) $CellContext`S[4, 3] + 
     Rational[1, 2] (1 + (-1)^Rational[3, 8]) $CellContext`S[4, 
        C[4]], {
      $CellContext`S[4, Q3`$]}], "Label" -> Subsuperscript["Z", 4, 
      Superscript[2, 2]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`ActOn[
     $CellContext`S[4, 
      C[3]], {
      $CellContext`S[4, Q3`$]}], "Label" -> Subsuperscript["Z", 4, 
      Superscript[2, 1]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`ActOn[
     $CellContext`S[4, 
      C[4]], {
      $CellContext`S[4, Q3`$]}], "Label" -> Subsuperscript["Z", 4, 
      Superscript[2, 0]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   Q3`ControlledGate[{$CellContext`S[2, Q3`$] -> 1}, 
    Q3`ActOn[
     $CellContext`S[3, 
      C[2]], {
      $CellContext`S[3, Q3`$]}], "Label" -> Subsuperscript["Z", 3, 
      Superscript[2, 1]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`ActOn[
     $CellContext`S[3, 
      C[3]], {
      $CellContext`S[3, Q3`$]}], "Label" -> Subsuperscript["Z", 3, 
      Superscript[2, 0]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1}, 
    Q3`ActOn[
     $CellContext`S[2, 
      C[2]], {
      $CellContext`S[2, Q3`$]}], "Label" -> Subsuperscript["Z", 2, 
      Superscript[2, 0]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[1, 6]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->1213466063,ExpressionUUID->"4483a154-c6ef-4f5f-bf3b-a497513db60a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "bdf5376d-e7ee-4b40-b51c-785b55a9abc7"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1173790184,ExpressionUUID->"54c46780-8467-4f2a-94ca-5b6587247835"],

Cell["Check that all those quantum circuits are equivalent.", "ExampleText",
 CellID->474132855,ExpressionUUID->"c1b4ecd0-dded-4703-be0f-0c17613551ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "alt", "]"}], "-", 
   RowBox[{"Matrix", "[", "qft", "]"}]}], "//", "SimplifyThrough"}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->1010417736,ExpressionUUID->"ea3e77b4-557a-485f-a68f-5d1c52d6af83"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
j4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+KD11x
AE6CroQ=
              "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, AxesStyle -> {}, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, AxesStyle -> Large, FrameStyle -> 
             Large, ImageSize -> Large, PlotRangePadding -> Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
j4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+KD11x
AE6CroQ=
              "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, AxesStyle -> {}, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, AxesStyle -> Large, FrameStyle -> 
             Large, ImageSize -> Large, PlotRangePadding -> Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["None", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {16, 16}, 0, {
   1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[1]=",
 CellID->379586113,ExpressionUUID->"5a9d1548-12f1-45ef-a78a-7d10d8c55bcc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "mint", "]"}], "-", 
   RowBox[{"Matrix", "[", "qft", "]"}]}], "//", "SimplifyThrough"}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->157150094,ExpressionUUID->"0cf0a029-20de-44a5-aa17-7bf80f962782"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
j4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+KD11x
AE6CroQ=
              "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, AxesStyle -> {}, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, AxesStyle -> Large, FrameStyle -> 
             Large, ImageSize -> Large, PlotRangePadding -> Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
j4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+KD11x
AE6CroQ=
              "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, AxesStyle -> {}, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, AxesStyle -> Large, FrameStyle -> 
             Large, ImageSize -> Large, PlotRangePadding -> Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["None", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {16, 16}, 0, {
   1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[2]=",
 CellID->1681551622,ExpressionUUID->"94108e53-ddc8-41a5-8d34-905a205f5c95"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "more", "]"}], "-", 
   RowBox[{"Matrix", "[", "qft", "]"}]}], "//", "SimplifyThrough"}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1358471741,ExpressionUUID->"d9fdc48b-04af-4800-9fb4-2d140085466d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
j4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+KD11x
AE6CroQ=
              "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, AxesStyle -> {}, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, AxesStyle -> Large, FrameStyle -> 
             Large, ImageSize -> Large, PlotRangePadding -> Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
j4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+KD11x
AE6CroQ=
              "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, AxesStyle -> {}, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, AxesStyle -> Large, FrameStyle -> 
             Large, ImageSize -> Large, PlotRangePadding -> Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["None", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {16, 16}, 0, {
   1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->470067496,ExpressionUUID->"f78e2cda-b045-487a-b165-27fd49a916c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "else", "]"}], "-", 
   RowBox[{"Matrix", "[", "qft", "]"}]}], "//", "SimplifyThrough"}]], "Input",\

 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1884554242,ExpressionUUID->"5e7cb08c-f5c8-4587-b3b4-98640ad197de"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
j4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+KD11x
AE6CroQ=
              "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, AxesStyle -> {}, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, AxesStyle -> Large, FrameStyle -> 
             Large, ImageSize -> Large, PlotRangePadding -> Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGAQgGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPio+K
j4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+Kj4qPio+KD11x
AE6CroQ=
              "], {{0, 0}, {16, 16}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, AxesStyle -> {}, Frame -> False, 
             FrameLabel -> {None, None}, FrameStyle -> Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, AxesStyle -> Large, FrameStyle -> 
             Large, ImageSize -> Large, PlotRangePadding -> Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"16", ",", "16"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["None", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {16, 16}, 0, {
   1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->107957891,ExpressionUUID->"1ed59fb0-2044-4061-8950-2b254c135497"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "4"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{14., {0.45000000000000107`, 13.549999999999999`}}]],
  ExpressionUUID->"86ae9a2b-6b61-40c1-9f45-6b865cdd09ab"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"1c930a7e-ba23-44a9-b02d-9e246887b421"],
 "Properties & Relations",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "19d65d9a-8ce7-49a8-b90c-087aaf1880c0"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1013844522,ExpressionUUID->"f4c471a8-7f9a-49b6-b888-d0d6cd569a9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->2123085903,ExpressionUUID->"081b0d9e-5e76-4c8e-a9b7-6d86f67558ef"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->1886460350,ExpressionUUID->"f22a14d0-79d5-4eb4-a91f-bbf38ca63258"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`S[4, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->109367173,ExpressionUUID->"040d2a65-e960-4b69-adcc-fa6508c9a21f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QFT", "[", "SS", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->1903667663,ExpressionUUID->"2e6956b9-9195-4fd0-ac05-d371808abdf1"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1337428728,ExpressionUUID->"85f104ee-7b3c-4fe5-8758-011dd3a34f73"]
}, Open  ]],

Cell["QFT gives QCR when squared.", "ExampleText",
 CellID->1569566381,ExpressionUUID->"39c098be-df66-4967-a470-72fee167176e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"op", "**", "op"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1815418686,ExpressionUUID->"7bef7c0c-0c76-4158-b9e0-2046d9e1b28a"],

Cell[BoxData[
 RowBox[{"QCR", "[", 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`S[1, Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`S[2, Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "3"},
       "RowWithSeparators"]],
     $CellContext`S[3, Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "4"},
       "RowWithSeparators"]],
     $CellContext`S[4, Q3`$]]}], "}"}], "]"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->2132519975,ExpressionUUID->"d50e80f4-3fc0-4933-9058-602f34ba3e75"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dagger", "[", "op", "]"}], "**", 
  RowBox[{"Dagger", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[5]:=",
 CellID->2111279117,ExpressionUUID->"1a26388c-d543-40ff-af90-94e46a71b630"],

Cell[BoxData[
 RowBox[{"QCR", "[", 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`S[1, Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`S[2, Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "3"},
       "RowWithSeparators"]],
     $CellContext`S[3, Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "4"},
       "RowWithSeparators"]],
     $CellContext`S[4, Q3`$]]}], "}"}], "]"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1733058325,ExpressionUUID->"38e185b8-3cbf-452b-b861-bf5142b7959f"]
}, Open  ]],

Cell["QFT multiplied by QCR gives the inverse QFT.", "ExampleText",
 CellID->2085376287,ExpressionUUID->"c35ec9c9-5461-405c-9133-2972571e214b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "**", "op"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->188361022,ExpressionUUID->"b48090df-712f-4e83-857f-64d88d1290d0"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->596397698,ExpressionUUID->"fd41461e-e8f6-4e41-ad33-74c9437d6978"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "**", "new"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->1415710222,ExpressionUUID->"18371545-af24-446e-9537-dcd072744bd2"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->2066818149,ExpressionUUID->"53ae4454-6829-49b6-a09d-6486a7aa4fc4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "**", 
  RowBox[{"Dagger", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[8]:=",
 CellID->1426344580,ExpressionUUID->"360b4f70-7df8-40c2-82da-db79580681a5"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1022337805,ExpressionUUID->"7186fab3-1ca9-4bbd-b4c6-1a8aa23994a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dagger", "[", "op", "]"}], "**", "new"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[9]:=",
 CellID->1919659908,ExpressionUUID->"19d83d9b-c822-45ea-885f-8ed7a18230df"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->154341714,ExpressionUUID->"fb17eb0c-43ee-454d-8db3-362db34d040e"]
}, Open  ]],

Cell[TextData[{
 "The above property is summarized as follows in terms of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["MultiplyPower"]], "paclet:Q3/ref/MultiplyPower", 
    "Q3 Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "8a5e2caa-4775-43e0-b0df-e444121aa186"],
 "."
}], "ExampleText",
 CellID->906316646,ExpressionUUID->"96506d18-5c76-498f-a129-5c72686be401"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"MultiplyPower", "[", 
    RowBox[{"op", ",", "k"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "12"}], "}"}]}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[10]:=",
 CellID->792357102,ExpressionUUID->"8949ff53-4bcc-418d-9299-5365070fbe29"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", "1", 
   ",", 
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", "1", 
   ",", 
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", "1"}], 
  "}"}]], "Output",
 CellLabel->"Out[10]=",
 CellID->1268867185,ExpressionUUID->"c8f14b03-2d90-4b33-822d-3c73735f6277"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"MultiplyPower", "[", 
    RowBox[{
     RowBox[{"Dagger", "@", "op"}], ",", "k"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "12"}], "}"}]}], "]"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[11]:=",
 CellID->1604847720,ExpressionUUID->"c3079611-9f4e-4711-b040-bc3f4fa375bf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", "1", 
   ",", 
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", "1", 
   ",", 
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, Q3`$]]}], "}"}], ",", "False"}], "]"}], ",", "1"}], 
  "}"}]], "Output",
 CellLabel->"Out[11]=",
 CellID->1708121042,ExpressionUUID->"2670eb84-e160-4562-920c-09f4fe95a472"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "4"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QBR"]], "paclet:Q3/ref/QBR", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "3dd0de52-ce4c-4377-9c7f-4d65be9d93c7"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QCR"]], "paclet:Q3/ref/QCR", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "19cb73be-0721-41dc-b68b-c460336208e9"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ControlledPower"]], "paclet:Q3/ref/ControlledPower", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "7245e2d6-bac2-4b90-9162-0e5b9eaa4055"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CNOT"]], "paclet:Q3/ref/CNOT", "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "65c1b3b7-b887-41fe-bc17-32c112558e7c"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Hadamard"]], "paclet:Q3/ref/Hadamard", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "adfbb4ee-70da-4345-ae3e-c1ac3563f42a"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Fourier"]], "paclet:ref/Fourier"},
          "RefLink",
          BaseStyle->{"InlineFormula"}]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "7b1a8889-54b1-4c82-a151-836ee904670b"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FourierMatrix"]], "paclet:ref/FourierMatrix"},
          "RefLink",
          BaseStyle->{"InlineFormula"}]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "5ed9949c-07cc-440c-a43c-bfa72267acc3"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["MultiplyPower"]], "paclet:Q3/ref/MultiplyPower", 
           "Q3 Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "9738d066-aa1a-4811-8e3d-12cb8b7f924d"]
       }], "SeeAlso",ExpressionUUID->"f9f9c123-e2ef-4574-958d-5ce30b2814c1"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"c0863df3-889e-436d-b086-\
6583a4976160"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Fourier Transform"]], 
           "paclet:Q3/tutorial/QuantumFourierTransform"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "39ea5bdc-48db-4983-801c-245ba374bef2"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "38875bc5-d6c7-4b50-8f1b-2bc17df9c0af"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quick Quantum Computing with Q3"]], 
           "paclet:Q3/tutorial/QuickQuantumComputingWithQ3"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "e5a5af26-e428-4a01-a473-bf5fc368b111"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], "paclet:Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "176cb419-42a0-4fb3-a572-a14187414082"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"fd82da98-f4cc-4406-b0ca-\
a947c4876728"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {27., 33.}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "5673f276-b2a2-4e68-8aa6-d03c83648d84"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3"]], "paclet:Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "4c1d1e9f-3da0-4c7f-acd3-3e6e970ba1bc"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"c8909d51-989c-4483-a424-\
2873c2ee0043"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "5d410614-e959-4090-ad61-9e48db431529"]}]],ExpressionUUID->
         "eba44edc-1839-46af-bd09-db2ff23b8f8e"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "RelatedLinks",ExpressionUUID->
        "e5e695df-f288-4946-be73-341a07d82ed7"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "f2e60a05-ac6f-4577-a1fe-73e556e65623"]}]],ExpressionUUID->
         "0ed31dac-da73-4424-aade-578a4a7dd44b"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "25cbf31d-d2ce-4be9-a947-1980dfc2e048"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"cb7436ff-a40a-48d0-aef6-\
8e83f59be3cc"],

Cell[" ", "FooterCell",ExpressionUUID->"de00574b-195f-490c-add1-f53230a3c1fa"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"QFT",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {
     "0" -> Open, "1" -> Closed, "3" -> Closed, "4" -> Closed}, 
    "AllOptsTable" -> Closed, "NotesSection" -> Closed}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2024, 3, 18, 10, 54, 16.269371}", 
    "history" -> {"13", "14.0", "", ""}, "context" -> "Q3`", 
    "keywords" -> {"quantum Fourier transform"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> "Q3 Symbol", 
    "language" -> "en", "paclet" -> "Q3", "status" -> "None", "summary" -> 
    "QFT[{s1, s2, ...}] represents the quantum Fourier transform on the \
qubits {s1, s2, ...}. QFT[type, {s1, s2, ...}, flag] is the full form of QFT, \
where type = \\[PlusMinus]1 indicates the Fourier or inverse Fourier \
transform and flag specifies whether the QFT is evaluated by using exact \
(False) or numerical (True) values.", "synonyms" -> {}, "tabletags" -> {}, 
    "title" -> "QFT", "titlemodifier" -> "", "metadescription" -> "", 
    "windowtitle" -> "QFT", "type" -> "Symbol", "uri" -> "Q3/ref/QFT"}},
CellContext->"Global`",
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.0 for Mac OS X ARM (64-bit) (December 12, 2023)", 
  StyleDefinitions -> "Default.nb"],
ExpressionUUID->"cabef905-9283-4a27-9ded-790aa132e34e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[23102, 662, 1391, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"52550999-7584-46a9-afd1-ed5e5c5f4b42",
   CellTags->"PrimaryExamplesSection",
   CellID->2030682492]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 389690, 10550}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[575, 21, 8163, 193, 57, "AnchorBarGrid",ExpressionUUID->"d26352aa-ef40-4e3f-a801-46e228dec5b9",
 CellID->1],
Cell[8741, 216, 85, 0, 23, "ContextNameCell",ExpressionUUID->"6b92d76a-bb7d-48ba-955f-d4733e2670cc"],
Cell[CellGroupData[{
Cell[8851, 220, 1166, 31, 60, "ObjectNameGrid",ExpressionUUID->"c618ceb8-2320-4fb6-9d68-b012685ab909"],
Cell[10020, 253, 3531, 98, 218, "Usage",ExpressionUUID->"b7595cb7-c20a-4366-a99c-02ce604eda2e",
 CellID->1825953146]
}, Open  ]],
Cell[CellGroupData[{
Cell[13588, 356, 1899, 47, 37, "NotesSection",ExpressionUUID->"d2e4198b-5e9e-48f2-a779-e5e6957c8bca",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->2099433986],
Cell[15490, 405, 2984, 98, 70, "Notes",ExpressionUUID->"71a33d32-aa75-43aa-94ab-b4c3f3f9e402",
 CellID->59811791],
Cell[18477, 505, 724, 21, 70, "Notes",ExpressionUUID->"ab33e735-61eb-45e6-a5eb-9d98663e846e",
 CellID->1585121827],
Cell[19204, 528, 1007, 33, 70, "Notes",ExpressionUUID->"0544a0f0-e3f1-47cb-94bb-28e579d2c76d",
 CellID->1475780666],
Cell[20214, 563, 980, 32, 70, "Notes",ExpressionUUID->"6ccc5191-a7f9-4f5e-915b-c3252c64ddfb",
 CellID->2122196282],
Cell[21197, 597, 849, 26, 70, "Notes",ExpressionUUID->"3aa52baf-8205-4a7a-b246-ba2149e09c6c",
 CellID->1817891589],
Cell[22049, 625, 926, 31, 70, "Notes",ExpressionUUID->"d4e38c37-4215-420f-99d3-64f49ad738ce",
 CellID->1697654462]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[23102, 662, 1391, 37, 36, "PrimaryExamplesSection",ExpressionUUID->"52550999-7584-46a9-afd1-ed5e5c5f4b42",
 CellTags->"PrimaryExamplesSection",
 CellID->2030682492],
Cell[24496, 701, 192, 3, 31, "Input",ExpressionUUID->"c8547e70-b57a-4fbb-b127-201722c9b802",
 CellID->1420320264],
Cell[CellGroupData[{
Cell[24713, 708, 1368, 36, 31, "ExampleSection",ExpressionUUID->"4069bdf8-4986-43c3-851f-51eadc706919",
 CellID->1870524920],
Cell[26084, 746, 150, 1, 38, "ExampleText",ExpressionUUID->"4a9d29c2-2995-4456-98e4-7c083afd8e7a",
 CellID->324198160],
Cell[26237, 749, 209, 5, 29, "Input",ExpressionUUID->"ab07a624-d961-408f-83b2-a9504e164be7",
 CellID->1417611086],
Cell[26449, 756, 177, 3, 38, "ExampleText",ExpressionUUID->"76847994-3de9-4b1a-b2dc-bdf797e98412",
 CellID->1975652896],
Cell[CellGroupData[{
Cell[26651, 763, 329, 9, 48, "Input",ExpressionUUID->"c4fabfb5-43df-496f-9df6-eb0963679e60",
 CellID->1538344178],
Cell[26983, 774, 596, 19, 37, "Output",ExpressionUUID->"6085b7cc-9e5b-48bb-ac0d-29f2f2926913",
 CellID->1761624115]
}, Open  ]],
Cell[27594, 796, 116, 1, 38, "ExampleText",ExpressionUUID->"84792339-fcf7-4b68-ab68-6e84c4bb3b30",
 CellID->1011065769],
Cell[CellGroupData[{
Cell[27735, 801, 206, 5, 29, "Input",ExpressionUUID->"68ac6481-ce27-4155-a91a-cda53486b8ed",
 CellID->907845956],
Cell[27944, 808, 696, 21, 37, "Output",ExpressionUUID->"7bba8627-f0a3-4d0a-b8a4-0e4b91123933",
 CellID->1620497082]
}, Open  ]],
Cell[28655, 832, 151, 1, 38, "ExampleText",ExpressionUUID->"514fc95d-a9cc-407e-afbb-b581528f5d59",
 CellID->532983359],
Cell[CellGroupData[{
Cell[28831, 837, 215, 5, 29, "Input",ExpressionUUID->"ebfd7d2c-5acc-4aab-a75b-0cf40d2c45a5",
 CellID->1463562962],
Cell[29049, 844, 18789, 485, 157, "Output",ExpressionUUID->"d2ac3f52-6607-4484-9d6e-6ac66626fecf",
 CellID->1012147265]
}, Open  ]],
Cell[CellGroupData[{
Cell[47875, 1334, 187, 4, 70, "Input",ExpressionUUID->"63df80e0-9d28-43f4-b98b-bfd9035d8c08",
 CellID->1164635486],
Cell[48065, 1340, 7057, 241, 179, "Output",ExpressionUUID->"e957407a-e512-401e-af96-5ecec43d7cd5",
 CellID->490340856]
}, Open  ]],
Cell[55137, 1584, 144, 1, 70, "ExampleText",ExpressionUUID->"bf2bacb1-c641-480a-9132-c95e7823a3b2",
 CellID->1728281487],
Cell[CellGroupData[{
Cell[55306, 1589, 210, 5, 70, "Input",ExpressionUUID->"6da7d05e-b283-4db4-8bc5-c0019a29c2c6",
 CellID->738769794],
Cell[55519, 1596, 714, 22, 37, "Output",ExpressionUUID->"9139c06f-edf0-4395-af7c-faa12f711585",
 CellID->248351781]
}, Open  ]],
Cell[CellGroupData[{
Cell[56270, 1623, 178, 4, 70, "Input",ExpressionUUID->"90056a9e-0c63-462e-bbe4-b9e89807c16d",
 CellID->697008013],
Cell[56451, 1629, 126, 2, 37, "Output",ExpressionUUID->"6ba2787e-d315-491f-b457-fd17308f732a",
 CellID->579309606]
}, Open  ]],
Cell[56592, 1634, 146, 1, 70, "ExampleText",ExpressionUUID->"d60b914a-40b7-4474-81ee-328ea7a6ba36",
 CellID->1338994217],
Cell[CellGroupData[{
Cell[56763, 1639, 294, 7, 70, "Input",ExpressionUUID->"72b05790-18f2-4966-bff4-ac2fa18751d5",
 CellID->1065133665],
Cell[57060, 1648, 12066, 345, 300, "Output",ExpressionUUID->"3f0a21f1-80fd-4e24-9106-484eb03e9ae9",
 CellID->477651687]
}, Open  ]],
Cell[69141, 1996, 468, 13, 70, "ExampleText",ExpressionUUID->"8014522f-bb96-456b-8989-4572d7d15d5b",
 CellID->21662866],
Cell[CellGroupData[{
Cell[69634, 2013, 300, 7, 70, "Input",ExpressionUUID->"4294494d-87b9-49c5-ac25-18c8826ca9f4",
 CellID->1935243801],
Cell[69937, 2022, 8314, 291, 300, "Output",ExpressionUUID->"e3e44e7b-4acf-4915-b553-1decf6ef7b98",
 CellID->474367223]
}, Open  ]],
Cell[CellGroupData[{
Cell[78288, 2318, 213, 5, 70, "Input",ExpressionUUID->"cfecac25-1b32-4bfe-ad59-4e95e3bf5a0e",
 CellID->1610672650],
Cell[78504, 2325, 936, 23, 168, "Output",ExpressionUUID->"0d4d3b9e-7d84-4c43-b709-91b57ee61aed",
 CellID->1354191826]
}, Open  ]],
Cell[CellGroupData[{
Cell[79477, 2353, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"5ffa28af-ede9-4f1e-9a39-955a309c658c",
 CellID->566965640],
Cell[79722, 2360, 123, 1, 70, "ExampleText",ExpressionUUID->"c1543c27-cf0e-4dc4-b9c3-51e3923ffb07",
 CellID->916988046],
Cell[CellGroupData[{
Cell[79870, 2365, 439, 13, 70, "Input",ExpressionUUID->"2fbd3b36-f16b-48cf-94a4-a6da2692cc52",
 CellID->512764678],
Cell[80312, 2380, 2216, 54, 41, "Output",ExpressionUUID->"c4fe0571-f3af-478e-b933-168cd6c95894",
 CellID->847453479]
}, Open  ]],
Cell[82543, 2437, 131, 1, 70, "ExampleText",ExpressionUUID->"dc6fd1dd-6d2f-4ded-8598-49f2cbda1d2e",
 CellID->801708978],
Cell[CellGroupData[{
Cell[82699, 2442, 203, 5, 70, "Input",ExpressionUUID->"cf09ad5c-bdda-4df4-8307-4cc2efaba726",
 CellID->1459809595],
Cell[82905, 2449, 8714, 225, 111, "Output",ExpressionUUID->"557a6781-9e4a-4117-abd5-e3066f576909",
 CellID->855628123]
}, Open  ]],
Cell[91634, 2677, 311, 5, 70, "ExampleText",ExpressionUUID->"59362261-11a1-4b57-b76c-4f6c8b9e8b78",
 CellID->358410394],
Cell[CellGroupData[{
Cell[91970, 2686, 291, 7, 70, "Input",ExpressionUUID->"807d78d0-fc68-4d8c-899f-92d0c92f28bc",
 CellID->1154479820],
Cell[92264, 2695, 1433, 51, 65, "Output",ExpressionUUID->"cfa07b1a-2b5e-40e8-a2c5-59e5cca74732",
 CellID->1566050306]
}, Open  ]],
Cell[CellGroupData[{
Cell[93734, 2751, 315, 8, 70, "Input",ExpressionUUID->"300fe4b3-7285-411c-8b0f-00f95571f4b4",
 CellID->618910181],
Cell[94052, 2761, 265, 6, 37, "Output",ExpressionUUID->"669bcc39-f71f-4e55-a386-65a634b7f6b7",
 CellID->378176715]
}, Open  ]],
Cell[CellGroupData[{
Cell[94354, 2772, 283, 7, 70, "Input",ExpressionUUID->"dceb7ebe-3735-40ce-9abf-07a3cbfd8ef8",
 CellID->1134493565],
Cell[94640, 2781, 1915, 65, 67, "Output",ExpressionUUID->"ad228ff3-763e-441a-98d2-1b5672e876db",
 CellID->1512170489]
}, Open  ]],
Cell[CellGroupData[{
Cell[96592, 2851, 242, 7, 70, "Input",ExpressionUUID->"a777b814-b6db-43a0-bdf9-ecb123309f98",
 CellID->2095659547],
Cell[96837, 2860, 238, 6, 37, "Output",ExpressionUUID->"8268fc87-e105-4b9c-99c8-86a6301384dd",
 CellID->1977271999]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97124, 2872, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"f6d841c7-487c-413d-8cb0-e0a332da4d74",
 CellID->633346104],
Cell[97369, 2879, 295, 5, 70, "ExampleText",ExpressionUUID->"55f30075-b386-4625-8325-6c02c4b3d49f",
 CellID->1225739319],
Cell[CellGroupData[{
Cell[97689, 2888, 224, 5, 70, "Input",ExpressionUUID->"eb210030-fade-4798-bc19-6a4e68a7879b",
 CellID->1645416489],
Cell[97916, 2895, 695, 21, 37, "Output",ExpressionUUID->"e3da8d6f-68ae-4475-8d6d-2e3aab429b81",
 CellID->2135236142]
}, Open  ]],
Cell[CellGroupData[{
Cell[98648, 2921, 205, 5, 70, "Input",ExpressionUUID->"424a1c20-28bd-4a4d-8ef0-66bf0b1944ba",
 CellID->511943956],
Cell[98856, 2928, 695, 21, 37, "Output",ExpressionUUID->"d726f274-831c-4762-bdc3-17bc1a56ac51",
 CellID->1279810640]
}, Open  ]],
Cell[CellGroupData[{
Cell[99588, 2954, 190, 4, 70, "Input",ExpressionUUID->"2056186e-681d-4cee-98fa-18747d721350",
 CellID->2120710401],
Cell[99781, 2960, 18890, 447, 129, "Output",ExpressionUUID->"10d0cc1f-2997-4b0f-bb48-e2ecd8a48278",
 CellID->179315387]
}, Open  ]],
Cell[CellGroupData[{
Cell[118708, 3412, 220, 5, 70, "Input",ExpressionUUID->"d6ee0432-7133-46d7-b681-d004efa070cb",
 CellID->1149083753],
Cell[118931, 3419, 11024, 219, 168, "Output",ExpressionUUID->"af2bb6b4-1d8a-4f35-a6fe-b5cac2309b20",
 CellID->767691049]
}, Open  ]],
Cell[CellGroupData[{
Cell[129992, 3643, 208, 5, 70, "Input",ExpressionUUID->"7e425e99-3624-415e-9635-3e1dfb3e4343",
 CellID->860433650],
Cell[130203, 3650, 8527, 206, 81, "Output",ExpressionUUID->"e3c33ab2-44b3-4251-9e4c-68fa962af1e9",
 CellID->776917137]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138779, 3862, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"df910006-986f-4e0d-ad2b-d9743935cde1",
 CellID->1755184417],
Cell[139025, 3869, 150, 1, 70, "ExampleText",ExpressionUUID->"a35cf276-edd4-4a0b-877e-a405cc8fac9f",
 CellID->182857608],
Cell[CellGroupData[{
Cell[139200, 3874, 211, 5, 70, "Input",ExpressionUUID->"4b4b8c17-bc51-427a-afc1-4ee540e40c1e",
 CellID->2015855374],
Cell[139414, 3881, 715, 22, 37, "Output",ExpressionUUID->"52d600d1-22c2-4e8a-b937-a56009f3b6fc",
 CellID->1391211005]
}, Open  ]],
Cell[CellGroupData[{
Cell[140166, 3908, 190, 4, 70, "Input",ExpressionUUID->"e83f1206-80f2-40c7-8ecc-7bd2dd9fbca7",
 CellID->1813718867],
Cell[140359, 3914, 18787, 485, 157, "Output",ExpressionUUID->"eae98c7f-6b6b-44e4-a5b9-4d3436d10102",
 CellID->28807335]
}, Open  ]],
Cell[CellGroupData[{
Cell[159183, 4404, 179, 4, 70, "Input",ExpressionUUID->"03e2503c-ff07-43fa-95c8-a89689974a57",
 CellID->1457601367],
Cell[159365, 4410, 126, 2, 37, "Output",ExpressionUUID->"2c398958-c300-43c6-9dce-9b5007b51714",
 CellID->612369762]
}, Open  ]],
Cell[CellGroupData[{
Cell[159528, 4417, 179, 4, 70, "Input",ExpressionUUID->"6977030d-3481-4af4-aa84-03550ab9bce1",
 CellID->1455047160],
Cell[159710, 4423, 126, 2, 37, "Output",ExpressionUUID->"136269e6-0948-457e-824a-ea6f51be339d",
 CellID->806353398]
}, Open  ]],
Cell[CellGroupData[{
Cell[159873, 4430, 295, 7, 70, "Input",ExpressionUUID->"0fcf4b00-1ac3-451c-ae58-6774e1468bca",
 CellID->1456139501],
Cell[160171, 4439, 12066, 345, 300, "Output",ExpressionUUID->"5c291e36-1370-445d-95d9-d4d5c846f422",
 CellID->494727356]
}, Open  ]],
Cell[CellGroupData[{
Cell[172274, 4789, 254, 7, 70, "Input",ExpressionUUID->"8cdc2857-346c-4198-9e04-1390dd0982c7",
 CellID->1935546351],
Cell[172531, 4798, 1085, 27, 168, "Output",ExpressionUUID->"8d12d4c3-c595-4529-a786-ab375de4b2cf",
 CellID->1564112758]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[173665, 4831, 241, 5, 70, "ExampleDelimiter",ExpressionUUID->"6c3c447b-1a3f-4b18-ab9d-59402d037e86",
 CellID->16769557],
Cell[173909, 4838, 169, 3, 70, "ExampleText",ExpressionUUID->"8846e7ce-17b4-4217-8818-fbf582a50496",
 CellID->525586742],
Cell[CellGroupData[{
Cell[174103, 4845, 217, 5, 70, "Input",ExpressionUUID->"e42c1435-6ee1-429b-a3ae-2127427eb28c",
 CellID->776477862],
Cell[174323, 4852, 1003, 26, 143, "Output",ExpressionUUID->"a1b6a87d-1dac-4d8d-b203-8cc0aeac8c97",
 CellID->666228083]
}, Open  ]],
Cell[CellGroupData[{
Cell[175363, 4883, 220, 5, 70, "Input",ExpressionUUID->"fb3d1699-eaf2-4080-b63e-5622486d239d",
 CellID->1626305766],
Cell[175586, 4890, 1041, 27, 143, "Output",ExpressionUUID->"18196699-75e4-4775-acb4-9be8ecd1e0b1",
 CellID->571907925]
}, Open  ]],
Cell[176642, 4920, 816, 26, 70, "ExampleText",ExpressionUUID->"95449b50-b878-4017-9a61-a733f91d056a",
 CellID->1382320030],
Cell[CellGroupData[{
Cell[177483, 4950, 211, 5, 70, "Input",ExpressionUUID->"3f3800e5-4732-4c4c-8f41-fb34cffa5f6c",
 CellID->1879716809],
Cell[177697, 4957, 4284, 107, 143, "Output",ExpressionUUID->"e3fb05d8-6c73-4d55-ac19-756d56a7b579",
 CellID->1643730571]
}, Open  ]],
Cell[CellGroupData[{
Cell[182018, 5069, 213, 5, 70, "Input",ExpressionUUID->"29b4afc6-c272-418d-9259-70838c630197",
 CellID->1850064624],
Cell[182234, 5076, 4451, 109, 143, "Output",ExpressionUUID->"4fcb9a04-961d-4cae-b6d4-320820146915",
 CellID->776524665]
}, Open  ]],
Cell[186700, 5188, 203, 4, 70, "ExampleText",ExpressionUUID->"d58d3b40-1d0a-4e1b-9534-31c1bd64d849",
 CellID->1011808894],
Cell[CellGroupData[{
Cell[186928, 5196, 215, 5, 70, "Input",ExpressionUUID->"f65281f6-1438-4cd1-9b7e-e32a1fb60363",
 CellID->1094389178],
Cell[187146, 5203, 3824, 98, 143, "Output",ExpressionUUID->"1e5bb95d-a875-46f4-9613-a73aa0eb5d8a",
 CellID->2100194584]
}, Open  ]],
Cell[CellGroupData[{
Cell[191007, 5306, 216, 5, 70, "Input",ExpressionUUID->"a86a34a4-4d3b-4586-aaaa-c32e47875b2b",
 CellID->677643271],
Cell[191226, 5313, 3941, 98, 143, "Output",ExpressionUUID->"6f117363-7488-4544-aeca-f4ac258e4729",
 CellID->1171838818]
}, Open  ]],
Cell[CellGroupData[{
Cell[195204, 5416, 524, 15, 70, "Input",ExpressionUUID->"385adebe-03c0-428c-a451-a56405129d26",
 CellID->1034640886],
Cell[195731, 5433, 1017, 26, 168, "Output",ExpressionUUID->"6fa14693-3de7-4a61-a79d-183d9b8d84cb",
 CellID->1628225877],
Cell[196751, 5461, 1016, 26, 168, "Output",ExpressionUUID->"02d495a9-4508-47de-83d9-1cd2163c19a8",
 CellID->208201018]
}, Open  ]],
Cell[CellGroupData[{
Cell[197804, 5492, 528, 15, 70, "Input",ExpressionUUID->"e3f54f06-86f4-48b1-b542-56bf8c234cdf",
 CellID->2104858351],
Cell[198335, 5509, 1016, 26, 168, "Output",ExpressionUUID->"f5724742-5576-4a0f-8016-61951e6b47b5",
 CellID->399993133],
Cell[199354, 5537, 1017, 26, 168, "Output",ExpressionUUID->"b40fabaa-c40a-41b0-b71b-23f7574fa41e",
 CellID->1060771221]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[200532, 5572, 1394, 36, 70, "ExampleSection",ExpressionUUID->"8605156b-ba54-45b3-ab63-339a1b67d03a",
 CellID->1502926422],
Cell[201929, 5610, 1213, 33, 70, "ExampleText",ExpressionUUID->"8fbf977c-467d-4ba9-8027-a0b5999ddec9",
 CellID->1326551885],
Cell[203145, 5645, 491, 13, 70, "ExampleText",ExpressionUUID->"f35f4b2a-a6f6-4579-89ad-c8b5c52163da",
 CellID->1844377872],
Cell[CellGroupData[{
Cell[203661, 5662, 412, 11, 70, "Input",ExpressionUUID->"a3e1cd74-2155-43db-94c6-e3126ab6052d",
 CellID->750101519],
Cell[204076, 5675, 744, 24, 37, "Output",ExpressionUUID->"81f4f264-6ad2-4786-a57a-f42c22758eeb",
 CellID->2111656846]
}, Open  ]],
Cell[CellGroupData[{
Cell[204857, 5704, 236, 6, 70, "Input",ExpressionUUID->"592affd6-0d38-4f91-9a0f-8d9884969849",
 CellID->1601330061],
Cell[205096, 5712, 852, 26, 37, "Output",ExpressionUUID->"c2f8ab3b-cf97-4ee5-a072-d8f0590b43b3",
 CellID->442197932]
}, Open  ]],
Cell[CellGroupData[{
Cell[205985, 5743, 218, 5, 70, "Input",ExpressionUUID->"64489409-331c-4b26-a4fe-12d6c833c973",
 CellID->1749439152],
Cell[206206, 5750, 1061, 28, 179, "Output",ExpressionUUID->"a4eb4bfa-b2e5-425b-a8d2-75557913e012",
 CellID->1333617970]
}, Open  ]],
Cell[207282, 5781, 141, 1, 70, "ExampleText",ExpressionUUID->"9a072f1c-b4e9-4ad3-978b-a58092b2b72e",
 CellID->1188118867],
Cell[CellGroupData[{
Cell[207448, 5786, 273, 7, 70, "Input",ExpressionUUID->"bf7101b2-e1dc-49be-a510-89bb8455b9e5",
 CellID->1516752790],
Cell[207724, 5795, 116, 1, 70, "EchoTiming",ExpressionUUID->"677c3224-834a-48c6-b25f-b2ec7650e4e4",
 CellID->1675292539]
}, Open  ]],
Cell[CellGroupData[{
Cell[207877, 5801, 269, 7, 70, "Input",ExpressionUUID->"a3a02361-2d16-4016-983d-2187d1090292",
 CellID->2006007153],
Cell[208149, 5810, 116, 1, 70, "EchoTiming",ExpressionUUID->"075a8266-d7c8-4a86-ba6b-b0efb450f118",
 CellID->1847370151]
}, Open  ]],
Cell[208280, 5814, 144, 1, 70, "ExampleText",ExpressionUUID->"3e26f6c8-32e3-46c5-9070-f8566bb202dd",
 CellID->122037108],
Cell[CellGroupData[{
Cell[208449, 5819, 438, 13, 70, "Input",ExpressionUUID->"c60a8af0-9a1f-4726-8a15-d13ee548cc12",
 CellID->82863167],
Cell[208890, 5834, 2794, 67, 41, "Output",ExpressionUUID->"f1ae284c-d6cd-4fd2-904d-357250d83bce",
 CellID->1769826132]
}, Open  ]],
Cell[CellGroupData[{
Cell[211721, 5906, 241, 6, 70, "Input",ExpressionUUID->"e4248438-3c1f-4595-90f1-10b724821956",
 CellID->1043266157],
Cell[211965, 5914, 114, 1, 70, "EchoTiming",ExpressionUUID->"f3dd4fbb-afc2-4cb4-ab4c-c6007e057385",
 CellID->97721547],
Cell[212082, 5917, 22617, 546, 161, "Output",ExpressionUUID->"23edbf9e-bc49-4d52-b73e-a4462151b46c",
 CellID->1728534121]
}, Open  ]],
Cell[CellGroupData[{
Cell[234736, 6468, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"cb194a6e-aabd-4a8d-a09b-4e99f18f0bf8",
 CellID->1166242150],
Cell[234982, 6475, 203, 4, 70, "ExampleText",ExpressionUUID->"a469ee92-71c0-4680-9c9a-899cdf859972",
 CellID->643625537],
Cell[CellGroupData[{
Cell[235210, 6483, 248, 6, 70, "Input",ExpressionUUID->"1240a424-aefc-4450-9dad-7e85e7f2b07c",
 CellID->1791312436],
Cell[235461, 6491, 6043, 149, 179, "Output",ExpressionUUID->"d670a724-9c2f-4f30-8e46-275b15bfc579",
 CellID->265855294]
}, Open  ]],
Cell[241519, 6643, 242, 4, 70, "ExampleText",ExpressionUUID->"196d657a-dd2f-43f1-8225-99d58670f207",
 CellID->562437636],
Cell[241764, 6649, 275, 7, 70, "Input",ExpressionUUID->"df9fa6f4-3f97-4203-b939-e43aea81a1ee",
 CellID->1949985825],
Cell[242042, 6658, 152, 1, 70, "ExampleText",ExpressionUUID->"6b2497d0-b553-45df-908c-fc3925e004a6",
 CellID->1896345337],
Cell[CellGroupData[{
Cell[242219, 6663, 270, 7, 70, "Input",ExpressionUUID->"aa5b3dd5-62da-46c7-8943-76fb36bd0905",
 CellID->803044201],
Cell[242492, 6672, 116, 1, 70, "EchoTiming",ExpressionUUID->"9767a27d-f4f8-4c07-8573-2973382bd95c",
 CellID->1193236200]
}, Open  ]],
Cell[CellGroupData[{
Cell[242645, 6678, 244, 7, 70, "Input",ExpressionUUID->"f3e1d4f6-820a-4dcf-b5cd-47d57b20802d",
 CellID->1911716864],
Cell[242892, 6687, 2179, 51, 304, "Output",ExpressionUUID->"9a07144f-c13c-4299-921c-f8a25fcb54e6",
 CellID->1834369009]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[245120, 6744, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"ab79ab20-554f-41bc-b23e-25d5bfab860c",
 CellID->948568881],
Cell[245365, 6751, 158, 2, 70, "ExampleText",ExpressionUUID->"3a76bcca-06cd-4db7-8ba3-acbf7d37b735",
 CellID->1538911483],
Cell[CellGroupData[{
Cell[245548, 6757, 250, 6, 70, "Input",ExpressionUUID->"f425ed53-8dd7-41cc-8839-9db6906b2881",
 CellID->192250313],
Cell[245801, 6765, 6440, 152, 179, "Output",ExpressionUUID->"ea01d912-5f39-4817-9857-9b33f618b7fa",
 CellID->991024962]
}, Open  ]],
Cell[252256, 6920, 583, 15, 70, "ExampleText",ExpressionUUID->"fc6b02e1-af0a-4c1b-b94f-282a11b0187b",
 CellID->261653958],
Cell[252842, 6937, 274, 7, 70, "Input",ExpressionUUID->"f3a0fea0-0f71-4e71-ab7f-322ecf3d4570",
 CellID->1580018662],
Cell[253119, 6946, 159, 2, 70, "ExampleText",ExpressionUUID->"2aa29afc-88b3-48f1-8106-ec1f2b328303",
 CellID->1596247736],
Cell[CellGroupData[{
Cell[253303, 6952, 271, 7, 70, "Input",ExpressionUUID->"c0643ac6-a5a9-454c-a196-f49f27a65e4c",
 CellID->1611158688],
Cell[253577, 6961, 116, 1, 70, "EchoTiming",ExpressionUUID->"251f82ac-ea79-491f-871c-db6b620a0f41",
 CellID->1545275520]
}, Open  ]],
Cell[CellGroupData[{
Cell[253730, 6967, 244, 7, 70, "Input",ExpressionUUID->"dac8a4af-433b-4f60-b91a-a0cdddda5f39",
 CellID->1119257192],
Cell[253977, 6976, 2179, 51, 304, "Output",ExpressionUUID->"f652ac02-7d9d-4273-b7c4-1bb5fb728305",
 CellID->1784673257]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[256317, 7036, 1401, 36, 70, "ExampleSection",ExpressionUUID->"49f3e93e-0637-4c86-ad2f-891c775a38d3",
 CellID->1895575281],
Cell[257721, 7074, 245, 4, 70, "ExampleText",ExpressionUUID->"24eb90bc-af9e-46cf-bb82-28e65605ef5d",
 CellID->1449669344],
Cell[257969, 7080, 194, 5, 70, "Input",ExpressionUUID->"da3aaaae-bd11-4426-9579-ac6172d4d364",
 CellID->2094919358],
Cell[CellGroupData[{
Cell[258188, 7089, 344, 9, 70, "Input",ExpressionUUID->"88f9c02a-890e-41c7-82ff-ceda489aecb2",
 CellID->1315257341],
Cell[258535, 7100, 744, 24, 37, "Output",ExpressionUUID->"76d5ad56-81a7-4acc-87f6-1eee5ea63e83",
 CellID->1503440133]
}, Open  ]],
Cell[259294, 7127, 115, 1, 70, "ExampleText",ExpressionUUID->"b0552d28-46ba-4415-9ee2-5ff69e123db6",
 CellID->147470073],
Cell[CellGroupData[{
Cell[259434, 7132, 207, 5, 70, "Input",ExpressionUUID->"2b23a954-aa6a-45c7-8d8a-a43444ffb50a",
 CellID->1018341382],
Cell[259644, 7139, 854, 26, 37, "Output",ExpressionUUID->"ced56cf4-db4e-4d06-948e-9d7df4dfac11",
 CellID->1025564886]
}, Open  ]],
Cell[260513, 7168, 139, 1, 70, "ExampleText",ExpressionUUID->"24e94640-dfef-4692-b140-5e6c4e873cb0",
 CellID->271289733],
Cell[CellGroupData[{
Cell[260677, 7173, 210, 5, 70, "Input",ExpressionUUID->"87ae02f0-7200-4973-9b44-9fdaf19d9091",
 CellID->597018216],
Cell[260890, 7180, 5853, 146, 179, "Output",ExpressionUUID->"aed6267f-d97b-4241-8a12-3c671662044c",
 CellID->25844751]
}, Open  ]],
Cell[266758, 7329, 133, 1, 70, "ExampleText",ExpressionUUID->"bd4fdc3c-027d-48c1-a2bd-888654e6bc0f",
 CellID->1395460857],
Cell[CellGroupData[{
Cell[266916, 7334, 188, 4, 70, "Input",ExpressionUUID->"2e7e67f8-e682-44a2-b465-4b0ec62641cd",
 CellID->171881754],
Cell[267107, 7340, 6094, 152, 179, "Output",ExpressionUUID->"de299af3-d7de-42b6-a030-1e2d25fb1b45",
 CellID->1014137880]
}, Open  ]],
Cell[273216, 7495, 310, 5, 70, "ExampleText",ExpressionUUID->"2e2d4059-91e9-4be0-8dd9-068a4d27c37d",
 CellID->1535874996],
Cell[CellGroupData[{
Cell[273551, 7504, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"82a5068f-4f4d-4654-ab26-acab5d9a1406",
 CellID->158760501],
Cell[273796, 7511, 1304, 33, 70, "ExampleText",ExpressionUUID->"8ecde349-6f26-45c6-a379-bb04cda09bab",
 CellID->673555027],
Cell[CellGroupData[{
Cell[275125, 7548, 213, 5, 70, "Input",ExpressionUUID->"5bfac5ab-7335-41df-a014-9662ab9741cf",
 CellID->1212258744],
Cell[275341, 7555, 5855, 146, 179, "Output",ExpressionUUID->"422002f2-6011-4814-9849-074e81f4ad3a",
 CellID->1550834295]
}, Open  ]],
Cell[281211, 7704, 225, 4, 70, "ExampleText",ExpressionUUID->"cb7f5049-d166-4df5-a2a0-107f9aab5d5b",
 CellID->659314118],
Cell[CellGroupData[{
Cell[281461, 7712, 479, 11, 70, "Input",ExpressionUUID->"9c8afebd-9b66-4248-8916-ec37b8a10a57",
 CellID->1732368903],
Cell[281943, 7725, 5854, 146, 179, "Output",ExpressionUUID->"44480497-2833-4e27-9b9e-f404ab9ed738",
 CellID->640638142]
}, Open  ]],
Cell[287812, 7874, 1254, 32, 70, "ExampleText",ExpressionUUID->"de5c0e9a-7a61-46f2-9586-c6735bbfdc7b",
 CellID->597410564],
Cell[CellGroupData[{
Cell[289091, 7910, 250, 6, 70, "Input",ExpressionUUID->"86e88869-b7d7-4753-9766-a9b22176e431",
 CellID->810946710],
Cell[289344, 7918, 6136, 152, 179, "Output",ExpressionUUID->"3ff4ecbd-76c5-4504-b687-6e4a8e3bdea8",
 CellID->858591399]
}, Open  ]],
Cell[295495, 8073, 267, 5, 70, "ExampleText",ExpressionUUID->"83375dc3-cf1a-41f3-9c51-86e149703fe9",
 CellID->544880232],
Cell[CellGroupData[{
Cell[295787, 8082, 254, 6, 70, "Input",ExpressionUUID->"34d7da68-a58b-4cca-8aa3-4381ed167095",
 CellID->1131136971],
Cell[296044, 8090, 6093, 152, 179, "Output",ExpressionUUID->"60245bea-6570-45b5-85ae-288041addce9",
 CellID->496981065]
}, Open  ]],
Cell[302152, 8245, 292, 5, 70, "ExampleText",ExpressionUUID->"1eeeb869-ec0b-46b4-96f4-fb65ab9daad8",
 CellID->1486864925]
}, Open  ]],
Cell[CellGroupData[{
Cell[302481, 8255, 241, 5, 70, "ExampleDelimiter",ExpressionUUID->"4e378bfc-ad4e-4997-9d92-7c7f29d1f9a5",
 CellID->76417801],
Cell[302725, 8262, 292, 8, 70, "ExampleText",ExpressionUUID->"e312bbdd-1848-4d7b-85e0-60ec554f0a3d",
 CellID->2137736558],
Cell[CellGroupData[{
Cell[303042, 8274, 215, 5, 70, "Input",ExpressionUUID->"4f09c144-7789-4f6e-9aaf-f20e45bb1ab9",
 CellID->1543898210],
Cell[303260, 8281, 6136, 152, 179, "Output",ExpressionUUID->"b61b6bfc-7263-4424-a5f2-86ea5fb0569d",
 CellID->427980299]
}, Open  ]],
Cell[CellGroupData[{
Cell[309433, 8438, 313, 8, 70, "Input",ExpressionUUID->"6453e5fe-d71a-4900-bda9-31e30fabf847",
 CellID->1371099242],
Cell[309749, 8448, 8155, 192, 179, "Output",ExpressionUUID->"4483a154-c6ef-4f5f-bf3b-a497513db60a",
 CellID->1213466063]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[317953, 8646, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"54c46780-8467-4f2a-94ca-5b6587247835",
 CellID->1173790184],
Cell[318199, 8653, 151, 1, 70, "ExampleText",ExpressionUUID->"c1b4ecd0-dded-4703-be0f-0c17613551ef",
 CellID->474132855],
Cell[CellGroupData[{
Cell[318375, 8658, 287, 8, 70, "Input",ExpressionUUID->"ea3e77b4-557a-485f-a68f-5d1c52d6af83",
 CellID->1010417736],
Cell[318665, 8668, 8018, 167, 70, "Output",ExpressionUUID->"5a9d1548-12f1-45ef-a78a-7d10d8c55bcc",
 CellID->379586113]
}, Open  ]],
Cell[CellGroupData[{
Cell[326720, 8840, 287, 8, 70, "Input",ExpressionUUID->"0cf0a029-20de-44a5-aa17-7bf80f962782",
 CellID->157150094],
Cell[327010, 8850, 8019, 167, 70, "Output",ExpressionUUID->"94108e53-ddc8-41a5-8d34-905a205f5c95",
 CellID->1681551622]
}, Open  ]],
Cell[CellGroupData[{
Cell[335066, 9022, 288, 8, 70, "Input",ExpressionUUID->"d9fdc48b-04af-4800-9fb4-2d140085466d",
 CellID->1358471741],
Cell[335357, 9032, 8018, 167, 70, "Output",ExpressionUUID->"f78e2cda-b045-487a-b165-27fd49a916c7",
 CellID->470067496]
}, Open  ]],
Cell[CellGroupData[{
Cell[343412, 9204, 288, 8, 70, "Input",ExpressionUUID->"5e7cb08c-f5c8-4587-b3b4-98640ad197de",
 CellID->1884554242],
Cell[343703, 9214, 8018, 167, 70, "Output",ExpressionUUID->"1ed59fb0-2044-4061-8950-2b254c135497",
 CellID->107957891]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, Closed]]]],
Cell[CellGroupData[{
Cell[351882, 9390, 1411, 36, 70, "ExampleSection",ExpressionUUID->"f4c471a8-7f9a-49b6-b888-d0d6cd569a9c",
 CellID->1013844522],
Cell[353296, 9428, 194, 5, 70, "Input",ExpressionUUID->"081b0d9e-5e76-4c8e-a9b7-6d86f67558ef",
 CellID->2123085903],
Cell[CellGroupData[{
Cell[353515, 9437, 344, 9, 70, "Input",ExpressionUUID->"f22a14d0-79d5-4eb4-a91f-bbf38ca63258",
 CellID->1886460350],
Cell[353862, 9448, 743, 24, 37, "Output",ExpressionUUID->"040d2a65-e960-4b69-adcc-fa6508c9a21f",
 CellID->109367173]
}, Open  ]],
Cell[CellGroupData[{
Cell[354642, 9477, 207, 5, 70, "Input",ExpressionUUID->"2e6956b9-9195-4fd0-ac05-d371808abdf1",
 CellID->1903667663],
Cell[354852, 9484, 854, 26, 37, "Output",ExpressionUUID->"85f104ee-7b3c-4fe5-8758-011dd3a34f73",
 CellID->1337428728]
}, Open  ]],
Cell[355721, 9513, 126, 1, 70, "ExampleText",ExpressionUUID->"39c098be-df66-4967-a470-72fee167176e",
 CellID->1569566381],
Cell[CellGroupData[{
Cell[355872, 9518, 203, 5, 70, "Input",ExpressionUUID->"7bef7c0c-0c76-4158-b9e0-2046d9e1b28a",
 CellID->1815418686],
Cell[356078, 9525, 795, 25, 37, "Output",ExpressionUUID->"d50e80f4-3fc0-4933-9058-602f34ba3e75",
 CellID->2132519975]
}, Open  ]],
Cell[CellGroupData[{
Cell[356910, 9555, 244, 6, 70, "Input",ExpressionUUID->"1a26388c-d543-40ff-af90-94e46a71b630",
 CellID->2111279117],
Cell[357157, 9563, 795, 25, 37, "Output",ExpressionUUID->"38e185b8-3cbf-452b-b861-bf5142b7959f",
 CellID->1733058325]
}, Open  ]],
Cell[357967, 9591, 143, 1, 70, "ExampleText",ExpressionUUID->"c35ec9c9-5461-405c-9133-2972571e214b",
 CellID->2085376287],
Cell[CellGroupData[{
Cell[358135, 9596, 178, 4, 70, "Input",ExpressionUUID->"b48090df-712f-4e83-857f-64d88d1290d0",
 CellID->188361022],
Cell[358316, 9602, 872, 27, 37, "Output",ExpressionUUID->"fd41461e-e8f6-4e41-ad33-74c9437d6978",
 CellID->596397698]
}, Open  ]],
Cell[CellGroupData[{
Cell[359225, 9634, 179, 4, 70, "Input",ExpressionUUID->"18371545-af24-446e-9537-dcd072744bd2",
 CellID->1415710222],
Cell[359407, 9640, 873, 27, 37, "Output",ExpressionUUID->"53ae4454-6829-49b6-a09d-6486a7aa4fc4",
 CellID->2066818149]
}, Open  ]],
Cell[CellGroupData[{
Cell[360317, 9672, 212, 5, 70, "Input",ExpressionUUID->"360b4f70-7df8-40c2-82da-db79580681a5",
 CellID->1426344580],
Cell[360532, 9679, 854, 26, 37, "Output",ExpressionUUID->"7186fab3-1ca9-4bbd-b4c6-1a8aa23994a5",
 CellID->1022337805]
}, Open  ]],
Cell[CellGroupData[{
Cell[361423, 9710, 212, 5, 70, "Input",ExpressionUUID->"19d83d9b-c822-45ea-885f-8ed7a18230df",
 CellID->1919659908],
Cell[361638, 9717, 853, 26, 37, "Output",ExpressionUUID->"fb17eb0c-43ee-454d-8db3-362db34d040e",
 CellID->154341714]
}, Open  ]],
Cell[362506, 9746, 471, 13, 70, "ExampleText",ExpressionUUID->"96506d18-5c76-498f-a129-5c72686be401",
 CellID->906316646],
Cell[CellGroupData[{
Cell[363002, 9763, 324, 9, 70, "Input",ExpressionUUID->"8949ff53-4bcc-418d-9299-5365070fbe29",
 CellID->792357102],
Cell[363329, 9774, 7139, 223, 72, "Output",ExpressionUUID->"c8f14b03-2d90-4b33-822d-3c73735f6277",
 CellID->1268867185]
}, Open  ]],
Cell[CellGroupData[{
Cell[370505, 10002, 356, 10, 70, "Input",ExpressionUUID->"c3079611-9f4e-4711-b040-bc3f4fa375bf",
 CellID->1604847720],
Cell[370864, 10014, 7139, 223, 72, "Output",ExpressionUUID->"2670eb84-e160-4562-920c-09f4fe95a472",
 CellID->1708121042]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "4"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[378245, 10246, 4225, 115, 70, "SeeAlsoSection",ExpressionUUID->"c0863df3-889e-436d-b086-6583a4976160"],
Cell[382473, 10363, 1823, 46, 70, "TechNotesSection",ExpressionUUID->"fd82da98-f4cc-4406-b0ca-a947c4876728"],
Cell[384299, 10411, 1045, 27, 70, "MoreAboutSection",ExpressionUUID->"c8909d51-989c-4483-a424-2873c2ee0043"],
Cell[385347, 10440, 2094, 59, 70, "RelatedLinksSection",ExpressionUUID->"cb7436ff-a40a-48d0-aef6-8e83f59be3cc"],
Cell[387444, 10501, 78, 0, 70, "FooterCell",ExpressionUUID->"de00574b-195f-490c-add1-f53230a3c1fa"]
}
]
*)

(* End of internal cache information *)

