(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    446895,      12121]
NotebookOptionsPosition[    408003,      11327]
NotebookOutlinePosition[    410553,      11389]
CellTagsIndexPosition[    410465,      11384]
WindowTitle->QFT
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "54e87fcf-c732-48a0-be42-f86a8ce6f039"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "05435173-eef2-4106-86ed-7fe2db953873"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "f41406ef-4846-4457-91ab-e2f7d2e0c985"]
         }],ExpressionUUID->"d04b0684-3c65-4075-bdef-d367a2c72085"],
         StripOnInput->False],{
        StyleBox["\"Fourier\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:ref/Fourier"], 
         StyleBox[
          "\"FourierMatrix\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:ref/FourierMatrix"], Delimiter, 
         StyleBox[
          "\"Functions\"", "SeeAlsoSection", FontSize -> 14, FontSlant -> 
           "Italic", StripOnInput -> False] :> 
         NotebookFind[EvaluationNotebook[], "SeeAlsoSection", All, CellStyle],
          StyleBox[
          StyleBox["\"QBR\"", "SeeAlsoRelated", StripOnInput -> False], 
           "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/QBR"], 
         StyleBox[
          StyleBox["\"QCR\"", "SeeAlsoRelated", StripOnInput -> False], 
           "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/QCR"], 
         StyleBox[
          StyleBox[
           "\"ControlledPower\"", "SeeAlsoRelated", StripOnInput -> False], 
           "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ControlledPower"],
          StyleBox[
          StyleBox["\"CNOT\"", "SeeAlsoRelated", StripOnInput -> False], 
           "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/CNOT"], 
         StyleBox[
          StyleBox["\"Hadamard\"", "SeeAlsoRelated", StripOnInput -> False], 
           "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/Hadamard"], 
         StyleBox[
          StyleBox[
           "\"MultiplyPower\"", "SeeAlsoRelated", StripOnInput -> False], 
           "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/MultiplyPower"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "017434db-9652-4d78-98a0-4e58af9c30aa"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "99a7af5c-968a-49f1-a06d-85f69bcc8c2f"]
         }],ExpressionUUID->"e6eb4f91-a7b0-40ad-a8e2-524bfddca056"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "a46b2df7-8efc-492f-bcc0-f124f506a786"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "b1cf0e73-98e1-4677-9f75-ce19db4f7fde"]
         }],ExpressionUUID->"6e83e25c-3092-4573-822e-9daf3dc94758"],
         StripOnInput->False],{
        "\"Quantum Fourier Transform\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumFourierTransform"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"], 
         "\"Quick Quantum Computing with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuickQuantumComputingWithQ3"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "c5aa9797-920f-4386-8e95-4f3e5ca2bb14"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "b4f25112-1566-4d99-87d2-1ca3bb39e293"]
         }],ExpressionUUID->"4e8a93f9-8fe3-43cb-88e8-db16e0e91681"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/QFT\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/QFT"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
QFT.html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, 
               Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/QFT") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "de2bf71d-796b-4089-97f1-246e667fd081"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "3076074e-bf6d-4835-8638-110e5b07cd65"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"08373b90-031c-434f-a656-c21ada2224a6"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"dd16ab0e-894b-4a62-8e09-c23bb9316834"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "QFT", "ObjectName",ExpressionUUID->
      "63bac2e1-96bd-47c9-8308-e5e7d4e1d99f"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"4b4a1bfa-e15f-47bb-841f-b3d7f872144a"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "b29a3ea6-158f-4fd1-8caf-d9c1149feffe"]
    }],ExpressionUUID->"c73a8670-f6d2-47c6-915f-6a255facb4e8"], Cell[BoxData[
     StyleBox[
      GraphicsBox[InsetBox[
        StyleBox["\<\"UPDATED IN 14.0\"\>",
         StripOnInput->False,
         FontFamily->"Source Sans Pro",
         FontSize->17,
         FontWeight->"Bold",
         FontSlant->"Italic",
         FontColor->LightDarkSwitched[
           RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
        Right, Center}],
       ImageSize->{125, 24},
       PlotRangePadding->Scaled[0.025]], "NewInGraphic",
      StripOnInput->False]],
     Deployed->True,
     Magnification->1,ExpressionUUID->
     "bce18fc0-5125-4450-832a-3ea1d16c8da6"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"87177906-f997-4643-8946-df222de872e8"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          StyleBox["s", "TI"], 
          StyleBox["1", "TR"]], ",", 
         SubscriptBox[
          StyleBox["s", "TI"], 
          StyleBox["2", "TR"]], ",", "\[Ellipsis]"}], "}"}], "]"}]], 
      "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "d755acb6-c4ae-4d7f-8b30-63da3c4e1a94"],
     "\[LineSeparator]represents the quantum Fourier transform on the qubits ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["2", "TR"]], ",", "\[Ellipsis]"}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "bf449e1e-16c1-4796-8b97-4d35043939c2"],
     "."
    }],ExpressionUUID->"478c2d19-1eaf-44b2-a462-c10522f980ac"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        StyleBox["type", "TI"], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["s", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["s", "TI"], 
           StyleBox["2", "TR"]], ",", 
          StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "44536c7f-1425-44e7-86f6-041c0b673d87"],
     "\[LineSeparator]is the full form of ",
     Cell[BoxData[
      TemplateBox[{
        Cell[
         TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
        "QuantumMob Package Symbol"},
       "PackageLink",
       BaseStyle->"InlineFormula"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "8f4be2c5-2512-45c3-ad75-27f04bb7fab8"],
     ", where ",
     Cell[BoxData[
      RowBox[{
       StyleBox["type", "TI"], "=", 
       RowBox[{"\[PlusMinus]", "1"}]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "97a2c92b-3b3f-4390-be9e-ca440ee656c6"],
     " indicates the Fourier or inverse Fourier transform."
    }],ExpressionUUID->"3408c08c-f705-4db5-aded-6f5cbcbd4c51"]}
  }]], "Usage",
 CellID->1825953146,ExpressionUUID->"1aecc75b-f5f4-4609-a60a-f8542765c121"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[CurrentValue[
         EvaluationCell[], "CellGroupOpen"] =!= Closed, 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"f5556424-12cf-44d7-9ac2-82d4cd069729"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"77e09c54-40bf-4d99-b86b-9ed2db415047"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"a6377984-6600-4bbe-8c00-23580c4bee8b"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"b834fd8f-70df-4dcc-a104-9f2b55bf460f"]], \
"NotesSection",
 ShowGroupOpener->"Thumbnail",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->771775849,ExpressionUUID->"faf298c3-e999-4691-924b-38145d577e3d"],

Cell[TextData[{
 "For a set of orthonormal states ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], ",", 
      TemplateBox[{"1"},
       "Ket"], ",", 
      TemplateBox[{"2"},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        RowBox[{"N", "-", "1"}]},
       "Ket"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "cc47f91a-e135-467b-821a-54612b6a0dbb"],
 ", the quantum Fourier transform (QFT) on ",
 Cell[BoxData[
  FormBox["\[ScriptCapitalB]", TraditionalForm]],ExpressionUUID->
  "26c9ca3e-51e6-4750-a8e5-29265d368488"],
 " is defined by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[{"y"},
     "Ket"], "\[RightTeeArrow]", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["N"]], 
     UnderoverscriptBox["\[CapitalSigma]", 
      RowBox[{"x", "=", "0"}], 
      RowBox[{"N", "-", "1"}]], 
     TemplateBox[{"x"},
      "Ket"], 
     SuperscriptBox["e", 
      RowBox[{
      "2", "\[VeryThinSpace]", "\[Pi]", "\[VeryThinSpace]", "\[ImaginaryI]", "\[VeryThinSpace]",
        "x", "\[VeryThinSpace]", 
       RowBox[{"y", "\[VeryThinSpace]", "/", "\[VeryThinSpace]", "N"}]}]]}]}],
    TraditionalForm]],ExpressionUUID->
  "f7e7e969-6002-426f-b756-114b6598b35c"],
 " ."
}], "Notes",
 CellID->59811791,ExpressionUUID->"49b81dc9-44fc-4061-8403-1481401b57c4"],

Cell[TextData[{
 "Typically, one chooses the computational basis ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], ",", 
      TemplateBox[{"1"},
       "Ket"], ",", 
      TemplateBox[{"2"},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]},
       "Ket"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "1b9262f2-a4c6-43ab-b1ed-600f43bd137d"],
 " for ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "556bccf9-7681-4008-bcbc-8540483f7ffc"],
 " qubits, and ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "9d83ef1f-e160-4c7a-abec-047ccca5a8e6"],
 " indeed assumes ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalB]", "=", 
    RowBox[{"{", 
     RowBox[{
      TemplateBox[{"0"},
       "Ket"], ",", 
      TemplateBox[{"1"},
       "Ket"], ",", 
      TemplateBox[{"2"},
       "Ket"], ",", "\[Ellipsis]", ",", 
      TemplateBox[{
        RowBox[{
          SuperscriptBox["2", "n"], "-", "1"}]},
       "Ket"]}], "}"}]}], TraditionalForm]],ExpressionUUID->
  "27b28dde-88aa-4ddf-9967-aaa0b21b79f1"],
 ". Note, however, that in many applications, one may have ",
 Cell[BoxData[
  FormBox[
   RowBox[{"N", "<", 
    SuperscriptBox["2", "n"]}], TraditionalForm]],ExpressionUUID->
  "65e23ee6-f6f7-41a6-8407-9162d6f8c3be"],
 "."
}], "Notes",
 CellID->1688628346,ExpressionUUID->"af5933f8-a5f5-4cd6-a984-059b715e773c"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Elaborate"]], "paclet:QuantumMob/Q3/ref/Elaborate", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["\[Ellipsis]", "TR"], "]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "64fb95c4-fdc3-4750-82b0-a75259f9b954"],
 " returns the explicit expression of the unitary operator in terms of the \
Pauli operators."
}], "Notes",
 CellID->1585121827,ExpressionUUID->"f44c55d4-f009-405d-8078-03ad12b4598c"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Unfold"]], "paclet:QuantumMob/Q3/ref/Unfold", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", "\[Ellipsis]", "]"}], "]"}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "1b98eb2e-1612-4ef5-9822-ee12c4c945b8"],
 " decomposes ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "20a158e9-d90a-46d4-b00d-a28c995e42db"],
 " into a sequence of Hadamard gates and ",
 ButtonBox["controlled powers",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/ControlledPower"],
 " of  the phase gate ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "k"], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          SubscriptBox["\[Phi]", "k"]}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "97a18a63-1f9a-45a4-b357-b05d94ae902a"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "k"], ":=", 
    FractionBox[
     RowBox[{"2", "\[Pi]"}], 
     SuperscriptBox["2", "k"]]}], TraditionalForm]],ExpressionUUID->
  "5f3cfdf2-59b5-4b87-988f-7d5d16041a7a"],
 "."
}], "Notes",
 CellID->1475780666,ExpressionUUID->"a798d813-c7b2-4c8c-88ce-d08a320c71ae"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["UnfoldAll"]], "paclet:QuantumMob/Q3/ref/UnfoldAll", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", "\[Ellipsis]", "]"}], "]"}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "5c6a3542-03ca-4d60-af98-a819bd07cf47"],
 " decomposes ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7686d426-e1f0-4a7c-b584-4e757180a642"],
 " into a sequence of Hadamard and phase gates ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "k"], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          SubscriptBox["\[Phi]", "k"]}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "7b8f363b-26f2-4c09-b674-fed7617ab1c7"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "k"], ":=", 
    FractionBox[
     RowBox[{"2", "\[Pi]"}], 
     SuperscriptBox["2", "k"]]}], TraditionalForm]],ExpressionUUID->
  "75597b60-c6f6-46a5-a8ed-dd267939ffdc"],
 "."
}], "Notes",
 CellID->2122196282,ExpressionUUID->"2c47c9b6-ce4c-4c45-a76a-a861ca679db5"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Dagger"]], "paclet:QuantumMob/Q3/ref/Dagger", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    RowBox[{
     StyleBox["type", "TI"], ",", "\[Ellipsis]"}], "]"}], "]"}]], 
  "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "728ce6a2-618a-4afb-8da4-e973c4cef02c"],
 " switches ",
 Cell[BoxData[
  StyleBox["type", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f1d62215-c588-4cce-8508-cbc438919ffc"],
 " from 1 to -1 and vice versa."
}], "Notes",
 CellID->1817891589,ExpressionUUID->"0e5cd147-e4ab-41a7-99dd-a51260b3c8da"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "8765db73-5478-4dca-8f00-99484f8bebfe"],
 ", ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Unfold"]], "paclet:QuantumMob/Q3/ref/Unfold", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{
     TemplateBox[{
       Cell[
        TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
       "QuantumMob Package Symbol"},
      "PackageLink",
      BaseStyle->"InlineFormula"], "[", "\[Ellipsis]", "]"}], ",", 
    "\[Ellipsis]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f52d42a6-c25c-4711-b952-1450642a470f"],
 " and ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["UnfoldAll"]], "paclet:QuantumMob/Q3/ref/UnfoldAll", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{
     TemplateBox[{
       Cell[
        TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
       "QuantumMob Package Symbol"},
      "PackageLink",
      BaseStyle->"InlineFormula"], "[", "\[Ellipsis]", "]"}], ",", 
    "\[Ellipsis]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "6f634ac6-a9ef-4159-b8a9-a194cff1a308"],
 " accept the following options:"
}], "Notes",
 CellID->1529489266,ExpressionUUID->"695fb418-99d6-4fe5-9729-3636f10b6e8c"],

Cell[BoxData[GridBox[{
   {Cell["      ", "TableRowIcon",ExpressionUUID->
     "46636464-9ba3-4449-8756-9fe95e063116"], "\"\<Label\>\"", "\"\<QFT\>\"", 
    Cell["\<\
The label of the circuit element in the quantum circuit representation.\
\>", "TableText",ExpressionUUID->"8cc4a48b-be64-4658-9828-e9f756a5dc81"]},
   {Cell["      ", "TableRowIcon",ExpressionUUID->
     "3b3421c7-8576-441f-ab64-dc2e148be380"], "\"\<ApproximationLevel\>\"", 
    TemplateBox[{
      Cell[
       TextData["Full"]], "paclet:ref/Full"},
     "RefLink",
     BaseStyle->{"3ColumnTableMod"}], Cell[
    "An integer parameter specifying the level approximation.", "TableText",
     ExpressionUUID->"5f5e1636-5537-46be-9372-63f3225be010"]},
   {Cell["      ", "TableRowIcon",ExpressionUUID->
     "a7db8148-d0d0-4e7f-afd0-7c1c75c538bf"], "\"\<Numeric\>\"", 
    TemplateBox[{
      Cell[
       TextData["False"]], "paclet:ref/False"},
     "RefLink",
     BaseStyle->{"3ColumnTableMod"}], Cell["\<\
If True, the matrix representation and operator expressions are calculated \
numerically.\
\>", "TableText",ExpressionUUID->"c55b3345-91f6-433d-9a15-7790ca11ec9b"]},
   {Cell["      ", "TableRowIcon",ExpressionUUID->
     "3ebd1268-a196-4322-b767-f227d543a044"], "\"\<Reversed\>\"", 
    TemplateBox[{
      Cell[
       TextData["False"]], "paclet:ref/False"},
     "RefLink",
     BaseStyle->{"3ColumnTableMod"}], Cell["\<\
If True, the circuit elements are reversed in the unfolded form of the \
quantum circuit representation.\
\>", "TableText",ExpressionUUID->"8163a07f-a2a3-45b2-8c5d-10ff7deaf4fc"]},
   {Cell["      ", "TableRowIcon",ExpressionUUID->
     "234395e2-0368-4b69-8e39-9c8ba732698d"], "\"\<Pushed\>\"", 
    TemplateBox[{
      Cell[
       TextData["False"]], "paclet:ref/False"},
     "RefLink",
     BaseStyle->{"3ColumnTableMod"}], Cell["\<\
If True, the controlled-phase gates are pushed as far as possible in the \
unfolded form of the quantum circuit representation.\
\>", "TableText",ExpressionUUID->"f1fd720b-2edc-4c62-8cd7-155b9b06c2d9"]}
  }]], "3ColumnTableMod",
 GridBoxOptions->{
 GridBoxBackground->{
  "Columns" -> {{None}}, "Rows" -> {None, None, None, None, {None}}},
 GridBoxDividers->{"Rows" -> {{True, True, True, True, True, True}}}},
 CellID->230984232,ExpressionUUID->"c28a9fe0-7504-47b6-b069-0ede1e0b4071"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"5c7b2dc8-4479-4680-85d6-4fdd7cb2f3fc"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"902b2dd0-3b9c-41fe-ae0e-8682a874cccb"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(14)", "ExampleCount",ExpressionUUID->
  "92565a02-1627-40ce-aae8-2876c33d17e8"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->435466263,ExpressionUUID->"ffcfa995-ac09-47b2-a3ad-6b16c357efce"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1420320264,ExpressionUUID->"3254928f-5ab4-4c66-b723-24edeb00e059"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"1063a9c5-388c-4eda-886e-5eee2c607fa7"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"b1c70bf9-97ce-4c96-b819-bb20bf8b2993"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(4)", "ExampleCount",ExpressionUUID->
  "b909871e-73e7-4b1e-9306-ba9de1fba4f6"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->257213265,ExpressionUUID->"068c90cf-1f5e-4f46-ba40-839c81ca752f"],

Cell["Pick a symbol to refer to the quantum register with:", "ExampleText",
 CellID->324198160,ExpressionUUID->"c1de3973-d3a4-41d0-b53f-404ba6732740"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1417611086,ExpressionUUID->"235d3657-01d9-4841-a719-38fe6edcd2c1"],

Cell["\<\
Consider the quantum Fourier transformation on a three-qubit register:\
\>", "ExampleText",
 CellID->1975652896,ExpressionUUID->"b09155ae-4529-4544-8deb-f81e73aa0fd6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1538344178,ExpressionUUID->"a4a05a9e-65af-4232-9532-40a10b1682e2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1200018272,ExpressionUUID->"4bfe1430-e1c5-42de-bc1a-e3b335e366f9"]
}, Open  ]],

Cell["Set the operator:", "ExampleText",
 CellID->1011065769,ExpressionUUID->"cadf8be3-5efa-47da-a3fa-2665bbc741c4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QFT", "[", "SS", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->907845956,ExpressionUUID->"57c54469-5e58-47d2-bbb1-ad86bdb34568"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1688168527,ExpressionUUID->"f7fd8eca-68ba-42e1-95cf-96fa65086294"]
}, Open  ]],

Cell["Represent it in the quantum circuit model:", "ExampleText",
 CellID->1487001751,ExpressionUUID->"7e040525-199b-49ac-a39d-577bfe570e7b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->16748836,ExpressionUUID->"5bb14ef2-2936-42ee-87e4-07945b6914e6"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QFT\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`QFT[1, {
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[4]=",
 CellID->494489125,ExpressionUUID->"71821292-aa1c-4e95-91ea-f9150d2efc5e"]
}, Open  ]],

Cell["\<\
Represent it in an unfolded form of quantum circuit using the \
controlled-power and Hadamard gate:\
\>", "ExampleText",
 CellID->484950209,ExpressionUUID->"6271b892-1d77-4c84-95e6-2ffc9e8645f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qft", "=", 
  RowBox[{"Unfold", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->2033637476,ExpressionUUID->"b63f62aa-6abe-42f4-aaec-bd95d327af13"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -1}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -3.4}, {2.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->298.8,
   PlotRange->{{0, 7}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}, 
    $CellContext`S[1, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[3, QuantumMob`Q3`$]}, 
    $CellContext`S[2, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[5]=",
 CellID->117009985,ExpressionUUID->"4c6eeef6-514f-4a03-9da5-fb39a21ac439"]
}, Open  ]],

Cell["\<\
Represent it using more elementary gates, i.e., the controlled-power and \
Hadamard gates:\
\>", "ExampleText",
 CellID->288030098,ExpressionUUID->"200857eb-73d5-4887-a55b-802f8f98c571"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alt", "=", 
  RowBox[{"UnfoldAll", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->362956318,ExpressionUUID->"b50bb193-4d1a-47f0-bb89-1095fc4e3b79"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -3}, {5, -2}}], 
     DiskBox[{5, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -3.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->334.8,
   PlotRange->{{0, 8}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[6]=",
 CellID->1639280890,ExpressionUUID->"b5309a05-684d-4d83-99b5-581dce906eee"]
}, Open  ]],

Cell["Express the operator in terms of the Pauli operators:", "ExampleText",
 CellID->532983359,ExpressionUUID->"7e234375-4902-407d-ac61-f6eb48710bc0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{"Elaborate", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1463562962,ExpressionUUID->"d184610a-7ad4-4bc2-8225-f25156bcfd76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", "8"], "+", 
    FractionBox["\[ImaginaryI]", "8"]}], ")"}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[3, 3]]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 1]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 1]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 1]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[3, 3]]}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1326210867,ExpressionUUID->"ed23321e-8907-4c16-8236-f923dd7f4887"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "//", "PauliForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1164635486,ExpressionUUID->"c76f0f7c-dbc5-426e-9441-a38401dae6bd"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "8"], "+", 
      FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>", 
     "\[CircleTimes]", "\<\"I\"\>"}]}],
   Complex[
    Rational[1, 8], 
    Rational[1, 8]]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>", "\[CircleTimes]", 
     TemplateBox[{"\"Z\""},
      "RowDefault"]}],
    $CellContext`S[3, 3]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", 
     TemplateBox[{"\"X\""},
      "RowDefault"], "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[2, 1]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", 
     TemplateBox[{"\"X\""},
      "RowDefault"], "\[CircleTimes]", 
     TemplateBox[{"\"Z\""},
      "RowDefault"]}],
    QuantumMob`Q3`Multiply[
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", 
     TemplateBox[{"\"Z\""},
      "RowDefault"], "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[2, 3]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", 
     TemplateBox[{"\"Z\""},
      "RowDefault"], "\[CircleTimes]", 
     TemplateBox[{"\"Z\""},
      "RowDefault"]}],
    QuantumMob`Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{
     TemplateBox[{"\"X\""},
      "RowDefault"], "\[CircleTimes]", "\<\"I\"\>", 
     "\[CircleTimes]", "\<\"I\"\>"}],
    $CellContext`S[1, 1]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "+", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{
     TemplateBox[{"\"X\""},
      "RowDefault"], "\[CircleTimes]", "\<\"I\"\>", "\[CircleTimes]", 
     TemplateBox[{"\"Z\""},
      "RowDefault"]}],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{
     TemplateBox[{"\"X\""},
      "RowDefault"], "\[CircleTimes]", 
     TemplateBox[{"\"X\""},
      "RowDefault"], "\[CircleTimes]", "\<\"I\"\>"}],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    RowBox[{
     TemplateBox[{"\"X\""},
      "RowDefault"], "\[CircleTimes]", 
     TemplateBox[{"\"X\""},
      "RowDefault"], "\[CircleTimes]", 
     TemplateBox[{"\"Z\""},
      "RowDefault"]}],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{
     TemplateBox[{"\"X\""},
      "RowDefault"], "\[CircleTimes]", 
     TemplateBox[{"\"Z\""},
      "RowDefault"], "\[CircleTimes]", "\<\"I\"\>"}],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   InterpretationBox[
    RowBox[{
     TemplateBox[{"\"X\""},
      "RowDefault"], "\[CircleTimes]", 
     TemplateBox[{"\"Z\""},
      "RowDefault"], "\[CircleTimes]", 
     TemplateBox[{"\"Z\""},
      "RowDefault"]}],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{
      TemplateBox[{"\"Y\""},
       "RowDefault"], "\[CircleTimes]", "\<\"I\"\>", "\[CircleTimes]", 
      TemplateBox[{"\"Y\""},
       "RowDefault"]}],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{
      TemplateBox[{"\"Y\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"X\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"Y\""},
       "RowDefault"]}],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{
      TemplateBox[{"\"Y\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"Y\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"X\""},
       "RowDefault"]}],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{
      TemplateBox[{"\"Y\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"Z\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"Y\""},
       "RowDefault"]}],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{
      TemplateBox[{"\"Z\""},
       "RowDefault"], "\[CircleTimes]", "\<\"I\"\>", "\[CircleTimes]", 
      TemplateBox[{"\"X\""},
       "RowDefault"]}],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{
      TemplateBox[{"\"Z\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"X\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"X\""},
       "RowDefault"]}],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{
      TemplateBox[{"\"Z\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"Y\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"Y\""},
       "RowDefault"]}],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     RowBox[{
      TemplateBox[{"\"Z\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"Z\""},
       "RowDefault"], "\[CircleTimes]", 
      TemplateBox[{"\"X\""},
       "RowDefault"]}],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]]}]], "Output",
 CellLabel->"Out[8]=",
 CellID->893269456,ExpressionUUID->"1616a895-2263-4d77-b117-f34dce12e744"]
}, Open  ]],

Cell["Take the Hermitian conjugate of the operator:", "ExampleText",
 CellID->1728281487,ExpressionUUID->"f830d316-4682-4302-a295-b5b81df1a9ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dag", "=", 
  RowBox[{"Dagger", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->738769794,ExpressionUUID->"8aac366f-665a-4727-bdb3-6d442587298f"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->121570815,ExpressionUUID->"e6fa39b3-b049-4920-a029-faf59ad1f4dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dag", "**", "op"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->697008013,ExpressionUUID->"ce5c8a93-99d0-4477-9bed-4a56f63ca378"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[10]=",
 CellID->983739408,ExpressionUUID->"4867e3fb-3e67-4e7b-83a6-36452d5a2773"]
}, Open  ]],

Cell["Calculate the matrix representation of the QFT:", "ExampleText",
 CellID->1338994217,ExpressionUUID->"097c9739-7066-4b1e-ae43-286d024f0952"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[11]:=",
 CellID->1065133665,ExpressionUUID->"1576d35f-e37b-48f9-81bb-6b3ad9f05650"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[11]//MatrixForm=",
 CellID->231632003,ExpressionUUID->"4faec8d0-96a5-48ff-9d8d-1a3bb28dfe9d"]
}, Open  ]],

Cell[TextData[{
 "The above matrix representation is equivalent to the result from the \
built-in function ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["FourierMatrix"]], "paclet:ref/FourierMatrix"},
   "RefLink",
   BaseStyle->{"InlineFormula"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "dfa971af-251e-40de-9dfc-584153b5af93"],
 ":"
}], "ExampleText",
 CellID->21662866,ExpressionUUID->"323b6d11-13b7-4103-aa67-b894bcc8be4f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"FourierMatrix", "[", "8", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[12]:=",
 CellID->1935243801,ExpressionUUID->"f323926c-38e0-436b-9f37-ae4e5dfd96d6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[12]//MatrixForm=",
 CellID->1798706057,ExpressionUUID->"d8a9021e-70f1-439d-869f-b1c6a6d0ef72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", "-", "new"}], "//", "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[13]:=",
 CellID->1610672650,ExpressionUUID->"1ad4eb6d-5e21-4b89-b852-b4ecc6fbbdba"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[13]//MatrixForm=",
 CellID->725401180,ExpressionUUID->"830af6b9-5d8a-44cf-923b-e1f590a0fea0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "fb9127a8-6731-4911-9fdc-118703bcac27"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->566965640,ExpressionUUID->"11c8811d-ee79-4591-a97c-82a6fefe33e0"],

Cell["Construct an input state:", "ExampleText",
 CellID->916988046,ExpressionUUID->"a2582fa9-955c-4e2f-b250-8fb7e04183c4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", "SS", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"bs", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "-", 
   RowBox[{"I", "*", 
    RowBox[{"bs", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}]}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->512764678,ExpressionUUID->"497763dc-b521-41a8-811f-1430f9229dac"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["1", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
     0, $CellContext`S[2, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->552968241,ExpressionUUID->"7934510c-228a-4bfe-8c41-14b983a89587"]
}, Open  ]],

Cell["Apply the QFT on the input state:", "ExampleText",
 CellID->801708978,ExpressionUUID->"00887498-7b38-4c3a-bd4c-d99a50e07a1e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"op", "**", "in"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1459809595,ExpressionUUID->"72ae143e-5e85-422e-89f1-c317b2ba89fd"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "-", 
      FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       0, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      SqrtBox["2"]}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "-", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], 
   SqrtBox["2"]], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "+", 
      FractionBox["\[ImaginaryI]", "2"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["S", 
              TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
             $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
       1, $CellContext`S[2, QuantumMob`Q3`$] -> 
       0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], 
   SqrtBox["2"]], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1575485918,ExpressionUUID->"af65aafb-7325-4bdd-962c-6a0802f1397d"]
}, Open  ]],

Cell["\<\
Let us check the result by comparing the vector representation of the output \
state with the result from multiplying the matrix representation of the QFT \
on the vector representation of the input state:\
\>", "ExampleText",
 CellID->358410394,ExpressionUUID->"26900138-802a-435d-aa54-f84112c9f055"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"Matrix", "[", "out", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vec", "//", "Normal"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1154479820,ExpressionUUID->"8daedc1c-b4f1-4ef6-9909-4a0384101d68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     FractionBox["1", "2"], "-", 
     FractionBox["\[ImaginaryI]", "2"]}], 
    SqrtBox["2"]], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "-", 
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   FractionBox[
    RowBox[{
     FractionBox["1", "2"], "+", 
     FractionBox["\[ImaginaryI]", "2"]}], 
    SqrtBox["2"]], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "+", 
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", "0", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], "-", 
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->718456316,ExpressionUUID->"75f69d48-8d98-468a-9c8a-7f9de095bd3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vin", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"in", ",", "SS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vin", "//", "Normal"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->618910181,ExpressionUUID->"dc9a7b05-05c8-4326-9727-3f740c970844"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->1942239578,ExpressionUUID->"80a7fd1c-58a3-40fa-ba20-69a0cfe39264"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"mat", ".", "vin"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "Normal"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1134493565,ExpressionUUID->"f2ede561-8f18-4d44-a2c3-e020bf96cb32"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     FractionBox["1", "2"], "-", 
     FractionBox["\[ImaginaryI]", "2"]}], 
    SqrtBox["2"]], ",", 
   RowBox[{
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   RowBox[{"-", 
    FractionBox["1", 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[ImaginaryI]", 
      RowBox[{"2", " ", 
       SqrtBox["2"]}]]}], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", 
   FractionBox[
    RowBox[{
     FractionBox["1", "2"], "+", 
     FractionBox["\[ImaginaryI]", "2"]}], 
    SqrtBox["2"]], ",", 
   RowBox[{
    FractionBox["\[ImaginaryI]", 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}], ",", "0", ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[ImaginaryI]", 
      RowBox[{"2", " ", 
       SqrtBox["2"]}]]}], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]]}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1469153046,ExpressionUUID->"45f98600-385b-482a-84ce-f30cd2a4fdc7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"vec", "-", "new"}], "//", "Normal"}], "//", "Simplify"}]], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->2095659547,ExpressionUUID->"c8e0787d-4e9b-43e1-953c-6110a06bbd0c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->288270916,ExpressionUUID->"54c15958-579c-4304-902c-ac35caa40257"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "2a4e2da3-c187-4751-b0bd-952f01bd1b9a"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->633346104,ExpressionUUID->"a74e5fa5-c701-4dca-945e-facd0e67775f"],

Cell["\<\
For a large number qubits, the evaluation of QFT takes long. In this case, \
setting the numeric evaluation flag helps make it faster. You can set the \
flag either manually or by using N:\
\>", "ExampleText",
 CellID->1225739319,ExpressionUUID->"f0102df7-ff04-42fa-bac8-1b01e289b7ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", " ", "SS", ",", 
   RowBox[{"\"\<Numeric\>\"", "->", "True"}]}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1645416489,ExpressionUUID->"d548879d-0a99-48d5-8e75-232b25a2c7c3"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}], ",", 
   RowBox[{"\<\"Numeric\"\>", "\[Rule]", "True"}]}], "]"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->246177580,ExpressionUUID->"38147f2c-03e8-4929-b630-8243ad9e9a73"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nop", "=", 
  RowBox[{"N", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->511943956,ExpressionUUID->"8cdd5579-db9f-42ac-9fa5-fab95e288e04"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}], ",", 
   RowBox[{"\<\"Numeric\"\>", "\[Rule]", "True"}]}], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1453082938,ExpressionUUID->"74823631-659e-4a4d-ae69-202685624f9c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "nop", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2120710401,ExpressionUUID->"56e8ec25-187e-4394-a7ea-b63d42acaced"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.125`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.12499999999999997`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.30177669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.12499999999999997`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.12499999999999999`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.125`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.30177669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.125`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{"0.17677669529663687`", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.051776695296636865`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.12499999999999997`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 2]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 2], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.17677669529663687`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.17677669529663687`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 3], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.12499999999999999`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.125`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 1]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.05177669529663689`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.125`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]]}], "+", 
  RowBox[{"0.17677669529663687`", " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.125`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.12499999999999997`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[3, 3]]}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->780905282,ExpressionUUID->"d0bb169a-bcf9-431f-a5d5-18093f8f8611"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Matrix", "[", "nop", "]"}], "//", "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1149083753,ExpressionUUID->"f1e9dcef-b4a9-4406-926e-887a38c55718"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.35355339059327373`", "0.35355339059327373`", "0.35355339059327373`", 
      "0.35355339059327373`", "0.35355339059327373`", "0.35355339059327373`", 
      "0.35355339059327373`", "0.35355339059327373`"},
     {"0.35355339059327373`", 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "+", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.35355339059327373`"}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "-", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}]},
     {"0.35355339059327373`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.35355339059327373`"}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      "0.35355339059327373`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.35355339059327373`"}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}]},
     {"0.35355339059327373`", 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "+", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.35355339059327373`"}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "-", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}]},
     {"0.35355339059327373`", 
      RowBox[{"-", "0.35355339059327373`"}], "0.35355339059327373`", 
      RowBox[{"-", "0.35355339059327373`"}], "0.35355339059327373`", 
      RowBox[{"-", "0.35355339059327373`"}], "0.35355339059327373`", 
      RowBox[{"-", "0.35355339059327373`"}]},
     {"0.35355339059327373`", 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "-", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.35355339059327373`"}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "+", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}]},
     {"0.35355339059327373`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.35355339059327373`"}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      "0.35355339059327373`", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.35355339059327373`"}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}]},
     {"0.35355339059327373`", 
      RowBox[{"0.25`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "-", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"-", "0.35355339059327373`"}], 
      RowBox[{
       RowBox[{"-", "0.24999999999999994`"}], "+", 
       RowBox[{"0.25`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.24999999999999994`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1402507757,ExpressionUUID->"b13513a0-57e2-4e10-aadd-53992e204e6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nop", "**", "in"}], "//", "KetChop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->860433650,ExpressionUUID->"4ba742fb-8049-4553-a16a-80caf49e393d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.6035533905932737`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.7071067811865475`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24999999999999994`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.6035533905932737`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24999999999999994`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.10355339059327373`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.10355339059327379`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1167362427,ExpressionUUID->"6852c7a2-6933-4a2a-9f27-a7409dd3ddf7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "31338c8d-6405-4b13-b0f2-3058f4688808"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1755184417,ExpressionUUID->"1746f770-3242-4492-a61a-e35e7e3e8268"],

Cell["Let us examine the Hermitian conjugate more closely:", "ExampleText",
 CellID->182857608,ExpressionUUID->"c13aaf69-4cb9-4bcb-91c5-125ac4238f8f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dag", "=", 
  RowBox[{"Dagger", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->2015855374,ExpressionUUID->"81b6aa78-4dcd-40a1-9876-ea2f5b9c58ef"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->449711597,ExpressionUUID->"09f56d19-e879-4c65-a1e9-6e7ff7c2adab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Elaborate", "[", "dag", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1813718867,ExpressionUUID->"dd38a8b0-80bd-4f29-a54b-cc528ae8976c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", "8"], "-", 
    FractionBox["\[ImaginaryI]", "8"]}], ")"}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "-", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[3, 3]]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 1], 
     $CellContext`S[3, 3]]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     $CellContext`S[1, 1], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 3]]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 1]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 2], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 1]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 1], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "+", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 2]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 2]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 2], 
      $CellContext`S[3, 2]]]}], 
   SqrtBox["2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "4"], "-", 
      FractionBox["\[ImaginaryI]", "4"]}], ")"}], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[1, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[2, 3]], 
         InterpretationBox[
          TemplateBox[{"S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
            TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
          $CellContext`S[3, 1]]}, "RowWithSeparators"]},
      "RowDefault"],
     QuantumMob`Q3`Multiply[
      $CellContext`S[1, 3], 
      $CellContext`S[2, 3], 
      $CellContext`S[3, 1]]]}], 
   SqrtBox["2"]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "-", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[1, 1]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ")"}], "+", 
     SqrtBox["2"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 1]]}], "+", 
  FractionBox[
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[2, 3]], 
   RowBox[{"4", " ", 
    SqrtBox["2"]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "8"], "-", 
     FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{"S", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    $CellContext`S[3, 3]]}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1307856986,ExpressionUUID->"5c7675b7-a8cd-4be9-acc2-1a93f937db33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dag", "**", "op"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1457601367,ExpressionUUID->"b7c0e4be-2962-4f4c-b26e-68786ea7c907"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->1657236657,ExpressionUUID->"d1f5c5c4-9ac0-400d-897d-f0d63217eebe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "**", "dag"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1455047160,ExpressionUUID->"d9290b84-6767-4b49-9576-757d5f20f4c5"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[4]=",
 CellID->313592609,ExpressionUUID->"7341ec2b-6132-461d-9570-65ced1f5ddb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"inv", "=", 
   RowBox[{"Matrix", "[", "dag", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"inv", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1456139501,ExpressionUUID->"4771d3d9-2b0f-4a75-a938-76d9a259a16a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox["\[ImaginaryI]", 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        RowBox[{"2", " ", 
         SqrtBox["2"]}]]}], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], 
       RowBox[{"2", " ", 
        SqrtBox["2"]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->626109725,ExpressionUUID->"e799fe6e-0557-46c0-b958-967f11a592f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"inv", ".", "mat"}], "//", "SimplifyThrough"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1935546351,ExpressionUUID->"7f0b93c1-0cf7-4734-8036-1014dc78e60e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->356277775,ExpressionUUID->"880f7472-4853-4a00-8a17-0e5d72f4ec27"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "8b8e0c3d-3626-4a31-9230-19172348d79b"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"446d775e-ce1e-4aa0-b186-13ea9c1945cb"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(5)", "ExampleCount",ExpressionUUID->
  "38a67143-2459-4f02-aec2-a790abfab200"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1502926422,ExpressionUUID->"c7b59fe0-5fef-4d94-a3d0-11d3ee0fd259"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "af9bbe11-9856-4381-9f73-aebacab8d8e1"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"9af061c3-96b7-452c-8ac3-015ac855026d"],
 "Quantum Circuit Model",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "a0025f31-8865-4dc4-a2cb-b063f281fd6d"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->148318357,ExpressionUUID->"96d872b8-83a1-4472-b860-9271044e057c"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->606512430,ExpressionUUID->"73bb9b41-97e6-4ab3-8f53-aa2b2ae88641"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1191141124,ExpressionUUID->"3f9683c3-55b6-40c5-a376-c3527b126074"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->776156589,ExpressionUUID->"b98e08fd-0b1a-47a5-8c3f-8f43d2fbf618"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QFT", "[", "SS", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1124287029,ExpressionUUID->"02a74c75-e9f7-44f6-b588-aec63b4a2460"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1048119445,ExpressionUUID->"93990ba8-708e-4894-9116-a18e5ced2b5c"]
}, Open  ]],

Cell["\<\
The QFT displays as a rectangular block in the quantum circuit:\
\>", "ExampleText",
 CellID->525586742,ExpressionUUID->"8109ed3d-36f3-470e-b1e7-909125343617"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->776477862,ExpressionUUID->"586638ab-db73-4dae-8c92-f46e5b317aa8"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QFT\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`QFT[1, {
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[4]=",
 CellID->2082639421,ExpressionUUID->"014866a8-6ff9-4762-b0cf-a1c4890ab050"]
}, Open  ]],

Cell[TextData[{
 "Decompose the QFT into a sequence of the controlled powers of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "e5934fda-c62a-4942-b77d-f56a4e275ce7"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "56cb384d-ae0b-4aff-a159-f94004f33f59"],
 " denotes the phase gate ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Z", "k"], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          SubscriptBox["\[Phi]", "k"]}]]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "ac50fb63-7d3b-4252-98fb-c6d0ac1a179b"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "k"], ":=", 
    FractionBox[
     RowBox[{"2", "\[Pi]"}], 
     SuperscriptBox["2", "k"]]}], TraditionalForm]],ExpressionUUID->
  "28795d34-bfe9-41b3-91cc-94fe89129830"],
 ":"
}], "ExampleText",
 CellID->1382320030,ExpressionUUID->"38a8e80a-cb47-4d64-9628-aa0853828587"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qft", "=", 
  RowBox[{"Unfold", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1879716809,ExpressionUUID->"e0b9e1e1-3cec-4c3a-8f83-874fab762bc9"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -4}, {2, -1}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -4}, {4, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -4}, {6, -3}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}, 
    $CellContext`S[1, 
     C[4]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}, 
    $CellContext`S[2, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[4, QuantumMob`Q3`$]}, 
    $CellContext`S[3, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[5]=",
 CellID->1084786294,ExpressionUUID->"607348c5-86cb-45c8-8913-2494af6fdede"]
}, Open  ]],

Cell["\<\
Further decompose the gates into more elementary gates; that is, the \
controlled-unitary gates.\
\>", "ExampleText",
 CellID->1011808894,ExpressionUUID->"3a0b883d-957d-4c63-9d39-9976aa1ffd20"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alt", "=", 
  RowBox[{"UnfoldAll", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1094389178,ExpressionUUID->"cd0b37ba-d12c-4125-a50e-090da0dae653"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -4}, {4, -1}}], 
     DiskBox[{4, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -2}}], 
     DiskBox[{6, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -4}, {7, -2}}], 
     DiskBox[{7, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -4}, {9, -3}}], 
     DiskBox[{9, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[4]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[3]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[6]=",
 CellID->2014563875,ExpressionUUID->"a52434b4-b5bb-41a2-ac07-9573dd4e9016"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "qft", "]"}], "-", 
    RowBox[{"Matrix", "[", "alt", "]"}]}], "//", "SimplifyThrough"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1034640886,ExpressionUUID->"4d2213ec-7027-40d5-856d-bb14ce39bb7b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
       0}, {}}, {}}]]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1547868523,ExpressionUUID->"a4c6cbfd-5302-4a29-845c-762cb3d2dd83"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "256e1196-3f62-4d59-909e-8343fafa64c0"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"ff03ef79-3bcb-421d-b9c9-a2d6d195ab52"],
 "Approximate QFT",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "55ee905f-d7f9-4591-97a3-7ebaeb97fa06"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->2092774907,ExpressionUUID->"5dc4bba5-a131-4c5d-9428-5fa2d4003abb"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Coppersmith (1994)"]], 
    "https://arxiv.org/abs/quant-ph/0201067"},
   "WebLink",
   BaseStyle->{"ExampleText", FontSlant -> "Plain"}]],ExpressionUUID->
  "67356d09-b089-47f9-8a6a-6471a54b5c1d"],
 " suggested a systematic way to approximate the QFT. Here, the method is \
illustrated. See also ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Barenco et al. (1996)"]], 
    "https://doi.org/10.1103/physreva.54.139"},
   "WebLink",
   BaseStyle->{"ExampleText"}]],ExpressionUUID->
  "d5f02921-7ce3-4ab9-bfd5-b8ceb2667f35"],
 " for the relevance of the approximate QFT in the presence of quantum \
decoherence."
}], "ExampleText",
 CellID->402065520,ExpressionUUID->"15c33d3e-ce7e-49e1-9a8b-e90d43da0552"],

Cell["Set the quantum register:", "ExampleText",
 CellID->1447727308,ExpressionUUID->"fc3935c0-9148-42e2-834c-de6b98d1e527"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1080511405,ExpressionUUID->"cb0505e9-8d1a-4a7a-aba3-339825513904"],

Cell["Set the qubits in the register:", "ExampleText",
 CellID->2134534541,ExpressionUUID->"cf70ed41-e6d6-4e79-ba91-0b6084410fdf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1033464803,ExpressionUUID->"879fcdd0-9f67-44b2-a0fe-9c122d5cd79a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`S[4, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "5"},
      "RowWithSeparators"]],
    $CellContext`S[5, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->409366303,ExpressionUUID->"b36061fa-5cd0-44d1-813b-f72a4d9933f7"]
}, Open  ]],

Cell["Set the QFT operator:", "ExampleText",
 CellID->963393444,ExpressionUUID->"a1158884-1328-4fa2-b43f-399698ffe118"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QFT", "[", "SS", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->666649869,ExpressionUUID->"a279e164-e03c-47a6-80e8-35771f0ae4f4"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "5"},
        "RowWithSeparators"]],
      $CellContext`S[5, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1829333180,ExpressionUUID->"a6e4e724-1bfa-43d7-9c7a-4e56d2ad178b"]
}, Open  ]],

Cell["Represent it in the quantum circuit model:", "ExampleText",
 CellID->1551454917,ExpressionUUID->"e4a77fc0-480d-4cd0-9c70-9b8777221929"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qft", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"UnfoldAll", "[", "op", "]"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->502922478,ExpressionUUID->"c5b1c45f-83a7-48f7-bf6e-715beb40369c"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {17, -1}}, {{0, -2}, {17, -2}}, {{0, -3}, {17, -3}}, {{
     0, -4}, {17, -4}}, {{0, -5}, {17, -5}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -4}, {4, -1}}], 
     DiskBox[{4, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -5}, {5, -1}}], 
     DiskBox[{5, -5}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "5"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -3}, {7, -2}}], 
     DiskBox[{7, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -4}, {8, -2}}], 
     DiskBox[{8, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -5}, {9, -2}}], 
     DiskBox[{9, -5}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {9., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -3.4}, {10.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {10., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{11, -4}, {11, -3}}], 
     DiskBox[{11, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -3.4}, {11.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {11., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{12, -5}, {12, -3}}], 
     DiskBox[{12, -5}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{11.6, -3.4}, {12.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {12., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{12.6, -4.4}, {13.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {13., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{14, -5}, {14, -4}}], 
     DiskBox[{14, -5}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{13.6, -4.4}, {14.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {14., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{14.6, -5.4}, {15.4, -4.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {15., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{15.6, -5.4}, {16.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.023529411764705882`],
       FontWeight->"Light",
       FontSlant->Italic], {16., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->658.8000000000001,
   PlotRange->{{0, 17}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[4]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[5, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[5]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[5, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[4]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[5, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[5, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[5, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$], 
     $CellContext`S[5, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[4]=",
 CellID->79382161,ExpressionUUID->"444a6c4e-e3fa-4fb6-9492-0015f3c45693"]
}, Open  ]],

Cell[TextData[{
 "Setting \
\[OpenCurlyDoubleQuote]ApproximationLevel\[CloseCurlyDoubleQuote]->m keeps \
only controlled-phase gates with phase angles ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "k"], "=", 
    RowBox[{"2", 
     RowBox[{"\[Pi]", "/", 
      SuperscriptBox["2", "k"]}]}]}], TraditionalForm]],ExpressionUUID->
  "30e1cde8-4ca5-4754-8d3c-e2e090c8a972"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "\[LessEqual]", "m"}], TraditionalForm]],ExpressionUUID->
  "aab1d398-8e56-432e-bbdf-b5ffd706d2f2"],
 ":"
}], "ExampleText",
 CellID->780825452,ExpressionUUID->"8c385534-a2b2-46b4-9273-98806dac2e7c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"apr2", "=", 
  RowBox[{"UnfoldAll", "[", 
   RowBox[{"op", ",", 
    RowBox[{"\"\<ApproximationLevel\>\"", "->", "2"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->60804947,ExpressionUUID->"94cfdc82-1fc0-4c72-8278-b6eecfced5e8"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}, {{0, -3}, {11, -3}}, {{
     0, -4}, {11, -4}}, {{0, -5}, {11, -5}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -2}}], 
     DiskBox[{4, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -4}, {6, -3}}], 
     DiskBox[{6, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -5}, {8, -4}}], 
     DiskBox[{8, -5}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -5.4}, {9.4, -4.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {9., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -5.4}, {10.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->442.8,
   PlotRange->{{0, 11}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[5, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[5, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$], 
     $CellContext`S[5, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[5]=",
 CellID->588635140,ExpressionUUID->"73f6a9d2-926c-4903-8363-c1c6aa39b110"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"apr3", "=", 
  RowBox[{"UnfoldAll", "[", 
   RowBox[{"op", ",", 
    RowBox[{"\"\<ApproximationLevel\>\"", "->", "3"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->507971047,ExpressionUUID->"88d882f3-28ee-4170-89fc-10c8a51a6c64"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {14, -1}}, {{0, -2}, {14, -2}}, {{0, -3}, {14, -3}}, {{
     0, -4}, {14, -4}}, {{0, -5}, {14, -5}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -3}, {5, -2}}], 
     DiskBox[{5, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -4}, {6, -2}}], 
     DiskBox[{6, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {7., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -4}, {8, -3}}], 
     DiskBox[{8, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -5}, {9, -3}}], 
     DiskBox[{9, -5}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {9., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{11, -5}, {11, -4}}], 
     DiskBox[{11, -5}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {11., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{11.6, -5.4}, {12.4, -4.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {12., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{12.6, -5.4}, {13.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {13., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->550.8000000000001,
   PlotRange->{{0, 14}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[3]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[5, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[5, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[5, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$], 
     $CellContext`S[5, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[6]=",
 CellID->1881119898,ExpressionUUID->"9b4b44e7-3c0f-4b20-8dcc-965ca4069007"]
}, Open  ]],

Cell["\<\
The controlled-phase gates and Hadamard gates commute with each other if the \
qubits they operate on are different, and some controlled-phase gates may be \
rearranged:\
\>", "ExampleText",
 CellID->2102571339,ExpressionUUID->"c5057130-5cca-4e52-88ee-8e2efd8e468e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alt3", "=", 
  RowBox[{"UnfoldAll", "[", 
   RowBox[{"op", ",", 
    RowBox[{"\"\<ApproximationLevel\>\"", "->", "3"}], ",", 
    RowBox[{"\"\<Pushed\>\"", "->", "True"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->2068345314,ExpressionUUID->"b5e85964-6334-4ea9-8c37-3d18fd3c318d"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {14, -1}}, {{0, -2}, {14, -2}}, {{0, -3}, {14, -3}}, {{
     0, -4}, {14, -4}}, {{0, -5}, {14, -5}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -1}}], 
     DiskBox[{4, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -3}, {5, -2}}], 
     DiskBox[{5, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -4}, {7, -2}}], 
     DiskBox[{7, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -4}, {8, -3}}], 
     DiskBox[{8, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {9., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{10, -5}, {10, -3}}], 
     DiskBox[{10, -5}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -3.4}, {10.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {10., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{11, -5}, {11, -4}}], 
     DiskBox[{11, -5}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {11., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{11.6, -5.4}, {12.4, -4.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {12., -5.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{12.6, -5.4}, {13.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.02857142857142857],
       FontWeight->"Light",
       FontSlant->Italic], {13., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->550.8000000000001,
   PlotRange->{{0, 14}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[5, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[5, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[5, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$], 
     $CellContext`S[5, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[7]=",
 CellID->727874552,ExpressionUUID->"1da9adef-22a8-4cdd-81ea-40fb62033718"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "apr3", "]"}], "-", 
   RowBox[{"Matrix", "[", "alt3", "]"}]}], "//", "ArrayZeroQ"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1878635140,ExpressionUUID->"eb0e72c0-7834-41b2-9322-5c7714e53d92"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[8]=",
 CellID->1320742152,ExpressionUUID->"dce4a7ca-025f-4be6-b821-bce1f692e763"]
}, Open  ]],

Cell["Calculate the errors:", "ExampleText",
 CellID->1261157815,ExpressionUUID->"d176dd97-3e01-40f6-8d89-cb0a0a8ce7cf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{"Matrix", "[", 
     RowBox[{"N", "@", "op"}], "]"}], "-", 
    RowBox[{"Matrix", "[", 
     RowBox[{"N", "@", "apr2"}], "]"}]}], "]"}], "/", 
  RowBox[{"Norm", "[", 
   RowBox[{"Matrix", "[", 
    RowBox[{"N", "@", "op"}], "]"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1644589934,ExpressionUUID->"7fb09565-0fed-4327-88a6-37dead3ce3ce"],

Cell[BoxData["1.9995793502381638`"], "Output",
 CellLabel->"Out[9]=",
 CellID->1322373272,ExpressionUUID->"f48ede93-d2e2-4f8c-a23d-29b4d32cb10a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{"Matrix", "[", 
     RowBox[{"N", "@", "op"}], "]"}], "-", 
    RowBox[{"Matrix", "[", 
     RowBox[{"N", "@", "apr3"}], "]"}]}], "]"}], "/", 
  RowBox[{"Norm", "[", 
   RowBox[{"Matrix", "[", 
    RowBox[{"N", "@", "op"}], "]"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->1346215444,ExpressionUUID->"547093bf-b787-49bd-9d15-5c38f0a2f355"],

Cell[BoxData["0.942793473651995`"], "Output",
 CellLabel->"Out[10]=",
 CellID->819319701,ExpressionUUID->"e31cb36a-49d0-495d-9437-2b5cf276cfbd"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "098f47f1-651f-40f4-821b-8a5315adf414"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"e02fd5fb-4b24-47dc-b896-05c5d862465d"],
 "Performance",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "4db3254b-6940-41f0-b3fc-68a2cd4f5f17"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1281406550,ExpressionUUID->"bb942073-8269-4fee-8290-1faa75fcf50b"],

Cell[TextData[{
 "The evaluation performance of a quantum circuit may vary significantly \
depending on how you evaluate it (that is, either using ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Evaluate"]], "paclet:QuantumMob/Q3/ref/Evaluate", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "ad6d63f0-21d8-43d1-9466-b23681a44b41"],
 "/",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["ExpressionFor"]], "paclet:QuantumMob/Q3/ref/ExpressionFor", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2064150a-87ad-4cf4-9bb7-c96b0e1e324f"],
 " or ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["Matrix"]], "paclet:QuantumMob/Q3/ref/Matrix", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "fb159392-16b5-49b1-866f-d21a8b3a06c4"],
 "), whether there is an input or not, or either directly working with \
high-level gates or elementary gates."
}], "ExampleText",
 CellID->1326551885,ExpressionUUID->"f74573e4-4732-4882-a568-48e9be075660"],

Cell[TextData[{
 "For example, consider the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["QFT"]], "paclet:QuantumMob/Q3/ref/QFT", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "db167125-84a9-46e4-bee7-6b53ebc8c8d8"],
 " gate, which is a high-level gate representing the quantum Fourier \
transform."
}], "ExampleText",
 CellID->1844377872,ExpressionUUID->"f6e62d5c-d3df-4eec-9e86-581155987beb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->750101519,ExpressionUUID->"91bb4bf6-2cee-4af6-92ec-ea19d824b40c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->641070143,ExpressionUUID->"8564ea64-e6a4-4662-9461-c8d527cb7a8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"N", "[", 
   RowBox[{"QFT", "[", "SS", "]"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1601330061,ExpressionUUID->"8fac43b4-66f8-4ed2-a488-0c356822aa5a"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]]}], "}"}], ",", 
   RowBox[{"\<\"Numeric\"\>", "\[Rule]", "True"}]}], "]"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->540436402,ExpressionUUID->"4e166821-7536-42f7-8450-c584fa38cff1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1749439152,ExpressionUUID->"416d55d9-9f73-48ea-8112-7cbe0c96c573"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QFT\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`QFT[1, {
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}, "Numeric" -> True]]]], "Output",
 CellLabel->"Out[3]=",
 CellID->1406265251,ExpressionUUID->"a6f1ca3a-5049-4bac-b9fd-c6067cdbd383"]
}, Open  ]],

Cell["Evaluating the circuit is reasonably fast.", "ExampleText",
 CellID->1188118867,ExpressionUUID->"e8f057f4-5703-4e91-8352-2af839ace63e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"expr", "=", 
    RowBox[{"Elaborate", "[", "qc", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1516752790,ExpressionUUID->"75b0f79d-2c4e-4240-b4f2-f16ed17022e1"],

Cell[BoxData["0.156923`"], "EchoTiming",
 CellID->2042538322,ExpressionUUID->"f5ec0c40-cc0f-470c-be87-991832d0418f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"mat", "=", 
    RowBox[{"Matrix", "[", "qc", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->2006007153,ExpressionUUID->"4f08800a-926e-48c0-b43a-3f8db418418e"],

Cell[BoxData["0.001455`"], "EchoTiming",
 CellID->1415480559,ExpressionUUID->"fb203a43-3cad-4d84-a5da-3c593bfcfb82"]
}, Open  ]],

Cell["Operating it on a Ket expression is also fast.", "ExampleText",
 CellID->122037108,ExpressionUUID->"d524f689-a486-467c-a7e6-d18095990dd8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bs", "=", 
   RowBox[{"Basis", "[", "SS", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"bs", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "-", 
   RowBox[{"I", "*", 
    RowBox[{"bs", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}]}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->82863167,ExpressionUUID->"a4b1977f-b563-47cc-b494-dc9e508cbc13"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["1", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
           $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
       SubscriptBox["0", 
        TemplateBox[{",", "\",\"", 
          InterpretationBox[
           SubscriptBox["S", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
      "RowWithSeparators"]},
    "Ket"],
   Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
     0, $CellContext`S[2, QuantumMob`Q3`$] -> 
     1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->157913647,ExpressionUUID->"588d0f13-9531-4824-ad7f-91aba432f375"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{"out", "=", 
   RowBox[{"qc", "**", "in"}]}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1043266157,ExpressionUUID->"01327bf8-77b8-4e52-973b-fa60c5fa8a9c"],

Cell[BoxData["0.020483`"], "EchoTiming",
 CellID->1912361084,ExpressionUUID->"6cb91354-9053-43d3-bf32-277630ade8d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.6035533905932737`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.7071067811865475`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24999999999999994`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.6035533905932737`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      0, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.35355339059327373`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.35355339059327373`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 0|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.24999999999999994`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.10355339059327373`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      0, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.25`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.10355339059327379`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`S[1, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`S[2, QuantumMob`Q3`$]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["S", 
             TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
            $CellContext`S[3, QuantumMob`Q3`$]]}, "RowWithSeparators"]]}, 
       "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`S[1, QuantumMob`Q3`$] -> 
      1, $CellContext`S[2, QuantumMob`Q3`$] -> 
      1, $CellContext`S[3, QuantumMob`Q3`$] -> 1|>]]}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1812477786,ExpressionUUID->"046bf4c0-8e2d-4139-bcec-b45387ccfa98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "f6fbc8a0-e69e-4fd3-b190-7083fb21e96b"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1166242150,ExpressionUUID->"1b3ef1cd-2c84-4221-91e9-4936eb0cf757"],

Cell["\<\
Now, consider the decomposition of the high-level QFT gate into a set of more \
elementary gates.\
\>", "ExampleText",
 CellID->643625537,ExpressionUUID->"6e4fcd99-f37f-4e36-84e2-71ac1503135c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc2", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"Unfold", "@", "op"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1791312436,ExpressionUUID->"b5f6070c-ea6b-4fee-8f6c-a31065a774da"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {7, -1}}, {{0, -2}, {7, -2}}, {{0, -3}, {7, -3}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -1}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -3.4}, {2.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05714285714285714],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->298.8,
   PlotRange->{{0, 7}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}, 
    QuantumMob`Q3`Phase[0.7853981633974483, 
     $CellContext`S[1, 3], "Label" -> Subscript["Z", 3]], "ControlLabel" -> 
    "x"], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[3, QuantumMob`Q3`$]}, 
    QuantumMob`Q3`Phase[1.5707963267948966`, 
     $CellContext`S[2, 3], "Label" -> Subscript["Z", 2]], "ControlLabel" -> 
    "x"], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->258616607,ExpressionUUID->"a8aefe1a-8063-4daa-bab0-2be45d7e79d9"]
}, Open  ]],

Cell["\<\
Since we have to simulate it classically, it is much slower than the above \
quantum circuit that directly uses the high-level feature..\
\>", "ExampleText",
 CellID->562437636,ExpressionUUID->"b16c0584-9ee0-4616-9fe9-8d73bda6795b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{"expr2", "=", 
    RowBox[{"Elaborate", "[", "qc2", "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1949985825,ExpressionUUID->"04461f27-f043-4128-8760-93c077c0b1d1"],

Cell[BoxData["2.039076`"], "EchoTiming",
 CellID->62412321,ExpressionUUID->"2e42e052-f8bd-4358-a37d-b51230cea007"]
}, Open  ]],

Cell["This may be overcome by using matrix representations.", "ExampleText",
 CellID->1896345337,ExpressionUUID->"d30b0271-3753-4fad-9f25-fba2bd9b0ddf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{"mat2", "=", 
    RowBox[{"Matrix", "[", "qc2", "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->803044201,ExpressionUUID->"2874d714-f38d-4684-b1cd-78076c7788c7"],

Cell[BoxData["0.004893`"], "EchoTiming",
 CellID->991859311,ExpressionUUID->"a3326a7f-1d52-4ed5-9935-d0ecd263cd1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "mat2"}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1911716864,ExpressionUUID->"7a395bef-0b0e-4929-9354-595676741e7e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1411371963,ExpressionUUID->"5a9932e5-c8d6-4f5a-ba1a-cbe90abe0945"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "e357ff8e-c74c-46f9-9cae-e6c688472af0"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->948568881,ExpressionUUID->"27220770-b849-419f-8e1c-0a709a73d665"],

Cell["Try with another version of the original quantum circuit.", \
"ExampleText",
 CellID->1538911483,ExpressionUUID->"f7cea1cc-9574-4c03-bb3f-80f78b9fe98c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc3", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{"UnfoldAll", "@", "op"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->192250313,ExpressionUUID->"59130ec6-bdf7-4682-bcf3-3d690b5fa67a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {8, -1}}, {{0, -2}, {8, -2}}, {{0, -3}, {8, -3}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -3}, {5, -2}}], 
     DiskBox[{5, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -3.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.05],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->334.8,
   PlotRange->{{0, 8}, {-3.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Phase[1.5707963267948966`, 
     $CellContext`S[1, 3], "Label" -> Subscript["Z", 2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Phase[0.7853981633974483, 
     $CellContext`S[1, 3], "Label" -> Subscript["Z", 3]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`Phase[1.5707963267948966`, 
     $CellContext`S[2, 3], "Label" -> Subscript["Z", 2]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->1971701026,ExpressionUUID->"3df50b18-0974-412b-a60f-2fe26ad69e3f"]
}, Open  ]],

Cell[TextData[{
 "This version is slightly better than the second version since some internal \
calculations (",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["MultiplyPower"]], "paclet:QuantumMob/Q3/ref/MultiplyPower", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7ff90636-cbf0-43b6-9a7b-296fa468d633"],
 " in this case) have already been incorporated at the time of the \
decomposition."
}], "ExampleText",
 CellID->261653958,ExpressionUUID->"b9be7990-2c28-4b86-9645-885f58d105d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{"exp3", "=", 
    RowBox[{"Elaborate", "[", "qc3", "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1580018662,ExpressionUUID->"6a519707-5603-4196-8f34-283643a0e9b6"],

Cell[BoxData["4.096087`"], "EchoTiming",
 CellID->558987125,ExpressionUUID->"e86caf37-14ae-4bf6-98e5-3da3e4d58582"]
}, Open  ]],

Cell["Again, evaluating it using matrix representations is fast.", \
"ExampleText",
 CellID->1596247736,ExpressionUUID->"21ebd83d-8a7c-4a46-bd41-dfa7b22ccb68"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{"mat3", "=", 
    RowBox[{"Matrix", "[", "qc3", "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1611158688,ExpressionUUID->"6e5a9df0-f762-4a58-83de-b4bf46545c55"],

Cell[BoxData["0.003585`"], "EchoTiming",
 CellID->1803137897,ExpressionUUID->"3482a661-f0a9-41b3-8e71-974b8097a01c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mat", "-", "mat3"}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1119257192,ExpressionUUID->"3ef049a5-921a-457f-9336-0213b20bf38f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->49408415,ExpressionUUID->"7973b446-2fdf-43e9-8fb6-7880bdd6282e"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "9ed06502-3517-449b-a13e-d848ae5a5b1b"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"3fde5c8a-2481-49d9-a30f-58fedb005fc9"],
 "Properties & Relations",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(5)", "ExampleCount",ExpressionUUID->
  "711c1d1f-94d6-4046-9c2c-5cca4f06b37b"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1013844522,ExpressionUUID->"48cc812b-a507-4a7c-abc0-da94e71c84c9"],

Cell["\<\
Here, we exploit the relation between the quantum Fourier transform(QFT) and \
its inverse to get a series of equivalent quantum circuits.\
\>", "ExampleText",
 CellID->1449669344,ExpressionUUID->"f24a6048-1430-4d55-9213-975a3e0eb117"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->435300863,ExpressionUUID->"d1645c33-6b06-45ba-9823-4f89c65ff0e1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1315257341,ExpressionUUID->"be701f1b-3c4f-4176-b73b-a9b5c99ed4cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1478543163,ExpressionUUID->"91b43a13-1974-4b30-92de-e0dd8476a75f"]
}, Open  ]],

Cell["Consider the QFT:", "ExampleText",
 CellID->147470073,ExpressionUUID->"2e5c4687-8fdc-46d4-b4fd-e6244d562025"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QFT", "[", "SS", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1018341382,ExpressionUUID->"9a7ae58a-0ad4-44d8-9072-c7886a13970e"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1341661104,ExpressionUUID->"a264f52a-b555-484c-a53e-e5b82892d0a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "3"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "53242c16-2a6b-430b-a133-f88c19b83300"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"cf2fca13-3ae3-44b3-99b9-9abe5523b929"],
 "Standard Circuit",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "1844bafb-9997-4dc5-84f0-28dca8c73b46"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1428253628,ExpressionUUID->"79fa5b79-4d6a-4908-ab9d-e4a929508a26"],

Cell["Here is the quantum circuit that Q3 uses:", "ExampleText",
 CellID->271289733,ExpressionUUID->"3c96edbc-38c6-427b-bcb1-1a0724b68057"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qft", "=", 
  RowBox[{"Unfold", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->597018216,ExpressionUUID->"cdafbda1-b6b7-4841-8765-a5d794321539"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -4}, {2, -1}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -4}, {4, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -4}, {6, -3}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}, 
    $CellContext`S[1, 
     C[4]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}, 
    $CellContext`S[2, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[4, QuantumMob`Q3`$]}, 
    $CellContext`S[3, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->719881428,ExpressionUUID->"2ec1d638-f91c-4d76-9aef-fdc9d1dbf5f8"]
}, Open  ]],

Cell["Unfold the controlled-power gates.", "ExampleText",
 CellID->1395460857,ExpressionUUID->"65b4050a-acde-43ad-a874-9b61c288218a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alt", "=", 
  RowBox[{"UnfoldAll", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->171881754,ExpressionUUID->"099ad987-5423-45d0-b01a-6add8077a448"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -1}}], 
     DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -4}, {4, -1}}], 
     DiskBox[{4, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -2}}], 
     DiskBox[{6, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -4}, {7, -2}}], 
     DiskBox[{7, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -4}, {9, -3}}], 
     DiskBox[{9, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[4]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[3]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->124293198,ExpressionUUID->"a621d42c-04d3-4c9d-b197-0b6b759b46b6"]
}, Open  ]],

Cell["\<\
Since the controlled-phase gates commute with the Hadamard gate unless the \
latter act on the control or target qubit, we can push such controlled-phase \
gates to the right as far as possible [this is the form examined in \
Coppersmith (1994)]:\
\>", "ExampleText",
 CellID->2054175921,ExpressionUUID->"3bb3b2a3-d5ad-4524-869a-306ca67c7d64"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"var", "=", 
  RowBox[{"UnfoldAll", "[", 
   RowBox[{"op", ",", 
    RowBox[{"\"\<Pushed\>\"", "->", "True"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1163101081,ExpressionUUID->"dc32661c-8c6c-4574-9bf3-85fe8e1e12f7"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -1}}], 
     DiskBox[{2, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -1}}], 
     DiskBox[{4, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -3}, {5, -2}}], 
     DiskBox[{5, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -4}, {7, -1}}], 
     DiskBox[{7, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -4}, {8, -2}}], 
     DiskBox[{8, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -4}, {9, -3}}], 
     DiskBox[{9, -4}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -3.4}, {9.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[2]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[1, 
     C[4]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[4, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[3]=",
 CellID->1641673902,ExpressionUUID->"ec551edc-faf3-4b14-afb8-9e4b57462a09"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "op", "]"}], "-", 
    RowBox[{"Matrix", "[", "alt", "]"}]}], "//", "SimplifyThrough"}], "//", 
  "ArrayZeroQ"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "op", "]"}], "-", 
    RowBox[{"Matrix", "[", "var", "]"}]}], "//", "SimplifyThrough"}], "//", 
  "ArrayZeroQ"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->788418180,ExpressionUUID->"5a32612e-8749-4d48-8842-1893ff0a69f1"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[4]=",
 CellID->743374258,ExpressionUUID->"d297cc37-cea6-4417-bc7c-afcb05d8ba46"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[4]=",
 CellID->1978779607,ExpressionUUID->"045c2def-193c-4cd5-b99d-a73fd0dafedf"]
}, Open  ]],

Cell["\<\
Note that the above quantum circuits are not appropriate for semiclassical \
implementation of QFT because Hadamard gates are applied on the control \
qubits after the controlled-power or controlled-unitary gates.\
\>", "ExampleText",
 CellID->1535874996,ExpressionUUID->"2834f7dc-46cd-4b28-9d3f-f5d000b97859"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "3"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "4"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "85a1b467-ab86-4628-a925-44ef339589bc"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"8b94efd2-dee3-41a7-a47b-918a1c6997a1"],
 "Reversed Circuit",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "d0b86e2b-787a-40de-b349-2f1254143983"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1175644165,ExpressionUUID->"9b0751fa-a236-410b-8e83-7e9906731694"],

Cell[TextData[{
 "The inverse QFT is another Fourier transform with the factor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
    "2", "\[Pi]", "\[VeryThinSpace]", "\[ImaginaryI]", "\[VeryThinSpace]", 
     "x", "\[VeryThinSpace]", 
     RowBox[{"k", "/", "N"}]}]], TraditionalForm]],ExpressionUUID->
  "27c66f1a-2d24-42b5-86c1-feefe2d5ddab"],
 "replaced by ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "2"}], "\[Pi]", "\[VeryThinSpace]", "\[ImaginaryI]", "\[VeryThinSpace]",
      "x", "\[VeryThinSpace]", 
     RowBox[{"k", "/", "N"}]}]], TraditionalForm]],ExpressionUUID->
  "e9bc6922-1b61-4465-8898-e304d9283ea2"],
 ". This suggests that the inverse QFT can be achieved simply by replacing \
each phase gate ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "k"], TraditionalForm]],ExpressionUUID->
  "d6b4fc67-8d54-441f-84fc-f432744222a1"],
 " by ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["Z", "k", "\[Dagger]"], TraditionalForm]],ExpressionUUID->
  "34687e69-eb48-41b2-a589-da039a89de95"],
 ". This also means that an equivalent quantum circuit may be achieved simply \
reversing the original quantum circuit:"
}], "ExampleText",
 CellID->673555027,ExpressionUUID->"0c8b9f8c-3309-4460-b9b4-2d1bdc11cc85"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rvs", "=", 
  RowBox[{"Reverse", "[", "qft", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1212258744,ExpressionUUID->"059e6bc0-d642-4b4d-a7d5-3596733908b4"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -4}, {3, -3}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -3}, {5, -4}, {5, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -4.4}, {5.4, -2.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -3}, {7, -4}, {7, -1}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -1.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -1.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[4, QuantumMob`Q3`$]}, 
    $CellContext`S[3, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}, 
    $CellContext`S[2, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}, 
    $CellContext`S[1, 
     C[4]], "ControlLabel" -> "x"], 
   $CellContext`S[1, 6]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->1417097407,ExpressionUUID->"0bd04fca-d8aa-472f-8369-d89f8e5c9b78"]
}, Open  ]],

Cell["\<\
We can bring the QBR transform at the beginning of the above circuit to the \
end by reversing the qubits in each gate:\
\>", "ExampleText",
 CellID->659314118,ExpressionUUID->"5236339f-ed83-4098-b1d6-a8aab1cde174"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"QuantumCircuit", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"QBR", "[", "SS", "]"}], "/@", 
     RowBox[{"Rest", "[", "rvs", "]"}]}], ",", 
    RowBox[{"QBR", "@", "SS"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1732368903,ExpressionUUID->"6748629a-abb4-427f-9b7a-66bd908b4370"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}, {4, -3}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -2}, {6, -1}, {6, -4}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"x\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", "\"x\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[1, QuantumMob`Q3`$]}, 
    $CellContext`S[2, 
     C[2]], "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[1, QuantumMob`Q3`$]}, 
    $CellContext`S[3, 
     C[3]], "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[1, QuantumMob`Q3`$]}, 
    $CellContext`S[4, 
     C[4]], "ControlLabel" -> "x"], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->1562474219,ExpressionUUID->"80212702-78e7-44e7-adce-c2a019c53e5f"]
}, Open  ]],

Cell[TextData[{
 "Here, it is important to the bit-strings are reversed when giving the \
integer values of ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "c778f88b-c0e1-4d08-8f69-98c31a1e6e94"],
 ":"
}], "ExampleText",
 CellID->1086766138,ExpressionUUID->"41b06ad2-3d3c-4667-a3c4-e8f57f2cc209"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{"new", ",", "_ControlledPower"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1633450301,ExpressionUUID->"057f8a3b-bb6c-46bc-9ee1-564dbcd3676a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ControlledPower", "[", 
    RowBox[{
     RowBox[{"{", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, QuantumMob`Q3`$]], "}"}], ",", 
     InterpretationBox[
      TemplateBox[{"S", 
        TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], 
           TagBox[
            SuperscriptBox["2", "2"], HoldForm]]}, "RowWithSeparators"]},
       "Subsuperscript"],
      $CellContext`S[2, 
       C[2]]], ",", 
     RowBox[{"\<\"ControlLabel\"\>", "\[Rule]", "\<\"x\"\>"}]}], "]"}], ",", 
   RowBox[{"ControlledPower", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]]}], "}"}], ",", 
     InterpretationBox[
      TemplateBox[{"S", 
        TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], 
           TagBox[
            SuperscriptBox["2", "3"], HoldForm]]}, "RowWithSeparators"]},
       "Subsuperscript"],
      $CellContext`S[3, 
       C[3]]], ",", 
     RowBox[{"\<\"ControlLabel\"\>", "\[Rule]", "\<\"x\"\>"}]}], "]"}], ",", 
   RowBox[{"ControlledPower", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]]}], "}"}], ",", 
     InterpretationBox[
      TemplateBox[{"S", 
        TemplateBox[{",", "\",\"", "4"}, "RowWithSeparators"], 
        TemplateBox[{",", "\",\"", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]"}], 
           TagBox[
            SuperscriptBox["2", "4"], HoldForm]]}, "RowWithSeparators"]},
       "Subsuperscript"],
      $CellContext`S[4, 
       C[4]]], ",", 
     RowBox[{"\<\"ControlLabel\"\>", "\[Rule]", "\<\"x\"\>"}]}], "]"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1074163217,ExpressionUUID->"920cfe28-2f4d-4b5b-ae60-f0878768fff4"]
}, Open  ]],

Cell[TextData[{
 "For heuristic purposes, Q3 provides a handy way to generate the above \
quantum circuit of the QFT. Note that the tilde accent above the label of \
control qubits to emphasize the bit string is reversed; that is,  ",
 Cell[BoxData[
  FormBox[Cell[TextData[Cell[BoxData[
    FormBox[
     RowBox[{
      OverscriptBox["x", "~"], ":=", 
      SubscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", 
          RowBox[{"k", "-", "1"}]], "\[Ellipsis]", "\[VeryThinSpace]", 
         SubscriptBox["x", "2"], 
         SubscriptBox["x", "1"]}], ")"}], "2"]}], TraditionalForm]],
    ExpressionUUID->"9ce1c92b-835e-486e-9b5c-a0a391436ae6"]],ExpressionUUID->
    "957371d7-695b-4773-8f0b-13b914172e6b"], TraditionalForm]],ExpressionUUID->
  "a94033d4-5d71-42cb-b694-7ae08502cd1b"],
 " rather than ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["x", "1"], 
      SubscriptBox["x", "2"], "\[Ellipsis]", "\[VeryThinSpace]", 
      SubscriptBox["x", 
       RowBox[{"k", "-", "1"}]]}], ")"}], "2"], TraditionalForm]],
  ExpressionUUID->"94f707b9-b561-4aa4-b223-cfd2534585b7"],
 ":"
}], "ExampleText",
 CellID->597410564,ExpressionUUID->"586c5f29-d817-4bc8-99d5-79591abe0816"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mint", "=", 
  RowBox[{"Unfold", "[", 
   RowBox[{"op", ",", 
    RowBox[{"\"\<Reversed\>\"", "->", "True"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->810946710,ExpressionUUID->"118a6a68-74f3-45b2-a0eb-3517a988d4dc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -1}, {4, -3}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -2}, {6, -1}, {6, -4}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -4.4}, {6.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[1, QuantumMob`Q3`$]}, 
    $CellContext`S[2, 
     C[2]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[1, QuantumMob`Q3`$]}, 
    $CellContext`S[3, 
     C[3]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[1, QuantumMob`Q3`$]}, 
    $CellContext`S[4, 
     C[4]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[4]=",
 CellID->1713651437,ExpressionUUID->"8900af27-7c47-45d6-8e19-489a3814fa7f"]
}, Open  ]],

Cell["\<\
Unfold further the controlled-power gates in the above quantum circuit to get \
the following conventional quantum circuit which commonly appears in \
textbooks.\
\>", "ExampleText",
 CellID->544880232,ExpressionUUID->"15c569b3-6c57-4059-bccc-7e58c8010439"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"more", "=", 
  RowBox[{"UnfoldAll", "[", 
   RowBox[{"op", ",", 
    RowBox[{"\"\<Reversed\>\"", "->", "True"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1131136971,ExpressionUUID->"7bac9f70-6b0b-46fc-9be8-d5c69af850e0"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -3}}], 
     DiskBox[{4, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -3}}], 
     DiskBox[{5, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -4}}], 
     DiskBox[{7, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -2}, {8, -4}}], 
     DiskBox[{8, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -4.4}, {8.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -3}, {9, -4}}], 
     DiskBox[{9, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[5]=",
 CellID->1436511742,ExpressionUUID->"a6b98192-d4ed-4dd5-b721-57a55270c180"]
}, Open  ]],

Cell["\<\
Push the controlled-phase gates to the left as far as possible [this is a \
variant of the form examined in Coppersmith (1994)]:\
\>", "ExampleText",
 CellID->586797214,ExpressionUUID->"510cf160-1b02-4b73-af83-126589930436"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"push", "=", 
  RowBox[{"UnfoldAll", "[", 
   RowBox[{"op", ",", 
    RowBox[{"\"\<Reversed\>\"", "->", "True"}], ",", 
    RowBox[{"\"\<Pushed\>\"", "->", "True"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1476000633,ExpressionUUID->"2f4a5e14-3ae0-4377-a692-0569fa2c80f5"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -1}, {2, -2}}], 
     DiskBox[{2, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -1}, {3, -3}}], 
     DiskBox[{3, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {3., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -1}, {4, -4}}], 
     DiskBox[{4, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {4., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -2}, {6, -3}}], 
     DiskBox[{6, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -4}}], 
     DiskBox[{7, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -4.4}, {7.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {7., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -3}, {9, -4}}], 
     DiskBox[{9, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -4.4}, {9.4, -3.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"Z\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -4.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   $CellContext`S[1, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[2, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[3]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[4]]], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[3, 
     C[2]]], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[3]]], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    $CellContext`S[4, 
     C[2]]], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}]]]], "Output",
 CellLabel->"Out[6]=",
 CellID->1441688220,ExpressionUUID->"5ad7d522-9879-4bda-bb06-cd58b47cd9fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "qft", "]"}], "-", 
    RowBox[{"Matrix", "[", "mint", "]"}]}], "//", "SimplifyThrough"}], "//", 
  "ArrayZeroQ"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "qft", "]"}], "-", 
    RowBox[{"Matrix", "[", "more", "]"}]}], "//", "SimplifyThrough"}], "//", 
  "ArrayZeroQ"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Matrix", "[", "qft", "]"}], "-", 
    RowBox[{"Matrix", "[", "push", "]"}]}], "//", "SimplifyThrough"}], "//", 
  "ArrayZeroQ"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->976045210,ExpressionUUID->"b78c442d-c78e-41e0-9cd1-2cae40a32a9a"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[7]=",
 CellID->395924439,ExpressionUUID->"12b7186f-6710-416b-9af5-c03846e13b66"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[7]=",
 CellID->1397707867,ExpressionUUID->"5d0bf225-4efd-414e-ab46-e66c028085d4"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[7]=",
 CellID->2099989783,ExpressionUUID->"10cd2b7d-73e1-477c-996e-bf8786784fac"]
}, Open  ]],

Cell["\<\
Note that these quantum circuits are suitable for semiclassical \
implementation of the QFT since there is nor Hadamard gate required after the \
controlled-power or controlled-unitary gates.\
\>", "ExampleText",
 CellID->1486864925,ExpressionUUID->"f799307e-9a65-4813-b2c1-334f3ec58134"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "4"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "5"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "57194d43-68b1-4071-b4ec-824521af4f21"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"e75f231b-e603-49ae-838f-b26dbab5394c"],
 "Other Variations",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "64198f8e-bf00-41fd-be07-a9ba3152a0e7"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->134046782,ExpressionUUID->"03abf94b-13fc-4de3-9efd-d0244ad4f482"],

Cell[TextData[{
 "Again, yet another equivalent quantum circuit may be constructed by \
reversing the above quantum circuits ",
 StyleBox["mint", "Input"],
 " or ",
 StyleBox["more", "Input"],
 ":"
}], "ExampleText",
 CellID->2137736558,ExpressionUUID->"9b53598b-603b-4c1e-b842-431307cda891"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"else", "=", 
  RowBox[{"Reverse", "[", "mint", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1543898210,ExpressionUUID->"cb12b1e9-29d8-48d5-a8df-bf1f72bf33bc"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {9, -1}}, {{0, -2}, {9, -2}}, {{0, -3}, {9, -3}}, {{
     0, -4}, {9, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -2}, {3, -1}, {3, -4}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -3.4}, {3.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -3.4}, {4.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -1}, {5, -3}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -3.4}, {5.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -1}, {7, -2}}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox[
       OverscriptBox["\<\"x\"\>", "~"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", 
         OverscriptBox["\"x\"", "~"]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -1.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.044444444444444446`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->370.8,
   PlotRange->{{0, 9}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[1, QuantumMob`Q3`$]}, 
    $CellContext`S[4, 
     C[4]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[1, QuantumMob`Q3`$]}, 
    $CellContext`S[3, 
     C[3]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledPower[{
     $CellContext`S[1, QuantumMob`Q3`$]}, 
    $CellContext`S[2, 
     C[2]], {"ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[1, 6]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->634544436,ExpressionUUID->"f896b573-a1b3-4116-9572-3d471b8c7ce2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuantumCircuit", "[", 
  RowBox[{
   RowBox[{"QBR", "[", "SS", "]"}], ",", 
   RowBox[{"Unfold", "@", 
    RowBox[{"Rest", "[", "else", "]"}]}]}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1371099242,ExpressionUUID->"835f07a9-29dc-45b2-978f-463fdf2b9a05"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {12, -1}}, {{0, -2}, {12, -2}}, {{0, -3}, {12, -3}}, {{
     0, -4}, {12, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -0.6}]}, InsetBox[
      StyleBox["\<\"QBR\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -4.4}, {2.4, -3.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {2., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -4}}], 
     DiskBox[{3, -3}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         TemplateBox[{"2", "2"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -4}}], 
     DiskBox[{4, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -4.4}, {4.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {4., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -1}, {5, -4}}], 
     DiskBox[{5, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -4.4}, {5.4, -3.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "4", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {5., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -3.4}, {6.4, -2.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {6., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -3}}], 
     DiskBox[{7, -2}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -3.4}, {7.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", 
         TemplateBox[{"2", "1"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {7., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -1}, {8, -3}}], 
     DiskBox[{8, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -3.4}, {8.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "3", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {8., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {9., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{10, -1}, {10, -2}}], 
     DiskBox[{10, -1}, 0.09], 
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -2.4}, {10.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"Z\"", "2", 
         TemplateBox[{"2", "0"}, "Superscript", SyntaxForm -> SuperscriptBox]},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.021666666666666667`],
       FontWeight->"Light",
       FontSlant->Italic], {10., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{10.6, -1.4}, {11.4, -0.6}]}, InsetBox[
      StyleBox["\<\"H\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03333333333333333],
       FontWeight->"Light",
       FontSlant->Italic], {11., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->478.8,
   PlotRange->{{0, 12}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[
   QuantumMob`Q3`QBR[{
     $CellContext`S[1, QuantumMob`Q3`$], 
     $CellContext`S[2, QuantumMob`Q3`$], 
     $CellContext`S[3, QuantumMob`Q3`$], 
     $CellContext`S[4, QuantumMob`Q3`$]}], 
   $CellContext`S[4, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[3, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     $CellContext`S[4, 
      C[2]], {
      $CellContext`S[4, QuantumMob`Q3`$]}], "Label" -> 
    Subsuperscript["Z", 4, 
      Superscript[2, 2]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     $CellContext`S[4, 
      C[3]], {
      $CellContext`S[4, QuantumMob`Q3`$]}], "Label" -> 
    Subsuperscript["Z", 4, 
      Superscript[2, 1]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     $CellContext`S[4, 
      C[4]], {
      $CellContext`S[4, QuantumMob`Q3`$]}], "Label" -> 
    Subsuperscript["Z", 4, 
      Superscript[2, 0]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[3, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[2, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     $CellContext`S[3, 
      C[2]], {
      $CellContext`S[3, QuantumMob`Q3`$]}], "Label" -> 
    Subsuperscript["Z", 3, 
      Superscript[2, 1]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     $CellContext`S[3, 
      C[3]], {
      $CellContext`S[3, QuantumMob`Q3`$]}], "Label" -> 
    Subsuperscript["Z", 3, 
      Superscript[2, 0]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[2, 6], 
   QuantumMob`Q3`ControlledGate[{$CellContext`S[1, QuantumMob`Q3`$] -> 1}, 
    QuantumMob`Q3`ActOn[
     $CellContext`S[2, 
      C[2]], {
      $CellContext`S[2, QuantumMob`Q3`$]}], "Label" -> 
    Subsuperscript["Z", 2, 
      Superscript[2, 0]], "LabelSize" -> 0.65, {
    "ControlLabel" -> OverTilde["x"]}, "ControlLabel" -> "x"], 
   $CellContext`S[1, 6]]]], "Output",
 CellLabel->"Out[2]=",
 CellID->384544850,ExpressionUUID->"115059e5-27d9-4268-a19e-dd8efd4983d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Matrix", "[", "qft", "]"}], "-", 
   RowBox[{"Matrix", "[", "else", "]"}]}], "//", "ArrayZeroQ"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->830254185,ExpressionUUID->"b5d29866-bc83-4ad1-97c3-ec1c51707e8c"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[3]=",
 CellID->1267000127,ExpressionUUID->"7ff80c0d-860e-4ea4-8ba6-a855376426a8"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "5"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "6"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "5f11162c-2793-4440-ae79-3d95e76f26a6"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"46ffa5ac-18d1-4fa2-b948-d156dba1a56f"],
 "Relation to QCR",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "374ec9da-2ae5-45c7-a3c4-093a7212bf1b"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->14250838,ExpressionUUID->"7a2c1ea0-f5bf-4c3d-950c-c37baba76efd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->2123085903,ExpressionUUID->"98b69741-4a26-425a-b0d8-edafa4f8a100"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1886460350,ExpressionUUID->"631a62f5-26f8-4914-b576-7af56b6f9668"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, QuantumMob`Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "4"},
      "RowWithSeparators"]],
    $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->23290837,ExpressionUUID->"6a7e684f-bf8d-4cca-ab0b-316c1c881e5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"QFT", "[", "SS", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1903667663,ExpressionUUID->"40a8b1ad-1cc1-4794-917f-c281dfca0e11"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->607073705,ExpressionUUID->"b7453277-b1ac-40ee-a6e6-f96669e26ae8"]
}, Open  ]],

Cell["QFT gives QCR when squared.", "ExampleText",
 CellID->1569566381,ExpressionUUID->"7d1142ce-54c4-4749-ae5d-e543f01a6b2d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"op", "**", "op"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1815418686,ExpressionUUID->"f357938c-89a7-45a9-a197-5ef15ee10de9"],

Cell[BoxData[
 RowBox[{"QCR", "[", 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`S[1, QuantumMob`Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`S[2, QuantumMob`Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "3"},
       "RowWithSeparators"]],
     $CellContext`S[3, QuantumMob`Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "4"},
       "RowWithSeparators"]],
     $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}], "]"}]], "Output",
 CellLabel->"Out[4]=",
 CellID->392953038,ExpressionUUID->"4ebab746-f917-49f9-89ad-4c3f4a936eb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dagger", "[", "op", "]"}], "**", 
  RowBox[{"Dagger", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->2111279117,ExpressionUUID->"da8b964d-23d6-475f-bc5f-8895b19308a7"],

Cell[BoxData[
 RowBox[{"QCR", "[", 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "1"},
       "RowWithSeparators"]],
     $CellContext`S[1, QuantumMob`Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "2"},
       "RowWithSeparators"]],
     $CellContext`S[2, QuantumMob`Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "3"},
       "RowWithSeparators"]],
     $CellContext`S[3, QuantumMob`Q3`$]], ",", 
    InterpretationBox[
     SubscriptBox["S", 
      TemplateBox[{",", "\",\"", "4"},
       "RowWithSeparators"]],
     $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}], "]"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->849495141,ExpressionUUID->"70d0df7f-3ae4-408b-a5fe-1eb41a79407d"]
}, Open  ]],

Cell["QFT multiplied by QCR gives the inverse QFT.", "ExampleText",
 CellID->2085376287,ExpressionUUID->"f243f7dc-6b73-4c2a-97a6-d3a4385f89f3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "**", "op"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->188361022,ExpressionUUID->"5928a179-5c0b-4eee-b64c-a17aaf4ec4b6"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->993549531,ExpressionUUID->"f9617c13-9716-4fe6-8194-5b8f0cac7949"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "**", "new"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1415710222,ExpressionUUID->"1e671a8c-a484-4fe9-877b-ef3a3fd7b3a1"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1901612092,ExpressionUUID->"a189a716-fc13-430c-9137-debbdebbe7c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "**", 
  RowBox[{"Dagger", "[", "op", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1426344580,ExpressionUUID->"33596f86-d283-4fac-9229-db12c680aebc"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1542795590,ExpressionUUID->"955024f3-f0bb-4c4f-a7fd-78933d3e2133"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dagger", "[", "op", "]"}], "**", "new"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1919659908,ExpressionUUID->"571242f8-666a-4703-a9de-3362b4bdee1c"],

Cell[BoxData[
 RowBox[{"QFT", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "1"},
        "RowWithSeparators"]],
      $CellContext`S[1, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`S[2, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "3"},
        "RowWithSeparators"]],
      $CellContext`S[3, QuantumMob`Q3`$]], ",", 
     InterpretationBox[
      SubscriptBox["S", 
       TemplateBox[{",", "\",\"", "4"},
        "RowWithSeparators"]],
      $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->1047927252,ExpressionUUID->"58d4cf48-ff43-404b-822e-dc73929b71c8"]
}, Open  ]],

Cell[TextData[{
 "The above property is summarized as follows in terms of the ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["MultiplyPower"]], "paclet:QuantumMob/Q3/ref/MultiplyPower", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7e1b8d23-04f6-42c6-bd96-54988126c12d"],
 "."
}], "ExampleText",
 CellID->906316646,ExpressionUUID->"a9901286-65ee-42f8-800c-a07e8a5417b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"MultiplyPower", "[", 
    RowBox[{"op", ",", "k"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "12"}], "}"}]}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->792357102,ExpressionUUID->"35b150fd-44ac-414e-a74e-83967eec3016"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", "1", ",", 
   
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", "1", ",", 
   
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", "1"}], 
  "}"}]], "Output",
 CellLabel->"Out[10]=",
 CellID->999935317,ExpressionUUID->"0d6bdb96-b96f-477c-9d6c-18af43a13080"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"MultiplyPower", "[", 
    RowBox[{
     RowBox[{"Dagger", "@", "op"}], ",", "k"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "12"}], "}"}]}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[11]:=",
 CellID->1604847720,ExpressionUUID->"025c8aa8-33d5-4e86-8c54-5892ee6013fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", "1", ",", 
   
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", "1", ",", 
   
   RowBox[{"QFT", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", 
   RowBox[{"QCR", "[", 
    RowBox[{"{", 
     RowBox[{
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "1"},
         "RowWithSeparators"]],
       $CellContext`S[1, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`S[2, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "3"},
         "RowWithSeparators"]],
       $CellContext`S[3, QuantumMob`Q3`$]], ",", 
      InterpretationBox[
       SubscriptBox["S", 
        TemplateBox[{",", "\",\"", "4"},
         "RowWithSeparators"]],
       $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}], "]"}], ",", 
   RowBox[{"QFT", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`S[1, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`S[2, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "3"},
          "RowWithSeparators"]],
        $CellContext`S[3, QuantumMob`Q3`$]], ",", 
       InterpretationBox[
        SubscriptBox["S", 
         TemplateBox[{",", "\",\"", "4"},
          "RowWithSeparators"]],
        $CellContext`S[4, QuantumMob`Q3`$]]}], "}"}]}], "]"}], ",", "1"}], 
  "}"}]], "Output",
 CellLabel->"Out[11]=",
 CellID->1853335044,ExpressionUUID->"9e8bff17-8dd0-461d-92b7-afcd262eef37"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "6"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QBR"]], "paclet:QuantumMob/Q3/ref/QBR", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "de08e364-0fc1-4d1a-8131-32350dc7d61d"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QCR"]], "paclet:QuantumMob/Q3/ref/QCR", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "4dd1a922-8c01-419c-8e13-d3089a5986bc"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ControlledPower"]], 
           "paclet:QuantumMob/Q3/ref/ControlledPower", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "7b47bc80-1ea3-45f2-9d04-aba3c009530b"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CNOT"]], "paclet:QuantumMob/Q3/ref/CNOT", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "f84e3fa5-e75d-4752-babc-612f5f0a9aea"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Hadamard"]], "paclet:QuantumMob/Q3/ref/Hadamard", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "76fa6d3c-0d1d-4beb-bda6-a76f33c7f696"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Fourier"]], "paclet:ref/Fourier"},
          "RefLink",
          BaseStyle->{"InlineFormula"}]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "62f1f906-12dc-46ce-b527-5f9cfa4ceaa0"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FourierMatrix"]], "paclet:ref/FourierMatrix"},
          "RefLink",
          BaseStyle->{"InlineFormula"}]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "3295cd74-d93f-44bc-b2c4-af6115d39dd4"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["MultiplyPower"]], 
           "paclet:QuantumMob/Q3/ref/MultiplyPower", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "389449df-4d23-49d4-9bc3-c9d1a4e70f49"]
       }], "SeeAlso",ExpressionUUID->"6ac6eec2-3bcd-464f-9339-3947d7c9710a"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"f3b42976-3d88-41ba-a050-\
94eda559892c"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Fourier Transform"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumFourierTransform"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "0d7f782a-5be3-42c3-8466-8b8e435650d6"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "b14a5cdf-b180-4e41-ab0e-ab1357655bae"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quick Quantum Computing with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuickQuantumComputingWithQ3"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "7f6fd20c-c3f3-4866-8020-f41c773ea073"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], 
           "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "63584c64-c797-48b8-8457-bdc7366e74fb"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"3ad22f72-4948-4faa-8c0c-\
f26097c1272a"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "794b124e-417f-49e0-a52e-ffdddc99fbde"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "428c9a45-c955-4596-9115-df618b5a1967"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"07aee5ce-28c4-47db-95ac-\
00f4d52b7141"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "24259085-7b7e-48e6-a1fd-fb1a1de44ba1"]}]],ExpressionUUID->
         "cc31c3be-e3e5-4052-b950-e677523e64a2"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "RelatedLinks",ExpressionUUID->
        "eb21c04f-2e14-4746-8dbd-bc11e0050006"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "D. Coppersmith (1994)"}]]]], 
             "https://arxiv.org/abs/quant-ph/0201067"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "a4866502-ad47-4e8c-a980-1fcb641be7af"]}]],ExpressionUUID->
         "5e5734be-0452-426d-adbd-05dbc8670c65"],
        StyleBox[
        ", IBM Research Report No. RC19642, \"An Approximate Fourier \
Transform Useful in Quantum Factoring.\"",
         FontSlant->"Plain"]
       }], "RelatedLinks",ExpressionUUID->
        "0f28ca11-1bc4-4a61-a738-72ae002d60c5"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "A. Barenco et al. (1996)"}]]]], 
             "https://doi.org/10.1103/physreva.54.139"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "1ec54ea3-4c34-4bd8-83d7-c850ae5e033f"]}]],ExpressionUUID->
         "fa98bba8-3d9b-4402-a9fb-104c04992d99"],
        ", Physical Review A 54, 139 (1996), \"Approximate quantum Fourier \
transform and decoherence.\""
       }], "RelatedLinks",ExpressionUUID->
        "e4da4fc9-e374-4489-999b-24ef74dd5023"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "46288179-8990-4782-b516-e140a4612f88"]}]],ExpressionUUID->
         "a0bd0523-4b9d-424d-8705-66560ae88591"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "7091c88f-8cd9-4944-95cb-2b9d3acd34c4"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"d096dc47-95ca-41d2-83ab-\
e2909fcfdfbd"],

Cell[" ", "FooterCell",ExpressionUUID->"f994d702-40e8-4851-8c8f-2c8142fe43e6"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"QFT",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed, "3" -> Closed}, 
    "AllOptsTable" -> Closed, "NotesSection" -> Closed, 
    "ExampleSubsection" -> {
     "0" -> Closed, "1" -> Closed, "2" -> Closed, "3" -> Closed, "4" -> 
      Closed, "5" -> Closed, "6" -> Closed}}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 1, 2, 19, 1, 52.506217}", 
    "history" -> {"13", "14.0", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {"quantum Fourier transform"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> "QuantumMob/Q3",
     "status" -> "None", "summary" -> 
    "QFT[{s1, s2, ...}] represents the quantum Fourier transform on the \
qubits {s1, s2, ...}. QFT[type, {s1, s2, ...}] is the full form of QFT, where \
type = \\[PlusMinus]1 indicates the Fourier or inverse Fourier transform.", 
    "synonyms" -> {}, "tabletags" -> {}, "title" -> "QFT", "titlemodifier" -> 
    "", "metadescription" -> "", "windowtitle" -> "QFT", "type" -> "Symbol", 
    "uri" -> "QuantumMob/Q3/ref/QFT"}},
CellContext->"Global`",
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"ac3767fc-fb14-4f76-874f-c6cc803207cd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[27179, 769, 1441, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"ffcfa995-ac09-47b2-a3ad-6b16c357efce",
   CellTags->"PrimaryExamplesSection",
   CellID->435466263]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 410265, 11377}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[571, 21, 8402, 198, 70, "AnchorBarGrid",ExpressionUUID->"08373b90-031c-434f-a656-c21ada2224a6",
 CellID->1],
Cell[8976, 221, 96, 0, 70, "ContextNameCell",ExpressionUUID->"dd16ab0e-894b-4a62-8e09-c23bb9316834"],
Cell[CellGroupData[{
Cell[9097, 225, 1146, 30, 70, "ObjectNameGrid",ExpressionUUID->"87177906-f997-4643-8946-df222de872e8"],
Cell[10246, 257, 2748, 77, 70, "Usage",ExpressionUUID->"1aecc75b-f5f4-4609-a60a-f8542765c121",
 CellID->1825953146]
}, Open  ]],
Cell[CellGroupData[{
Cell[13031, 339, 1850, 45, 70, "NotesSection",ExpressionUUID->"faf298c3-e999-4691-924b-38145d577e3d",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->771775849],
Cell[14884, 386, 1381, 44, 70, "Notes",ExpressionUUID->"49b81dc9-44fc-4061-8403-1481401b57c4",
 CellID->59811791],
Cell[16268, 432, 1717, 57, 70, "Notes",ExpressionUUID->"af5933f8-a5f5-4cd6-a984-059b715e773c",
 CellID->1688628346],
Cell[17988, 491, 770, 22, 70, "Notes",ExpressionUUID->"f44c55d4-f009-405d-8078-03ad12b4598c",
 CellID->1585121827],
Cell[18761, 515, 1772, 57, 70, "Notes",ExpressionUUID->"a798d813-c7b2-4c8c-88ce-d08a320c71ae",
 CellID->1475780666],
Cell[20536, 574, 1647, 53, 70, "Notes",ExpressionUUID->"2c47c9b6-ce4c-4c45-a76a-a861ca679db5",
 CellID->2122196282],
Cell[22186, 629, 900, 28, 70, "Notes",ExpressionUUID->"0e5cd147-e4ab-41a7-99dd-a51260b3c8da",
 CellID->1817891589],
Cell[23089, 659, 1632, 52, 70, "Notes",ExpressionUUID->"695fb418-99d6-4fe5-9729-3636f10b6e8c",
 CellID->1529489266],
Cell[24724, 713, 2328, 50, 70, "3ColumnTableMod",ExpressionUUID->"c28a9fe0-7504-47b6-b069-0ede1e0b4071",
 CellID->230984232]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[27179, 769, 1441, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"ffcfa995-ac09-47b2-a3ad-6b16c357efce",
 CellTags->"PrimaryExamplesSection",
 CellID->435466263],
Cell[28623, 809, 203, 3, 70, "Input",ExpressionUUID->"3254928f-5ab4-4c66-b723-24edeb00e059",
 CellID->1420320264],
Cell[CellGroupData[{
Cell[28851, 816, 1418, 37, 70, "ExampleSection",ExpressionUUID->"068c90cf-1f5e-4f46-ba40-839c81ca752f",
 CellID->257213265],
Cell[30272, 855, 150, 1, 70, "ExampleText",ExpressionUUID->"c1de3973-d3a4-41d0-b53f-404ba6732740",
 CellID->324198160],
Cell[30425, 858, 220, 5, 70, "Input",ExpressionUUID->"235d3657-01d9-4841-a719-38fe6edcd2c1",
 CellID->1417611086],
Cell[30648, 865, 177, 3, 70, "ExampleText",ExpressionUUID->"b09155ae-4529-4544-8deb-f81e73aa0fd6",
 CellID->1975652896],
Cell[CellGroupData[{
Cell[30850, 872, 340, 9, 70, "Input",ExpressionUUID->"a4a05a9e-65af-4232-9532-40a10b1682e2",
 CellID->1538344178],
Cell[31193, 883, 629, 19, 70, "Output",ExpressionUUID->"4bfe1430-e1c5-42de-bc1a-e3b335e366f9",
 CellID->1200018272]
}, Open  ]],
Cell[31837, 905, 116, 1, 70, "ExampleText",ExpressionUUID->"cadf8be3-5efa-47da-a3fa-2665bbc741c4",
 CellID->1011065769],
Cell[CellGroupData[{
Cell[31978, 910, 217, 5, 70, "Input",ExpressionUUID->"57c54469-5e58-47d2-bbb1-ad86bdb34568",
 CellID->907845956],
Cell[32198, 917, 715, 21, 70, "Output",ExpressionUUID->"f7fd8eca-68ba-42e1-95cf-96fa65086294",
 CellID->1688168527]
}, Open  ]],
Cell[32928, 941, 141, 1, 70, "ExampleText",ExpressionUUID->"7e040525-199b-49ac-a39d-577bfe570e7b",
 CellID->1487001751],
Cell[CellGroupData[{
Cell[33094, 946, 227, 5, 70, "Input",ExpressionUUID->"5bb14ef2-2936-42ee-87e4-07945b6914e6",
 CellID->16748836],
Cell[33324, 953, 1007, 25, 70, "Output",ExpressionUUID->"71821292-aa1c-4e95-91ea-f9150d2efc5e",
 CellID->494489125]
}, Open  ]],
Cell[34346, 981, 205, 4, 70, "ExampleText",ExpressionUUID->"6271b892-1d77-4c84-95e6-2ffc9e8645f0",
 CellID->484950209],
Cell[CellGroupData[{
Cell[34576, 989, 222, 5, 70, "Input",ExpressionUUID->"b63f62aa-6abe-42f4-aaec-bd95d327af13",
 CellID->2033637476],
Cell[34801, 996, 4538, 113, 70, "Output",ExpressionUUID->"4c6eeef6-514f-4a03-9da5-fb39a21ac439",
 CellID->117009985]
}, Open  ]],
Cell[39354, 1112, 196, 4, 70, "ExampleText",ExpressionUUID->"200857eb-73d5-4887-a55b-802f8f98c571",
 CellID->288030098],
Cell[CellGroupData[{
Cell[39575, 1120, 224, 5, 70, "Input",ExpressionUUID->"b50bb193-4d1a-47f0-bb89-1095fc4e3b79",
 CellID->362956318],
Cell[39802, 1127, 4063, 103, 70, "Output",ExpressionUUID->"b5309a05-684d-4d83-99b5-581dce906eee",
 CellID->1639280890]
}, Open  ]],
Cell[43880, 1233, 151, 1, 70, "ExampleText",ExpressionUUID->"7e234375-4902-407d-ac61-f6eb48710bc0",
 CellID->532983359],
Cell[CellGroupData[{
Cell[44056, 1238, 226, 5, 70, "Input",ExpressionUUID->"d184610a-7ad4-4bc2-8225-f25156bcfd76",
 CellID->1463562962],
Cell[44285, 1245, 18954, 485, 70, "Output",ExpressionUUID->"ed23321e-8907-4c16-8236-f923dd7f4887",
 CellID->1326210867]
}, Open  ]],
Cell[CellGroupData[{
Cell[63276, 1735, 198, 4, 70, "Input",ExpressionUUID->"c76f0f7c-dbc5-426e-9441-a38401dae6bd",
 CellID->1164635486],
Cell[63477, 1741, 8704, 307, 70, "Output",ExpressionUUID->"1616a895-2263-4d77-b117-f34dce12e744",
 CellID->893269456]
}, Open  ]],
Cell[72196, 2051, 144, 1, 70, "ExampleText",ExpressionUUID->"f830d316-4682-4302-a295-b5b81df1a9ee",
 CellID->1728281487],
Cell[CellGroupData[{
Cell[72365, 2056, 221, 5, 70, "Input",ExpressionUUID->"8aac366f-665a-4727-bdb3-6d442587298f",
 CellID->738769794],
Cell[72589, 2063, 733, 22, 70, "Output",ExpressionUUID->"e6fa39b3-b049-4920-a029-faf59ad1f4dc",
 CellID->121570815]
}, Open  ]],
Cell[CellGroupData[{
Cell[73359, 2090, 190, 4, 70, "Input",ExpressionUUID->"ce5c8a93-99d0-4477-9bed-4a56f63ca378",
 CellID->697008013],
Cell[73552, 2096, 127, 2, 70, "Output",ExpressionUUID->"4867e3fb-3e67-4e7b-83a6-36452d5a2773",
 CellID->983739408]
}, Open  ]],
Cell[73694, 2101, 146, 1, 70, "ExampleText",ExpressionUUID->"097c9739-7066-4b1e-ae43-286d024f0952",
 CellID->1338994217],
Cell[CellGroupData[{
Cell[73865, 2106, 306, 7, 70, "Input",ExpressionUUID->"1576d35f-e37b-48f9-81bb-6b3ad9f05650",
 CellID->1065133665],
Cell[74174, 2115, 8315, 291, 70, "Output",ExpressionUUID->"4faec8d0-96a5-48ff-9d8d-1a3bb28dfe9d",
 CellID->231632003]
}, Open  ]],
Cell[82504, 2409, 468, 13, 70, "ExampleText",ExpressionUUID->"323b6d11-13b7-4103-aa67-b894bcc8be4f",
 CellID->21662866],
Cell[CellGroupData[{
Cell[82997, 2426, 312, 7, 70, "Input",ExpressionUUID->"f323926c-38e0-436b-9f37-ae4e5dfd96d6",
 CellID->1935243801],
Cell[83312, 2435, 8316, 291, 70, "Output",ExpressionUUID->"d8a9021e-70f1-439d-869f-b1c6a6d0ef72",
 CellID->1798706057]
}, Open  ]],
Cell[CellGroupData[{
Cell[91665, 2731, 224, 5, 70, "Input",ExpressionUUID->"1ad4eb6d-5e21-4b89-b852-b4ecc6fbbdba",
 CellID->1610672650],
Cell[91892, 2738, 935, 23, 70, "Output",ExpressionUUID->"830af6b9-5d8a-44cf-923b-e1f590a0fea0",
 CellID->725401180]
}, Open  ]],
Cell[CellGroupData[{
Cell[92864, 2766, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"11c8811d-ee79-4591-a97c-82a6fefe33e0",
 CellID->566965640],
Cell[93109, 2773, 123, 1, 70, "ExampleText",ExpressionUUID->"a2582fa9-955c-4e2f-b250-8fb7e04183c4",
 CellID->916988046],
Cell[CellGroupData[{
Cell[93257, 2778, 450, 13, 70, "Input",ExpressionUUID->"497763dc-b521-41a8-811f-1430f9229dac",
 CellID->512764678],
Cell[93710, 2793, 2361, 56, 70, "Output",ExpressionUUID->"7934510c-228a-4bfe-8c41-14b983a89587",
 CellID->552968241]
}, Open  ]],
Cell[96086, 2852, 131, 1, 70, "ExampleText",ExpressionUUID->"00887498-7b38-4c3a-bd4c-d99a50e07a1e",
 CellID->801708978],
Cell[CellGroupData[{
Cell[96242, 2857, 214, 5, 70, "Input",ExpressionUUID->"72ae143e-5e85-422e-89f1-c317b2ba89fd",
 CellID->1459809595],
Cell[96459, 2864, 9228, 232, 70, "Output",ExpressionUUID->"af65aafb-7325-4bdd-962c-6a0802f1397d",
 CellID->1575485918]
}, Open  ]],
Cell[105702, 3099, 311, 5, 70, "ExampleText",ExpressionUUID->"26900138-802a-435d-aa54-f84112c9f055",
 CellID->358410394],
Cell[CellGroupData[{
Cell[106038, 3108, 302, 7, 70, "Input",ExpressionUUID->"8daedc1c-b4f1-4ef6-9909-4a0384101d68",
 CellID->1154479820],
Cell[106343, 3117, 1432, 51, 70, "Output",ExpressionUUID->"75f69d48-8d98-468a-9c8a-7f9de095bd3e",
 CellID->718456316]
}, Open  ]],
Cell[CellGroupData[{
Cell[107812, 3173, 326, 8, 70, "Input",ExpressionUUID->"dc9a7b05-05c8-4326-9727-3f740c970844",
 CellID->618910181],
Cell[108141, 3183, 266, 6, 70, "Output",ExpressionUUID->"80a7fd1c-58a3-40fa-ba20-69a0cfe39264",
 CellID->1942239578]
}, Open  ]],
Cell[CellGroupData[{
Cell[108444, 3194, 294, 7, 70, "Input",ExpressionUUID->"f2ede561-8f18-4d44-a2c3-e020bf96cb32",
 CellID->1134493565],
Cell[108741, 3203, 1915, 65, 70, "Output",ExpressionUUID->"45f98600-385b-482a-84ce-f30cd2a4fdc7",
 CellID->1469153046]
}, Open  ]],
Cell[CellGroupData[{
Cell[110693, 3273, 253, 7, 70, "Input",ExpressionUUID->"c8e0787d-4e9b-43e1-953c-6110a06bbd0c",
 CellID->2095659547],
Cell[110949, 3282, 237, 6, 70, "Output",ExpressionUUID->"54c15958-579c-4304-902c-ac35caa40257",
 CellID->288270916]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[111235, 3294, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"a74e5fa5-c701-4dca-945e-facd0e67775f",
 CellID->633346104],
Cell[111480, 3301, 295, 5, 70, "ExampleText",ExpressionUUID->"f0102df7-ff04-42fa-bac8-1b01e289b7ac",
 CellID->1225739319],
Cell[CellGroupData[{
Cell[111800, 3310, 274, 6, 70, "Input",ExpressionUUID->"d548879d-0a99-48d5-8e75-232b25a2c7c3",
 CellID->1645416489],
Cell[112077, 3318, 771, 22, 70, "Output",ExpressionUUID->"38147f2c-03e8-4929-b630-8243ad9e9a73",
 CellID->246177580]
}, Open  ]],
Cell[CellGroupData[{
Cell[112885, 3345, 216, 5, 70, "Input",ExpressionUUID->"8cdd5579-db9f-42ac-9fa5-fab95e288e04",
 CellID->511943956],
Cell[113104, 3352, 772, 22, 70, "Output",ExpressionUUID->"74823631-659e-4a4d-ae69-202685624f9c",
 CellID->1453082938]
}, Open  ]],
Cell[CellGroupData[{
Cell[113913, 3379, 201, 4, 70, "Input",ExpressionUUID->"56e8ec25-187e-4394-a7ea-b63d42acaced",
 CellID->2120710401],
Cell[114117, 3385, 18837, 441, 70, "Output",ExpressionUUID->"d0bb169a-bcf9-431f-a5d5-18093f8f8611",
 CellID->780905282]
}, Open  ]],
Cell[CellGroupData[{
Cell[132991, 3831, 231, 5, 70, "Input",ExpressionUUID->"f1e9dcef-b4a9-4406-926e-887a38c55718",
 CellID->1149083753],
Cell[133225, 3838, 5347, 111, 70, "Output",ExpressionUUID->"b13513a0-57e2-4e10-aadd-53992e204e6e",
 CellID->1402507757]
}, Open  ]],
Cell[CellGroupData[{
Cell[138609, 3954, 219, 5, 70, "Input",ExpressionUUID->"4ba742fb-8049-4553-a16a-80caf49e393d",
 CellID->860433650],
Cell[138831, 3961, 9039, 213, 70, "Output",ExpressionUUID->"6852c7a2-6933-4a2a-9f27-a7409dd3ddf7",
 CellID->1167362427]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[147919, 4180, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"1746f770-3242-4492-a61a-e35e7e3e8268",
 CellID->1755184417],
Cell[148165, 4187, 150, 1, 70, "ExampleText",ExpressionUUID->"c13aaf69-4cb9-4bcb-91c5-125ac4238f8f",
 CellID->182857608],
Cell[CellGroupData[{
Cell[148340, 4192, 222, 5, 70, "Input",ExpressionUUID->"81b6aa78-4dcd-40a1-9876-ea2f5b9c58ef",
 CellID->2015855374],
Cell[148565, 4199, 733, 22, 70, "Output",ExpressionUUID->"09f56d19-e879-4c65-a1e9-6e7ff7c2adab",
 CellID->449711597]
}, Open  ]],
Cell[CellGroupData[{
Cell[149335, 4226, 201, 4, 70, "Input",ExpressionUUID->"dd38a8b0-80bd-4f29-a54b-cc528ae8976c",
 CellID->1813718867],
Cell[149539, 4232, 18954, 485, 70, "Output",ExpressionUUID->"5c7675b7-a8cd-4be9-acc2-1a93f937db33",
 CellID->1307856986]
}, Open  ]],
Cell[CellGroupData[{
Cell[168530, 4722, 190, 4, 70, "Input",ExpressionUUID->"b7c0e4be-2962-4f4c-b26e-68786ea7c907",
 CellID->1457601367],
Cell[168723, 4728, 127, 2, 70, "Output",ExpressionUUID->"d1f5c5c4-9ac0-400d-897d-f0d63217eebe",
 CellID->1657236657]
}, Open  ]],
Cell[CellGroupData[{
Cell[168887, 4735, 190, 4, 70, "Input",ExpressionUUID->"d9290b84-6767-4b49-9576-757d5f20f4c5",
 CellID->1455047160],
Cell[169080, 4741, 126, 2, 70, "Output",ExpressionUUID->"7341ec2b-6132-461d-9570-65ced1f5ddb0",
 CellID->313592609]
}, Open  ]],
Cell[CellGroupData[{
Cell[169243, 4748, 306, 7, 70, "Input",ExpressionUUID->"4771d3d9-2b0f-4a75-a938-76d9a259a16a",
 CellID->1456139501],
Cell[169552, 4757, 8314, 291, 70, "Output",ExpressionUUID->"e799fe6e-0557-46c0-b958-967f11a592f8",
 CellID->626109725]
}, Open  ]],
Cell[CellGroupData[{
Cell[177903, 5053, 265, 7, 70, "Input",ExpressionUUID->"7f0b93c1-0cf7-4734-8036-1014dc78e60e",
 CellID->1935546351],
Cell[178171, 5062, 934, 23, 70, "Output",ExpressionUUID->"880f7472-4853-4a00-8a17-0e5d72f4ec27",
 CellID->356277775]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[179266, 5094, 1323, 35, 70, "ExampleSection",ExpressionUUID->"c7b59fe0-5fef-4d94-a3d0-11d3ee0fd259",
 CellID->1502926422],
Cell[CellGroupData[{
Cell[180614, 5133, 1347, 35, 70, "ExampleSubsection",ExpressionUUID->"96d872b8-83a1-4472-b860-9271044e057c",
 CellID->148318357],
Cell[181964, 5170, 219, 5, 70, "Input",ExpressionUUID->"73bb9b41-97e6-4ab3-8f53-aa2b2ae88641",
 CellID->606512430],
Cell[CellGroupData[{
Cell[182208, 5179, 340, 9, 70, "Input",ExpressionUUID->"3f9683c3-55b6-40c5-a376-c3527b126074",
 CellID->1191141124],
Cell[182551, 5190, 787, 24, 70, "Output",ExpressionUUID->"b98e08fd-0b1a-47a5-8c3f-8f43d2fbf618",
 CellID->776156589]
}, Open  ]],
Cell[CellGroupData[{
Cell[183375, 5219, 218, 5, 70, "Input",ExpressionUUID->"02a74c75-e9f7-44f6-b588-aec63b4a2460",
 CellID->1124287029],
Cell[183596, 5226, 884, 26, 70, "Output",ExpressionUUID->"93990ba8-708e-4894-9116-a18e5ced2b5c",
 CellID->1048119445]
}, Open  ]],
Cell[184495, 5255, 169, 3, 70, "ExampleText",ExpressionUUID->"8109ed3d-36f3-470e-b1e7-909125343617",
 CellID->525586742],
Cell[CellGroupData[{
Cell[184689, 5262, 228, 5, 70, "Input",ExpressionUUID->"586638ab-db73-4dae-8c92-f46e5b317aa8",
 CellID->776477862],
Cell[184920, 5269, 1077, 27, 70, "Output",ExpressionUUID->"014866a8-6ff9-4762-b0cf-a1c4890ab050",
 CellID->2082639421]
}, Open  ]],
Cell[186012, 5299, 1113, 35, 70, "ExampleText",ExpressionUUID->"38a8e80a-cb47-4d64-9628-aa0853828587",
 CellID->1382320030],
Cell[CellGroupData[{
Cell[187150, 5338, 222, 5, 70, "Input",ExpressionUUID->"e0b9e1e1-3cec-4c3a-8f83-874fab762bc9",
 CellID->1879716809],
Cell[187375, 5345, 6246, 155, 70, "Output",ExpressionUUID->"607348c5-86cb-45c8-8913-2494af6fdede",
 CellID->1084786294]
}, Open  ]],
Cell[193636, 5503, 203, 4, 70, "ExampleText",ExpressionUUID->"3a0b883d-957d-4c63-9d39-9976aa1ffd20",
 CellID->1011808894],
Cell[CellGroupData[{
Cell[193864, 5511, 225, 5, 70, "Input",ExpressionUUID->"cd0b37ba-d12c-4125-a50e-090da0dae653",
 CellID->1094389178],
Cell[194092, 5518, 6518, 161, 70, "Output",ExpressionUUID->"a52434b4-b5bb-41a2-ac07-9573dd4e9016",
 CellID->2014563875]
}, Open  ]],
Cell[CellGroupData[{
Cell[200647, 5684, 335, 9, 70, "Input",ExpressionUUID->"4d2213ec-7027-40d5-856d-bb14ce39bb7b",
 CellID->1034640886],
Cell[200985, 5695, 2179, 51, 70, "Output",ExpressionUUID->"a4c6cbfd-5302-4a29-845c-762cb3d2dd83",
 CellID->1547868523]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[203316, 5754, 1342, 35, 70, "ExampleSubsection",ExpressionUUID->"5dc4bba5-a131-4c5d-9428-5fa2d4003abb",
 CellID->2092774907],
Cell[204661, 5791, 789, 22, 70, "ExampleText",ExpressionUUID->"15c33d3e-ce7e-49e1-9a8b-e90d43da0552",
 CellID->402065520],
Cell[205453, 5815, 124, 1, 70, "ExampleText",ExpressionUUID->"fc3935c0-9148-42e2-834c-de6b98d1e527",
 CellID->1447727308],
Cell[205580, 5818, 220, 5, 70, "Input",ExpressionUUID->"cb0505e9-8d1a-4a7a-aba3-339825513904",
 CellID->1080511405],
Cell[205803, 5825, 130, 1, 70, "ExampleText",ExpressionUUID->"cf70ed41-e6d6-4e79-ba91-0b6084410fdf",
 CellID->2134534541],
Cell[CellGroupData[{
Cell[205958, 5830, 340, 9, 70, "Input",ExpressionUUID->"879fcdd0-9f67-44b2-a0fe-9c122d5cd79a",
 CellID->1033464803],
Cell[206301, 5841, 946, 29, 70, "Output",ExpressionUUID->"b36061fa-5cd0-44d1-813b-f72a4d9933f7",
 CellID->409366303]
}, Open  ]],
Cell[207262, 5873, 119, 1, 70, "ExampleText",ExpressionUUID->"a1158884-1328-4fa2-b43f-399698ffe118",
 CellID->963393444],
Cell[CellGroupData[{
Cell[207406, 5878, 217, 5, 70, "Input",ExpressionUUID->"a279e164-e03c-47a6-80e8-35771f0ae4f4",
 CellID->666649869],
Cell[207626, 5885, 1053, 31, 70, "Output",ExpressionUUID->"a6e4e724-1bfa-43d7-9c7a-4e56d2ad178b",
 CellID->1829333180]
}, Open  ]],
Cell[208694, 5919, 141, 1, 70, "ExampleText",ExpressionUUID->"e4a77fc0-480d-4cd0-9c70-9b8777221929",
 CellID->1551454917],
Cell[CellGroupData[{
Cell[208860, 5924, 266, 6, 70, "Input",ExpressionUUID->"c5b1c45f-83a7-48f7-bf6e-715beb40369c",
 CellID->502922478],
Cell[209129, 5932, 9528, 233, 70, "Output",ExpressionUUID->"444a6c4e-e3fa-4fb6-9492-0015f3c45693",
 CellID->79382161]
}, Open  ]],
Cell[218672, 6168, 645, 19, 70, "ExampleText",ExpressionUUID->"8c385534-a2b2-46b4-9273-98806dac2e7c",
 CellID->780825452],
Cell[CellGroupData[{
Cell[219342, 6191, 299, 7, 70, "Input",ExpressionUUID->"94cfdc82-1fc0-4c72-8278-b6eecfced5e8",
 CellID->60804947],
Cell[219644, 6200, 5792, 143, 70, "Output",ExpressionUUID->"73f6a9d2-926c-4903-8363-c1c6aa39b110",
 CellID->588635140]
}, Open  ]],
Cell[CellGroupData[{
Cell[225473, 6348, 300, 7, 70, "Input",ExpressionUUID->"88d882f3-28ee-4170-89fc-10c8a51a6c64",
 CellID->507971047],
Cell[225776, 6357, 7650, 188, 70, "Output",ExpressionUUID->"9b4b44e7-3c0f-4b20-8dcc-965ca4069007",
 CellID->1881119898]
}, Open  ]],
Cell[233441, 6548, 276, 5, 70, "ExampleText",ExpressionUUID->"c5057130-5cca-4e52-88ee-8e2efd8e468e",
 CellID->2102571339],
Cell[CellGroupData[{
Cell[233742, 6557, 353, 8, 70, "Input",ExpressionUUID->"b5e85964-6334-4ea9-8c37-3d18fd3c318d",
 CellID->2068345314],
Cell[234098, 6567, 7652, 188, 70, "Output",ExpressionUUID->"1da9adef-22a8-4cdd-81ea-40fb62033718",
 CellID->727874552]
}, Open  ]],
Cell[CellGroupData[{
Cell[241787, 6760, 293, 7, 70, "Input",ExpressionUUID->"eb0e72c0-7834-41b2-9322-5c7714e53d92",
 CellID->1878635140],
Cell[242083, 6769, 130, 2, 70, "Output",ExpressionUUID->"dce4a7ca-025f-4be6-b821-bce1f692e763",
 CellID->1320742152]
}, Open  ]],
Cell[242228, 6774, 120, 1, 70, "ExampleText",ExpressionUUID->"d176dd97-3e01-40f6-8d89-cb0a0a8ce7cf",
 CellID->1261157815],
Cell[CellGroupData[{
Cell[242373, 6779, 458, 13, 70, "Input",ExpressionUUID->"7fb09565-0fed-4327-88a6-37dead3ce3ce",
 CellID->1644589934],
Cell[242834, 6794, 145, 2, 70, "Output",ExpressionUUID->"f48ede93-d2e2-4f8c-a23d-29b4d32cb10a",
 CellID->1322373272]
}, Open  ]],
Cell[CellGroupData[{
Cell[243016, 6801, 459, 13, 70, "Input",ExpressionUUID->"547093bf-b787-49bd-9d15-5c38f0a2f355",
 CellID->1346215444],
Cell[243478, 6816, 144, 2, 70, "Output",ExpressionUUID->"e31cb36a-49d0-495d-9437-2b5cf276cfbd",
 CellID->819319701]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[243774, 6826, 1338, 35, 70, "ExampleSubsection",ExpressionUUID->"bb942073-8269-4fee-8290-1faa75fcf50b",
 CellID->1281406550],
Cell[245115, 6863, 1280, 35, 70, "ExampleText",ExpressionUUID->"f74573e4-4732-4882-a568-48e9be075660",
 CellID->1326551885],
Cell[246398, 6900, 515, 14, 70, "ExampleText",ExpressionUUID->"f6e62d5c-d3df-4eec-9e86-581155987beb",
 CellID->1844377872],
Cell[CellGroupData[{
Cell[246938, 6918, 423, 11, 70, "Input",ExpressionUUID->"91bb4bf6-2cee-4af6-92ec-ea19d824b40c",
 CellID->750101519],
Cell[247364, 6931, 628, 19, 70, "Output",ExpressionUUID->"8564ea64-e6a4-4662-9461-c8d527cb7a8f",
 CellID->641070143]
}, Open  ]],
Cell[CellGroupData[{
Cell[248029, 6955, 247, 6, 70, "Input",ExpressionUUID->"8fac43b4-66f8-4ed2-a488-0c356822aa5a",
 CellID->1601330061],
Cell[248279, 6963, 771, 22, 70, "Output",ExpressionUUID->"4e166821-7536-42f7-8450-c584fa38cff1",
 CellID->540436402]
}, Open  ]],
Cell[CellGroupData[{
Cell[249087, 6990, 229, 5, 70, "Input",ExpressionUUID->"416d55d9-9f73-48ea-8112-7cbe0c96c573",
 CellID->1749439152],
Cell[249319, 6997, 1027, 25, 70, "Output",ExpressionUUID->"a6f1ca3a-5049-4bac-b9fd-c6067cdbd383",
 CellID->1406265251]
}, Open  ]],
Cell[250361, 7025, 141, 1, 70, "ExampleText",ExpressionUUID->"e8f057f4-5703-4e91-8352-2af839ace63e",
 CellID->1188118867],
Cell[CellGroupData[{
Cell[250527, 7030, 284, 7, 70, "Input",ExpressionUUID->"75b0f79d-2c4e-4240-b4f2-f16ed17022e1",
 CellID->1516752790],
Cell[250814, 7039, 116, 1, 70, "EchoTiming",ExpressionUUID->"f5ec0c40-cc0f-470c-be87-991832d0418f",
 CellID->2042538322]
}, Open  ]],
Cell[CellGroupData[{
Cell[250967, 7045, 280, 7, 70, "Input",ExpressionUUID->"4f08800a-926e-48c0-b43a-3f8db418418e",
 CellID->2006007153],
Cell[251250, 7054, 116, 1, 70, "EchoTiming",ExpressionUUID->"fb203a43-3cad-4d84-a5da-3c593bfcfb82",
 CellID->1415480559]
}, Open  ]],
Cell[251381, 7058, 144, 1, 70, "ExampleText",ExpressionUUID->"d524f689-a486-467c-a7e6-d18095990dd8",
 CellID->122037108],
Cell[CellGroupData[{
Cell[251550, 7063, 449, 13, 70, "Input",ExpressionUUID->"a4b1977f-b563-47cc-b494-dc9e508cbc13",
 CellID->82863167],
Cell[252002, 7078, 2361, 56, 70, "Output",ExpressionUUID->"588d0f13-9531-4824-ad7f-91aba432f375",
 CellID->157913647]
}, Open  ]],
Cell[CellGroupData[{
Cell[254400, 7139, 252, 6, 70, "Input",ExpressionUUID->"01327bf8-77b8-4e52-973b-fa60c5fa8a9c",
 CellID->1043266157],
Cell[254655, 7147, 116, 1, 70, "EchoTiming",ExpressionUUID->"6cb91354-9053-43d3-bf32-277630ade8d2",
 CellID->1912361084],
Cell[254774, 7150, 9157, 216, 70, "Output",ExpressionUUID->"046bf4c0-8e2d-4139-bcec-b45387ccfa98",
 CellID->1812477786]
}, Open  ]],
Cell[CellGroupData[{
Cell[263968, 7371, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"1b3ef1cd-2c84-4221-91e9-4936eb0cf757",
 CellID->1166242150],
Cell[264214, 7378, 203, 4, 70, "ExampleText",ExpressionUUID->"6e4fcd99-f37f-4e36-84e2-71ac1503135c",
 CellID->643625537],
Cell[CellGroupData[{
Cell[264442, 7386, 259, 6, 70, "Input",ExpressionUUID->"b5f6070c-ea6b-4fee-8f6c-a31065a774da",
 CellID->1791312436],
Cell[264704, 7394, 4685, 115, 70, "Output",ExpressionUUID->"a8aefe1a-8063-4daa-bab0-2be45d7e79d9",
 CellID->258616607]
}, Open  ]],
Cell[269404, 7512, 242, 4, 70, "ExampleText",ExpressionUUID->"b16c0584-9ee0-4616-9fe9-8d73bda6795b",
 CellID->562437636],
Cell[CellGroupData[{
Cell[269671, 7520, 286, 7, 70, "Input",ExpressionUUID->"04461f27-f043-4128-8760-93c077c0b1d1",
 CellID->1949985825],
Cell[269960, 7529, 114, 1, 70, "EchoTiming",ExpressionUUID->"2e42e052-f8bd-4358-a37d-b51230cea007",
 CellID->62412321]
}, Open  ]],
Cell[270089, 7533, 152, 1, 70, "ExampleText",ExpressionUUID->"d30b0271-3753-4fad-9f25-fba2bd9b0ddf",
 CellID->1896345337],
Cell[CellGroupData[{
Cell[270266, 7538, 281, 7, 70, "Input",ExpressionUUID->"2874d714-f38d-4684-b1cd-78076c7788c7",
 CellID->803044201],
Cell[270550, 7547, 115, 1, 70, "EchoTiming",ExpressionUUID->"a3326a7f-1d52-4ed5-9935-d0ecd263cd1e",
 CellID->991859311]
}, Open  ]],
Cell[CellGroupData[{
Cell[270702, 7553, 255, 7, 70, "Input",ExpressionUUID->"7a395bef-0b0e-4929-9354-595676741e7e",
 CellID->1911716864],
Cell[270960, 7562, 935, 23, 70, "Output",ExpressionUUID->"5a9932e5-c8d6-4f5a-ba1a-cbe90abe0945",
 CellID->1411371963]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[271944, 7591, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"27220770-b849-419f-8e1c-0a709a73d665",
 CellID->948568881],
Cell[272189, 7598, 158, 2, 70, "ExampleText",ExpressionUUID->"f7cea1cc-9574-4c03-bb3f-80f78b9fe98c",
 CellID->1538911483],
Cell[CellGroupData[{
Cell[272372, 7604, 261, 6, 70, "Input",ExpressionUUID->"59130ec6-bdf7-4682-bcf3-3d690b5fa67a",
 CellID->192250313],
Cell[272636, 7612, 4269, 103, 70, "Output",ExpressionUUID->"3df50b18-0974-412b-a60f-2fe26ad69e3f",
 CellID->1971701026]
}, Open  ]],
Cell[276920, 7718, 602, 15, 70, "ExampleText",ExpressionUUID->"b9be7990-2c28-4b86-9645-885f58d105d3",
 CellID->261653958],
Cell[CellGroupData[{
Cell[277547, 7737, 285, 7, 70, "Input",ExpressionUUID->"6a519707-5603-4196-8f34-283643a0e9b6",
 CellID->1580018662],
Cell[277835, 7746, 115, 1, 70, "EchoTiming",ExpressionUUID->"e86caf37-14ae-4bf6-98e5-3da3e4d58582",
 CellID->558987125]
}, Open  ]],
Cell[277965, 7750, 159, 2, 70, "ExampleText",ExpressionUUID->"21ebd83d-8a7c-4a46-bd41-dfa7b22ccb68",
 CellID->1596247736],
Cell[CellGroupData[{
Cell[278149, 7756, 282, 7, 70, "Input",ExpressionUUID->"6e5a9df0-f762-4a58-83de-b4bf46545c55",
 CellID->1611158688],
Cell[278434, 7765, 116, 1, 70, "EchoTiming",ExpressionUUID->"3482a661-f0a9-41b3-8e71-974b8097a01c",
 CellID->1803137897]
}, Open  ]],
Cell[CellGroupData[{
Cell[278587, 7771, 255, 7, 70, "Input",ExpressionUUID->"3ef049a5-921a-457f-9336-0213b20bf38f",
 CellID->1119257192],
Cell[278845, 7780, 933, 23, 70, "Output",ExpressionUUID->"7973b446-2fdf-43e9-8fb6-7880bdd6282e",
 CellID->49408415]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[280054, 7815, 1340, 35, 70, "ExampleSection",ExpressionUUID->"48cc812b-a507-4a7c-abc0-da94e71c84c9",
 CellID->1013844522],
Cell[281397, 7852, 245, 4, 70, "ExampleText",ExpressionUUID->"f24a6048-1430-4d55-9213-975a3e0eb117",
 CellID->1449669344],
Cell[281645, 7858, 219, 5, 70, "Input",ExpressionUUID->"d1645c33-6b06-45ba-9823-4f89c65ff0e1",
 CellID->435300863],
Cell[CellGroupData[{
Cell[281889, 7867, 340, 9, 70, "Input",ExpressionUUID->"be701f1b-3c4f-4176-b73b-a9b5c99ed4cf",
 CellID->1315257341],
Cell[282232, 7878, 788, 24, 70, "Output",ExpressionUUID->"91b43a13-1974-4b30-92de-e0dd8476a75f",
 CellID->1478543163]
}, Open  ]],
Cell[283035, 7905, 115, 1, 70, "ExampleText",ExpressionUUID->"2e5c4687-8fdc-46d4-b4fd-e6244d562025",
 CellID->147470073],
Cell[CellGroupData[{
Cell[283175, 7910, 218, 5, 70, "Input",ExpressionUUID->"9a7ae58a-0ad4-44d8-9072-c7886a13970e",
 CellID->1018341382],
Cell[283396, 7917, 884, 26, 70, "Output",ExpressionUUID->"a264f52a-b555-484c-a53e-e5b82892d0a3",
 CellID->1341661104]
}, Open  ]],
Cell[CellGroupData[{
Cell[284317, 7948, 1343, 35, 70, "ExampleSubsection",ExpressionUUID->"79fa5b79-4d6a-4908-ab9d-e4a929508a26",
 CellID->1428253628],
Cell[285663, 7985, 139, 1, 70, "ExampleText",ExpressionUUID->"3c96edbc-38c6-427b-bcb1-1a0724b68057",
 CellID->271289733],
Cell[CellGroupData[{
Cell[285827, 7990, 221, 5, 70, "Input",ExpressionUUID->"cdafbda1-b6b7-4841-8765-a5d794321539",
 CellID->597018216],
Cell[286051, 7997, 6245, 155, 70, "Output",ExpressionUUID->"2ec1d638-f91c-4d76-9aef-fdc9d1dbf5f8",
 CellID->719881428]
}, Open  ]],
Cell[292311, 8155, 133, 1, 70, "ExampleText",ExpressionUUID->"65b4050a-acde-43ad-a874-9b61c288218a",
 CellID->1395460857],
Cell[CellGroupData[{
Cell[292469, 8160, 224, 5, 70, "Input",ExpressionUUID->"099ad987-5423-45d0-b01a-6add8077a448",
 CellID->171881754],
Cell[292696, 8167, 6517, 161, 70, "Output",ExpressionUUID->"a621d42c-04d3-4c9d-b197-0b6b759b46b6",
 CellID->124293198]
}, Open  ]],
Cell[299228, 8331, 353, 6, 70, "ExampleText",ExpressionUUID->"3bb3b2a3-d5ad-4524-869a-306ca67c7d64",
 CellID->2054175921],
Cell[CellGroupData[{
Cell[299606, 8341, 291, 7, 70, "Input",ExpressionUUID->"dc32661c-8c6c-4574-9bf3-85fe8e1e12f7",
 CellID->1163101081],
Cell[299900, 8350, 6518, 161, 70, "Output",ExpressionUUID->"ec551edc-faf3-4b14-afb8-9e4b57462a09",
 CellID->1641673902]
}, Open  ]],
Cell[CellGroupData[{
Cell[306455, 8516, 533, 15, 70, "Input",ExpressionUUID->"5a32612e-8749-4d48-8842-1893ff0a69f1",
 CellID->788418180],
Cell[306991, 8533, 129, 2, 70, "Output",ExpressionUUID->"d297cc37-cea6-4417-bc7c-afcb05d8ba46",
 CellID->743374258],
Cell[307123, 8537, 130, 2, 70, "Output",ExpressionUUID->"045c2def-193c-4cd5-b99d-a73fd0dafedf",
 CellID->1978779607]
}, Open  ]],
Cell[307268, 8542, 320, 5, 70, "ExampleText",ExpressionUUID->"2834f7dc-46cd-4b28-9d3f-f5d000b97859",
 CellID->1535874996]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "3"}, Closed]]]],
Cell[CellGroupData[{
Cell[307728, 8554, 1343, 35, 70, "ExampleSubsection",ExpressionUUID->"9b0751fa-a236-410b-8e83-7e9906731694",
 CellID->1175644165],
Cell[309074, 8591, 1304, 33, 70, "ExampleText",ExpressionUUID->"0c8b9f8c-3309-4460-b9b4-2d1bdc11cc85",
 CellID->673555027],
Cell[CellGroupData[{
Cell[310403, 8628, 224, 5, 70, "Input",ExpressionUUID->"059e6bc0-d642-4b4d-a7d5-3596733908b4",
 CellID->1212258744],
Cell[310630, 8635, 6246, 155, 70, "Output",ExpressionUUID->"0bd04fca-d8aa-472f-8369-d89f8e5c9b78",
 CellID->1417097407]
}, Open  ]],
Cell[316891, 8793, 225, 4, 70, "ExampleText",ExpressionUUID->"5236339f-ed83-4098-b1d6-a8aab1cde174",
 CellID->659314118],
Cell[CellGroupData[{
Cell[317141, 8801, 377, 10, 70, "Input",ExpressionUUID->"6748629a-abb4-427f-9b7a-66bd908b4370",
 CellID->1732368903],
Cell[317521, 8813, 6246, 155, 70, "Output",ExpressionUUID->"80212702-78e7-44e7-adce-c2a019c53e5f",
 CellID->1562474219]
}, Open  ]],
Cell[323782, 8971, 318, 8, 70, "ExampleText",ExpressionUUID->"41b06ad2-3d3c-4667-a3c4-e8f57f2cc209",
 CellID->1086766138],
Cell[CellGroupData[{
Cell[324125, 8983, 235, 5, 70, "Input",ExpressionUUID->"057f8a3b-bb6c-46bc-9ee1-564dbcd3676a",
 CellID->1633450301],
Cell[324363, 8990, 2851, 82, 70, "Output",ExpressionUUID->"920cfe28-2f4d-4b5b-ae60-f0878768fff4",
 CellID->1074163217]
}, Open  ]],
Cell[327229, 9075, 1254, 32, 70, "ExampleText",ExpressionUUID->"586c5f29-d817-4bc8-99d5-79591abe0816",
 CellID->597410564],
Cell[CellGroupData[{
Cell[328508, 9111, 290, 7, 70, "Input",ExpressionUUID->"118a6a68-74f3-45b2-a0eb-3517a988d4dc",
 CellID->810946710],
Cell[328801, 9120, 6528, 161, 70, "Output",ExpressionUUID->"8900af27-7c47-45d6-8e19-489a3814fa7f",
 CellID->1713651437]
}, Open  ]],
Cell[335344, 9284, 267, 5, 70, "ExampleText",ExpressionUUID->"15c569b3-6c57-4059-bccc-7e58c8010439",
 CellID->544880232],
Cell[CellGroupData[{
Cell[335636, 9293, 294, 7, 70, "Input",ExpressionUUID->"7bac9f70-6b0b-46fc-9be8-d5c69af850e0",
 CellID->1131136971],
Cell[335933, 9302, 6518, 161, 70, "Output",ExpressionUUID->"a6b98192-d4ed-4dd5-b721-57a55270c180",
 CellID->1436511742]
}, Open  ]],
Cell[342466, 9466, 234, 4, 70, "ExampleText",ExpressionUUID->"510cf160-1b02-4b73-af83-126589930436",
 CellID->586797214],
Cell[CellGroupData[{
Cell[342725, 9474, 346, 8, 70, "Input",ExpressionUUID->"2f4a5e14-3ae0-4377-a692-0569fa2c80f5",
 CellID->1476000633],
Cell[343074, 9484, 6518, 161, 70, "Output",ExpressionUUID->"5ad7d522-9879-4bda-bb06-cd58b47cd9fd",
 CellID->1441688220]
}, Open  ]],
Cell[CellGroupData[{
Cell[349629, 9650, 737, 21, 70, "Input",ExpressionUUID->"b78c442d-c78e-41e0-9cd1-2cae40a32a9a",
 CellID->976045210],
Cell[350369, 9673, 129, 2, 70, "Output",ExpressionUUID->"12b7186f-6710-416b-9af5-c03846e13b66",
 CellID->395924439],
Cell[350501, 9677, 130, 2, 70, "Output",ExpressionUUID->"5d0bf225-4efd-414e-ab46-e66c028085d4",
 CellID->1397707867],
Cell[350634, 9681, 130, 2, 70, "Output",ExpressionUUID->"10cd2b7d-73e1-477c-996e-bf8786784fac",
 CellID->2099989783]
}, Open  ]],
Cell[350779, 9686, 298, 5, 70, "ExampleText",ExpressionUUID->"f799307e-9a65-4813-b2c1-334f3ec58134",
 CellID->1486864925]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "4"}, Closed]]]],
Cell[CellGroupData[{
Cell[351217, 9698, 1342, 35, 70, "ExampleSubsection",ExpressionUUID->"03abf94b-13fc-4de3-9efd-d0244ad4f482",
 CellID->134046782],
Cell[352562, 9735, 292, 8, 70, "ExampleText",ExpressionUUID->"9b53598b-603b-4c1e-b842-431307cda891",
 CellID->2137736558],
Cell[CellGroupData[{
Cell[352879, 9747, 226, 5, 70, "Input",ExpressionUUID->"cb12b1e9-29d8-48d5-a8df-bf1f72bf33bc",
 CellID->1543898210],
Cell[353108, 9754, 6527, 161, 70, "Output",ExpressionUUID->"f896b573-a1b3-4116-9572-3d471b8c7ce2",
 CellID->634544436]
}, Open  ]],
Cell[CellGroupData[{
Cell[359672, 9920, 324, 8, 70, "Input",ExpressionUUID->"835f07a9-29dc-45b2-978f-463fdf2b9a05",
 CellID->1371099242],
Cell[359999, 9930, 8494, 203, 70, "Output",ExpressionUUID->"115059e5-27d9-4268-a19e-dd8efd4983d4",
 CellID->384544850]
}, Open  ]],
Cell[CellGroupData[{
Cell[368530, 10138, 291, 7, 70, "Input",ExpressionUUID->"b5d29866-bc83-4ad1-97c3-ec1c51707e8c",
 CellID->830254185],
Cell[368824, 10147, 130, 2, 70, "Output",ExpressionUUID->"7ff80c0d-860e-4ea4-8ba6-a855376426a8",
 CellID->1267000127]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "5"}, Closed]]]],
Cell[CellGroupData[{
Cell[369106, 10157, 1340, 35, 70, "ExampleSubsection",ExpressionUUID->"7a2c1ea0-f5bf-4c3d-950c-c37baba76efd",
 CellID->14250838],
Cell[370449, 10194, 205, 5, 70, "Input",ExpressionUUID->"98b69741-4a26-425a-b0d8-edafa4f8a100",
 CellID->2123085903],
Cell[CellGroupData[{
Cell[370679, 10203, 355, 9, 70, "Input",ExpressionUUID->"631a62f5-26f8-4914-b576-7af56b6f9668",
 CellID->1886460350],
Cell[371037, 10214, 786, 24, 70, "Output",ExpressionUUID->"6a7e684f-bf8d-4cca-ab0b-316c1c881e5f",
 CellID->23290837]
}, Open  ]],
Cell[CellGroupData[{
Cell[371860, 10243, 218, 5, 70, "Input",ExpressionUUID->"40a8b1ad-1cc1-4794-917f-c281dfca0e11",
 CellID->1903667663],
Cell[372081, 10250, 883, 26, 70, "Output",ExpressionUUID->"b7453277-b1ac-40ee-a6e6-f96669e26ae8",
 CellID->607073705]
}, Open  ]],
Cell[372979, 10279, 126, 1, 70, "ExampleText",ExpressionUUID->"7d1142ce-54c4-4749-ae5d-e543f01a6b2d",
 CellID->1569566381],
Cell[CellGroupData[{
Cell[373130, 10284, 214, 5, 70, "Input",ExpressionUUID->"f357938c-89a7-45a9-a197-5ef15ee10de9",
 CellID->1815418686],
Cell[373347, 10291, 838, 25, 70, "Output",ExpressionUUID->"4ebab746-f917-49f9-89ad-4c3f4a936eb3",
 CellID->392953038]
}, Open  ]],
Cell[CellGroupData[{
Cell[374222, 10321, 255, 6, 70, "Input",ExpressionUUID->"da8b964d-23d6-475f-bc5f-8895b19308a7",
 CellID->2111279117],
Cell[374480, 10329, 838, 25, 70, "Output",ExpressionUUID->"70d0df7f-3ae4-408b-a5fe-1eb41a79407d",
 CellID->849495141]
}, Open  ]],
Cell[375333, 10357, 143, 1, 70, "ExampleText",ExpressionUUID->"f243f7dc-6b73-4c2a-97a6-d3a4385f89f3",
 CellID->2085376287],
Cell[CellGroupData[{
Cell[375501, 10362, 189, 4, 70, "Input",ExpressionUUID->"5928a179-5c0b-4eee-b64c-a17aaf4ec4b6",
 CellID->188361022],
Cell[375693, 10368, 902, 27, 70, "Output",ExpressionUUID->"f9617c13-9716-4fe6-8194-5b8f0cac7949",
 CellID->993549531]
}, Open  ]],
Cell[CellGroupData[{
Cell[376632, 10400, 190, 4, 70, "Input",ExpressionUUID->"1e671a8c-a484-4fe9-877b-ef3a3fd7b3a1",
 CellID->1415710222],
Cell[376825, 10406, 903, 27, 70, "Output",ExpressionUUID->"a189a716-fc13-430c-9137-debbdebbe7c3",
 CellID->1901612092]
}, Open  ]],
Cell[CellGroupData[{
Cell[377765, 10438, 223, 5, 70, "Input",ExpressionUUID->"33596f86-d283-4fac-9229-db12c680aebc",
 CellID->1426344580],
Cell[377991, 10445, 884, 26, 70, "Output",ExpressionUUID->"955024f3-f0bb-4c4f-a7fd-78933d3e2133",
 CellID->1542795590]
}, Open  ]],
Cell[CellGroupData[{
Cell[378912, 10476, 223, 5, 70, "Input",ExpressionUUID->"571242f8-666a-4703-a9de-3362b4bdee1c",
 CellID->1919659908],
Cell[379138, 10483, 884, 26, 70, "Output",ExpressionUUID->"58d4cf48-ff43-404b-822e-dc73929b71c8",
 CellID->1047927252]
}, Open  ]],
Cell[380037, 10512, 490, 13, 70, "ExampleText",ExpressionUUID->"a9901286-65ee-42f8-800c-a07e8a5417b1",
 CellID->906316646],
Cell[CellGroupData[{
Cell[380552, 10529, 335, 9, 70, "Input",ExpressionUUID->"35b150fd-44ac-414e-a74e-83967eec3016",
 CellID->792357102],
Cell[380890, 10540, 7450, 223, 70, "Output",ExpressionUUID->"0d6bdb96-b96f-477c-9d6c-18af43a13080",
 CellID->999935317]
}, Open  ]],
Cell[CellGroupData[{
Cell[388377, 10768, 367, 10, 70, "Input",ExpressionUUID->"025c8aa8-33d5-4e86-8c54-5892ee6013fc",
 CellID->1604847720],
Cell[388747, 10780, 7451, 223, 70, "Output",ExpressionUUID->"9e8bff17-8dd0-461d-92b7-afcd262eef37",
 CellID->1853335044]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "6"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[396555, 11015, 4415, 120, 70, "SeeAlsoSection",ExpressionUUID->"f3b42976-3d88-41ba-a050-94eda559892c"],
Cell[400973, 11137, 1895, 47, 70, "TechNotesSection",ExpressionUUID->"3ad22f72-4948-4faa-8c0c-f26097c1272a"],
Cell[402871, 11186, 1124, 28, 70, "MoreAboutSection",ExpressionUUID->"07aee5ce-28c4-47db-95ac-00f4d52b7141"],
Cell[403998, 11216, 3920, 107, 70, "RelatedLinksSection",ExpressionUUID->"d096dc47-95ca-41d2-83ab-e2909fcfdfbd"],
Cell[407921, 11325, 78, 0, 70, "FooterCell",ExpressionUUID->"f994d702-40e8-4851-8c8f-2c8142fe43e6"]
}
]
*)

(* End of internal cache information *)
