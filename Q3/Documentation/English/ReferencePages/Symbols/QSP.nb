(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    279559,       7295]
NotebookOptionsPosition[    247354,       6646]
NotebookOutlinePosition[    250247,       6713]
CellTagsIndexPosition[    250160,       6708]
WindowTitle->QSP
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "db70cce2-e420-4108-a9d7-e8bd1004a55e"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "65682849-aaee-4098-8e7e-402282b8bd8c"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "bbc2bb0c-ae74-44d5-a60e-abcda97a51aa"]
         }],ExpressionUUID->"89398f5e-64d6-400b-b096-83e621bbfada"],
         StripOnInput->False],{
        StyleBox["\"QSPFind\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/QSPFind"], 
         StyleBox["\"QSPConvert\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/QSPConvert"], 
         StyleBox[
          "\"ChebyshevCoefficients\"", "SeeAlsoRelated", StripOnInput -> 
           False] :> Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/ChebyshevCoefficients"], 
         StyleBox[
          "\"ChebyshevSeries\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ChebyshevSeries"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "ca29d623-1d2c-4f3e-a1b9-d34ab5692534"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "7a27b1c3-02f1-4340-89f9-8f233b93a4d2"]
         }],ExpressionUUID->"f2f2037b-2e29-4877-a26e-5820c77ebc6c"],
         StripOnInput->False],{
        "\"Quantum Signal Processing\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumSignalProcessing"], 
         "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumSpinSystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "55db683e-9f4a-44cc-831b-da31530a0531"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "2ea73444-1c20-447b-a266-62a45d1dfe6d"]
         }],ExpressionUUID->"1ec4d92f-fe23-44eb-a87a-42596cfa81a3"],
         StripOnInput->False],{
        "\"Quantum Signal Processing\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumSignalProcessing"], 
         "\"Quantum Linear System Problems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumLinearSystemProblems"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumSpinSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "2eb58ddb-8103-49ed-bc38-39b60501a868"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "bb4a5fd1-f631-41a3-a8f2-cc51eb7b8856"]
         }],ExpressionUUID->"1b8dd59d-e9c7-4b5c-89d5-ffebe9fe455d"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/QSP\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/QSP"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
QSP.html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, 
               Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "QuantumMob/Q3/ref/QSP" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "197baf36-1eb3-4d80-904b-f630431959f0"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "a95c84fd-ace5-4acb-b847-13956498884c"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"2c7e3d8f-c2d4-4afb-bbc6-23ccf6f70166"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"4ee23b1a-5232-4bd6-b88d-7c5f9c52215d"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "QSP", "ObjectName",ExpressionUUID->
      "9b0b629f-d251-4bb2-9394-b61d9c938a6c"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"6da6a87a-9119-40cf-8344-20906ce9d640"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "a4e34765-cabe-4059-b58c-e965e26adc10"]
    }],ExpressionUUID->"0d38682e-ca78-4319-aa39-862bf2f073cd"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.0\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "a8650729-5bc3-409b-9f9b-dc426aa8d473"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"b6fcb020-22d9-458b-8efb-2588d3f3c9b9"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["0", "TR"]], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["1", "TR"]], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["2", "TR"]], ",", 
         StyleBox["\[Ellipsis]", "TR"], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["d", "TI"]]}], "}"}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "d60326d1-e910-4fc6-ab1b-03694905e4e7"],
     "\[LineSeparator]represents the quantum signal processing of degree ",
     Cell[BoxData[
      StyleBox["d", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "5c5f0848-98a7-4fa1-8a1b-f7f827b65cff"],
     " with ",
     StyleBox["full",
      FontSlant->"Italic"],
     " phase vector ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["0", "TR"]], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["d", "TI"]]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "afb29883-8ce7-461d-b140-2ffeccc28eb7"],
     "."
    }],ExpressionUUID->"02f520ae-30d9-4ec9-9365-7fe941cb5d49"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{"{", 
        RowBox[{
         StyleBox[
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], ",", 
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], ",", 
            StyleBox["\[Ellipsis]", "TR"]}], "}"}], "TI"], 
         StyleBox[",", "TI"], ",", 
         StyleBox["parity", "TI"]}], 
        StyleBox["}", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "b223c8ea-09ca-47ce-b463-611fe062cddc"],
     "\[LineSeparator]represents the ",
     StyleBox["symmetric",
      FontSlant->"Italic"],
     " quantum signal processing associated with ",
     StyleBox["reduced",
      FontSlant->"Italic"],
     " phase vector ",
     Cell[BoxData[
      RowBox[{
       RowBox[{
        StyleBox["{", "TI"], 
        RowBox[{
         RowBox[{
          StyleBox["{", "TI"], 
          RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], "TI"], 
           StyleBox[",", "TI"], 
           StyleBox[
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], "TI"], 
           StyleBox[",", "TI"], 
           StyleBox["\[Ellipsis]", "TR"]}], 
          StyleBox["}", "TI"]}], 
         StyleBox[",", "TI"], 
         StyleBox["parity", "TI"]}], 
        StyleBox["}", "TI"]}], 
       StyleBox[",", "TI"]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "caff4dd0-54a5-4b18-960b-00911af9f24c"],
     " where ",
     Cell[BoxData[
      RowBox[{
       StyleBox["parity", "TI"], "=", 
       RowBox[{"\[PlusMinus]", "1"}]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "8ce6089a-da53-47e5-b978-ac3b68fea850"],
     " for even and odd, respectively."
    }],ExpressionUUID->"12ea0a15-bdea-4207-a5b7-ba9e37e7e7d7"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], ",", 
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], ",", 
            StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
          StyleBox["parity", "TI"]}], "}"}], ",", 
        StyleBox["post", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "2a3006f2-5c63-482b-939b-8aa508249192"],
     "\[LineSeparator]is equivalent to ",
     Cell[BoxData[
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          TemplateBox[{
            Cell[
             TextData["Composition"]], "paclet:ref/Composition"},
           "RefLink",
           BaseStyle->{"InlineFormula"}], "[", 
          RowBox[{
           StyleBox["post", "TI"], ",", 
           RowBox[{"QSP", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox[
                StyleBox["\[Phi]", "TR"], 
                StyleBox["0", "TR"]], ",", 
               SubscriptBox[
                StyleBox["\[Phi]", "TR"], 
                StyleBox["1", "TR"]], ",", 
               StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
             StyleBox["parity", "TI"]}]}]}]}], "}"}], "]"}], "]"}]], 
      "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "1ad17e4f-6e59-41f0-b291-f67a078659ef"],
     "."
    }],ExpressionUUID->"24f79417-1eae-42ce-a162-2e1f132196db"]}
  }]], "Usage",
 CellID->1887563293,ExpressionUUID->"5ede1058-3dd0-43c4-b9c7-b4b3dfa7be66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[
       MatchQ[
        CurrentValue[
         EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, 
         Closed], 
        Alternatives[Open, True]], 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"803ed6cc-973d-4de7-beee-296f42abafd1"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"00cbb171-210a-437b-82e4-55910d446f43"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"36344cdf-bc8c-45b3-be9c-672d3c07f88e"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"b949572e-80bf-4ff9-865c-2a7db1e6a3e9"]], \
"NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->10121410,ExpressionUUID->"3e849261-94cb-4d78-9a03-b0ce6c599cf0"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   StyleBox["x", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "59ad5981-c2f5-407a-b61a-2fe0ce1ecc1d"],
 " returns the value ",
 Cell[BoxData[
  StyleBox["y", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "cbfb7c4a-ef39-4b11-9689-c74c8a1534ce"],
 " at ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "18276b96-2cca-4d9a-8f9e-cd161f94c798"],
 " of the polynomial that ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   StyleBox["spec", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2fb1d105-0e0d-408d-9f07-afe744a9b18d"],
 " represents. ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      StyleBox["x", "TI"], 
      StyleBox["1", "TR"]], ",", 
     SubscriptBox[
      StyleBox["x", "TI"], 
      StyleBox["2", "TR"]], ",", 
     StyleBox["\[Ellipsis]", "TR"]}], "}"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "c9f333ed-35fb-44cf-badc-b1f6d8a68946"],
 " returns the list ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     StyleBox["y", "TI"], 
     StyleBox["1", "TR"]], ",", 
    SubscriptBox[
     StyleBox["y", "TI"], 
     StyleBox["2", "TR"]], ",", 
    StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "faf1c8bb-5999-40bd-b7c2-338791f5e930"],
 " of values at ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["1", "TR"]], ",", 
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["2", "TR"]], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "095b9ca7-536f-460f-94e5-008c5f280ac7"],
 "."
}], "Notes",
 CellID->915826333,ExpressionUUID->"b44d462b-c110-41ab-96da-55da7c9159fa"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Gradient"]], "paclet:ref/Gradient"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    TemplateBox[{
      Cell[
       TextData["x"]], "paclet:QuantumMob/Q3/ref/x"},
     "RefLink",
     BaseStyle->{"InlineFormula", "TI"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "560f5ee3-085a-45c2-af60-401e6dc8e453"],
 " returns ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     StyleBox["y", "TI"], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        StyleBox["g", "TI"], 
        StyleBox["1", "TR"]], ",", 
       SubscriptBox[
        StyleBox["g", "TI"], 
        StyleBox["2", "TR"]], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}]}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "27d01f0b-141e-4d38-97ef-324659df1f5d"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["i", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      TemplateBox[{
        Cell[
         TextData["x"]], "paclet:QuantumMob/Q3/ref/x"},
       "RefLink",
       BaseStyle->{"InlineFormula", "TI"}], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TI"], 
      StyleBox["i", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "dbd9d8fb-ad8a-4139-ad8e-18eeb00e4fa1"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Gradient"]], "paclet:ref/Gradient"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "5f23ef52-b027-4dc5-b5d6-db8dd06101b9"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["y", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["y", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["g", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0cb6b26b-90b1-4a97-8b09-86d3509db4a4"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["i", "TI"]], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "1b93f858-8e94-4f96-837b-26f881cfad2c"],
 "."
}], "Notes",
 CellID->1931150725,ExpressionUUID->"d8c0db28-ebe6-4436-8000-8d1b5563e4e2"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Hessian"]], "paclet:ref/Hessian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    StyleBox["x", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "cd60297b-3464-4076-9388-042a7bfb4e9b"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    StyleBox["y", "TI"], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["h", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "929bed5d-87bd-4ede-926c-52d1e4b75df0"],
 " with the ",
 ButtonBox["Hessian matrix",
  BaseStyle->"Link",
  ButtonData->
   "paclet:tutorial/UnconstrainedOptimizationMethodsForLocalMinimization"],
 " ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["h", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      StyleBox["x", "TI"], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["i", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f8cddff3-1400-4423-89fe-fae14cf17260"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Hessian"]], "paclet:ref/Hessian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "6e396310-36d8-4c42-9ceb-5af8176cc57f"],
 " returns ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        StyleBox["y", "TI"], 
        StyleBox["1", "TR"]], ",", 
       SubscriptBox[
        StyleBox["y", "TI"], 
        StyleBox["2", "TR"]], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       StyleBox["\[Ellipsis]", "TR"], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\[Ellipsis]", "TR"], ",", 
         RowBox[{"{", 
          RowBox[{
           StyleBox["\[Ellipsis]", "TR"], ",", 
           SubscriptBox[
            StyleBox["h", "TI"], 
            StyleBox["ijk", "TI"]], ",", 
           StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
         StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}]}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "983f4ea4-64a1-49d0-9f7f-e6559821d573"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["h", "TI"], 
    StyleBox["ijk", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["i", "TI"]], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["k", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e519151a-5589-4497-af58-4fc5e62453c8"],
 ". "
}], "Notes",
 CellID->765642393,ExpressionUUID->"bf730f1c-8ca1-499d-af93-0391a64dc671"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Jacobian"]], "paclet:ref/Jacobian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{"QSP", "[", 
    StyleBox["spec", "TI"], "]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2be587da-1612-4ff1-8761-d7c474e1be48"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["0", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["g", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "d7b51550-0249-48dc-b6c5-ff9b96d2eb7f"],
 ", where ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["0", "TR"]], ",", 
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["1", "TR"]], ",", 
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["2", "TR"]], ",", 
    StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "1be2a804-29fa-4b0c-9877-786eeedd7b71"],
 " is the Chebyshev expansion coefficients of ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   StyleBox["x", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "9a13e0d0-e183-4022-bf1e-60bcb98d511e"],
 " and ",
 Cell[BoxData[
  StyleBox["g", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "db25fb11-727f-4045-8d09-176b45c9cca2"],
 " is the Jacobian matrix, ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     SubscriptBox[
      StyleBox["c", "TI"], 
      StyleBox["i", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e0d0f726-a736-4d93-aad1-931b50ed9f94"],
 "."
}], "Notes",
 CellID->328467597,ExpressionUUID->"475ff2be-608e-4743-beb8-160bc3ff2611"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Matrix"]], "paclet:QuantumMob/Q3/ref/Matrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", " ", 
    StyleBox["x", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "9f4af73c-78d2-4d2b-b74c-86a558dacc19"],
 " returns the QSP unitary matrix at ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "97072277-6318-4071-93b6-8b0a089bc07e"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Matrix"]], "paclet:QuantumMob/Q3/ref/Matrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "939f6722-57ba-4032-ac05-670037783157"],
 " returns the list of matrices at ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["1", "TR"]], ",", 
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["2", "TR"]], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0559c5ff-2eef-452b-b34b-6f12588fefd9"],
 "."
}], "Notes",
 CellID->740487261,ExpressionUUID->"de9277f2-7462-4582-a847-33e36d2c5a2a"],

Cell[TextData[{
 "The quantum signal processing (QSP) of degree ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "da02b460-da08-46ac-9836-9c6f043a4296"],
 " with phases ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{":", 
     OverscriptBox["\[Phi]", "\[RightVector]"]}]}], TraditionalForm]],
  ExpressionUUID->"7c54c88a-14d1-4734-afa3-708cd0ade598"],
 " is a parameterized representation of a polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "226977b3-ff40-4d40-90e2-1d8467095707"],
 " of degree ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "64d16c15-6872-4b41-a80d-b7ff1c1f05c5"],
 " and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"d", " ", "mod", " ", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"3098c901-c09a-4ce2-b3e8-406fc884bf1f"],
 ", through the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Times]", "2"}], TraditionalForm]],ExpressionUUID->
  "3b2c3f37-f1fc-4142-9b1d-c0c33a26f973"],
 " unitary matrix\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], ":=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
        SubscriptBox["\[Phi]", "0"], "Z"}]], 
      RowBox[{
       UnderoverscriptBox["\[CapitalPi]", 
        RowBox[{"k", "=", "1"}], "d"], "[", 
       RowBox[{
        RowBox[{"W", "(", "x", ")"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          SubscriptBox["\[Phi]", "k"], "Z"}]]}], "]"}]}], "=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"P", "(", "x", ")"}], 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          RowBox[{"Q", "(", "x", ")"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["x", "2"]}]]}]},
        {
         RowBox[{"\[VeryThinSpace]", 
          RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
           RowBox[{
            SuperscriptBox["Q", "*"], "(", "x", ")"}], 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["x", "2"]}]]}]}], 
         RowBox[{
          SuperscriptBox["P", "*"], "(", "x", ")"}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "e0994b37-6016-4b6a-aa2b-97cde01120ae"],
 " ,\nwhere ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "fc106c8c-8bf6-48d0-b620-30477b3a0235"],
 " is the Pauli-",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "1e3d0ccb-511c-4950-bdc0-4ae8a2b19180"],
 " matrix,\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        RowBox[{"-", "1"}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "e9327ea8-f566-4291-9635-727b7c40b418"],
 " ,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "e6ddd512-bf7a-4808-bfe5-595ca1c91e7b"],
 " is a rotation in the Bloch space around the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "c4ae46b5-0631-4dd4-963e-3b03c888ad1d"],
 "-axis by angle ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"arccos", "(", "x", ")"}]}], TraditionalForm]],ExpressionUUID->
  "6e8e719d-f84c-4672-8d45-415f0c5d6327"],
 ",\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"W", "(", "x", ")"}], ":=", 
    RowBox[{"(", GridBox[{
       {"x", 
        RowBox[{"\[ImaginaryI]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}]]}]},
       {
        RowBox[{"\[ImaginaryI]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}]]}], "x"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "263c3ba3-9870-4168-a76f-ac0da8045a0b"],
 " ,\nand ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "7b48bd3a-34e9-4228-87b5-253a91fd7644"],
 " is a polynomial of degree ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", "-", "1"}], TraditionalForm]],ExpressionUUID->
  "0625ef7a-1d38-4739-88fc-5bc2c57c3ba9"],
 " and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"d", "-", 
       RowBox[{"1", " ", "mod", " ", "2"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"ff9380ff-a772-479f-a32e-dfa79c8c1978"],
 " satisfying the unitarity constraint \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{"P", "(", "x", ")"}], "\[RightBracketingBar]"}], "2"], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"\[LeftBracketingBar]", 
        RowBox[{"Q", "(", "x", ")"}], "\[RightBracketingBar]"}], "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "2"]}], ")"}]}]}], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"44da3cef-56b6-422f-a023-e7560f9b8935"],
 "."
}], "Notes",
 CellID->958672882,ExpressionUUID->"8716fde1-48d5-4fe1-9116-c064b490f06f"],

Cell[TextData[{
 "Quantum signal processing is ",
 StyleBox["symmetric",
  FontSlant->"Italic"],
 " if the phase vector is symmetric ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "d"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "1"], ",", 
      SubscriptBox["\[Phi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"741f5c0e-28be-41f7-9286-eec52203ae7b"],
 " under list reversal. A symmetric quantum signal processing has its \
characteristic unitary matrix symmetric, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"], "T"], "(", "x", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"5e0d4503-3763-4007-adb7-d4d9db8d7dbe"],
 ", and polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "ebeee878-4844-4d3f-9438-67fba1e67ee4"],
 " is real. See Theorem 2 in Dong et al. (2021)."
}], "Notes",
 CellID->1795688728,ExpressionUUID->"11f45084-298c-4f25-bc23-584e51954310"],

Cell[TextData[{
 "A quantum signal processing is said to be ",
 StyleBox["symmetric",
  FontSlant->"Italic"],
 " if the phase vector is symmetric; that is, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "d"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "1"], ",", 
      SubscriptBox["\[Phi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"14be136b-eab3-48a1-87b0-0e77e489ae8e"],
 ", which leaves only ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "d"], ":=", 
    RowBox[{"\[LeftCeiling]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "+", "1"}], ")"}], "/", "2"}], "\[RightCeiling]"}]}], 
   TraditionalForm]],ExpressionUUID->"4bedc7d5-6434-48b8-8b90-7acd51883e86"],
 " independent phase variables. A symmetric quantum signal processing has its \
characteristic unitary matrix symmetric, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"], "T"], "(", "x", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"fe4c2e46-53c6-4dc8-bc91-e73275364e3c"],
 ", and the polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "222ac43e-fa09-4117-aa97-945ebdcc9f80"],
 " is real ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["(Dong, Meng, Whaley and Lin, 2021: Theorem 2)"]], 
    "https://doi.org/10.1103/PhysRevA.103.042419"},
   "WebLink",
   BaseStyle->{"Notes"}]],ExpressionUUID->
  "1234be77-0cf9-43e2-b202-cf7fbf0e9638"],
 "."
}], "Notes",
 CellID->1190343635,ExpressionUUID->"2159b4f7-6292-4cf9-9467-28832357f24b"],

Cell[TextData[{
 "Given a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " set ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[CurlyPhi]", "0"], ",", 
     SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
     SubscriptBox["\[CurlyPhi]", 
      RowBox[{
       SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], TraditionalForm]],
  ExpressionUUID->"def8ff2d-f6d7-4eca-b896-f75f92376886"],
 " of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "d"], TraditionalForm]],ExpressionUUID->
  "25647fd9-ab6b-4548-a77b-d57ed53b6b28"],
 " independent phase variables and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "=", 
    RowBox[{"\[PlusMinus]", "1"}]}], TraditionalForm]],ExpressionUUID->
  "427a1003-c75d-4696-b335-838e9031e7c0"],
 " for a symmetric quantum signal processing, one can recover the ",
 StyleBox["full vector",
  FontSlant->"Italic"],
 " of phase variables as follows:\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[CurlyPhi]", "0"], ",", 
        SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{
          SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
      RowBox[{"+", "1"}]}], "}"}], "\[RightTeeArrow]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[CurlyPhi]", "0"], ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
      RowBox[{"2", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{
         SubscriptBox["n", "d"], "-", "1"}]]}], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", 
      SubscriptBox["\[CurlyPhi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"6c5af047-6d45-45b7-a8a4-f783d5f4b2ea"],
 " (notice the factor of 2 for technical convenience),\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[CurlyPhi]", "0"], ",", 
        SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{
          SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], "\[RightTeeArrow]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[CurlyPhi]", "0"], ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{
        SubscriptBox["n", "d"], "-", "1"}]], ",", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{
        SubscriptBox["n", "d"], "-", "1"}]], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", 
      SubscriptBox["\[CurlyPhi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"c830cffc-596d-4286-bf32-7482e0464dcb"],
 ".\nThe pair ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[CurlyPhi]", "0"], ",", 
       SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{
         SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
     RowBox[{"p", "=", 
      RowBox[{"\[PlusMinus]", "1"}]}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"8cea9a86-b49a-49ba-b0b3-52e2a8e7b2af"],
 " is called the ",
 StyleBox["reduced phase vector",
  FontSlant->"Italic"],
 " to be distinguished from the ",
 StyleBox["full phase vector",
  FontSlant->"Italic"],
 "."
}], "Notes",
 CellID->1535193593,ExpressionUUID->"df7e932d-d091-4218-a940-55989c150e9f"],

Cell[TextData[{
 "The correspondence between the reduced and full phase vector is closely \
related to that between the ",
 ButtonBox["reduced and full Chebyshev coefficients",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/ChebyshevCoefficients"],
 " list."
}], "Notes",
 CellID->227248759,ExpressionUUID->"8a6aaeed-0765-45dd-9ed2-2f52ee03d322"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"51d8a36b-0ffe-4adc-a639-77a89658e29f"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"aa7b7991-7357-4369-be2a-792aa9cbb6db"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(11)", "ExampleCount",ExpressionUUID->
  "750ca572-f53c-4db2-856a-7984348a7b90"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->459329757,ExpressionUUID->"72427243-2a3c-422d-b426-affa13c91f55"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->556413652,ExpressionUUID->"bfa900e0-1ca8-46cf-b1b8-525af331b307"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"f3abb015-ea8c-4534-9189-43a2e4efb26f"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"d492df9a-ec45-4813-8ed0-f1d8c2032af1"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "7e3da71d-9ad2-4c60-b9b5-bd4a3fd36746"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1898998581,ExpressionUUID->"60961d8e-7a41-4624-8ee5-44c72010ba34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->672243474,ExpressionUUID->"b86b7189-e8ca-4dc8-8e4e-a63c63eebb9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->484600651,ExpressionUUID->"b7c855d4-9b79-45b4-99e0-4bc792d7fdca"],

Cell["Construct a QSP.", "ExampleText",
 CellID->1540884431,ExpressionUUID->"c819da19-19f0-4ca5-ae6b-50ed781c61aa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "$n"}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1425151933,ExpressionUUID->"b1a1669a-d7b9-49a6-9a8f-a7a63d62dd1c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1618799386,ExpressionUUID->"9a769fec-0607-4fa1-9e93-b2dca449509d"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->690956659,ExpressionUUID->"5584d24e-a994-46c1-9261-e3fa00b65fee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$phi", ",", "$parity"}], "}"}], ",", "Re"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1098093014,ExpressionUUID->"1f5088b7-3044-4d9c-a056-283b123b3201"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Re", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{{1.0523932828678402`, 1.3747791482091025`, -0.4063726489518741}, 1},
    Re],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->831016580,ExpressionUUID->"f62690ed-e412-497d-addd-35390e0a0349"]
}, Open  ]],

Cell["Pick a position.", "ExampleText",
 CellID->569269380,ExpressionUUID->"2c0d8cd0-2978-46fa-b14b-38ac226f4daa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1920729624,ExpressionUUID->"ee7c92e0-c8c1-405d-831c-d5e394c9ad0c"],

Cell[BoxData["0.7222657925379279`"], "Output",
 CellLabel->"Out[5]=",
 CellID->1843653352,ExpressionUUID->"043818cd-4613-4cd5-830b-e8a5c8429b3c"]
}, Open  ]],

Cell["Calculate the QSP polynomial at the position.", "ExampleText",
 CellID->1970697472,ExpressionUUID->"615ff83c-ba4f-4445-bfe1-de56c1c731c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"y", "=", 
  RowBox[{"qsp", "[", "x", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1579083477,ExpressionUUID->"2b5af503-14fa-435a-8308-3b9dd430e473"],

Cell[BoxData[
 RowBox[{"-", "0.24370437270790196`"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1336212431,ExpressionUUID->"b58d0472-185e-485d-a273-8bc9555d63f9"]
}, Open  ]],

Cell["\<\
Calculate the gradient with respect to the phases at the position.\
\>", "ExampleText",
 CellID->1682239748,ExpressionUUID->"6226b4bf-dfaa-4268-8ff7-b27bb92e5934"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"f", ",", "df"}], "}"}], "=", 
  RowBox[{"Gradient", "[", 
   RowBox[{"qsp", ",", "x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->487601425,ExpressionUUID->"5f974254-6ac7-4800-a357-c35e053fd251"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.24370437270790196`"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.857436120097687`", ",", 
     RowBox[{"-", "0.4001420997668619`"}], ",", "1.8237858602958372`"}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1801030237,ExpressionUUID->"0eeb62dd-0377-4759-990e-c44e14521b48"]
}, Open  ]],

Cell["\<\
Calculate the Jacobian matrix between the Chebyshev coefficients and the \
phases.\
\>", "ExampleText",
 CellID->1831286845,ExpressionUUID->"7a52037d-2f12-4679-b0fa-862fd1a263c1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cff", ",", "jac"}], "}"}], "=", 
   RowBox[{"Jacobian", "[", "qsp", "]"}]}], 
  ";"}], "\[IndentingNewLine]", "cff", "\[IndentingNewLine]", 
 RowBox[{"jac", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1520012391,ExpressionUUID->"e41fb03f-14fc-4c0b-b0ce-10f4910ef80f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.24101003885481828`"}], ",", 
   RowBox[{"-", "0.3673208690650344`"}], ",", 
   RowBox[{"-", "0.013273647029757535`"}]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->560859652,ExpressionUUID->"052bfc1f-db0b-40e1-a66a-6a04c954f955"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.8218192361642762`", 
      RowBox[{"-", "0.343954026056741`"}], "1.8049624494329581`"},
     {
      RowBox[{"-", "0.21025955307636565`"}], "1.776921963764637`", 
      RowBox[{"-", "0.21025955307636565`"}]},
     {
      RowBox[{"-", "0.04489727239963969`"}], "0.1336944729803754`", 
      RowBox[{"-", "0.02804048566832135`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->1062444481,ExpressionUUID->"78379620-56be-45eb-a63b-05c1a6742f97"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"ec16e115-393f-43b0-9e15-c325c299bbfe"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"5b4f1b03-cbab-4faf-94ee-9191c2e7653a"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(9)", "ExampleCount",ExpressionUUID->
  "30530e41-18b6-4e74-a2fe-f4ed470afd0a"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1703330544,ExpressionUUID->"2374f366-8587-4262-9aeb-d5dca1849abc"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"ad459140-669b-4917-8971-fbd453a82e4a"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"3af3a3cb-b19c-4c72-9856-02d3528b55ff"],
 "Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "9443d507-5ee1-4328-9f02-bc3aff7b9a5b"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1625224184,ExpressionUUID->"fe682a93-2075-4ba7-913b-f82f04c9e857"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->866063270,ExpressionUUID->"522e9533-92cc-46e8-bd0e-9a0322b46499"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1774012929,ExpressionUUID->"4d23828f-d1c1-480b-b744-c22ab47ecdd5"],

Cell["Construct a QSP.", "ExampleText",
 CellID->1210812697,ExpressionUUID->"bc5f8627-527a-4906-99fb-414df1c74775"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"-", "1"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->93372207,ExpressionUUID->"e01ccbbf-f57d-4e8c-aca4-6844d1f70894"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->422583316,ExpressionUUID->"870dfc80-e2cf-4f9e-a616-cd576920d556"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->629371383,ExpressionUUID->"3d470fd0-ee7f-49a1-a623-47e23d31d679"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1264054559,ExpressionUUID->"b2f5d262-ceeb-4ccf-b77b-ba9be1270fbe"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][0]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][1]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][2]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{{
     $CellContext`\[Phi][0], 
     $CellContext`\[Phi][1], 
     $CellContext`\[Phi][2]}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->58382099,ExpressionUUID->"50f92d74-53f2-4bd0-81c2-47f047f135fb"]
}, Open  ]],

Cell["Get the QSP unitary matrix.", "ExampleText",
 CellID->645597649,ExpressionUUID->"49ab42f4-e8a8-46f9-a7a0-480c3095366f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", 
     RowBox[{"$qsp", ",", "x"}], "]"}], "//", "Simplify"}]}], ";"}]}], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1538010568,ExpressionUUID->"5d56aff1-0b5f-40b2-a3a7-c2645a4d2db9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "mat", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->2098320073,ExpressionUUID->"e7be22ca-7680-44e1-810a-b6a0b5419df6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2"}], "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->219690561,ExpressionUUID->"8316e1f6-7904-499d-83aa-e15edb9f11da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1894606122,ExpressionUUID->"bc184841-fe94-4090-9135-531b487a529c"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][0]]}], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][0]]}], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"2", "-", 
    RowBox[{"6", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "4"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["x", "4"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["x", "4"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][2]]}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "4"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][2]]}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "4"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "+", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->578746079,ExpressionUUID->"1c38d2a5-a575-428b-945c-6fcb4a04d06e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "806fecfe-981d-4d78-b21a-9a71f6b5d127"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->706601561,ExpressionUUID->"1226e71a-041f-4246-9929-8ffe9ec4452d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "300"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->349864653,ExpressionUUID->"ed0e0ee3-5e03-43da-b306-ebf918d483ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1138088487,ExpressionUUID->"13f57842-def9-4203-ba76-284c5108a597"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2147261437,ExpressionUUID->"66ed82b2-38bc-428e-abab-01bdbcc70bd0"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->1509109399,ExpressionUUID->"559027b1-5c77-418c-aa87-0920735cd18f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->745752491,ExpressionUUID->"4bad6c8e-214a-4478-89fa-04147f88aa75"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["598", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["598", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678397`", ",", "1.374779148209103`", ",", 
                    RowBox[{"-", "0.40637264895187375`"}], ",", 
                    "1.3526643903415394`", ",", 
                    RowBox[{"-", "1.461278434239575`"}], ",", 
                    "1.238024845709142`", ",", 
                    RowBox[{"-", "0.489838900356113`"}], ",", 
                    "0.14740162462925266`", ",", "0.09519214138002319`", ",", 
                    
                    RowBox[{"-", "0.05437715996348036`"}], ",", 
                    "1.1366917987048302`", ",", 
                    RowBox[{"-", "0.9313131184913912`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{CompressedData["
1:eJwN1Hk81Ikfx/FhJe2WpSiJn1Ha+NXi54h0fKY20kFINmllxTo2V1hWylhH
zljboaSmyFHUbI4s8vk6E6PGNU3OwWDc3xlmjE3188/n7+fj8Xq8P9ruAQ6e
MhQKZdfKIXRfO93lkHDiasqval/EoKR/0k9WtgcFzADfmFwxxCZzrnr+vIi5
J75sm387D+k5pw/FOQ8iL+zGJcWBOqDvVfpPjGsF0NPdXzq8f4r7Ntu/GjEQ
Qaax9U77thlMWRut90VxBpVMCoUxRmwUnFaXf6Q8CvSepMTJ8nEkm0+Oh7HZ
wHt8xPTPykmwUy5YcLJth0vCJYEaVYreovBh5nEp0L08LrmfnUVey94t1Rlj
6MaUYYaqNmGRS0RYcSUJFyetJojKeTDfEnTkg60QqEpPNw41TUPg54xvvl0v
BfMrGjdLd4iR/Mnicq9tHyq1KAz2tHEwZFqQuPH7Bfg351HoPeUFbH74hPV6
eQToNyNT4qILIL3fw3Qu+ANS3Stdiht6wDs4d/BQ3gLq5ntnaWSMAsPo1qya
9gg86We+rD0rRManIlIlXAR0n5shG+TqgGJHrf5tdSeGf8ytMv56GHX2eot5
WvPAjpdv3F8thO8CPycdFixguOHehh1mQ6jzIrXwdckESukdOfysOaT4hJ/a
H3EbeW9T2rIqh4DSHL+45VQT0FvVrmYPcqAgqn+p8x8+qhRO1kwlzgPtp90t
I+tFYO2Y27/13hiSsndl1uaIkJZz2PXj1b+BYrJ98xwZj7SbS7t+0FzpusXn
eikxjTzf46zN9AZMaL7UKsedwQLFaofh+FEUqBYEp9aNglK/umZ7/HtUiw+r
8ZefA8btANfjtxuQyj3vd0CTh0XMc2tKghcxoyzLVKS9iBXVT1lenCnI67mr
6xwpwRpj7wOWaSLUZRJXDSKmMcHl92qvvll8dib90Q6zebS+wjrvJJ7B5q3a
tSJVEcbGrUpy3r8A+twLtJC0Bczc3VC7Z5DEdNuwo/E3uegIslPvBqWg9FRv
77s/RPAkJBFi9aTIyO9NUkjtA0HxOkWXFB5K1QvFofqzyMaJlP37+Eh3sOr1
vDAJ54qLOu/XkSB9PJFQ8HIKqTtpdnceNwHjlrCkyo+NbgmuhcPHWKiguDFn
S4oQ6fyTU+NBAxBYmvDK1oYNivR9VpU2JNI/KcbnCzqRaezTnOIyBPLJmokP
bIS4fPhM/WTTSr9H0lan51mos6qssE06iQpHqzy19cfB0NV16wUYw/DXhLV2
vwRKNZtk60kRUt+oHh3aNoSUXmOX4Zle4M59zGce5CNtvFQs0BwAcrq7vWmq
HcOhr/ju21EktNvsaq1HYdfSqutm1CVIf9kV5xg3BP7ZrIv3t6/4/C0q1tsW
Ay3L4p/syxy0zrw8kF0zCQrLx76qnx3CAtWmtexGEmjSX2QYHxch0M/3zZWD
fcgiTpaMnBJDpvDPTkE/H8rdHz4LLhQjvayz1sulFZkPtA4tMUeByE7drGrf
BoQrlxmb0QqBFzfk+lDbgaKsN6uiXA0U8yG3TY/+QvY5D/dbHh2Q6eztKnjF
A7fUHfJFhzqQLepOxRvdqBC4V/6PWT4qdN7aH+U8B+nm4T/YnO5BHrvMsPd5
N9g5Cd8amIwDoWW5Lt+BD2v1uXVrKGJ0q5DOth1bQKqRNWP5qw4kHqSn7HzK
Rwb7Z8G7Qh66zTD/1xMxAbSYkr4br2aguSa2OuHmKFKS37wfWyJASbbI2Gz9
MPDV9yQa3JCgw2rGAz/Defw6jevoXC5Bom0N0zW1DKfbpUoa8UI09/nPvMeH
YdD5fI37KXcedYvkn5xg85EnvyWLH8BBuhadiE6qhwLf8rx79CG4IRPy2Kt+
EglaiH1J1EtgON89aqwpBepuLb5GxwdQWfv4oV/4DFLEd6RRyS3Au6zcvedS
K/rnbYvQqhBjYFvEeKgBByTeCdPPts0j1ZLu9/hQD7qZ6U06qjUiIeO3zXJz
LdBrTAVaevPA5e6QsuUkGIJHY977zUPgt8N/SYy6QKlxd1u5ZAyKzu6Xz7s2
D/S/LP74Ma4Vim5rly6oiCCBU7VRv5SHCn+H1AccmUZKQE12IZGHhOUuq4e5
L4A5rGnipSUGXxU1NkN3EYkM8+7nr1b+ZOpF+y9PJ8CjMPpBaP8U2tp9na3P
FOPwr+m/g7MUadTIA6HLvcCLtKxqXN0AlHJHp6DkFadguWXP6VEkx4wI8r0A
KHq2TYqDdXjPvM/xbpMApf7DG873jAHlzhGb7F9GUGGyRkrlrrinv6lID+0B
j+s69QG9YrgY5XdHRjyB9OJcV5ZlO1Kio5r/m1MLmbE2HsFuEtAJ8tV+FkJC
z0FK3PH3JDIHs01Lj3xY6THNenGtBCgMsWalRxkQ31b5lxsQ4HjCxNjLfxEp
4Vb5lFYW8g8U1z7cIQHr9Iy8cuEEKr22zZEd4ECfb2rTlQtCsB3k6Z3yI/HR
K5n7ZxSl6KZo5NRaVwuxMj9qrHEQw4ngkTDWeiEQXs2hkfvfANX4NPNNVyNq
EDl6LzqFSLhtG2Sd60FS5nsPb+44UK7qqR/b3oClQf9c2cdcwIScFslcnAh0
btkVk/4kkpfiovJ5XUjotZ6f+DIG9GdTRZU7C9DN5dx625EeIH5w31Wu34hK
eEEyPM5DxsfnZibb28AfjzhVIYkefZgm1zGBtFXWnA3nO4BKeC6qWI0AP2bT
pJn6EhqOhS+S5l2oeP6Tiab+yq78rYA+3gJs1X8PZxhNgO5UKCfq8zSwmg4n
F0UuIE8xUc7slAByu87GfPAjwe7kd4GezSKgsL7qDOyPALmHEdyg44vY/M5I
/2zXMNxw9u8feSfE3RFl67JGFtBQbYS5dY8INNS/JNmvnkO3qihT32sDoJah
oK+6PI70+9Fv9VaVwb0XyWa308RYsZuT1jo2hSpBQkmX+xTSyj07NCeEQCPz
Eqx+roUi66zK9NVS4L+5LOaPC5A7u2pT36IUKEyvaz7j11GJZSG1tB0Auvj3
+2EGg5BpahEd8ZsAKccvJCQqFkOktXLcpoMiSFpn0bj4mkRdx+5Ip9WzQBxN
e2n4theWi876288I4Yy5yTW3WQnIvYsftVvx6/ZftjmjLoHA1j/tGa6LmB46
knGP0wX/ByBOH18=
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->983480955,ExpressionUUID->"eb12e54f-7824-4c63-9467-e346ce705896"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1123936882,ExpressionUUID->"9316da6a-afb6-40fb-afe9-1b224c069f62"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"mat", "=", 
    RowBox[{
     RowBox[{"Matrix", "[", 
      RowBox[{"qsp", ",", "xx"}], "]"}], "//", "Chop"}]}], ";"}], 
  "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1756899605,ExpressionUUID->"40580c9f-b911-4997-9852-41a6c126db52"],

Cell[BoxData["5.053804`"], "EchoTiming",
 CellID->889511317,ExpressionUUID->"24ec68e7-4757-4d16-9cb9-e707e1af75fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{";;", 
     RowBox[{"UpTo", "[", "5", "]"}]}], "]"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1891135613,ExpressionUUID->"24f6294b-238c-487e-b30b-a4beee34cfce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.41304947785650553`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.9009462388461904`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13298873467846822`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13298873467846822`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.41304947785650553`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9009462388461904`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.40210871608187676`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.8289773173643366`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.3887225073834071`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.3887225073834071`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.40210871608187676`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.8289773173643366`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.37940300195480586`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6914742399323501`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6147493290908801`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6147493290908801`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.37940300195480586`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6914742399323501`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.3434652525296449`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5006799352962821`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7945761276909991`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7945761276909991`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.3434652525296449`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5006799352962821`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.2925244603824132`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.27344836431087705`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9163271425280941`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9163271425280941`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.2925244603824132`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.27344836431087705`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->596814346,ExpressionUUID->"862e11f3-7152-4077-9538-b3df52195edc"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"1d8fb3c9-732f-40cd-bbee-2a3b37aff591"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"ee934330-0299-4814-b574-5241c50ba07f"],
 "Gradient",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "99ef4723-6f2c-43f7-b020-d351b8adfe4d"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->976509307,ExpressionUUID->"8c0e37d2-2200-4cef-b7f1-508936aa475a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->404620761,ExpressionUUID->"b9796203-1591-47e3-a94b-7251110451f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1527903725,ExpressionUUID->"af58350c-d1ea-47bd-b3cf-9a94c8a622e7"],

Cell["Construct a QSP.", "ExampleText",
 CellID->645812421,ExpressionUUID->"fb847c95-45e8-4d6a-8e3c-79ad16753d07"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$parity", "=", 
   RowBox[{"-", "1"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2015938896,ExpressionUUID->"9d53a80e-6190-4e72-b5f1-12b487063712"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1621756012,ExpressionUUID->"808fb9ba-2b37-4244-b656-24794cabf138"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->883939583,ExpressionUUID->"4e07737f-6044-425a-b625-e77d07c2e99d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->205122666,ExpressionUUID->"ec9a160f-9ad5-41b3-b07a-994886ef1244"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "*", "Pi"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1288517488,ExpressionUUID->"9998c65f-09bd-4e29-9a8c-5df5bc8146b0"],

Cell[BoxData[
 RowBox[{"-", "0.9763034131218359`"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->204953888,ExpressionUUID->"c801e09c-e445-4ba5-8032-803031a35e71"]
}, Open  ]],

Cell["Calculate the gradient with respect to the phases.", "ExampleText",
 CellID->1991143895,ExpressionUUID->"72e11a8f-bea2-41eb-b46b-7f7ef199ceff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "grd"}], "}"}], "=", 
  RowBox[{"Gradient", "[", 
   RowBox[{"$qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->763019732,ExpressionUUID->"7fc647c5-5f88-4f76-a598-5d563b4d4c51"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5353834564485714`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.7698389667404558`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.5396779334809116`"}], "+", 
      RowBox[{"1.0707669128971429`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.1427205960590454`"}], "+", 
      RowBox[{"1.1199214833381976`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.5585409731606994`"}], "+", 
      RowBox[{"1.1631045338923487`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1032165591,ExpressionUUID->"877ba44f-c921-410b-95ac-5b1ea28e4db8"]
}, Open  ]],

Cell["\<\
For comparison, calculate the gradient by taking the partial derivative of \
the polynomial.\
\>", "ExampleText",
 CellID->2001042392,ExpressionUUID->"9601b6f5-1d7e-49f8-80cd-235a912ee34a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"tmp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"var", ",", "$parity"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"tmp", ",", "$x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mint", "=", 
  RowBox[{"ReplaceAll", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"mat", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
      "var"}], ",", 
    RowBox[{"Thread", "[", 
     RowBox[{"var", "->", "$phi"}], "]"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1840117499,ExpressionUUID->"cd76d376-d1b3-4909-84b9-238975c3de48"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->417734221,ExpressionUUID->"2c1d8412-19eb-449d-8fbc-3bfb7c75db28"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][0]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][1]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][2]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{{
     $CellContext`\[Phi][0], 
     $CellContext`\[Phi][1], 
     $CellContext`\[Phi][2]}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[7]=",
 CellID->735010304,ExpressionUUID->"8c6cdc9c-138b-4662-8b9a-b610d5a9a08d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1.5396779334809114`"}], "+", 
    RowBox[{"1.070766912897143`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.1427205960590452`"}], "+", 
    RowBox[{"1.1199214833381976`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.5585409731606994`"}], "+", 
    RowBox[{"1.163104533892349`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",\

 CellLabel->"Out[7]=",
 CellID->992241784,ExpressionUUID->"eb213834-0649-4529-a0c4-4c395b2b359f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"grd", "-", "mint"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1440956291,ExpressionUUID->"c06f722f-eb07-4ef5-b173-9d2d48e53ac7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->228926762,ExpressionUUID->"b5adb423-cba1-4c03-9a66-e06d36be463e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "6f9d009a-049f-499e-a7e8-7e66e7205147"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1767104397,ExpressionUUID->"c653f00a-18ba-49f9-b36b-2a2fbd1bc488"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "75"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->24762369,ExpressionUUID->"2763b469-a903-48e7-8655-8da24dff2e0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1716791912,ExpressionUUID->"e0c7f7e0-eadf-4d0e-ba02-24cef995d533"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->531383892,ExpressionUUID->"1b054472-f762-438a-a2fa-1c4b9fd4185f"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->676666589,ExpressionUUID->"9b554fbe-75c2-4a0d-8c56-7141e22fb1f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1736427641,ExpressionUUID->"e9a71116-87c4-414d-84f7-23c6e6f3750b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678397`", ",", "1.374779148209103`", ",", 
                    RowBox[{"-", "0.40637264895187375`"}], ",", 
                    "1.3526643903415394`", ",", 
                    RowBox[{"-", "1.461278434239575`"}], ",", 
                    "1.238024845709142`", ",", 
                    RowBox[{"-", "0.489838900356113`"}], ",", 
                    "0.14740162462925266`", ",", "0.09519214138002319`", ",", 
                    
                    RowBox[{"-", "0.05437715996348036`"}], ",", 
                    "1.1366917987048302`", ",", 
                    RowBox[{"-", "0.9313131184913912`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{CompressedData["
1:eJwBZQKa/SFib1JlAQAAAEsAAADAKMdWmtbwP0x+jGsY//U/EC5PbQIC2r/o
sG9qg6T1P4SL1n5lYfe/pEz/I/PO8z+Qo1VChVnfv+B3lHIO3sI/gDsQHoNe
uD+AkGK3UtervzwZUb3jL/I/mDNIK1HN7b+MDIEp/w7tvxA0qfGDMtC/6FUa
BqIR5T+A2oqJ6rbnv/DIT+d30NA/4KVHNZG66j9QEaj0Vk7RP3Lx+egYIPi/
aPJ44rBL+D+AZ2RyYlruv+DKOxu8kua/YLABsHUVxr+sW3p3rbrwP2zqRunA
uvM/OBtxR9lO8T8gEKsW4cbsP3D+kgsPEvg/OH0clbQn9b/wXTp7207cvxDK
CN/azda/dOzoiRYt9D/6o6J1nBH0v8ihqszH/OM/gJV8jIWBqD+Q3WQ173PZ
vyBiulutxNo/aHOk30Km9L8op2ibHJLlP6Aylu4YIeM/qt2wt8Fa8b+g/azw
FHjyP4BplXQTBMI/AFAgvHYH0794+6S7MwrivyQ7aPXgH/M/0IYGxT288T8m
cP6KROj0v3gwO8QnN+G/JLKNqcez6b/4gNKj5JvvvwBpeFM9epe/4M6MzZu6
4T8AyIb3G1PGP4DLGH6d39Y/qH/d+dO55L8Uqeq+64nzP0BdNsrjEvI/SFSk
3SKc5r/wApoBDKPyv0CjRF77frE/ADQlGe/whr9AlfksQx33v6QbaY60wOy/
4GpLzBmAxL+IyHLLBNjtv6gOvFLihuW/6BWoc43C5T8Q3Rod0YbXvxiGd75u
Bu8/oJdvXkuXxL8g2F9tPh3gv6ywXAmzc/e/krWbNfIh97/n6kpR
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->581207287,ExpressionUUID->"f287608f-6989-4ceb-ad80-2c347513ead6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->360339012,ExpressionUUID->"818e788d-63f9-43c5-9ab6-5b0d80ab027e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "grd"}], "}"}], "=", 
    RowBox[{"Gradient", "[", 
     RowBox[{"qsp", ",", "xx"}], "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->313890144,ExpressionUUID->"a6f5cf4c-262f-46ac-b83e-eff2f7cd1d73"],

Cell[BoxData["5.683885`"], "EchoTiming",
 CellID->1895513536,ExpressionUUID->"c50c6e80-ffe2-4fb6-915a-412f1f662316"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"grd", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}]}], "]"}], "]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1745720274,ExpressionUUID->"330649f1-82c2-4211-b01b-6e931fca3cc0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.7476389859037237`"}], "-", 
       RowBox[{"1.8549919901494485`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7473570833739208`"}], "-", 
       RowBox[{"1.8545112539935613`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7476311402464493`"}], "-", 
       RowBox[{"1.854880031356911`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7474607507190942`"}], "-", 
       RowBox[{"1.8541124285330488`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7476640804515589`"}], "-", 
       RowBox[{"1.854886365565306`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "1.100487528798556`"}], "-", 
       RowBox[{"1.6474893571595874`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.0834148233755754`"}], "-", 
       RowBox[{"1.6354010387015232`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.10238767604167`"}], "-", 
       RowBox[{"1.6406420392908425`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1122746752722517`"}], "-", 
       RowBox[{"1.6244668938133788`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1080253858253124`"}], "-", 
       RowBox[{"1.6451215910664856`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "1.3014746354907452`"}], "-", 
       RowBox[{"1.1469265457634408`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.2040922402867031`"}], "-", 
       RowBox[{"1.087250207158791`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.3139470933624244`"}], "-", 
       RowBox[{"1.1074950209044285`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.3840643821703333`"}], "-", 
       RowBox[{"1.0323028098261249`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.3485045410667194`"}], "-", 
       RowBox[{"1.1357391412601099`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.8562582701892676`"}], "-", 
       RowBox[{"0.3588073868797296`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6227110349620479`"}], "-", 
       RowBox[{"0.22231680213551203`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.8886847224903176`"}], "-", 
       RowBox[{"0.26259450857796135`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.0775423665274984`"}], "-", 
       RowBox[{"0.09644535286280581`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.9750036487299754`"}], "-", 
       RowBox[{"0.33403684281824897`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.2066088720263416`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.47432126528052765`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5165754627639738`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6512799143036037`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1585578702139016`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.606705213674892`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1334255361462051`"}], "+", 
       RowBox[{"0.814037961032697`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.03712124367306908`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.5051798963591225`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->2123579954,ExpressionUUID->"b07fd5a7-d443-4a69-ac11-20d066c9c495"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"b95948f3-da11-4819-85e0-0cacf2ed775d"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"ba0e7aad-690e-455d-8957-938abdd8702b"],
 "Jacobian Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "7ff3c3a9-9d5e-4521-9c3e-bc7b2b1aa4da"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->38255620,ExpressionUUID->"cc0bb814-97c6-49ce-8a2a-85c6b83a19f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->864594887,ExpressionUUID->"6ca907c0-caa2-4349-94a9-20d1ac2d6f93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1371910207,ExpressionUUID->"cebef06d-0b3a-4373-8736-96f366e1e6b0"],

Cell["Construct a QSP.", "ExampleText",
 CellID->162931210,ExpressionUUID->"8a1d4fd0-77b6-4381-b71f-f2a870aa7953"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$parity", "=", 
   RowBox[{"-", "1"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->343196545,ExpressionUUID->"4a91804f-85ea-4421-93d6-f77ecf04dbed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->933628700,ExpressionUUID->"3d029e7c-78fe-41a0-9d2e-079999009d24"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->918428547,ExpressionUUID->"9231cdfe-d66b-44d5-9699-af661d062e57"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->574913399,ExpressionUUID->"f6ec1355-1acc-48e7-94c7-7c5e76c468b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "*", "Pi"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1374222030,ExpressionUUID->"8c14325c-27ea-4a9f-83bc-dc2f879649ce"],

Cell[BoxData[
 RowBox[{"-", "0.9763034131218359`"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->722564189,ExpressionUUID->"549cec62-d2dc-4a27-b3e3-463f01f8b024"]
}, Open  ]],

Cell["Calculate the gradient with respect to the phases.", "ExampleText",
 CellID->523581948,ExpressionUUID->"b5467a3c-11ea-4cf8-9ec6-7bdd2b1f4f13"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cff", ",", "jac"}], "}"}], "=", 
   RowBox[{"Jacobian", "[", "$qsp", "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1601298277,ExpressionUUID->"0087cd79-2fbb-4acf-bc64-482cd81bc3e9"],

Cell[CellGroupData[{

Cell[BoxData["cff"], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->450237662,ExpressionUUID->"83d9fa8a-145b-4502-9bb3-b8916c6c9763"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.2602311260461158`"}], "-", 
    RowBox[{"0.7611134399038366`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3450831485647699`"}], "-", 
    RowBox[{"0.04976818742283829`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.01629028033872487`"}], "+", 
    RowBox[{"0.027550421982539715`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->860680741,ExpressionUUID->"ca4ecfb3-204e-4470-9b34-ffa57a9cff4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "jac", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->30274202,ExpressionUUID->"edbb0620-5499-4375-ae8e-7f972d1669c5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1.522226879807674`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5204622520922316`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.25097163688678475`"}], "-", 
       RowBox[{"1.233177156841502`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.699832672894775`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9233108263695123`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.09953637484567669`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6901662971295398`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6535555211756574`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2674606711686963`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11915001937234378`"}], "-", 
       RowBox[{"0.3436095762973714`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.05510084396507943`"}], "-", 
       RowBox[{"0.032580560677449785`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.164078526399397`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.27749262422641563`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.014020242834160321`"}], "+", 
       RowBox[{"0.023711292767662838`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->1452619630,ExpressionUUID->"433be19c-17d9-4177-a2c8-b11bf3725949"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"ChebyshevCoefficients", "[", 
   RowBox[{"$qsp", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$n", "+", "1"}], ",", "$parity"}], "}"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->429782927,ExpressionUUID->"a3efdfbf-5ac9-4b1d-8cea-44aa220b98d2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.2602311260461158`"}], "-", 
    RowBox[{"0.7611134399038368`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3450831485647699`"}], "-", 
    RowBox[{"0.0497681874228383`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.016290280338724903`"}], "+", 
    RowBox[{"0.02755042198253976`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->1517646919,ExpressionUUID->"c66a8378-4b59-4198-8000-4ebbbd4aeb76"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cff", "-", "new"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->379226317,ExpressionUUID->"67cc20d2-abe5-49f5-8061-803041e83f55"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[10]=",
 CellID->864834938,ExpressionUUID->"7840e174-f8ce-488a-9b2d-c70fb9c92f3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "b3eab46c-087b-4558-bf65-9dae16870910"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->512088563,ExpressionUUID->"c90708c5-5fd6-4d64-84f2-330a8d2c7d57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "75"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1705504812,ExpressionUUID->"ed0483fa-e41f-408b-bd00-46ab64abc3da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1955138775,ExpressionUUID->"2fe1e470-9dab-46f0-af4f-fbd24ef9a96f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1370108678,ExpressionUUID->"a2ba2066-968e-4a76-9815-751778d6e288"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->2077003281,ExpressionUUID->"39170ca9-8dfd-4022-b53e-d3ba6c42f1fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->42686767,ExpressionUUID->"8113bbfa-8489-4230-9df1-4c9b5fdf9fa4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678397`", ",", "1.374779148209103`", ",", 
                    RowBox[{"-", "0.40637264895187375`"}], ",", 
                    "1.3526643903415394`", ",", 
                    RowBox[{"-", "1.461278434239575`"}], ",", 
                    "1.238024845709142`", ",", 
                    RowBox[{"-", "0.489838900356113`"}], ",", 
                    "0.14740162462925266`", ",", "0.09519214138002319`", ",", 
                    
                    RowBox[{"-", "0.05437715996348036`"}], ",", 
                    "1.1366917987048302`", ",", 
                    RowBox[{"-", "0.9313131184913912`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{CompressedData["
1:eJwBZQKa/SFib1JlAQAAAEsAAADAKMdWmtbwP0x+jGsY//U/EC5PbQIC2r/o
sG9qg6T1P4SL1n5lYfe/pEz/I/PO8z+Qo1VChVnfv+B3lHIO3sI/gDsQHoNe
uD+AkGK3UtervzwZUb3jL/I/mDNIK1HN7b+MDIEp/w7tvxA0qfGDMtC/6FUa
BqIR5T+A2oqJ6rbnv/DIT+d30NA/4KVHNZG66j9QEaj0Vk7RP3Lx+egYIPi/
aPJ44rBL+D+AZ2RyYlruv+DKOxu8kua/YLABsHUVxr+sW3p3rbrwP2zqRunA
uvM/OBtxR9lO8T8gEKsW4cbsP3D+kgsPEvg/OH0clbQn9b/wXTp7207cvxDK
CN/azda/dOzoiRYt9D/6o6J1nBH0v8ihqszH/OM/gJV8jIWBqD+Q3WQ173PZ
vyBiulutxNo/aHOk30Km9L8op2ibHJLlP6Aylu4YIeM/qt2wt8Fa8b+g/azw
FHjyP4BplXQTBMI/AFAgvHYH0794+6S7MwrivyQ7aPXgH/M/0IYGxT288T8m
cP6KROj0v3gwO8QnN+G/JLKNqcez6b/4gNKj5JvvvwBpeFM9epe/4M6MzZu6
4T8AyIb3G1PGP4DLGH6d39Y/qH/d+dO55L8Uqeq+64nzP0BdNsrjEvI/SFSk
3SKc5r/wApoBDKPyv0CjRF77frE/ADQlGe/whr9AlfksQx33v6QbaY60wOy/
4GpLzBmAxL+IyHLLBNjtv6gOvFLihuW/6BWoc43C5T8Q3Rod0YbXvxiGd75u
Bu8/oJdvXkuXxL8g2F9tPh3gv6ywXAmzc/e/krWbNfIh97/n6kpR
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->245632230,ExpressionUUID->"a6b6490e-9a47-4f4c-9671-9b9ccd6f075d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1963149449,ExpressionUUID->"0429ac23-4f29-4c77-af33-2c993144fc9d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cff", ",", "jac"}], "}"}], "=", 
    RowBox[{"Jacobian", "[", "$qsp", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->714036835,ExpressionUUID->"2e802f9f-488c-483c-8775-2e357e686f4b"],

Cell[BoxData["5.652459`"], "EchoTiming",
 CellID->1081187110,ExpressionUUID->"13e108ad-7ae0-4075-81a1-25541f5293b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"jac", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}]}], "]"}], "]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1994254140,ExpressionUUID->"1007e60f-bc2b-4941-8664-fffd8d27de0a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.10732694992958576`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3336074545476473`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.09592513054706321`"}], "-", 
       RowBox[{"0.352332037088171`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09741941203650938`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3368060087131491`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.20049921569346488`"}], "-", 
       RowBox[{"0.39718783925324824`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.08395634485527731`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3221090936616829`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.2880009589529242`"}], "-", 
       RowBox[{"0.7615169900364511`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.23978592500425355`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.26731248842076577`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.29731226353770135`"}], "-", 
       RowBox[{"0.7303137156920702`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.11968832377341009`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2455167748427235`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.30583680464939456`"}], "-", 
       RowBox[{"0.771787225570095`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.14352211980460125`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2043700345520603`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2681270244161595`"}], "-", 
       RowBox[{"0.6071438444022215`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.15186505479103415`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2478239005759886`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.008613609028514093`"}], "-", 
       RowBox[{"0.5970044400906976`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.21398620985314157`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.19304174933267024`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.04828327650186469`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.27743180406652684`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6158256914964378`"}], "-", 
       RowBox[{"0.3282078691514675`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1079202084207529`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.41122147194829284`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09096028090088515`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.24750353778629278`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.18741356329467038`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.239882110908366`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.6902568892430568`"}], "-", 
       RowBox[{"0.04706157499515032`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.10268272577955034`"}], "-", 
       RowBox[{"0.025406145407431253`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.630057986349766`"}], "-", 
       RowBox[{"0.027793534825154984`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.060432975775728245`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13038596081342116`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.68769327844795`"}], "-", 
       RowBox[{"0.026995819308094516`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1298512132,ExpressionUUID->"b5aeedc4-bc94-4de4-81ae-27eb75999123"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "3"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"e7cb1599-a3c4-4f1a-9263-8da1af340be3"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"53ba61aa-8583-46b6-bb35-81f82373addb"],
 "Hessian Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "6faf64e8-b215-4f42-bbe6-b62f16044769"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->729870429,ExpressionUUID->"d47668f4-b830-41ec-850b-e5a58604fd13"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1888803347,ExpressionUUID->"747d31e9-5e4e-4da9-bfb9-df5402b09ecf"],

Cell["Construct a QSP.", "ExampleText",
 CellID->891018326,ExpressionUUID->"d8e4a515-161b-4f5c-a204-8c1b4c39de08"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$d", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$full", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{"$d", "+", "1"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1014583075,ExpressionUUID->"e59359dc-cb27-4dab-9bd1-2835f9adde05"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678397`", ",", "1.374779148209103`", ",", 
   RowBox[{"-", "0.40637264895187375`"}]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->288954349,ExpressionUUID->"b287b23c-2abd-452a-9667-d028ae9c230d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", "$full", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->599153438,ExpressionUUID->"b7dbd8df-700e-4b12-a082-e740df197049"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678397`", ",", "1.374779148209103`", ",", 
                    RowBox[{"-", "0.40637264895187375`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{1.0523932828678397`, 1.374779148209103, -0.40637264895187375`}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->547526300,ExpressionUUID->"ecd81d07-3e15-4d25-a1cf-9465102a2d78"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP.", "ExampleText",
 CellID->316224040,ExpressionUUID->"d6f46321-35c3-4752-86ec-aed88b125c6d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->2132222963,ExpressionUUID->"ecda880b-164b-4968-89fe-f84b65b311ad"],

Cell[BoxData["0.8611328962689639`"], "Output",
 CellLabel->"Out[4]=",
 CellID->1483951291,ExpressionUUID->"7518cd6a-3886-40d2-a794-bd27ca979455"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "hss"}], "}"}], "=", 
  RowBox[{"Hessian", "[", 
   RowBox[{"qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->818380663,ExpressionUUID->"c5a2befb-8af6-467c-8609-03225daf7af5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.5153551899367814`"}], "+", 
    RowBox[{"0.8398386288552564`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5153551899367814`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552564`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.1297466907213975`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4956119965571271`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367814`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552564`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.1297466907213975`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4956119965571271`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367814`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552564`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.1297466907213975`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4956119965571271`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5153551899367814`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552564`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.1297466907213975`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.4956119965571271`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367814`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552564`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1632714667,ExpressionUUID->"42482017-317a-45a8-b909-89923bea0424"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"val", "-", 
   RowBox[{"qsp", "[", "$x", "]"}]}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->580159733,ExpressionUUID->"659a0389-ef0d-41b4-9dd7-934a2e09d3b1"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->1331267656,ExpressionUUID->"ae2809f0-be1d-4691-a254-a5b0f7b4eecc"]
}, Open  ]],

Cell["\<\
To verify the above result, let us calculate the Hessian matrix by explicitly \
taking the partial derivative with respect to the phase variables.\
\>", "ExampleText",
 CellID->1948001229,ExpressionUUID->"54fe5a2c-7e49-4611-b77d-15ce0237bf09"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$d"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun", "=", 
   RowBox[{"QSP", "[", "var", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{
   RowBox[{"Matrix", "[", 
    RowBox[{"fun", ",", "$x"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->104260101,ExpressionUUID->"8f90a565-8d9f-4853-9d9d-7875008ab817"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1655829223,ExpressionUUID->"e422c9a5-ac22-4c1d-bc3b-ded5daabce6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.2584501349634259`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][0]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.7415498650365742`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][0]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     InterpretationBox[
      SubscriptBox["\[Phi]", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`\[Phi][2]], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][2]], "]"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->281169488,ExpressionUUID->"301a223a-dae5-44ab-9616-87d217cdc4ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"fun", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", "var", ",", 
     "var"}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"var", "->", "$full"}], "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->447088284,ExpressionUUID->"d38a7113-45b4-4338-b424-baede3bdda37"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5153551899367813`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552562`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139738`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.495611996557127`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367813`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552562`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.12974669072139738`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.495611996557127`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367813`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552562`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139738`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.495611996557127`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5153551899367813`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552562`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139738`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.495611996557127`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367813`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552562`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->786739363,ExpressionUUID->"66513257-79ee-40b4-a5cb-ac47b8a7e130"]
}, Open  ]],

Cell["Finally, compare the two results.", "ExampleText",
 CellID->1592012364,ExpressionUUID->"26667780-33c4-4bd7-876a-4d1971c66e85"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hss", "-", "new"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->2109008775,ExpressionUUID->"5ad8069f-733b-424a-9b8e-8b1f3c21af16"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->1323034062,ExpressionUUID->"2554b502-a5d8-43cf-a44e-4b96a2973b4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "27e227e3-b4de-4c68-9691-20329283f65b"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->16707169,ExpressionUUID->"d8846294-e01f-465d-9128-aa3f335c99c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1832672994,ExpressionUUID->"c3789584-3f43-45a4-8cee-02e98693194d"],

Cell[TextData[{
 "Construct a QSP with a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " phase vector."
}], "ExampleText",
 CellID->377061237,ExpressionUUID->"2d43f7cc-8419-44cc-ab56-fc3bdd432a58"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$d", "=", 
  RowBox[{
   RowBox[{"2", "*", "$n"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "$parity"}], ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$phi", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{"$n", "+", "1"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->43967962,ExpressionUUID->"52b48b71-5af3-45dd-9a90-e0d079345c34"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[2]=",
 CellID->1659331825,ExpressionUUID->"ccab644f-46c3-48a2-b6dd-8a40ea57d941"],

Cell[BoxData["4"], "Output",
 CellLabel->"Out[2]=",
 CellID->1167342833,ExpressionUUID->"21eaef2c-77c8-435c-8ec6-fb84b1813176"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5339902389407847`", ",", "1.1787619696233085`", ",", 
   "0.7580510288911491`"}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->120395239,ExpressionUUID->"2abee8c0-a37f-4895-a451-ec0892008486"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->200293604,ExpressionUUID->"de24e0a2-f5c5-4cad-bd8b-567a75a1ade7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "0.5339902389407847`", ",", "1.1787619696233085`", ",", 
                    "0.7580510288911491`"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{{0.5339902389407847, 1.1787619696233085`, 0.7580510288911491}, 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1888943484,ExpressionUUID->"cf4ab41e-7df9-4869-ac98-063e38bf0f59"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP.", "ExampleText",
 CellID->1394539877,ExpressionUUID->"ad842d48-bd2c-44ba-a003-21a39475d493"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->395189381,ExpressionUUID->"ae2b7b89-9443-49c3-963c-4a08a0470172"],

Cell[BoxData["0.7222657925379279`"], "Output",
 CellLabel->"Out[4]=",
 CellID->1094546939,ExpressionUUID->"d9a9fec4-5edb-42a5-8559-3c9293ad889a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "hss"}], "}"}], "=", 
  RowBox[{"Hessian", "[", 
   RowBox[{"qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->159787830,ExpressionUUID->"c03438d6-9b35-48a3-b62b-ff5df3028192"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5769627824536401`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.41453640258641383`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2.307851129814561`"}], "+", 
        RowBox[{"1.658145610345655`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.2552598932355514`", "\[VeryThinSpace]", "+", 
        RowBox[{"2.5361482143617513`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "3.358382584793751`"}], "+", 
        RowBox[{"2.1631785520385014`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1.2552598932355514`", "\[VeryThinSpace]", "+", 
        RowBox[{"2.5361482143617513`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "2.4130282108016887`"}], "+", 
        RowBox[{"1.466902161955847`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0337064748265935`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.004835123625018166`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3.358382584793751`"}], "+", 
        RowBox[{"2.1631785520385014`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0337064748265935`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.004835123625018166`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "2.307851129814561`"}], "+", 
        RowBox[{"1.658145610345655`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1952011314,ExpressionUUID->"8541b2d7-c5aa-4aab-b08a-674a51d012a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"val", "-", 
   RowBox[{"qsp", "[", "$x", "]"}]}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1568514031,ExpressionUUID->"4b939b09-0715-4634-b6ab-8d9a03b7bc5a"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->337323295,ExpressionUUID->"26711a01-da08-4521-a686-25b4f7c121c7"]
}, Open  ]],

Cell["\<\
To verify the above result, let us calculate the Hessian matrix by explicitly \
taking the partial derivative with respect to the phase variables.\
\>", "ExampleText",
 CellID->664134417,ExpressionUUID->"31a5ecf4-8225-45b8-8a5a-0d63ac79ffec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun", "=", 
   RowBox[{"QSP", "[", 
    RowBox[{"{", 
     RowBox[{"var", ",", "$parity"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{
   RowBox[{"Matrix", "[", 
    RowBox[{"fun", ",", "$x"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1634633060,ExpressionUUID->"f6400d19-d084-405a-a6fa-0c069a978a9c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->898130752,ExpressionUUID->"4779917c-dbcf-42b4-9407-a4e333673b2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     InterpretationBox[
      SubscriptBox["\[Phi]", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`\[Phi][0]], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.7222657925379279`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.47833212492955896`"}], "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.5216678750704411`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{"0.7222657925379279`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{"0.7222657925379279`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.47833212492955896`"}], "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.5216678750704411`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->220994101,ExpressionUUID->"03ea3924-2341-4ef8-91c2-b969154ebe74"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"fun", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", "var", ",", 
     "var"}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"var", "->", "$phi"}], "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2087253347,ExpressionUUID->"5b2ee99b-ba14-457c-a4b6-f82d75c63844"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2.307851129814561`"}], "+", 
      RowBox[{"1.6581456103456544`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.2552598932355514`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.5361482143617513`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.3583825847937527`"}], "+", 
      RowBox[{"2.1631785520385014`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.2552598932355514`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.5361482143617513`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.4130282108016887`"}], "+", 
      RowBox[{"1.4669021619558464`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.033706474826593454`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.004835123625018912`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3.3583825847937527`"}], "+", 
      RowBox[{"2.1631785520385014`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.033706474826593454`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.004835123625018912`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.307851129814561`"}], "+", 
      RowBox[{"1.6581456103456544`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1447738778,ExpressionUUID->"168a37aa-ebae-4c65-b579-e83148da1819"]
}, Open  ]],

Cell["Finally, compare the two results.", "ExampleText",
 CellID->1200015267,ExpressionUUID->"5c6c169f-cdeb-4f59-a82d-dc7dfb27cd7a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hss", "-", "new"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1637663492,ExpressionUUID->"f0adb48b-b6a6-4e40-8cc4-d6baf83a2ece"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->1043009138,ExpressionUUID->"5584bc5b-2d8e-4b85-a3f7-f6b75b11773f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "2069290c-66a4-4f73-80da-6fb2878c347b"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->486630493,ExpressionUUID->"6b84c660-79fe-42f9-8483-c81b1c0d99be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1180968075,ExpressionUUID->"a864185e-7932-42db-b9d7-e31112bd000c"],

Cell[TextData[{
 "Construct a QSP with a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " phase vector."
}], "ExampleText",
 CellID->1486570951,ExpressionUUID->"0f6f9d19-8b28-4fe7-afa9-217a1955245c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$d", "=", 
  RowBox[{
   RowBox[{"2", "*", "$n"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "$parity"}], ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->973224259,ExpressionUUID->"a31e4838-f751-4f79-a4c8-c195506126f2"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[2]=",
 CellID->327528081,ExpressionUUID->"cb64bbed-dfa4-4773-b4d9-fca6af5a45f8"],

Cell[BoxData["50"], "Output",
 CellLabel->"Out[2]=",
 CellID->763870106,ExpressionUUID->"57eb7e02-07ef-4daa-8822-6c20699d0629"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1678153624,ExpressionUUID->"459b9bc3-0d6b-4865-83b6-3d6215a622bb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["50", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["50", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "0.5339902389407847`", ",", "1.1787619696233085`", ",", 
                    "0.7580510288911491`", ",", "1.1345324538881822`", ",", 
                    RowBox[{"-", "1.3517605416842526`"}], ",", 
                    "0.9052533646233885`", ",", "0.5911185260826715`", ",", 
                    RowBox[{"-", "1.2759930775363912`"}], ",", 
                    RowBox[{"-", "1.380412044034851`"}], ",", 
                    "1.4620420068679367`", ",", "0.7025872706147629`", ",", 
                    RowBox[{"-", "0.29182991018788584`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{{0.5339902389407847, 1.1787619696233085`, 0.7580510288911491, 
    1.1345324538881822`, -1.3517605416842526`, 0.9052533646233885, 
    0.5911185260826715, -1.2759930775363912`, -1.380412044034851, 
    1.4620420068679367`, 
    0.7025872706147629, -0.29182991018788584`, -0.24536498352059954`, 
    1.0646298953735762`, -0.25399141819566484`, 
    0.08863906086950202, -1.0453485273215293`, 
    0.09975231071398305, -1.0299833787160213`, -1.4448761853812915`, 
    1.4661621476657105`, -0.3262702156822801, 0.15997240332047902`, 
    1.225736529620975, 0.520354847198762, 0.8953919346918022}, 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1142100439,ExpressionUUID->"e43ab874-7150-4d48-a8ec-a2ede832dfe7"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP.", "ExampleText",
 CellID->1858429471,ExpressionUUID->"42f73f58-1237-4637-9db3-3471673d790e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1621957129,ExpressionUUID->"29dee1f0-7ea7-490a-b61d-4ca8e0276f5e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "hss"}], "}"}], "=", 
    RowBox[{"Hessian", "[", 
     RowBox[{"qsp", ",", "xx"}], "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->454622630,ExpressionUUID->"4f0aaaf2-d45b-413a-8d7f-4327a4dcdd2f"],

Cell[BoxData["9.176989`"], "EchoTiming",
 CellID->406299671,ExpressionUUID->"9fce1318-38a2-4382-a5c5-fd4ed5aac1cb"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "3"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"8345b930-e0ab-4264-894c-7346c8a51fce"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"b6bfb18c-4205-4832-8535-a4fd5f5cc359"],
 "Applications",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "78022d3e-301f-4c0c-b777-6623084d7b17"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->701469844,ExpressionUUID->"7cc9b96a-c596-4a82-acfe-7f46745f4543"],

Cell["\<\
Evaluating a QSP involves a multiplication of many matrices. The \
computational cost can be reduced to half by using the reduced phase vector.\
\>", "ExampleText",
 CellID->411726774,ExpressionUUID->"d0715729-0385-4838-8661-eb0632610536"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->271315786,ExpressionUUID->"0fac1b51-3d5f-40ad-a0f8-175077263c64"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$n", "=", 
  RowBox[{"400", "+", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"5", ",", "10"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1529848425,ExpressionUUID->"d7f43e3d-5699-407f-8527-830ce169e5f3"],

Cell[BoxData["410"], "Output",
 CellLabel->"Out[2]=",
 CellID->448778265,ExpressionUUID->"e02fb74c-ebaa-4cf5-b30b-e1fa01f6e4d0"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->653731591,ExpressionUUID->"8c53695e-ff95-47a0-8b85-655c10c84ac4"]
}, Open  ]],

Cell["Construct a QSP with the reduced phase vector.", "ExampleText",
 CellID->263062639,ExpressionUUID->"0673619a-3aee-4999-aa33-6ed72c5a4925"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$phi", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
       RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"reduced", " ", "phase", " ", "vector"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"$post", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{"Re", ",", "Im"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$phi", ",", "$parity"}], "}"}], ",", "$post"}], 
   "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->252225698,ExpressionUUID->"2d808b17-4861-4d81-91c7-8d5fff2b188b"],

Cell[BoxData["Im"], "Output",
 CellLabel->"Out[3]=",
 CellID->318150053,ExpressionUUID->"3b936281-931a-486e-8350-6a5c8ffe05d5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Im", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"1.1886524295174121`", ",", 
                    RowBox[{"-", "1.528253957058153`"}], ",", 
                    RowBox[{"-", "0.17942028160821533`"}], ",", 
                    RowBox[{"-", "1.2173503105164918`"}], ",", 
                    RowBox[{"-", "0.1188766940728172`"}], ",", 
                    RowBox[{"-", "0.1832487555143043`"}], ",", 
                    RowBox[{"-", "1.4383225005814628`"}], ",", 
                    RowBox[{"-", "1.5529442957893163`"}], ",", 
                    "1.1890198090786859`", ",", "0.8937051586490581`", ",", 
                    RowBox[{"-", "0.5875081577071493`"}], ",", 
                    RowBox[{"-", "1.3983546572808385`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[{CompressedData["
1:eJwNlns41IkXxr+VijZilygVSehmbbX7o+RMNZXaLpPamkRNIirVhCRRI2oR
EVKs1SwKkVxKCGfchSTlEmKMwRjDjLmYkUu/+ef8eZ7zPs97Pu+70umKncss
giDilcP5/JhbgYoEFGXtF4s8FcgO6XGzkVdj/pK3h8m+EiSS9k/kXS5FVtHk
RI5XDRZHHfY6NUeONg3mK7raFWjNTEmymicBve2PIrbGCSA4+ArvWwMHF2f/
YpR+ehwHdjdTDRZNYJMLxw3EHPBb5aN947QIqDaaZwOKR4HSVk6UhnKBk+Xt
TA+SYxJn+fSbHQokxe+Zcd1SByohb/FVkBg04cxsLcY3tLAP0TWy5iH9aZ/w
1HM5WPivW7DK6gtQTXr/cF3ER99FJtHFZ2VIz98ffmFFF9D6gs5df8JF43L8
y+a5GNdXP6juU1cAEa2SecE6E+lpPfWuge1ovWbZYu43CbDIznLpk0pc+HH1
78bMcWgCB9pM9QiY9c/VyFkkR8NPC9XOVzUh46/S+UGOxRjJ+zHiP9yF7LyQ
AdWeUeDzP4zWP5QjnfLpaEvsILS7JebnOUlgVLhjSVm0HKlTkWG3DbkQ+lRB
95KJkBIW7hG+ig8bQ6mDhdoyJNZtmdqUNIAkDe75wgdD4JecaXe7WYYMWmnc
+ssfoNEo6vr3egkaps5+V/ipFoi3Mr4ppRWI/42WnEweAlLZowC3ATkKNBr/
DBQKkG1sX66fywLWVWYc9x8BsOvl7WeCyyBrTtJEwRIxsjZS/+SMtSBrx7wv
j/1fY8JwwfqHCyeQtSI4K/1wM6RFY+K7TC4kBiXpZhAKJBwS2hIMbwMjYMlU
TFsVMiQnVp6sz0BW6cG5Z/QHkLoud9+2q1KkJdQ9VYutRlG3y9Jn5jwoKHQx
2icZhLTkkKzYvTwgaZ2rgioumJOO28fmyTDGxsmF6BsD0czGhSOnxoEmSOmw
mMsCImmNT0tbF6y18xm8dFSOogv/8V0PdCOrrm5jf2MP3tl8Pfv5ZjGSHoXe
5vbn49oIl+bttiJk6ammeCbKgBTberWtvQGWjb7pTYrhY5OdRAObP0OBu+vb
EXUOUNVmbI3n9kNkn7xtr+0Isr6bnNz6kAXGzSYZfm0KaH/x/BbHl4ORm+Ny
fitrw8hYFY7e7XZkzHoZ9FU7A9vDL2vU3+vFYuLVm0kdKTLWjhb/Q4wDY6Nq
wnNzFiSQO53J86VAun3T+EBLDxBfbp5lXnoOlFkbjtvTeyGzJGSXx+gw8m6E
6XhO80GQN7Ncf6cI3S7ZlX/bIACy+MMFi4MjqDFeZbCOLkL2uxDHIbtmmLL/
UkDN4yPZxnHwxTIpCizX/q5HUoDtLwlv9Gz7MIhXP7zrdwkUHGoN3trHRtWL
9bV36jmwRcdXd3fAOL7+pWJ29FsRphV+bDKBfhgP2fWeFSjDqIDJVIdQBVKe
HPCwW9iHzLuKqLMh9aC9qdvSaPYY+OS4qT0e4qLmmOqbXVVtYDZxgZLBY2Nk
9/TQ5g/DoNnZ8iR2p1JvY9NhXlQRht2Z6jhHFiBlaZvXlQX9QLMvWgreHGRf
212fbfAV6eb6r3pUeBiZ/t2D69iN5LYXzqQ+KSwM8DW+G8lHzcKfXWvrR4Hp
NxG0paAM9ktz/87hioG1wb86U5wLadpda3Ku9SLrQcJDVXYB0Bv5/+zz44Dl
15nlvncEQKpl1hrY1SAlftDvEV0MxAya/zjxEgynj4b4OX7GmIrA8OOvlL5e
76ZmoHUPvKPMOTHHxGiyI/VhBU+EpGve7gd1GyB7RUs5c7wdjecvPqS3bAKo
hQPftw7JgfBx0TcgO2P7nWxKXWE/ODB5tw6uEmD23+Vk1ZR+ZFScPvHloNKH
cSE3vQ14wHY+UurBa0aWi17NvtFaJPUkxFx0z0XSpW3Xgw9UovOtlVe/Vgyi
RZaP0IfaBx3upxPe8cVo/L4003t0EGuf+T+PGOhH2tEt+Ysf9yPzwSjp8081
GGynbe9xegTc/Net8HosA8K+U/fHvTzk3ovbvkddDEE2C6w9DvKR3vBUM9lx
ECjXyIsjTPmgCFXcl3wbx+C+SZHTkUFwjyevLfqiAPY5e6mblRBTDqiHrbwp
h+xpbqb+DwEEPe4NDq2V4+Y/6TeXnRBjcEfq8PxSDrDCOIM10mzQ+9Coemzv
MEi1tR0n5QrglZ6NiW0WQjbvxv5EWTvqGUyaSsyGgXLz4smwGRGI7tfBCf8O
yC6M5rTWKoDlbNnceaBcqXOpp+k2KfK25p2h7+ci6z+J6o67ReBQnmecQxkD
4lG3EVPYA1Pi67m0lHGInZzmjwgVaBFslnJb0goClxfSMisFUCXLz8bYScFb
4n/3kKMEj3aor+m5IIXmzTcHbLMlGDnE8rEy/IzdEus8F98xpJzjd4V+ZKNe
R2pDQosIDJt7L20rVvK+eNP55dflwN48I+r+owZot6bUvhsNYPP8vxL1nik5
/rpKzj3IU/q/XjO5sxvSehdeHBrgIqNpqW6nUy7OCyCsh87L8dhgV0lb1Dgy
h66EqI58AUoYeZE7XYC0uROrzCY70SL1RvS9mE9QmxsUZ+fAQRX59x7bFBFW
elgc6/AcQ0aNSv+qWf3gNtQ2ZvamH2f/xslX2MqwvaTaKn6rBJs4J6dtzvKQ
JSnXdbV8jVRrg7AaZ2WejItT2Ee7MTIlNfQIW4yalmWXGtL7gLRev0JnJQsM
o4TbdpNkaHLK63V0gxgtbnxP0vJuBdbqH93xue/BYfq9CUxJsWlULXafUAoq
S6NHPsaJIGVCRaP7tRxU3hw6uYsnAoeRjg+esSKgRwS13D03iKp8VtfH1Rwg
Xvyq7fpVDgyZtZQZ0gW1/oHvFnwYBZJpb+YX/c9IDJi8EkofIRF3ctMSog6J
Mw7d96qVvcNwu+vOn3vQd2kz98kRKZJYdhcmnF4jc9nUXEaYWNkr/L7b8luA
tV+roHSoEKRpW07VLhaiZfExco1lP9K3xHzx2NsE7DkPGgp02tCw4OdEnfdc
zG7uVKSXjUFkntVlq9IxoJyPmH+3h4MEVSXI6WE6ej2qIfco73dfcGK3uIqP
tivMv3pt5wKr6zyXcbgbRCW/pbieakHihqfLRWxGZpodLypV+e+aT55HhzIx
bHmQek/gIJr9lDHgdFwC7NNEclXeAFbOWMbfV5MiC3hXJw1laOjsP3BsXQWQ
0xJ7vqmL0MPz1KK7eRKU8scTA79Kgf2k/DP1fiVU2tlEjZsrQLvSUN9s9Rgk
7BPJVm+WAmtb3b2KwhIURc2jSV99RdJvi2LyOkqQ9OfsMF0/GTBSjcT9Lt1g
u5gU576HjX4tal5qAjn6aPg9yQAhNJG2OV/SGoQHOoPeN5aPocKgbHs2VXmX
6HPtH619yvz9/fHFhAzgSzR2xnPH0OzHUNpLU2U/27p2Qiu0FlbsZZmm9yrQ
8Pg3j3StJiBs/8q3iuhAwuc+NdNmGILKrn46pMZDxsF3CcNq9aBq3hjT0CdE
ympTieOmMQib2RDfk8VD9ljlpQYVFlpoaMxXXylFujg0nJbPQyL5MmfkvgiI
0JADYpO7wJj7b/jE7C4gPFbmtrYNg+G/TkjW60XK9DUr6pFxEMHUCXqEGGhH
tvd0hkkw+5TznrSHyj3ZEWePR5VAKy21Ya2vHGkBmzRvuSv1ZQb8wvcpg3ZT
Vb9wxwEw43FbAr8NIUPjirXfySIgO/06L4srRPa/tqOU+f3AeDnQYVakAFL3
Bh6Vo+Sw7n/+LhmdwBoyS9aP7oAw9cnhX+dIYX/Qt+wbamIkOx5p+bdGiPQ1
H6xq9nCRRIqWvNnxGWkZlYdWZjfCjptCS5JAjITcfVhvoBFFI9MDYVl88M3i
+W+bPYZNOdWBzhvbsHSIT/CHJKjq/CI++ZMcjYbtbcfnjCPhttDy0o9nyKDk
pLhtlwHtVZZg9YU69LOgLYimiMFw3mVewQM+anxwD+CsEmFTvbXNxbxWoDtG
pwsdOjBTwFP1ihpG5tWO/d1ajUg6YBuSF9SDhvIoDV2iGpgmWZ71XGXuaxxu
oY4KwEteZJFbp+RMRHxL0tN+aNDp6i3LkyPDRSf10/J8YG7wz0pdz8Zlc9i3
Tzsp+5wJ/5hbnwyWvu2zsu6QI4m2fvyO+C36JXguuGGn5O/aDdk+q9jYVJBv
UqI1gcZ/dF2jb5Ahc3pW2r2sdmRyK8I2zbRDynnmM9sdw0h6WR0nDWeDZXvx
M99qKdACVKymT4ihMlq0M9JRAf8HFC4ecw==
    "], -1}, Im],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->2061143388,ExpressionUUID->"dd4f577b-8270-4a50-a72a-b82f7b117a77"]
}, Open  ]],

Cell["\<\
For comparison, construct an equivalent QSP with the full phase vector.\
\>", "ExampleText",
 CellID->783735018,ExpressionUUID->"c23661cf-f763-42c3-8649-b67a2aa9c68e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gun", "=", 
  RowBox[{"QSPConvert", "[", "fun", "]"}], 
  RowBox[{"(*", 
   RowBox[{"full", " ", "phase", " ", "vector"}], "*)"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->553874063,ExpressionUUID->"052ba2a4-2e7b-414a-b179-7f30c30ed4cb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Im", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"1.1886524295174121`", ",", 
                    RowBox[{"-", "1.528253957058153`"}], ",", 
                    RowBox[{"-", "0.17942028160821533`"}], ",", 
                    RowBox[{"-", "1.2173503105164918`"}], ",", 
                    RowBox[{"-", "0.1188766940728172`"}], ",", 
                    RowBox[{"-", "0.1832487555143043`"}], ",", 
                    RowBox[{"-", "1.4383225005814628`"}], ",", 
                    RowBox[{"-", "1.5529442957893163`"}], ",", 
                    "1.1890198090786859`", ",", "0.8937051586490581`", ",", 
                    RowBox[{"-", "0.5875081577071493`"}], ",", 
                    RowBox[{"-", "1.3983546572808385`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`QSP[CompressedData["
1:eJw9mXlczPkfx2cJ5UfYdbTOkLSubbH7K9J72Ha3tY7EkiPaFCF2JCS1JuJX
CalEtrWzRKFNylGO3pOjWsUmUpKapqmm6ZpmpmZC+c0fXv7q8ehRM9/j/Xkd
z/dYz19dvT8RCAQzewoEXpvafDJNtGTIKdtya4eBZeFVPo76XL7x+c0lToFa
Fpxd0JmxLZult952XvXP4zvRS/zX9tSzY+G00RVlBnaQJJ61760li7knjs2O
b6KwsF+VrwvlPDTts3EX13Vw3ffFbmMGdHKRt9yHNHIKGh8weM86Nbk5Dlwf
cqeFXErvCbIjFCRP3eUlCtXzWfmoruvzDCw8/UP3xlmPyCT8Jl8J1dBA+qXH
IPFrtl0VPmycg5JFf9a0rr2gJ9vgyX3H2z8nN+vqbzYOUHHgAOuYO+vbWXRj
wZHNoyvIoyZ0w+5TCra6xz87XtDwlNyjuTX9DSSIMUnZ7JDCouSqgo0Hytjh
i5FDFa+1JHXy0utOPeB+/0742krSQUW0xqM7t5lsanuZXx2gZ8un/cw2PSxi
8c/ZfULd73CU8n1zcGMFyzLC60yrWkiletxScFzPIpeny0ri6qnM58yNDE8t
tbTO+zwnRs9u76Ii91kqKOJPg8i/Xc0ukUf8joxX0fQIt/qswe0smDzr3Yyz
dSw0V2zKOtpAQedSXPcVt7PYIzt+yrbH9GRc9O43BVq2TOpxO+tpPglutqsm
urwgwX9b7q4+10DCnBMhPnV6bjJ/8tOB1iaWWa26NyJdStLtknjF700kK9CX
/RKWQ6k9z3Zmfq5h6XS3n+RtJSyd1/v5yeBrnNCYOeV4v06Wjg5LvbikmJJj
+MztFAWdCT077LLAwII1CaUJlvtIHPL5u9jShyzWrhy7uuAyS7MX9fplRB27
TU6fP2e7jj0SHv1pFpfL6krv4eenKSkzy3vcfG09JZ8LT437UUnCQRse0kMF
TROuWBWX0c6xjp7egpo2UndP79e8toM8mhLLbXtJSXD2i4CS0gqa5BpQv3WZ
ntWb/1JtXFjJ0kePptc+qeL9M3enXZipYeGJiH2K2hs86Zh38VxnNUstTBN3
nGknYdyL7aVlhTSy5Xr12VgVF7lqzbn4GWX6brzZ3F9Obmbdzla9aimqRl/6
o3MzS99Yr559XEpWxdaXg0oNVHbpwm/yQDlHzYy/+lVOKUfFmcgt9pWx+JO/
Q18OvsxlR7aZFxyq5juCK9ffDtGxeFLLnd8FHSSebppwYZqUEpxeeTn10ZFw
316rhSVVJHi+d71k6wVy+WTqilWiakq5G/6dX0sjK/dEDtnRpaKmjO5RI75V
s89W13uvpzaRk+bxZttFzWze8XDMZJGaZbfD3Rtci+ndqueZbhkqdnJ0r780
UsdNdpO+thAayPmzhOsWzjUcqixo/O5rLWUufhE2u0bGplsK8vcXyGnWkMBh
34d08LXP7veIuanm5Kx/i6ypljrCv/tHeqCdo0PeJq2JMLDLqYV+rv1qWHLQ
EL0+vIAGz6i0G9ejjQKu+pidbFDwwDbT6989LCWbzs0ul5Uyjqrsapj5uJEG
vio5Ffet8X6fFC1RRt/iyP3vyjc4NbHL8FL/X/vWkseqW8Npl5xlO78vSBvz
kkXTRlypMlFy1MU3fgr3SnYqveQlrNFRv5BAq4NRKh6Y9enG/IIWkgR1hs7K
zKEFuvT/XVVoSDo1ODdFk07Jgyu+uLqzmqVHE46byjJJ9ET1+/wgOdm97B4V
uL+JhPmS/DGueexyuj7ohEhDgm6e9n7l32TZtSw8yP0Zx94/cGTFFeNcT/Ex
GzPoEO2KniaPXa5h63lJx+8r1Szcuct30bBCShtdck/SUcZWfYYuthjZSW5Z
dW9mN+hJEOA9YoyTF5ftT3N5lFVLayTK3xaNb+K0/91zMk2sZfH9dSufLzLO
YXz43l1jlCTzWprtpyxmqbdF3vyWfBZWJcRu8U1n4dY5u8MWPmCv38Zuf3m/
nm1TA1oD3Gqo3Hddwm2Vhq3+yU7Z1VLP+eeDLxyrq2WPZbNuDD1Zy5KjLcJn
/8njMNfBq/zWNZNP8OTR/ifbSbDq1bD3hzJYcSh+7g/9NRTq2NfBb5GKRYV/
DjznXk8uO52GHpuoIkOE4bD2dQeH1bxVey6tJ9/TTpNuPTeQbMMqnY99Kycu
7B85dq+e0roUKSPeN1HoyeqwiHw9z/xJtHfkSg2HlSc19smWkzRSXp+nSyOL
x09Ml//YSLrBg93f6g2kzF4fG1fcSmnKPQvOtJexxZi3E7U2jeSyd8vqyG41
qQ8/opXB5ZSWFSN/kW8gqZdd8auF94z3OXzHxDk6Vs7O+EW0QMHSv7Sm8w7e
ojX3MqyuurSR4ETlOElrFb3T7E73SOyguLddquZWA9uG2STu076gJu9Luhx7
A7lpR62PddXRLm3wwcXuWl5W3v+Lqs06Kp65t845TctRDdIAe8tnXKl1yPAO
bGOXDaqKiH9lbFGeVJhQoibL4uqtc+4Y9f7OjE2jdutJNrNbXflNHnn89s7s
zbg6Lu7z8xmL80Ydv/ZQr1ikNM5/wcBzryopubrfloY6BYuLhg975ZnOvUME
Dg2b9Ly8vuJuaXQHSxp+DTdtfk4ukU4DfEVN7NGrc7zN21dsm7Qn5lDsU8pP
D413XSNnE/2bKudENT/ws11evqONxXkmteM/qSWfhtI2m+u13OMr+Q2DczuX
3c21Pz1by0Xy1V2O65Us1d4bttHuGrs5jInM8zL6SYcmUbaskqMSkyKWyjQ8
0C5na+HFGhJOGXF/yFgpWUa3zvle2M7Wa/2vxRRq2HbPm7ODdr0g6YT3lafT
/6E1Xf9Y0zsdF7WYxc1v1ZHJ8Jjmf+PVlNhpYl55TU8m1xev/k6ppjXN5Y93
xKlJdCy05OCGejZVSSv+nSAnwaUvB298qSdxu4NOEl5B+cEHbvd93ELCidUp
z0c8Y0Gd9ZVW3QkWxK+e8bngEQt+WVN5KNeYOyznbvz20yoOHF6sOLVUx0Kp
6+ZOz2ssGfmulzhSY8wVQW+cVSUkXTAoM7shi3TJs9bmD21luzvLnfLsalk0
K/a5349FJOt5tDBzSClbZn56Zsg/Ck4rfmW4mNNGURn22+yz28hl07E+B6vk
LHAzCfU8fpH9T+Q5VRmv37fvyu81D1XsPHraS/+5CpJWbFKIl1SS+u5XiRvX
lrBgzw7vLVzMkmRXZXSS8bwPPHUhJkLCkaNC+1cdqGeb/1yu81yhJdk6wbmH
GXX8oNvu9GEzHUtJuf2tZTtbegXXLZ98n5ySz1S97q9mvx1rBxzM0LJO1XHm
wEsdyU7de+Z2+AE9cHWM7phmoMEPLEfYTGijhPnq9gkzdSSd8+jQ/ay7rI7u
7aG78pKFXw2IzSi/y8KfekQOC2oncdI4Ta13JTkPFcb7/iDjoBIzf7MmPQeY
B526TK1UJJzjtXVQPR0dUr9rz6g2NozJmZvmZrwu9bP8b17UGP3365NbEi6T
Smv+7WlFG9u8b0j+e6Ixn82e1DkoIp9G/yideLHawJYrXvtdHFREAuefb9gf
K2dBwGG3FMdGCs3Z/nSxmZLFi24nNJoVkOm0J7GFNa3sMmGi1n1GG0V2Tz1d
lapkWduDrYUmUrY1N+/Tf6yORZqIIx43lCw4t03efFhNgojwhRrrgyTu9ceR
zh4VJPAbm/6itJEs//BkJ4tqdunaae+2tIPU9G6l6JiGPJbOrXoVqeW0tV4/
JB83fk7asfUrou/SC4+kwkmBevYImTHwN1/j/aWEfKYKyKGyiaZBR9zryEap
KDnwuoHF5r86BK2+RU6eX/ZOVbSy7A/nFpc+tST+u67c5paBhJVTlW5yow4P
+yvY+/IrkjbYnBsRU06R/d82ftlTRwtCX6ftMdOwk/vSkj/yWln0xWP7vB8U
LBTGaK/Pe8Yelx8sHpv2hObtbbUTNmlYoPdttKh7wurmrrrIVBUFpiqD5/Ro
46KruQe8ppdydoNKoGrQsqnXpdPnnup5XOMq546eHSzw6We39f15FrtcTfSZ
204eV1KbJmx+xEG2Hn1jXDRk2XubMvOois0f+4bIx6u5qMDBcUvGCxK5x1xs
XVPOKU1KU//oRpZsL19QOegJCxc6h2eEVrGlPtp8mCCXJNapOwoURt83X1Li
1tJE/vpbtumPjDpz7HTJ2T9rqXBIRXVOhp7F3kOSno66QZKpwalJU2Q8sqds
3zpPY56zVi33qWmn4Tdr7B3K9Sz0mNKxX3OTgxJ29N3jatTfSVPTAsbLuCjz
hvXdQZ1s9U3FTtHUdpZ0fZJ8KLWMJYr7kTO6yyhxk+S887xGFv6dG687IiO7
sjvnA3N15BFiYt+1UkMPYtTfRrkbPv7E7/F3+D98Dj4X34PvxXXgunCduG7c
B+4L94n7xnPAc8FzwnPDc8RzxXPGc8d7wHvBe8J7w3vEe8V7xnvHHGAuMCeY
G8wR5gpzhrnDHGIuMaeYW8wx5hpzjrnHOcC5wDnBucE5wrnCOcO5wznEucQ5
xbnFOca5xjnHuYcOQBegEx9144OOQFegM9Ad6BB0CToF3YKOQdegc9A96CB0
EToJ3YSOQlehs9Bd6DB0GToN3YaOQ9eh89B9+AB8AT4B34CPwFfgM/Ad+BB8
CT4F34KPwdfgc/A9+CB8ET4J34SPwlfhs/Bd+DB8GT4N34aPw9fh8/B95ADk
AuQE5AbkCOQK5IyPueNDDkEuQU5BbkGOQa5BzkHuQQ76mIs+5CTkJuQo5Crk
LOQu5DDkMuQ05DbkOOQ65DzkPuRA5ELkRORG5EjkSuRM5E7kUORS5FTkVuRY
5FrkXORe5GDkYuRk5GbkaORq5GzkbuRw5HLkdOR25HjkeuR85H70APQC9AT0
BvQI9Ar0DPQO9BD0EvQU9Bb0GPQa9Bz0HvQg9CL0JPQm9Cj0KvQs9C70MPQy
9DT0NvQ49Dr0PPQ+9ED0QvRE9Eb0SPRK9Ez0TvRQ9FL0VPRW9Fj0WvRc9F70
YPRi9GT0ZvRo9Gr0bPRu9HD0cvR09Hb0ePR69Hz0fnCAj1zgAycANwBHAFcA
ZwB3AIcAlwCnALcAxwDXAOcA9wAHARcBJwE3AUcBVwFnAXcBhwGXAacBtwHH
AdcB5wH3AQcCFwInAjcCRwJXAmcCdwKHApcCpwK3AscC1wLnAvcCBwMXAycD
NwNHA1cDZwN3A4cDlwOnA7cDxwPXA+cD9wMHBBcEJwQ3BEcEVwRnBHcEhwSX
BKcEtwTHBNcE5wT3BAcFFwUnBTcFRwVXBWf9yF0/cFhwWXBacNuPHPcD1wXn
BfcFBwYXBicGNwZHBlcGZwZ3BocGlwanBrcGxwbXBucG9wYHBxcHJwc3B0cH
VwdnB3cHhweXB6cHtwfHB9cH5wf3xx4Ae4GPe4IPewPsEbBXwJ4BewfsIbCX
wJ4CewvsMbDXwJ4Dew/sQbAXwZ4EexPsUbBXwZ4FexfsYbCX+T9InTo8
   "], Im],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->820978259,ExpressionUUID->"44a2f935-084e-467a-bdfa-d860f9e30ed3"]
}, Open  ]],

Cell["Let us evaluate the QSP polynomial at the Chebyshev points.", \
"ExampleText",
 CellID->789353421,ExpressionUUID->"aa8a6277-adae-4603-89b2-94900fe838d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->210476177,ExpressionUUID->"3ad8bbb2-7449-4fa3-8e36-81d7ebeefac8"],

Cell["With the reduced phase vector, it is reasonably fast.", "ExampleText",
 CellID->1365905885,ExpressionUUID->"048d3223-3378-4e3b-af12-a8536c86ceab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"val", "=", 
    RowBox[{"fun", "[", "xx", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->192749570,ExpressionUUID->"d7c3223b-1bc1-453b-93a2-fb300ed2765b"],

Cell[BoxData["4.165479`"], "EchoTiming",
 CellID->1184788612,ExpressionUUID->"cdc210c1-2eb1-4f75-9864-7f627d92fca2"]
}, Open  ]],

Cell["With the full phase vector, it takes much longer.", "ExampleText",
 CellID->988870704,ExpressionUUID->"2cc3738e-1c47-4d04-9c9b-839610b5fbc0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"new", "=", 
    RowBox[{"gun", "[", "xx", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->482833766,ExpressionUUID->"c3c005b5-2118-41e9-b7fc-e08939f34b71"],

Cell[BoxData["13.188433`"], "EchoTiming",
 CellID->189680862,ExpressionUUID->"2baca9d8-0aa1-4ad5-8d90-0081fd5221d7"]
}, Open  ]],

Cell["Nevertheless, the result must be the same.", "ExampleText",
 CellID->603496782,ExpressionUUID->"87d0221a-6f5b-40ea-a0a5-462daee80d39"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"val", "-", "new"}], "//", "Chop"}], ",", "0"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->857850345,ExpressionUUID->"120319f5-23cf-4739-b546-85cf295b6976"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1100515486,ExpressionUUID->"a5778d56-be3a-4279-8fd2-2f2ed39be2c2"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QSPFind"]], "paclet:QuantumMob/Q3/ref/QSPFind", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "a05a6b0e-9e81-4f3c-a89e-5f12ec5b9b3a"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QSPConvert"]], "paclet:QuantumMob/Q3/ref/QSPConvert", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "5cd203b9-ee15-4606-b463-73d81598eaa3"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChebyshevCoefficients"]], 
           "paclet:QuantumMob/Q3/ref/ChebyshevCoefficients", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "597ccb93-ff67-4e40-827d-27c575468472"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChebyshevSeries"]], 
           "paclet:QuantumMob/Q3/ref/ChebyshevSeries", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "53a31101-970f-46ea-b982-e6b2f910e4fa"]
       }], "SeeAlso",ExpressionUUID->"831d092f-adfc-45df-a067-b1acd60a805a"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"a988cce7-6c80-4d59-a7d4-\
6146e8c86628"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Signal Processing",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumSignalProcessing"]], 
         "TechNotes",ExpressionUUID->
         "3ebba37b-537d-42a2-ba04-94cddaaa6dbd"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Linear System Problems",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumLinearSystemProblems"]], 
         "TechNotes",ExpressionUUID->
         "1cf3cb3c-5136-4331-830c-fd68c09e1813"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "970e6ad4-bbf9-462d-aa6a-5c608515fd9e"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "6d13c76a-4f90-4c5c-8993-f5b144b2d804"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Spin Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumSpinSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "6c92d6d3-f505-4197-93df-e08a8c29ec16"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"20a39c7a-8afd-4b0c-8908-\
757a5821f877"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Signal Processing"]], 
           "paclet:QuantumMob/Q3/guide/QuantumSignalProcessing"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "b564856c-c73e-4d78-85f7-fe3e388ed48e"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "89624223-273d-42f3-b1c7-566a4a220efa"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "df35c221-a2ca-42db-98c1-d7d9449ebd28"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Spin Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumSpinSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "40ad8ade-3e98-4add-a3d5-562bfd8e5d4b"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "d596fd8b-9f7c-4afb-ad8e-3a8cd3d1314a"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"d7373604-74fe-4f11-b43f-\
e68df586b3d2"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        " ",
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "QSPPACK"}]]]], 
             "https://github.com/qsppack/QSPPACK"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "a5557e9f-0855-48d9-8873-5708c5ea33f9"]}]],ExpressionUUID->
         "5fd7c0cf-2b6b-411c-ab4d-90a21c72bcb0"],
        " by Y. Dong, J. Wang, X. Meng, H. Ni and L. Lin."
       }], "RelatedLinks",ExpressionUUID->
        "1a94f1d8-c2b7-44ed-8b12-5e3083c46656"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Y. Dong et al. (2021)"}]]]], 
             "https://doi.org/10.1103/PhysRevA.103.042419"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "a5f86955-2a0a-4843-ae5b-6e101d4ab821"]}]],ExpressionUUID->
         "15e623cd-865e-4d8c-938d-f08d4a71f821"],
        ", Physical Review A 103, 042419 (2021), \".Efficient phase-factor \
evaluation in quantum signal processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "ecf429cd-39c2-466f-abfb-b622543e6394"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J. Wang et al. (2022)"}]]]], 
             "https://doi.org/10.22331/q-2022-11-03-850"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "44298751-8b98-4c09-b606-43c1b545a59a"]}]],ExpressionUUID->
         "1c0b33c9-dd11-46fe-9744-9e292ea194c5"],
        ", Quantum 6, 850 (2022), \"On the energy landscape of symmetric \
quantum signal processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "e25b702b-6422-4c90-8975-872ac0211640"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "L. Lin (2022)"}]]]], 
             "https://arxiv.org/abs/2201.08309"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "017112ff-b472-4be6-8f61-ccac69f460c3"]}]],ExpressionUUID->
         "76f24f26-457a-47e1-9d29-e0b2f1664c1f"],
        ", arXiv:2201.08309,  \"Lecture Notes on Quantum Algorithms for \
Scientific Computation.\""
       }], "RelatedLinks",ExpressionUUID->
        "2ece37d1-6600-46cd-a3c9-f102fce937ad"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "A. Gilyen, Y. Su, G. H. Low, and N. Wiebe (2019)"}]]]], 
             "https://doi.org/10.1145/3313276.3316366"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "d4a6127e-1fea-4bb9-9d49-8a82b1166c84"]}]],ExpressionUUID->
         "c248c492-e8bb-463e-b533-df859532dfc1"],
        ", Proceedings of the 51st Annual ACM SIGACT Symposium on Theory of \
Computing, \"Quantum singular value transformation and beyond: exponential \
improvements for quantum matrix arithmetics.\""
       }], "RelatedLinks",ExpressionUUID->
        "dacf70b1-9619-474c-b465-49e830cf6701"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "J. Haah (2019)"}]]]], 
             "https://doi.org/10.22331/q-2019-10-07-190"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "34dc037c-b430-40a9-a327-40a85b955afc"]}]],ExpressionUUID->
         "eb3fd00e-5357-448d-8848-f7304fec2203"],
        ", Quantum 3, 190 (2019), \"Product Decomposition of Periodic \
Functions in Quantum Signal Processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "6e77c751-9295-4bc8-9003-5436ae1cd38b"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "C. T. Kelley (1999)"}]]]],
              "https://doi.org/10.1137/1.9781611970920"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "94785c86-6245-48a3-9cf0-1f8d23f7228e"]}]],ExpressionUUID->
         "94d3c207-f259-4667-aa63-43610c6a53b4"],
        ", Iterative Methods for Optimization (SIAM, 1999)."
       }], "RelatedLinks",ExpressionUUID->
        "eb757127-0253-48f7-a693-82411ef698e8"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "W. Sun and Y.-X. Yuan (2006)"}]]]], 
             "https://doi.org/10.1007/b106451"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "71411ba1-d38f-4253-b870-6519b1c2a4a3"]}]],ExpressionUUID->
         "3aa50c17-7172-41cc-ad0d-9a1365700e48"],
        ", Optimization Theory and Methods (Kluwer Academic Publishers, 2006)."
       }], "RelatedLinks",ExpressionUUID->
        "05cdf471-2982-4c0b-8a9f-62c30ec9ab57"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "3787d1ce-9e2a-48f9-aaf6-0b20b719ba8c"]}]],ExpressionUUID->
         "ecdd3dde-4985-4c17-8b36-316ba404f34b"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "f2cb1e75-bd26-4992-95f7-5712ed956872"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"9dd5b891-1c81-4509-b2b6-\
ee2883b69b4f"],

Cell[" ", "FooterCell",ExpressionUUID->"ea960d0b-72a0-4fd9-b868-f22abc6cdbf4"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"QSP",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed, "3" -> Closed}, 
    "AllOptsTable" -> Closed, "NotesSection" -> Closed, 
    "ExampleSubsection" -> {
     "0" -> Closed, "1" -> Closed, "2" -> Closed, "3" -> Closed}}, 
  "NewStyles" -> True, "CitationPopupData" -> $Failed, "ShowCitation" -> 
  False, "HasOptions" -> True, "RootCaptions" -> "", 
  "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 3, 4, 22, 45, 5.550360}", 
    "history" -> {"14.0", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {
     "quantum signal processing", "quantum singular value transform", 
      "quantum eigenvalue transform"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> "QuantumMob/Q3",
     "status" -> "None", "summary" -> 
    "QSP[{\\[Phi]0, \\[Phi]1, \\[Phi]2, ..., \\[Phi]d}] represents the \
quantum signal processing of degree d with full phase vector {\\[Phi]0, \
\\[Phi]1, \\[Phi]2, ..., \\[Phi]d}. QSP[{{\\[Phi] 0, \\[Phi] 1, ...}, , \
parity}] represents the symmetric quantum signal processing associated with \
reduced phase vector {{\\[Phi] 0, \\[Phi] 1, ...}, parity}, where parity = \
\\[PlusMinus]1 for even and odd, respectively. QSP[{{\\[Phi]0, \\[Phi]1, \
...}, parity}, post] is equivalent to Composition[post, QSP[{\\[Phi]0, \
\\[Phi]1, ...}, parity}]].", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "QSP", "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "QSP", "type" -> "Symbol", "uri" -> "QuantumMob/Q3/ref/QSP"}},
CellContext->"Global`",
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.2 for Mac OS X ARM (64-bit) (December 26, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"00def42a-2ef6-4fcb-bc96-6ff61b504cbb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[45864, 1404, 1441, 38, 34, "PrimaryExamplesSection",ExpressionUUID->"72427243-2a3c-422d-b426-affa13c91f55",
   CellTags->"PrimaryExamplesSection",
   CellID->459329757]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 249959, 6701}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[571, 21, 7749, 185, 50, "AnchorBarGrid",ExpressionUUID->"2c7e3d8f-c2d4-4afb-bbc6-23ccf6f70166",
 CellID->1],
Cell[8323, 208, 96, 0, 22, "ContextNameCell",ExpressionUUID->"4ee23b1a-5232-4bd6-b88d-7c5f9c52215d"],
Cell[CellGroupData[{
Cell[8444, 212, 1320, 36, 57, "ObjectNameGrid",ExpressionUUID->"b6fcb020-22d9-458b-8efb-2588d3f3c9b9"],
Cell[9767, 250, 6110, 180, 273, "Usage",ExpressionUUID->"5ede1058-3dd0-43c4-b9c7-b4b3dfa7be66",
 CellID->1887563293]
}, Open  ]],
Cell[CellGroupData[{
Cell[15914, 435, 1915, 48, 34, "NotesSection",ExpressionUUID->"3e849261-94cb-4d78-9a03-b0ce6c599cf0",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->10121410],
Cell[17832, 485, 2570, 85, 70, "Notes",ExpressionUUID->"b44d462b-c110-41ab-96da-55da7c9159fa",
 CellID->915826333],
Cell[20405, 572, 3840, 135, 70, "Notes",ExpressionUUID->"d8c0db28-ebe6-4436-8000-8d1b5563e4e2",
 CellID->1931150725],
Cell[24248, 709, 4184, 144, 70, "Notes",ExpressionUUID->"bf730f1c-8ca1-499d-af93-0391a64dc671",
 CellID->765642393],
Cell[28435, 855, 2929, 99, 70, "Notes",ExpressionUUID->"475ff2be-608e-4743-beb8-160bc3ff2611",
 CellID->328467597],
Cell[31367, 956, 1755, 57, 70, "Notes",ExpressionUUID->"de9277f2-7462-4582-a847-33e36d2c5a2a",
 CellID->740487261],
Cell[33125, 1015, 5375, 168, 70, "Notes",ExpressionUUID->"8716fde1-48d5-4fe1-9116-c064b490f06f",
 CellID->958672882],
Cell[38503, 1185, 1372, 38, 70, "Notes",ExpressionUUID->"11f45084-298c-4f25-bc23-584e51954310",
 CellID->1795688728],
Cell[39878, 1225, 1951, 57, 70, "Notes",ExpressionUUID->"2159b4f7-6292-4cf9-9467-28832357f24b",
 CellID->1190343635],
Cell[41832, 1284, 3542, 104, 70, "Notes",ExpressionUUID->"df7e932d-d091-4218-a940-55989c150e9f",
 CellID->1535193593],
Cell[45377, 1390, 360, 8, 70, "Notes",ExpressionUUID->"8a6aaeed-0765-45dd-9ed2-2f52ee03d322",
 CellID->227248759]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[45864, 1404, 1441, 38, 34, "PrimaryExamplesSection",ExpressionUUID->"72427243-2a3c-422d-b426-affa13c91f55",
 CellTags->"PrimaryExamplesSection",
 CellID->459329757],
Cell[47308, 1444, 202, 3, 29, "Input",ExpressionUUID->"bfa900e0-1ca8-46cf-b1b8-525af331b307",
 CellID->556413652],
Cell[CellGroupData[{
Cell[47535, 1451, 1419, 37, 29, "ExampleSection",ExpressionUUID->"60961d8e-7a41-4624-8ee5-44c72010ba34",
 CellID->1898998581],
Cell[48957, 1490, 204, 5, 28, "Input",ExpressionUUID->"b86b7189-e8ca-4dc8-8e4e-a63c63eebb9f",
 CellID->672243474],
Cell[49164, 1497, 219, 5, 28, "Input",ExpressionUUID->"b7c855d4-9b79-45b4-99e0-4bc792d7fdca",
 CellID->484600651],
Cell[49386, 1504, 115, 1, 37, "ExampleText",ExpressionUUID->"c819da19-19f0-4ca5-ae6b-50ed781c61aa",
 CellID->1540884431],
Cell[CellGroupData[{
Cell[49526, 1509, 544, 16, 45, "Input",ExpressionUUID->"b1a1669a-d7b9-49a6-9a8f-a7a63d62dd1c",
 CellID->1425151933],
Cell[50073, 1527, 255, 5, 36, "Output",ExpressionUUID->"9a769fec-0607-4fa1-9e93-b2dca449509d",
 CellID->1618799386],
Cell[50331, 1534, 126, 2, 36, "Output",ExpressionUUID->"5584d24e-a994-46c1-9261-e3fa00b65fee",
 CellID->690956659]
}, Open  ]],
Cell[CellGroupData[{
Cell[50494, 1541, 303, 8, 28, "Input",ExpressionUUID->"1f5088b7-3044-4d9c-a056-283b123b3201",
 CellID->1098093014],
Cell[50800, 1551, 4488, 98, 60, "Output",ExpressionUUID->"f62690ed-e412-497d-addd-35390e0a0349",
 CellID->831016580]
}, Open  ]],
Cell[55303, 1652, 114, 1, 37, "ExampleText",ExpressionUUID->"2c0d8cd0-2978-46fa-b14b-38ac226f4daa",
 CellID->569269380],
Cell[CellGroupData[{
Cell[55442, 1657, 293, 8, 70, "Input",ExpressionUUID->"ee7c92e0-c8c1-405d-831c-d5e394c9ad0c",
 CellID->1920729624],
Cell[55738, 1667, 145, 2, 36, "Output",ExpressionUUID->"043818cd-4613-4cd5-830b-e8a5c8429b3c",
 CellID->1843653352]
}, Open  ]],
Cell[55898, 1672, 144, 1, 70, "ExampleText",ExpressionUUID->"615ff83c-ba4f-4445-bfe1-de56c1c731c5",
 CellID->1970697472],
Cell[CellGroupData[{
Cell[56067, 1677, 216, 5, 70, "Input",ExpressionUUID->"2b5af503-14fa-435a-8308-3b9dd430e473",
 CellID->1579083477],
Cell[56286, 1684, 163, 3, 36, "Output",ExpressionUUID->"b58d0472-185e-485d-a273-8bc9555d63f9",
 CellID->1336212431]
}, Open  ]],
Cell[56464, 1690, 173, 3, 70, "ExampleText",ExpressionUUID->"6226b4bf-dfaa-4268-8ff7-b27bb92e5934",
 CellID->1682239748],
Cell[CellGroupData[{
Cell[56662, 1697, 294, 8, 70, "Input",ExpressionUUID->"5f974254-6ac7-4800-a357-c35e053fd251",
 CellID->487601425],
Cell[56959, 1707, 348, 9, 36, "Output",ExpressionUUID->"0eeb62dd-0377-4759-990e-c44e14521b48",
 CellID->1801030237]
}, Open  ]],
Cell[57322, 1719, 189, 4, 70, "ExampleText",ExpressionUUID->"7a52037d-2f12-4679-b0fa-862fd1a263c1",
 CellID->1831286845],
Cell[CellGroupData[{
Cell[57536, 1727, 392, 10, 70, "Input",ExpressionUUID->"e41fb03f-14fc-4c0b-b0ce-10f4910ef80f",
 CellID->1520012391],
Cell[57931, 1739, 295, 7, 36, "Output",ExpressionUUID->"052bfc1f-db0b-40e1-a66a-6a04c954f955",
 CellID->560859652],
Cell[58229, 1748, 899, 23, 75, "Output",ExpressionUUID->"78379620-56be-45eb-a63b-05c1a6742f97",
 CellID->1062444481]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[59277, 1779, 1411, 37, 70, "ExampleSection",ExpressionUUID->"2374f366-8587-4262-9aeb-d5dca1849abc",
 CellID->1703330544],
Cell[CellGroupData[{
Cell[60713, 1820, 1421, 37, 70, "ExampleSubsection",ExpressionUUID->"fe682a93-2075-4ba7-913b-f82f04c9e857",
 CellID->1625224184],
Cell[62137, 1859, 223, 5, 70, "Input",ExpressionUUID->"522e9533-92cc-46e8-bd0e-9a0322b46499",
 CellID->866063270],
Cell[62363, 1866, 205, 5, 70, "Input",ExpressionUUID->"4d23828f-d1c1-480b-b744-c22ab47ecdd5",
 CellID->1774012929],
Cell[62571, 1873, 115, 1, 70, "ExampleText",ExpressionUUID->"bc5f8627-527a-4906-99fb-414df1c74775",
 CellID->1210812697],
Cell[CellGroupData[{
Cell[62711, 1878, 355, 9, 70, "Input",ExpressionUUID->"e01ccbbf-f57d-4e8c-aca4-6844d1f70894",
 CellID->93372207],
Cell[63069, 1889, 607, 19, 36, "Output",ExpressionUUID->"870dfc80-e2cf-4f9e-a616-cd576920d556",
 CellID->422583316],
Cell[63679, 1910, 143, 3, 36, "Output",ExpressionUUID->"3d470fd0-ee7f-49a1-a623-47e23d31d679",
 CellID->629371383]
}, Open  ]],
Cell[CellGroupData[{
Cell[63859, 1918, 277, 7, 70, "Input",ExpressionUUID->"b2f5d262-ceeb-4ccf-b77b-ba9be1270fbe",
 CellID->1264054559],
Cell[64139, 1927, 5033, 110, 70, "Output",ExpressionUUID->"50f92d74-53f2-4bd0-81c2-47f047f135fb",
 CellID->58382099]
}, Open  ]],
Cell[69187, 2040, 125, 1, 70, "ExampleText",ExpressionUUID->"49ab42f4-e8a8-46f9-a7a0-480c3095366f",
 CellID->645597649],
Cell[69315, 2043, 383, 11, 70, "Input",ExpressionUUID->"5d56aff1-0b5f-40b2-a3a7-c2645a4d2db9",
 CellID->1538010568],
Cell[CellGroupData[{
Cell[69723, 2058, 202, 4, 70, "Input",ExpressionUUID->"e7be22ca-7680-44e1-810a-b6a0b5419df6",
 CellID->2098320073],
Cell[69928, 2064, 171, 4, 36, "Output",ExpressionUUID->"8316e1f6-7904-499d-83aa-e15edb9f11da",
 CellID->219690561]
}, Open  ]],
Cell[CellGroupData[{
Cell[70136, 2073, 273, 7, 70, "Input",ExpressionUUID->"bc184841-fe94-4090-9135-531b487a529c",
 CellID->1894606122],
Cell[70412, 2082, 5788, 175, 88, "Output",ExpressionUUID->"1c38d2a5-a575-428b-945c-6fcb4a04d06e",
 CellID->578746079]
}, Open  ]],
Cell[CellGroupData[{
Cell[76237, 2262, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"1226e71a-041f-4246-9929-8ffe9ec4452d",
 CellID->706601561],
Cell[76482, 2269, 206, 5, 70, "Input",ExpressionUUID->"ed0e0ee3-5e03-43da-b306-ebf918d483ef",
 CellID->349864653],
Cell[76691, 2276, 220, 5, 70, "Input",ExpressionUUID->"13f57842-def9-4203-ba76-284c5108a597",
 CellID->1138088487],
Cell[CellGroupData[{
Cell[76936, 2285, 571, 17, 70, "Input",ExpressionUUID->"66ed82b2-38bc-428e-abab-01bdbcc70bd0",
 CellID->2147261437],
Cell[77510, 2304, 127, 2, 36, "Output",ExpressionUUID->"559027b1-5c77-418c-aa87-0920735cd18f",
 CellID->1509109399]
}, Open  ]],
Cell[CellGroupData[{
Cell[77674, 2311, 275, 7, 70, "Input",ExpressionUUID->"4bad6c8e-214a-4478-89fa-04147f88aa75",
 CellID->745752491],
Cell[77952, 2320, 8142, 160, 70, "Output",ExpressionUUID->"eb12e54f-7824-4c63-9467-e346ce705896",
 CellID->983480955]
}, Open  ]],
Cell[86109, 2483, 306, 8, 70, "Input",ExpressionUUID->"9316da6a-afb6-40fb-afe9-1b224c069f62",
 CellID->1123936882],
Cell[CellGroupData[{
Cell[86440, 2495, 342, 10, 70, "Input",ExpressionUUID->"40580c9f-b911-4997-9852-41a6c126db52",
 CellID->1756899605],
Cell[86785, 2507, 115, 1, 70, "EchoTiming",ExpressionUUID->"24ec68e7-4757-4d16-9cb9-e707e1af75fe",
 CellID->889511317]
}, Open  ]],
Cell[CellGroupData[{
Cell[86937, 2513, 305, 8, 70, "Input",ExpressionUUID->"24f6294b-238c-487e-b30b-a4beee34cfce",
 CellID->1891135613],
Cell[87245, 2523, 5011, 119, 106, "Output",ExpressionUUID->"862e11f3-7152-4077-9538-b3df52195edc",
 CellID->596814346]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[92420, 2651, 1422, 37, 70, "ExampleSubsection",ExpressionUUID->"8c0e37d2-2200-4cef-b7f1-508936aa475a",
 CellID->976509307],
Cell[93845, 2690, 204, 5, 70, "Input",ExpressionUUID->"b9796203-1591-47e3-a94b-7251110451f5",
 CellID->404620761],
Cell[94052, 2697, 220, 5, 70, "Input",ExpressionUUID->"af58350c-d1ea-47bd-b3cf-9a94c8a622e7",
 CellID->1527903725],
Cell[94275, 2704, 114, 1, 70, "ExampleText",ExpressionUUID->"fb847c95-45e8-4d6a-8e3c-79ad16753d07",
 CellID->645812421],
Cell[CellGroupData[{
Cell[94414, 2709, 498, 15, 70, "Input",ExpressionUUID->"9d53a80e-6190-4e72-b5f1-12b487063712",
 CellID->2015938896],
Cell[94915, 2726, 255, 5, 36, "Output",ExpressionUUID->"808fb9ba-2b37-4244-b656-24794cabf138",
 CellID->1621756012]
}, Open  ]],
Cell[CellGroupData[{
Cell[95207, 2736, 276, 7, 70, "Input",ExpressionUUID->"4e07737f-6044-425a-b625-e77d07c2e99d",
 CellID->883939583],
Cell[95486, 2745, 4560, 100, 70, "Output",ExpressionUUID->"ec9a160f-9ad5-41b3-b07a-994886ef1244",
 CellID->205122666]
}, Open  ]],
Cell[CellGroupData[{
Cell[100083, 2850, 334, 9, 70, "Input",ExpressionUUID->"9998c65f-09bd-4e29-9a8c-5df5bc8146b0",
 CellID->1288517488],
Cell[100420, 2861, 161, 3, 36, "Output",ExpressionUUID->"c801e09c-e445-4ba5-8032-803031a35e71",
 CellID->204953888]
}, Open  ]],
Cell[100596, 2867, 149, 1, 70, "ExampleText",ExpressionUUID->"72e11a8f-bea2-41eb-b46b-7f7ef199ceff",
 CellID->1991143895],
Cell[CellGroupData[{
Cell[100770, 2872, 299, 8, 70, "Input",ExpressionUUID->"7fc647c5-5f88-4f76-a598-5d563b4d4c51",
 CellID->763019732],
Cell[101072, 2882, 720, 18, 36, "Output",ExpressionUUID->"877ba44f-c921-410b-95ac-5b1ea28e4db8",
 CellID->1032165591]
}, Open  ]],
Cell[101807, 2903, 199, 4, 70, "ExampleText",ExpressionUUID->"9601b6f5-1d7e-49f8-80cd-235a912ee34a",
 CellID->2001042392],
Cell[CellGroupData[{
Cell[102031, 2911, 1034, 30, 70, "Input",ExpressionUUID->"cd76d376-d1b3-4909-84b9-238975c3de48",
 CellID->1840117499],
Cell[103068, 2943, 607, 19, 36, "Output",ExpressionUUID->"2c1d8412-19eb-449d-8fbc-3bfb7c75db28",
 CellID->417734221],
Cell[103678, 2964, 5034, 110, 70, "Output",ExpressionUUID->"8c6cdc9c-138b-4662-8b9a-b610d5a9a08d",
 CellID->735010304],
Cell[108715, 3076, 532, 14, 36, "Output",ExpressionUUID->"eb213834-0649-4529-a0c4-4c395b2b359f",
 CellID->992241784]
}, Open  ]],
Cell[CellGroupData[{
Cell[109284, 3095, 218, 5, 70, "Input",ExpressionUUID->"c06f722f-eb07-4ef5-b173-9d2d48e53ac7",
 CellID->1440956291],
Cell[109505, 3102, 181, 4, 36, "Output",ExpressionUUID->"b5adb423-cba1-4c03-9a66-e06d36be463e",
 CellID->228926762]
}, Open  ]],
Cell[CellGroupData[{
Cell[109723, 3111, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"c653f00a-18ba-49f9-b36b-2a2fbd1bc488",
 CellID->1767104397],
Cell[109969, 3118, 204, 5, 70, "Input",ExpressionUUID->"2763b469-a903-48e7-8655-8da24dff2e0c",
 CellID->24762369],
Cell[110176, 3125, 220, 5, 70, "Input",ExpressionUUID->"e0c7f7e0-eadf-4d0e-ba02-24cef995d533",
 CellID->1716791912],
Cell[CellGroupData[{
Cell[110421, 3134, 570, 17, 70, "Input",ExpressionUUID->"1b054472-f762-438a-a2fa-1c4b9fd4185f",
 CellID->531383892],
Cell[110994, 3153, 126, 2, 36, "Output",ExpressionUUID->"9b554fbe-75c2-4a0d-8c56-7141e22fb1f1",
 CellID->676666589]
}, Open  ]],
Cell[CellGroupData[{
Cell[111157, 3160, 276, 7, 70, "Input",ExpressionUUID->"e9a71116-87c4-414d-84f7-23c6e6f3750b",
 CellID->1736427641],
Cell[111436, 3169, 5799, 121, 70, "Output",ExpressionUUID->"f287608f-6989-4ceb-ad80-2c347513ead6",
 CellID->581207287]
}, Open  ]],
Cell[117250, 3293, 305, 8, 70, "Input",ExpressionUUID->"818e788d-63f9-43c5-9ab6-5b0d80ab027e",
 CellID->360339012],
Cell[CellGroupData[{
Cell[117580, 3305, 362, 10, 70, "Input",ExpressionUUID->"a6f5cf4c-262f-46ac-b83e-eff2f7cd1d73",
 CellID->313890144],
Cell[117945, 3317, 116, 1, 70, "EchoTiming",ExpressionUUID->"c50c6e80-ffe2-4fb6-915a-412f1f662316",
 CellID->1895513536]
}, Open  ]],
Cell[CellGroupData[{
Cell[118098, 3323, 393, 11, 70, "Input",ExpressionUUID->"330649f1-82c2-4211-b01b-6e931fca3cc0",
 CellID->1745720274],
Cell[118494, 3336, 3855, 91, 107, "Output",ExpressionUUID->"b07fd5a7-d443-4a69-ac11-20d066c9c495",
 CellID->2123579954]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[122513, 3436, 1428, 37, 70, "ExampleSubsection",ExpressionUUID->"cc0bb814-97c6-49ce-8a2a-85c6b83a19f3",
 CellID->38255620],
Cell[123944, 3475, 204, 5, 70, "Input",ExpressionUUID->"6ca907c0-caa2-4349-94a9-20d1ac2d6f93",
 CellID->864594887],
Cell[124151, 3482, 220, 5, 70, "Input",ExpressionUUID->"cebef06d-0b3a-4373-8736-96f366e1e6b0",
 CellID->1371910207],
Cell[124374, 3489, 114, 1, 70, "ExampleText",ExpressionUUID->"8a1d4fd0-77b6-4381-b71f-f2a870aa7953",
 CellID->162931210],
Cell[CellGroupData[{
Cell[124513, 3494, 497, 15, 70, "Input",ExpressionUUID->"4a91804f-85ea-4421-93d6-f77ecf04dbed",
 CellID->343196545],
Cell[125013, 3511, 254, 5, 36, "Output",ExpressionUUID->"3d029e7c-78fe-41a0-9d2e-079999009d24",
 CellID->933628700]
}, Open  ]],
Cell[CellGroupData[{
Cell[125304, 3521, 276, 7, 70, "Input",ExpressionUUID->"9231cdfe-d66b-44d5-9699-af661d062e57",
 CellID->918428547],
Cell[125583, 3530, 4560, 100, 70, "Output",ExpressionUUID->"f6ec1355-1acc-48e7-94c7-7c5e76c468b7",
 CellID->574913399]
}, Open  ]],
Cell[CellGroupData[{
Cell[130180, 3635, 334, 9, 70, "Input",ExpressionUUID->"8c14325c-27ea-4a9f-83bc-dc2f879649ce",
 CellID->1374222030],
Cell[130517, 3646, 161, 3, 36, "Output",ExpressionUUID->"549cec62-d2dc-4a27-b3e3-463f01f8b024",
 CellID->722564189]
}, Open  ]],
Cell[130693, 3652, 148, 1, 70, "ExampleText",ExpressionUUID->"b5467a3c-11ea-4cf8-9ec6-7bdd2b1f4f13",
 CellID->523581948],
Cell[130844, 3655, 296, 8, 70, "Input",ExpressionUUID->"0087cd79-2fbb-4acf-bc64-482cd81bc3e9",
 CellID->1601298277],
Cell[CellGroupData[{
Cell[131165, 3667, 165, 3, 70, "Input",ExpressionUUID->"83d9fa8a-145b-4502-9bb3-b8916c6c9763",
 CellID->450237662],
Cell[131333, 3672, 539, 14, 36, "Output",ExpressionUUID->"ca4ecfb3-204e-4470-9b34-ffa57a9cff4f",
 CellID->860680741]
}, Open  ]],
Cell[CellGroupData[{
Cell[131909, 3691, 200, 4, 70, "Input",ExpressionUUID->"edbb0620-5499-4375-ae8e-7f972d1669c5",
 CellID->30274202],
Cell[132112, 3697, 1751, 40, 75, "Output",ExpressionUUID->"433be19c-17d9-4177-a2c8-b11bf3725949",
 CellID->1452619630]
}, Open  ]],
Cell[CellGroupData[{
Cell[133900, 3742, 347, 9, 70, "Input",ExpressionUUID->"a3efdfbf-5ac9-4b1d-8cea-44aa220b98d2",
 CellID->429782927],
Cell[134250, 3753, 539, 14, 36, "Output",ExpressionUUID->"c66a8378-4b59-4198-8000-4ebbbd4aeb76",
 CellID->1517646919]
}, Open  ]],
Cell[CellGroupData[{
Cell[134826, 3772, 217, 5, 70, "Input",ExpressionUUID->"67cc20d2-abe5-49f5-8061-803041e83f55",
 CellID->379226317],
Cell[135046, 3779, 182, 4, 36, "Output",ExpressionUUID->"7840e174-f8ce-488a-9b2d-c70fb9c92f3c",
 CellID->864834938]
}, Open  ]],
Cell[CellGroupData[{
Cell[135265, 3788, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"c90708c5-5fd6-4d64-84f2-330a8d2c7d57",
 CellID->512088563],
Cell[135510, 3795, 206, 5, 70, "Input",ExpressionUUID->"ed0483fa-e41f-408b-bd00-46ab64abc3da",
 CellID->1705504812],
Cell[135719, 3802, 220, 5, 70, "Input",ExpressionUUID->"2fe1e470-9dab-46f0-af4f-fbd24ef9a96f",
 CellID->1955138775],
Cell[CellGroupData[{
Cell[135964, 3811, 571, 17, 70, "Input",ExpressionUUID->"a2ba2066-968e-4a76-9815-751778d6e288",
 CellID->1370108678],
Cell[136538, 3830, 127, 2, 36, "Output",ExpressionUUID->"39170ca9-8dfd-4022-b53e-d3ba6c42f1fc",
 CellID->2077003281]
}, Open  ]],
Cell[CellGroupData[{
Cell[136702, 3837, 275, 7, 70, "Input",ExpressionUUID->"8113bbfa-8489-4230-9df1-4c9b5fdf9fa4",
 CellID->42686767],
Cell[136980, 3846, 5799, 121, 70, "Output",ExpressionUUID->"a6b6490e-9a47-4f4c-9671-9b9ccd6f075d",
 CellID->245632230]
}, Open  ]],
Cell[142794, 3970, 306, 8, 70, "Input",ExpressionUUID->"0429ac23-4f29-4c77-af33-2c993144fc9d",
 CellID->1963149449],
Cell[CellGroupData[{
Cell[143125, 3982, 336, 9, 70, "Input",ExpressionUUID->"2e802f9f-488c-483c-8775-2e357e686f4b",
 CellID->714036835],
Cell[143464, 3993, 116, 1, 70, "EchoTiming",ExpressionUUID->"13e108ad-7ae0-4075-81a1-25541f5293b4",
 CellID->1081187110]
}, Open  ]],
Cell[CellGroupData[{
Cell[143617, 3999, 393, 11, 70, "Input",ExpressionUUID->"1007e60f-bc2b-4941-8664-fffd8d27de0a",
 CellID->1994254140],
Cell[144013, 4012, 3858, 82, 107, "Output",ExpressionUUID->"b5aeedc4-bc94-4de4-81ae-27eb75999123",
 CellID->1298512132]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed]]]],
Cell[CellGroupData[{
Cell[148035, 4103, 1428, 37, 70, "ExampleSubsection",ExpressionUUID->"d47668f4-b830-41ec-850b-e5a58604fd13",
 CellID->729870429],
Cell[149466, 4142, 220, 5, 70, "Input",ExpressionUUID->"747d31e9-5e4e-4da9-bfb9-df5402b09ecf",
 CellID->1888803347],
Cell[149689, 4149, 114, 1, 70, "ExampleText",ExpressionUUID->"d8e4a515-161b-4f5c-a204-8c1b4c39de08",
 CellID->891018326],
Cell[CellGroupData[{
Cell[149828, 4154, 476, 14, 70, "Input",ExpressionUUID->"e59359dc-cb27-4dab-9bd1-2835f9adde05",
 CellID->1014583075],
Cell[150307, 4170, 254, 5, 36, "Output",ExpressionUUID->"b287b23c-2abd-452a-9667-d028ae9c230d",
 CellID->288954349]
}, Open  ]],
Cell[CellGroupData[{
Cell[150598, 4180, 221, 5, 70, "Input",ExpressionUUID->"b7dbd8df-700e-4b12-a082-e740df197049",
 CellID->599153438],
Cell[150822, 4187, 4481, 97, 70, "Output",ExpressionUUID->"ecd81d07-3e15-4d25-a1cf-9465102a2d78",
 CellID->547526300]
}, Open  ]],
Cell[155318, 4287, 138, 1, 70, "ExampleText",ExpressionUUID->"d6f46321-35c3-4752-86ec-aed88b125c6d",
 CellID->316224040],
Cell[CellGroupData[{
Cell[155481, 4292, 294, 8, 70, "Input",ExpressionUUID->"ecda880b-164b-4968-89fe-f84b65b311ad",
 CellID->2132222963],
Cell[155778, 4302, 145, 2, 36, "Output",ExpressionUUID->"7518cd6a-3886-40d2-a794-bd27ca979455",
 CellID->1483951291]
}, Open  ]],
Cell[CellGroupData[{
Cell[155960, 4309, 297, 8, 70, "Input",ExpressionUUID->"c5a2befb-8af6-467c-8609-03225daf7af5",
 CellID->818380663],
Cell[156260, 4319, 1667, 34, 68, "Output",ExpressionUUID->"42482017-317a-45a8-b909-89923bea0424",
 CellID->1632714667]
}, Open  ]],
Cell[CellGroupData[{
Cell[157964, 4358, 246, 6, 70, "Input",ExpressionUUID->"659a0389-ef0d-41b4-9dd7-934a2e09d3b1",
 CellID->580159733],
Cell[158213, 4366, 127, 2, 36, "Output",ExpressionUUID->"ae2809f0-be1d-4691-a254-a5b0f7b4eecc",
 CellID->1331267656]
}, Open  ]],
Cell[158355, 4371, 253, 4, 70, "ExampleText",ExpressionUUID->"54fe5a2c-7e49-4611-b77d-15ce0237bf09",
 CellID->1948001229],
Cell[CellGroupData[{
Cell[158633, 4379, 663, 18, 70, "Input",ExpressionUUID->"8f90a565-8d9f-4853-9d9d-7875008ab817",
 CellID->104260101],
Cell[159299, 4399, 608, 19, 36, "Output",ExpressionUUID->"e422c9a5-ac22-4c1d-bc3b-ded5daabce6f",
 CellID->1655829223],
Cell[159910, 4420, 3004, 89, 52, "Output",ExpressionUUID->"301a223a-dae5-44ab-9616-87d217cdc4ef",
 CellID->281169488]
}, Open  ]],
Cell[CellGroupData[{
Cell[162951, 4514, 450, 13, 70, "Input",ExpressionUUID->"d38a7113-45b4-4338-b424-baede3bdda37",
 CellID->447088284],
Cell[163404, 4529, 1450, 29, 68, "Output",ExpressionUUID->"66513257-79ee-40b4-a5cb-ac47b8a7e130",
 CellID->786739363]
}, Open  ]],
Cell[164869, 4561, 132, 1, 70, "ExampleText",ExpressionUUID->"26667780-33c4-4bd7-876a-4d1971c66e85",
 CellID->1592012364],
Cell[CellGroupData[{
Cell[165026, 4566, 253, 7, 70, "Input",ExpressionUUID->"5ad8069f-733b-424a-9b8e-8b1f3c21af16",
 CellID->2109008775],
Cell[165282, 4575, 625, 18, 75, "Output",ExpressionUUID->"2554b502-a5d8-43cf-a44e-4b96a2973b4d",
 CellID->1323034062]
}, Open  ]],
Cell[CellGroupData[{
Cell[165944, 4598, 241, 5, 70, "ExampleDelimiter",ExpressionUUID->"d8846294-e01f-465d-9128-aa3f335c99c2",
 CellID->16707169],
Cell[166188, 4605, 220, 5, 70, "Input",ExpressionUUID->"c3789584-3f43-45a4-8cee-02e98693194d",
 CellID->1832672994],
Cell[166411, 4612, 200, 6, 70, "ExampleText",ExpressionUUID->"2d43f7cc-8419-44cc-ab56-fc3bdd432a58",
 CellID->377061237],
Cell[CellGroupData[{
Cell[166636, 4622, 818, 25, 70, "Input",ExpressionUUID->"52b48b71-5af3-45dd-9a90-e0d079345c34",
 CellID->43967962],
Cell[167457, 4649, 127, 2, 36, "Output",ExpressionUUID->"ccab644f-46c3-48a2-b6dd-8a40ea57d941",
 CellID->1659331825],
Cell[167587, 4653, 127, 2, 36, "Output",ExpressionUUID->"21eaef2c-77c8-435c-8ec6-fb84b1813176",
 CellID->1167342833],
Cell[167717, 4657, 242, 6, 36, "Output",ExpressionUUID->"2abee8c0-a37f-4895-a451-ec0892008486",
 CellID->120395239]
}, Open  ]],
Cell[CellGroupData[{
Cell[167996, 4668, 275, 7, 70, "Input",ExpressionUUID->"de24e0a2-f5c5-4cad-bd8b-567a75a1ade7",
 CellID->200293604],
Cell[168274, 4677, 4451, 96, 70, "Output",ExpressionUUID->"cf4ab41e-7df9-4869-ac98-063e38bf0f59",
 CellID->1888943484]
}, Open  ]],
Cell[172740, 4776, 139, 1, 70, "ExampleText",ExpressionUUID->"ad842d48-bd2c-44ba-a003-21a39475d493",
 CellID->1394539877],
Cell[CellGroupData[{
Cell[172904, 4781, 293, 8, 70, "Input",ExpressionUUID->"ae2b7b89-9443-49c3-963c-4a08a0470172",
 CellID->395189381],
Cell[173200, 4791, 145, 2, 36, "Output",ExpressionUUID->"d9a9fec4-5edb-42a5-8559-3c9293ad889a",
 CellID->1094546939]
}, Open  ]],
Cell[CellGroupData[{
Cell[173382, 4798, 297, 8, 70, "Input",ExpressionUUID->"c03438d6-9b35-48a3-b62b-ff5df3028192",
 CellID->159787830],
Cell[173682, 4808, 1685, 38, 68, "Output",ExpressionUUID->"8541b2d7-c5aa-4aab-b08a-674a51d012a5",
 CellID->1952011314]
}, Open  ]],
Cell[CellGroupData[{
Cell[175404, 4851, 247, 6, 70, "Input",ExpressionUUID->"4b939b09-0715-4634-b6ab-8d9a03b7bc5a",
 CellID->1568514031],
Cell[175654, 4859, 126, 2, 36, "Output",ExpressionUUID->"26711a01-da08-4521-a686-25b4f7c121c7",
 CellID->337323295]
}, Open  ]],
Cell[175795, 4864, 252, 4, 70, "ExampleText",ExpressionUUID->"31a5ecf4-8225-45b8-8a5a-0d63ac79ffec",
 CellID->664134417],
Cell[CellGroupData[{
Cell[176072, 4872, 721, 20, 70, "Input",ExpressionUUID->"f6400d19-d084-405a-a6fa-0c069a978a9c",
 CellID->1634633060],
Cell[176796, 4894, 607, 19, 36, "Output",ExpressionUUID->"4779917c-dbcf-42b4-9407-a4e333673b2a",
 CellID->898130752],
Cell[177406, 4915, 16166, 420, 173, "Output",ExpressionUUID->"03ea3924-2341-4ef8-91c2-b969154ebe74",
 CellID->220994101]
}, Open  ]],
Cell[CellGroupData[{
Cell[193609, 5340, 450, 13, 70, "Input",ExpressionUUID->"5b2ee99b-ba14-457c-a4b6-f82d75c63844",
 CellID->2087253347],
Cell[194062, 5355, 1467, 34, 68, "Output",ExpressionUUID->"168a37aa-ebae-4c65-b579-e83148da1819",
 CellID->1447738778]
}, Open  ]],
Cell[195544, 5392, 132, 1, 70, "ExampleText",ExpressionUUID->"5c6c169f-cdeb-4f59-a82d-dc7dfb27cd7a",
 CellID->1200015267],
Cell[CellGroupData[{
Cell[195701, 5397, 253, 7, 70, "Input",ExpressionUUID->"f0adb48b-b6a6-4e40-8cc4-d6baf83a2ece",
 CellID->1637663492],
Cell[195957, 5406, 625, 18, 75, "Output",ExpressionUUID->"5584bc5b-2d8e-4b85-a3f7-f6b75b11773f",
 CellID->1043009138]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196631, 5430, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"6b84c660-79fe-42f9-8483-c81b1c0d99be",
 CellID->486630493],
Cell[196876, 5437, 220, 5, 70, "Input",ExpressionUUID->"a864185e-7932-42db-b9d7-e31112bd000c",
 CellID->1180968075],
Cell[197099, 5444, 201, 6, 70, "ExampleText",ExpressionUUID->"0f6f9d19-8b28-4fe7-afa9-217a1955245c",
 CellID->1486570951],
Cell[CellGroupData[{
Cell[197325, 5454, 846, 26, 70, "Input",ExpressionUUID->"a31e4838-f751-4f79-a4c8-c195506126f2",
 CellID->973224259],
Cell[198174, 5482, 126, 2, 36, "Output",ExpressionUUID->"cb64bbed-dfa4-4773-b4d9-fca6af5a45f8",
 CellID->327528081],
Cell[198303, 5486, 127, 2, 36, "Output",ExpressionUUID->"57eb7e02-07ef-4daa-8822-6c20699d0629",
 CellID->763870106]
}, Open  ]],
Cell[CellGroupData[{
Cell[198467, 5493, 276, 7, 70, "Input",ExpressionUUID->"459b9bc3-0d6b-4865-83b6-3d6215a622bb",
 CellID->1678153624],
Cell[198746, 5502, 5441, 112, 70, "Output",ExpressionUUID->"e43ab874-7150-4d48-a8ec-a2ede832dfe7",
 CellID->1142100439]
}, Open  ]],
Cell[204202, 5617, 139, 1, 70, "ExampleText",ExpressionUUID->"42f73f58-1237-4637-9db3-3471673d790e",
 CellID->1858429471],
Cell[204344, 5620, 306, 8, 70, "Input",ExpressionUUID->"29dee1f0-7ea7-490a-b61d-4ca8e0276f5e",
 CellID->1621957129],
Cell[CellGroupData[{
Cell[204675, 5632, 361, 10, 70, "Input",ExpressionUUID->"4f0aaaf2-d45b-413a-8d7f-4327a4dcdd2f",
 CellID->454622630],
Cell[205039, 5644, 115, 1, 70, "EchoTiming",ExpressionUUID->"9fce1318-38a2-4382-a5c5-fd4ed5aac1cb",
 CellID->406299671]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "3"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[205430, 5657, 1417, 37, 70, "ExampleSection",ExpressionUUID->"7cc9b96a-c596-4a82-acfe-7f46745f4543",
 CellID->701469844],
Cell[206850, 5696, 249, 4, 70, "ExampleText",ExpressionUUID->"d0715729-0385-4838-8661-eb0632610536",
 CellID->411726774],
Cell[207102, 5702, 219, 5, 70, "Input",ExpressionUUID->"0fac1b51-3d5f-40ad-a0f8-175077263c64",
 CellID->271315786],
Cell[CellGroupData[{
Cell[207346, 5711, 480, 13, 70, "Input",ExpressionUUID->"d7f43e3d-5699-407f-8527-830ce169e5f3",
 CellID->1529848425],
Cell[207829, 5726, 128, 2, 36, "Output",ExpressionUUID->"e02fb74c-ebaa-4cf5-b30b-e1fa01f6e4d0",
 CellID->448778265],
Cell[207960, 5730, 143, 3, 36, "Output",ExpressionUUID->"8c53695e-ff95-47a0-8b85-655c10c84ac4",
 CellID->653731591]
}, Open  ]],
Cell[208118, 5736, 144, 1, 70, "ExampleText",ExpressionUUID->"0673619a-3aee-4999-aa33-6ed72c5a4925",
 CellID->263062639],
Cell[CellGroupData[{
Cell[208287, 5741, 822, 25, 70, "Input",ExpressionUUID->"2d808b17-4861-4d81-91c7-8d5fff2b188b",
 CellID->252225698],
Cell[209112, 5768, 127, 2, 36, "Output",ExpressionUUID->"3b936281-931a-486e-8350-6a5c8ffe05d5",
 CellID->318150053],
Cell[209242, 5772, 9346, 178, 70, "Output",ExpressionUUID->"dd4f577b-8270-4a50-a72a-b82f7b117a77",
 CellID->2061143388]
}, Open  ]],
Cell[218603, 5953, 177, 3, 70, "ExampleText",ExpressionUUID->"c23661cf-f763-42c3-8649-b67a2aa9c68e",
 CellID->783735018],
Cell[CellGroupData[{
Cell[218805, 5960, 302, 7, 70, "Input",ExpressionUUID->"052ba2a4-2e7b-414a-b179-7f30c30ed4cb",
 CellID->553874063],
Cell[219110, 5969, 10578, 198, 70, "Output",ExpressionUUID->"44a2f935-084e-467a-bdfa-d860f9e30ed3",
 CellID->820978259]
}, Open  ]],
Cell[229703, 6170, 159, 2, 70, "ExampleText",ExpressionUUID->"aa8a6277-adae-4603-89b2-94900fe838d9",
 CellID->789353421],
Cell[229865, 6174, 305, 8, 70, "Input",ExpressionUUID->"3ad8bbb2-7449-4fa3-8e36-81d7ebeefac8",
 CellID->210476177],
Cell[230173, 6184, 152, 1, 70, "ExampleText",ExpressionUUID->"048d3223-3378-4e3b-af12-a8536c86ceab",
 CellID->1365905885],
Cell[CellGroupData[{
Cell[230350, 6189, 276, 7, 70, "Input",ExpressionUUID->"d7c3223b-1bc1-453b-93a2-fb300ed2765b",
 CellID->192749570],
Cell[230629, 6198, 116, 1, 70, "EchoTiming",ExpressionUUID->"cdc210c1-2eb1-4f75-9864-7f627d92fca2",
 CellID->1184788612]
}, Open  ]],
Cell[230760, 6202, 147, 1, 70, "ExampleText",ExpressionUUID->"2cc3738e-1c47-4d04-9c9b-839610b5fbc0",
 CellID->988870704],
Cell[CellGroupData[{
Cell[230932, 6207, 276, 7, 70, "Input",ExpressionUUID->"c3c005b5-2118-41e9-b7fc-e08939f34b71",
 CellID->482833766],
Cell[231211, 6216, 116, 1, 70, "EchoTiming",ExpressionUUID->"2baca9d8-0aa1-4ad5-8d90-0081fd5221d7",
 CellID->189680862]
}, Open  ]],
Cell[231342, 6220, 140, 1, 70, "ExampleText",ExpressionUUID->"87d0221a-6f5b-40ea-a0a5-462daee80d39",
 CellID->603496782],
Cell[CellGroupData[{
Cell[231507, 6225, 280, 7, 70, "Input",ExpressionUUID->"120319f5-23cf-4739-b546-85cf295b6976",
 CellID->857850345],
Cell[231790, 6234, 144, 3, 36, "Output",ExpressionUUID->"a5778d56-be3a-4279-8fd2-2f2ed39be2c2",
 CellID->1100515486]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[232176, 6246, 2487, 66, 70, "SeeAlsoSection",ExpressionUUID->"a988cce7-6c80-4d59-a7d4-6146e8c86628"],
Cell[234666, 6314, 2211, 56, 70, "TechNotesSection",ExpressionUUID->"20a39c7a-8afd-4b0c-8908-757a5821f877"],
Cell[236880, 6372, 2223, 55, 70, "MoreAboutSection",ExpressionUUID->"d7373604-74fe-4f11-b43f-e68df586b3d2"],
Cell[239106, 6429, 8163, 213, 70, "RelatedLinksSection",ExpressionUUID->"9dd5b891-1c81-4509-b2b6-ee2883b69b4f"],
Cell[247272, 6644, 78, 0, 70, "FooterCell",ExpressionUUID->"ea960d0b-72a0-4fd9-b868-f22abc6cdbf4"]
}
]
*)

(* End of internal cache information *)

