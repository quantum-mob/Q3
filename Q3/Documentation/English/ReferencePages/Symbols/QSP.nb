(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    279553,       7296]
NotebookOptionsPosition[    247220,       6644]
NotebookOutlinePosition[    250119,       6712]
CellTagsIndexPosition[    250032,       6707]
WindowTitle->QSP
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "d50c3117-6e30-496c-afb9-e9eac26bbe5e"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "e9a8b759-df0b-4559-b070-82e2d1ca51a7"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "b67ea6d5-6a80-4f0e-b2d4-b7b290ccf492"]
         }],ExpressionUUID->"71761c06-970c-417f-aef1-d1f0f39870b9"],
         StripOnInput->False],{
        StyleBox["\"QSPFind\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/QSPFind"], 
         StyleBox["\"QSPConvert\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/QSPConvert"], 
         StyleBox[
          "\"ChebyshevCoefficients\"", "SeeAlsoRelated", StripOnInput -> 
           False] :> Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/ChebyshevCoefficients"], 
         StyleBox[
          "\"ChebyshevSeries\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ChebyshevSeries"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "c2dbd8c8-a8bd-4ec3-a478-85c2a223d361"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "446981f2-fd3c-47d7-ace7-cede386ff453"]
         }],ExpressionUUID->"0f3d68b7-eb50-4bf6-9ee8-06b7e5ce0a11"],
         StripOnInput->False],{
        "\"Quantum Signal Processing\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumSignalProcessing"], 
         "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumSpinSystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "829fcf2b-2b1d-44a5-aa0c-9f68f4abe3ff"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "f8b9806d-25c2-4326-9836-b1843ab8ff20"]
         }],ExpressionUUID->"2c528430-1824-44a2-863c-5bda3c80ff78"],
         StripOnInput->False],{
        "\"Quantum Signal Processing\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumSignalProcessing"], 
         "\"Quantum Linear System Problems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumLinearSystemProblems"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumSpinSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "b2029243-0d04-4548-b779-a024150f287c"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "17e35163-6774-4d41-a36f-7ea5f593bdb5"]
         }],ExpressionUUID->"74f7ae88-4d01-4590-a784-627f766eaf92"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/QSP\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/QSP"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
QSP.html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, 
               Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/QSP") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "228d3774-31cd-4a76-92e8-6aa083abced5"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "2b6fb8ee-a9c9-4a53-a231-00942f557e93"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"8b406c2f-5db5-4a38-b265-232617549ba6"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"94605233-e430-4cc0-9403-e2d893949ac5"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "QSP", "ObjectName",ExpressionUUID->
      "07b0656f-f6f4-4da8-9e8c-5764e2bc60ea"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"f4323041-559b-41eb-8a5a-69040781c554"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "9dc3e295-2bea-4566-bba8-9fc304644206"]
    }],ExpressionUUID->"a4ae7936-971b-4fed-958d-c46451a9d466"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.0\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->LightDarkSwitched[
              RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "0c62970e-bc85-4187-be58-5d4a468318b0"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"7d3af260-a680-48ac-9860-1fe3baaf58b1"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["0", "TR"]], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["1", "TR"]], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["2", "TR"]], ",", 
         StyleBox["\[Ellipsis]", "TR"], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["d", "TI"]]}], "}"}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "59ca89ac-28a5-44d4-bab0-4936a68b3e84"],
     "\[LineSeparator]represents the quantum signal processing of degree ",
     Cell[BoxData[
      StyleBox["d", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "a07eca77-a8c9-4c4e-bbc1-78a5e6765bcd"],
     " with ",
     StyleBox["full",
      FontSlant->"Italic"],
     " phase vector ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["0", "TR"]], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["d", "TI"]]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "5bdea287-f627-4cd4-a2d2-0e816cbcecf9"],
     "."
    }],ExpressionUUID->"a6b2d092-217b-43cf-8bf1-ddce2c21ecd1"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{"{", 
        RowBox[{
         StyleBox[
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], ",", 
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], ",", 
            StyleBox["\[Ellipsis]", "TR"]}], "}"}], "TI"], 
         StyleBox[",", "TI"], ",", 
         StyleBox["parity", "TI"]}], 
        StyleBox["}", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "1ac47d6d-0fa1-4fa5-ad54-fb589e2127ac"],
     "\[LineSeparator]represents the ",
     StyleBox["symmetric",
      FontSlant->"Italic"],
     " quantum signal processing associated with ",
     StyleBox["reduced",
      FontSlant->"Italic"],
     " phase vector ",
     Cell[BoxData[
      RowBox[{
       RowBox[{
        StyleBox["{", "TI"], 
        RowBox[{
         RowBox[{
          StyleBox["{", "TI"], 
          RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], "TI"], 
           StyleBox[",", "TI"], 
           StyleBox[
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], "TI"], 
           StyleBox[",", "TI"], 
           StyleBox["\[Ellipsis]", "TR"]}], 
          StyleBox["}", "TI"]}], 
         StyleBox[",", "TI"], 
         StyleBox["parity", "TI"]}], 
        StyleBox["}", "TI"]}], 
       StyleBox[",", "TI"]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "582bfe10-9767-45c0-ae7b-eaa805ceddd2"],
     " where ",
     Cell[BoxData[
      RowBox[{
       StyleBox["parity", "TI"], "=", 
       RowBox[{"\[PlusMinus]", "1"}]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "87b21261-b305-49f7-a166-e1f17a0fb63c"],
     " for even and odd, respectively."
    }],ExpressionUUID->"f33a3695-43d7-490d-a2d2-bccd07d7a90a"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], ",", 
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], ",", 
            StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
          StyleBox["parity", "TI"]}], "}"}], ",", 
        StyleBox["post", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "9071cd92-2701-4210-9194-b25622f7475b"],
     "\[LineSeparator]is equivalent to ",
     Cell[BoxData[
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          TemplateBox[{
            Cell[
             TextData["Composition"]], "paclet:ref/Composition"},
           "RefLink",
           BaseStyle->{"InlineFormula"}], "[", 
          RowBox[{
           StyleBox["post", "TI"], ",", 
           RowBox[{"QSP", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox[
                StyleBox["\[Phi]", "TR"], 
                StyleBox["0", "TR"]], ",", 
               SubscriptBox[
                StyleBox["\[Phi]", "TR"], 
                StyleBox["1", "TR"]], ",", 
               StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
             StyleBox["parity", "TI"]}]}]}]}], "}"}], "]"}], "]"}]], 
      "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "ac7e607d-2c5d-413f-bfde-fda6024b8fb9"],
     "."
    }],ExpressionUUID->"59b9e7ed-743b-44f9-b743-f587aad04afd"]}
  }]], "Usage",
 CellID->1887563293,ExpressionUUID->"e26c1978-c343-4eba-a0a3-59b7d9dc0a82"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[CurrentValue[
         EvaluationCell[], "CellGroupOpen"] =!= Closed, 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"38ea474a-a7de-42ac-8b25-021868f43127"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"ab9251ee-ccc0-42df-bbba-198e5d476cda"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"423f30c9-9be4-4dc0-8cec-f79d3f7be963"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"56361167-4901-45a1-abff-8ea5c63ae7cd"]], \
"NotesSection",
 ShowGroupOpener->"Thumbnail",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->167656497,ExpressionUUID->"d234b39d-f91c-40a0-94a2-f4a071d54c1a"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   StyleBox["x", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0b8eb748-beba-491c-b3af-32fed5130556"],
 " returns the value ",
 Cell[BoxData[
  StyleBox["y", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2e0ef2d2-759b-4880-9af0-c7fc5b875f75"],
 " at ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "442f99dc-8ef3-4e2b-b79a-f2dec7ddc941"],
 " of the polynomial that ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   StyleBox["spec", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "ec9d46f6-e825-44e9-bef8-2eb09f2fde9f"],
 " represents. ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      StyleBox["x", "TI"], 
      StyleBox["1", "TR"]], ",", 
     SubscriptBox[
      StyleBox["x", "TI"], 
      StyleBox["2", "TR"]], ",", 
     StyleBox["\[Ellipsis]", "TR"]}], "}"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "88b79c07-6c3c-4a44-9294-66a3585a5620"],
 " returns the list ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     StyleBox["y", "TI"], 
     StyleBox["1", "TR"]], ",", 
    SubscriptBox[
     StyleBox["y", "TI"], 
     StyleBox["2", "TR"]], ",", 
    StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0ecf131f-53ac-40b0-9df6-4902ea5a10e3"],
 " of values at ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["1", "TR"]], ",", 
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["2", "TR"]], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "8a53c112-d2c6-4d15-8180-1325c22f0549"],
 "."
}], "Notes",
 CellID->915826333,ExpressionUUID->"ede7cec5-bca9-4625-b3a8-418e60b5c234"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Gradient"]], "paclet:ref/Gradient"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    TemplateBox[{
      Cell[
       TextData["x"]], "paclet:QuantumMob/Q3/ref/x"},
     "RefLink",
     BaseStyle->{"InlineFormula", "TI"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "538e8c49-214f-4c60-8fd7-8e74d52966f3"],
 " returns ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     StyleBox["y", "TI"], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        StyleBox["g", "TI"], 
        StyleBox["1", "TR"]], ",", 
       SubscriptBox[
        StyleBox["g", "TI"], 
        StyleBox["2", "TR"]], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}]}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "c5537150-6405-41ec-a2f6-07d1f8acd731"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["i", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      TemplateBox[{
        Cell[
         TextData["x"]], "paclet:QuantumMob/Q3/ref/x"},
       "RefLink",
       BaseStyle->{"InlineFormula", "TI"}], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TI"], 
      StyleBox["i", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "98bea36a-7758-4981-8342-9792b67e1f91"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Gradient"]], "paclet:ref/Gradient"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "55a7d4e4-eaed-4c0d-8f23-c5e9fb368568"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["y", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["y", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["g", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7c68a550-d77a-4938-8467-f0ec8c2c598e"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["i", "TI"]], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "69ee1e7d-707f-4b00-a862-5b1db2cb8fc2"],
 "."
}], "Notes",
 CellID->1931150725,ExpressionUUID->"f1f68c01-568e-4af1-b95e-0634d5829f1a"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Hessian"]], "paclet:ref/Hessian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    StyleBox["x", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "8b6b3154-9e21-4489-bd75-dc7df88422f3"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    StyleBox["y", "TI"], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["h", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7c0d0c00-02f6-4889-a4f3-ca08a70f109a"],
 " with the ",
 ButtonBox["Hessian matrix",
  BaseStyle->"Link",
  ButtonData->
   "paclet:tutorial/UnconstrainedOptimizationMethodsForLocalMinimization"],
 " ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["h", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      StyleBox["x", "TI"], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["i", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "a8e18b75-226f-4c8f-8bb9-36d96204e93e"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Hessian"]], "paclet:ref/Hessian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "3050b886-bfa2-4d63-820f-af0da174d39b"],
 " returns ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        StyleBox["y", "TI"], 
        StyleBox["1", "TR"]], ",", 
       SubscriptBox[
        StyleBox["y", "TI"], 
        StyleBox["2", "TR"]], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       StyleBox["\[Ellipsis]", "TR"], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\[Ellipsis]", "TR"], ",", 
         RowBox[{"{", 
          RowBox[{
           StyleBox["\[Ellipsis]", "TR"], ",", 
           SubscriptBox[
            StyleBox["h", "TI"], 
            StyleBox["ijk", "TI"]], ",", 
           StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
         StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}]}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "63e4b8e4-7aa8-4b62-864f-e97940b739a1"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["h", "TI"], 
    StyleBox["ijk", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["i", "TI"]], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["k", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "3371c093-b5b2-4251-8324-c495e377e32f"],
 ". "
}], "Notes",
 CellID->765642393,ExpressionUUID->"926e43cc-e8e0-4d49-8d82-9bd1a45ff8f7"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Jacobian"]], "paclet:ref/Jacobian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{"QSP", "[", 
    StyleBox["spec", "TI"], "]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "13f6552e-1adf-4046-b0c3-3c7dcdc788c7"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["0", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["g", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "be69dacc-8f25-4cdc-8730-35d48a4715c9"],
 ", where ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["0", "TR"]], ",", 
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["1", "TR"]], ",", 
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["2", "TR"]], ",", 
    StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "6a3e2547-6374-4254-bd49-14f5e6a11c1a"],
 " is the Chebyshev expansion coefficients of ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   StyleBox["x", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "136b6e3b-71a7-456d-b02d-e63ed95f8e17"],
 " and ",
 Cell[BoxData[
  StyleBox["g", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "56bc00e2-64fe-48c7-b7ec-c4a735b0d921"],
 " is the Jacobian matrix, ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     SubscriptBox[
      StyleBox["c", "TI"], 
      StyleBox["i", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "aff046d4-65f4-42da-82ac-b4b99672ee4f"],
 "."
}], "Notes",
 CellID->328467597,ExpressionUUID->"5323e73d-1769-4bd0-aee2-13cf647bd219"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Matrix"]], "paclet:QuantumMob/Q3/ref/Matrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", " ", 
    StyleBox["x", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "88221919-dcd7-4b4b-9896-75c1dbaf34c4"],
 " returns the QSP unitary matrix at ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f6c3f474-157a-4f72-865e-01b4a8eb8b60"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Matrix"]], "paclet:QuantumMob/Q3/ref/Matrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e7046194-9009-4634-811b-a8059ccfa664"],
 " returns the list of matrices at ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["1", "TR"]], ",", 
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["2", "TR"]], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7ddbb204-8019-4ac9-bacc-6feb81fcba1e"],
 "."
}], "Notes",
 CellID->740487261,ExpressionUUID->"082579cf-be07-4bca-b98e-a2599177e806"],

Cell[TextData[{
 "The quantum signal processing (QSP) of degree ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "33a8b90e-affb-4373-984e-02acf6cc14df"],
 " with phases ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{":", 
     OverscriptBox["\[Phi]", "\[RightVector]"]}]}], TraditionalForm]],
  ExpressionUUID->"e10cfe26-9d77-4abc-92cc-910dd676523e"],
 " is a parameterized representation of a polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "80e76a18-811f-48af-87a1-255a65ac9aa7"],
 " of degree ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "7aeb89b3-18f8-4a42-a186-8d07abee9664"],
 " and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"d", " ", "mod", " ", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"34e9d0aa-d017-4833-b30f-e5218faecdb5"],
 ", through the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Times]", "2"}], TraditionalForm]],ExpressionUUID->
  "f75cb50d-c599-46b7-b0da-88f33badb323"],
 " unitary matrix\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], ":=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
        SubscriptBox["\[Phi]", "0"], "Z"}]], 
      RowBox[{
       UnderoverscriptBox["\[CapitalPi]", 
        RowBox[{"k", "=", "1"}], "d"], "[", 
       RowBox[{
        RowBox[{"W", "(", "x", ")"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          SubscriptBox["\[Phi]", "k"], "Z"}]]}], "]"}]}], "=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"P", "(", "x", ")"}], 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          RowBox[{"Q", "(", "x", ")"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["x", "2"]}]]}]},
        {
         RowBox[{"\[VeryThinSpace]", 
          RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
           RowBox[{
            SuperscriptBox["Q", "*"], "(", "x", ")"}], 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["x", "2"]}]]}]}], 
         RowBox[{
          SuperscriptBox["P", "*"], "(", "x", ")"}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "b4d826cf-c79e-4876-a64b-d85047ee96fa"],
 " ,\nwhere ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "34bc2898-d9d3-405e-9e29-52c629bebfef"],
 " is the Pauli-",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "6fe91f99-d98f-4293-9ed2-7930287a1df5"],
 " matrix,\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        RowBox[{"-", "1"}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "55a0f530-f011-4c9c-a679-702a07c2e83d"],
 " ,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "89dd7248-144d-47bd-80c5-4b00abd5f643"],
 " is a rotation in the Bloch space around the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "87d2ab97-1f11-46d5-94d9-f7b0449ebb6b"],
 "-axis by angle ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"arccos", "(", "x", ")"}]}], TraditionalForm]],ExpressionUUID->
  "d876b067-1692-4084-912c-e9985c176b3f"],
 ",\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"W", "(", "x", ")"}], ":=", 
    RowBox[{"(", GridBox[{
       {"x", 
        RowBox[{"\[ImaginaryI]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}]]}]},
       {
        RowBox[{"\[ImaginaryI]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}]]}], "x"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "25bd86dd-42d5-4b0a-a1e4-e5d278b4af59"],
 " ,\nand ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "b1142f7c-1212-4b7f-a25d-26e39b9e5ee5"],
 " is a polynomial of degree ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", "-", "1"}], TraditionalForm]],ExpressionUUID->
  "11bbea07-ab86-4813-98fb-8a2b8bab4641"],
 " and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"d", "-", 
       RowBox[{"1", " ", "mod", " ", "2"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"90dd20ff-8c0b-47d1-b8a3-878476473cc4"],
 " satisfying the unitarity constraint \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{"P", "(", "x", ")"}], "\[RightBracketingBar]"}], "2"], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"\[LeftBracketingBar]", 
        RowBox[{"Q", "(", "x", ")"}], "\[RightBracketingBar]"}], "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "2"]}], ")"}]}]}], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"e9051952-eadc-460e-9f3d-7fd5f2627ccc"],
 "."
}], "Notes",
 CellID->958672882,ExpressionUUID->"a6437913-2906-4ac6-8c30-d7dbcdd579a8"],

Cell[TextData[{
 "Quantum signal processing is ",
 StyleBox["symmetric",
  FontSlant->"Italic"],
 " if the phase vector is symmetric ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "d"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "1"], ",", 
      SubscriptBox["\[Phi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"2205fc97-730b-4292-82fd-f75a537340c6"],
 " under list reversal. A symmetric quantum signal processing has its \
characteristic unitary matrix symmetric, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"], "T"], "(", "x", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"ef47596e-eee8-482f-815a-dfcd44e8b81e"],
 ", and polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "3d9f7b20-3c02-4047-a080-5e3761a9a35d"],
 " is real. See Theorem 2 in Dong et al. (2021)."
}], "Notes",
 CellID->1795688728,ExpressionUUID->"27fb6a77-8e2d-47c9-aca6-7317c90e09cc"],

Cell[TextData[{
 "A quantum signal processing is said to be ",
 StyleBox["symmetric",
  FontSlant->"Italic"],
 " if the phase vector is symmetric; that is, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "d"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "1"], ",", 
      SubscriptBox["\[Phi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"1e080363-a7b0-4f6d-a7d9-b7097466446b"],
 ", which leaves only ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "d"], ":=", 
    RowBox[{"\[LeftCeiling]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "+", "1"}], ")"}], "/", "2"}], "\[RightCeiling]"}]}], 
   TraditionalForm]],ExpressionUUID->"241dec13-1f32-4483-9c56-96d6e55e91fd"],
 " independent phase variables. A symmetric quantum signal processing has its \
characteristic unitary matrix symmetric, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"], "T"], "(", "x", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"5ed3dedf-f6ac-413a-933b-0620d9d146d0"],
 ", and the polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "91f35782-af2e-4152-ae7c-11a2f41ec700"],
 " is real ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["(Dong, Meng, Whaley and Lin, 2021: Theorem 2)"]], 
    "https://doi.org/10.1103/PhysRevA.103.042419"},
   "WebLink",
   BaseStyle->{"Notes"}]],ExpressionUUID->
  "76927529-5d10-43e4-93e2-efcaa51eb120"],
 "."
}], "Notes",
 CellID->1190343635,ExpressionUUID->"8ab547af-7127-45f5-b231-b8090c6da5ce"],

Cell[TextData[{
 "Given a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " set ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[CurlyPhi]", "0"], ",", 
     SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
     SubscriptBox["\[CurlyPhi]", 
      RowBox[{
       SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], TraditionalForm]],
  ExpressionUUID->"af48e94d-2ab9-4431-8ea7-142f2162b7ac"],
 " of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "d"], TraditionalForm]],ExpressionUUID->
  "5a74dc61-bb59-49c1-b5d5-ef6d3e3a8bf4"],
 " independent phase variables and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "=", 
    RowBox[{"\[PlusMinus]", "1"}]}], TraditionalForm]],ExpressionUUID->
  "b4e4dca8-bc35-43e2-9ed1-1549d502254a"],
 " for a symmetric quantum signal processing, one can recover the ",
 StyleBox["full vector",
  FontSlant->"Italic"],
 " of phase variables as follows:\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[CurlyPhi]", "0"], ",", 
        SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{
          SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
      RowBox[{"+", "1"}]}], "}"}], "\[RightTeeArrow]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[CurlyPhi]", "0"], ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
      RowBox[{"2", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{
         SubscriptBox["n", "d"], "-", "1"}]]}], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", 
      SubscriptBox["\[CurlyPhi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"328933e5-9772-4f17-8f67-b17e9de2e5be"],
 " (notice the factor of 2 for technical convenience),\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[CurlyPhi]", "0"], ",", 
        SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{
          SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], "\[RightTeeArrow]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[CurlyPhi]", "0"], ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{
        SubscriptBox["n", "d"], "-", "1"}]], ",", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{
        SubscriptBox["n", "d"], "-", "1"}]], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", 
      SubscriptBox["\[CurlyPhi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"76a36b78-60cf-4550-903f-fa932efe9b62"],
 ".\nThe pair ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[CurlyPhi]", "0"], ",", 
       SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{
         SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
     RowBox[{"p", "=", 
      RowBox[{"\[PlusMinus]", "1"}]}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"e75cfdbd-0f45-4eaf-8ab5-5dd8c2b78130"],
 " is called the ",
 StyleBox["reduced phase vector",
  FontSlant->"Italic"],
 " to be distinguished from the ",
 StyleBox["full phase vector",
  FontSlant->"Italic"],
 "."
}], "Notes",
 CellID->1535193593,ExpressionUUID->"74840076-b96c-4f67-9a8a-8264c6540b0d"],

Cell[TextData[{
 "The correspondence between the reduced and full phase vector is closely \
related to that between the ",
 ButtonBox["reduced and full Chebyshev coefficients",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/ChebyshevCoefficients"],
 " list."
}], "Notes",
 CellID->227248759,ExpressionUUID->"6c60619d-a2c2-4fc7-8b50-5a4b7dfc16f0"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"bfaa0add-5318-467f-9321-edcddb17d9eb"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"0a005b31-1f77-4daa-85cf-b251d2238085"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(11)", "ExampleCount",ExpressionUUID->
  "d64bf9e9-2117-4175-a4e5-5300f45da48e"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->304200215,ExpressionUUID->"19c98329-8df2-4388-8e01-65a04f6a211b"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->556413652,ExpressionUUID->"660ba185-6234-4ef5-8cdd-f8ea68742905"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"638fd63c-a68d-4f94-8db1-5a511313bbab"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"f276cc0a-173a-409d-94f7-d9aee1c3869d"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "ccf33145-3acf-46e0-bc04-96f232334ea9"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1681933645,ExpressionUUID->"baf9c22e-9929-4331-a041-96d1b3464f1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->672243474,ExpressionUUID->"b4461f29-95f9-47ba-b033-8a7509af3d09"],

Cell["Set the phase vector and parity:", "ExampleText",
 CellID->966966361,ExpressionUUID->"936f56e8-ceba-4267-911c-fa7197abc30d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->484600651,ExpressionUUID->"e33b0565-6a9b-4998-aa8e-41a254f81eff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "$n"}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1425151933,ExpressionUUID->"221fc653-d973-4fd9-bdb3-4547d2818059"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->931228551,ExpressionUUID->"27bff7bd-d1de-489b-a635-2bc87187612e"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->297437321,ExpressionUUID->"59f7daa8-af82-42ec-a246-f19ef079bfa7"]
}, Open  ]],

Cell["Construct a QSP:", "ExampleText",
 CellID->1540884431,ExpressionUUID->"1aba0d31-b304-4343-acd8-3a6fe02cf1d6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$phi", ",", "$parity"}], "}"}], ",", "Re"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1098093014,ExpressionUUID->"7ece8eac-4606-4946-bc50-52a4630c2409"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Re", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, 1}, Re],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1834607478,ExpressionUUID->"1f0a9444-42e3-4523-8766-ba8cb8e31087"]
}, Open  ]],

Cell["Pick a position:", "ExampleText",
 CellID->569269380,ExpressionUUID->"123bb641-9dfd-4353-9b94-58d7222e7d03"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1920729624,ExpressionUUID->"18e8ea64-436a-45a3-986f-e90730f1090f"],

Cell[BoxData["0.7222657925379279`"], "Output",
 CellLabel->"Out[5]=",
 CellID->677679120,ExpressionUUID->"02960a66-4e8b-43d8-aada-30d2128a906b"]
}, Open  ]],

Cell["Calculate the QSP polynomial at the position:", "ExampleText",
 CellID->1970697472,ExpressionUUID->"aa929278-2ee8-4d92-8d9a-1692674da08a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"y", "=", 
  RowBox[{"qsp", "[", "x", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1579083477,ExpressionUUID->"81a21891-b3da-46a6-b526-d11bca415a32"],

Cell[BoxData[
 RowBox[{"-", "0.24370437270790196`"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1647189799,ExpressionUUID->"bb28500a-616e-49dc-8bbe-3162376fa6cd"]
}, Open  ]],

Cell["\<\
Calculate the gradient with respect to the phases at the position:\
\>", "ExampleText",
 CellID->1682239748,ExpressionUUID->"5b862874-d43f-4aef-bf12-08b257e0f695"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"f", ",", "df"}], "}"}], "=", 
  RowBox[{"Gradient", "[", 
   RowBox[{"qsp", ",", "x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->487601425,ExpressionUUID->"002f4b76-a3d1-467b-8b2d-baf571f70918"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.24370437270790196`"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.857436120097687`", ",", 
     RowBox[{"-", "0.4001420997668619`"}], ",", "1.8237858602958372`"}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1107258316,ExpressionUUID->"d163e2da-f886-438b-8f7c-85de5cb414cc"]
}, Open  ]],

Cell["\<\
Calculate the Jacobian matrix between the Chebyshev coefficients and the \
phases:\
\>", "ExampleText",
 CellID->1831286845,ExpressionUUID->"d73d2fe4-0316-4e7a-b001-0c6d0dad36ed"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cff", ",", "jac"}], "}"}], "=", 
   RowBox[{"Jacobian", "[", "qsp", "]"}]}], 
  ";"}], "\[IndentingNewLine]", "cff", "\[IndentingNewLine]", 
 RowBox[{"jac", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1520012391,ExpressionUUID->"e5e7d2f5-29eb-4c22-9a86-ce39a9ae8050"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.24101003885481828`"}], ",", 
   RowBox[{"-", "0.3673208690650344`"}], ",", 
   RowBox[{"-", "0.013273647029757533`"}]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1744715757,ExpressionUUID->"acca76bf-55e4-4e6e-ab0d-6bec2132dda6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.8218192361642762`", 
      RowBox[{"-", "0.343954026056741`"}], "1.8049624494329581`"},
     {
      RowBox[{"-", "0.21025955307636573`"}], "1.7769219637646367`", 
      RowBox[{"-", "0.21025955307636565`"}]},
     {
      RowBox[{"-", "0.044897272399639726`"}], "0.1336944729803754`", 
      RowBox[{"-", "0.02804048566832132`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->1696011761,ExpressionUUID->"bc0a097f-a8f7-4921-b59c-fc5f7877f01f"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "be125316-7340-4011-a5bd-0921bde3c74e"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"920b685b-18bc-4bbd-95d6-cea6f4115efc"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(9)", "ExampleCount",ExpressionUUID->
  "06a22967-8c74-4e6a-96c9-9ab1cb4a9626"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1703330544,ExpressionUUID->"dc2d76bd-0b5c-4197-9f36-f9a64a253eb1"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "f8ad08e9-7a40-4720-8e5d-10638c3eb4e3"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"4329ac36-8ede-46d2-b300-34b2564d0fda"],
 "Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "1244d682-56f3-4a30-8af0-756b46c96e6d"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1625224184,ExpressionUUID->"1c44a9ed-7190-453b-9c8e-567b0e29021f"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->866063270,ExpressionUUID->"2065e5d4-1254-41dc-9f7c-b1b15ab4c43c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1774012929,ExpressionUUID->"113b0529-7d86-4907-a915-bcaa1a92aa70"],

Cell["Construct a QSP:", "ExampleText",
 CellID->1210812697,ExpressionUUID->"2305ce9c-bf8b-4c4b-be21-62dae35862bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"-", "1"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->93372207,ExpressionUUID->"f46b1cfa-751a-4090-b2b8-d2233b8d6c00"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1319220496,ExpressionUUID->"4723ad65-9ade-483d-b08b-c14ee4a8d8ee"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1517704644,ExpressionUUID->"68efc984-7ea4-4d8d-bb0c-62ba60649de9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1264054559,ExpressionUUID->"a9de1bd9-214c-4cc1-850f-f19ce2e00071"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][0]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][1]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][2]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{
     $CellContext`\[Phi][0], 
     $CellContext`\[Phi][1], 
     $CellContext`\[Phi][2]}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->251192642,ExpressionUUID->"3ae5756f-6b83-44f4-a99f-6958dc338160"]
}, Open  ]],

Cell["Get the QSP unitary matrix:", "ExampleText",
 CellID->645597649,ExpressionUUID->"c2704553-75f4-44a3-97ad-ddf11bd17078"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", 
     RowBox[{"$qsp", ",", "x"}], "]"}], "//", "Simplify"}]}], ";"}]}], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1538010568,ExpressionUUID->"7379a66e-9de3-40ce-a353-76233b622999"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "mat", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->2098320073,ExpressionUUID->"c3397b40-e4d7-47a6-9ec8-ded1b0c79bd0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2"}], "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1989367739,ExpressionUUID->"b2d1351c-69d8-4ee4-b8a7-795ca32ef6d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1894606122,ExpressionUUID->"d8a8d895-f001-4da9-a2c9-78010e3fc88b"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][0]]}], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][0]]}], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"2", "-", 
    RowBox[{"6", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "4"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["x", "4"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["x", "4"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][2]]}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "4"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][2]]}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "4"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "+", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1130689230,ExpressionUUID->"e56854f3-cc26-42a2-be75-66a2064a3079"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "f6434b60-394a-4a43-ba97-8ac063c42040"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->706601561,ExpressionUUID->"d2d884e3-c66d-4961-bac8-a6db2da2c9fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "300"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->349864653,ExpressionUUID->"c563f716-6648-4dc3-8b39-f5ab4c6ea889"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1138088487,ExpressionUUID->"4fa12c22-e554-498a-8088-63fca59e1087"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2147261437,ExpressionUUID->"43bdceb0-fc6e-4af1-ad61-754c761279d1"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->411096307,ExpressionUUID->"aed74f4a-a8dc-4bd7-8a32-ca81e0f8ce5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->745752491,ExpressionUUID->"0b4a623c-0501-4622-9720-56b17ef21402"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["598", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["598", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}], ",", 
                    "1.3526643903415392`", ",", 
                    RowBox[{"-", "1.4612784342395748`"}], ",", 
                    "1.2380248457091423`", ",", 
                    RowBox[{"-", "0.4898389003561131`"}], ",", 
                    "0.14740162462925227`", ",", "0.09519214138002281`", ",", 
                    
                    RowBox[{"-", "0.054377159963480484`"}], ",", 
                    "1.1366917987048297`", ",", 
                    RowBox[{"-", "0.9313131184913914`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwNlHk4FIgfhyORNqQiORapZCv6OVKsvjocKYpkQ0vrWMeGhGVRSM6IlNpI
kSuhZnNkXd9xJvc5xs0MZtxzmMOm/Prn8/f7PO/zfpSdfKxcBTZt2nTk+9Qf
+mSTRmKA2d2EP2Q2OCCtfslLUHAYaQQfz8gcDkQ+IN11/Y2HuRc3VNidbEjJ
vnomynYCewOf3BYfrwdX/R0/RjpUQEqy00erwULU22tZQ9VgQZqW6WHLjiV8
uD1CbUN8CUW1C5iRmt04fVVW+LXkDNwbjo+bL6fhQsslWmB3N0zkmug8qpwH
a8k3qzYWPXCbuUaXUeLj76wgCuECH+65udx2slvGyVZ9ueqUWXQhCBACpJrx
nX1wYHElA27OG88RK9lwUs7XZMiCCUo7CqWnmhfB91vKDxI7+aB7Rz61VJWD
vF/1QkYsRlG8devEcAcJAxbpcdJHV2Et+3XAC8lVbM162/5pnQq+qaEJURFv
IG7MRWfFbwgPOVXaFzcOg7tfzsSZvFVUzXdPl0+ZgQzNp8syylR4O0b4WGfH
xMyvRYzdQSwI9kj13yVUD/xLStV/ivRh8JecKq1tFDyo786ZVGRDd7Rwk0E1
E1RvfYs/R1/FP4/pN6rqTuH+D4kFn0rmcC28N3s6fQV73IOuGAQ/Q0pnQkd6
5RRsa4nmyV1phog2mbsZEyTICxtb6/t3GqUK5msX4thg+OvxVupOFpha54zt
ezGLDME0ge3ZLNTMPufw5e4/UKR1YO8KIxoNU9eOnFX47lXO42EpcREXPC+0
7w1vxNiW221C5CXME6+2okTP4KzUG7/E+hkQG5NV6IkeRJnowFpv4RV4/8zH
4cKzRtxHdvQ6pTCJhYTroiV+PHxUlq7DUuZhRXVhuxtpAXKH0w7ZhnIRtdxP
GSWxUI1AvKsRvIix9n9Vu40uY/G15Nequmw0udPuaMNZwpZ9ynUsKRbej9oS
b2uwCkfJzob+Sav47Hhj3ckJBqZYBJ6PTiWjDQgudE3wQaJQTb/rHgve+sfB
fTU+5uWPxG9NHIX5YjFx+4RJ5MsWcALUl7Eb5xIMfp7GSCvjEVfneXAoLup7
Wc8AXu5c7JuPC6h02PDy89xmeP2UWVLl1Y3esQ4FFLN23CounS2XwMSo6UsL
NN9x8CiNrbEw7waJ8J+NK80ZGPJVPDqf3of/aHm0JNhPgfADhbhX5kxcP3et
Yb55Be9n8dts3qejypaygg7+PP5wvspVWZ0GRx0c9jnDLAZ/Ipoqj3GhRKFZ
sIHBQqXPUuenVKZQaETLnrI0AuSVL/mE09NoSCvl0BXGgbM40NO80IMhMFqc
1jmDdcodl+tMZ0B9bctDXaU1SPzYH2UdNQXeGe03Xx5goKG3XsVOi2LQT9f7
NyOEhCZ/h4xn1M6D6LrZ5oblKSyQat7e3cQAQ/7vAplfeODp5fn5zulRbCde
KqFe4UAa81EffWwayp2y3vkVcDCmrK/Ozb4N371SPLNGmIGyjMS9UpYd0OVA
JtxPaQPPm7tyPJR6QFhSbXm3ZDXk6E7d2PP6MbZed3F66tILqbbuDvSaSbBL
VBUuOtOLrayBRHwygMK39IXvLU+jUN9TgzDbFUg8EXTW/Or3H+ouOzbyfgAu
2jA7NbRpQFQ0Esu3mgYxdXK96CYOOlbwlzvMVvGgpmnm+uZerHmVnHC4cBpf
dv9G7yqYROclwv+Gg+fAMLJk9EnNEjTW3q+OTZ3BL/GfB2fXiCAhWKSlu5MC
VNmTcRpPuGgpkvnK6xgbRZPI1rblXMzvECU4JJbhYg9/h3w0E/U8fmS7DFFA
5VsM+WsOGw8UCb+92D2NQ8Jy6dM+JExWDCdGxDdAjmd53ovwKXgs4J/r1jCP
ZEN/y5Kwj5Blm3ZeS4EPMscVp+V7h2DX9twsr6AlFOI854c9aIXxEMmBk7fb
0CdPJVixgoMBHcG0AA0ScN1jF9+psFHBKNwr98wwWuuqzVvLNGGHgJeK0d46
CKvVoSuqsWGQrMrvFuKiH56PHPRig4cE5TFXsx92NB3vKOfOQqGdgXBeDBvC
Huvd+yWqDYqeKZeu7mZBNKlKWr10EkX/8W/wMVlEindtRgExD8uMjhhn5XwA
AkVB202RAx67ZbozD/GwNuXEwPsaKoQn3rTcKJwDl4KIVwFjC2hxeVuGOoGD
lD+S/wJbPpoohZ4KWB+B+VCjqiaRRtgos7bxfcAGMn299eTVGVya1SQyBukg
oWbRLD5Rj+knRq3Tmum45k3Z5Tg8C0LPTcwzfqeiyHwtX4nMhtjFHyqSA4bB
9eH+Bp8RDtwM83ouwJnDkOIch3ajHtwWEdbyU3Yd/H3f3MXvBhf2+3oqv/Nn
wPDpTVEXBhlYNpGhU2oyhETDxfYPMSUglslRqHQpg3qJKu9yDSJYX9TWcvPm
4eYg4/xNbe04c6q4LkuVCybJKXnlzDnc+skiW3CcBKOeic13nJlgPjGpdsWL
ga9rBF5eE+ejjbimTVt9HdwT+EVe1IoDZn7UwPadTOh0awkINfgM8lpXCZ/7
m1COmK32oY+JVTdUJtqvDyNb4KiLO5kGonfVZM0ONGKJ7793fiasYlx2K3cl
igX7n14uZngzkHc7Kix/sh+r1doc5zZmwerdQlHl4TfoYH99pwV1GOrPOh0p
V29CMXTmUmiTmPflva72gQ7wRhObKmSg0ygmCfXO4ektpqRdjr2gQHTl7Tam
AjVyz7yu7BoenQ3iMU70o7jjV20F9VXc520M4bRW6JX671yK5hz8tBBACvu2
CO3N5x4Uha7iqHickO4VOuT220UOeTHA8tLBW64tLMht3dx3aywYhLKCyb4X
eNjUpalu10/53r/3GLWLibrBZWLp1FXUkKES9p1kgbzsRrylyAraVoXpeMaM
g3TKVnWpdRr+8TKiU21LGbz48ED3WRIHK46TktpmF1Dal8ntd1pAw3LXXoU5
Jugw8mKNf6uDQtP0ymQRPlA+h3CmaXQcWt6yZ5THh13v3WI8aA9RrF2Pb2Qx
DrGcv14GakzAcx29iOA/6Thu5hwbJ14Md0wlo/acZkG8mF4T7xMDD1kPhNqI
LEPd+aSPxzpH4L8iO2/LJSbYnNCOubHMBaGu6JnL3/kPjoWYX5Plgk/bI8tM
Bx4mBFBTXpD64f+rcCbi
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->840739350,ExpressionUUID->"c992f745-5f54-4239-ad51-def4bd8e0168"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1123936882,ExpressionUUID->"8223e86d-8288-485b-aa98-0acd1486ef26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{"mat", "=", 
    RowBox[{
     RowBox[{"Matrix", "[", 
      RowBox[{"qsp", ",", "xx"}], "]"}], "//", "Chop"}]}], "]"}], 
  ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1756899605,ExpressionUUID->"70ba3b5d-d568-4fe3-90d4-42c2dd2017b0"],

Cell[BoxData["3.233398`"], "EchoTiming",
 CellID->2011341837,ExpressionUUID->"dec68706-9f9f-4548-a543-4a416a4f73a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{";;", 
     RowBox[{"UpTo", "[", "5", "]"}]}], "]"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1891135613,ExpressionUUID->"344b72b9-6863-4cd6-aceb-e7cbf06282a0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.41304947785649526`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.9009462388461923`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13298873467846836`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13298873467846836`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.41304947785649526`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9009462388461923`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.40210871608186455`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.8289773173643352`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.38872250738340675`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.38872250738340675`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.40210871608186455`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.8289773173643352`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.37940300195479393`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6914742399323504`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6147493290908808`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6147493290908808`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.37940300195479393`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6914742399323504`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.34346525252963295`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5006799352962871`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7945761276910034`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7945761276910034`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.34346525252963295`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5006799352962871`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.292524460382402`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.27344836431088027`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9163271425280948`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9163271425280948`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.292524460382402`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.27344836431088027`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1082167032,ExpressionUUID->"f58ca356-2300-4faa-ae1e-b64fc0247a90"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "17eb03bb-6e72-4b7d-8c4d-44bd174402ee"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"79a1e3dc-18a6-4a59-9685-572dcb5f63fe"],
 "Gradient",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "24c2ea45-c175-470a-a26a-180d66eb4c7b"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->976509307,ExpressionUUID->"5166e35b-1a06-449b-b944-22134de7fe8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->404620761,ExpressionUUID->"a49e382f-d0cf-4fee-82af-de381fda14db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1527903725,ExpressionUUID->"7ff84a29-ad0e-410d-9a2f-d89ea7fd2b1c"],

Cell["Construct a QSP:", "ExampleText",
 CellID->645812421,ExpressionUUID->"7dd6badf-9ee0-4170-b17e-3d285f5be003"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$parity", "=", 
   RowBox[{"-", "1"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2015938896,ExpressionUUID->"a47c7ae7-f9c8-4f91-b39c-c522bc99f6ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->942300381,ExpressionUUID->"7708c37f-d8a6-44d2-a481-b1f8846f2333"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->883939583,ExpressionUUID->"f47f3fb5-605d-4f05-bf21-68af472b392c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1698090489,ExpressionUUID->"89a64b34-2fa8-433f-b546-a3033d8f2fb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "*", "Pi"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1288517488,ExpressionUUID->"ab7aecf2-18d9-4615-b226-62629ca6104c"],

Cell[BoxData[
 RowBox[{"-", "0.9763034131218359`"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1896663640,ExpressionUUID->"72566c36-f6b0-4056-97fa-bbb576e390c9"]
}, Open  ]],

Cell["Calculate the gradient with respect to the phases:", "ExampleText",
 CellID->1991143895,ExpressionUUID->"f67f45a4-882d-44fb-b0b4-431d2a010272"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "grd"}], "}"}], "=", 
  RowBox[{"Gradient", "[", 
   RowBox[{"$qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->763019732,ExpressionUUID->"a3478703-f698-43d2-a52a-fed07e1745ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5353834564485714`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.7698389667404558`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.5396779334809116`"}], "+", 
      RowBox[{"1.0707669128971429`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.1427205960590454`"}], "+", 
      RowBox[{"1.1199214833381976`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.5585409731606994`"}], "+", 
      RowBox[{"1.1631045338923487`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->2126025059,ExpressionUUID->"e2ea5f51-e07b-41f7-ac66-242e13d19593"]
}, Open  ]],

Cell["\<\
For comparison, calculate the gradient by taking the partial derivative of \
the polynomial:\
\>", "ExampleText",
 CellID->2001042392,ExpressionUUID->"0fdff8a5-3a19-4784-9a28-20091f8d2a2b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"tmp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"var", ",", "$parity"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"tmp", ",", "$x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mint", "=", 
  RowBox[{"ReplaceAll", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"mat", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
      "var"}], ",", 
    RowBox[{"Thread", "[", 
     RowBox[{"var", "->", "$phi"}], "]"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1840117499,ExpressionUUID->"f7a2a4f1-ba35-4ef4-a1a7-caf92727a41a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->122764180,ExpressionUUID->"12244a54-29be-4bf0-8e93-0e8e022da6c9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][0]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][1]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][2]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{
     $CellContext`\[Phi][0], 
     $CellContext`\[Phi][1], 
     $CellContext`\[Phi][2]}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[7]=",
 CellID->1713272140,ExpressionUUID->"437ed43f-2a11-4092-9632-176d446c77fa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1.5396779334809114`"}], "+", 
    RowBox[{"1.070766912897143`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.1427205960590452`"}], "+", 
    RowBox[{"1.1199214833381976`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.5585409731606994`"}], "+", 
    RowBox[{"1.163104533892349`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",\

 CellLabel->"Out[7]=",
 CellID->1504118004,ExpressionUUID->"1563938e-30e8-490d-8c7f-ece21a55f4ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"grd", "-", "mint"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1440956291,ExpressionUUID->"41dae87e-2a82-4d5d-82d4-02522dd79ffc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1681284391,ExpressionUUID->"e74b54c0-d8b8-467d-9cce-89611f91b13e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "fabaa797-5701-47d6-bb3a-c6cafd22757a"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1767104397,ExpressionUUID->"b3905385-b29b-4c9c-ad67-ab4e8dc11990"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "75"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->24762369,ExpressionUUID->"44a64c45-910b-486d-b62f-94e04629dab0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1716791912,ExpressionUUID->"8b18bc9c-bb1d-4514-9e6c-1fa69c3bfaf1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->531383892,ExpressionUUID->"e2657e06-db35-4ba4-8b32-7b39e40e7994"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->756932311,ExpressionUUID->"6dccda8a-b319-4f5b-9f21-9ffed438b1d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1736427641,ExpressionUUID->"fdf3b42c-8b0b-4e2f-a204-5967d9707e60"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}], ",", 
                    "1.3526643903415392`", ",", 
                    RowBox[{"-", "1.4612784342395748`"}], ",", 
                    "1.2380248457091423`", ",", 
                    RowBox[{"-", "0.4898389003561131`"}], ",", 
                    "0.14740162462925227`", ",", "0.09519214138002281`", ",", 
                    
                    RowBox[{"-", "0.054377159963480484`"}], ",", 
                    "1.1366917987048297`", ",", 
                    RowBox[{"-", "0.9313131184913914`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwBZQKa/SFib1JlAQAAAEsAAADCKMdWmtbwP0p+jGsY//U/Fi5PbQIC2r/n
sG9qg6T1P4OL1n5lYfe/pUz/I/PO8z+So1VChVnfv9J3lHIO3sI/ZTsQHoNe
uD+SkGK3UtervzoZUb3jL/I/mjNIK1HN7b+ODIEp/w7tvwk0qfGDMtC/5FUa
BqIR5T+C2oqJ6rbnv+vIT+d30NA/36VHNZG66j9UEaj0Vk7RP3Lx+egYIPi/
ZvJ44rBL+D+CZ2RyYlruv+DKOxu8kua/ZLABsHUVxr+uW3p3rbrwP2zqRunA
uvM/ORtxR9lO8T8gEKsW4cbsP3H+kgsPEvg/N30clbQn9b/3XTp7207cvw7K
CN/azda/dezoiRYt9D/5o6J1nBH0v8qhqszH/OM/cZV8jIWBqD+J3WQ173PZ
vyhiulutxNo/aHOk30Km9L8np2ibHJLlP50ylu4YIeM/qt2wt8Fa8b+g/azw
FHjyP3pplXQTBMI/+E8gvHYH0796+6S7MwrivyY7aPXgH/M/0IYGxT288T8n
cP6KROj0v3YwO8QnN+G/JLKNqcez6b/5gNKj5Jvvv9FoeFM9epe/4s6MzZu6
4T8KyIb3G1PGP4HLGH6d39Y/pn/d+dO55L8Vqeq+64nzP0BdNsrjEvI/SFSk
3SKc5r/wApoBDKPyvzKjRF77frE/rDMlGe/whr9AlfksQx33v6UbaY60wOy/
62pLzBmAxL+IyHLLBNjtv6YOvFLihuW/5hWoc43C5T8N3Rod0YbXvxiGd75u
Bu8/r5dvXkuXxL8i2F9tPh3gv6uwXAmzc/e/kbWbNfIh97+B20y2
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->68226149,ExpressionUUID->"84ab860a-31f8-4982-a8e9-b55943a467b0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->360339012,ExpressionUUID->"2ac211ea-7a7b-4250-ad2a-a32e0b5be3c0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "grd"}], "}"}], "=", 
    RowBox[{"Gradient", "[", 
     RowBox[{"qsp", ",", "xx"}], "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->313890144,ExpressionUUID->"c95c58da-0673-443d-ae0c-8e1859053ba5"],

Cell[BoxData["3.717617`"], "EchoTiming",
 CellID->2068102392,ExpressionUUID->"fd330df4-eb86-4e04-8971-900984b81dc4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"grd", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}]}], "]"}], "]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1745720274,ExpressionUUID->"b6fd653c-f5b2-4894-87a4-5449b9d3e7cf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.7476389859037255`"}], "-", 
       RowBox[{"1.8549919901494456`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7473570833739234`"}], "-", 
       RowBox[{"1.854511253993559`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7476311402464512`"}], "-", 
       RowBox[{"1.8548800313569078`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7474607507190953`"}], "-", 
       RowBox[{"1.8541124285330457`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7476640804515604`"}], "-", 
       RowBox[{"1.8548863655653032`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "1.1004875287985585`"}], "-", 
       RowBox[{"1.6474893571595834`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.0834148233755785`"}], "-", 
       RowBox[{"1.6354010387015196`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1023876760416726`"}], "-", 
       RowBox[{"1.6406420392908385`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1122746752722539`"}], "-", 
       RowBox[{"1.6244668938133753`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1080253858253157`"}], "-", 
       RowBox[{"1.6451215910664816`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "1.3014746354907474`"}], "-", 
       RowBox[{"1.1469265457634368`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.2040922402867065`"}], "-", 
       RowBox[{"1.0872502071587873`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.3139470933624264`"}], "-", 
       RowBox[{"1.107495020904424`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.3840643821703353`"}], "-", 
       RowBox[{"1.0323028098261218`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.348504541066721`"}], "-", 
       RowBox[{"1.1357391412601059`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.8562582701892734`"}], "-", 
       RowBox[{"0.35880738687972713`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6227110349620539`"}], "-", 
       RowBox[{"0.22231680213551014`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.8886847224903233`"}], "-", 
       RowBox[{"0.26259450857795885`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.0775423665275032`"}], "-", 
       RowBox[{"0.09644535286280301`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.9750036487299802`"}], "-", 
       RowBox[{"0.33403684281824614`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.20660887202633704`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.47432126528052676`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5165754627639698`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6512799143036041`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.15855787021389672`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6067052136748909`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1334255361462097`"}], "+", 
       RowBox[{"0.8140379610326964`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.03712124367306434`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.5051798963591223`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1574075649,ExpressionUUID->"73e468da-d4ef-45ee-81f9-7f75a1d3c719"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "cd61d8ac-af74-4001-8959-bb1b2bb1ab13"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"3e38a68d-c592-4662-a717-4dbd80bf4e99"],
 "Jacobian Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "f18f2de9-4bbc-4c18-b9a1-a4278212d363"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->38255620,ExpressionUUID->"e7d525bf-798a-418f-b06a-f700e4642dfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->864594887,ExpressionUUID->"d19c33f3-5158-4978-a33a-8bcc5642296e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1371910207,ExpressionUUID->"64d0fc37-1d84-4145-aa8e-71233a070bf6"],

Cell["Construct a QSP:", "ExampleText",
 CellID->162931210,ExpressionUUID->"93169191-0853-4d43-b5ee-9bfa42b76704"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$parity", "=", 
   RowBox[{"-", "1"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->343196545,ExpressionUUID->"8c20f6ae-75b3-4d10-9584-928ffd96df94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->638385350,ExpressionUUID->"ee8c780c-737b-42a5-afe3-017095198f3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->918428547,ExpressionUUID->"6aab54a1-6102-4acd-84fb-55eab20e296b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->514277038,ExpressionUUID->"526757a1-5fe6-4c08-ae37-38e6fd052258"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "*", "Pi"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1374222030,ExpressionUUID->"903e99b7-8a58-4274-a260-c9aa44ad2b7a"],

Cell[BoxData[
 RowBox[{"-", "0.9763034131218359`"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1979982138,ExpressionUUID->"ae393c04-210f-4b8b-9143-73bdcb32cb42"]
}, Open  ]],

Cell["\<\
Calculate the Jacobian matrix the Chebyshev coefficients with respect to the \
phases:\
\>", "ExampleText",
 CellID->523581948,ExpressionUUID->"2e104cc7-b64c-40e3-8466-5024d23aa0ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cff", ",", "jac"}], "}"}], "=", 
   RowBox[{"Jacobian", "[", "$qsp", "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1601298277,ExpressionUUID->"7043a598-9a33-42d5-a9b6-07234d651a80"],

Cell[CellGroupData[{

Cell[BoxData["cff"], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->450237662,ExpressionUUID->"494b6216-a4dd-42f8-815c-0c1377ea7d03"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.2602311260461158`"}], "-", 
    RowBox[{"0.7611134399038367`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3450831485647699`"}], "-", 
    RowBox[{"0.04976818742283829`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.01629028033872486`"}], "+", 
    RowBox[{"0.02755042198253971`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->153199454,ExpressionUUID->"6e641977-fe79-405f-a31e-36e329099a10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "jac", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->30274202,ExpressionUUID->"bad41a2a-016b-42e0-bbe2-90f8eb9d5698"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1.522226879807674`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5204622520922315`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.25097163688678475`"}], "-", 
       RowBox[{"1.233177156841502`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6998326728947746`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9233108263695126`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.09953637484567669`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6901662971295398`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6535555211756574`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2674606711686963`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11915001937234378`"}], "-", 
       RowBox[{"0.3436095762973714`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.05510084396507945`"}], "-", 
       RowBox[{"0.032580560677449785`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.164078526399397`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2774926242264156`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.014020242834160321`"}], "+", 
       RowBox[{"0.023711292767662852`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->2137814272,ExpressionUUID->"f82c4f8f-cf36-4e9c-aed4-b5622f8b1a2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"ChebyshevCoefficients", "[", 
   RowBox[{"$qsp", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$n", "+", "1"}], ",", "$parity"}], "}"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->429782927,ExpressionUUID->"42240fc4-9ed9-453a-bb0c-fa6b2e12363d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.26023112604611576`"}], "-", 
    RowBox[{"0.7611134399038368`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3450831485647699`"}], "-", 
    RowBox[{"0.0497681874228383`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.016290280338724896`"}], "+", 
    RowBox[{"0.027550421982539767`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->695571547,ExpressionUUID->"92570cb7-7a12-44db-b851-59e4b7d291a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cff", "-", "new"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->379226317,ExpressionUUID->"5b4816e6-4ffc-4dd6-84b6-e6dcc88ef3d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[10]=",
 CellID->1717499808,ExpressionUUID->"cffb2bb4-8e97-42be-96d4-15ef30959ecb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "3ce66a8e-a596-4b45-9c13-3e6465bf8f1e"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->512088563,ExpressionUUID->"a1ede3e7-eb9f-4c04-90cc-e3244446eca1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "75"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1705504812,ExpressionUUID->"1ab23711-c0b5-49be-8b7a-da9e42f742cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1955138775,ExpressionUUID->"37a54033-8b4f-4b5f-9703-13eb29e52bc7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1370108678,ExpressionUUID->"a7fe4814-0624-47e4-b135-8665a192f236"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->1691573729,ExpressionUUID->"a2b926ac-5b82-4da8-95a4-647a16fbea22"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->42686767,ExpressionUUID->"f99d377b-0c7b-4141-b0fe-9397c68547d7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}], ",", 
                    "1.3526643903415392`", ",", 
                    RowBox[{"-", "1.4612784342395748`"}], ",", 
                    "1.2380248457091423`", ",", 
                    RowBox[{"-", "0.4898389003561131`"}], ",", 
                    "0.14740162462925227`", ",", "0.09519214138002281`", ",", 
                    
                    RowBox[{"-", "0.054377159963480484`"}], ",", 
                    "1.1366917987048297`", ",", 
                    RowBox[{"-", "0.9313131184913914`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwBZQKa/SFib1JlAQAAAEsAAADCKMdWmtbwP0p+jGsY//U/Fi5PbQIC2r/n
sG9qg6T1P4OL1n5lYfe/pUz/I/PO8z+So1VChVnfv9J3lHIO3sI/ZTsQHoNe
uD+SkGK3UtervzoZUb3jL/I/mjNIK1HN7b+ODIEp/w7tvwk0qfGDMtC/5FUa
BqIR5T+C2oqJ6rbnv+vIT+d30NA/36VHNZG66j9UEaj0Vk7RP3Lx+egYIPi/
ZvJ44rBL+D+CZ2RyYlruv+DKOxu8kua/ZLABsHUVxr+uW3p3rbrwP2zqRunA
uvM/ORtxR9lO8T8gEKsW4cbsP3H+kgsPEvg/N30clbQn9b/3XTp7207cvw7K
CN/azda/dezoiRYt9D/5o6J1nBH0v8qhqszH/OM/cZV8jIWBqD+J3WQ173PZ
vyhiulutxNo/aHOk30Km9L8np2ibHJLlP50ylu4YIeM/qt2wt8Fa8b+g/azw
FHjyP3pplXQTBMI/+E8gvHYH0796+6S7MwrivyY7aPXgH/M/0IYGxT288T8n
cP6KROj0v3YwO8QnN+G/JLKNqcez6b/5gNKj5Jvvv9FoeFM9epe/4s6MzZu6
4T8KyIb3G1PGP4HLGH6d39Y/pn/d+dO55L8Vqeq+64nzP0BdNsrjEvI/SFSk
3SKc5r/wApoBDKPyvzKjRF77frE/rDMlGe/whr9AlfksQx33v6UbaY60wOy/
62pLzBmAxL+IyHLLBNjtv6YOvFLihuW/5hWoc43C5T8N3Rod0YbXvxiGd75u
Bu8/r5dvXkuXxL8i2F9tPh3gv6uwXAmzc/e/kbWbNfIh97+B20y2
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1891144317,ExpressionUUID->"84f1a5a0-a80e-4dc1-a759-668149490407"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1963149449,ExpressionUUID->"c1f68a29-00e5-4ff4-bb63-8370455da052"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cff", ",", "jac"}], "}"}], "=", 
    RowBox[{"Jacobian", "[", "$qsp", "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->714036835,ExpressionUUID->"074e32c3-cb35-4c9b-b97f-0e3c20ecde13"],

Cell[BoxData["3.69898`"], "EchoTiming",
 CellID->1704560219,ExpressionUUID->"9de1e52b-cfde-414c-a4b2-e94531fbcadb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"jac", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}]}], "]"}], "]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1994254140,ExpressionUUID->"cd241861-4da8-477c-b0fd-4a65054054a1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.10732694992958547`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3336074545476465`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0959251305470628`"}], "-", 
       RowBox[{"0.3523320370881716`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09741941203650925`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3368060087131481`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.20049921569346335`"}], "-", 
       RowBox[{"0.3971878392532484`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0839563448552769`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.32210909366168267`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.2880009589529222`"}], "-", 
       RowBox[{"0.761516990036452`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.23978592500425494`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.267312488420766`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.29731226353769974`"}], "-", 
       RowBox[{"0.7303137156920703`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1196883237734089`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2455167748427231`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.30583680464939306`"}], "-", 
       RowBox[{"0.7717872255700957`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.14352211980460244`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.20437003455206015`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2681270244161595`"}], "-", 
       RowBox[{"0.6071438444022214`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1518650547910353`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2478239005759883`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.008613609028514836`"}], "-", 
       RowBox[{"0.5970044400906976`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.21398620985314284`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.19304174933267`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.04828327650186211`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2774318040665258`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6158256914964385`"}], "-", 
       RowBox[{"0.32820786915146943`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.10792020842075108`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.4112214719482929`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0909602809008879`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2475035377862933`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1874135632946686`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.23988211090836487`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.6902568892430568`"}], "-", 
       RowBox[{"0.04706157499515176`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.10268272577955069`"}], "-", 
       RowBox[{"0.02540614540743067`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6300579863497657`"}], "-", 
       RowBox[{"0.027793534825155765`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.060432975775725796`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13038596081342144`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6876932784479498`"}], "-", 
       RowBox[{"0.026995819308095994`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1111749753,ExpressionUUID->"86fad324-a116-4b07-8d2d-34c20f9d6687"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "3"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "427e1c38-729d-4822-ad00-4f63ce52a406"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"385bdf12-31dc-4d87-96ff-adfa8606540e"],
 "Hessian Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "15c651a9-e078-4280-bfe1-cea23369136a"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->729870429,ExpressionUUID->"b8ca2ab8-3210-467a-8c90-cf1832642004"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1888803347,ExpressionUUID->"44fba486-7541-45cb-b241-89ef9568e9f9"],

Cell["Construct a QSP:", "ExampleText",
 CellID->891018326,ExpressionUUID->"7092563c-0089-4262-a8e3-e61aea2adba7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$d", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$full", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{"$d", "+", "1"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1014583075,ExpressionUUID->"2620dd6a-5cb6-48ef-8876-6c48fe7eb53e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->2070369771,ExpressionUUID->"1db8d9a0-bd76-4f71-a9b4-648ce9f57bd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", "$full", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->599153438,ExpressionUUID->"f9679119-2921-4221-ab22-3ec0a2dc0721"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{1.0523932828678402`, 
   1.3747791482091025`, -0.4063726489518741}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1027208856,ExpressionUUID->"85d28a9b-8e5d-4669-85d2-26c90eb9db1a"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP:", "ExampleText",
 CellID->316224040,ExpressionUUID->"cd7d7dd5-ba9f-4f5c-8901-64314d617c7e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->2132222963,ExpressionUUID->"0a68311f-f0df-4b90-b403-f0faa5dc2469"],

Cell[BoxData["0.8611328962689639`"], "Output",
 CellLabel->"Out[4]=",
 CellID->678204559,ExpressionUUID->"4519039a-9498-4c7d-9839-99b1f0103906"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "hss"}], "}"}], "=", 
  RowBox[{"Hessian", "[", 
   RowBox[{"qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->818380663,ExpressionUUID->"1a755b12-7899-44ee-ad58-4fff46ca9f55"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.5153551899367812`"}], "+", 
    RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1888308484,ExpressionUUID->"5c39176d-48b5-4775-944f-b47ee5640a4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"val", "-", 
   RowBox[{"qsp", "[", "$x", "]"}]}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->580159733,ExpressionUUID->"482748c5-6f87-4c15-9627-ddadf5aede8d"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->1287355222,ExpressionUUID->"cde1b5a3-5867-48d8-8776-6b8e407a7e28"]
}, Open  ]],

Cell["\<\
To verify the above result, let us calculate the Hessian matrix by explicitly \
taking the partial derivative with respect to the phase variables:\
\>", "ExampleText",
 CellID->1948001229,ExpressionUUID->"4f524ef8-65dc-4ff7-9f56-50cac2311009"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$d"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun", "=", 
   RowBox[{"QSP", "[", "var", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{
   RowBox[{"Matrix", "[", 
    RowBox[{"fun", ",", "$x"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->104260101,ExpressionUUID->"3fa465ed-a6c5-444c-9c2a-b8e8a79427dd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->681472629,ExpressionUUID->"459c2108-b21d-4df6-93dd-ab6cada5d4d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.2584501349634259`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][0]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.7415498650365742`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][0]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     InterpretationBox[
      SubscriptBox["\[Phi]", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`\[Phi][2]], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][2]], "]"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->980186152,ExpressionUUID->"dadfa3ba-1bfd-4469-bdcb-f7e07fb9bc68"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"fun", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", "var", ",", 
     "var"}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"var", "->", "$full"}], "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->447088284,ExpressionUUID->"8da9f3ab-d64c-45a9-9156-53c7dc4120b3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->641600527,ExpressionUUID->"60314cd7-ad6c-4653-bb5e-3d524e2a5238"]
}, Open  ]],

Cell["Finally, compare the two results:", "ExampleText",
 CellID->1592012364,ExpressionUUID->"8a0419d5-336e-4ef7-8d1a-78699d741307"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hss", "-", "new"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->2109008775,ExpressionUUID->"29b67921-0724-4567-9abc-77f4c1d8ee3d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->864665702,ExpressionUUID->"d10f2c3a-ce08-4485-92d4-d58ff18ee727"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "ac4d5a6b-382f-455a-89c1-09bc51ac5566"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->16707169,ExpressionUUID->"dcc8b56d-452e-4540-abe3-ff6d6c256fa5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1832672994,ExpressionUUID->"610a8e97-152f-4647-a808-069de1419602"],

Cell[TextData[{
 "Construct a QSP with a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " phase vector:"
}], "ExampleText",
 CellID->377061237,ExpressionUUID->"a96c8566-44d0-42b7-829d-13d58f133b14"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$d", "=", 
  RowBox[{
   RowBox[{"2", "*", "$n"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "$parity"}], ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$phi", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{"$n", "+", "1"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->43967962,ExpressionUUID->"f0f50d8a-e2b6-453f-af47-3df24e370b86"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[2]=",
 CellID->414614265,ExpressionUUID->"5854f696-3d19-498e-b9ba-cab8426ada75"],

Cell[BoxData["4"], "Output",
 CellLabel->"Out[2]=",
 CellID->1985000987,ExpressionUUID->"7e65429b-a4f7-4502-95e7-d375d30887cb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5339902389407843`", ",", "1.1787619696233085`", ",", 
   "0.7580510288911491`"}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->753132364,ExpressionUUID->"661f1215-6634-49eb-9a3b-50d7bae766e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->200293604,ExpressionUUID->"7ed62ac0-2a3d-4021-8536-df2d9cd8fa49"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "0.5339902389407843`", ",", "1.1787619696233085`", ",", 
                    "0.7580510288911491`"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{0.5339902389407843, 1.1787619696233085`, 
    0.7580510288911491}, 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->627026330,ExpressionUUID->"1ffa646b-c9fe-486f-a125-7c9ff55e2d26"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP:", "ExampleText",
 CellID->1394539877,ExpressionUUID->"54ffc5b6-5757-4630-86c5-b789db0c7b15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->395189381,ExpressionUUID->"35995db3-c4b9-4d52-950d-9c5644f8e465"],

Cell[BoxData["0.7222657925379279`"], "Output",
 CellLabel->"Out[4]=",
 CellID->729272481,ExpressionUUID->"b97fbc29-996c-46b8-b42b-6a49b997f905"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "hss"}], "}"}], "=", 
  RowBox[{"Hessian", "[", 
   RowBox[{"qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->159787830,ExpressionUUID->"d6d0a979-8ead-4696-97c7-9c67433c2500"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5769627824536402`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.4145364025864139`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2.3078511298145608`"}], "+", 
        RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.2552598932355523`", "\[VeryThinSpace]", "+", 
        RowBox[{"2.5361482143617504`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "3.35838258479375`"}], "+", 
        RowBox[{"2.1631785520385023`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1.2552598932355523`", "\[VeryThinSpace]", "+", 
        RowBox[{"2.5361482143617504`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "2.4130282108016887`"}], "+", 
        RowBox[{"1.466902161955848`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.033706474826593384`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.004835123625018142`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3.35838258479375`"}], "+", 
        RowBox[{"2.1631785520385023`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.033706474826593384`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.004835123625018142`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "2.3078511298145608`"}], "+", 
        RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1193414738,ExpressionUUID->"cd374772-5ac9-40f9-9944-cabd2ff4fe83"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"val", "-", 
   RowBox[{"qsp", "[", "$x", "]"}]}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1568514031,ExpressionUUID->"66407633-3428-435f-acc3-b677432f597f"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->224238586,ExpressionUUID->"38df79b3-7206-413b-bffd-bebc91b3bf71"]
}, Open  ]],

Cell["\<\
To verify the above result, let us calculate the Hessian matrix by explicitly \
taking the partial derivative with respect to the phase variables:\
\>", "ExampleText",
 CellID->664134417,ExpressionUUID->"e2fd3d37-013b-48ec-9e35-f0a08c1b0a16"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun", "=", 
   RowBox[{"QSP", "[", 
    RowBox[{"{", 
     RowBox[{"var", ",", "$parity"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{
   RowBox[{"Matrix", "[", 
    RowBox[{"fun", ",", "$x"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1634633060,ExpressionUUID->"fb654c1d-8499-4316-94cc-f69f2633415a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->2091598064,ExpressionUUID->"6db72d67-1c35-42d5-9e0a-9a06494123e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     InterpretationBox[
      SubscriptBox["\[Phi]", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`\[Phi][0]], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.7222657925379279`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.47833212492955896`"}], "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.5216678750704411`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{"0.7222657925379279`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{"0.7222657925379279`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.47833212492955896`"}], "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.5216678750704411`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1328843905,ExpressionUUID->"c0add9b2-ed46-49de-ab52-5b9e5474d839"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"fun", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", "var", ",", 
     "var"}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"var", "->", "$phi"}], "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2087253347,ExpressionUUID->"05b8f78e-d0ed-46b8-9519-0db4b2b3a3de"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2.3078511298145594`"}], "+", 
      RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.2552598932355528`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.5361482143617513`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.358382584793751`"}], "+", 
      RowBox[{"2.1631785520385027`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.2552598932355528`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.5361482143617513`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.413028210801688`"}], "+", 
      RowBox[{"1.4669021619558475`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03370647482659327`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.004835123625018508`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3.358382584793751`"}], "+", 
      RowBox[{"2.1631785520385027`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03370647482659327`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.004835123625018508`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.3078511298145594`"}], "+", 
      RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->49582535,ExpressionUUID->"28a7691e-12fe-4f6c-b2e7-cb0628871dc5"]
}, Open  ]],

Cell["Finally, compare the two results:", "ExampleText",
 CellID->1200015267,ExpressionUUID->"431b2ed2-cbb2-4411-bc75-7c3f94e7bed5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hss", "-", "new"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1637663492,ExpressionUUID->"b86bf045-3111-44dd-8619-31d589c2dcc3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->110010709,ExpressionUUID->"b9c768f4-1e9e-4d04-9307-aba2cf168dc9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "53851d47-1e4f-45e6-9c0d-0e13b75bb14b"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->486630493,ExpressionUUID->"88d7ce5b-5553-493a-b5e1-a95f6f9da6b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1180968075,ExpressionUUID->"455e8843-214d-4293-bcbf-2f211752ac77"],

Cell[TextData[{
 "Construct a QSP with a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " phase vector:"
}], "ExampleText",
 CellID->1486570951,ExpressionUUID->"2ab8db54-7e67-480a-87d2-2be86de8f8a2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$d", "=", 
  RowBox[{
   RowBox[{"2", "*", "$n"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "$parity"}], ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->973224259,ExpressionUUID->"0cc60023-f7c8-451f-870c-4008f7942444"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[2]=",
 CellID->2114049743,ExpressionUUID->"0ef9ecf9-2a63-40f3-a155-ec6a94a0de24"],

Cell[BoxData["50"], "Output",
 CellLabel->"Out[2]=",
 CellID->717090986,ExpressionUUID->"1fb44516-40ef-4471-9144-ec5659e9cfda"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1678153624,ExpressionUUID->"33cc6efe-1b23-469d-8811-6bdcba323ca5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["50", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["50", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "0.5339902389407843`", ",", "1.1787619696233085`", ",", 
                    "0.7580510288911491`", ",", "1.134532453888182`", ",", 
                    RowBox[{"-", "1.3517605416842526`"}], ",", 
                    "0.9052533646233881`", ",", "0.591118526082671`", ",", 
                    RowBox[{"-", "1.2759930775363912`"}], ",", 
                    RowBox[{"-", "1.3804120440348508`"}], ",", 
                    "1.4620420068679363`", ",", "0.702587270614763`", ",", 
                    RowBox[{"-", "0.29182991018788623`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{0.5339902389407843, 1.1787619696233085`, 
    0.7580510288911491, 1.134532453888182, -1.3517605416842526`, 
    0.9052533646233881, 
    0.591118526082671, -1.2759930775363912`, -1.3804120440348508`, 
    1.4620420068679363`, 
    0.702587270614763, -0.29182991018788623`, -0.2453649835205999, 
    1.0646298953735758`, -0.2539914181956648, 
    0.08863906086950231, -1.045348527321529, 
    0.09975231071398345, -1.0299833787160213`, -1.4448761853812915`, 
    1.4661621476657107`, -0.3262702156822805, 0.1599724033204789, 
    1.2257365296209746`, 0.5203548471987617, 0.895391934691802}, 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->469974738,ExpressionUUID->"c9a0a4b9-d31a-470b-84fa-eaa0fd762073"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP:", "ExampleText",
 CellID->1858429471,ExpressionUUID->"8501ea53-73e6-4f90-bdce-5bc408ba8b41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1621957129,ExpressionUUID->"618d8ba8-07a6-487a-9a44-e623a5fb9b06"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "hss"}], "}"}], "=", 
    RowBox[{"Hessian", "[", 
     RowBox[{"qsp", ",", "xx"}], "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->454622630,ExpressionUUID->"d00bc487-070f-4978-8ef7-9f67bc7e0034"],

Cell[BoxData["2.913976`"], "EchoTiming",
 CellID->420567900,ExpressionUUID->"8eda6687-5ea0-4b2d-8a6b-4a7cf11e997c"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "3"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "7ac41882-27f9-48bc-a18f-11195dfbb43d"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"d1bb5b8e-5625-48ac-b988-6c1cc462f817"],
 "Applications",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "1ddbad52-56c7-4476-bf3d-d821e4687734"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->701469844,ExpressionUUID->"47fd54b2-1d55-4cf6-9da0-3891b8b5f2bf"],

Cell["\<\
Evaluating a QSP involves a multiplication of many matrices. The \
computational cost can be reduced to half by using the reduced phase vector.\
\>", "ExampleText",
 CellID->411726774,ExpressionUUID->"eb42648f-dcb4-4ac7-b576-8ee5ecf71843"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->271315786,ExpressionUUID->"176f1d3f-cb61-4c5e-ae13-ee172da1c99c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$n", "=", 
  RowBox[{"400", "+", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"5", ",", "10"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1529848425,ExpressionUUID->"f16832c3-f1be-4ab1-a57b-7eb795cf6232"],

Cell[BoxData["410"], "Output",
 CellLabel->"Out[2]=",
 CellID->1116013023,ExpressionUUID->"6a06da3c-636f-4bce-bd6e-1b61c912f8f1"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->708704663,ExpressionUUID->"1e424c39-74f6-4640-8d2f-253996774575"]
}, Open  ]],

Cell["Construct a QSP with the reduced phase vector.", "ExampleText",
 CellID->263062639,ExpressionUUID->"58e3898d-87a2-4eb2-a4f1-8b2f86da3a26"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$phi", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
       RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"reduced", " ", "phase", " ", "vector"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"$post", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{"Re", ",", "Im"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$phi", ",", "$parity"}], "}"}], ",", "$post"}], 
   "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->252225698,ExpressionUUID->"1fcdcc8f-d954-4af4-9eed-710c8f525b73"],

Cell[BoxData["Im"], "Output",
 CellLabel->"Out[3]=",
 CellID->487988694,ExpressionUUID->"a36d05ae-e1b9-4190-8d96-a17e11533792"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Im", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"1.188652429517412`", ",", 
                    RowBox[{"-", "1.5282539570581533`"}], ",", 
                    RowBox[{"-", "0.17942028160821494`"}], ",", 
                    RowBox[{"-", "1.2173503105164918`"}], ",", 
                    RowBox[{"-", "0.11887669407281704`"}], ",", 
                    RowBox[{"-", "0.18324875551430472`"}], ",", 
                    RowBox[{"-", "1.4383225005814628`"}], ",", 
                    RowBox[{"-", "1.5529442957893163`"}], ",", 
                    "1.1890198090786863`", ",", "0.8937051586490578`", ",", 
                    RowBox[{"-", "0.5875081577071491`"}], ",", 
                    RowBox[{"-", "1.3983546572808385`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwNz2cgFQofgHFJRTfKjSiVUiiV9n2J/CmVFlJJisoIpbKSjCRys1JIkaSI
RNYpIfyNjJBkHXuc5ZyDs5eE9355Pv+e9Q63rJznSUlJJf8XRzeua4kMH6aq
e66XeUuwPWLY1Uhcj8Urv5wy9eej4M2JKcLNSvxZNj1V6NOA5XGnfOzni9Go
RXftQI8EjdIy3uov5IOyybNYg6QJ+PfRLfpgCwlXFCzXyL4kQtrhdhv1pVPY
7kxyBR4J7m3wU7p7iQO2RsscQ8pZYEGskaqMpMBonq+TR5gY35DWzHw+IEG9
5COzLvuaYH7EF8wP44EqXJFWvD+IurYRKhqGdPR6TWbbZ4pBN2jL4g36nXBO
a/Qfl6VM9F+qFV/uKETv4hMx19YOgAM57OqdFxTUrMGzRpk83Fr/uJ4sLwGp
eJnca4a56PN+uNkltAcNN69eQRnkA8HUSSx48Q0Vfmru3Zgmgla4eHm2fhK0
qQsUCpeKUfXXEjm3ujaMOVu5KMyuHCPpc5NB4wNIJkTQZIdZwGD+YDU/FaOX
5a8zXYljQHRNLSY48IHFPrCyOl6Mtn+eRAevo0DEa4mHj5CDVtExXjEbmLAr
0masVEmI0lv2/dn9loYHFShupY8ZEJieaxXcLkSvy5VJW2/+gJ8acXd+N/Nx
eZb019JfjTBdLGRqW3aDzP9YFRfSGWBc/SzElSbGSYXW46HsCWRstK1RK6oC
9ExLorycgIFmcc+VR9WQP//tVMlKHpbvsjlO4nYh4cDCzudBn/DVeMnWp0um
sG7to7zsU+2QE4+pX3MpkBr2ViVHSoJLbFOIKeuC4UnIyj8JxDo05p9ff6E5
BysrzRdcUaOhzZaiY/s9BXg2pem1XGI9Tg45r3qnS4eSUmeNY/wxyEyPyEs8
SocDilfroI4C243P2SYShPjMyMFZiswF9uyuJZP2Ijg7kdG3Y0EVzL3Z7NdF
HIDNVn5jN86IkXXtDdPl5BDWNjXtorYOY+ieOwWZe3io8SwymEItRp1Y53YT
Mw5Wq8pmeKcK4WBityexpwXWsj6Pvk1gYocVXwHbO6DU3eXLpDwJbOVmzTYu
oEIsWUw8ajaJX35rXTB4WgUa7Vo5gUQJdH3IvEfyJ+HjPUmFO6uJGJEoQ1IN
7sGP8z6G9SrlIDHmpkJz+ChWSOV/nlYW4D0dVvlLKREE7ZJNydStgpem/U6m
iwRgEByw8WTXMHA6AhzTbmTCqXnbztl6jEJORcQhL9Y4jt2NVvaeYcIEYXaN
2kEOOt+wqhncNgGHeD+u7TCfxKWiOvUtHhwc/Bphx7BqhxnbzhIbAhNNjezG
PqwW4Liezl5VYwkcXZ7yWdWMjKH05vFDe/lQZtH9yIA8gguuNzc+aCaBvrK/
yuEQEX5aXisd/4WDWaU/27SACuKIQ9+rQoX4NGQ662KkBC1enPSyWkLGvIeS
OMeIZlixe0hPQ5oLvoWucs8ZFFThyn4+VEcEnalrljn0EXw8NMPY82McFPq7
XiQeFIBha9spelwZRj3403fVdAItVxF9bi2mgqNt2SrwJWH/7cPNBeq96KWr
lj8sQ8eo7N9eFLshPEj84GRMFoBCiP/Gh0+YuLT0b5fGZha8DpwK21dSDccE
Rf8WUnhQvS2oPpdXBB+UBjYX3h7F7McpT2VHSsCzlfnyWOB/n72za/wfTIB5
Y1qjulUDWiWPBT7z4IFoBnXnzn8ErZkzEYF2HfisNjTmXL4EOVtd5dQVw8E3
TpeUYM1D7QNZT2vpHITbvu7mKi3waW1XTZqoBzUXrbBQXT0FNqW03wYMMST7
OKupmzphz4MCy6ZSKtil0e+Zb5jA/H9rTGUzqHi/9tL5TnMhmCZFBPiq02HE
6XSlF70da51VG46xGlFzOCXhunsRmtzYf+fRyW/oeG+9Z2/tGO7M82P72ZCh
z/1SylcmDzd+r8z1ZY1h3bugzFgaFR3P7Cte8ZyKzx+zjDv+asAwKyVbr0uT
4Ba0Za3PcyEo2farzIUTkBqeZHJEngcPjRYbepkz0bvl9bJ0uzE4fdt0Raw2
E6YiJVH8QRGGk6c5DqfH4FqyqU5ZpwRGr9oKXPXZmHFSPnp9gBgIM5RctbkJ
CHs++iiyUYx7j3sErD7Pw6i+rPFFlSRIjyaNNQgKYNWPVlnro+MgUlKymxZL
gFnpmJDYzoYv9LsnUoU9qKQ+rc3fNA4WAdcvRM9yYDyqCc4H9UFeaTypu1EC
BU567f0na7Dx3Spv7f0CZBgQrnicoGDvG77sgYdlYF9D2FhoyYXZhCGNNPYw
/OHdKbqcIYLE6RnmJFuCOx5tygjmd8Ok8wdBtb4ErPlrHBOsBODLD3poYcfH
033ym4evCaB9TwDNrICPzxhVfvrrOnCIb0hw9uei5VXmQOTPEVTty2pJ6eKA
dvvojf3lbRhcvtttzR0xMPfMcob+aYAr9/7I/dagYfuis6mq7zho8alOTDGn
w5L+5mXp/UOQO7rkOoNGwZC2VSr9DkW4IETKkOEmRuuxgQpinAhTGLciZCc7
4VS06VJ3jwk8v2Bqw6bpftyedTc+POEXNBSFJVldJKGM+PewWQYHa712WPd5
czG0QYa6YR4VXBlE7qbPVJy3k1QsMRNib0W9frIBH9tIF2aMHOlYxq9RcdH7
hNaG6tENTjQ0E/EyRs4M4ZOMrMjTIzyU16u+0ZJNhoNb1WqV11fBujj2/sPG
QtSy9/kU38LDPXd/v1X07YYWzbmh5KLvcHHmuxb8EeBPllziMbYA5q+Kn/yZ
xIHMKRmFoU9ikP5sceEQnQN2k30/vBM54Bkb1vXw6hguZFYN/NQkwVz2diWX
XjHcFxoK0iIGoD4o9OviHyww0R7N7VTrQHmaVj5b8AwFLy7sXinVhOLLF4fC
6yuxcZ2Jy8G/hzFgVTvlxWkB2lVZXZty+IRvVv9ZcD+ah9+dA3+bMbvgywnF
kkpGKQjf77NvXMFGg3Jr0wY9KrruS+j0OtoGvfMft5QoE1Gj5O9U5e8ULGzv
l2RXc+EpQf+mfiUXzN1iFz0cJmHdOZkwh6fZ6PuswXT4P7/74vOHeXVMPLFW
t9fHhAJfB9wo908NAaNiZ4aLfRfO+Hk7X8d2fPveih6XRcX0ZS8y4yPTMGpN
mPxw6Bjq/JVDczjHB/IlqfQ6Ag2/zeolR8kJsBrontPrhKjjFESz3lILpu9T
hwflOejpbb/0IYGPQqYoNbRXAJ0vajpsor5BjZVRnEhXAsu/rVPbpMmFlGMc
oeYeARD2N4XXllYgL27hZUF+L1rvXJpA6KtAo+PS0SqBQvDP0uBRnYfgyArj
JPcjIxjYJecjNyFGf4XAFznAhg7j/U43FMcgVnnM9+4aLkrUq00KbISowelo
/KebDOw3e59fT8kBJl/hYDKFi9pzjPcftSWob6AzpRjZCGuPVmlnj0pw9blB
r2zFNpg9crZYP7YP5+5E2eQajUN4tecvCzk63jX/mjIu1wwLdVsTWshsNNfU
5tvt5kL07Lbk4Tw60rnfbrTIVOEOBYVF8usF6MGLjLlcTMd56TdJk1EcEEZG
nORpPYSABa9ipqQHQNprfVE3cRzWvXJAU9VRNJ+5rW9zWgQ8+HPeI5YHV06b
DPdH8zHf3unI+6d0XFYQ63gurgK6L2e16PiL0TFk97J77mSQ5IQsZ/pVA1Fb
NjDGjgbadEpX6CADAxRuGQZeKINDDtsX5lHYOPTKjGW5iAr3P9L6NpVJYP/Q
NroNiYo2Km+CnHP6ARmb0tXi++Cx/PT49vkCOB42WHBXjoemdqe7XjWw8dbm
H/oNRyhobBzP/3ygAy/kfLNYX9AKBwLYesYTPFwkdh9XpbUia3KGFp3HBP88
etB+aS52FNaHOu0iIjKYUkwGH+WcPiSn/xKjxritmWi+CNe7LtG7MfcOH1gW
ZriaCMEtP29C81oT+u+4vDjekgdrF96klzxmovwP9xDSBg52NBsaXSd0g69d
fDb7Yh/mTdBlfeLG8YNn34khxVY0OGkWQQgbRjVxnIKKVD2kauV5N1O44Kdw
qsuGNQHe4rIdRU18bI1N7nr7mgotygOj1QQxRjsrZ/1aUwxp24LysraO4Or5
I8GXHLjA0mJau5KFsPILWd+wT4xnLm8VPeB9wcAU78V3rfgYo7OtwG/DCLaV
FGtVKE7hxn8GbntsE+KrmXnvw/N68C2lNnr3bA9kuqW9MzswjiYf65MEMSPw
v57yd/71ArAPkdGfOc+Db/Gcg0/sJPB/ujUvdA==
    "], -1}, Im],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->385932165,ExpressionUUID->"22fa61b6-3fc3-473b-9cb2-4cf5a5d79956"]
}, Open  ]],

Cell["\<\
For comparison, construct an equivalent QSP with the full phase vector.\
\>", "ExampleText",
 CellID->783735018,ExpressionUUID->"68f52232-236a-445e-b048-a040d50b4e83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gun", "=", 
  RowBox[{"QSPConvert", "[", "fun", "]"}], 
  RowBox[{"(*", 
   RowBox[{"full", " ", "phase", " ", "vector"}], "*)"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->553874063,ExpressionUUID->"abfca45d-41e0-4c72-ba54-213bbb32c605"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Im", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"1.188652429517412`", ",", 
                    RowBox[{"-", "1.5282539570581533`"}], ",", 
                    RowBox[{"-", "0.17942028160821494`"}], ",", 
                    RowBox[{"-", "1.2173503105164918`"}], ",", 
                    RowBox[{"-", "0.11887669407281704`"}], ",", 
                    RowBox[{"-", "0.18324875551430472`"}], ",", 
                    RowBox[{"-", "1.4383225005814628`"}], ",", 
                    RowBox[{"-", "1.5529442957893163`"}], ",", 
                    "1.1890198090786863`", ",", "0.8937051586490578`", ",", 
                    RowBox[{"-", "0.5875081577071491`"}], ",", 
                    RowBox[{"-", "1.3983546572808385`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[CompressedData["
1:eJw9mXlYzWv3xkMor8JrKDOhjB0H57wirSJHHEKmRIYGMlOEFFIcpXRUQieE
SCIpUqHVoIESSho17Ha12027PbR3Un7vH7/7/avr6qq9v9/nWete9/1ZE+0O
WTn2UlNTm9dHTc1+T7tTorqMOtNK9iW7qLjAp8rJRJnFCSNfrjV3k7H8zsrO
+IMp/DG5q/PZ0Wx+Hbj26LY+SjbJMxxXUaJik/CIu0b9ZDTc7GrAwhvN9NfF
Q6JveQIeETtUL2p7B9f/UWA9flAnFzgKnEgqoNOTTgw7uV1CNiaD7T1ft9Lq
4nS1FF8h1cS4Ohz2VvIdwdjuF4tVPD90Wc/uBe+pj89LfuotJV3a2XvI2W9s
aOOjo2csYufbtW3bHijJ0GPGgElGX2iTfs3vuweJ2W2QftBrewW7JKz03zuu
guxqvXcdvy7kKem8weSBlGdmXc6q1VKRWpD6473Gj/now6rc3V4lbDxtzAjh
NxnFmzso5dffsvbHKb9NDu+gfNq6oyerhQzq+mo/G6Rk3c8DNfdkfmL/DSn9
vW1fs6/oZ4tHUwXXxvvUa1S1UqP4Q2vuFSU7r/m8viikgYqdbiXE28motW3x
yLQgJdv8+NvvzAQh+dxWHT6qkLCVn7+z/yQxzfG1bkgapuDeMxb8mHu3npdo
C/ckXW4k93uPrc4UKNh5R8qNmQc/0Ee9wOPfc2U8NLL3q6TPOdSVoBAbrPlK
6v9pfbPlXiOZpl31dKpXcot2/p9ebc3cONkmfXRcKvGR8BvCf5qpIldZsvNi
Gj3tc7czcaSUX8+x/lPQXsTxi/t9uebxnG82Jc68MrCTM8ddjIlaW0DRQXzr
1WMh3fK+qxOtpuKBNmHFYRPO0N+eI38EF2eyqWzzxC250ZySYtl35+h6tp4R
t2LRETlvCHt/WzMki1sqHUfdNxRRYpKj3gpZAz245xMTslxEi4fsyqRMIf1i
uskmJF7BV03sHNVq26mtZ87Alm0dtKE5omx231T6eWfaiaLiCppmdaLhwHol
t+69I969qpIz3r+fU5dfxV7zjsc+mCdlvau+Z4R1CTw9wLHAzELCaboaES63
FLQk5OuR4pI8Gtf6ouZusJgLrWTaXFBISft3v2zREpCNZo/F5L51FFCrLF5u
0cIvv+tvWXgllfQK9KPdi1VU9OjBaYGbgC/Pu/Hs17Ri9glRF+ieKeEnvZ54
lw6L5mL/g9q5F2r4jdrTF13D5Xx6euvrf9Q6yGOORtgDw1T6x7zcwby/nBae
OTV5VVEVSQpP2YcfeEBre83aZHO4hqLf+Cx1bm3ihpN+w126xdQc3zN29BIJ
Ox6wSv82q5mWSj/snW3ZwoM6MsfPOCzhb698bButCqjb5kuidbyYzU1sGx6N
kXPT/Om/6ZqqaPnQsBe6FrXsJcptWvqbjJJXf724sLaa++7LzTmXKyCj4W46
f3h28POhGb2DXko4MunjJ32qI6XP0nepXgq+4tkVudVXxauvr3K2GljLMedV
gfY+uTRibuV8vd7t5PrMSfNao5B12jVeLM0spumde9dEi6r5cmV347wPTaRd
XnQ9ZImcjPM/rRUFJvOlcz/Kdpk385pRxUcPDagje5vkUeQq4PJjf+TGji9l
Z8PRT6vURXwp6ruz0LaSlxQ/cjCtlZO2p9vk83+LeVDSv3fn5LbSbfdO7wWJ
abRCHvfXM6GU0mZ5ZD2WxtGjYRXTnh2r4ajLYVc0qhPpSL74nxXu/33P0p6x
bueayTInPGe8VTZbhTa4Xz0spY5uNvy5+Qnpd6/3cbct5KsZXv6bnqpYMtNJ
c/yQC+QaaCgI3ihlg8WRVzJEEqZjrvstdfLo+bii9PCOEp7Sf8Rq3TGdZJ1U
/31ho5JCjzqOHm/uwCXnYte8T6oj23DRactJzfz0r3RzjYg6PpuxffMXSwWZ
3/A55TpeRNUO61KcRQWc4aibvaI1h6dUhQXv2x/HZgcWHb+46i3bn554pDSj
gX+NOdF2wrqWyvZvD3sllvLkdymPXVsbOPO+x4OA+jq2X78gYcS1Or52udW0
8F/Z7G01zMZ5ewvt8Zgx7ug1BQ2zKdf5eSGe6y7cMFumJaXzJgOMnS3F7JJ3
e/A92wZad8x8RICBmDp9VZdk3zr4Qm2XxG5dA+0NNZ+e/EVFNbts5E5GbRyx
Sstv4iklxXcLH4/+2Uze12ou+uYo+bc/D58as1nKl8oim/qnCOien6AhWx5L
oz7ka2xc3kQdw4bZdilVJE6xDw4paKOXopMrbylKeNj4LgPZ1CZafWrfFr8e
CTVdek+bPcooJilI8DVHRbEO8wvKV6Vzzv1RLgaL5Ny4MH7n4ZVCLr0j01h8
Ppm2pcdPframnXqCK/XC26roh/R43I6IDgrp6ha3tKl49sWpEWdkX6nF8ZE8
zUhFG2Vj7YOt5OQq8zi/2lbG68q0plXtlVPBvFP1FrEyvtqYesJoQiFXyozj
Hd3aec0ucYXvx2rWLYvMCyuSkEFBzYFFrz/xmddz94w9riTxvB5J5e/ZtPP0
D83vevVc0H/DLd37El79PFMptBTRwPLcwffKK+lxzcB9jfVC9vw0SqfcLo77
eqoZN+5R8saGijfFgR0c1njIR6PlC631Mx+0/3Azb+7bOWlqVzn/Enky6ELw
Z8qO875htVXA6srvVRYREs5wnr2xzKWdvbLV6yb1qiOnxuL2qS/quNevggSV
hYJL32QZhS6U8SfBlm4TexEny9J1ds9/zhuNx/tlO9SzRYc0onp9Jf8dEem7
rlrKWvPTDuRF1dKSmaMzhk9MpQmBbYv+MFWw/rajz4PypDzv5Pe7Q1y/Ut6U
n5Whce9oa/c7ffoh54+tmiEr2uTUZ1RQy8cbEnrQqa5d+VxJvV+s3rJUJCHb
lrIPLiESOhLgXXR+VwP3E6dWfJwioJ9RvwzbXaqkswpjebhPBWV5eL0a8KGV
zAxqHn8ZXcha9fpP2+RXWX59y9yRau9ZuWNr5YWsFM6ZYLZ7yb+r+NSoAuH1
dXK2TbXa22n3nO+M+dH3rJ+U3zm6f7cQF9HLlUMSUxqTSPFwwbacEW288PVG
8+z5dey0IPiL8/JPVNrncl7i8GLWS/z3reHvhPysoFwVldZOV+KNDhqltJPl
noD+56sEnLlJ3dvuShS7Xs02r/rv8+8fsPkPaaaYV44zLD1qJqRXFXuEZ9dW
UuObXyN2byvi7hMujvu4gO8+tBIFRtbxvcHXHwT5hvOlsd5aVV4NPP1f0fV2
m2RUu13tXmZ8Pb/tmR96SVPOaSQ60jVBwdMdPOo3zsgg84e3qr5pSfiIy7ZB
5+NlrBB33PIqldOX6+mF1pfeUrqVSWCHoYqGvp0weuqUdgpbIVFMmSen+EXv
L2QkvWFpYL8d8qelvPHXQcHxZW/Y5M/efjruCnKL1JPWOVbSshGmN/Yvq2b3
Is2jms1KdtN2vx5NbVRousjhwJAGChje4HpybDurxqeZxVorWE9SmPP711pq
u/PbtX1h0SSWaS8JFbazwc/Gh08MVGy0cHrnEN8cGrc81SCqRsVjNn1zjhry
iXqWbUgwCijjn8cvWT82aaILaUc+r9YU8UnLV2FNmrnUzzA/OK+2jS2nGMhs
57aTX8+s0KoYEYva3x7IU0/l2dra/bUmyvmw1Nd/R4KIe907KGi5JCGFr88q
qf55OtX3pn9n7wrq7Twx7mtxE024acfmujVs2X3MyHpdB0npx+bDAVLauc6s
qtxPxk+3OSx7eEXEg2MD7DcFvqGvOyLzprsp2d5z7uDT+2tJFe05VHwijYoN
NNz9bevJQCQs8vrWyKe0Dxm7b0mmpXa/9IsRtnHlTYvWNf3r6OyT+rKpySpa
VDlLZC2oY2udOx6O0eXEjVPvjQ4qo8taXU2/9JHTn97fYk9qStncdl3Rzew2
PjTtg1H2MiGbmgbJXiwu5C3Rb1dPjM2nxafa5ps2S7m/cn+Tbn0+t7Z01/vF
iMktRuSxqHc7Fz7L8nKYU8zcKFYTN8pY0+FR6L3PStZrsrHo6NPBE50Gzj/w
8z6fW/MswslMQXuexjRP2fue3WbvGBC0Rkrj+h0UJV4Ws9aH/Z6CSRIuzDU2
2Rf/lVxtg6LatpZxTLNI42hgEz86Urayckg+L1xl4RPvXcWjlYHaOmpZdEs/
xiVX2E4ntNcWWbc2k4syeXbcexnnB4QW3b1dR3nDK2rS4pXs5zg88vPYBAqf
5RETObOax/SpPrPdrp1a9cUbnWoVNPJlrZFxmZLX75jZcU76kt3DXAactJKx
//RZsScmVfOnxAT9N0M6efLvFccOz1Lwze5eDy/ElPBdYYbf3J4SerAn/L7F
4iY2e5J1Q+5fTf8peX3fLUtO2zzVjbo3S+ltkGTJ37aq//3E7/F3+D98Dj4X
34PvxXPgufCceG68B94L74n3xjngXHBOODecI84V54xzxz3gXnBPuDfcI+4V
94x7Rx2gLlAnqBvUEeoKdYa6Qx2iLlGnqFvUMeoadY66Rx+gL9An6Bv0EfoK
fYa+Qx+iL9Gn6Fv0MfoafY6+hw5AF6AT0A3oCHQFOgPdgQ5Bl6BT0C3oGHQN
Ogfdgw5CF6GT0E3oKHQVOgvdhQ5Dl6HT0G3oOHQdOg/dxxzAXMCcwNzAHMFc
wZzB3MEcwlzCnMLcwhzDXMOcw9zDHMRcxJzE3MQcxVzFnMXcxRzGXMacxtzG
HMdcx5zH3IcPgC+AT4BvgI+Ar4DPgO+AD4EvgU+Bb4GPga+Bz4HvgQ+CL4JP
gm+Cj4Kvgs+C74IPgy+DT4Nvg4+Dr4PPg++DD4QvhE+Eb4SPhK+Ez4TvhA+F
L4VPhW+Fj4Wvhc+F74UPhi+GT4Zvho+Gr4bPhu+GD4cvh0+Hb4ePh6+Hz4fv
Rw5ALkBOQG5AjkCuQM5A7kAOQS5BTkFuQY5BrkHOQe5BDkIuQk5CbkKOQq5C
zkLuQg5DLkNOQ25DjkOuQ85D7kMORC5ETkRuRI5ErkTORO5EDkUuRU5FbkWO
Ra5FzkXuRQ5GLkZORm5GjkauRs5G7kYORy5HTkduR45HrkfOR+4HBwAXACcA
NwBHAFcAZwB3AIcAlwCnALcAxwDXAOcA9wAHARcBJwE3AUcBVwFnAXcBhwGX
AacBtwHHAdcB5wH3AQcCFwInAjcCRwJXAmcCdwKHApcCpwK3AscC1wLnAvcC
BwMXAycDNwNHA1cDZwN3A4cDlwOnA7cDxwPXA+cD9wMHBBcEJwQ3BEcEVwRn
BHcEhwSXBKcEtwTHBNcE5wT3BAcFFwUnBTcFRwVXBWcFdwWHBZcFpwW3BccF
1wXnBfcFBwYXBicGNwZHBlcGZwZ3BocGlwanBrcGxwbXBucG9wYHBxcHJwc3
B0cHVwdnB3cHhweXB6cHtwfHB9cH5wf3xx4Ae4H/7Qn+f2+APQL2CtgzYO+A
PQT2EthTYG+BPQb2GthzYO+BPQj2ItiTYG+CPQr2KtizYO+CPQz2Mv8Ho/tc
Pg==
   "], Im],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->961283215,ExpressionUUID->"06005d52-fee2-4d29-8cb9-ae77236161e7"]
}, Open  ]],

Cell["Let us evaluate the QSP polynomial at the Chebyshev points.", \
"ExampleText",
 CellID->789353421,ExpressionUUID->"c91c1636-0a45-4e4c-a7e8-c4790630390d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->210476177,ExpressionUUID->"e8e6f089-31ef-4054-b4b4-cd33b2ab3793"],

Cell["With the reduced phase vector, it is reasonably fast.", "ExampleText",
 CellID->1365905885,ExpressionUUID->"7da432d6-46cb-4542-87ae-75b04ab711bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"val", "=", 
    RowBox[{"fun", "[", "xx", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->192749570,ExpressionUUID->"139fb11a-62b6-471d-bf82-1993a99366cb"],

Cell[BoxData["2.758064`"], "EchoTiming",
 CellID->767518124,ExpressionUUID->"09ff4349-56f6-4202-9035-00c9baa94df9"]
}, Open  ]],

Cell["With the full phase vector, it takes much longer.", "ExampleText",
 CellID->988870704,ExpressionUUID->"26716aa4-21e0-4df4-bd72-1250ddad0083"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"new", "=", 
    RowBox[{"gun", "[", "xx", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->482833766,ExpressionUUID->"304750c1-c7af-44c0-8ff7-98f36c468902"],

Cell[BoxData["8.641693`"], "EchoTiming",
 CellID->1890326186,ExpressionUUID->"c9f81f8f-2243-41eb-836f-9b592d347217"]
}, Open  ]],

Cell["Nevertheless, the result must be the same.", "ExampleText",
 CellID->603496782,ExpressionUUID->"820c5b4f-1a6b-43b4-94bd-5a7dfeecf4f7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"val", "-", "new"}], "//", "Chop"}], ",", "0"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->857850345,ExpressionUUID->"b8cc46b2-721d-435a-a266-45cd7929851b"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->839134384,ExpressionUUID->"c8798484-06f4-42b0-9d65-4a86368ab258"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QSPFind"]], "paclet:QuantumMob/Q3/ref/QSPFind", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "c532296f-811f-4dc5-ab26-ea556c969012"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QSPConvert"]], "paclet:QuantumMob/Q3/ref/QSPConvert", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "eee9ce41-a76e-4d13-a130-79fd282216c9"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChebyshevCoefficients"]], 
           "paclet:QuantumMob/Q3/ref/ChebyshevCoefficients", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "041e7ecb-3d20-4081-9d22-49cb7d49b3f8"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChebyshevSeries"]], 
           "paclet:QuantumMob/Q3/ref/ChebyshevSeries", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "f236e551-2310-4727-8d6a-75f5027f1f8b"]
       }], "SeeAlso",ExpressionUUID->"6d55df7b-de32-4c0d-ab4b-41729556c7c2"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"1edc74f6-8c95-41a1-b5bc-\
d386f907a148"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Signal Processing",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumSignalProcessing"]], 
         "TechNotes",ExpressionUUID->
         "a03c9550-e08c-401b-bb32-ae075f5aa39c"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Linear System Problems",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumLinearSystemProblems"]], 
         "TechNotes",ExpressionUUID->
         "390c1440-8ce1-466c-9493-d07cfc74b2f5"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "167008dd-770c-4732-801d-fd01675f3b7a"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "59235bb5-c6f1-4258-802f-9d0d200bba68"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Spin Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumSpinSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "45f47d2a-f2ed-4da9-8962-62b05f35e2f1"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"8bdd245d-da88-44f0-9a1a-\
70cd8dd98dbe"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Signal Processing"]], 
           "paclet:QuantumMob/Q3/guide/QuantumSignalProcessing"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "4ab76537-6fd8-4c56-8034-561de291117d"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "bd994482-7324-4f29-abf4-ae67db034052"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "02cfdf6b-9c19-461c-ab8e-5c7c8b5d3773"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Spin Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumSpinSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "8a243c35-c2a2-4db6-be31-d375425d8912"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "28b53517-c23f-4cb6-a92d-d521d0beea89"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"b8ba9caa-9bce-4b52-87e3-\
7e8afc54c5ca"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        " ",
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "QSPPACK"}]]]], 
             "https://github.com/qsppack/QSPPACK"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "3b74e956-0426-4d9c-8a4f-3d6bb08434d5"]}]],ExpressionUUID->
         "21fc363e-25fc-4a7f-80fb-6bc2e582730a"],
        " by Y. Dong, J. Wang, X. Meng, H. Ni and L. Lin."
       }], "RelatedLinks",ExpressionUUID->
        "d86493b2-ee1b-440e-8206-a3c21c119b00"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Y. Dong et al. (2021)"}]]]], 
             "https://doi.org/10.1103/PhysRevA.103.042419"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "815ab9f4-4c99-4066-a8e6-4ac499e26e1d"]}]],ExpressionUUID->
         "8c7a274b-dac1-4d08-9b30-e32190b651a9"],
        ", Physical Review A 103, 042419 (2021), \".Efficient phase-factor \
evaluation in quantum signal processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "874f3e02-3131-4181-a9da-e871c784345b"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J. Wang et al. (2022)"}]]]], 
             "https://doi.org/10.22331/q-2022-11-03-850"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "b76844d3-d14f-4ab8-9220-cc42daeeca35"]}]],ExpressionUUID->
         "6a33ef35-aee2-4cb5-81db-18b1c5b4fca9"],
        ", Quantum 6, 850 (2022), \"On the energy landscape of symmetric \
quantum signal processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "51641c81-8025-4c15-86c4-38b21d6b33e6"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "L. Lin (2022)"}]]]], 
             "https://arxiv.org/abs/2201.08309"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "cfaa1448-1cdd-45e7-b18c-bf8a63c2f882"]}]],ExpressionUUID->
         "9373b232-797a-47d0-ab32-96600d8dd17c"],
        ", arXiv:2201.08309,  \"Lecture Notes on Quantum Algorithms for \
Scientific Computation.\""
       }], "RelatedLinks",ExpressionUUID->
        "3c718591-d403-48fd-9f0d-9bd4a0719658"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "A. Gilyen, Y. Su, G. H. Low, and N. Wiebe (2019)"}]]]], 
             "https://doi.org/10.1145/3313276.3316366"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "af56e0cf-6094-49c9-81fc-1633fc6c4fe7"]}]],ExpressionUUID->
         "4ca12ba1-d421-4a6d-a6a8-f90efa3d7f97"],
        ", Proceedings of the 51st Annual ACM SIGACT Symposium on Theory of \
Computing, \"Quantum singular value transformation and beyond: exponential \
improvements for quantum matrix arithmetics.\""
       }], "RelatedLinks",ExpressionUUID->
        "b77942d7-a0a6-411c-baa8-7e3ed6d07c44"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "J. Haah (2019)"}]]]], 
             "https://doi.org/10.22331/q-2019-10-07-190"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "3e9936c7-1f44-4e0e-98a7-435c27891abf"]}]],ExpressionUUID->
         "6ecdd8bd-1fb2-491b-81ba-82e634467964"],
        ", Quantum 3, 190 (2019), \"Product Decomposition of Periodic \
Functions in Quantum Signal Processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "0d633402-09d7-4cc1-b788-dba9af27fa43"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "C. T. Kelley (1999)"}]]]],
              "https://doi.org/10.1137/1.9781611970920"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "58399f4f-b13e-4add-91d2-25d002f999b8"]}]],ExpressionUUID->
         "e4b30c3c-50e8-40ae-a1cd-7d5e9fe9ae2d"],
        ", Iterative Methods for Optimization (SIAM, 1999)."
       }], "RelatedLinks",ExpressionUUID->
        "a94e92c7-a888-4c76-9fe9-f426a49be875"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "W. Sun and Y.-X. Yuan (2006)"}]]]], 
             "https://doi.org/10.1007/b106451"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "6f6ad588-201c-4883-a46f-5b8eae59c05a"]}]],ExpressionUUID->
         "fec98a6a-4425-488d-b816-df03b4ae93fb"],
        ", Optimization Theory and Methods (Kluwer Academic Publishers, 2006)."
       }], "RelatedLinks",ExpressionUUID->
        "d682de22-5116-4526-b5b5-155549eaae0d"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "4822cc8d-40ef-4459-aa0f-b731ed28626f"]}]],ExpressionUUID->
         "f3de7309-0d0f-4591-8e7d-3a5e4876ccad"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "041560cc-efb2-4863-8ae2-d8a6f608b5ad"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"410013d3-1be8-45be-b74b-\
4088235e7fa7"],

Cell[" ", "FooterCell",ExpressionUUID->"a5d740fa-a2ee-4c64-b23b-1d1a49c4bbcc"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"QSP",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed, "3" -> Closed}, 
    "AllOptsTable" -> Closed, "NotesSection" -> Closed, 
    "ExampleSubsection" -> {
     "0" -> Closed, "1" -> Closed, "2" -> Closed, "3" -> Closed}}, 
  "NewStyles" -> True, "CitationPopupData" -> $Failed, "ShowCitation" -> 
  False, "HasOptions" -> True, "RootCaptions" -> "", 
  "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 10, 14, 9, 8, 47.664504}", 
    "history" -> {"14.0", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {
     "quantum signal processing", "quantum singular value transform", 
      "quantum eigenvalue transform"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> "QuantumMob/Q3",
     "status" -> "None", "summary" -> 
    "QSP[{\\[Phi]0, \\[Phi]1, \\[Phi]2, ..., \\[Phi]d}] represents the \
quantum signal processing of degree d with full phase vector {\\[Phi]0, \
\\[Phi]1, \\[Phi]2, ..., \\[Phi]d}. QSP[{{\\[Phi] 0, \\[Phi] 1, ...}, , \
parity}] represents the symmetric quantum signal processing associated with \
reduced phase vector {{\\[Phi] 0, \\[Phi] 1, ...}, parity}, where parity = \
\\[PlusMinus]1 for even and odd, respectively. QSP[{{\\[Phi]0, \\[Phi]1, \
...}, parity}, post] is equivalent to Composition[post, QSP[{\\[Phi]0, \
\\[Phi]1, ...}, parity}]].", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "QSP", "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "QSP", "type" -> "Symbol", "uri" -> "QuantumMob/Q3/ref/QSP"}},
CellContext->"Global`",
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"0b36d6a2-287e-434f-bc38-cf0f88e49770"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[45868, 1403, 1441, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"19c98329-8df2-4388-8e01-65a04f6a211b",
   CellTags->"PrimaryExamplesSection",
   CellID->304200215]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 249831, 6700}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[571, 21, 7784, 186, 70, "AnchorBarGrid",ExpressionUUID->"8b406c2f-5db5-4a38-b265-232617549ba6",
 CellID->1],
Cell[8358, 209, 96, 0, 70, "ContextNameCell",ExpressionUUID->"94605233-e430-4cc0-9403-e2d893949ac5"],
Cell[CellGroupData[{
Cell[8479, 213, 1354, 37, 70, "ObjectNameGrid",ExpressionUUID->"7d3af260-a680-48ac-9860-1fe3baaf58b1"],
Cell[9836, 252, 6110, 180, 70, "Usage",ExpressionUUID->"e26c1978-c343-4eba-a0a3-59b7d9dc0a82",
 CellID->1887563293]
}, Open  ]],
Cell[CellGroupData[{
Cell[15983, 437, 1850, 45, 70, "NotesSection",ExpressionUUID->"d234b39d-f91c-40a0-94a2-f4a071d54c1a",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->167656497],
Cell[17836, 484, 2570, 85, 70, "Notes",ExpressionUUID->"ede7cec5-bca9-4625-b3a8-418e60b5c234",
 CellID->915826333],
Cell[20409, 571, 3840, 135, 70, "Notes",ExpressionUUID->"f1f68c01-568e-4af1-b95e-0634d5829f1a",
 CellID->1931150725],
Cell[24252, 708, 4184, 144, 70, "Notes",ExpressionUUID->"926e43cc-e8e0-4d49-8d82-9bd1a45ff8f7",
 CellID->765642393],
Cell[28439, 854, 2929, 99, 70, "Notes",ExpressionUUID->"5323e73d-1769-4bd0-aee2-13cf647bd219",
 CellID->328467597],
Cell[31371, 955, 1755, 57, 70, "Notes",ExpressionUUID->"082579cf-be07-4bca-b98e-a2599177e806",
 CellID->740487261],
Cell[33129, 1014, 5375, 168, 70, "Notes",ExpressionUUID->"a6437913-2906-4ac6-8c30-d7dbcdd579a8",
 CellID->958672882],
Cell[38507, 1184, 1372, 38, 70, "Notes",ExpressionUUID->"27fb6a77-8e2d-47c9-aca6-7317c90e09cc",
 CellID->1795688728],
Cell[39882, 1224, 1951, 57, 70, "Notes",ExpressionUUID->"8ab547af-7127-45f5-b231-b8090c6da5ce",
 CellID->1190343635],
Cell[41836, 1283, 3542, 104, 70, "Notes",ExpressionUUID->"74840076-b96c-4f67-9a8a-8264c6540b0d",
 CellID->1535193593],
Cell[45381, 1389, 360, 8, 70, "Notes",ExpressionUUID->"6c60619d-a2c2-4fc7-8b50-5a4b7dfc16f0",
 CellID->227248759]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[45868, 1403, 1441, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"19c98329-8df2-4388-8e01-65a04f6a211b",
 CellTags->"PrimaryExamplesSection",
 CellID->304200215],
Cell[47312, 1443, 202, 3, 70, "Input",ExpressionUUID->"660ba185-6234-4ef5-8cdd-f8ea68742905",
 CellID->556413652],
Cell[CellGroupData[{
Cell[47539, 1450, 1419, 37, 70, "ExampleSection",ExpressionUUID->"baf9c22e-9929-4331-a041-96d1b3464f1c",
 CellID->1681933645],
Cell[48961, 1489, 204, 5, 70, "Input",ExpressionUUID->"b4461f29-95f9-47ba-b033-8a7509af3d09",
 CellID->672243474],
Cell[49168, 1496, 130, 1, 70, "ExampleText",ExpressionUUID->"936f56e8-ceba-4267-911c-fa7197abc30d",
 CellID->966966361],
Cell[49301, 1499, 219, 5, 70, "Input",ExpressionUUID->"e33b0565-6a9b-4998-aa8e-41a254f81eff",
 CellID->484600651],
Cell[CellGroupData[{
Cell[49545, 1508, 544, 16, 70, "Input",ExpressionUUID->"221fc653-d973-4fd9-bdb3-4547d2818059",
 CellID->1425151933],
Cell[50092, 1526, 254, 5, 70, "Output",ExpressionUUID->"27bff7bd-d1de-489b-a635-2bc87187612e",
 CellID->931228551],
Cell[50349, 1533, 126, 2, 70, "Output",ExpressionUUID->"59f7daa8-af82-42ec-a246-f19ef079bfa7",
 CellID->297437321]
}, Open  ]],
Cell[50490, 1538, 115, 1, 70, "ExampleText",ExpressionUUID->"1aba0d31-b304-4343-acd8-3a6fe02cf1d6",
 CellID->1540884431],
Cell[CellGroupData[{
Cell[50630, 1543, 303, 8, 70, "Input",ExpressionUUID->"7ece8eac-4606-4946-bc50-52a4630c2409",
 CellID->1098093014],
Cell[50936, 1553, 4501, 98, 70, "Output",ExpressionUUID->"1f0a9444-42e3-4523-8766-ba8cb8e31087",
 CellID->1834607478]
}, Open  ]],
Cell[55452, 1654, 114, 1, 70, "ExampleText",ExpressionUUID->"123bb641-9dfd-4353-9b94-58d7222e7d03",
 CellID->569269380],
Cell[CellGroupData[{
Cell[55591, 1659, 293, 8, 70, "Input",ExpressionUUID->"18e8ea64-436a-45a3-986f-e90730f1090f",
 CellID->1920729624],
Cell[55887, 1669, 144, 2, 70, "Output",ExpressionUUID->"02960a66-4e8b-43d8-aada-30d2128a906b",
 CellID->677679120]
}, Open  ]],
Cell[56046, 1674, 144, 1, 70, "ExampleText",ExpressionUUID->"aa929278-2ee8-4d92-8d9a-1692674da08a",
 CellID->1970697472],
Cell[CellGroupData[{
Cell[56215, 1679, 216, 5, 70, "Input",ExpressionUUID->"81a21891-b3da-46a6-b526-d11bca415a32",
 CellID->1579083477],
Cell[56434, 1686, 163, 3, 70, "Output",ExpressionUUID->"bb28500a-616e-49dc-8bbe-3162376fa6cd",
 CellID->1647189799]
}, Open  ]],
Cell[56612, 1692, 173, 3, 70, "ExampleText",ExpressionUUID->"5b862874-d43f-4aef-bf12-08b257e0f695",
 CellID->1682239748],
Cell[CellGroupData[{
Cell[56810, 1699, 294, 8, 70, "Input",ExpressionUUID->"002f4b76-a3d1-467b-8b2d-baf571f70918",
 CellID->487601425],
Cell[57107, 1709, 348, 9, 70, "Output",ExpressionUUID->"d163e2da-f886-438b-8f7c-85de5cb414cc",
 CellID->1107258316]
}, Open  ]],
Cell[57470, 1721, 189, 4, 70, "ExampleText",ExpressionUUID->"d73d2fe4-0316-4e7a-b001-0c6d0dad36ed",
 CellID->1831286845],
Cell[CellGroupData[{
Cell[57684, 1729, 392, 10, 70, "Input",ExpressionUUID->"e5e7d2f5-29eb-4c22-9a86-ce39a9ae8050",
 CellID->1520012391],
Cell[58079, 1741, 296, 7, 70, "Output",ExpressionUUID->"acca76bf-55e4-4e6e-ab0d-6bec2132dda6",
 CellID->1744715757],
Cell[58378, 1750, 901, 23, 70, "Output",ExpressionUUID->"bc0a097f-a8f7-4921-b59c-fc5f7877f01f",
 CellID->1696011761]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[59428, 1781, 1323, 35, 70, "ExampleSection",ExpressionUUID->"dc2d76bd-0b5c-4197-9f36-f9a64a253eb1",
 CellID->1703330544],
Cell[CellGroupData[{
Cell[60776, 1820, 1333, 35, 70, "ExampleSubsection",ExpressionUUID->"1c44a9ed-7190-453b-9c8e-567b0e29021f",
 CellID->1625224184],
Cell[62112, 1857, 223, 5, 70, "Input",ExpressionUUID->"2065e5d4-1254-41dc-9f7c-b1b15ab4c43c",
 CellID->866063270],
Cell[62338, 1864, 205, 5, 70, "Input",ExpressionUUID->"113b0529-7d86-4907-a915-bcaa1a92aa70",
 CellID->1774012929],
Cell[62546, 1871, 115, 1, 70, "ExampleText",ExpressionUUID->"2305ce9c-bf8b-4c4b-be21-62dae35862bf",
 CellID->1210812697],
Cell[CellGroupData[{
Cell[62686, 1876, 355, 9, 70, "Input",ExpressionUUID->"f46b1cfa-751a-4090-b2b8-d2233b8d6c00",
 CellID->93372207],
Cell[63044, 1887, 608, 19, 70, "Output",ExpressionUUID->"4723ad65-9ade-483d-b08b-c14ee4a8d8ee",
 CellID->1319220496],
Cell[63655, 1908, 144, 3, 70, "Output",ExpressionUUID->"68efc984-7ea4-4d8d-bb0c-62ba60649de9",
 CellID->1517704644]
}, Open  ]],
Cell[CellGroupData[{
Cell[63836, 1916, 277, 7, 70, "Input",ExpressionUUID->"a9de1bd9-214c-4cc1-850f-f19ce2e00071",
 CellID->1264054559],
Cell[64116, 1925, 5045, 110, 70, "Output",ExpressionUUID->"3ae5756f-6b83-44f4-a99f-6958dc338160",
 CellID->251192642]
}, Open  ]],
Cell[69176, 2038, 125, 1, 70, "ExampleText",ExpressionUUID->"c2704553-75f4-44a3-97ad-ddf11bd17078",
 CellID->645597649],
Cell[69304, 2041, 383, 11, 70, "Input",ExpressionUUID->"7379a66e-9de3-40ce-a353-76233b622999",
 CellID->1538010568],
Cell[CellGroupData[{
Cell[69712, 2056, 202, 4, 70, "Input",ExpressionUUID->"c3397b40-e4d7-47a6-9ec8-ded1b0c79bd0",
 CellID->2098320073],
Cell[69917, 2062, 172, 4, 70, "Output",ExpressionUUID->"b2d1351c-69d8-4ee4-b8a7-795ca32ef6d6",
 CellID->1989367739]
}, Open  ]],
Cell[CellGroupData[{
Cell[70126, 2071, 273, 7, 70, "Input",ExpressionUUID->"d8a8d895-f001-4da9-a2c9-78010e3fc88b",
 CellID->1894606122],
Cell[70402, 2080, 5789, 175, 70, "Output",ExpressionUUID->"e56854f3-cc26-42a2-be75-66a2064a3079",
 CellID->1130689230]
}, Open  ]],
Cell[CellGroupData[{
Cell[76228, 2260, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"d2d884e3-c66d-4961-bac8-a6db2da2c9fe",
 CellID->706601561],
Cell[76473, 2267, 206, 5, 70, "Input",ExpressionUUID->"c563f716-6648-4dc3-8b39-f5ab4c6ea889",
 CellID->349864653],
Cell[76682, 2274, 220, 5, 70, "Input",ExpressionUUID->"4fa12c22-e554-498a-8088-63fca59e1087",
 CellID->1138088487],
Cell[CellGroupData[{
Cell[76927, 2283, 571, 17, 70, "Input",ExpressionUUID->"43bdceb0-fc6e-4af1-ad61-754c761279d1",
 CellID->2147261437],
Cell[77501, 2302, 126, 2, 70, "Output",ExpressionUUID->"aed74f4a-a8dc-4bd7-8a32-ca81e0f8ce5a",
 CellID->411096307]
}, Open  ]],
Cell[CellGroupData[{
Cell[77664, 2309, 275, 7, 70, "Input",ExpressionUUID->"0b4a623c-0501-4622-9720-56b17ef21402",
 CellID->745752491],
Cell[77942, 2318, 8161, 160, 70, "Output",ExpressionUUID->"c992f745-5f54-4239-ad51-def4bd8e0168",
 CellID->840739350]
}, Open  ]],
Cell[86118, 2481, 306, 8, 70, "Input",ExpressionUUID->"8223e86d-8288-485b-aa98-0acd1486ef26",
 CellID->1123936882],
Cell[CellGroupData[{
Cell[86449, 2493, 342, 10, 70, "Input",ExpressionUUID->"70ba3b5d-d568-4fe3-90d4-42c2dd2017b0",
 CellID->1756899605],
Cell[86794, 2505, 116, 1, 70, "EchoTiming",ExpressionUUID->"dec68706-9f9f-4548-a543-4a416a4f73a0",
 CellID->2011341837]
}, Open  ]],
Cell[CellGroupData[{
Cell[86947, 2511, 305, 8, 70, "Input",ExpressionUUID->"344b72b9-6863-4cd6-aceb-e7cbf06282a0",
 CellID->1891135613],
Cell[87255, 2521, 5014, 119, 70, "Output",ExpressionUUID->"f58ca356-2300-4faa-ae1e-b64fc0247a90",
 CellID->1082167032]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[92433, 2649, 1334, 35, 70, "ExampleSubsection",ExpressionUUID->"5166e35b-1a06-449b-b944-22134de7fe8a",
 CellID->976509307],
Cell[93770, 2686, 204, 5, 70, "Input",ExpressionUUID->"a49e382f-d0cf-4fee-82af-de381fda14db",
 CellID->404620761],
Cell[93977, 2693, 220, 5, 70, "Input",ExpressionUUID->"7ff84a29-ad0e-410d-9a2f-d89ea7fd2b1c",
 CellID->1527903725],
Cell[94200, 2700, 114, 1, 70, "ExampleText",ExpressionUUID->"7dd6badf-9ee0-4170-b17e-3d285f5be003",
 CellID->645812421],
Cell[CellGroupData[{
Cell[94339, 2705, 498, 15, 70, "Input",ExpressionUUID->"a47c7ae7-f9c8-4f91-b39c-c522bc99f6ef",
 CellID->2015938896],
Cell[94840, 2722, 254, 5, 70, "Output",ExpressionUUID->"7708c37f-d8a6-44d2-a481-b1f8846f2333",
 CellID->942300381]
}, Open  ]],
Cell[CellGroupData[{
Cell[95131, 2732, 276, 7, 70, "Input",ExpressionUUID->"f47f3fb5-605d-4f05-bf21-68af472b392c",
 CellID->883939583],
Cell[95410, 2741, 4572, 100, 70, "Output",ExpressionUUID->"89a64b34-2fa8-433f-b546-a3033d8f2fb3",
 CellID->1698090489]
}, Open  ]],
Cell[CellGroupData[{
Cell[100019, 2846, 334, 9, 70, "Input",ExpressionUUID->"ab7aecf2-18d9-4615-b226-62629ca6104c",
 CellID->1288517488],
Cell[100356, 2857, 162, 3, 70, "Output",ExpressionUUID->"72566c36-f6b0-4056-97fa-bbb576e390c9",
 CellID->1896663640]
}, Open  ]],
Cell[100533, 2863, 149, 1, 70, "ExampleText",ExpressionUUID->"f67f45a4-882d-44fb-b0b4-431d2a010272",
 CellID->1991143895],
Cell[CellGroupData[{
Cell[100707, 2868, 299, 8, 70, "Input",ExpressionUUID->"a3478703-f698-43d2-a52a-fed07e1745ba",
 CellID->763019732],
Cell[101009, 2878, 720, 18, 70, "Output",ExpressionUUID->"e2ea5f51-e07b-41f7-ac66-242e13d19593",
 CellID->2126025059]
}, Open  ]],
Cell[101744, 2899, 199, 4, 70, "ExampleText",ExpressionUUID->"0fdff8a5-3a19-4784-9a28-20091f8d2a2b",
 CellID->2001042392],
Cell[CellGroupData[{
Cell[101968, 2907, 1034, 30, 70, "Input",ExpressionUUID->"f7a2a4f1-ba35-4ef4-a1a7-caf92727a41a",
 CellID->1840117499],
Cell[103005, 2939, 607, 19, 70, "Output",ExpressionUUID->"12244a54-29be-4bf0-8e93-0e8e022da6c9",
 CellID->122764180],
Cell[103615, 2960, 5046, 110, 70, "Output",ExpressionUUID->"437ed43f-2a11-4092-9632-176d446c77fa",
 CellID->1713272140],
Cell[108664, 3072, 533, 14, 70, "Output",ExpressionUUID->"1563938e-30e8-490d-8c7f-ece21a55f4ec",
 CellID->1504118004]
}, Open  ]],
Cell[CellGroupData[{
Cell[109234, 3091, 218, 5, 70, "Input",ExpressionUUID->"41dae87e-2a82-4d5d-82d4-02522dd79ffc",
 CellID->1440956291],
Cell[109455, 3098, 182, 4, 70, "Output",ExpressionUUID->"e74b54c0-d8b8-467d-9cce-89611f91b13e",
 CellID->1681284391]
}, Open  ]],
Cell[CellGroupData[{
Cell[109674, 3107, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"b3905385-b29b-4c9c-ad67-ab4e8dc11990",
 CellID->1767104397],
Cell[109920, 3114, 204, 5, 70, "Input",ExpressionUUID->"44a64c45-910b-486d-b62f-94e04629dab0",
 CellID->24762369],
Cell[110127, 3121, 220, 5, 70, "Input",ExpressionUUID->"8b18bc9c-bb1d-4514-9e6c-1fa69c3bfaf1",
 CellID->1716791912],
Cell[CellGroupData[{
Cell[110372, 3130, 570, 17, 70, "Input",ExpressionUUID->"e2657e06-db35-4ba4-8b32-7b39e40e7994",
 CellID->531383892],
Cell[110945, 3149, 126, 2, 70, "Output",ExpressionUUID->"6dccda8a-b319-4f5b-9f21-9ffed438b1d3",
 CellID->756932311]
}, Open  ]],
Cell[CellGroupData[{
Cell[111108, 3156, 276, 7, 70, "Input",ExpressionUUID->"fdf3b42c-8b0b-4e2f-a204-5967d9707e60",
 CellID->1736427641],
Cell[111387, 3165, 5813, 121, 70, "Output",ExpressionUUID->"84ab860a-31f8-4982-a8e9-b55943a467b0",
 CellID->68226149]
}, Open  ]],
Cell[117215, 3289, 305, 8, 70, "Input",ExpressionUUID->"2ac211ea-7a7b-4250-ad2a-a32e0b5be3c0",
 CellID->360339012],
Cell[CellGroupData[{
Cell[117545, 3301, 362, 10, 70, "Input",ExpressionUUID->"c95c58da-0673-443d-ae0c-8e1859053ba5",
 CellID->313890144],
Cell[117910, 3313, 116, 1, 70, "EchoTiming",ExpressionUUID->"fd330df4-eb86-4e04-8971-900984b81dc4",
 CellID->2068102392]
}, Open  ]],
Cell[CellGroupData[{
Cell[118063, 3319, 393, 11, 70, "Input",ExpressionUUID->"b6fd653c-f5b2-4894-87a4-5449b9d3e7cf",
 CellID->1745720274],
Cell[118459, 3332, 3863, 91, 70, "Output",ExpressionUUID->"73e468da-d4ef-45ee-81f9-7f75a1d3c719",
 CellID->1574075649]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[122486, 3432, 1340, 35, 70, "ExampleSubsection",ExpressionUUID->"e7d525bf-798a-418f-b06a-f700e4642dfe",
 CellID->38255620],
Cell[123829, 3469, 204, 5, 70, "Input",ExpressionUUID->"d19c33f3-5158-4978-a33a-8bcc5642296e",
 CellID->864594887],
Cell[124036, 3476, 220, 5, 70, "Input",ExpressionUUID->"64d0fc37-1d84-4145-aa8e-71233a070bf6",
 CellID->1371910207],
Cell[124259, 3483, 114, 1, 70, "ExampleText",ExpressionUUID->"93169191-0853-4d43-b5ee-9bfa42b76704",
 CellID->162931210],
Cell[CellGroupData[{
Cell[124398, 3488, 497, 15, 70, "Input",ExpressionUUID->"8c20f6ae-75b3-4d10-9584-928ffd96df94",
 CellID->343196545],
Cell[124898, 3505, 254, 5, 70, "Output",ExpressionUUID->"ee8c780c-737b-42a5-afe3-017095198f3c",
 CellID->638385350]
}, Open  ]],
Cell[CellGroupData[{
Cell[125189, 3515, 276, 7, 70, "Input",ExpressionUUID->"6aab54a1-6102-4acd-84fb-55eab20e296b",
 CellID->918428547],
Cell[125468, 3524, 4571, 100, 70, "Output",ExpressionUUID->"526757a1-5fe6-4c08-ae37-38e6fd052258",
 CellID->514277038]
}, Open  ]],
Cell[CellGroupData[{
Cell[130076, 3629, 334, 9, 70, "Input",ExpressionUUID->"903e99b7-8a58-4274-a260-c9aa44ad2b7a",
 CellID->1374222030],
Cell[130413, 3640, 162, 3, 70, "Output",ExpressionUUID->"ae393c04-210f-4b8b-9143-73bdcb32cb42",
 CellID->1979982138]
}, Open  ]],
Cell[130590, 3646, 192, 4, 70, "ExampleText",ExpressionUUID->"2e104cc7-b64c-40e3-8466-5024d23aa0ac",
 CellID->523581948],
Cell[130785, 3652, 296, 8, 70, "Input",ExpressionUUID->"7043a598-9a33-42d5-a9b6-07234d651a80",
 CellID->1601298277],
Cell[CellGroupData[{
Cell[131106, 3664, 165, 3, 70, "Input",ExpressionUUID->"494b6216-a4dd-42f8-815c-0c1377ea7d03",
 CellID->450237662],
Cell[131274, 3669, 538, 14, 70, "Output",ExpressionUUID->"6e641977-fe79-405f-a31e-36e329099a10",
 CellID->153199454]
}, Open  ]],
Cell[CellGroupData[{
Cell[131849, 3688, 200, 4, 70, "Input",ExpressionUUID->"bad41a2a-016b-42e0-bbe2-90f8eb9d5698",
 CellID->30274202],
Cell[132052, 3694, 1751, 40, 70, "Output",ExpressionUUID->"f82c4f8f-cf36-4e9c-aed4-b5622f8b1a2a",
 CellID->2137814272]
}, Open  ]],
Cell[CellGroupData[{
Cell[133840, 3739, 347, 9, 70, "Input",ExpressionUUID->"42240fc4-9ed9-453a-bb0c-fa6b2e12363d",
 CellID->429782927],
Cell[134190, 3750, 540, 14, 70, "Output",ExpressionUUID->"92570cb7-7a12-44db-b851-59e4b7d291a8",
 CellID->695571547]
}, Open  ]],
Cell[CellGroupData[{
Cell[134767, 3769, 217, 5, 70, "Input",ExpressionUUID->"5b4816e6-4ffc-4dd6-84b6-e6dcc88ef3d5",
 CellID->379226317],
Cell[134987, 3776, 183, 4, 70, "Output",ExpressionUUID->"cffb2bb4-8e97-42be-96d4-15ef30959ecb",
 CellID->1717499808]
}, Open  ]],
Cell[CellGroupData[{
Cell[135207, 3785, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"a1ede3e7-eb9f-4c04-90cc-e3244446eca1",
 CellID->512088563],
Cell[135452, 3792, 206, 5, 70, "Input",ExpressionUUID->"1ab23711-c0b5-49be-8b7a-da9e42f742cb",
 CellID->1705504812],
Cell[135661, 3799, 220, 5, 70, "Input",ExpressionUUID->"37a54033-8b4f-4b5f-9703-13eb29e52bc7",
 CellID->1955138775],
Cell[CellGroupData[{
Cell[135906, 3808, 571, 17, 70, "Input",ExpressionUUID->"a7fe4814-0624-47e4-b135-8665a192f236",
 CellID->1370108678],
Cell[136480, 3827, 127, 2, 70, "Output",ExpressionUUID->"a2b926ac-5b82-4da8-95a4-647a16fbea22",
 CellID->1691573729]
}, Open  ]],
Cell[CellGroupData[{
Cell[136644, 3834, 275, 7, 70, "Input",ExpressionUUID->"f99d377b-0c7b-4141-b0fe-9397c68547d7",
 CellID->42686767],
Cell[136922, 3843, 5815, 121, 70, "Output",ExpressionUUID->"84f1a5a0-a80e-4dc1-a759-668149490407",
 CellID->1891144317]
}, Open  ]],
Cell[142752, 3967, 306, 8, 70, "Input",ExpressionUUID->"c1f68a29-00e5-4ff4-bb63-8370455da052",
 CellID->1963149449],
Cell[CellGroupData[{
Cell[143083, 3979, 336, 9, 70, "Input",ExpressionUUID->"074e32c3-cb35-4c9b-b97f-0e3c20ecde13",
 CellID->714036835],
Cell[143422, 3990, 115, 1, 70, "EchoTiming",ExpressionUUID->"9de1e52b-cfde-414c-a4b2-e94531fbcadb",
 CellID->1704560219]
}, Open  ]],
Cell[CellGroupData[{
Cell[143574, 3996, 393, 11, 70, "Input",ExpressionUUID->"cd241861-4da8-477c-b0fd-4a65054054a1",
 CellID->1994254140],
Cell[143970, 4009, 3852, 82, 70, "Output",ExpressionUUID->"86fad324-a116-4b07-8d2d-34c20f9d6687",
 CellID->1111749753]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed]]]],
Cell[CellGroupData[{
Cell[147986, 4100, 1340, 35, 70, "ExampleSubsection",ExpressionUUID->"b8ca2ab8-3210-467a-8c90-cf1832642004",
 CellID->729870429],
Cell[149329, 4137, 220, 5, 70, "Input",ExpressionUUID->"44fba486-7541-45cb-b241-89ef9568e9f9",
 CellID->1888803347],
Cell[149552, 4144, 114, 1, 70, "ExampleText",ExpressionUUID->"7092563c-0089-4262-a8e3-e61aea2adba7",
 CellID->891018326],
Cell[CellGroupData[{
Cell[149691, 4149, 476, 14, 70, "Input",ExpressionUUID->"2620dd6a-5cb6-48ef-8876-6c48fe7eb53e",
 CellID->1014583075],
Cell[150170, 4165, 255, 5, 70, "Output",ExpressionUUID->"1db8d9a0-bd76-4f71-a9b4-648ce9f57bd5",
 CellID->2070369771]
}, Open  ]],
Cell[CellGroupData[{
Cell[150462, 4175, 221, 5, 70, "Input",ExpressionUUID->"f9679119-2921-4221-ab22-3ec0a2dc0721",
 CellID->599153438],
Cell[150686, 4182, 4497, 98, 70, "Output",ExpressionUUID->"85d28a9b-8e5d-4669-85d2-26c90eb9db1a",
 CellID->1027208856]
}, Open  ]],
Cell[155198, 4283, 138, 1, 70, "ExampleText",ExpressionUUID->"cd7d7dd5-ba9f-4f5c-8901-64314d617c7e",
 CellID->316224040],
Cell[CellGroupData[{
Cell[155361, 4288, 294, 8, 70, "Input",ExpressionUUID->"0a68311f-f0df-4b90-b403-f0faa5dc2469",
 CellID->2132222963],
Cell[155658, 4298, 144, 2, 70, "Output",ExpressionUUID->"4519039a-9498-4c7d-9839-99b1f0103906",
 CellID->678204559]
}, Open  ]],
Cell[CellGroupData[{
Cell[155839, 4305, 297, 8, 70, "Input",ExpressionUUID->"1a755b12-7899-44ee-ad58-4fff46ca9f55",
 CellID->818380663],
Cell[156139, 4315, 1675, 34, 70, "Output",ExpressionUUID->"5c39176d-48b5-4775-944f-b47ee5640a4d",
 CellID->1888308484]
}, Open  ]],
Cell[CellGroupData[{
Cell[157851, 4354, 246, 6, 70, "Input",ExpressionUUID->"482748c5-6f87-4c15-9627-ddadf5aede8d",
 CellID->580159733],
Cell[158100, 4362, 127, 2, 70, "Output",ExpressionUUID->"cde1b5a3-5867-48d8-8776-6b8e407a7e28",
 CellID->1287355222]
}, Open  ]],
Cell[158242, 4367, 253, 4, 70, "ExampleText",ExpressionUUID->"4f524ef8-65dc-4ff7-9f56-50cac2311009",
 CellID->1948001229],
Cell[CellGroupData[{
Cell[158520, 4375, 663, 18, 70, "Input",ExpressionUUID->"3fa465ed-a6c5-444c-9c2a-b8e8a79427dd",
 CellID->104260101],
Cell[159186, 4395, 607, 19, 70, "Output",ExpressionUUID->"459c2108-b21d-4df6-93dd-ab6cada5d4d7",
 CellID->681472629],
Cell[159796, 4416, 3004, 89, 70, "Output",ExpressionUUID->"dadfa3ba-1bfd-4469-bdcb-f7e07fb9bc68",
 CellID->980186152]
}, Open  ]],
Cell[CellGroupData[{
Cell[162837, 4510, 450, 13, 70, "Input",ExpressionUUID->"8da9f3ab-d64c-45a9-9156-53c7dc4120b3",
 CellID->447088284],
Cell[163290, 4525, 1462, 30, 70, "Output",ExpressionUUID->"60314cd7-ad6c-4653-bb5e-3d524e2a5238",
 CellID->641600527]
}, Open  ]],
Cell[164767, 4558, 132, 1, 70, "ExampleText",ExpressionUUID->"8a0419d5-336e-4ef7-8d1a-78699d741307",
 CellID->1592012364],
Cell[CellGroupData[{
Cell[164924, 4563, 253, 7, 70, "Input",ExpressionUUID->"29b67921-0724-4567-9abc-77f4c1d8ee3d",
 CellID->2109008775],
Cell[165180, 4572, 624, 18, 70, "Output",ExpressionUUID->"d10f2c3a-ce08-4485-92d4-d58ff18ee727",
 CellID->864665702]
}, Open  ]],
Cell[CellGroupData[{
Cell[165841, 4595, 241, 5, 70, "ExampleDelimiter",ExpressionUUID->"dcc8b56d-452e-4540-abe3-ff6d6c256fa5",
 CellID->16707169],
Cell[166085, 4602, 220, 5, 70, "Input",ExpressionUUID->"610a8e97-152f-4647-a808-069de1419602",
 CellID->1832672994],
Cell[166308, 4609, 200, 6, 70, "ExampleText",ExpressionUUID->"a96c8566-44d0-42b7-829d-13d58f133b14",
 CellID->377061237],
Cell[CellGroupData[{
Cell[166533, 4619, 818, 25, 70, "Input",ExpressionUUID->"f0f50d8a-e2b6-453f-af47-3df24e370b86",
 CellID->43967962],
Cell[167354, 4646, 126, 2, 70, "Output",ExpressionUUID->"5854f696-3d19-498e-b9ba-cab8426ada75",
 CellID->414614265],
Cell[167483, 4650, 127, 2, 70, "Output",ExpressionUUID->"7e65429b-a4f7-4502-95e7-d375d30887cb",
 CellID->1985000987],
Cell[167613, 4654, 242, 6, 70, "Output",ExpressionUUID->"661f1215-6634-49eb-9a3b-50d7bae766e7",
 CellID->753132364]
}, Open  ]],
Cell[CellGroupData[{
Cell[167892, 4665, 275, 7, 70, "Input",ExpressionUUID->"7ed62ac0-2a3d-4021-8536-df2d9cd8fa49",
 CellID->200293604],
Cell[168170, 4674, 4466, 97, 70, "Output",ExpressionUUID->"1ffa646b-c9fe-486f-a125-7c9ff55e2d26",
 CellID->627026330]
}, Open  ]],
Cell[172651, 4774, 139, 1, 70, "ExampleText",ExpressionUUID->"54ffc5b6-5757-4630-86c5-b789db0c7b15",
 CellID->1394539877],
Cell[CellGroupData[{
Cell[172815, 4779, 293, 8, 70, "Input",ExpressionUUID->"35995db3-c4b9-4d52-950d-9c5644f8e465",
 CellID->395189381],
Cell[173111, 4789, 144, 2, 70, "Output",ExpressionUUID->"b97fbc29-996c-46b8-b42b-6a49b997f905",
 CellID->729272481]
}, Open  ]],
Cell[CellGroupData[{
Cell[173292, 4796, 297, 8, 70, "Input",ExpressionUUID->"d6d0a979-8ead-4696-97c7-9c67433c2500",
 CellID->159787830],
Cell[173592, 4806, 1690, 38, 70, "Output",ExpressionUUID->"cd374772-5ac9-40f9-9944-cabd2ff4fe83",
 CellID->1193414738]
}, Open  ]],
Cell[CellGroupData[{
Cell[175319, 4849, 247, 6, 70, "Input",ExpressionUUID->"66407633-3428-435f-acc3-b677432f597f",
 CellID->1568514031],
Cell[175569, 4857, 126, 2, 70, "Output",ExpressionUUID->"38df79b3-7206-413b-bffd-bebc91b3bf71",
 CellID->224238586]
}, Open  ]],
Cell[175710, 4862, 252, 4, 70, "ExampleText",ExpressionUUID->"e2fd3d37-013b-48ec-9e35-f0a08c1b0a16",
 CellID->664134417],
Cell[CellGroupData[{
Cell[175987, 4870, 721, 20, 70, "Input",ExpressionUUID->"fb654c1d-8499-4316-94cc-f69f2633415a",
 CellID->1634633060],
Cell[176711, 4892, 608, 19, 70, "Output",ExpressionUUID->"6db72d67-1c35-42d5-9e0a-9a06494123e0",
 CellID->2091598064],
Cell[177322, 4913, 16167, 420, 70, "Output",ExpressionUUID->"c0add9b2-ed46-49de-ab52-5b9e5474d839",
 CellID->1328843905]
}, Open  ]],
Cell[CellGroupData[{
Cell[193526, 5338, 450, 13, 70, "Input",ExpressionUUID->"05b8f78e-d0ed-46b8-9519-0db4b2b3a3de",
 CellID->2087253347],
Cell[193979, 5353, 1462, 34, 70, "Output",ExpressionUUID->"28a7691e-12fe-4f6c-b2e7-cb0628871dc5",
 CellID->49582535]
}, Open  ]],
Cell[195456, 5390, 132, 1, 70, "ExampleText",ExpressionUUID->"431b2ed2-cbb2-4411-bc75-7c3f94e7bed5",
 CellID->1200015267],
Cell[CellGroupData[{
Cell[195613, 5395, 253, 7, 70, "Input",ExpressionUUID->"b86bf045-3111-44dd-8619-31d589c2dcc3",
 CellID->1637663492],
Cell[195869, 5404, 624, 18, 70, "Output",ExpressionUUID->"b9c768f4-1e9e-4d04-9307-aba2cf168dc9",
 CellID->110010709]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196542, 5428, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"88d7ce5b-5553-493a-b5e1-a95f6f9da6b5",
 CellID->486630493],
Cell[196787, 5435, 220, 5, 70, "Input",ExpressionUUID->"455e8843-214d-4293-bcbf-2f211752ac77",
 CellID->1180968075],
Cell[197010, 5442, 201, 6, 70, "ExampleText",ExpressionUUID->"2ab8db54-7e67-480a-87d2-2be86de8f8a2",
 CellID->1486570951],
Cell[CellGroupData[{
Cell[197236, 5452, 846, 26, 70, "Input",ExpressionUUID->"0cc60023-f7c8-451f-870c-4008f7942444",
 CellID->973224259],
Cell[198085, 5480, 127, 2, 70, "Output",ExpressionUUID->"0ef9ecf9-2a63-40f3-a155-ec6a94a0de24",
 CellID->2114049743],
Cell[198215, 5484, 127, 2, 70, "Output",ExpressionUUID->"1fb44516-40ef-4471-9144-ec5659e9cfda",
 CellID->717090986]
}, Open  ]],
Cell[CellGroupData[{
Cell[198379, 5491, 276, 7, 70, "Input",ExpressionUUID->"33cc6efe-1b23-469d-8811-6bdcba323ca5",
 CellID->1678153624],
Cell[198658, 5500, 5446, 113, 70, "Output",ExpressionUUID->"c9a0a4b9-d31a-470b-84fa-eaa0fd762073",
 CellID->469974738]
}, Open  ]],
Cell[204119, 5616, 139, 1, 70, "ExampleText",ExpressionUUID->"8501ea53-73e6-4f90-bdce-5bc408ba8b41",
 CellID->1858429471],
Cell[204261, 5619, 306, 8, 70, "Input",ExpressionUUID->"618d8ba8-07a6-487a-9a44-e623a5fb9b06",
 CellID->1621957129],
Cell[CellGroupData[{
Cell[204592, 5631, 361, 10, 70, "Input",ExpressionUUID->"d00bc487-070f-4978-8ef7-9f67bc7e0034",
 CellID->454622630],
Cell[204956, 5643, 115, 1, 70, "EchoTiming",ExpressionUUID->"8eda6687-5ea0-4b2d-8a6b-4a7cf11e997c",
 CellID->420567900]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "3"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[205347, 5656, 1329, 35, 70, "ExampleSection",ExpressionUUID->"47fd54b2-1d55-4cf6-9da0-3891b8b5f2bf",
 CellID->701469844],
Cell[206679, 5693, 249, 4, 70, "ExampleText",ExpressionUUID->"eb42648f-dcb4-4ac7-b576-8ee5ecf71843",
 CellID->411726774],
Cell[206931, 5699, 219, 5, 70, "Input",ExpressionUUID->"176f1d3f-cb61-4c5e-ae13-ee172da1c99c",
 CellID->271315786],
Cell[CellGroupData[{
Cell[207175, 5708, 480, 13, 70, "Input",ExpressionUUID->"f16832c3-f1be-4ab1-a57b-7eb795cf6232",
 CellID->1529848425],
Cell[207658, 5723, 129, 2, 70, "Output",ExpressionUUID->"6a06da3c-636f-4bce-bd6e-1b61c912f8f1",
 CellID->1116013023],
Cell[207790, 5727, 143, 3, 70, "Output",ExpressionUUID->"1e424c39-74f6-4640-8d2f-253996774575",
 CellID->708704663]
}, Open  ]],
Cell[207948, 5733, 144, 1, 70, "ExampleText",ExpressionUUID->"58e3898d-87a2-4eb2-a4f1-8b2f86da3a26",
 CellID->263062639],
Cell[CellGroupData[{
Cell[208117, 5738, 822, 25, 70, "Input",ExpressionUUID->"1fcdcc8f-d954-4af4-9eed-710c8f525b73",
 CellID->252225698],
Cell[208942, 5765, 127, 2, 70, "Output",ExpressionUUID->"a36d05ae-e1b9-4190-8d96-a17e11533792",
 CellID->487988694],
Cell[209072, 5769, 9362, 178, 70, "Output",ExpressionUUID->"22fa61b6-3fc3-473b-9cb2-4cf5a5d79956",
 CellID->385932165]
}, Open  ]],
Cell[218449, 5950, 177, 3, 70, "ExampleText",ExpressionUUID->"68f52232-236a-445e-b048-a040d50b4e83",
 CellID->783735018],
Cell[CellGroupData[{
Cell[218651, 5957, 302, 7, 70, "Input",ExpressionUUID->"abfca45d-41e0-4c72-ba54-213bbb32c605",
 CellID->553874063],
Cell[218956, 5966, 10600, 199, 70, "Output",ExpressionUUID->"06005d52-fee2-4d29-8cb9-ae77236161e7",
 CellID->961283215]
}, Open  ]],
Cell[229571, 6168, 159, 2, 70, "ExampleText",ExpressionUUID->"c91c1636-0a45-4e4c-a7e8-c4790630390d",
 CellID->789353421],
Cell[229733, 6172, 305, 8, 70, "Input",ExpressionUUID->"e8e6f089-31ef-4054-b4b4-cd33b2ab3793",
 CellID->210476177],
Cell[230041, 6182, 152, 1, 70, "ExampleText",ExpressionUUID->"7da432d6-46cb-4542-87ae-75b04ab711bc",
 CellID->1365905885],
Cell[CellGroupData[{
Cell[230218, 6187, 276, 7, 70, "Input",ExpressionUUID->"139fb11a-62b6-471d-bf82-1993a99366cb",
 CellID->192749570],
Cell[230497, 6196, 115, 1, 70, "EchoTiming",ExpressionUUID->"09ff4349-56f6-4202-9035-00c9baa94df9",
 CellID->767518124]
}, Open  ]],
Cell[230627, 6200, 147, 1, 70, "ExampleText",ExpressionUUID->"26716aa4-21e0-4df4-bd72-1250ddad0083",
 CellID->988870704],
Cell[CellGroupData[{
Cell[230799, 6205, 276, 7, 70, "Input",ExpressionUUID->"304750c1-c7af-44c0-8ff7-98f36c468902",
 CellID->482833766],
Cell[231078, 6214, 116, 1, 70, "EchoTiming",ExpressionUUID->"c9f81f8f-2243-41eb-836f-9b592d347217",
 CellID->1890326186]
}, Open  ]],
Cell[231209, 6218, 140, 1, 70, "ExampleText",ExpressionUUID->"820c5b4f-1a6b-43b4-94bd-5a7dfeecf4f7",
 CellID->603496782],
Cell[CellGroupData[{
Cell[231374, 6223, 280, 7, 70, "Input",ExpressionUUID->"b8cc46b2-721d-435a-a266-45cd7929851b",
 CellID->857850345],
Cell[231657, 6232, 143, 3, 70, "Output",ExpressionUUID->"c8798484-06f4-42b0-9d65-4a86368ab258",
 CellID->839134384]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[232042, 6244, 2487, 66, 70, "SeeAlsoSection",ExpressionUUID->"1edc74f6-8c95-41a1-b5bc-d386f907a148"],
Cell[234532, 6312, 2211, 56, 70, "TechNotesSection",ExpressionUUID->"8bdd245d-da88-44f0-9a1a-70cd8dd98dbe"],
Cell[236746, 6370, 2223, 55, 70, "MoreAboutSection",ExpressionUUID->"b8ba9caa-9bce-4b52-87e3-7e8afc54c5ca"],
Cell[238972, 6427, 8163, 213, 70, "RelatedLinksSection",ExpressionUUID->"410013d3-1be8-45be-b74b-4088235e7fa7"],
Cell[247138, 6642, 78, 0, 70, "FooterCell",ExpressionUUID->"a5d740fa-a2ee-4c64-b23b-1d1a49c4bbcc"]
}
]
*)

(* End of internal cache information *)
