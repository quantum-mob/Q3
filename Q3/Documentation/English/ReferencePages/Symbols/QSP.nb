(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    280096,       7308]
NotebookOptionsPosition[    247760,       6656]
NotebookOutlinePosition[    250661,       6724]
CellTagsIndexPosition[    250574,       6719]
WindowTitle->QSP
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "07bb8085-b7ae-4695-af80-fb8f8367c017"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "45dca802-9d9f-4eb2-b048-cc62867f1891"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "c2ccf63c-6703-44b3-84bb-389d14c1b2f5"]
         }],ExpressionUUID->"9207bb4c-0671-4c0c-bd7b-a399f3abe05f"],
         StripOnInput->False],{
        StyleBox["\"QSPFind\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/QSPFind"], 
         StyleBox["\"QSPConvert\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/QSPConvert"], 
         StyleBox[
          "\"ChebyshevCoefficients\"", "SeeAlsoRelated", StripOnInput -> 
           False] :> Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/ChebyshevCoefficients"], 
         StyleBox[
          "\"ChebyshevSeries\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ChebyshevSeries"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "dbb47aed-8370-456b-bef8-cacebdba4172"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "b32b15c7-3c51-43b4-8a5d-e4335983e19f"]
         }],ExpressionUUID->"ee89154d-91bd-4173-b55a-0c62db30d192"],
         StripOnInput->False],{
        "\"Quantum Signal Processing\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumSignalProcessing"], 
         "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumSpinSystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "387b94fe-585c-4075-92e0-8c1f65792af3"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "8b880098-5194-41af-9c5e-f79520837e10"]
         }],ExpressionUUID->"51d103a4-9c4d-40fc-ae75-b2ca40b45ebc"],
         StripOnInput->False],{
        "\"Quantum Signal Processing\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumSignalProcessing"], 
         "\"Quantum Linear System Problems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumLinearSystemProblems"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumSpinSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "87f0dc4b-eb20-4d9c-b79f-fb41636bc1ae"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "5c454d21-67ae-4804-a7fa-efe697dcc6f5"]
         }],ExpressionUUID->"636710fa-f484-4da1-91fd-f691f0e89bbc"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/QSP\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/QSP"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
QSP.html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, 
               Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/QSP") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "318c138e-8c69-4518-8957-9d304a921ebf"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "877bf4f9-4f43-4dd1-ac2c-a544cd764828"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"8cb39028-7b83-4b54-95a4-b44e5f881734"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"12e9bf4e-99c5-4465-9b77-52b10ab64aff"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "QSP", "ObjectName",ExpressionUUID->
      "a5a5c91e-fb8e-42e8-b274-ee018735d1b1"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"0faa4a1c-e654-4c7a-b0e3-e95f77538e48"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "7767b6fb-95bc-40b5-aea4-0151abf617f9"]
    }],ExpressionUUID->"49d2defe-dcbb-4034-8524-78dacb0ee083"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.0\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->LightDarkSwitched[
              RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "86c4f865-d3ad-4342-a768-c29acbb2c47b"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"ca0606b3-cffc-4840-9bd3-4a8c7486d053"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["0", "TR"]], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["1", "TR"]], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["2", "TR"]], ",", 
         StyleBox["\[Ellipsis]", "TR"], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["d", "TI"]]}], "}"}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "799002c2-8b57-4e4c-a2f6-d6186d278851"],
     "\[LineSeparator]represents the quantum signal processing of degree ",
     Cell[BoxData[
      StyleBox["d", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "3e780f69-ffe4-4285-8604-b09458d5ba35"],
     " with ",
     StyleBox["full",
      FontSlant->"Italic"],
     " phase vector ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["0", "TR"]], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["d", "TI"]]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "adaa2cc5-a45d-4696-943c-d99c33f43f76"],
     "."
    }],ExpressionUUID->"5af56e07-fce1-4f97-90a7-330b7e60ac42"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{"{", 
        RowBox[{
         StyleBox[
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], ",", 
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], ",", 
            StyleBox["\[Ellipsis]", "TR"]}], "}"}], "TI"], 
         StyleBox[",", "TI"], ",", 
         StyleBox["parity", "TI"]}], 
        StyleBox["}", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "f5713d5a-870a-4622-b1e0-17115c6d0754"],
     "\[LineSeparator]represents the ",
     StyleBox["symmetric",
      FontSlant->"Italic"],
     " quantum signal processing associated with ",
     StyleBox["reduced",
      FontSlant->"Italic"],
     " phase vector ",
     Cell[BoxData[
      RowBox[{
       RowBox[{
        StyleBox["{", "TI"], 
        RowBox[{
         RowBox[{
          StyleBox["{", "TI"], 
          RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], "TI"], 
           StyleBox[",", "TI"], 
           StyleBox[
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], "TI"], 
           StyleBox[",", "TI"], 
           StyleBox["\[Ellipsis]", "TR"]}], 
          StyleBox["}", "TI"]}], 
         StyleBox[",", "TI"], 
         StyleBox["parity", "TI"]}], 
        StyleBox["}", "TI"]}], 
       StyleBox[",", "TI"]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "62a88919-15aa-4807-b948-074bb7726884"],
     " where ",
     Cell[BoxData[
      RowBox[{
       StyleBox["parity", "TI"], "=", 
       RowBox[{"\[PlusMinus]", "1"}]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "ce68eefd-d47a-4306-a39d-0035d0bb0093"],
     " for even and odd, respectively."
    }],ExpressionUUID->"d1a210b9-7e7e-4b0d-ad94-ce8a6a550beb"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], ",", 
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], ",", 
            StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
          StyleBox["parity", "TI"]}], "}"}], ",", 
        StyleBox["post", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "d0467f95-0ff6-46cb-8a4e-9c7b1f92278a"],
     "\[LineSeparator]is equivalent to ",
     Cell[BoxData[
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          TemplateBox[{
            Cell[
             TextData["Composition"]], "paclet:ref/Composition"},
           "RefLink",
           BaseStyle->{"InlineFormula"}], "[", 
          RowBox[{
           StyleBox["post", "TI"], ",", 
           RowBox[{"QSP", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox[
                StyleBox["\[Phi]", "TR"], 
                StyleBox["0", "TR"]], ",", 
               SubscriptBox[
                StyleBox["\[Phi]", "TR"], 
                StyleBox["1", "TR"]], ",", 
               StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
             StyleBox["parity", "TI"]}]}]}]}], "}"}], "]"}], "]"}]], 
      "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "fab1bd31-8c75-448a-8e3f-7a606a72b849"],
     "."
    }],ExpressionUUID->"f5562272-92e9-44f5-a405-c4666dc084bf"]}
  }]], "Usage",
 CellID->1887563293,ExpressionUUID->"d96d2b09-1148-4770-9274-988b5aec0bc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[CurrentValue[
         EvaluationCell[], "CellGroupOpen"] =!= Closed, 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"ab9ae2fa-0af2-463b-830d-f0c99c904ec6"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"87fb4acf-f11f-4977-892a-67e2821823b3"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"61022dd4-f8ed-4f50-9a9e-bcf2eb1cd711"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"36a70332-8458-4bab-b534-e5910773cfed"]], \
"NotesSection",
 ShowGroupOpener->"Thumbnail",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->863078482,ExpressionUUID->"29865c37-1bad-441e-b22f-d224ece64f27"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   StyleBox["x", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "6913752c-4834-4fb7-91a0-7666a5f18ee3"],
 " returns the value ",
 Cell[BoxData[
  StyleBox["y", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "74702d00-1da8-4d12-a193-aaaa57cee6de"],
 " at ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "c790c198-a58a-41b9-86c7-055651d95a48"],
 " of the polynomial that ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   StyleBox["spec", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "c121c236-8fa8-43d5-bb96-9026a785c8ec"],
 " represents. ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      StyleBox["x", "TI"], 
      StyleBox["1", "TR"]], ",", 
     SubscriptBox[
      StyleBox["x", "TI"], 
      StyleBox["2", "TR"]], ",", 
     StyleBox["\[Ellipsis]", "TR"]}], "}"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "8e360df7-bf29-438c-a073-9fb90de0826a"],
 " returns the list ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     StyleBox["y", "TI"], 
     StyleBox["1", "TR"]], ",", 
    SubscriptBox[
     StyleBox["y", "TI"], 
     StyleBox["2", "TR"]], ",", 
    StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f8431c66-5d58-4e63-a483-6017396e468d"],
 " of values at ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["1", "TR"]], ",", 
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["2", "TR"]], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "35745056-ce18-4246-81c7-a09e01953f12"],
 "."
}], "Notes",
 CellID->915826333,ExpressionUUID->"e451d129-4335-4fc7-a7bf-1b460ccb5f61"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Gradient"]], "paclet:ref/Gradient"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    TemplateBox[{
      Cell[
       TextData["x"]], "paclet:QuantumMob/Q3/ref/x"},
     "RefLink",
     BaseStyle->{"InlineFormula", "TI"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "155f6baf-3a89-4739-8a32-ca9af025564a"],
 " returns ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     StyleBox["y", "TI"], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        StyleBox["g", "TI"], 
        StyleBox["1", "TR"]], ",", 
       SubscriptBox[
        StyleBox["g", "TI"], 
        StyleBox["2", "TR"]], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}]}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "251547aa-a366-4eea-91a6-e1e792a4cddf"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["i", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      TemplateBox[{
        Cell[
         TextData["x"]], "paclet:QuantumMob/Q3/ref/x"},
       "RefLink",
       BaseStyle->{"InlineFormula", "TI"}], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TI"], 
      StyleBox["i", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "6a2d00bf-1b8f-4bbc-a394-e50098efe4c2"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Gradient"]], "paclet:ref/Gradient"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "766f7d6d-c801-4eae-a3e5-338fd1f42dae"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["y", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["y", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["g", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e0e4445c-2069-488d-93b9-9158bbc1174f"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["i", "TI"]], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "bd9381ea-9835-4324-92fe-ccaef0ed7d27"],
 "."
}], "Notes",
 CellID->1931150725,ExpressionUUID->"6b88f153-000e-42df-9687-0437eb4d3b97"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Hessian"]], "paclet:ref/Hessian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    StyleBox["x", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "79b9cf94-9d7c-4b5d-92e3-d35a5b306e87"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    StyleBox["y", "TI"], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["h", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "9b701efa-0b3d-48f7-8691-a48b0eb63016"],
 " with the ",
 ButtonBox["Hessian matrix",
  BaseStyle->"Link",
  ButtonData->
   "paclet:tutorial/UnconstrainedOptimizationMethodsForLocalMinimization"],
 " ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["h", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      StyleBox["x", "TI"], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["i", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "01f3b551-f057-4024-863d-01b110ad20dd"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Hessian"]], "paclet:ref/Hessian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "fcae49ca-4ddc-4148-8221-e1de39945858"],
 " returns ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        StyleBox["y", "TI"], 
        StyleBox["1", "TR"]], ",", 
       SubscriptBox[
        StyleBox["y", "TI"], 
        StyleBox["2", "TR"]], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       StyleBox["\[Ellipsis]", "TR"], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\[Ellipsis]", "TR"], ",", 
         RowBox[{"{", 
          RowBox[{
           StyleBox["\[Ellipsis]", "TR"], ",", 
           SubscriptBox[
            StyleBox["h", "TI"], 
            StyleBox["ijk", "TI"]], ",", 
           StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
         StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}]}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0e8adc67-91c1-40d3-abbd-c0d1c986c9e9"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["h", "TI"], 
    StyleBox["ijk", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["i", "TI"]], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["k", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "b4879d50-5586-4872-a503-1c5123a0cf18"],
 ". "
}], "Notes",
 CellID->765642393,ExpressionUUID->"25cdedac-6c5c-4aff-b8e1-6b09f7f2fce0"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Jacobian"]], "paclet:ref/Jacobian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{"QSP", "[", 
    StyleBox["spec", "TI"], "]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "b02a4f31-1f3e-418e-a898-e9d5de647043"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["0", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["g", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "596bbda1-d72b-4f5c-9025-2a1e257ce5df"],
 ", where ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["0", "TR"]], ",", 
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["1", "TR"]], ",", 
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["2", "TR"]], ",", 
    StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "9a98c33a-d338-48d8-9cfb-ef9204cc49b5"],
 " is the Chebyshev expansion coefficients of ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   StyleBox["x", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "e8b6393f-5943-4158-8fa5-8384a97ceda3"],
 " and ",
 Cell[BoxData[
  StyleBox["g", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "8ff7cdd7-1920-4008-af9e-6c6cc21c0f0e"],
 " is the Jacobian matrix, ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     SubscriptBox[
      StyleBox["c", "TI"], 
      StyleBox["i", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2040bd74-c825-4c55-bf36-d042473f2cd1"],
 "."
}], "Notes",
 CellID->328467597,ExpressionUUID->"b78eb5bf-a415-4925-b9dc-3f4bbf850ec1"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Matrix"]], "paclet:QuantumMob/Q3/ref/Matrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", " ", 
    StyleBox["x", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2a5afe18-56d4-4be0-bf18-82caae006a57"],
 " returns the QSP unitary matrix at ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "63f156d9-ae67-4709-b368-daf8af6acdb4"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Matrix"]], "paclet:QuantumMob/Q3/ref/Matrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "9b5b5881-7378-4a81-b9e5-65183da8062f"],
 " returns the list of matrices at ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["1", "TR"]], ",", 
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["2", "TR"]], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f022c7ad-6702-440b-987b-3ccc4eadad5b"],
 "."
}], "Notes",
 CellID->740487261,ExpressionUUID->"09671d9c-75d3-4a64-8318-481bc196197b"],

Cell[TextData[{
 "The quantum signal processing (QSP) of degree ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "c239dae7-8cba-4944-9f20-5e5b42c7ecba"],
 " with phases ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{":", 
     OverscriptBox["\[Phi]", "\[RightVector]"]}]}], TraditionalForm]],
  ExpressionUUID->"01394d85-b362-4beb-b06f-2cdb8829589a"],
 " is a parameterized representation of a polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "3aa3c888-bf9d-4d34-b708-c660fb2e39a9"],
 " of degree ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "afe9ed65-6bbc-43e0-bc2e-1592da761ec6"],
 " and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"d", " ", "mod", " ", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"fbadd4a5-5657-4d9f-8b60-6ba4f312e66e"],
 ", through the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Times]", "2"}], TraditionalForm]],ExpressionUUID->
  "c25e41bc-924e-4fa1-a3d6-91193be30eb8"],
 " unitary matrix\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], ":=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
        SubscriptBox["\[Phi]", "0"], "Z"}]], 
      RowBox[{
       UnderoverscriptBox["\[CapitalPi]", 
        RowBox[{"k", "=", "1"}], "d"], "[", 
       RowBox[{
        RowBox[{"W", "(", "x", ")"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          SubscriptBox["\[Phi]", "k"], "Z"}]]}], "]"}]}], "=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"P", "(", "x", ")"}], 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          RowBox[{"Q", "(", "x", ")"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["x", "2"]}]]}]},
        {
         RowBox[{"\[VeryThinSpace]", 
          RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
           RowBox[{
            SuperscriptBox["Q", "*"], "(", "x", ")"}], 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["x", "2"]}]]}]}], 
         RowBox[{
          SuperscriptBox["P", "*"], "(", "x", ")"}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "57959097-dee7-4557-b2d9-4d2b25ea026f"],
 " ,\nwhere ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "10c63c74-66d2-4a54-b1ce-c66b75dc6574"],
 " is the Pauli-",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "df5c0477-65b6-46b3-88ea-a0d14d680cbe"],
 " matrix,\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        RowBox[{"-", "1"}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "2369073b-0c26-4cf2-9469-59c678355f61"],
 " ,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "e8f69ac4-5981-4e1b-8dfd-284f335da6e9"],
 " is a rotation in the Bloch space around the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "fb54ab8c-0f84-46f0-9bd5-197d75adbfef"],
 "-axis by angle ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"arccos", "(", "x", ")"}]}], TraditionalForm]],ExpressionUUID->
  "5fe10ee8-a14f-4576-bdb4-1ac77dc10cf1"],
 ",\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"W", "(", "x", ")"}], ":=", 
    RowBox[{"(", GridBox[{
       {"x", 
        RowBox[{"\[ImaginaryI]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}]]}]},
       {
        RowBox[{"\[ImaginaryI]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}]]}], "x"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "84330d3f-2207-4554-9edb-3e0a8163978f"],
 " ,\nand ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "8f7ee9fa-3eb8-4666-a9df-6cdd63856c2b"],
 " is a polynomial of degree ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", "-", "1"}], TraditionalForm]],ExpressionUUID->
  "69243232-3acf-4515-8e99-7a1042904b19"],
 " and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"d", "-", 
       RowBox[{"1", " ", "mod", " ", "2"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"cdef2bfd-8646-4a19-8a2b-03df5cb19898"],
 " satisfying the unitarity constraint \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{"P", "(", "x", ")"}], "\[RightBracketingBar]"}], "2"], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"\[LeftBracketingBar]", 
        RowBox[{"Q", "(", "x", ")"}], "\[RightBracketingBar]"}], "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "2"]}], ")"}]}]}], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"0a614291-69dd-4c9d-9cd1-3bd9b6e2612c"],
 "."
}], "Notes",
 CellID->958672882,ExpressionUUID->"de449bb6-657a-49e2-9b83-d2c580c0a682"],

Cell[TextData[{
 "Quantum signal processing is ",
 StyleBox["symmetric",
  FontSlant->"Italic"],
 " if the phase vector is symmetric ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "d"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "1"], ",", 
      SubscriptBox["\[Phi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"de412edb-8d70-49dc-be2b-e679750a437e"],
 " under list reversal. A symmetric quantum signal processing has its \
characteristic unitary matrix symmetric, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"], "T"], "(", "x", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"419eb10b-57a2-4735-84c2-8d21c4dbfa0b"],
 ", and polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "bfbe04ef-8c6c-4010-b9bb-ba494ccb6f6f"],
 " is real. See Theorem 2 in Dong et al. (2021)."
}], "Notes",
 CellID->1795688728,ExpressionUUID->"d4f5777e-af6e-4b77-ae24-af288d76ce05"],

Cell[TextData[{
 "A quantum signal processing is said to be ",
 StyleBox["symmetric",
  FontSlant->"Italic"],
 " if the phase vector is symmetric; that is, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "d"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "1"], ",", 
      SubscriptBox["\[Phi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"e729726e-0074-4d45-b7a2-4f0984571e97"],
 ", which leaves only ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "d"], ":=", 
    RowBox[{"\[LeftCeiling]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "+", "1"}], ")"}], "/", "2"}], "\[RightCeiling]"}]}], 
   TraditionalForm]],ExpressionUUID->"f1fb9eff-dfbb-4464-adb4-7d9da399cc41"],
 " independent phase variables. A symmetric quantum signal processing has its \
characteristic unitary matrix symmetric, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"], "T"], "(", "x", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"7ca41f89-adfc-4b72-8f1b-3d1eb020377e"],
 ", and the polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "6d66fa80-f443-4ebe-ae12-858bcc9518f5"],
 " is real ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["(Dong, Meng, Whaley and Lin, 2021: Theorem 2)"]], 
    "https://doi.org/10.1103/PhysRevA.103.042419"},
   "WebLink",
   BaseStyle->{"Notes"}]],ExpressionUUID->
  "8973c60e-2256-403d-979a-6676d676d270"],
 "."
}], "Notes",
 CellID->1190343635,ExpressionUUID->"d6e95ccd-7f77-46f5-96af-2e80f44ed485"],

Cell[TextData[{
 "Given a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " set ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[CurlyPhi]", "0"], ",", 
     SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
     SubscriptBox["\[CurlyPhi]", 
      RowBox[{
       SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], TraditionalForm]],
  ExpressionUUID->"90f53ffd-3594-4d49-83d2-04003ac9da97"],
 " of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "d"], TraditionalForm]],ExpressionUUID->
  "26820d73-cb05-45a0-95b2-4cc7f4f7ce0f"],
 " independent phase variables and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "=", 
    RowBox[{"\[PlusMinus]", "1"}]}], TraditionalForm]],ExpressionUUID->
  "61e8cf38-54b4-4b48-9f00-92e953ed511a"],
 " for a symmetric quantum signal processing, one can recover the ",
 StyleBox["full vector",
  FontSlant->"Italic"],
 " of phase variables as follows:\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[CurlyPhi]", "0"], ",", 
        SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{
          SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
      RowBox[{"+", "1"}]}], "}"}], "\[RightTeeArrow]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[CurlyPhi]", "0"], ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
      RowBox[{"2", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{
         SubscriptBox["n", "d"], "-", "1"}]]}], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", 
      SubscriptBox["\[CurlyPhi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"678e4f46-9963-4c23-a35c-7ad1d2fbfa1b"],
 " (notice the factor of 2 for technical convenience),\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[CurlyPhi]", "0"], ",", 
        SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{
          SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], "\[RightTeeArrow]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[CurlyPhi]", "0"], ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{
        SubscriptBox["n", "d"], "-", "1"}]], ",", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{
        SubscriptBox["n", "d"], "-", "1"}]], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", 
      SubscriptBox["\[CurlyPhi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"535e39aa-367a-4885-81ef-373caf2ca96c"],
 ".\nThe pair ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[CurlyPhi]", "0"], ",", 
       SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{
         SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
     RowBox[{"p", "=", 
      RowBox[{"\[PlusMinus]", "1"}]}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"e206b746-f8c1-4f67-8531-c23555b075bf"],
 " is called the ",
 StyleBox["reduced phase vector",
  FontSlant->"Italic"],
 " to be distinguished from the ",
 StyleBox["full phase vector",
  FontSlant->"Italic"],
 "."
}], "Notes",
 CellID->1535193593,ExpressionUUID->"11353ab1-a5aa-4fb6-9e91-cdea1d1f01f5"],

Cell[TextData[{
 "The correspondence between the reduced and full phase vector is closely \
related to that between the ",
 ButtonBox["reduced and full Chebyshev coefficients",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/ChebyshevCoefficients"],
 " list."
}], "Notes",
 CellID->227248759,ExpressionUUID->"6aa0838f-d3a8-48a1-a83a-70da3dd322fa"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"a81d0496-29fc-4af3-b78d-41fea3fc9be8"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"1acea867-bc9b-4a1b-ab29-c8dd5a09a814"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(11)", "ExampleCount",ExpressionUUID->
  "8968abcb-3b5d-43c4-b770-3a8c8ed2eb4c"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->1655495136,ExpressionUUID->"bea5f83a-a0d6-4b19-9fbe-174b199bfb16"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->556413652,ExpressionUUID->"2c6db76c-6694-48e6-8aa0-984c047178ac"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"a82f889f-bc19-45bf-a3a6-f3fea9c4e009"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"561ab59d-38ed-42b0-919e-f37b2d519514"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "fd5f06d0-ca8c-4cc7-84ff-6788ea6a9000"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1108620220,ExpressionUUID->"d6b629a6-3dc6-4ada-90c2-d3dec79ea3c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->672243474,ExpressionUUID->"26193668-5e1a-45d6-9db9-e6c4f4ebb71a"],

Cell["Set the phase vector and parity:", "ExampleText",
 CellID->966966361,ExpressionUUID->"c1a81fd5-b438-406d-8fd5-420fb4683873"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->484600651,ExpressionUUID->"a0629659-1e19-4b2f-b4af-c7e14e00ecf9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "$n"}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1425151933,ExpressionUUID->"7e56a47c-a8db-4954-87f5-aad072021413"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->931228551,ExpressionUUID->"b49f7ae1-7bb5-450a-b35a-d08d0d45bc22"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->297437321,ExpressionUUID->"77f312f0-e80d-45fb-af15-95becd77a98b"]
}, Open  ]],

Cell["Construct a QSP:", "ExampleText",
 CellID->1540884431,ExpressionUUID->"fcb5fb98-63ca-47cd-a361-d09a27ad943f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$phi", ",", "$parity"}], "}"}], ",", "Re"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1098093014,ExpressionUUID->"35429930-6284-429f-ac25-40f9499d58a8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Re", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, 1}, Re],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1834607478,ExpressionUUID->"2065665f-46a6-4dae-ac64-5c50d7f0b5ea"]
}, Open  ]],

Cell["Pick a position:", "ExampleText",
 CellID->569269380,ExpressionUUID->"2dd92c7f-c82e-4620-8f25-40e70eadfed3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1920729624,ExpressionUUID->"32d4b158-ea0f-48db-994e-8cf0f1240bf8"],

Cell[BoxData["0.7222657925379279`"], "Output",
 CellLabel->"Out[5]=",
 CellID->677679120,ExpressionUUID->"88cc7510-458e-42ea-b0e1-0f2ddb9ab932"]
}, Open  ]],

Cell["Calculate the QSP polynomial at the position:", "ExampleText",
 CellID->1970697472,ExpressionUUID->"4f7f552b-fef6-4494-800c-75f54a48642e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"y", "=", 
  RowBox[{"qsp", "[", "x", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1579083477,ExpressionUUID->"08e7a380-358a-4db3-8f46-696fa8e53b07"],

Cell[BoxData[
 RowBox[{"-", "0.24370437270790196`"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1647189799,ExpressionUUID->"cf3c9a30-f853-4040-a119-2e2df1446610"]
}, Open  ]],

Cell["\<\
Calculate the gradient with respect to the phases at the position:\
\>", "ExampleText",
 CellID->1682239748,ExpressionUUID->"8c7853bf-9cb6-4031-a168-0d0254c3ec55"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"f", ",", "df"}], "}"}], "=", 
  RowBox[{"Gradient", "[", 
   RowBox[{"qsp", ",", "x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->487601425,ExpressionUUID->"7d7ad420-c3b8-4d90-8771-de1e2884b77f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.24370437270790196`"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.857436120097687`", ",", 
     RowBox[{"-", "0.4001420997668619`"}], ",", "1.8237858602958372`"}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1107258316,ExpressionUUID->"4988a5b8-cc86-4985-8316-a5f6afe9569b"]
}, Open  ]],

Cell["\<\
Calculate the Jacobian matrix between the Chebyshev coefficients and the \
phases:\
\>", "ExampleText",
 CellID->1831286845,ExpressionUUID->"985a1ff9-e075-4437-962b-689a4f91da33"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cff", ",", "jac"}], "}"}], "=", 
   RowBox[{"Jacobian", "[", "qsp", "]"}]}], 
  ";"}], "\[IndentingNewLine]", "cff", "\[IndentingNewLine]", 
 RowBox[{"jac", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1520012391,ExpressionUUID->"28282656-50a8-4567-ab3b-5d32ca26e822"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.24101003885481828`"}], ",", 
   RowBox[{"-", "0.3673208690650344`"}], ",", 
   RowBox[{"-", "0.013273647029757533`"}]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1744715757,ExpressionUUID->"cb0d5136-a4fc-4b1c-989d-43ace9b5538c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.8218192361642762`", 
      RowBox[{"-", "0.343954026056741`"}], "1.8049624494329581`"},
     {
      RowBox[{"-", "0.21025955307636573`"}], "1.7769219637646367`", 
      RowBox[{"-", "0.21025955307636565`"}]},
     {
      RowBox[{"-", "0.044897272399639726`"}], "0.1336944729803754`", 
      RowBox[{"-", "0.02804048566832132`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->1696011761,ExpressionUUID->"14a0417d-8833-42e8-a262-e871f3104dcf"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"52ba4a94-5367-4492-a04b-487cffaf8bd2"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"960c7f55-ab5d-415e-afb9-97ad4a184eff"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(9)", "ExampleCount",ExpressionUUID->
  "f1ae2fc8-5fcd-44d9-a9ee-59496a4877a2"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1703330544,ExpressionUUID->"498d9621-55b6-4759-a83f-b5d5b5e0acf2"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"daa9bf5a-7d52-471b-8017-8c90cd1463c8"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"05c04f0b-c64b-4d4a-89e8-48bafb0b88a8"],
 "Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "38f715c9-fd88-43dd-9217-5b9ed01de6be"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1625224184,ExpressionUUID->"5e2f89df-42c3-4865-9814-573b354c43ce"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->866063270,ExpressionUUID->"2687b572-9a79-49e5-9651-9f577febf143"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1774012929,ExpressionUUID->"2558492b-478f-45a1-a6e3-104d9da72cd9"],

Cell["Construct a QSP:", "ExampleText",
 CellID->1210812697,ExpressionUUID->"22748576-a7d2-479a-a1fa-94b875eba9ec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"-", "1"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->93372207,ExpressionUUID->"50040da1-051a-4f36-bfac-b478555a1a50"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1319220496,ExpressionUUID->"e965ddf6-3562-4553-9167-3bb8355ac0ac"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1517704644,ExpressionUUID->"e77967bb-17b7-44a8-9627-8cdafd2a8494"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1264054559,ExpressionUUID->"c6ba407d-f80a-493b-a4dd-072c52ede775"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][0]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][1]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][2]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{
     $CellContext`\[Phi][0], 
     $CellContext`\[Phi][1], 
     $CellContext`\[Phi][2]}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->251192642,ExpressionUUID->"4bc1d2dd-85f6-433c-baf7-411a2809edbe"]
}, Open  ]],

Cell["Get the QSP unitary matrix:", "ExampleText",
 CellID->645597649,ExpressionUUID->"6c8afae1-3465-42a0-8689-961cb1ae1558"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", 
     RowBox[{"$qsp", ",", "x"}], "]"}], "//", "Simplify"}]}], ";"}]}], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1538010568,ExpressionUUID->"16c00151-7466-4f7d-a81d-5704922c4894"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "mat", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->2098320073,ExpressionUUID->"3cdd784d-31c5-46ec-9740-825a9d09ebd5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2"}], "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1989367739,ExpressionUUID->"956157f9-c828-426a-a2de-0b03b4a5610f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1894606122,ExpressionUUID->"1849f303-76b0-48fa-8bcb-40e8a5db3bc5"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][0]]}], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][0]]}], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"2", "-", 
    RowBox[{"6", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "4"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["x", "4"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["x", "4"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][2]]}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "4"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][2]]}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "4"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "+", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1130689230,ExpressionUUID->"cd9ed6ec-5c07-4d5b-a98d-57e626bfa549"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "5d2d3286-8706-4edb-9aee-34b497853d7e"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->706601561,ExpressionUUID->"4671f191-6666-4c28-874b-2770b7e88a64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "300"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->349864653,ExpressionUUID->"da83af4c-6d63-469b-bcee-4123d2d1a440"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1138088487,ExpressionUUID->"7163b7fe-f0eb-4249-bb6e-bb5bc6e742e9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2147261437,ExpressionUUID->"271c9ded-b1a6-45eb-bd12-45548ad534dd"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->411096307,ExpressionUUID->"1839780d-7d8d-441d-bcdd-2618329309d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->745752491,ExpressionUUID->"6a175fd2-e3a7-44fa-a93b-d49cb5bd8f36"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["598", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["598", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}], ",", 
                    "1.3526643903415392`", ",", 
                    RowBox[{"-", "1.4612784342395748`"}], ",", 
                    "1.2380248457091423`", ",", 
                    RowBox[{"-", "0.4898389003561131`"}], ",", 
                    "0.14740162462925227`", ",", "0.09519214138002281`", ",", 
                    
                    RowBox[{"-", "0.054377159963480484`"}], ",", 
                    "1.1366917987048297`", ",", 
                    RowBox[{"-", "0.9313131184913914`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwNlHk4FIgfhyORNqQiORapZCv6OVKsvjocKYpkQ0vrWMeGhGVRSM6IlNpI
kSuhZnNkXd9xJvc5xs0MZtxzmMOm/Prn8/f7PO/zfpSdfKxcBTZt2nTk+9Qf
+mSTRmKA2d2EP2Q2OCCtfslLUHAYaQQfz8gcDkQ+IN11/Y2HuRc3VNidbEjJ
vnomynYCewOf3BYfrwdX/R0/RjpUQEqy00erwULU22tZQ9VgQZqW6WHLjiV8
uD1CbUN8CUW1C5iRmt04fVVW+LXkDNwbjo+bL6fhQsslWmB3N0zkmug8qpwH
a8k3qzYWPXCbuUaXUeLj76wgCuECH+65udx2slvGyVZ9ueqUWXQhCBACpJrx
nX1wYHElA27OG88RK9lwUs7XZMiCCUo7CqWnmhfB91vKDxI7+aB7Rz61VJWD
vF/1QkYsRlG8devEcAcJAxbpcdJHV2Et+3XAC8lVbM162/5pnQq+qaEJURFv
IG7MRWfFbwgPOVXaFzcOg7tfzsSZvFVUzXdPl0+ZgQzNp8syylR4O0b4WGfH
xMyvRYzdQSwI9kj13yVUD/xLStV/ivRh8JecKq1tFDyo786ZVGRDd7Rwk0E1
E1RvfYs/R1/FP4/pN6rqTuH+D4kFn0rmcC28N3s6fQV73IOuGAQ/Q0pnQkd6
5RRsa4nmyV1phog2mbsZEyTICxtb6/t3GqUK5msX4thg+OvxVupOFpha54zt
ezGLDME0ge3ZLNTMPufw5e4/UKR1YO8KIxoNU9eOnFX47lXO42EpcREXPC+0
7w1vxNiW221C5CXME6+2okTP4KzUG7/E+hkQG5NV6IkeRJnowFpv4RV4/8zH
4cKzRtxHdvQ6pTCJhYTroiV+PHxUlq7DUuZhRXVhuxtpAXKH0w7ZhnIRtdxP
GSWxUI1AvKsRvIix9n9Vu40uY/G15Nequmw0udPuaMNZwpZ9ynUsKRbej9oS
b2uwCkfJzob+Sav47Hhj3ckJBqZYBJ6PTiWjDQgudE3wQaJQTb/rHgve+sfB
fTU+5uWPxG9NHIX5YjFx+4RJ5MsWcALUl7Eb5xIMfp7GSCvjEVfneXAoLup7
Wc8AXu5c7JuPC6h02PDy89xmeP2UWVLl1Y3esQ4FFLN23CounS2XwMSo6UsL
NN9x8CiNrbEw7waJ8J+NK80ZGPJVPDqf3of/aHm0JNhPgfADhbhX5kxcP3et
Yb55Be9n8dts3qejypaygg7+PP5wvspVWZ0GRx0c9jnDLAZ/Ipoqj3GhRKFZ
sIHBQqXPUuenVKZQaETLnrI0AuSVL/mE09NoSCvl0BXGgbM40NO80IMhMFqc
1jmDdcodl+tMZ0B9bctDXaU1SPzYH2UdNQXeGe03Xx5goKG3XsVOi2LQT9f7
NyOEhCZ/h4xn1M6D6LrZ5oblKSyQat7e3cQAQ/7vAplfeODp5fn5zulRbCde
KqFe4UAa81EffWwayp2y3vkVcDCmrK/Ozb4N371SPLNGmIGyjMS9UpYd0OVA
JtxPaQPPm7tyPJR6QFhSbXm3ZDXk6E7d2PP6MbZed3F66tILqbbuDvSaSbBL
VBUuOtOLrayBRHwygMK39IXvLU+jUN9TgzDbFUg8EXTW/Or3H+ouOzbyfgAu
2jA7NbRpQFQ0Esu3mgYxdXK96CYOOlbwlzvMVvGgpmnm+uZerHmVnHC4cBpf
dv9G7yqYROclwv+Gg+fAMLJk9EnNEjTW3q+OTZ3BL/GfB2fXiCAhWKSlu5MC
VNmTcRpPuGgpkvnK6xgbRZPI1rblXMzvECU4JJbhYg9/h3w0E/U8fmS7DFFA
5VsM+WsOGw8UCb+92D2NQ8Jy6dM+JExWDCdGxDdAjmd53ovwKXgs4J/r1jCP
ZEN/y5Kwj5Blm3ZeS4EPMscVp+V7h2DX9twsr6AlFOI854c9aIXxEMmBk7fb
0CdPJVixgoMBHcG0AA0ScN1jF9+psFHBKNwr98wwWuuqzVvLNGGHgJeK0d46
CKvVoSuqsWGQrMrvFuKiH56PHPRig4cE5TFXsx92NB3vKOfOQqGdgXBeDBvC
Huvd+yWqDYqeKZeu7mZBNKlKWr10EkX/8W/wMVlEindtRgExD8uMjhhn5XwA
AkVB202RAx67ZbozD/GwNuXEwPsaKoQn3rTcKJwDl4KIVwFjC2hxeVuGOoGD
lD+S/wJbPpoohZ4KWB+B+VCjqiaRRtgos7bxfcAGMn299eTVGVya1SQyBukg
oWbRLD5Rj+knRq3Tmum45k3Z5Tg8C0LPTcwzfqeiyHwtX4nMhtjFHyqSA4bB
9eH+Bp8RDtwM83ouwJnDkOIch3ajHtwWEdbyU3Yd/H3f3MXvBhf2+3oqv/Nn
wPDpTVEXBhlYNpGhU2oyhETDxfYPMSUglslRqHQpg3qJKu9yDSJYX9TWcvPm
4eYg4/xNbe04c6q4LkuVCybJKXnlzDnc+skiW3CcBKOeic13nJlgPjGpdsWL
ga9rBF5eE+ejjbimTVt9HdwT+EVe1IoDZn7UwPadTOh0awkINfgM8lpXCZ/7
m1COmK32oY+JVTdUJtqvDyNb4KiLO5kGonfVZM0ONGKJ7793fiasYlx2K3cl
igX7n14uZngzkHc7Kix/sh+r1doc5zZmwerdQlHl4TfoYH99pwV1GOrPOh0p
V29CMXTmUmiTmPflva72gQ7wRhObKmSg0ygmCfXO4ektpqRdjr2gQHTl7Tam
AjVyz7yu7BoenQ3iMU70o7jjV20F9VXc520M4bRW6JX671yK5hz8tBBACvu2
CO3N5x4Uha7iqHickO4VOuT220UOeTHA8tLBW64tLMht3dx3aywYhLKCyb4X
eNjUpalu10/53r/3GLWLibrBZWLp1FXUkKES9p1kgbzsRrylyAraVoXpeMaM
g3TKVnWpdRr+8TKiU21LGbz48ED3WRIHK46TktpmF1Dal8ntd1pAw3LXXoU5
Jugw8mKNf6uDQtP0ymQRPlA+h3CmaXQcWt6yZ5THh13v3WI8aA9RrF2Pb2Qx
DrGcv14GakzAcx29iOA/6Thu5hwbJ14Md0wlo/acZkG8mF4T7xMDD1kPhNqI
LEPd+aSPxzpH4L8iO2/LJSbYnNCOubHMBaGu6JnL3/kPjoWYX5Plgk/bI8tM
Bx4mBFBTXpD64f+rcCbi
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->840739350,ExpressionUUID->"ba781fbe-8eb6-42f2-8d1b-eab48caa5ad2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1123936882,ExpressionUUID->"b1f05605-75ad-40ee-9708-1d58d06028d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{"mat", "=", 
    RowBox[{
     RowBox[{"Matrix", "[", 
      RowBox[{"qsp", ",", "xx"}], "]"}], "//", "Chop"}]}], "]"}], 
  ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1756899605,ExpressionUUID->"87257ca3-06a6-4fc3-91f4-cc1f98724d2f"],

Cell[BoxData["3.233398`"], "EchoTiming",
 CellID->2011341837,ExpressionUUID->"2c82639c-eefe-42ec-b7a5-a2677e92a841"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{";;", 
     RowBox[{"UpTo", "[", "5", "]"}]}], "]"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1891135613,ExpressionUUID->"5ca9b518-66b1-4ec0-8354-bd347bb34ef8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.41304947785649526`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.9009462388461923`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13298873467846836`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13298873467846836`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.41304947785649526`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9009462388461923`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.40210871608186455`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.8289773173643352`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.38872250738340675`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.38872250738340675`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.40210871608186455`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.8289773173643352`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.37940300195479393`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6914742399323504`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6147493290908808`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6147493290908808`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.37940300195479393`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6914742399323504`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.34346525252963295`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5006799352962871`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7945761276910034`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7945761276910034`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.34346525252963295`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5006799352962871`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.292524460382402`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.27344836431088027`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9163271425280948`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9163271425280948`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.292524460382402`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.27344836431088027`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1082167032,ExpressionUUID->"dd0d243e-524f-4442-a674-ec129a8212b5"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"0e10915a-0876-43e2-950c-dbcfdb681ce6"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"566b339b-aeb3-4c79-8561-b80519109c6c"],
 "Gradient",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "2d41156f-0079-4108-8e1b-0f7d800ccdf4"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->976509307,ExpressionUUID->"d2fec3eb-496e-4525-8f58-b611d4899368"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->404620761,ExpressionUUID->"11e485f5-d1a6-424a-9c83-8f9d09e218c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1527903725,ExpressionUUID->"d0843a2b-1d96-4623-a088-109b2778a93f"],

Cell["Construct a QSP:", "ExampleText",
 CellID->645812421,ExpressionUUID->"4b64011d-a27e-4b50-8f7b-19cf75ce6897"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$parity", "=", 
   RowBox[{"-", "1"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2015938896,ExpressionUUID->"6502ea10-188f-4767-b9f5-d499b62e39c2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->942300381,ExpressionUUID->"37a0646d-3943-4bfc-ac4f-25aed435a811"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->883939583,ExpressionUUID->"646e8b08-0fff-44f9-9c7b-856a6766d636"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1698090489,ExpressionUUID->"1672f956-98c7-4448-9ce9-d9576996edf3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "*", "Pi"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1288517488,ExpressionUUID->"a56bbad0-3634-4c63-b297-a46b868f164e"],

Cell[BoxData[
 RowBox[{"-", "0.9763034131218359`"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1896663640,ExpressionUUID->"35fe6fe4-5d3c-4c3c-b5f2-c2d16e5551fc"]
}, Open  ]],

Cell["Calculate the gradient with respect to the phases:", "ExampleText",
 CellID->1991143895,ExpressionUUID->"f68821ad-0579-433b-bd81-7d72d1a80087"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "grd"}], "}"}], "=", 
  RowBox[{"Gradient", "[", 
   RowBox[{"$qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->763019732,ExpressionUUID->"24e0b6fd-63e7-45e6-84a8-7b2cf14b8ad5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5353834564485714`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.7698389667404558`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.5396779334809116`"}], "+", 
      RowBox[{"1.0707669128971429`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.1427205960590454`"}], "+", 
      RowBox[{"1.1199214833381976`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.5585409731606994`"}], "+", 
      RowBox[{"1.1631045338923487`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->2126025059,ExpressionUUID->"d3447a97-41ff-4ace-a791-e0f7cf6e1057"]
}, Open  ]],

Cell["\<\
For comparison, calculate the gradient by taking the partial derivative of \
the polynomial:\
\>", "ExampleText",
 CellID->2001042392,ExpressionUUID->"06107888-f3ec-43ad-afd4-95e232560edc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"tmp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"var", ",", "$parity"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"tmp", ",", "$x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mint", "=", 
  RowBox[{"ReplaceAll", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"mat", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
      "var"}], ",", 
    RowBox[{"Thread", "[", 
     RowBox[{"var", "->", "$phi"}], "]"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1840117499,ExpressionUUID->"58c9a045-8746-4772-9624-547e19cc6c87"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->122764180,ExpressionUUID->"f7af90c5-29c4-47ce-95bf-e61050f0683d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][0]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][1]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][2]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{
     $CellContext`\[Phi][0], 
     $CellContext`\[Phi][1], 
     $CellContext`\[Phi][2]}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[7]=",
 CellID->1713272140,ExpressionUUID->"1affde8d-c3de-4cae-b4c1-f2ea2a745bfe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1.5396779334809114`"}], "+", 
    RowBox[{"1.070766912897143`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.1427205960590452`"}], "+", 
    RowBox[{"1.1199214833381976`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.5585409731606994`"}], "+", 
    RowBox[{"1.163104533892349`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",\

 CellLabel->"Out[7]=",
 CellID->1504118004,ExpressionUUID->"de41b532-f12f-4bc0-bac0-95fc83e218b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"grd", "-", "mint"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1440956291,ExpressionUUID->"d96404ed-ea8e-4a6e-a31e-c45ccf4a5dc6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1681284391,ExpressionUUID->"09d6395e-c0ed-4f6b-91fc-c704cdb75959"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "2ddac24e-d832-40f8-ac1e-b36d4ab807cf"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1767104397,ExpressionUUID->"66db23f4-bbdf-44c2-acc2-f1c0c7b1e2dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "75"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->24762369,ExpressionUUID->"fc084e16-b239-4bf2-85c1-fdeafd9652fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1716791912,ExpressionUUID->"624a85b7-3cc1-40ef-882f-8ef47e250890"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->531383892,ExpressionUUID->"6f8563e8-19c4-45e0-b94a-4f225b13e672"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->756932311,ExpressionUUID->"78267807-1af5-4b9e-9328-56cc8aa69a89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1736427641,ExpressionUUID->"795dc488-469b-4d19-864b-697fc66420e5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}], ",", 
                    "1.3526643903415392`", ",", 
                    RowBox[{"-", "1.4612784342395748`"}], ",", 
                    "1.2380248457091423`", ",", 
                    RowBox[{"-", "0.4898389003561131`"}], ",", 
                    "0.14740162462925227`", ",", "0.09519214138002281`", ",", 
                    
                    RowBox[{"-", "0.054377159963480484`"}], ",", 
                    "1.1366917987048297`", ",", 
                    RowBox[{"-", "0.9313131184913914`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwBZQKa/SFib1JlAQAAAEsAAADCKMdWmtbwP0p+jGsY//U/Fi5PbQIC2r/n
sG9qg6T1P4OL1n5lYfe/pUz/I/PO8z+So1VChVnfv9J3lHIO3sI/ZTsQHoNe
uD+SkGK3UtervzoZUb3jL/I/mjNIK1HN7b+ODIEp/w7tvwk0qfGDMtC/5FUa
BqIR5T+C2oqJ6rbnv+vIT+d30NA/36VHNZG66j9UEaj0Vk7RP3Lx+egYIPi/
ZvJ44rBL+D+CZ2RyYlruv+DKOxu8kua/ZLABsHUVxr+uW3p3rbrwP2zqRunA
uvM/ORtxR9lO8T8gEKsW4cbsP3H+kgsPEvg/N30clbQn9b/3XTp7207cvw7K
CN/azda/dezoiRYt9D/5o6J1nBH0v8qhqszH/OM/cZV8jIWBqD+J3WQ173PZ
vyhiulutxNo/aHOk30Km9L8np2ibHJLlP50ylu4YIeM/qt2wt8Fa8b+g/azw
FHjyP3pplXQTBMI/+E8gvHYH0796+6S7MwrivyY7aPXgH/M/0IYGxT288T8n
cP6KROj0v3YwO8QnN+G/JLKNqcez6b/5gNKj5Jvvv9FoeFM9epe/4s6MzZu6
4T8KyIb3G1PGP4HLGH6d39Y/pn/d+dO55L8Vqeq+64nzP0BdNsrjEvI/SFSk
3SKc5r/wApoBDKPyvzKjRF77frE/rDMlGe/whr9AlfksQx33v6UbaY60wOy/
62pLzBmAxL+IyHLLBNjtv6YOvFLihuW/5hWoc43C5T8N3Rod0YbXvxiGd75u
Bu8/r5dvXkuXxL8i2F9tPh3gv6uwXAmzc/e/kbWbNfIh97+B20y2
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->68226149,ExpressionUUID->"4176097c-75c6-4e16-9f2a-612771892c0a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->360339012,ExpressionUUID->"5fd19029-33f9-45b0-84c2-6f2c929fc352"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "grd"}], "}"}], "=", 
    RowBox[{"Gradient", "[", 
     RowBox[{"qsp", ",", "xx"}], "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->313890144,ExpressionUUID->"23c0261a-17ff-4a2e-9460-25e42897b57d"],

Cell[BoxData["3.717617`"], "EchoTiming",
 CellID->2068102392,ExpressionUUID->"d164dcf2-b871-467c-a582-f9ce3bc9f534"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"grd", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}]}], "]"}], "]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1745720274,ExpressionUUID->"ebec4c49-55b2-4ff8-b28e-75a55a7b9915"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.7476389859037255`"}], "-", 
       RowBox[{"1.8549919901494456`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7473570833739234`"}], "-", 
       RowBox[{"1.854511253993559`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7476311402464512`"}], "-", 
       RowBox[{"1.8548800313569078`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7474607507190953`"}], "-", 
       RowBox[{"1.8541124285330457`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7476640804515604`"}], "-", 
       RowBox[{"1.8548863655653032`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "1.1004875287985585`"}], "-", 
       RowBox[{"1.6474893571595834`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.0834148233755785`"}], "-", 
       RowBox[{"1.6354010387015196`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1023876760416726`"}], "-", 
       RowBox[{"1.6406420392908385`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1122746752722539`"}], "-", 
       RowBox[{"1.6244668938133753`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1080253858253157`"}], "-", 
       RowBox[{"1.6451215910664816`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "1.3014746354907474`"}], "-", 
       RowBox[{"1.1469265457634368`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.2040922402867065`"}], "-", 
       RowBox[{"1.0872502071587873`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.3139470933624264`"}], "-", 
       RowBox[{"1.107495020904424`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.3840643821703353`"}], "-", 
       RowBox[{"1.0323028098261218`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.348504541066721`"}], "-", 
       RowBox[{"1.1357391412601059`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.8562582701892734`"}], "-", 
       RowBox[{"0.35880738687972713`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6227110349620539`"}], "-", 
       RowBox[{"0.22231680213551014`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.8886847224903233`"}], "-", 
       RowBox[{"0.26259450857795885`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.0775423665275032`"}], "-", 
       RowBox[{"0.09644535286280301`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.9750036487299802`"}], "-", 
       RowBox[{"0.33403684281824614`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.20660887202633704`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.47432126528052676`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5165754627639698`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6512799143036041`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.15855787021389672`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6067052136748909`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1334255361462097`"}], "+", 
       RowBox[{"0.8140379610326964`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.03712124367306434`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.5051798963591223`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1574075649,ExpressionUUID->"0ec6e7c6-7497-494a-880b-4d4f4fe6a67f"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"63bcc896-7991-4e9e-a1be-31c2cf675422"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"c70ad0e2-1c2b-489c-a700-225080108c0a"],
 "Jacobian Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "595c0c2d-c99e-4bda-80dc-4f2f2f5cff9d"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->38255620,ExpressionUUID->"e5290ba9-23ab-41c4-86fc-03544ef414a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->864594887,ExpressionUUID->"8a342f33-67de-4602-9be5-3e500e9c72ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1371910207,ExpressionUUID->"156d3c33-f9e4-4151-b77e-289034b5cbf0"],

Cell["Construct a QSP:", "ExampleText",
 CellID->162931210,ExpressionUUID->"63a1f118-7a8c-4865-bac2-ae3836c7a102"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$parity", "=", 
   RowBox[{"-", "1"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->343196545,ExpressionUUID->"e2f90372-d6f4-4236-999f-fb0fd2b1486a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->638385350,ExpressionUUID->"4829233c-ef89-477b-aa81-3e805fea64be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->918428547,ExpressionUUID->"9bebcc27-8b63-4d37-8ec9-0e1fada55f4f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->514277038,ExpressionUUID->"e95c63c2-0206-448a-bd6e-3ff40581ce00"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "*", "Pi"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1374222030,ExpressionUUID->"123af4af-0299-4673-a918-8b25b9bc4f21"],

Cell[BoxData[
 RowBox[{"-", "0.9763034131218359`"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1979982138,ExpressionUUID->"942ed6f7-7e2b-4be0-a2d4-cd2ed60e6053"]
}, Open  ]],

Cell["\<\
Calculate the Jacobian matrix the Chebyshev coefficients with respect to the \
phases:\
\>", "ExampleText",
 CellID->523581948,ExpressionUUID->"c75179a0-1ca9-40d8-b756-af83a723825b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cff", ",", "jac"}], "}"}], "=", 
   RowBox[{"Jacobian", "[", "$qsp", "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1601298277,ExpressionUUID->"b2f8faa5-e2d4-40f7-b590-6e235b2f332e"],

Cell[CellGroupData[{

Cell[BoxData["cff"], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->450237662,ExpressionUUID->"eac711d2-0d8b-41a6-961d-4f5d2d4ccebe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.2602311260461158`"}], "-", 
    RowBox[{"0.7611134399038367`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3450831485647699`"}], "-", 
    RowBox[{"0.04976818742283829`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.01629028033872486`"}], "+", 
    RowBox[{"0.02755042198253971`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->153199454,ExpressionUUID->"fbedca38-e43d-4339-a5fc-f6b9c1d77285"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "jac", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->30274202,ExpressionUUID->"c1a03644-b03d-4de0-949f-4b92ea1dbcac"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1.522226879807674`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5204622520922315`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.25097163688678475`"}], "-", 
       RowBox[{"1.233177156841502`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6998326728947746`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9233108263695126`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.09953637484567669`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6901662971295398`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6535555211756574`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2674606711686963`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11915001937234378`"}], "-", 
       RowBox[{"0.3436095762973714`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.05510084396507945`"}], "-", 
       RowBox[{"0.032580560677449785`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.164078526399397`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2774926242264156`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.014020242834160321`"}], "+", 
       RowBox[{"0.023711292767662852`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->2137814272,ExpressionUUID->"b86e34ed-d3b3-4fd5-932b-613e022ace74"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"ChebyshevCoefficients", "[", 
   RowBox[{"$qsp", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$n", "+", "1"}], ",", "$parity"}], "}"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->429782927,ExpressionUUID->"dc0a84f8-adbf-42cc-95fd-2e87d61976d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.26023112604611576`"}], "-", 
    RowBox[{"0.7611134399038368`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3450831485647699`"}], "-", 
    RowBox[{"0.0497681874228383`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.016290280338724896`"}], "+", 
    RowBox[{"0.027550421982539767`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->695571547,ExpressionUUID->"8410ce12-0091-42b1-8241-43df5e827f8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cff", "-", "new"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->379226317,ExpressionUUID->"40e35a47-f37d-44fd-a6ff-964df0a3651d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[10]=",
 CellID->1717499808,ExpressionUUID->"267cc461-158e-4c04-8e7b-164012214e81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "519190d7-f011-4595-b441-fc718880f087"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->512088563,ExpressionUUID->"df3a2bf1-10c4-4138-97e7-069f76609fd7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "75"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1705504812,ExpressionUUID->"435dd71f-e3c5-4002-a090-114ecfad736a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1955138775,ExpressionUUID->"d88bb6d4-f549-4ffa-9fdb-44000f333ad1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1370108678,ExpressionUUID->"88fb567d-c1f6-482e-ac7c-87cafa3caf59"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->1691573729,ExpressionUUID->"9e39327a-82b1-47ab-a56c-8cc2aa2a8f17"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->42686767,ExpressionUUID->"5f56d12a-a5df-4bf8-aeed-8f28ca05ad6e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}], ",", 
                    "1.3526643903415392`", ",", 
                    RowBox[{"-", "1.4612784342395748`"}], ",", 
                    "1.2380248457091423`", ",", 
                    RowBox[{"-", "0.4898389003561131`"}], ",", 
                    "0.14740162462925227`", ",", "0.09519214138002281`", ",", 
                    
                    RowBox[{"-", "0.054377159963480484`"}], ",", 
                    "1.1366917987048297`", ",", 
                    RowBox[{"-", "0.9313131184913914`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwBZQKa/SFib1JlAQAAAEsAAADCKMdWmtbwP0p+jGsY//U/Fi5PbQIC2r/n
sG9qg6T1P4OL1n5lYfe/pUz/I/PO8z+So1VChVnfv9J3lHIO3sI/ZTsQHoNe
uD+SkGK3UtervzoZUb3jL/I/mjNIK1HN7b+ODIEp/w7tvwk0qfGDMtC/5FUa
BqIR5T+C2oqJ6rbnv+vIT+d30NA/36VHNZG66j9UEaj0Vk7RP3Lx+egYIPi/
ZvJ44rBL+D+CZ2RyYlruv+DKOxu8kua/ZLABsHUVxr+uW3p3rbrwP2zqRunA
uvM/ORtxR9lO8T8gEKsW4cbsP3H+kgsPEvg/N30clbQn9b/3XTp7207cvw7K
CN/azda/dezoiRYt9D/5o6J1nBH0v8qhqszH/OM/cZV8jIWBqD+J3WQ173PZ
vyhiulutxNo/aHOk30Km9L8np2ibHJLlP50ylu4YIeM/qt2wt8Fa8b+g/azw
FHjyP3pplXQTBMI/+E8gvHYH0796+6S7MwrivyY7aPXgH/M/0IYGxT288T8n
cP6KROj0v3YwO8QnN+G/JLKNqcez6b/5gNKj5Jvvv9FoeFM9epe/4s6MzZu6
4T8KyIb3G1PGP4HLGH6d39Y/pn/d+dO55L8Vqeq+64nzP0BdNsrjEvI/SFSk
3SKc5r/wApoBDKPyvzKjRF77frE/rDMlGe/whr9AlfksQx33v6UbaY60wOy/
62pLzBmAxL+IyHLLBNjtv6YOvFLihuW/5hWoc43C5T8N3Rod0YbXvxiGd75u
Bu8/r5dvXkuXxL8i2F9tPh3gv6uwXAmzc/e/kbWbNfIh97+B20y2
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1891144317,ExpressionUUID->"30946801-a031-4322-baac-cad3c905e1ef"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1963149449,ExpressionUUID->"c8b3e2d1-0ec1-4cde-8aee-693093a845e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cff", ",", "jac"}], "}"}], "=", 
    RowBox[{"Jacobian", "[", "$qsp", "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->714036835,ExpressionUUID->"179a3cac-9611-48d5-896d-ecf4ffcaf6c8"],

Cell[BoxData["3.69898`"], "EchoTiming",
 CellID->1704560219,ExpressionUUID->"7f1f2cf0-26c5-4cfe-951a-84c57ad01589"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"jac", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}]}], "]"}], "]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1994254140,ExpressionUUID->"cd72f68b-b1b3-4a35-a24b-2e4aab67199a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.10732694992958547`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3336074545476465`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0959251305470628`"}], "-", 
       RowBox[{"0.3523320370881716`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09741941203650925`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3368060087131481`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.20049921569346335`"}], "-", 
       RowBox[{"0.3971878392532484`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0839563448552769`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.32210909366168267`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.2880009589529222`"}], "-", 
       RowBox[{"0.761516990036452`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.23978592500425494`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.267312488420766`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.29731226353769974`"}], "-", 
       RowBox[{"0.7303137156920703`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1196883237734089`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2455167748427231`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.30583680464939306`"}], "-", 
       RowBox[{"0.7717872255700957`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.14352211980460244`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.20437003455206015`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2681270244161595`"}], "-", 
       RowBox[{"0.6071438444022214`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1518650547910353`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2478239005759883`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.008613609028514836`"}], "-", 
       RowBox[{"0.5970044400906976`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.21398620985314284`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.19304174933267`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.04828327650186211`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2774318040665258`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6158256914964385`"}], "-", 
       RowBox[{"0.32820786915146943`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.10792020842075108`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.4112214719482929`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0909602809008879`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2475035377862933`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1874135632946686`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.23988211090836487`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.6902568892430568`"}], "-", 
       RowBox[{"0.04706157499515176`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.10268272577955069`"}], "-", 
       RowBox[{"0.02540614540743067`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6300579863497657`"}], "-", 
       RowBox[{"0.027793534825155765`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.060432975775725796`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13038596081342144`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6876932784479498`"}], "-", 
       RowBox[{"0.026995819308095994`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1111749753,ExpressionUUID->"5459de54-ed5a-43ce-b24e-4230b6b1dd2c"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "3"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"00aa088f-8134-443c-858d-dc59c4777f68"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"bcd451e2-b3ac-4358-b5ee-a74ff82303b6"],
 "Hessian Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "00c1f9c2-61eb-400d-aa3a-dae9b2947d78"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->729870429,ExpressionUUID->"35260baa-ddd8-4817-8df5-c861532f750d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1888803347,ExpressionUUID->"82579151-7c32-47be-a8c1-fab0666fc900"],

Cell["Construct a QSP:", "ExampleText",
 CellID->891018326,ExpressionUUID->"50bee4f6-18a5-477b-90ad-bf725ff15181"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$d", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$full", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{"$d", "+", "1"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1014583075,ExpressionUUID->"e9244c25-eca4-4ca5-bcb5-426535ad2902"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->2070369771,ExpressionUUID->"779f6f80-102a-4821-a5e3-62a9d9d5b636"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", "$full", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->599153438,ExpressionUUID->"45eb213a-fce0-4b21-980d-5c4c2ea23ed9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{1.0523932828678402`, 
   1.3747791482091025`, -0.4063726489518741}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1027208856,ExpressionUUID->"7baca7e5-b356-4258-a3b0-c6d9bd3776e1"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP:", "ExampleText",
 CellID->316224040,ExpressionUUID->"e4496a22-d533-4f37-86dd-f73d3a65882b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->2132222963,ExpressionUUID->"8746311f-bafa-4e93-95f9-e94be3441ca1"],

Cell[BoxData["0.8611328962689639`"], "Output",
 CellLabel->"Out[4]=",
 CellID->678204559,ExpressionUUID->"09f57235-e4c3-4297-b67c-a3b4fb5bd805"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "hss"}], "}"}], "=", 
  RowBox[{"Hessian", "[", 
   RowBox[{"qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->818380663,ExpressionUUID->"e7f20388-706e-4eeb-9718-dc7d2799ff4c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.5153551899367812`"}], "+", 
    RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1888308484,ExpressionUUID->"5714e9c0-39c0-4c44-8720-ae1eb3b9c1a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"val", "-", 
   RowBox[{"qsp", "[", "$x", "]"}]}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->580159733,ExpressionUUID->"4dbb8bbc-7684-47de-8771-9f2d19ce26bd"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->1287355222,ExpressionUUID->"3c807b9f-fa33-4b39-97ba-6bfff21b9d58"]
}, Open  ]],

Cell["\<\
To verify the above result, let us calculate the Hessian matrix by explicitly \
taking the partial derivative with respect to the phase variables:\
\>", "ExampleText",
 CellID->1948001229,ExpressionUUID->"903f166f-78d7-483b-b9fa-a9fa4c93bdfd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$d"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun", "=", 
   RowBox[{"QSP", "[", "var", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{
   RowBox[{"Matrix", "[", 
    RowBox[{"fun", ",", "$x"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->104260101,ExpressionUUID->"95f2fd20-6d75-4b0d-ab0d-db37001f6c1a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->681472629,ExpressionUUID->"78df5d36-976a-421e-b345-450ec9b81b88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.2584501349634259`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][0]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.7415498650365742`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][0]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     InterpretationBox[
      SubscriptBox["\[Phi]", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`\[Phi][2]], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][2]], "]"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->980186152,ExpressionUUID->"2457dd32-56e5-4924-987c-bc56f65a574b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"fun", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", "var", ",", 
     "var"}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"var", "->", "$full"}], "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->447088284,ExpressionUUID->"83cbf6a7-d836-4b43-b87d-f63a2e5a3225"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->641600527,ExpressionUUID->"76244018-b0be-4fe4-ab4a-73b3eb1805a4"]
}, Open  ]],

Cell["Finally, compare the two results:", "ExampleText",
 CellID->1592012364,ExpressionUUID->"5038d434-044f-48fb-9bc3-203c298ecb1a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hss", "-", "new"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->2109008775,ExpressionUUID->"3bc487b5-629d-40b6-a192-b922612e9387"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->864665702,ExpressionUUID->"c809637d-66f6-46ac-b4bc-b4067698a13e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "1350e15d-7fe9-471f-9cad-8993aa7f0662"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->16707169,ExpressionUUID->"d67b05c0-1501-41d6-8ca0-c01f3c78b6f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1832672994,ExpressionUUID->"45d60a4a-7dcb-4302-9364-aac3c2d466d1"],

Cell[TextData[{
 "Construct a QSP with a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " phase vector:"
}], "ExampleText",
 CellID->377061237,ExpressionUUID->"0bca8656-a62a-4ef8-8de8-f1f3ed72fe00"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$d", "=", 
  RowBox[{
   RowBox[{"2", "*", "$n"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "$parity"}], ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$phi", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{"$n", "+", "1"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->43967962,ExpressionUUID->"5f1b1c8c-1de5-4bc4-9422-451a0d197f52"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[2]=",
 CellID->414614265,ExpressionUUID->"0004f0b8-fe01-4523-9690-a92da12a496a"],

Cell[BoxData["4"], "Output",
 CellLabel->"Out[2]=",
 CellID->1985000987,ExpressionUUID->"8e76741a-9058-45ff-bf85-a39d90e179b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5339902389407843`", ",", "1.1787619696233085`", ",", 
   "0.7580510288911491`"}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->753132364,ExpressionUUID->"7037df84-76e8-4524-b807-345cbe0ea010"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->200293604,ExpressionUUID->"d40a1744-72a0-428c-b246-baea1f938e41"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "0.5339902389407843`", ",", "1.1787619696233085`", ",", 
                    "0.7580510288911491`"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{0.5339902389407843, 1.1787619696233085`, 
    0.7580510288911491}, 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->627026330,ExpressionUUID->"f8d60c97-a8b7-416d-9ba4-11d18ec32cf5"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP:", "ExampleText",
 CellID->1394539877,ExpressionUUID->"3dc17e5c-ba2a-4b6f-8add-a82061c748a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->395189381,ExpressionUUID->"dbe7693f-b431-4740-bb50-c7fa4adcbce6"],

Cell[BoxData["0.7222657925379279`"], "Output",
 CellLabel->"Out[4]=",
 CellID->729272481,ExpressionUUID->"2a359298-8c9a-4b34-b839-648828149082"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "hss"}], "}"}], "=", 
  RowBox[{"Hessian", "[", 
   RowBox[{"qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->159787830,ExpressionUUID->"45944f54-f4fe-4760-bf04-8db4a8760980"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5769627824536402`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.4145364025864139`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2.3078511298145608`"}], "+", 
        RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.2552598932355523`", "\[VeryThinSpace]", "+", 
        RowBox[{"2.5361482143617504`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "3.35838258479375`"}], "+", 
        RowBox[{"2.1631785520385023`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1.2552598932355523`", "\[VeryThinSpace]", "+", 
        RowBox[{"2.5361482143617504`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "2.4130282108016887`"}], "+", 
        RowBox[{"1.466902161955848`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.033706474826593384`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.004835123625018142`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3.35838258479375`"}], "+", 
        RowBox[{"2.1631785520385023`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.033706474826593384`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.004835123625018142`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "2.3078511298145608`"}], "+", 
        RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1193414738,ExpressionUUID->"a14f711f-eb92-4bf3-96d4-7d3d46f3bbe8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"val", "-", 
   RowBox[{"qsp", "[", "$x", "]"}]}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1568514031,ExpressionUUID->"122a8587-0c01-4397-90ef-53b3f2bb0d15"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->224238586,ExpressionUUID->"5ab832b8-954a-46c0-a93d-ca40c47dba38"]
}, Open  ]],

Cell["\<\
To verify the above result, let us calculate the Hessian matrix by explicitly \
taking the partial derivative with respect to the phase variables:\
\>", "ExampleText",
 CellID->664134417,ExpressionUUID->"cd4be782-dfad-4284-8f94-964d7d7f1c62"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun", "=", 
   RowBox[{"QSP", "[", 
    RowBox[{"{", 
     RowBox[{"var", ",", "$parity"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{
   RowBox[{"Matrix", "[", 
    RowBox[{"fun", ",", "$x"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1634633060,ExpressionUUID->"96868676-ce2d-43d4-a6c5-1aa6236935a1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->2091598064,ExpressionUUID->"8bfbec65-34bd-4ecb-b530-28830f63e35c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     InterpretationBox[
      SubscriptBox["\[Phi]", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`\[Phi][0]], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.7222657925379279`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.47833212492955896`"}], "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.5216678750704411`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{"0.7222657925379279`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{"0.7222657925379279`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.47833212492955896`"}], "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.5216678750704411`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1328843905,ExpressionUUID->"285cad53-1216-45c9-ab11-59c3b82b6d5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"fun", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", "var", ",", 
     "var"}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"var", "->", "$phi"}], "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2087253347,ExpressionUUID->"1384bcd8-3c3a-40bd-a4f0-3ecb09562f5a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2.3078511298145594`"}], "+", 
      RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.2552598932355528`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.5361482143617513`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.358382584793751`"}], "+", 
      RowBox[{"2.1631785520385027`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.2552598932355528`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.5361482143617513`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.413028210801688`"}], "+", 
      RowBox[{"1.4669021619558475`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03370647482659327`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.004835123625018508`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3.358382584793751`"}], "+", 
      RowBox[{"2.1631785520385027`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03370647482659327`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.004835123625018508`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.3078511298145594`"}], "+", 
      RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->49582535,ExpressionUUID->"374bcc8c-c329-4b90-aeba-a639367a0e23"]
}, Open  ]],

Cell["Finally, compare the two results:", "ExampleText",
 CellID->1200015267,ExpressionUUID->"1c4d1315-8ea2-47ad-88ae-2db90b1446bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hss", "-", "new"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1637663492,ExpressionUUID->"2ee5b5a8-cfcb-444f-bbbf-b83f8a97ca49"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->110010709,ExpressionUUID->"022e7081-4786-4ca4-a460-fdea4dd5ea04"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "b1933d54-933a-4514-ad3b-46d70abc7f3d"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->486630493,ExpressionUUID->"9a527ed0-6d88-4d41-9129-a7934e34af67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1180968075,ExpressionUUID->"d64ed777-e981-4394-9646-b6b34aa0d5f2"],

Cell[TextData[{
 "Construct a QSP with a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " phase vector:"
}], "ExampleText",
 CellID->1486570951,ExpressionUUID->"2d7f6e8f-1bc3-429c-9c9e-623d2a9e8417"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$d", "=", 
  RowBox[{
   RowBox[{"2", "*", "$n"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "$parity"}], ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->973224259,ExpressionUUID->"8a3d3c20-22c0-49bf-b878-4d1d5e5ed617"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[2]=",
 CellID->2114049743,ExpressionUUID->"326059fb-02e5-4698-981e-eec49d5f94d8"],

Cell[BoxData["50"], "Output",
 CellLabel->"Out[2]=",
 CellID->717090986,ExpressionUUID->"c7392917-189e-452e-81b8-18639bb71559"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1678153624,ExpressionUUID->"2f4e7611-5f37-4ecc-b637-8e66da2557f6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["50", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["50", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "0.5339902389407843`", ",", "1.1787619696233085`", ",", 
                    "0.7580510288911491`", ",", "1.134532453888182`", ",", 
                    RowBox[{"-", "1.3517605416842526`"}], ",", 
                    "0.9052533646233881`", ",", "0.591118526082671`", ",", 
                    RowBox[{"-", "1.2759930775363912`"}], ",", 
                    RowBox[{"-", "1.3804120440348508`"}], ",", 
                    "1.4620420068679363`", ",", "0.702587270614763`", ",", 
                    RowBox[{"-", "0.29182991018788623`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{0.5339902389407843, 1.1787619696233085`, 
    0.7580510288911491, 1.134532453888182, -1.3517605416842526`, 
    0.9052533646233881, 
    0.591118526082671, -1.2759930775363912`, -1.3804120440348508`, 
    1.4620420068679363`, 
    0.702587270614763, -0.29182991018788623`, -0.2453649835205999, 
    1.0646298953735758`, -0.2539914181956648, 
    0.08863906086950231, -1.045348527321529, 
    0.09975231071398345, -1.0299833787160213`, -1.4448761853812915`, 
    1.4661621476657107`, -0.3262702156822805, 0.1599724033204789, 
    1.2257365296209746`, 0.5203548471987617, 0.895391934691802}, 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->469974738,ExpressionUUID->"2503fefc-e517-4aab-af4f-1d13b210c45a"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP:", "ExampleText",
 CellID->1858429471,ExpressionUUID->"3306ea47-4343-4d1c-a71e-c60c39dc7f19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1621957129,ExpressionUUID->"9e66a2c3-8255-4098-8fe2-dd7a60d3051d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "hss"}], "}"}], "=", 
    RowBox[{"Hessian", "[", 
     RowBox[{"qsp", ",", "xx"}], "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->454622630,ExpressionUUID->"1bd969fe-9a88-4a85-b092-4d195716b0be"],

Cell[BoxData["2.913976`"], "EchoTiming",
 CellID->420567900,ExpressionUUID->"eaec5b38-448d-4f51-b554-cd08d45cf06d"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "3"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"52c8dce3-2da2-4c67-828f-5fe885a8f1c3"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"d34daae4-768b-440a-804a-63e467df7251"],
 "Applications",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "678f3656-28f4-4bdd-ab5b-0bf4c1764b0e"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->701469844,ExpressionUUID->"e48a756d-7f75-4393-a150-47cb3c394b69"],

Cell["\<\
Evaluating a QSP involves a multiplication of many matrices. The \
computational cost can be reduced to half by using the reduced phase vector.\
\>", "ExampleText",
 CellID->411726774,ExpressionUUID->"fa15f909-2bc4-41d0-9389-dd1183996f30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->271315786,ExpressionUUID->"5041975e-b75b-441a-8e25-043409a0a447"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$n", "=", 
  RowBox[{"400", "+", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"5", ",", "10"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1529848425,ExpressionUUID->"5d9a4315-2ec3-412b-b3a7-7bf50ad0fe0e"],

Cell[BoxData["410"], "Output",
 CellLabel->"Out[2]=",
 CellID->1116013023,ExpressionUUID->"052272f9-6b14-4d72-8b0b-7a09d3c4573b"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->708704663,ExpressionUUID->"a131c2b5-50ff-4b2b-a842-bce036e66854"]
}, Open  ]],

Cell["Construct a QSP with the reduced phase vector.", "ExampleText",
 CellID->263062639,ExpressionUUID->"e0b8ca76-d9e8-4cea-b18d-5e875229f896"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$phi", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
       RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"reduced", " ", "phase", " ", "vector"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"$post", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{"Re", ",", "Im"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$phi", ",", "$parity"}], "}"}], ",", "$post"}], 
   "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->252225698,ExpressionUUID->"04e0758d-d9b2-496c-a1a9-ecf9ade9e9e3"],

Cell[BoxData["Im"], "Output",
 CellLabel->"Out[3]=",
 CellID->487988694,ExpressionUUID->"d1fb5ba5-63da-4315-baf0-f8fc3c04dc9c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Im", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"1.188652429517412`", ",", 
                    RowBox[{"-", "1.5282539570581533`"}], ",", 
                    RowBox[{"-", "0.17942028160821494`"}], ",", 
                    RowBox[{"-", "1.2173503105164918`"}], ",", 
                    RowBox[{"-", "0.11887669407281704`"}], ",", 
                    RowBox[{"-", "0.18324875551430472`"}], ",", 
                    RowBox[{"-", "1.4383225005814628`"}], ",", 
                    RowBox[{"-", "1.5529442957893163`"}], ",", 
                    "1.1890198090786863`", ",", "0.8937051586490578`", ",", 
                    RowBox[{"-", "0.5875081577071491`"}], ",", 
                    RowBox[{"-", "1.3983546572808385`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwNz2cgFQofgHFJRTfKjSiVUiiV9n2J/CmVFlJJisoIpbKSjCRys1JIkaSI
RNYpIfyNjJBkHXuc5ZyDs5eE9355Pv+e9Q63rJznSUlJJf8XRzeua4kMH6aq
e66XeUuwPWLY1Uhcj8Urv5wy9eej4M2JKcLNSvxZNj1V6NOA5XGnfOzni9Go
RXftQI8EjdIy3uov5IOyybNYg6QJ+PfRLfpgCwlXFCzXyL4kQtrhdhv1pVPY
7kxyBR4J7m3wU7p7iQO2RsscQ8pZYEGskaqMpMBonq+TR5gY35DWzHw+IEG9
5COzLvuaYH7EF8wP44EqXJFWvD+IurYRKhqGdPR6TWbbZ4pBN2jL4g36nXBO
a/Qfl6VM9F+qFV/uKETv4hMx19YOgAM57OqdFxTUrMGzRpk83Fr/uJ4sLwGp
eJnca4a56PN+uNkltAcNN69eQRnkA8HUSSx48Q0Vfmru3Zgmgla4eHm2fhK0
qQsUCpeKUfXXEjm3ujaMOVu5KMyuHCPpc5NB4wNIJkTQZIdZwGD+YDU/FaOX
5a8zXYljQHRNLSY48IHFPrCyOl6Mtn+eRAevo0DEa4mHj5CDVtExXjEbmLAr
0masVEmI0lv2/dn9loYHFShupY8ZEJieaxXcLkSvy5VJW2/+gJ8acXd+N/Nx
eZb019JfjTBdLGRqW3aDzP9YFRfSGWBc/SzElSbGSYXW46HsCWRstK1RK6oC
9ExLorycgIFmcc+VR9WQP//tVMlKHpbvsjlO4nYh4cDCzudBn/DVeMnWp0um
sG7to7zsU+2QE4+pX3MpkBr2ViVHSoJLbFOIKeuC4UnIyj8JxDo05p9ff6E5
BysrzRdcUaOhzZaiY/s9BXg2pem1XGI9Tg45r3qnS4eSUmeNY/wxyEyPyEs8
SocDilfroI4C243P2SYShPjMyMFZiswF9uyuJZP2Ijg7kdG3Y0EVzL3Z7NdF
HIDNVn5jN86IkXXtDdPl5BDWNjXtorYOY+ieOwWZe3io8SwymEItRp1Y53YT
Mw5Wq8pmeKcK4WBityexpwXWsj6Pvk1gYocVXwHbO6DU3eXLpDwJbOVmzTYu
oEIsWUw8ajaJX35rXTB4WgUa7Vo5gUQJdH3IvEfyJ+HjPUmFO6uJGJEoQ1IN
7sGP8z6G9SrlIDHmpkJz+ChWSOV/nlYW4D0dVvlLKREE7ZJNydStgpem/U6m
iwRgEByw8WTXMHA6AhzTbmTCqXnbztl6jEJORcQhL9Y4jt2NVvaeYcIEYXaN
2kEOOt+wqhncNgGHeD+u7TCfxKWiOvUtHhwc/Bphx7BqhxnbzhIbAhNNjezG
PqwW4Liezl5VYwkcXZ7yWdWMjKH05vFDe/lQZtH9yIA8gguuNzc+aCaBvrK/
yuEQEX5aXisd/4WDWaU/27SACuKIQ9+rQoX4NGQ662KkBC1enPSyWkLGvIeS
OMeIZlixe0hPQ5oLvoWucs8ZFFThyn4+VEcEnalrljn0EXw8NMPY82McFPq7
XiQeFIBha9spelwZRj3403fVdAItVxF9bi2mgqNt2SrwJWH/7cPNBeq96KWr
lj8sQ8eo7N9eFLshPEj84GRMFoBCiP/Gh0+YuLT0b5fGZha8DpwK21dSDccE
Rf8WUnhQvS2oPpdXBB+UBjYX3h7F7McpT2VHSsCzlfnyWOB/n72za/wfTIB5
Y1qjulUDWiWPBT7z4IFoBnXnzn8ErZkzEYF2HfisNjTmXL4EOVtd5dQVw8E3
TpeUYM1D7QNZT2vpHITbvu7mKi3waW1XTZqoBzUXrbBQXT0FNqW03wYMMST7
OKupmzphz4MCy6ZSKtil0e+Zb5jA/H9rTGUzqHi/9tL5TnMhmCZFBPiq02HE
6XSlF70da51VG46xGlFzOCXhunsRmtzYf+fRyW/oeG+9Z2/tGO7M82P72ZCh
z/1SylcmDzd+r8z1ZY1h3bugzFgaFR3P7Cte8ZyKzx+zjDv+asAwKyVbr0uT
4Ba0Za3PcyEo2farzIUTkBqeZHJEngcPjRYbepkz0bvl9bJ0uzE4fdt0Raw2
E6YiJVH8QRGGk6c5DqfH4FqyqU5ZpwRGr9oKXPXZmHFSPnp9gBgIM5RctbkJ
CHs++iiyUYx7j3sErD7Pw6i+rPFFlSRIjyaNNQgKYNWPVlnro+MgUlKymxZL
gFnpmJDYzoYv9LsnUoU9qKQ+rc3fNA4WAdcvRM9yYDyqCc4H9UFeaTypu1EC
BU567f0na7Dx3Spv7f0CZBgQrnicoGDvG77sgYdlYF9D2FhoyYXZhCGNNPYw
/OHdKbqcIYLE6RnmJFuCOx5tygjmd8Ok8wdBtb4ErPlrHBOsBODLD3poYcfH
033ym4evCaB9TwDNrICPzxhVfvrrOnCIb0hw9uei5VXmQOTPEVTty2pJ6eKA
dvvojf3lbRhcvtttzR0xMPfMcob+aYAr9/7I/dagYfuis6mq7zho8alOTDGn
w5L+5mXp/UOQO7rkOoNGwZC2VSr9DkW4IETKkOEmRuuxgQpinAhTGLciZCc7
4VS06VJ3jwk8v2Bqw6bpftyedTc+POEXNBSFJVldJKGM+PewWQYHa712WPd5
czG0QYa6YR4VXBlE7qbPVJy3k1QsMRNib0W9frIBH9tIF2aMHOlYxq9RcdH7
hNaG6tENTjQ0E/EyRs4M4ZOMrMjTIzyU16u+0ZJNhoNb1WqV11fBujj2/sPG
QtSy9/kU38LDPXd/v1X07YYWzbmh5KLvcHHmuxb8EeBPllziMbYA5q+Kn/yZ
xIHMKRmFoU9ikP5sceEQnQN2k30/vBM54Bkb1vXw6hguZFYN/NQkwVz2diWX
XjHcFxoK0iIGoD4o9OviHyww0R7N7VTrQHmaVj5b8AwFLy7sXinVhOLLF4fC
6yuxcZ2Jy8G/hzFgVTvlxWkB2lVZXZty+IRvVv9ZcD+ah9+dA3+bMbvgywnF
kkpGKQjf77NvXMFGg3Jr0wY9KrruS+j0OtoGvfMft5QoE1Gj5O9U5e8ULGzv
l2RXc+EpQf+mfiUXzN1iFz0cJmHdOZkwh6fZ6PuswXT4P7/74vOHeXVMPLFW
t9fHhAJfB9wo908NAaNiZ4aLfRfO+Hk7X8d2fPveih6XRcX0ZS8y4yPTMGpN
mPxw6Bjq/JVDczjHB/IlqfQ6Ag2/zeolR8kJsBrontPrhKjjFESz3lILpu9T
hwflOejpbb/0IYGPQqYoNbRXAJ0vajpsor5BjZVRnEhXAsu/rVPbpMmFlGMc
oeYeARD2N4XXllYgL27hZUF+L1rvXJpA6KtAo+PS0SqBQvDP0uBRnYfgyArj
JPcjIxjYJecjNyFGf4XAFznAhg7j/U43FMcgVnnM9+4aLkrUq00KbISowelo
/KebDOw3e59fT8kBJl/hYDKFi9pzjPcftSWob6AzpRjZCGuPVmlnj0pw9blB
r2zFNpg9crZYP7YP5+5E2eQajUN4tecvCzk63jX/mjIu1wwLdVsTWshsNNfU
5tvt5kL07Lbk4Tw60rnfbrTIVOEOBYVF8usF6MGLjLlcTMd56TdJk1EcEEZG
nORpPYSABa9ipqQHQNprfVE3cRzWvXJAU9VRNJ+5rW9zWgQ8+HPeI5YHV06b
DPdH8zHf3unI+6d0XFYQ63gurgK6L2e16PiL0TFk97J77mSQ5IQsZ/pVA1Fb
NjDGjgbadEpX6CADAxRuGQZeKINDDtsX5lHYOPTKjGW5iAr3P9L6NpVJYP/Q
NroNiYo2Km+CnHP6ARmb0tXi++Cx/PT49vkCOB42WHBXjoemdqe7XjWw8dbm
H/oNRyhobBzP/3ygAy/kfLNYX9AKBwLYesYTPFwkdh9XpbUia3KGFp3HBP88
etB+aS52FNaHOu0iIjKYUkwGH+WcPiSn/xKjxritmWi+CNe7LtG7MfcOH1gW
ZriaCMEtP29C81oT+u+4vDjekgdrF96klzxmovwP9xDSBg52NBsaXSd0g69d
fDb7Yh/mTdBlfeLG8YNn34khxVY0OGkWQQgbRjVxnIKKVD2kauV5N1O44Kdw
qsuGNQHe4rIdRU18bI1N7nr7mgotygOj1QQxRjsrZ/1aUwxp24LysraO4Or5
I8GXHLjA0mJau5KFsPILWd+wT4xnLm8VPeB9wcAU78V3rfgYo7OtwG/DCLaV
FGtVKE7hxn8GbntsE+KrmXnvw/N68C2lNnr3bA9kuqW9MzswjiYf65MEMSPw
v57yd/71ArAPkdGfOc+Db/Gcg0/sJPB/ujUvdA==
    "], -1}, Im],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->385932165,ExpressionUUID->"b2bb1dcc-8178-4a3b-a127-684778e4db68"]
}, Open  ]],

Cell["\<\
For comparison, construct an equivalent QSP with the full phase vector.\
\>", "ExampleText",
 CellID->783735018,ExpressionUUID->"ee2e70c2-30c6-4218-8bda-c354a135225a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gun", "=", 
  RowBox[{"QSPConvert", "[", "fun", "]"}], 
  RowBox[{"(*", 
   RowBox[{"full", " ", "phase", " ", "vector"}], "*)"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->553874063,ExpressionUUID->"74641d32-f9a3-40c2-a051-29410c63e80b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Im", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"1.188652429517412`", ",", 
                    RowBox[{"-", "1.5282539570581533`"}], ",", 
                    RowBox[{"-", "0.17942028160821494`"}], ",", 
                    RowBox[{"-", "1.2173503105164918`"}], ",", 
                    RowBox[{"-", "0.11887669407281704`"}], ",", 
                    RowBox[{"-", "0.18324875551430472`"}], ",", 
                    RowBox[{"-", "1.4383225005814628`"}], ",", 
                    RowBox[{"-", "1.5529442957893163`"}], ",", 
                    "1.1890198090786863`", ",", "0.8937051586490578`", ",", 
                    RowBox[{"-", "0.5875081577071491`"}], ",", 
                    RowBox[{"-", "1.3983546572808385`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[CompressedData["
1:eJw9mXlYzWv3xkMor8JrKDOhjB0H57wirSJHHEKmRIYGMlOEFFIcpXRUQieE
SCIpUqHVoIESSho17Ha12027PbR3Un7vH7/7/avr6qq9v9/nWete9/1ZE+0O
WTn2UlNTm9dHTc1+T7tTorqMOtNK9iW7qLjAp8rJRJnFCSNfrjV3k7H8zsrO
+IMp/DG5q/PZ0Wx+Hbj26LY+SjbJMxxXUaJik/CIu0b9ZDTc7GrAwhvN9NfF
Q6JveQIeETtUL2p7B9f/UWA9flAnFzgKnEgqoNOTTgw7uV1CNiaD7T1ft9Lq
4nS1FF8h1cS4Ohz2VvIdwdjuF4tVPD90Wc/uBe+pj89LfuotJV3a2XvI2W9s
aOOjo2csYufbtW3bHijJ0GPGgElGX2iTfs3vuweJ2W2QftBrewW7JKz03zuu
guxqvXcdvy7kKem8weSBlGdmXc6q1VKRWpD6473Gj/now6rc3V4lbDxtzAjh
NxnFmzso5dffsvbHKb9NDu+gfNq6oyerhQzq+mo/G6Rk3c8DNfdkfmL/DSn9
vW1fs6/oZ4tHUwXXxvvUa1S1UqP4Q2vuFSU7r/m8viikgYqdbiXE28motW3x
yLQgJdv8+NvvzAQh+dxWHT6qkLCVn7+z/yQxzfG1bkgapuDeMxb8mHu3npdo
C/ckXW4k93uPrc4UKNh5R8qNmQc/0Ee9wOPfc2U8NLL3q6TPOdSVoBAbrPlK
6v9pfbPlXiOZpl31dKpXcot2/p9ebc3cONkmfXRcKvGR8BvCf5qpIldZsvNi
Gj3tc7czcaSUX8+x/lPQXsTxi/t9uebxnG82Jc68MrCTM8ddjIlaW0DRQXzr
1WMh3fK+qxOtpuKBNmHFYRPO0N+eI38EF2eyqWzzxC250ZySYtl35+h6tp4R
t2LRETlvCHt/WzMki1sqHUfdNxRRYpKj3gpZAz245xMTslxEi4fsyqRMIf1i
uskmJF7BV03sHNVq26mtZ87Alm0dtKE5omx231T6eWfaiaLiCppmdaLhwHol
t+69I969qpIz3r+fU5dfxV7zjsc+mCdlvau+Z4R1CTw9wLHAzELCaboaES63
FLQk5OuR4pI8Gtf6ouZusJgLrWTaXFBISft3v2zREpCNZo/F5L51FFCrLF5u
0cIvv+tvWXgllfQK9KPdi1VU9OjBaYGbgC/Pu/Hs17Ri9glRF+ieKeEnvZ54
lw6L5mL/g9q5F2r4jdrTF13D5Xx6euvrf9Q6yGOORtgDw1T6x7zcwby/nBae
OTV5VVEVSQpP2YcfeEBre83aZHO4hqLf+Cx1bm3ihpN+w126xdQc3zN29BIJ
Ox6wSv82q5mWSj/snW3ZwoM6MsfPOCzhb698bButCqjb5kuidbyYzU1sGx6N
kXPT/Om/6ZqqaPnQsBe6FrXsJcptWvqbjJJXf724sLaa++7LzTmXKyCj4W46
f3h28POhGb2DXko4MunjJ32qI6XP0nepXgq+4tkVudVXxauvr3K2GljLMedV
gfY+uTRibuV8vd7t5PrMSfNao5B12jVeLM0spumde9dEi6r5cmV347wPTaRd
XnQ9ZImcjPM/rRUFJvOlcz/Kdpk385pRxUcPDagje5vkUeQq4PJjf+TGji9l
Z8PRT6vURXwp6ruz0LaSlxQ/cjCtlZO2p9vk83+LeVDSv3fn5LbSbfdO7wWJ
abRCHvfXM6GU0mZ5ZD2WxtGjYRXTnh2r4ajLYVc0qhPpSL74nxXu/33P0p6x
bueayTInPGe8VTZbhTa4Xz0spY5uNvy5+Qnpd6/3cbct5KsZXv6bnqpYMtNJ
c/yQC+QaaCgI3ihlg8WRVzJEEqZjrvstdfLo+bii9PCOEp7Sf8Rq3TGdZJ1U
/31ho5JCjzqOHm/uwCXnYte8T6oj23DRactJzfz0r3RzjYg6PpuxffMXSwWZ
3/A55TpeRNUO61KcRQWc4aibvaI1h6dUhQXv2x/HZgcWHb+46i3bn554pDSj
gX+NOdF2wrqWyvZvD3sllvLkdymPXVsbOPO+x4OA+jq2X78gYcS1Or52udW0
8F/Z7G01zMZ5ewvt8Zgx7ug1BQ2zKdf5eSGe6y7cMFumJaXzJgOMnS3F7JJ3
e/A92wZad8x8RICBmDp9VZdk3zr4Qm2XxG5dA+0NNZ+e/EVFNbts5E5GbRyx
Sstv4iklxXcLH4/+2Uze12ou+uYo+bc/D58as1nKl8oim/qnCOien6AhWx5L
oz7ka2xc3kQdw4bZdilVJE6xDw4paKOXopMrbylKeNj4LgPZ1CZafWrfFr8e
CTVdek+bPcooJilI8DVHRbEO8wvKV6Vzzv1RLgaL5Ny4MH7n4ZVCLr0j01h8
Ppm2pcdPframnXqCK/XC26roh/R43I6IDgrp6ha3tKl49sWpEWdkX6nF8ZE8
zUhFG2Vj7YOt5OQq8zi/2lbG68q0plXtlVPBvFP1FrEyvtqYesJoQiFXyozj
Hd3aec0ucYXvx2rWLYvMCyuSkEFBzYFFrz/xmddz94w9riTxvB5J5e/ZtPP0
D83vevVc0H/DLd37El79PFMptBTRwPLcwffKK+lxzcB9jfVC9vw0SqfcLo77
eqoZN+5R8saGijfFgR0c1njIR6PlC631Mx+0/3Azb+7bOWlqVzn/Enky6ELw
Z8qO875htVXA6srvVRYREs5wnr2xzKWdvbLV6yb1qiOnxuL2qS/quNevggSV
hYJL32QZhS6U8SfBlm4TexEny9J1ds9/zhuNx/tlO9SzRYc0onp9Jf8dEem7
rlrKWvPTDuRF1dKSmaMzhk9MpQmBbYv+MFWw/rajz4PypDzv5Pe7Q1y/Ut6U
n5Whce9oa/c7ffoh54+tmiEr2uTUZ1RQy8cbEnrQqa5d+VxJvV+s3rJUJCHb
lrIPLiESOhLgXXR+VwP3E6dWfJwioJ9RvwzbXaqkswpjebhPBWV5eL0a8KGV
zAxqHn8ZXcha9fpP2+RXWX59y9yRau9ZuWNr5YWsFM6ZYLZ7yb+r+NSoAuH1
dXK2TbXa22n3nO+M+dH3rJ+U3zm6f7cQF9HLlUMSUxqTSPFwwbacEW288PVG
8+z5dey0IPiL8/JPVNrncl7i8GLWS/z3reHvhPysoFwVldZOV+KNDhqltJPl
noD+56sEnLlJ3dvuShS7Xs02r/rv8+8fsPkPaaaYV44zLD1qJqRXFXuEZ9dW
UuObXyN2byvi7hMujvu4gO8+tBIFRtbxvcHXHwT5hvOlsd5aVV4NPP1f0fV2
m2RUu13tXmZ8Pb/tmR96SVPOaSQ60jVBwdMdPOo3zsgg84e3qr5pSfiIy7ZB
5+NlrBB33PIqldOX6+mF1pfeUrqVSWCHoYqGvp0weuqUdgpbIVFMmSen+EXv
L2QkvWFpYL8d8qelvPHXQcHxZW/Y5M/efjruCnKL1JPWOVbSshGmN/Yvq2b3
Is2jms1KdtN2vx5NbVRousjhwJAGChje4HpybDurxqeZxVorWE9SmPP711pq
u/PbtX1h0SSWaS8JFbazwc/Gh08MVGy0cHrnEN8cGrc81SCqRsVjNn1zjhry
iXqWbUgwCijjn8cvWT82aaILaUc+r9YU8UnLV2FNmrnUzzA/OK+2jS2nGMhs
57aTX8+s0KoYEYva3x7IU0/l2dra/bUmyvmw1Nd/R4KIe907KGi5JCGFr88q
qf55OtX3pn9n7wrq7Twx7mtxE024acfmujVs2X3MyHpdB0npx+bDAVLauc6s
qtxPxk+3OSx7eEXEg2MD7DcFvqGvOyLzprsp2d5z7uDT+2tJFe05VHwijYoN
NNz9bevJQCQs8vrWyKe0Dxm7b0mmpXa/9IsRtnHlTYvWNf3r6OyT+rKpySpa
VDlLZC2oY2udOx6O0eXEjVPvjQ4qo8taXU2/9JHTn97fYk9qStncdl3Rzew2
PjTtg1H2MiGbmgbJXiwu5C3Rb1dPjM2nxafa5ps2S7m/cn+Tbn0+t7Z01/vF
iMktRuSxqHc7Fz7L8nKYU8zcKFYTN8pY0+FR6L3PStZrsrHo6NPBE50Gzj/w
8z6fW/MswslMQXuexjRP2fue3WbvGBC0Rkrj+h0UJV4Ws9aH/Z6CSRIuzDU2
2Rf/lVxtg6LatpZxTLNI42hgEz86Urayckg+L1xl4RPvXcWjlYHaOmpZdEs/
xiVX2E4ntNcWWbc2k4syeXbcexnnB4QW3b1dR3nDK2rS4pXs5zg88vPYBAqf
5RETObOax/SpPrPdrp1a9cUbnWoVNPJlrZFxmZLX75jZcU76kt3DXAactJKx
//RZsScmVfOnxAT9N0M6efLvFccOz1Lwze5eDy/ElPBdYYbf3J4SerAn/L7F
4iY2e5J1Q+5fTf8peX3fLUtO2zzVjbo3S+ltkGTJ37aq//3E7/F3+D98Dj4X
34PvxXPgufCceG68B94L74n3xjngXHBOODecI84V54xzxz3gXnBPuDfcI+4V
94x7Rx2gLlAnqBvUEeoKdYa6Qx2iLlGnqFvUMeoadY66Rx+gL9An6Bv0EfoK
fYa+Qx+iL9Gn6Fv0MfoafY6+hw5AF6AT0A3oCHQFOgPdgQ5Bl6BT0C3oGHQN
Ogfdgw5CF6GT0E3oKHQVOgvdhQ5Dl6HT0G3oOHQdOg/dxxzAXMCcwNzAHMFc
wZzB3MEcwlzCnMLcwhzDXMOcw9zDHMRcxJzE3MQcxVzFnMXcxRzGXMacxtzG
HMdcx5zH3IcPgC+AT4BvgI+Ar4DPgO+AD4EvgU+Bb4GPga+Bz4HvgQ+CL4JP
gm+Cj4Kvgs+C74IPgy+DT4Nvg4+Dr4PPg++DD4QvhE+Eb4SPhK+Ez4TvhA+F
L4VPhW+Fj4Wvhc+F74UPhi+GT4Zvho+Gr4bPhu+GD4cvh0+Hb4ePh6+Hz4fv
Rw5ALkBOQG5AjkCuQM5A7kAOQS5BTkFuQY5BrkHOQe5BDkIuQk5CbkKOQq5C
zkLuQg5DLkNOQ25DjkOuQ85D7kMORC5ETkRuRI5ErkTORO5EDkUuRU5FbkWO
Ra5FzkXuRQ5GLkZORm5GjkauRs5G7kYORy5HTkduR45HrkfOR+4HBwAXACcA
NwBHAFcAZwB3AIcAlwCnALcAxwDXAOcA9wAHARcBJwE3AUcBVwFnAXcBhwGX
AacBtwHHAdcB5wH3AQcCFwInAjcCRwJXAmcCdwKHApcCpwK3AscC1wLnAvcC
BwMXAycDNwNHA1cDZwN3A4cDlwOnA7cDxwPXA+cD9wMHBBcEJwQ3BEcEVwRn
BHcEhwSXBKcEtwTHBNcE5wT3BAcFFwUnBTcFRwVXBWcFdwWHBZcFpwW3BccF
1wXnBfcFBwYXBicGNwZHBlcGZwZ3BocGlwanBrcGxwbXBucG9wYHBxcHJwc3
B0cHVwdnB3cHhweXB6cHtwfHB9cH5wf3xx4Ae4H/7Qn+f2+APQL2CtgzYO+A
PQT2EthTYG+BPQb2GthzYO+BPQj2ItiTYG+CPQr2KtizYO+CPQz2Mv8Ho/tc
Pg==
   "], Im],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->961283215,ExpressionUUID->"3aa17772-9bda-4012-9d36-210238e7e02f"]
}, Open  ]],

Cell["Let us evaluate the QSP polynomial at the Chebyshev points.", \
"ExampleText",
 CellID->789353421,ExpressionUUID->"0fbd86c8-62f8-4b34-95ae-d384ccc32946"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->210476177,ExpressionUUID->"63ba8374-baef-4fcc-8f71-8e439770940f"],

Cell["With the reduced phase vector, it is reasonably fast.", "ExampleText",
 CellID->1365905885,ExpressionUUID->"27e98840-a961-426c-b951-2658a2afdef1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"val", "=", 
    RowBox[{"fun", "[", "xx", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->192749570,ExpressionUUID->"25379d50-bdc6-4ded-9375-d448b5d7cb22"],

Cell[BoxData["2.758064`"], "EchoTiming",
 CellID->767518124,ExpressionUUID->"451a7857-0c5d-46bc-8f4d-0c22f8180c56"]
}, Open  ]],

Cell["With the full phase vector, it takes much longer.", "ExampleText",
 CellID->988870704,ExpressionUUID->"42a73604-b8d8-46bc-a448-f047693da73c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"new", "=", 
    RowBox[{"gun", "[", "xx", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->482833766,ExpressionUUID->"10b4a33a-8d51-40d2-8571-6a9779256322"],

Cell[BoxData["8.641693`"], "EchoTiming",
 CellID->1890326186,ExpressionUUID->"98cf8a5b-7653-4492-bcf0-3df6f50fcb60"]
}, Open  ]],

Cell["Nevertheless, the result must be the same.", "ExampleText",
 CellID->603496782,ExpressionUUID->"5ff40eb9-a854-4d00-9f98-2b5cfb5b3f96"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"val", "-", "new"}], "//", "Chop"}], ",", "0"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->857850345,ExpressionUUID->"caa67510-f69a-40f6-b183-c57b9d1b7c18"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->839134384,ExpressionUUID->"05feac9d-159e-42ba-8e50-34481da2e165"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QSPFind"]], "paclet:QuantumMob/Q3/ref/QSPFind", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "afd950f4-c5ae-43cf-9182-6cbc4903fe22"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QSPConvert"]], "paclet:QuantumMob/Q3/ref/QSPConvert", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "32ab6e2e-4707-4095-b2f6-bc18eb73c84b"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChebyshevCoefficients"]], 
           "paclet:QuantumMob/Q3/ref/ChebyshevCoefficients", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "b19b5876-6fdc-4156-9c10-21bc3a52a8a3"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChebyshevSeries"]], 
           "paclet:QuantumMob/Q3/ref/ChebyshevSeries", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "2e873d60-53ec-4018-a460-8b54e0c66fae"]
       }], "SeeAlso",ExpressionUUID->"24a7770b-5dcb-4f2b-9c80-e9f408371d39"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"68aad467-6fc5-4b7f-a7e1-\
4784042cc884"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Signal Processing",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumSignalProcessing"]], 
         "TechNotes",ExpressionUUID->
         "32833648-486a-4ae1-b129-e0ed4e85568b"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Linear System Problems",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumLinearSystemProblems"]], 
         "TechNotes",ExpressionUUID->
         "d9a14ea8-2ed1-4fde-af8e-fe6581e94ff5"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "74f96363-9538-474a-9891-22d6ddbd1af1"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "4c06d804-a322-487e-9cb9-aff1b51aca7c"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Spin Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumSpinSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "4015f396-337d-4cf6-b05c-49ff66d59287"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"73a13e13-3bf0-4dd4-96b9-\
d4a700ee2899"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Signal Processing"]], 
           "paclet:QuantumMob/Q3/guide/QuantumSignalProcessing"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "879a7a08-67b4-4064-9f95-446302a11e38"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "25d35555-46ab-423a-a4ba-14e8b378a6d5"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "2d837f7b-51f5-41a5-b9f2-f5f07242b318"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Spin Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumSpinSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "f4b228e4-d016-460d-97fd-1ac7cbbd557d"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "1b883d37-ebe4-49c1-9c83-a28c6189f506"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"1d49991a-77ad-4aa9-8da8-\
c308ef30429b"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        " ",
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "QSPPACK"}]]]], 
             "https://github.com/qsppack/QSPPACK"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "fa717564-5051-43aa-9850-f0d0a47b04cd"]}]],ExpressionUUID->
         "a80b9587-fc2e-4eae-be0d-c1cfc27206b1"],
        " by Y. Dong, J. Wang, X. Meng, H. Ni and L. Lin."
       }], "RelatedLinks",ExpressionUUID->
        "407cfd18-90f7-406e-b859-0c7a360ddf0e"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Y. Dong et al. (2021)"}]]]], 
             "https://doi.org/10.1103/PhysRevA.103.042419"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "27eefb74-3533-494a-bf26-fba0220ba2d2"]}]],ExpressionUUID->
         "d255a91a-b7d2-49a8-a4c0-8a1aea59467c"],
        ", Physical Review A 103, 042419 (2021), \".Efficient phase-factor \
evaluation in quantum signal processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "03086c0d-362e-42b6-b9a8-c2ef7296379b"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J. Wang et al. (2022)"}]]]], 
             "https://doi.org/10.22331/q-2022-11-03-850"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "86bcbf8b-21d4-40b8-bbf9-3cb71e97f131"]}]],ExpressionUUID->
         "8c6bf2eb-eb25-428a-b49c-00b99bec1593"],
        ", Quantum 6, 850 (2022), \"On the energy landscape of symmetric \
quantum signal processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "110469fb-ff7f-4ac7-ba84-d1b6034014aa"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "L. Lin (2022)"}]]]], 
             "https://arxiv.org/abs/2201.08309"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "b7764f1c-8b9f-4d3f-ad30-7f4892e9bef8"]}]],ExpressionUUID->
         "3e2a955a-aedd-4cae-92fd-ff19793ac659"],
        ", arXiv:2201.08309,  \"Lecture Notes on Quantum Algorithms for \
Scientific Computation.\""
       }], "RelatedLinks",ExpressionUUID->
        "4ff59b18-e280-4c7a-92d6-5d6525a64628"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "A. Gilyen, Y. Su, G. H. Low, and N. Wiebe (2019)"}]]]], 
             "https://doi.org/10.1145/3313276.3316366"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "e58a9966-11e6-4af4-ba84-d072d88d9fe8"]}]],ExpressionUUID->
         "bcd886ee-6d56-4673-a65e-b42f6baff023"],
        ", Proceedings of the 51st Annual ACM SIGACT Symposium on Theory of \
Computing, \"Quantum singular value transformation and beyond: exponential \
improvements for quantum matrix arithmetics.\""
       }], "RelatedLinks",ExpressionUUID->
        "06930314-9abf-458b-894b-268482d6493f"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "J. Haah (2019)"}]]]], 
             "https://doi.org/10.22331/q-2019-10-07-190"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "7bb3d183-8c2c-4e36-9a41-b4a66c142d7e"]}]],ExpressionUUID->
         "7b9aa3e4-8030-420a-bc08-b613d4016649"],
        ", Quantum 3, 190 (2019), \"Product Decomposition of Periodic \
Functions in Quantum Signal Processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "d7682343-e428-428e-baab-3b3402cd7f0f"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "C. T. Kelley (1999)"}]]]],
              "https://doi.org/10.1137/1.9781611970920"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "b48b0f74-51a6-4331-96ac-3de69320dde2"]}]],ExpressionUUID->
         "212bffe8-7f51-418e-97db-1a1d0f79c14e"],
        ", Iterative Methods for Optimization (SIAM, 1999)."
       }], "RelatedLinks",ExpressionUUID->
        "7ba11df9-dae6-49e4-bd9c-eb29af0e210f"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "W. Sun and Y.-X. Yuan (2006)"}]]]], 
             "https://doi.org/10.1007/b106451"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "91406a96-5385-4a13-ad04-689ac62fd2a7"]}]],ExpressionUUID->
         "cdae30bd-9ab5-4427-9da3-8962332aaf7b"],
        ", Optimization Theory and Methods (Kluwer Academic Publishers, 2006)."
       }], "RelatedLinks",ExpressionUUID->
        "98d82469-df63-4d6d-8c1b-02fb796ff5f0"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "73771add-d9fd-447e-b709-8e8162bc0333"]}]],ExpressionUUID->
         "c5292a2a-1015-42a1-a769-e4cd1a4d0af7"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "4dfc5c7d-1410-4b06-b358-e28a2ef89456"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"b0ea76e3-2fb6-440d-a559-\
1b816a80573a"],

Cell[" ", "FooterCell",ExpressionUUID->"7c30b484-b82f-4081-8c0d-a8ec042a935a"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"QSP",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed, "3" -> Closed}, 
    "AllOptsTable" -> Closed, "NotesSection" -> Closed, 
    "ExampleSubsection" -> {
     "0" -> Closed, "1" -> Closed, "2" -> Closed, "3" -> Closed}}, 
  "NewStyles" -> True, "CitationPopupData" -> $Failed, "ShowCitation" -> 
  False, "HasOptions" -> True, "RootCaptions" -> "", 
  "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 18, 23, 58, 48.851059}", 
    "history" -> {"14.0", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {
     "quantum signal processing", "quantum singular value transform", 
      "quantum eigenvalue transform"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> "QuantumMob/Q3",
     "status" -> "None", "summary" -> 
    "QSP[{\\[Phi]0, \\[Phi]1, \\[Phi]2, ..., \\[Phi]d}] represents the \
quantum signal processing of degree d with full phase vector {\\[Phi]0, \
\\[Phi]1, \\[Phi]2, ..., \\[Phi]d}. QSP[{{\\[Phi] 0, \\[Phi] 1, ...}, , \
parity}] represents the symmetric quantum signal processing associated with \
reduced phase vector {{\\[Phi] 0, \\[Phi] 1, ...}, parity}, where parity = \
\\[PlusMinus]1 for even and odd, respectively. QSP[{{\\[Phi]0, \\[Phi]1, \
...}, parity}, post] is equivalent to Composition[post, QSP[{\\[Phi]0, \
\\[Phi]1, ...}, parity}]].", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "QSP", "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "QSP", "type" -> "Symbol", "uri" -> "QuantumMob/Q3/ref/QSP"}},
CellContext->"Global`",
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"ff068368-e2b4-427c-850b-e6fce2664a49"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[45868, 1403, 1442, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"bea5f83a-a0d6-4b19-9fbe-174b199bfb16",
   CellTags->"PrimaryExamplesSection",
   CellID->1655495136]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 250372, 6712}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[571, 21, 7784, 186, 70, "AnchorBarGrid",ExpressionUUID->"8cb39028-7b83-4b54-95a4-b44e5f881734",
 CellID->1],
Cell[8358, 209, 96, 0, 70, "ContextNameCell",ExpressionUUID->"12e9bf4e-99c5-4465-9b77-52b10ab64aff"],
Cell[CellGroupData[{
Cell[8479, 213, 1354, 37, 70, "ObjectNameGrid",ExpressionUUID->"ca0606b3-cffc-4840-9bd3-4a8c7486d053"],
Cell[9836, 252, 6110, 180, 70, "Usage",ExpressionUUID->"d96d2b09-1148-4770-9274-988b5aec0bc0",
 CellID->1887563293]
}, Open  ]],
Cell[CellGroupData[{
Cell[15983, 437, 1850, 45, 70, "NotesSection",ExpressionUUID->"29865c37-1bad-441e-b22f-d224ece64f27",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->863078482],
Cell[17836, 484, 2570, 85, 70, "Notes",ExpressionUUID->"e451d129-4335-4fc7-a7bf-1b460ccb5f61",
 CellID->915826333],
Cell[20409, 571, 3840, 135, 70, "Notes",ExpressionUUID->"6b88f153-000e-42df-9687-0437eb4d3b97",
 CellID->1931150725],
Cell[24252, 708, 4184, 144, 70, "Notes",ExpressionUUID->"25cdedac-6c5c-4aff-b8e1-6b09f7f2fce0",
 CellID->765642393],
Cell[28439, 854, 2929, 99, 70, "Notes",ExpressionUUID->"b78eb5bf-a415-4925-b9dc-3f4bbf850ec1",
 CellID->328467597],
Cell[31371, 955, 1755, 57, 70, "Notes",ExpressionUUID->"09671d9c-75d3-4a64-8318-481bc196197b",
 CellID->740487261],
Cell[33129, 1014, 5375, 168, 70, "Notes",ExpressionUUID->"de449bb6-657a-49e2-9b83-d2c580c0a682",
 CellID->958672882],
Cell[38507, 1184, 1372, 38, 70, "Notes",ExpressionUUID->"d4f5777e-af6e-4b77-ae24-af288d76ce05",
 CellID->1795688728],
Cell[39882, 1224, 1951, 57, 70, "Notes",ExpressionUUID->"d6e95ccd-7f77-46f5-96af-2e80f44ed485",
 CellID->1190343635],
Cell[41836, 1283, 3542, 104, 70, "Notes",ExpressionUUID->"11353ab1-a5aa-4fb6-9e91-cdea1d1f01f5",
 CellID->1535193593],
Cell[45381, 1389, 360, 8, 70, "Notes",ExpressionUUID->"6aa0838f-d3a8-48a1-a83a-70da3dd322fa",
 CellID->227248759]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[45868, 1403, 1442, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"bea5f83a-a0d6-4b19-9fbe-174b199bfb16",
 CellTags->"PrimaryExamplesSection",
 CellID->1655495136],
Cell[47313, 1443, 202, 3, 70, "Input",ExpressionUUID->"2c6db76c-6694-48e6-8aa0-984c047178ac",
 CellID->556413652],
Cell[CellGroupData[{
Cell[47540, 1450, 1419, 37, 70, "ExampleSection",ExpressionUUID->"d6b629a6-3dc6-4ada-90c2-d3dec79ea3c3",
 CellID->1108620220],
Cell[48962, 1489, 204, 5, 70, "Input",ExpressionUUID->"26193668-5e1a-45d6-9db9-e6c4f4ebb71a",
 CellID->672243474],
Cell[49169, 1496, 130, 1, 70, "ExampleText",ExpressionUUID->"c1a81fd5-b438-406d-8fd5-420fb4683873",
 CellID->966966361],
Cell[49302, 1499, 219, 5, 70, "Input",ExpressionUUID->"a0629659-1e19-4b2f-b4af-c7e14e00ecf9",
 CellID->484600651],
Cell[CellGroupData[{
Cell[49546, 1508, 544, 16, 70, "Input",ExpressionUUID->"7e56a47c-a8db-4954-87f5-aad072021413",
 CellID->1425151933],
Cell[50093, 1526, 254, 5, 70, "Output",ExpressionUUID->"b49f7ae1-7bb5-450a-b35a-d08d0d45bc22",
 CellID->931228551],
Cell[50350, 1533, 126, 2, 70, "Output",ExpressionUUID->"77f312f0-e80d-45fb-af15-95becd77a98b",
 CellID->297437321]
}, Open  ]],
Cell[50491, 1538, 115, 1, 70, "ExampleText",ExpressionUUID->"fcb5fb98-63ca-47cd-a361-d09a27ad943f",
 CellID->1540884431],
Cell[CellGroupData[{
Cell[50631, 1543, 303, 8, 70, "Input",ExpressionUUID->"35429930-6284-429f-ac25-40f9499d58a8",
 CellID->1098093014],
Cell[50937, 1553, 4501, 98, 70, "Output",ExpressionUUID->"2065665f-46a6-4dae-ac64-5c50d7f0b5ea",
 CellID->1834607478]
}, Open  ]],
Cell[55453, 1654, 114, 1, 70, "ExampleText",ExpressionUUID->"2dd92c7f-c82e-4620-8f25-40e70eadfed3",
 CellID->569269380],
Cell[CellGroupData[{
Cell[55592, 1659, 293, 8, 70, "Input",ExpressionUUID->"32d4b158-ea0f-48db-994e-8cf0f1240bf8",
 CellID->1920729624],
Cell[55888, 1669, 144, 2, 70, "Output",ExpressionUUID->"88cc7510-458e-42ea-b0e1-0f2ddb9ab932",
 CellID->677679120]
}, Open  ]],
Cell[56047, 1674, 144, 1, 70, "ExampleText",ExpressionUUID->"4f7f552b-fef6-4494-800c-75f54a48642e",
 CellID->1970697472],
Cell[CellGroupData[{
Cell[56216, 1679, 216, 5, 70, "Input",ExpressionUUID->"08e7a380-358a-4db3-8f46-696fa8e53b07",
 CellID->1579083477],
Cell[56435, 1686, 163, 3, 70, "Output",ExpressionUUID->"cf3c9a30-f853-4040-a119-2e2df1446610",
 CellID->1647189799]
}, Open  ]],
Cell[56613, 1692, 173, 3, 70, "ExampleText",ExpressionUUID->"8c7853bf-9cb6-4031-a168-0d0254c3ec55",
 CellID->1682239748],
Cell[CellGroupData[{
Cell[56811, 1699, 294, 8, 70, "Input",ExpressionUUID->"7d7ad420-c3b8-4d90-8771-de1e2884b77f",
 CellID->487601425],
Cell[57108, 1709, 348, 9, 70, "Output",ExpressionUUID->"4988a5b8-cc86-4985-8316-a5f6afe9569b",
 CellID->1107258316]
}, Open  ]],
Cell[57471, 1721, 189, 4, 70, "ExampleText",ExpressionUUID->"985a1ff9-e075-4437-962b-689a4f91da33",
 CellID->1831286845],
Cell[CellGroupData[{
Cell[57685, 1729, 392, 10, 70, "Input",ExpressionUUID->"28282656-50a8-4567-ab3b-5d32ca26e822",
 CellID->1520012391],
Cell[58080, 1741, 296, 7, 70, "Output",ExpressionUUID->"cb0d5136-a4fc-4b1c-989d-43ace9b5538c",
 CellID->1744715757],
Cell[58379, 1750, 901, 23, 70, "Output",ExpressionUUID->"14a0417d-8833-42e8-a262-e871f3104dcf",
 CellID->1696011761]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[59429, 1781, 1411, 37, 70, "ExampleSection",ExpressionUUID->"498d9621-55b6-4759-a83f-b5d5b5e0acf2",
 CellID->1703330544],
Cell[CellGroupData[{
Cell[60865, 1822, 1421, 37, 70, "ExampleSubsection",ExpressionUUID->"5e2f89df-42c3-4865-9814-573b354c43ce",
 CellID->1625224184],
Cell[62289, 1861, 223, 5, 70, "Input",ExpressionUUID->"2687b572-9a79-49e5-9651-9f577febf143",
 CellID->866063270],
Cell[62515, 1868, 205, 5, 70, "Input",ExpressionUUID->"2558492b-478f-45a1-a6e3-104d9da72cd9",
 CellID->1774012929],
Cell[62723, 1875, 115, 1, 70, "ExampleText",ExpressionUUID->"22748576-a7d2-479a-a1fa-94b875eba9ec",
 CellID->1210812697],
Cell[CellGroupData[{
Cell[62863, 1880, 355, 9, 70, "Input",ExpressionUUID->"50040da1-051a-4f36-bfac-b478555a1a50",
 CellID->93372207],
Cell[63221, 1891, 608, 19, 70, "Output",ExpressionUUID->"e965ddf6-3562-4553-9167-3bb8355ac0ac",
 CellID->1319220496],
Cell[63832, 1912, 144, 3, 70, "Output",ExpressionUUID->"e77967bb-17b7-44a8-9627-8cdafd2a8494",
 CellID->1517704644]
}, Open  ]],
Cell[CellGroupData[{
Cell[64013, 1920, 277, 7, 70, "Input",ExpressionUUID->"c6ba407d-f80a-493b-a4dd-072c52ede775",
 CellID->1264054559],
Cell[64293, 1929, 5045, 110, 70, "Output",ExpressionUUID->"4bc1d2dd-85f6-433c-baf7-411a2809edbe",
 CellID->251192642]
}, Open  ]],
Cell[69353, 2042, 125, 1, 70, "ExampleText",ExpressionUUID->"6c8afae1-3465-42a0-8689-961cb1ae1558",
 CellID->645597649],
Cell[69481, 2045, 383, 11, 70, "Input",ExpressionUUID->"16c00151-7466-4f7d-a81d-5704922c4894",
 CellID->1538010568],
Cell[CellGroupData[{
Cell[69889, 2060, 202, 4, 70, "Input",ExpressionUUID->"3cdd784d-31c5-46ec-9740-825a9d09ebd5",
 CellID->2098320073],
Cell[70094, 2066, 172, 4, 70, "Output",ExpressionUUID->"956157f9-c828-426a-a2de-0b03b4a5610f",
 CellID->1989367739]
}, Open  ]],
Cell[CellGroupData[{
Cell[70303, 2075, 273, 7, 70, "Input",ExpressionUUID->"1849f303-76b0-48fa-8bcb-40e8a5db3bc5",
 CellID->1894606122],
Cell[70579, 2084, 5789, 175, 70, "Output",ExpressionUUID->"cd9ed6ec-5c07-4d5b-a98d-57e626bfa549",
 CellID->1130689230]
}, Open  ]],
Cell[CellGroupData[{
Cell[76405, 2264, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"4671f191-6666-4c28-874b-2770b7e88a64",
 CellID->706601561],
Cell[76650, 2271, 206, 5, 70, "Input",ExpressionUUID->"da83af4c-6d63-469b-bcee-4123d2d1a440",
 CellID->349864653],
Cell[76859, 2278, 220, 5, 70, "Input",ExpressionUUID->"7163b7fe-f0eb-4249-bb6e-bb5bc6e742e9",
 CellID->1138088487],
Cell[CellGroupData[{
Cell[77104, 2287, 571, 17, 70, "Input",ExpressionUUID->"271c9ded-b1a6-45eb-bd12-45548ad534dd",
 CellID->2147261437],
Cell[77678, 2306, 126, 2, 70, "Output",ExpressionUUID->"1839780d-7d8d-441d-bcdd-2618329309d5",
 CellID->411096307]
}, Open  ]],
Cell[CellGroupData[{
Cell[77841, 2313, 275, 7, 70, "Input",ExpressionUUID->"6a175fd2-e3a7-44fa-a93b-d49cb5bd8f36",
 CellID->745752491],
Cell[78119, 2322, 8161, 160, 70, "Output",ExpressionUUID->"ba781fbe-8eb6-42f2-8d1b-eab48caa5ad2",
 CellID->840739350]
}, Open  ]],
Cell[86295, 2485, 306, 8, 70, "Input",ExpressionUUID->"b1f05605-75ad-40ee-9708-1d58d06028d3",
 CellID->1123936882],
Cell[CellGroupData[{
Cell[86626, 2497, 342, 10, 70, "Input",ExpressionUUID->"87257ca3-06a6-4fc3-91f4-cc1f98724d2f",
 CellID->1756899605],
Cell[86971, 2509, 116, 1, 70, "EchoTiming",ExpressionUUID->"2c82639c-eefe-42ec-b7a5-a2677e92a841",
 CellID->2011341837]
}, Open  ]],
Cell[CellGroupData[{
Cell[87124, 2515, 305, 8, 70, "Input",ExpressionUUID->"5ca9b518-66b1-4ec0-8354-bd347bb34ef8",
 CellID->1891135613],
Cell[87432, 2525, 5014, 119, 70, "Output",ExpressionUUID->"dd0d243e-524f-4442-a674-ec129a8212b5",
 CellID->1082167032]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[92610, 2653, 1422, 37, 70, "ExampleSubsection",ExpressionUUID->"d2fec3eb-496e-4525-8f58-b611d4899368",
 CellID->976509307],
Cell[94035, 2692, 204, 5, 70, "Input",ExpressionUUID->"11e485f5-d1a6-424a-9c83-8f9d09e218c0",
 CellID->404620761],
Cell[94242, 2699, 220, 5, 70, "Input",ExpressionUUID->"d0843a2b-1d96-4623-a088-109b2778a93f",
 CellID->1527903725],
Cell[94465, 2706, 114, 1, 70, "ExampleText",ExpressionUUID->"4b64011d-a27e-4b50-8f7b-19cf75ce6897",
 CellID->645812421],
Cell[CellGroupData[{
Cell[94604, 2711, 498, 15, 70, "Input",ExpressionUUID->"6502ea10-188f-4767-b9f5-d499b62e39c2",
 CellID->2015938896],
Cell[95105, 2728, 254, 5, 70, "Output",ExpressionUUID->"37a0646d-3943-4bfc-ac4f-25aed435a811",
 CellID->942300381]
}, Open  ]],
Cell[CellGroupData[{
Cell[95396, 2738, 276, 7, 70, "Input",ExpressionUUID->"646e8b08-0fff-44f9-9c7b-856a6766d636",
 CellID->883939583],
Cell[95675, 2747, 4572, 100, 70, "Output",ExpressionUUID->"1672f956-98c7-4448-9ce9-d9576996edf3",
 CellID->1698090489]
}, Open  ]],
Cell[CellGroupData[{
Cell[100284, 2852, 334, 9, 70, "Input",ExpressionUUID->"a56bbad0-3634-4c63-b297-a46b868f164e",
 CellID->1288517488],
Cell[100621, 2863, 162, 3, 70, "Output",ExpressionUUID->"35fe6fe4-5d3c-4c3c-b5f2-c2d16e5551fc",
 CellID->1896663640]
}, Open  ]],
Cell[100798, 2869, 149, 1, 70, "ExampleText",ExpressionUUID->"f68821ad-0579-433b-bd81-7d72d1a80087",
 CellID->1991143895],
Cell[CellGroupData[{
Cell[100972, 2874, 299, 8, 70, "Input",ExpressionUUID->"24e0b6fd-63e7-45e6-84a8-7b2cf14b8ad5",
 CellID->763019732],
Cell[101274, 2884, 720, 18, 70, "Output",ExpressionUUID->"d3447a97-41ff-4ace-a791-e0f7cf6e1057",
 CellID->2126025059]
}, Open  ]],
Cell[102009, 2905, 199, 4, 70, "ExampleText",ExpressionUUID->"06107888-f3ec-43ad-afd4-95e232560edc",
 CellID->2001042392],
Cell[CellGroupData[{
Cell[102233, 2913, 1034, 30, 70, "Input",ExpressionUUID->"58c9a045-8746-4772-9624-547e19cc6c87",
 CellID->1840117499],
Cell[103270, 2945, 607, 19, 70, "Output",ExpressionUUID->"f7af90c5-29c4-47ce-95bf-e61050f0683d",
 CellID->122764180],
Cell[103880, 2966, 5046, 110, 70, "Output",ExpressionUUID->"1affde8d-c3de-4cae-b4c1-f2ea2a745bfe",
 CellID->1713272140],
Cell[108929, 3078, 533, 14, 70, "Output",ExpressionUUID->"de41b532-f12f-4bc0-bac0-95fc83e218b2",
 CellID->1504118004]
}, Open  ]],
Cell[CellGroupData[{
Cell[109499, 3097, 218, 5, 70, "Input",ExpressionUUID->"d96404ed-ea8e-4a6e-a31e-c45ccf4a5dc6",
 CellID->1440956291],
Cell[109720, 3104, 182, 4, 70, "Output",ExpressionUUID->"09d6395e-c0ed-4f6b-91fc-c704cdb75959",
 CellID->1681284391]
}, Open  ]],
Cell[CellGroupData[{
Cell[109939, 3113, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"66db23f4-bbdf-44c2-acc2-f1c0c7b1e2dd",
 CellID->1767104397],
Cell[110185, 3120, 204, 5, 70, "Input",ExpressionUUID->"fc084e16-b239-4bf2-85c1-fdeafd9652fc",
 CellID->24762369],
Cell[110392, 3127, 220, 5, 70, "Input",ExpressionUUID->"624a85b7-3cc1-40ef-882f-8ef47e250890",
 CellID->1716791912],
Cell[CellGroupData[{
Cell[110637, 3136, 570, 17, 70, "Input",ExpressionUUID->"6f8563e8-19c4-45e0-b94a-4f225b13e672",
 CellID->531383892],
Cell[111210, 3155, 126, 2, 70, "Output",ExpressionUUID->"78267807-1af5-4b9e-9328-56cc8aa69a89",
 CellID->756932311]
}, Open  ]],
Cell[CellGroupData[{
Cell[111373, 3162, 276, 7, 70, "Input",ExpressionUUID->"795dc488-469b-4d19-864b-697fc66420e5",
 CellID->1736427641],
Cell[111652, 3171, 5813, 121, 70, "Output",ExpressionUUID->"4176097c-75c6-4e16-9f2a-612771892c0a",
 CellID->68226149]
}, Open  ]],
Cell[117480, 3295, 305, 8, 70, "Input",ExpressionUUID->"5fd19029-33f9-45b0-84c2-6f2c929fc352",
 CellID->360339012],
Cell[CellGroupData[{
Cell[117810, 3307, 362, 10, 70, "Input",ExpressionUUID->"23c0261a-17ff-4a2e-9460-25e42897b57d",
 CellID->313890144],
Cell[118175, 3319, 116, 1, 70, "EchoTiming",ExpressionUUID->"d164dcf2-b871-467c-a582-f9ce3bc9f534",
 CellID->2068102392]
}, Open  ]],
Cell[CellGroupData[{
Cell[118328, 3325, 393, 11, 70, "Input",ExpressionUUID->"ebec4c49-55b2-4ff8-b28e-75a55a7b9915",
 CellID->1745720274],
Cell[118724, 3338, 3863, 91, 70, "Output",ExpressionUUID->"0ec6e7c6-7497-494a-880b-4d4f4fe6a67f",
 CellID->1574075649]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[122751, 3438, 1428, 37, 70, "ExampleSubsection",ExpressionUUID->"e5290ba9-23ab-41c4-86fc-03544ef414a8",
 CellID->38255620],
Cell[124182, 3477, 204, 5, 70, "Input",ExpressionUUID->"8a342f33-67de-4602-9be5-3e500e9c72ff",
 CellID->864594887],
Cell[124389, 3484, 220, 5, 70, "Input",ExpressionUUID->"156d3c33-f9e4-4151-b77e-289034b5cbf0",
 CellID->1371910207],
Cell[124612, 3491, 114, 1, 70, "ExampleText",ExpressionUUID->"63a1f118-7a8c-4865-bac2-ae3836c7a102",
 CellID->162931210],
Cell[CellGroupData[{
Cell[124751, 3496, 497, 15, 70, "Input",ExpressionUUID->"e2f90372-d6f4-4236-999f-fb0fd2b1486a",
 CellID->343196545],
Cell[125251, 3513, 254, 5, 70, "Output",ExpressionUUID->"4829233c-ef89-477b-aa81-3e805fea64be",
 CellID->638385350]
}, Open  ]],
Cell[CellGroupData[{
Cell[125542, 3523, 276, 7, 70, "Input",ExpressionUUID->"9bebcc27-8b63-4d37-8ec9-0e1fada55f4f",
 CellID->918428547],
Cell[125821, 3532, 4571, 100, 70, "Output",ExpressionUUID->"e95c63c2-0206-448a-bd6e-3ff40581ce00",
 CellID->514277038]
}, Open  ]],
Cell[CellGroupData[{
Cell[130429, 3637, 334, 9, 70, "Input",ExpressionUUID->"123af4af-0299-4673-a918-8b25b9bc4f21",
 CellID->1374222030],
Cell[130766, 3648, 162, 3, 70, "Output",ExpressionUUID->"942ed6f7-7e2b-4be0-a2d4-cd2ed60e6053",
 CellID->1979982138]
}, Open  ]],
Cell[130943, 3654, 192, 4, 70, "ExampleText",ExpressionUUID->"c75179a0-1ca9-40d8-b756-af83a723825b",
 CellID->523581948],
Cell[131138, 3660, 296, 8, 70, "Input",ExpressionUUID->"b2f8faa5-e2d4-40f7-b590-6e235b2f332e",
 CellID->1601298277],
Cell[CellGroupData[{
Cell[131459, 3672, 165, 3, 70, "Input",ExpressionUUID->"eac711d2-0d8b-41a6-961d-4f5d2d4ccebe",
 CellID->450237662],
Cell[131627, 3677, 538, 14, 70, "Output",ExpressionUUID->"fbedca38-e43d-4339-a5fc-f6b9c1d77285",
 CellID->153199454]
}, Open  ]],
Cell[CellGroupData[{
Cell[132202, 3696, 200, 4, 70, "Input",ExpressionUUID->"c1a03644-b03d-4de0-949f-4b92ea1dbcac",
 CellID->30274202],
Cell[132405, 3702, 1751, 40, 70, "Output",ExpressionUUID->"b86e34ed-d3b3-4fd5-932b-613e022ace74",
 CellID->2137814272]
}, Open  ]],
Cell[CellGroupData[{
Cell[134193, 3747, 347, 9, 70, "Input",ExpressionUUID->"dc0a84f8-adbf-42cc-95fd-2e87d61976d1",
 CellID->429782927],
Cell[134543, 3758, 540, 14, 70, "Output",ExpressionUUID->"8410ce12-0091-42b1-8241-43df5e827f8f",
 CellID->695571547]
}, Open  ]],
Cell[CellGroupData[{
Cell[135120, 3777, 217, 5, 70, "Input",ExpressionUUID->"40e35a47-f37d-44fd-a6ff-964df0a3651d",
 CellID->379226317],
Cell[135340, 3784, 183, 4, 70, "Output",ExpressionUUID->"267cc461-158e-4c04-8e7b-164012214e81",
 CellID->1717499808]
}, Open  ]],
Cell[CellGroupData[{
Cell[135560, 3793, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"df3a2bf1-10c4-4138-97e7-069f76609fd7",
 CellID->512088563],
Cell[135805, 3800, 206, 5, 70, "Input",ExpressionUUID->"435dd71f-e3c5-4002-a090-114ecfad736a",
 CellID->1705504812],
Cell[136014, 3807, 220, 5, 70, "Input",ExpressionUUID->"d88bb6d4-f549-4ffa-9fdb-44000f333ad1",
 CellID->1955138775],
Cell[CellGroupData[{
Cell[136259, 3816, 571, 17, 70, "Input",ExpressionUUID->"88fb567d-c1f6-482e-ac7c-87cafa3caf59",
 CellID->1370108678],
Cell[136833, 3835, 127, 2, 70, "Output",ExpressionUUID->"9e39327a-82b1-47ab-a56c-8cc2aa2a8f17",
 CellID->1691573729]
}, Open  ]],
Cell[CellGroupData[{
Cell[136997, 3842, 275, 7, 70, "Input",ExpressionUUID->"5f56d12a-a5df-4bf8-aeed-8f28ca05ad6e",
 CellID->42686767],
Cell[137275, 3851, 5815, 121, 70, "Output",ExpressionUUID->"30946801-a031-4322-baac-cad3c905e1ef",
 CellID->1891144317]
}, Open  ]],
Cell[143105, 3975, 306, 8, 70, "Input",ExpressionUUID->"c8b3e2d1-0ec1-4cde-8aee-693093a845e5",
 CellID->1963149449],
Cell[CellGroupData[{
Cell[143436, 3987, 336, 9, 70, "Input",ExpressionUUID->"179a3cac-9611-48d5-896d-ecf4ffcaf6c8",
 CellID->714036835],
Cell[143775, 3998, 115, 1, 70, "EchoTiming",ExpressionUUID->"7f1f2cf0-26c5-4cfe-951a-84c57ad01589",
 CellID->1704560219]
}, Open  ]],
Cell[CellGroupData[{
Cell[143927, 4004, 393, 11, 70, "Input",ExpressionUUID->"cd72f68b-b1b3-4a35-a24b-2e4aab67199a",
 CellID->1994254140],
Cell[144323, 4017, 3852, 82, 70, "Output",ExpressionUUID->"5459de54-ed5a-43ce-b24e-4230b6b1dd2c",
 CellID->1111749753]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed]]]],
Cell[CellGroupData[{
Cell[148339, 4108, 1428, 37, 70, "ExampleSubsection",ExpressionUUID->"35260baa-ddd8-4817-8df5-c861532f750d",
 CellID->729870429],
Cell[149770, 4147, 220, 5, 70, "Input",ExpressionUUID->"82579151-7c32-47be-a8c1-fab0666fc900",
 CellID->1888803347],
Cell[149993, 4154, 114, 1, 70, "ExampleText",ExpressionUUID->"50bee4f6-18a5-477b-90ad-bf725ff15181",
 CellID->891018326],
Cell[CellGroupData[{
Cell[150132, 4159, 476, 14, 70, "Input",ExpressionUUID->"e9244c25-eca4-4ca5-bcb5-426535ad2902",
 CellID->1014583075],
Cell[150611, 4175, 255, 5, 70, "Output",ExpressionUUID->"779f6f80-102a-4821-a5e3-62a9d9d5b636",
 CellID->2070369771]
}, Open  ]],
Cell[CellGroupData[{
Cell[150903, 4185, 221, 5, 70, "Input",ExpressionUUID->"45eb213a-fce0-4b21-980d-5c4c2ea23ed9",
 CellID->599153438],
Cell[151127, 4192, 4497, 98, 70, "Output",ExpressionUUID->"7baca7e5-b356-4258-a3b0-c6d9bd3776e1",
 CellID->1027208856]
}, Open  ]],
Cell[155639, 4293, 138, 1, 70, "ExampleText",ExpressionUUID->"e4496a22-d533-4f37-86dd-f73d3a65882b",
 CellID->316224040],
Cell[CellGroupData[{
Cell[155802, 4298, 294, 8, 70, "Input",ExpressionUUID->"8746311f-bafa-4e93-95f9-e94be3441ca1",
 CellID->2132222963],
Cell[156099, 4308, 144, 2, 70, "Output",ExpressionUUID->"09f57235-e4c3-4297-b67c-a3b4fb5bd805",
 CellID->678204559]
}, Open  ]],
Cell[CellGroupData[{
Cell[156280, 4315, 297, 8, 70, "Input",ExpressionUUID->"e7f20388-706e-4eeb-9718-dc7d2799ff4c",
 CellID->818380663],
Cell[156580, 4325, 1675, 34, 70, "Output",ExpressionUUID->"5714e9c0-39c0-4c44-8720-ae1eb3b9c1a9",
 CellID->1888308484]
}, Open  ]],
Cell[CellGroupData[{
Cell[158292, 4364, 246, 6, 70, "Input",ExpressionUUID->"4dbb8bbc-7684-47de-8771-9f2d19ce26bd",
 CellID->580159733],
Cell[158541, 4372, 127, 2, 70, "Output",ExpressionUUID->"3c807b9f-fa33-4b39-97ba-6bfff21b9d58",
 CellID->1287355222]
}, Open  ]],
Cell[158683, 4377, 253, 4, 70, "ExampleText",ExpressionUUID->"903f166f-78d7-483b-b9fa-a9fa4c93bdfd",
 CellID->1948001229],
Cell[CellGroupData[{
Cell[158961, 4385, 663, 18, 70, "Input",ExpressionUUID->"95f2fd20-6d75-4b0d-ab0d-db37001f6c1a",
 CellID->104260101],
Cell[159627, 4405, 607, 19, 70, "Output",ExpressionUUID->"78df5d36-976a-421e-b345-450ec9b81b88",
 CellID->681472629],
Cell[160237, 4426, 3004, 89, 70, "Output",ExpressionUUID->"2457dd32-56e5-4924-987c-bc56f65a574b",
 CellID->980186152]
}, Open  ]],
Cell[CellGroupData[{
Cell[163278, 4520, 450, 13, 70, "Input",ExpressionUUID->"83cbf6a7-d836-4b43-b87d-f63a2e5a3225",
 CellID->447088284],
Cell[163731, 4535, 1462, 30, 70, "Output",ExpressionUUID->"76244018-b0be-4fe4-ab4a-73b3eb1805a4",
 CellID->641600527]
}, Open  ]],
Cell[165208, 4568, 132, 1, 70, "ExampleText",ExpressionUUID->"5038d434-044f-48fb-9bc3-203c298ecb1a",
 CellID->1592012364],
Cell[CellGroupData[{
Cell[165365, 4573, 253, 7, 70, "Input",ExpressionUUID->"3bc487b5-629d-40b6-a192-b922612e9387",
 CellID->2109008775],
Cell[165621, 4582, 624, 18, 70, "Output",ExpressionUUID->"c809637d-66f6-46ac-b4bc-b4067698a13e",
 CellID->864665702]
}, Open  ]],
Cell[CellGroupData[{
Cell[166282, 4605, 241, 5, 70, "ExampleDelimiter",ExpressionUUID->"d67b05c0-1501-41d6-8ca0-c01f3c78b6f0",
 CellID->16707169],
Cell[166526, 4612, 220, 5, 70, "Input",ExpressionUUID->"45d60a4a-7dcb-4302-9364-aac3c2d466d1",
 CellID->1832672994],
Cell[166749, 4619, 200, 6, 70, "ExampleText",ExpressionUUID->"0bca8656-a62a-4ef8-8de8-f1f3ed72fe00",
 CellID->377061237],
Cell[CellGroupData[{
Cell[166974, 4629, 818, 25, 70, "Input",ExpressionUUID->"5f1b1c8c-1de5-4bc4-9422-451a0d197f52",
 CellID->43967962],
Cell[167795, 4656, 126, 2, 70, "Output",ExpressionUUID->"0004f0b8-fe01-4523-9690-a92da12a496a",
 CellID->414614265],
Cell[167924, 4660, 127, 2, 70, "Output",ExpressionUUID->"8e76741a-9058-45ff-bf85-a39d90e179b2",
 CellID->1985000987],
Cell[168054, 4664, 242, 6, 70, "Output",ExpressionUUID->"7037df84-76e8-4524-b807-345cbe0ea010",
 CellID->753132364]
}, Open  ]],
Cell[CellGroupData[{
Cell[168333, 4675, 275, 7, 70, "Input",ExpressionUUID->"d40a1744-72a0-428c-b246-baea1f938e41",
 CellID->200293604],
Cell[168611, 4684, 4466, 97, 70, "Output",ExpressionUUID->"f8d60c97-a8b7-416d-9ba4-11d18ec32cf5",
 CellID->627026330]
}, Open  ]],
Cell[173092, 4784, 139, 1, 70, "ExampleText",ExpressionUUID->"3dc17e5c-ba2a-4b6f-8add-a82061c748a2",
 CellID->1394539877],
Cell[CellGroupData[{
Cell[173256, 4789, 293, 8, 70, "Input",ExpressionUUID->"dbe7693f-b431-4740-bb50-c7fa4adcbce6",
 CellID->395189381],
Cell[173552, 4799, 144, 2, 70, "Output",ExpressionUUID->"2a359298-8c9a-4b34-b839-648828149082",
 CellID->729272481]
}, Open  ]],
Cell[CellGroupData[{
Cell[173733, 4806, 297, 8, 70, "Input",ExpressionUUID->"45944f54-f4fe-4760-bf04-8db4a8760980",
 CellID->159787830],
Cell[174033, 4816, 1690, 38, 70, "Output",ExpressionUUID->"a14f711f-eb92-4bf3-96d4-7d3d46f3bbe8",
 CellID->1193414738]
}, Open  ]],
Cell[CellGroupData[{
Cell[175760, 4859, 247, 6, 70, "Input",ExpressionUUID->"122a8587-0c01-4397-90ef-53b3f2bb0d15",
 CellID->1568514031],
Cell[176010, 4867, 126, 2, 70, "Output",ExpressionUUID->"5ab832b8-954a-46c0-a93d-ca40c47dba38",
 CellID->224238586]
}, Open  ]],
Cell[176151, 4872, 252, 4, 70, "ExampleText",ExpressionUUID->"cd4be782-dfad-4284-8f94-964d7d7f1c62",
 CellID->664134417],
Cell[CellGroupData[{
Cell[176428, 4880, 721, 20, 70, "Input",ExpressionUUID->"96868676-ce2d-43d4-a6c5-1aa6236935a1",
 CellID->1634633060],
Cell[177152, 4902, 608, 19, 70, "Output",ExpressionUUID->"8bfbec65-34bd-4ecb-b530-28830f63e35c",
 CellID->2091598064],
Cell[177763, 4923, 16167, 420, 70, "Output",ExpressionUUID->"285cad53-1216-45c9-ab11-59c3b82b6d5e",
 CellID->1328843905]
}, Open  ]],
Cell[CellGroupData[{
Cell[193967, 5348, 450, 13, 70, "Input",ExpressionUUID->"1384bcd8-3c3a-40bd-a4f0-3ecb09562f5a",
 CellID->2087253347],
Cell[194420, 5363, 1462, 34, 70, "Output",ExpressionUUID->"374bcc8c-c329-4b90-aeba-a639367a0e23",
 CellID->49582535]
}, Open  ]],
Cell[195897, 5400, 132, 1, 70, "ExampleText",ExpressionUUID->"1c4d1315-8ea2-47ad-88ae-2db90b1446bc",
 CellID->1200015267],
Cell[CellGroupData[{
Cell[196054, 5405, 253, 7, 70, "Input",ExpressionUUID->"2ee5b5a8-cfcb-444f-bbbf-b83f8a97ca49",
 CellID->1637663492],
Cell[196310, 5414, 624, 18, 70, "Output",ExpressionUUID->"022e7081-4786-4ca4-a460-fdea4dd5ea04",
 CellID->110010709]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196983, 5438, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"9a527ed0-6d88-4d41-9129-a7934e34af67",
 CellID->486630493],
Cell[197228, 5445, 220, 5, 70, "Input",ExpressionUUID->"d64ed777-e981-4394-9646-b6b34aa0d5f2",
 CellID->1180968075],
Cell[197451, 5452, 201, 6, 70, "ExampleText",ExpressionUUID->"2d7f6e8f-1bc3-429c-9c9e-623d2a9e8417",
 CellID->1486570951],
Cell[CellGroupData[{
Cell[197677, 5462, 846, 26, 70, "Input",ExpressionUUID->"8a3d3c20-22c0-49bf-b878-4d1d5e5ed617",
 CellID->973224259],
Cell[198526, 5490, 127, 2, 70, "Output",ExpressionUUID->"326059fb-02e5-4698-981e-eec49d5f94d8",
 CellID->2114049743],
Cell[198656, 5494, 127, 2, 70, "Output",ExpressionUUID->"c7392917-189e-452e-81b8-18639bb71559",
 CellID->717090986]
}, Open  ]],
Cell[CellGroupData[{
Cell[198820, 5501, 276, 7, 70, "Input",ExpressionUUID->"2f4e7611-5f37-4ecc-b637-8e66da2557f6",
 CellID->1678153624],
Cell[199099, 5510, 5446, 113, 70, "Output",ExpressionUUID->"2503fefc-e517-4aab-af4f-1d13b210c45a",
 CellID->469974738]
}, Open  ]],
Cell[204560, 5626, 139, 1, 70, "ExampleText",ExpressionUUID->"3306ea47-4343-4d1c-a71e-c60c39dc7f19",
 CellID->1858429471],
Cell[204702, 5629, 306, 8, 70, "Input",ExpressionUUID->"9e66a2c3-8255-4098-8fe2-dd7a60d3051d",
 CellID->1621957129],
Cell[CellGroupData[{
Cell[205033, 5641, 361, 10, 70, "Input",ExpressionUUID->"1bd969fe-9a88-4a85-b092-4d195716b0be",
 CellID->454622630],
Cell[205397, 5653, 115, 1, 70, "EchoTiming",ExpressionUUID->"eaec5b38-448d-4f51-b554-cd08d45cf06d",
 CellID->420567900]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "3"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[205788, 5666, 1417, 37, 70, "ExampleSection",ExpressionUUID->"e48a756d-7f75-4393-a150-47cb3c394b69",
 CellID->701469844],
Cell[207208, 5705, 249, 4, 70, "ExampleText",ExpressionUUID->"fa15f909-2bc4-41d0-9389-dd1183996f30",
 CellID->411726774],
Cell[207460, 5711, 219, 5, 70, "Input",ExpressionUUID->"5041975e-b75b-441a-8e25-043409a0a447",
 CellID->271315786],
Cell[CellGroupData[{
Cell[207704, 5720, 480, 13, 70, "Input",ExpressionUUID->"5d9a4315-2ec3-412b-b3a7-7bf50ad0fe0e",
 CellID->1529848425],
Cell[208187, 5735, 129, 2, 70, "Output",ExpressionUUID->"052272f9-6b14-4d72-8b0b-7a09d3c4573b",
 CellID->1116013023],
Cell[208319, 5739, 143, 3, 70, "Output",ExpressionUUID->"a131c2b5-50ff-4b2b-a842-bce036e66854",
 CellID->708704663]
}, Open  ]],
Cell[208477, 5745, 144, 1, 70, "ExampleText",ExpressionUUID->"e0b8ca76-d9e8-4cea-b18d-5e875229f896",
 CellID->263062639],
Cell[CellGroupData[{
Cell[208646, 5750, 833, 25, 70, "Input",ExpressionUUID->"04e0758d-d9b2-496c-a1a9-ecf9ade9e9e3",
 CellID->252225698],
Cell[209482, 5777, 127, 2, 70, "Output",ExpressionUUID->"d1fb5ba5-63da-4315-baf0-f8fc3c04dc9c",
 CellID->487988694],
Cell[209612, 5781, 9362, 178, 70, "Output",ExpressionUUID->"b2bb1dcc-8178-4a3b-a127-684778e4db68",
 CellID->385932165]
}, Open  ]],
Cell[218989, 5962, 177, 3, 70, "ExampleText",ExpressionUUID->"ee2e70c2-30c6-4218-8bda-c354a135225a",
 CellID->783735018],
Cell[CellGroupData[{
Cell[219191, 5969, 302, 7, 70, "Input",ExpressionUUID->"74641d32-f9a3-40c2-a051-29410c63e80b",
 CellID->553874063],
Cell[219496, 5978, 10600, 199, 70, "Output",ExpressionUUID->"3aa17772-9bda-4012-9d36-210238e7e02f",
 CellID->961283215]
}, Open  ]],
Cell[230111, 6180, 159, 2, 70, "ExampleText",ExpressionUUID->"0fbd86c8-62f8-4b34-95ae-d384ccc32946",
 CellID->789353421],
Cell[230273, 6184, 305, 8, 70, "Input",ExpressionUUID->"63ba8374-baef-4fcc-8f71-8e439770940f",
 CellID->210476177],
Cell[230581, 6194, 152, 1, 70, "ExampleText",ExpressionUUID->"27e98840-a961-426c-b951-2658a2afdef1",
 CellID->1365905885],
Cell[CellGroupData[{
Cell[230758, 6199, 276, 7, 70, "Input",ExpressionUUID->"25379d50-bdc6-4ded-9375-d448b5d7cb22",
 CellID->192749570],
Cell[231037, 6208, 115, 1, 70, "EchoTiming",ExpressionUUID->"451a7857-0c5d-46bc-8f4d-0c22f8180c56",
 CellID->767518124]
}, Open  ]],
Cell[231167, 6212, 147, 1, 70, "ExampleText",ExpressionUUID->"42a73604-b8d8-46bc-a448-f047693da73c",
 CellID->988870704],
Cell[CellGroupData[{
Cell[231339, 6217, 276, 7, 70, "Input",ExpressionUUID->"10b4a33a-8d51-40d2-8571-6a9779256322",
 CellID->482833766],
Cell[231618, 6226, 116, 1, 70, "EchoTiming",ExpressionUUID->"98cf8a5b-7653-4492-bcf0-3df6f50fcb60",
 CellID->1890326186]
}, Open  ]],
Cell[231749, 6230, 140, 1, 70, "ExampleText",ExpressionUUID->"5ff40eb9-a854-4d00-9f98-2b5cfb5b3f96",
 CellID->603496782],
Cell[CellGroupData[{
Cell[231914, 6235, 280, 7, 70, "Input",ExpressionUUID->"caa67510-f69a-40f6-b183-c57b9d1b7c18",
 CellID->857850345],
Cell[232197, 6244, 143, 3, 70, "Output",ExpressionUUID->"05feac9d-159e-42ba-8e50-34481da2e165",
 CellID->839134384]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[232582, 6256, 2487, 66, 70, "SeeAlsoSection",ExpressionUUID->"68aad467-6fc5-4b7f-a7e1-4784042cc884"],
Cell[235072, 6324, 2211, 56, 70, "TechNotesSection",ExpressionUUID->"73a13e13-3bf0-4dd4-96b9-d4a700ee2899"],
Cell[237286, 6382, 2223, 55, 70, "MoreAboutSection",ExpressionUUID->"1d49991a-77ad-4aa9-8da8-c308ef30429b"],
Cell[239512, 6439, 8163, 213, 70, "RelatedLinksSection",ExpressionUUID->"b0ea76e3-2fb6-440d-a559-1b816a80573a"],
Cell[247678, 6654, 78, 0, 70, "FooterCell",ExpressionUUID->"7c30b484-b82f-4081-8c0d-a8ec042a935a"]
}
]
*)

(* End of internal cache information *)
