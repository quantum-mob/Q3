(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    279556,       7296]
NotebookOptionsPosition[    247221,       6644]
NotebookOutlinePosition[    250121,       6712]
CellTagsIndexPosition[    250034,       6707]
WindowTitle->QSP
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "bc35fb5c-672b-492c-9027-b3bc3d3f752b"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "bd6a201e-9f9a-4963-8004-9941b8ee7752"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "f4abd262-198e-4a8f-b9bc-74eb73aadf39"]
         }],ExpressionUUID->"79ade61b-0224-486d-bbae-390509854f7b"],
         StripOnInput->False],{
        StyleBox["\"QSPFind\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/QSPFind"], 
         StyleBox["\"QSPConvert\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/QSPConvert"], 
         StyleBox[
          "\"ChebyshevCoefficients\"", "SeeAlsoRelated", StripOnInput -> 
           False] :> Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/ChebyshevCoefficients"], 
         StyleBox[
          "\"ChebyshevSeries\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/ChebyshevSeries"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "4c60c2c6-46f5-465c-ad5f-a2406bcb9fac"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "34eee806-aef0-495c-a55e-9e0b37f36120"]
         }],ExpressionUUID->"1ab97a1a-cc53-4b58-8938-281f8c8dc232"],
         StripOnInput->False],{
        "\"Quantum Signal Processing\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumSignalProcessing"], 
         "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumSpinSystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "f69eed13-3f70-411c-ab97-c7a979e154ec"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "4151de3a-0c21-4f0c-93e3-438ac83ecb0e"]
         }],ExpressionUUID->"ff8b5a39-fec0-4205-8c33-d554360621e8"],
         StripOnInput->False],{
        "\"Quantum Signal Processing\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumSignalProcessing"], 
         "\"Quantum Linear System Problems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumLinearSystemProblems"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"], 
         "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Quantum Spin Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumSpinSystems"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "c7e2d839-38df-41f9-a79e-b954e6018fd9"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "13b21b7b-2e98-425b-908b-d479a8df813e"]
         }],ExpressionUUID->"d74b0920-52a5-4c6b-9d14-678a5f7f9644"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/QSP\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/QSP"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
QSP.html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]}, 
               Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/QSP") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "882a9d4c-bd3e-42cb-9276-0639e558faae"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "ec25a504-e2c8-413d-9545-1ed52f4b551a"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"7a7aa697-aa27-4c36-8969-116b80f0ef21"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"c8a55e6b-05b1-419e-94b5-cfa4fd45a732"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "QSP", "ObjectName",ExpressionUUID->
      "f4d16a02-4b22-40da-a96a-f0722cf6e25b"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"31bb7fe5-7bb1-42c8-aad8-f5a38f0c01e9"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "4fa1e984-4d03-4748-aab1-0ac76533b6aa"]
    }],ExpressionUUID->"6a467a85-cafd-435c-9b30-f8657d2bb541"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.0\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->LightDarkSwitched[
              RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "2e7c2589-0c29-473b-8b71-15ba9799d109"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"367367cf-21e6-459f-ac0f-a6dd709ad2ec"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["0", "TR"]], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["1", "TR"]], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["2", "TR"]], ",", 
         StyleBox["\[Ellipsis]", "TR"], ",", 
         SubscriptBox[
          StyleBox["\[Phi]", "TR"], 
          StyleBox["d", "TI"]]}], "}"}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "36a54561-2abf-494e-80d8-2f8fd98d9c58"],
     "\[LineSeparator]represents the quantum signal processing of degree ",
     Cell[BoxData[
      StyleBox["d", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "86b3118f-4e15-42d3-a913-85e9bb3b5d92"],
     " with ",
     StyleBox["full",
      FontSlant->"Italic"],
     " phase vector ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["0", "TR"]], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["\[Phi]", "TR"], 
         StyleBox["d", "TI"]]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "d4ec67df-7ced-4a30-b860-1ed2ac17a11f"],
     "."
    }],ExpressionUUID->"3a9ce226-d2bd-4c25-a6cc-19b8f50ccee5"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{"{", 
        RowBox[{
         StyleBox[
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], ",", 
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], ",", 
            StyleBox["\[Ellipsis]", "TR"]}], "}"}], "TI"], 
         StyleBox[",", "TI"], ",", 
         StyleBox["parity", "TI"]}], 
        StyleBox["}", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "dca5d505-cee8-4d33-9828-69c1a9e9e598"],
     "\[LineSeparator]represents the ",
     StyleBox["symmetric",
      FontSlant->"Italic"],
     " quantum signal processing associated with ",
     StyleBox["reduced",
      FontSlant->"Italic"],
     " phase vector ",
     Cell[BoxData[
      RowBox[{
       RowBox[{
        StyleBox["{", "TI"], 
        RowBox[{
         RowBox[{
          StyleBox["{", "TI"], 
          RowBox[{
           StyleBox[
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], "TI"], 
           StyleBox[",", "TI"], 
           StyleBox[
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], "TI"], 
           StyleBox[",", "TI"], 
           StyleBox["\[Ellipsis]", "TR"]}], 
          StyleBox["}", "TI"]}], 
         StyleBox[",", "TI"], 
         StyleBox["parity", "TI"]}], 
        StyleBox["}", "TI"]}], 
       StyleBox[",", "TI"]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "341ae690-1fe6-4951-959a-bfd7c94465d6"],
     " where ",
     Cell[BoxData[
      RowBox[{
       StyleBox["parity", "TI"], "=", 
       RowBox[{"\[PlusMinus]", "1"}]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "871c868c-6e0f-4da1-80f2-02ceafd3df32"],
     " for even and odd, respectively."
    }],ExpressionUUID->"6cf90efb-706d-4e38-a766-059e9c7415cf"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["0", "TR"]], ",", 
            SubscriptBox[
             StyleBox["\[Phi]", "TR"], 
             StyleBox["1", "TR"]], ",", 
            StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
          StyleBox["parity", "TI"]}], "}"}], ",", 
        StyleBox["post", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "44583aeb-29a5-4919-b173-32acfe9e7158"],
     "\[LineSeparator]is equivalent to ",
     Cell[BoxData[
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          TemplateBox[{
            Cell[
             TextData["Composition"]], "paclet:ref/Composition"},
           "RefLink",
           BaseStyle->{"InlineFormula"}], "[", 
          RowBox[{
           StyleBox["post", "TI"], ",", 
           RowBox[{"QSP", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox[
                StyleBox["\[Phi]", "TR"], 
                StyleBox["0", "TR"]], ",", 
               SubscriptBox[
                StyleBox["\[Phi]", "TR"], 
                StyleBox["1", "TR"]], ",", 
               StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
             StyleBox["parity", "TI"]}]}]}]}], "}"}], "]"}], "]"}]], 
      "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "5b6c7117-23d8-46a2-95db-e918542bd22d"],
     "."
    }],ExpressionUUID->"f06e64f8-afad-4542-b583-95b0942aa37c"]}
  }]], "Usage",
 CellID->1887563293,ExpressionUUID->"93a06ec9-8b9c-4f4e-805b-d5d7a82b658f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[CurrentValue[
         EvaluationCell[], "CellGroupOpen"] =!= Closed, 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"e2993db7-eaa6-4334-a49a-2af9f1211d13"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"986306a9-2fe7-4ab3-9e76-a6ec4a0ac71d"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"82a24a92-8849-4116-8289-78a327ee4474"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"a452f478-1243-4208-a1ee-3b959ee818fe"]], \
"NotesSection",
 ShowGroupOpener->"Thumbnail",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->1004852458,ExpressionUUID->"c1ee34af-360d-41b9-86a5-ecfde1532ec2"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   StyleBox["x", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "d9f50066-5039-41db-8e34-fbcdb400ee62"],
 " returns the value ",
 Cell[BoxData[
  StyleBox["y", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "58fa810f-7fa8-4dfd-ae2e-a70d98df4a4b"],
 " at ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "67ef6e67-e5a1-400c-873a-9b7d2bdc40d7"],
 " of the polynomial that ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   StyleBox["spec", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "b125abb0-aedc-456c-aa94-88c6edae535e"],
 " represents. ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      StyleBox["x", "TI"], 
      StyleBox["1", "TR"]], ",", 
     SubscriptBox[
      StyleBox["x", "TI"], 
      StyleBox["2", "TR"]], ",", 
     StyleBox["\[Ellipsis]", "TR"]}], "}"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "763b1633-4bea-4c2c-834b-a89f1316ee88"],
 " returns the list ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     StyleBox["y", "TI"], 
     StyleBox["1", "TR"]], ",", 
    SubscriptBox[
     StyleBox["y", "TI"], 
     StyleBox["2", "TR"]], ",", 
    StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "80b51a5b-1fa7-4eac-b60b-78d378b6e2b8"],
 " of values at ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["1", "TR"]], ",", 
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["2", "TR"]], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "626fcfcc-abaa-4c24-81ae-e8991b53a90b"],
 "."
}], "Notes",
 CellID->915826333,ExpressionUUID->"4ad85537-52ae-4c86-9532-049572e03589"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Gradient"]], "paclet:ref/Gradient"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    TemplateBox[{
      Cell[
       TextData["x"]], "paclet:QuantumMob/Q3/ref/x"},
     "RefLink",
     BaseStyle->{"InlineFormula", "TI"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "8625b609-abf5-47a7-a386-312a8a8f1bad"],
 " returns ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     StyleBox["y", "TI"], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        StyleBox["g", "TI"], 
        StyleBox["1", "TR"]], ",", 
       SubscriptBox[
        StyleBox["g", "TI"], 
        StyleBox["2", "TR"]], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}]}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "592a7b3a-36a7-4b21-b3e6-c2daa48e506a"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["i", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      TemplateBox[{
        Cell[
         TextData["x"]], "paclet:QuantumMob/Q3/ref/x"},
       "RefLink",
       BaseStyle->{"InlineFormula", "TI"}], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TI"], 
      StyleBox["i", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "1b76b0a9-4f83-4424-8d0b-f4890f8a18ea"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Gradient"]], "paclet:ref/Gradient"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f5bef0d8-8a60-466b-b93b-107abdef6665"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["y", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["y", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["g", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "6a9bbc62-4fe0-42bd-9f1d-84c6980d6215"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["i", "TI"]], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "cc1e417b-74be-4516-822a-670dccd0c0b4"],
 "."
}], "Notes",
 CellID->1931150725,ExpressionUUID->"276353f2-48d6-40b5-ba27-9a2302b461ce"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Hessian"]], "paclet:ref/Hessian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    StyleBox["x", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "f39d0b69-2862-4357-a23b-66bccdbb4993"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    StyleBox["y", "TI"], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["h", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "0caad3ce-fada-4716-908f-bd138f9aafd8"],
 " with the ",
 ButtonBox["Hessian matrix",
  BaseStyle->"Link",
  ButtonData->
   "paclet:tutorial/UnconstrainedOptimizationMethodsForLocalMinimization"],
 " ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["h", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      StyleBox["x", "TI"], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["i", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "06c83808-8324-49f9-82c9-de1236dc79b5"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Hessian"]], "paclet:ref/Hessian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "07e7bc1a-70a0-47ab-bac2-ecc41fc073a5"],
 " returns ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        StyleBox["y", "TI"], 
        StyleBox["1", "TR"]], ",", 
       SubscriptBox[
        StyleBox["y", "TI"], 
        StyleBox["2", "TR"]], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       StyleBox["\[Ellipsis]", "TR"], ",", 
       RowBox[{"{", 
        RowBox[{
         StyleBox["\[Ellipsis]", "TR"], ",", 
         RowBox[{"{", 
          RowBox[{
           StyleBox["\[Ellipsis]", "TR"], ",", 
           SubscriptBox[
            StyleBox["h", "TI"], 
            StyleBox["ijk", "TI"]], ",", 
           StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
         StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
       StyleBox["\[Ellipsis]", "TR"]}], "}"}]}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "92775836-7e00-4b22-8679-9d992c08d6eb"],
 " with ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["h", "TI"], 
    StyleBox["ijk", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"QSP", "[", 
       StyleBox["spec", "TI"], "]"}], "[", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["i", "TI"]], "]"}], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["k", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "a03f0f3d-985a-4245-860d-f7b2013dcf99"],
 ". "
}], "Notes",
 CellID->765642393,ExpressionUUID->"fbf9d508-4cb5-4660-8f48-69bec17cbea6"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Jacobian"]], "paclet:ref/Jacobian"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{"QSP", "[", 
    StyleBox["spec", "TI"], "]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2eeb5c46-e619-43d0-ac66-dc2f54ba52cd"],
 " returns ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["0", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["c", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      StyleBox["\[Ellipsis]", "TR"], ",", 
      RowBox[{"{", 
       RowBox[{
        StyleBox["\[Ellipsis]", "TR"], ",", 
        SubscriptBox[
         StyleBox["g", "TI"], 
         StyleBox["ij", "TI"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "a90479c6-36ea-4c8e-90c8-dcdf220bc821"],
 ", where ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["0", "TR"]], ",", 
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["1", "TR"]], ",", 
    SubscriptBox[
     StyleBox["c", "TI"], 
     StyleBox["2", "TR"]], ",", 
    StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "34c283cf-5238-471d-8f0b-31f6787f775c"],
 " is the Chebyshev expansion coefficients of ",
 Cell[BoxData[
  RowBox[{
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["QSP"]], "paclet:QuantumMob/Q3/ref/QSP", 
      "QuantumMob Package Symbol"},
     "PackageLink",
     BaseStyle->"InlineFormula"], "[", 
    StyleBox["spec", "TI"], "]"}], "[", 
   StyleBox["x", "TI"], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "17ce139a-78a2-42ba-9c03-89a63efd4c8f"],
 " and ",
 Cell[BoxData[
  StyleBox["g", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "cc5602db-5241-4841-b492-e01a90ede9d5"],
 " is the Jacobian matrix, ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["g", "TI"], 
    StyleBox["ij", "TI"]], ":=", 
   RowBox[{
    TemplateBox[{
      Cell[
       TextData["D"]], "paclet:ref/D"},
     "RefLink",
     BaseStyle->{"InlineFormula"}], "[", 
    RowBox[{
     SubscriptBox[
      StyleBox["c", "TI"], 
      StyleBox["i", "TI"]], ",", 
     SubscriptBox[
      StyleBox["\[Phi]", "TR"], 
      StyleBox["j", "TI"]]}], "]"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "d3e905e7-be67-48eb-8f71-be4c571c73e6"],
 "."
}], "Notes",
 CellID->328467597,ExpressionUUID->"38eef5cc-dd2d-4b98-a443-84e69e43535c"],

Cell[TextData[{
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Matrix"]], "paclet:QuantumMob/Q3/ref/Matrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", " ", 
    StyleBox["x", "TI"]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "bb502951-b85d-4a5d-88b4-ff735ca39104"],
 " returns the QSP unitary matrix at ",
 Cell[BoxData[
  StyleBox["x", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "c207c447-0e12-4a4f-aa43-cfc4ad55492b"],
 ". ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Matrix"]], "paclet:QuantumMob/Q3/ref/Matrix", 
     "QuantumMob Package Symbol"},
    "PackageLink",
    BaseStyle->"InlineFormula"], "[", 
   RowBox[{
    RowBox[{"QSP", "[", 
     StyleBox["spec", "TI"], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["1", "TR"]], ",", 
      SubscriptBox[
       StyleBox["x", "TI"], 
       StyleBox["2", "TR"]], ",", 
      StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2c245775-5ff7-45a4-b95b-00d2f5e0222b"],
 " returns the list of matrices at ",
 Cell[BoxData[
  RowBox[{
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["1", "TR"]], ",", 
   SubscriptBox[
    StyleBox["x", "TI"], 
    StyleBox["2", "TR"]], ",", 
   StyleBox["\[Ellipsis]", "TR"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7ad2e523-ddaf-427f-882e-274ac425bceb"],
 "."
}], "Notes",
 CellID->740487261,ExpressionUUID->"236ce795-deb7-4a45-b901-c7452071619d"],

Cell[TextData[{
 "The quantum signal processing (QSP) of degree ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "178a0311-2597-42c3-b182-1675cc351ad7"],
 " with phases ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{":", 
     OverscriptBox["\[Phi]", "\[RightVector]"]}]}], TraditionalForm]],
  ExpressionUUID->"5c90ecd4-0f21-4cee-a812-3ed759428d62"],
 " is a parameterized representation of a polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "a58fc0a0-2043-48ea-b83e-e4e6ec868ed0"],
 " of degree ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "09c0320b-57cc-48e5-9b0f-e6c340b72238"],
 " and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"d", " ", "mod", " ", "2"}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"a1331108-23a3-4751-9bd9-4d955848783a"],
 ", through the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "\[Times]", "2"}], TraditionalForm]],ExpressionUUID->
  "00352378-5b6e-4dec-a940-3850f20aa9d8"],
 " unitary matrix\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], ":=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
        SubscriptBox["\[Phi]", "0"], "Z"}]], 
      RowBox[{
       UnderoverscriptBox["\[CapitalPi]", 
        RowBox[{"k", "=", "1"}], "d"], "[", 
       RowBox[{
        RowBox[{"W", "(", "x", ")"}], 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          SubscriptBox["\[Phi]", "k"], "Z"}]]}], "]"}]}], "=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"P", "(", "x", ")"}], 
         RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
          RowBox[{"Q", "(", "x", ")"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["x", "2"]}]]}]},
        {
         RowBox[{"\[VeryThinSpace]", 
          RowBox[{"\[ImaginaryI]", "\[VeryThinSpace]", 
           RowBox[{
            SuperscriptBox["Q", "*"], "(", "x", ")"}], 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["x", "2"]}]]}]}], 
         RowBox[{
          SuperscriptBox["P", "*"], "(", "x", ")"}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "101a6063-9b72-41aa-89c5-a10ec04cdc85"],
 " ,\nwhere ",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "21d0399e-458d-4d15-8e2c-92f6b29a2255"],
 " is the Pauli-",
 Cell[BoxData[
  FormBox["Z", TraditionalForm]],ExpressionUUID->
  "aab7d64b-12ce-444b-a232-f07bf165f694"],
 " matrix,\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"Z", ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {"0", 
        RowBox[{"-", "1"}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "56a15a70-edbc-43e7-998b-5514655dcb9f"],
 " ,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "2da5c733-6dfb-4152-808b-9fb2f3482468"],
 " is a rotation in the Bloch space around the ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "a692b84d-5fa6-4abd-8787-c55b3ad6242e"],
 "-axis by angle ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"arccos", "(", "x", ")"}]}], TraditionalForm]],ExpressionUUID->
  "14b62884-8459-4113-87d4-b87cddcf6e2b"],
 ",\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"W", "(", "x", ")"}], ":=", 
    RowBox[{"(", GridBox[{
       {"x", 
        RowBox[{"\[ImaginaryI]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}]]}]},
       {
        RowBox[{"\[ImaginaryI]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}]]}], "x"}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "0a9e2473-36d6-4d9b-b8da-0bcb3e463ae1"],
 " ,\nand ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "d2acf908-01b0-46ce-8813-8c85260f3bfc"],
 " is a polynomial of degree ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", "-", "1"}], TraditionalForm]],ExpressionUUID->
  "07b7339c-e958-4dd9-bf88-1eff926629aa"],
 " and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{"d", "-", 
       RowBox[{"1", " ", "mod", " ", "2"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"0af95612-edfe-4513-80fa-591931449274"],
 " satisfying the unitarity constraint \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{"P", "(", "x", ")"}], "\[RightBracketingBar]"}], "2"], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"\[LeftBracketingBar]", 
        RowBox[{"Q", "(", "x", ")"}], "\[RightBracketingBar]"}], "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "2"]}], ")"}]}]}], "=", "1"}], TraditionalForm]],
  ExpressionUUID->"3aa20b50-1ed5-4bee-ba9e-469fb0dbd58d"],
 "."
}], "Notes",
 CellID->958672882,ExpressionUUID->"5cb8d44a-0f7c-4283-8e83-e421e7eb8942"],

Cell[TextData[{
 "Quantum signal processing is ",
 StyleBox["symmetric",
  FontSlant->"Italic"],
 " if the phase vector is symmetric ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "d"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "1"], ",", 
      SubscriptBox["\[Phi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"284394b1-9204-41ce-a841-e1771ed59a04"],
 " under list reversal. A symmetric quantum signal processing has its \
characteristic unitary matrix symmetric, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"], "T"], "(", "x", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"e48b6d1c-aca0-4259-bb04-819c7244263b"],
 ", and polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "dc5a9ab4-54c3-41ea-a44f-11f57d6c79dc"],
 " is real. See Theorem 2 in Dong et al. (2021)."
}], "Notes",
 CellID->1795688728,ExpressionUUID->"830986fb-4547-4bf0-9316-b093485ca305"],

Cell[TextData[{
 "A quantum signal processing is said to be ",
 StyleBox["symmetric",
  FontSlant->"Italic"],
 " if the phase vector is symmetric; that is, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "0"], ",", 
      SubscriptBox["\[Phi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "d"]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[Phi]", "d"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[Phi]", "1"], ",", 
      SubscriptBox["\[Phi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"5ce95808-2762-43a4-9925-9c178a0ecf69"],
 ", which leaves only ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "d"], ":=", 
    RowBox[{"\[LeftCeiling]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "+", "1"}], ")"}], "/", "2"}], "\[RightCeiling]"}]}], 
   TraditionalForm]],ExpressionUUID->"998c1c26-2e64-4d79-a095-907dcf23b0be"],
 " independent phase variables. A symmetric quantum signal processing has its \
characteristic unitary matrix symmetric, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"]], "(", "x", ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["U", 
      OverscriptBox["\[Phi]", "\[RightVector]"], "T"], "(", "x", ")"}]}], 
   TraditionalForm]],ExpressionUUID->"3a40b6ab-35fc-4779-87b3-7fd8aabe2a2d"],
 ", and the polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "x", ")"}], TraditionalForm]],ExpressionUUID->
  "b5eafb2f-1e5c-456e-a80e-b7314522ad71"],
 " is real ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["(Dong, Meng, Whaley and Lin, 2021: Theorem 2)"]], 
    "https://doi.org/10.1103/PhysRevA.103.042419"},
   "WebLink",
   BaseStyle->{"Notes"}]],ExpressionUUID->
  "221eeaab-b7f0-4f35-8bec-84119257d86f"],
 "."
}], "Notes",
 CellID->1190343635,ExpressionUUID->"11a733b4-b9a4-4f8e-b0c9-3ae8cdd0721d"],

Cell[TextData[{
 "Given a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " set ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[CurlyPhi]", "0"], ",", 
     SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
     SubscriptBox["\[CurlyPhi]", 
      RowBox[{
       SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], TraditionalForm]],
  ExpressionUUID->"b6eee4cf-23e6-4ee2-a9c7-c9358be60c2e"],
 " of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "d"], TraditionalForm]],ExpressionUUID->
  "5bf48de0-8d43-4dcc-9302-0dd0a314b9a0"],
 " independent phase variables and parity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", "=", 
    RowBox[{"\[PlusMinus]", "1"}]}], TraditionalForm]],ExpressionUUID->
  "af248b88-8342-4bb1-8000-4dba7faf3376"],
 " for a symmetric quantum signal processing, one can recover the ",
 StyleBox["full vector",
  FontSlant->"Italic"],
 " of phase variables as follows:\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[CurlyPhi]", "0"], ",", 
        SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{
          SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
      RowBox[{"+", "1"}]}], "}"}], "\[RightTeeArrow]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[CurlyPhi]", "0"], ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
      RowBox[{"2", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{
         SubscriptBox["n", "d"], "-", "1"}]]}], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", 
      SubscriptBox["\[CurlyPhi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"9f0e9d02-57f2-4686-b9d6-c56c35f9612e"],
 " (notice the factor of 2 for technical convenience),\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[CurlyPhi]", "0"], ",", 
        SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{
          SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], "\[RightTeeArrow]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["\[CurlyPhi]", "0"], ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{
        SubscriptBox["n", "d"], "-", "1"}]], ",", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{
        SubscriptBox["n", "d"], "-", "1"}]], ",", "\[Ellipsis]", ",", 
      SubscriptBox["\[CurlyPhi]", "1"], ",", 
      SubscriptBox["\[CurlyPhi]", "0"]}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"98bff1a1-b980-4db1-b9e6-37efe0d90668"],
 ".\nThe pair ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[CurlyPhi]", "0"], ",", 
       SubscriptBox["\[CurlyPhi]", "1"], ",", "\[Ellipsis]", ",", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{
         SubscriptBox["n", "d"], "-", "1"}]]}], "}"}], ",", 
     RowBox[{"p", "=", 
      RowBox[{"\[PlusMinus]", "1"}]}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"9e58f92c-4383-4061-90e6-e4963a2d4115"],
 " is called the ",
 StyleBox["reduced phase vector",
  FontSlant->"Italic"],
 " to be distinguished from the ",
 StyleBox["full phase vector",
  FontSlant->"Italic"],
 "."
}], "Notes",
 CellID->1535193593,ExpressionUUID->"b7411b4b-2212-4818-a871-5cc27fc1188b"],

Cell[TextData[{
 "The correspondence between the reduced and full phase vector is closely \
related to that between the ",
 ButtonBox["reduced and full Chebyshev coefficients",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/ref/ChebyshevCoefficients"],
 " list."
}], "Notes",
 CellID->227248759,ExpressionUUID->"c26b381f-d7dc-4b29-bfa5-4137bfe0d2b4"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"69250036-0204-4a8b-99dc-d2bdf56199e8"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"e8f4a1ca-ed0a-4ab5-ba9b-862790bb796f"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(11)", "ExampleCount",ExpressionUUID->
  "835a9167-e2fe-4a7f-a0e2-9be8cf1e5394"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->743861598,ExpressionUUID->"39fd7cb9-ca12-444b-ad79-726bc980d779"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->556413652,ExpressionUUID->"3e033788-0868-4aa8-a156-4d08cb31a063"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"93b6f474-a1a7-46dd-9c94-441b37138294"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"0aff916c-ccc9-44a8-a4b3-e53c390185f6"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "c44bf387-574c-4c2e-b737-4c329a382939"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1579568399,ExpressionUUID->"98ac740d-8df8-4d8c-a3b4-c9ab3f07245f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->672243474,ExpressionUUID->"230fe014-dbbb-45c2-93e1-bbf62a9a4732"],

Cell["Set the phase vector and parity:", "ExampleText",
 CellID->966966361,ExpressionUUID->"a93a5d60-ce37-41b2-a7f2-812f6441958c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->484600651,ExpressionUUID->"6f374979-a62f-405b-bcd8-e2ab4483cf18"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "$n"}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1425151933,ExpressionUUID->"169cd958-751a-4ff4-951e-ad387f31b944"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->931228551,ExpressionUUID->"0b97435d-177a-4804-83b8-8119388891a0"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->297437321,ExpressionUUID->"dd41e5ba-fbb7-4703-be42-16730b295f18"]
}, Open  ]],

Cell["Construct a QSP:", "ExampleText",
 CellID->1540884431,ExpressionUUID->"da9206c4-b586-43fe-95ac-7339e1c59f70"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$phi", ",", "$parity"}], "}"}], ",", "Re"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1098093014,ExpressionUUID->"50037b46-f2ef-4457-8706-48653bccbe12"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Re", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, 1}, Re],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1834607478,ExpressionUUID->"a3f4389d-b896-4646-9c36-862866d17c6c"]
}, Open  ]],

Cell["Pick a position:", "ExampleText",
 CellID->569269380,ExpressionUUID->"9b252bd7-f3c8-402f-b3b2-0717f4d31553"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1920729624,ExpressionUUID->"fdf681b4-2d14-4005-9a20-3d48fcd571ae"],

Cell[BoxData["0.7222657925379279`"], "Output",
 CellLabel->"Out[5]=",
 CellID->677679120,ExpressionUUID->"9eecd9ae-a3c4-47ee-b0c3-b3f0ed8746e7"]
}, Open  ]],

Cell["Calculate the QSP polynomial at the position:", "ExampleText",
 CellID->1970697472,ExpressionUUID->"a8bb711f-08f3-45bb-aff4-fa9090f4549f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"y", "=", 
  RowBox[{"qsp", "[", "x", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1579083477,ExpressionUUID->"1affa54b-cdb5-4788-9cc4-f23e33eb26ce"],

Cell[BoxData[
 RowBox[{"-", "0.24370437270790196`"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1647189799,ExpressionUUID->"441ca5d5-82f3-4c7d-b138-ce1fd4abf55a"]
}, Open  ]],

Cell["\<\
Calculate the gradient with respect to the phases at the position:\
\>", "ExampleText",
 CellID->1682239748,ExpressionUUID->"f2c3c3f0-49bf-459d-b52d-b22690333216"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"f", ",", "df"}], "}"}], "=", 
  RowBox[{"Gradient", "[", 
   RowBox[{"qsp", ",", "x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->487601425,ExpressionUUID->"d1574224-76d3-4385-9f55-50de38a9d20a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.24370437270790196`"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.857436120097687`", ",", 
     RowBox[{"-", "0.4001420997668619`"}], ",", "1.8237858602958372`"}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1107258316,ExpressionUUID->"2ad0b0ed-049a-4e1a-931d-1ee2c750a8bc"]
}, Open  ]],

Cell["\<\
Calculate the Jacobian matrix between the Chebyshev coefficients and the \
phases:\
\>", "ExampleText",
 CellID->1831286845,ExpressionUUID->"3dc79638-0eb6-4d17-9e60-ea3e887bc8b5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cff", ",", "jac"}], "}"}], "=", 
   RowBox[{"Jacobian", "[", "qsp", "]"}]}], 
  ";"}], "\[IndentingNewLine]", "cff", "\[IndentingNewLine]", 
 RowBox[{"jac", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1520012391,ExpressionUUID->"10b49b70-8258-4243-8168-621d52685176"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.24101003885481828`"}], ",", 
   RowBox[{"-", "0.3673208690650344`"}], ",", 
   RowBox[{"-", "0.013273647029757533`"}]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1744715757,ExpressionUUID->"cc5928e0-39d0-40ce-adda-9f0cd9efd3d5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.8218192361642762`", 
      RowBox[{"-", "0.343954026056741`"}], "1.8049624494329581`"},
     {
      RowBox[{"-", "0.21025955307636573`"}], "1.7769219637646367`", 
      RowBox[{"-", "0.21025955307636565`"}]},
     {
      RowBox[{"-", "0.044897272399639726`"}], "0.1336944729803754`", 
      RowBox[{"-", "0.02804048566832132`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->1696011761,ExpressionUUID->"c5b333bc-efc4-4763-85bf-3bcf187ad8eb"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "de2ad0a5-21c9-4b1a-88bc-d5580533357e"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"34ee74ee-51d3-4265-aa17-6b4d196969c8"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(9)", "ExampleCount",ExpressionUUID->
  "c8419563-bad4-4203-9b89-7a0af6801387"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1703330544,ExpressionUUID->"df142de1-0aad-4c62-9f54-1ccf7f4c8254"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "062e742a-ccc2-4efe-be17-5110427f6d2b"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"0d919df6-2027-4e81-a550-46038ecf022c"],
 "Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "12bb4b32-720a-481c-989f-044600836725"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1625224184,ExpressionUUID->"51d4cade-0827-430c-b83f-ca12c0389e18"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->866063270,ExpressionUUID->"4bfe8b12-f139-45aa-9a33-9044f79b5a62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1774012929,ExpressionUUID->"cf91db09-0e25-474e-bbb4-7bf63f266258"],

Cell["Construct a QSP:", "ExampleText",
 CellID->1210812697,ExpressionUUID->"064bc26c-c167-4179-95e4-a2e652a405c2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"-", "1"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->93372207,ExpressionUUID->"9f4d6ea7-9793-4a61-9d91-001e8120cdc3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1319220496,ExpressionUUID->"63329990-6118-4961-9758-2c404698ade1"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1517704644,ExpressionUUID->"e8765f41-901c-4136-999f-f6cc6e08291a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1264054559,ExpressionUUID->"783cdb34-9e70-4a94-aa2b-0785d8bc9ee7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][0]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][1]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][2]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{
     $CellContext`\[Phi][0], 
     $CellContext`\[Phi][1], 
     $CellContext`\[Phi][2]}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->251192642,ExpressionUUID->"ad98171a-ab50-4ce9-bd58-2e5c4ca2d014"]
}, Open  ]],

Cell["Get the QSP unitary matrix:", "ExampleText",
 CellID->645597649,ExpressionUUID->"099be4dd-0751-4fc4-a71f-8f1a84aaad5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "x", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", 
     RowBox[{"$qsp", ",", "x"}], "]"}], "//", "Simplify"}]}], ";"}]}], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1538010568,ExpressionUUID->"e0327912-eeb9-447b-af2f-d3e6145f2f44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "mat", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->2098320073,ExpressionUUID->"d76a246b-e9f1-4559-b576-a68a2e9b38c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2"}], "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1989367739,ExpressionUUID->"5c7b7123-54ba-44fc-bb42-74af74d6b139"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1894606122,ExpressionUUID->"2395a4ec-6b52-446a-b33e-67ab845785f6"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][0]]}], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "0"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][0]]}], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"2", "-", 
    RowBox[{"6", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "4"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["x", "4"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["x", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["x", "4"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][2]]}], "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["x", "4"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "2"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][2]]}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "4"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "+", 
    RowBox[{"2", " ", "\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       InterpretationBox[
        SubscriptBox["\[Phi]", 
         TemplateBox[{",", "\",\"", "1"},
          "RowWithSeparators"]],
        $CellContext`\[Phi][1]]}], "]"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "-", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "+", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "2"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][2]]}], ")"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1130689230,ExpressionUUID->"b70df93f-f515-444e-834e-8502f28b8ca1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "f8ebf254-4659-48fa-bee6-d7718988a699"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->706601561,ExpressionUUID->"72465aa1-17f2-4160-be1d-f15245571f9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "300"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->349864653,ExpressionUUID->"34185249-36a8-417b-8a65-88b2787a0779"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1138088487,ExpressionUUID->"e552f10f-deee-4849-a3fb-5de0e094b1f5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2147261437,ExpressionUUID->"f366d3a8-9b0f-4769-a2c6-8891e3bc4d71"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->411096307,ExpressionUUID->"f5e908f5-8696-491d-92f2-23e0d95b597d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->745752491,ExpressionUUID->"f5cffbe0-c9cd-4229-abd0-e6b52955092a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["598", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["598", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}], ",", 
                    "1.3526643903415392`", ",", 
                    RowBox[{"-", "1.4612784342395748`"}], ",", 
                    "1.2380248457091423`", ",", 
                    RowBox[{"-", "0.4898389003561131`"}], ",", 
                    "0.14740162462925227`", ",", "0.09519214138002281`", ",", 
                    
                    RowBox[{"-", "0.054377159963480484`"}], ",", 
                    "1.1366917987048297`", ",", 
                    RowBox[{"-", "0.9313131184913914`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwNlHk4FIgfhyORNqQiORapZCv6OVKsvjocKYpkQ0vrWMeGhGVRSM6IlNpI
kSuhZnNkXd9xJvc5xs0MZtxzmMOm/Prn8/f7PO/zfpSdfKxcBTZt2nTk+9Qf
+mSTRmKA2d2EP2Q2OCCtfslLUHAYaQQfz8gcDkQ+IN11/Y2HuRc3VNidbEjJ
vnomynYCewOf3BYfrwdX/R0/RjpUQEqy00erwULU22tZQ9VgQZqW6WHLjiV8
uD1CbUN8CUW1C5iRmt04fVVW+LXkDNwbjo+bL6fhQsslWmB3N0zkmug8qpwH
a8k3qzYWPXCbuUaXUeLj76wgCuECH+65udx2slvGyVZ9ueqUWXQhCBACpJrx
nX1wYHElA27OG88RK9lwUs7XZMiCCUo7CqWnmhfB91vKDxI7+aB7Rz61VJWD
vF/1QkYsRlG8devEcAcJAxbpcdJHV2Et+3XAC8lVbM162/5pnQq+qaEJURFv
IG7MRWfFbwgPOVXaFzcOg7tfzsSZvFVUzXdPl0+ZgQzNp8syylR4O0b4WGfH
xMyvRYzdQSwI9kj13yVUD/xLStV/ivRh8JecKq1tFDyo786ZVGRDd7Rwk0E1
E1RvfYs/R1/FP4/pN6rqTuH+D4kFn0rmcC28N3s6fQV73IOuGAQ/Q0pnQkd6
5RRsa4nmyV1phog2mbsZEyTICxtb6/t3GqUK5msX4thg+OvxVupOFpha54zt
ezGLDME0ge3ZLNTMPufw5e4/UKR1YO8KIxoNU9eOnFX47lXO42EpcREXPC+0
7w1vxNiW221C5CXME6+2okTP4KzUG7/E+hkQG5NV6IkeRJnowFpv4RV4/8zH
4cKzRtxHdvQ6pTCJhYTroiV+PHxUlq7DUuZhRXVhuxtpAXKH0w7ZhnIRtdxP
GSWxUI1AvKsRvIix9n9Vu40uY/G15Nequmw0udPuaMNZwpZ9ynUsKRbej9oS
b2uwCkfJzob+Sav47Hhj3ckJBqZYBJ6PTiWjDQgudE3wQaJQTb/rHgve+sfB
fTU+5uWPxG9NHIX5YjFx+4RJ5MsWcALUl7Eb5xIMfp7GSCvjEVfneXAoLup7
Wc8AXu5c7JuPC6h02PDy89xmeP2UWVLl1Y3esQ4FFLN23CounS2XwMSo6UsL
NN9x8CiNrbEw7waJ8J+NK80ZGPJVPDqf3of/aHm0JNhPgfADhbhX5kxcP3et
Yb55Be9n8dts3qejypaygg7+PP5wvspVWZ0GRx0c9jnDLAZ/Ipoqj3GhRKFZ
sIHBQqXPUuenVKZQaETLnrI0AuSVL/mE09NoSCvl0BXGgbM40NO80IMhMFqc
1jmDdcodl+tMZ0B9bctDXaU1SPzYH2UdNQXeGe03Xx5goKG3XsVOi2LQT9f7
NyOEhCZ/h4xn1M6D6LrZ5oblKSyQat7e3cQAQ/7vAplfeODp5fn5zulRbCde
KqFe4UAa81EffWwayp2y3vkVcDCmrK/Ozb4N371SPLNGmIGyjMS9UpYd0OVA
JtxPaQPPm7tyPJR6QFhSbXm3ZDXk6E7d2PP6MbZed3F66tILqbbuDvSaSbBL
VBUuOtOLrayBRHwygMK39IXvLU+jUN9TgzDbFUg8EXTW/Or3H+ouOzbyfgAu
2jA7NbRpQFQ0Esu3mgYxdXK96CYOOlbwlzvMVvGgpmnm+uZerHmVnHC4cBpf
dv9G7yqYROclwv+Gg+fAMLJk9EnNEjTW3q+OTZ3BL/GfB2fXiCAhWKSlu5MC
VNmTcRpPuGgpkvnK6xgbRZPI1rblXMzvECU4JJbhYg9/h3w0E/U8fmS7DFFA
5VsM+WsOGw8UCb+92D2NQ8Jy6dM+JExWDCdGxDdAjmd53ovwKXgs4J/r1jCP
ZEN/y5Kwj5Blm3ZeS4EPMscVp+V7h2DX9twsr6AlFOI854c9aIXxEMmBk7fb
0CdPJVixgoMBHcG0AA0ScN1jF9+psFHBKNwr98wwWuuqzVvLNGGHgJeK0d46
CKvVoSuqsWGQrMrvFuKiH56PHPRig4cE5TFXsx92NB3vKOfOQqGdgXBeDBvC
Huvd+yWqDYqeKZeu7mZBNKlKWr10EkX/8W/wMVlEindtRgExD8uMjhhn5XwA
AkVB202RAx67ZbozD/GwNuXEwPsaKoQn3rTcKJwDl4KIVwFjC2hxeVuGOoGD
lD+S/wJbPpoohZ4KWB+B+VCjqiaRRtgos7bxfcAGMn299eTVGVya1SQyBukg
oWbRLD5Rj+knRq3Tmum45k3Z5Tg8C0LPTcwzfqeiyHwtX4nMhtjFHyqSA4bB
9eH+Bp8RDtwM83ouwJnDkOIch3ajHtwWEdbyU3Yd/H3f3MXvBhf2+3oqv/Nn
wPDpTVEXBhlYNpGhU2oyhETDxfYPMSUglslRqHQpg3qJKu9yDSJYX9TWcvPm
4eYg4/xNbe04c6q4LkuVCybJKXnlzDnc+skiW3CcBKOeic13nJlgPjGpdsWL
ga9rBF5eE+ejjbimTVt9HdwT+EVe1IoDZn7UwPadTOh0awkINfgM8lpXCZ/7
m1COmK32oY+JVTdUJtqvDyNb4KiLO5kGonfVZM0ONGKJ7793fiasYlx2K3cl
igX7n14uZngzkHc7Kix/sh+r1doc5zZmwerdQlHl4TfoYH99pwV1GOrPOh0p
V29CMXTmUmiTmPflva72gQ7wRhObKmSg0ygmCfXO4ektpqRdjr2gQHTl7Tam
AjVyz7yu7BoenQ3iMU70o7jjV20F9VXc520M4bRW6JX671yK5hz8tBBACvu2
CO3N5x4Uha7iqHickO4VOuT220UOeTHA8tLBW64tLMht3dx3aywYhLKCyb4X
eNjUpalu10/53r/3GLWLibrBZWLp1FXUkKES9p1kgbzsRrylyAraVoXpeMaM
g3TKVnWpdRr+8TKiU21LGbz48ED3WRIHK46TktpmF1Dal8ntd1pAw3LXXoU5
Jugw8mKNf6uDQtP0ymQRPlA+h3CmaXQcWt6yZ5THh13v3WI8aA9RrF2Pb2Qx
DrGcv14GakzAcx29iOA/6Thu5hwbJ14Md0wlo/acZkG8mF4T7xMDD1kPhNqI
LEPd+aSPxzpH4L8iO2/LJSbYnNCOubHMBaGu6JnL3/kPjoWYX5Plgk/bI8tM
Bx4mBFBTXpD64f+rcCbi
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->840739350,ExpressionUUID->"7e4b8c56-5b37-4e71-859e-8758fc165384"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1123936882,ExpressionUUID->"b7e0c238-8018-4fe9-a193-5cbf17f3ca40"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{"mat", "=", 
    RowBox[{
     RowBox[{"Matrix", "[", 
      RowBox[{"qsp", ",", "xx"}], "]"}], "//", "Chop"}]}], "]"}], 
  ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1756899605,ExpressionUUID->"314b044c-d345-4ecf-be12-9e36aa37b29e"],

Cell[BoxData["3.233398`"], "EchoTiming",
 CellID->2011341837,ExpressionUUID->"f74ddab7-2aac-4f84-af85-1eff2771c9a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{";;", 
     RowBox[{"UpTo", "[", "5", "]"}]}], "]"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1891135613,ExpressionUUID->"840c8aae-04ab-44d3-b48f-bcf5d5823f89"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.41304947785649526`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.9009462388461923`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13298873467846836`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.13298873467846836`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.41304947785649526`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9009462388461923`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.40210871608186455`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.8289773173643352`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.38872250738340675`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.38872250738340675`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.40210871608186455`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.8289773173643352`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.37940300195479393`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.6914742399323504`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6147493290908808`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6147493290908808`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.37940300195479393`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.6914742399323504`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.34346525252963295`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.5006799352962871`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7945761276910034`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.7945761276910034`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.34346525252963295`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.5006799352962871`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"0.292524460382402`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.27344836431088027`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9163271425280948`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.9163271425280948`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.292524460382402`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.27344836431088027`", " ", "\[ImaginaryI]"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1082167032,ExpressionUUID->"d70ff576-4f65-481e-9e2c-3a9ab9ea04fc"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "a1a2e051-6e26-4fd3-b260-e59036fa474f"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"e04aec97-acda-433a-80b4-912156f77f87"],
 "Gradient",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "a9613c18-0e69-46f3-8bfc-9427aa81a079"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->976509307,ExpressionUUID->"b7704e67-34dc-4204-8f90-6e53976da5c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->404620761,ExpressionUUID->"b5561db8-9cf8-4d52-ae4e-a29456172662"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1527903725,ExpressionUUID->"91b9f4db-92ba-4fc8-8556-612d44f0f30a"],

Cell["Construct a QSP:", "ExampleText",
 CellID->645812421,ExpressionUUID->"73faa8f9-6c5f-4888-82aa-bc9c981a4e7c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$parity", "=", 
   RowBox[{"-", "1"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->2015938896,ExpressionUUID->"91c31911-6b17-4d04-aea0-a874802cddae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->942300381,ExpressionUUID->"26886725-4102-4f4e-ad53-2a65228a3049"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->883939583,ExpressionUUID->"77d2cdec-a653-48a1-b043-00beb32aa1b4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1698090489,ExpressionUUID->"b632a8ed-7c30-44ba-b722-bd4dcbcd8d9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "*", "Pi"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1288517488,ExpressionUUID->"07d01525-6225-424c-b96a-7e606ae7d2a3"],

Cell[BoxData[
 RowBox[{"-", "0.9763034131218359`"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1896663640,ExpressionUUID->"7fe0827b-0a12-4ccb-bae7-dc66cf45f2c3"]
}, Open  ]],

Cell["Calculate the gradient with respect to the phases:", "ExampleText",
 CellID->1991143895,ExpressionUUID->"fc579dbc-294d-423c-b6c0-0be4330b74eb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "grd"}], "}"}], "=", 
  RowBox[{"Gradient", "[", 
   RowBox[{"$qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->763019732,ExpressionUUID->"1ff6b06f-58fe-4c87-81c8-8a2b0f2981cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5353834564485714`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.7698389667404558`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.5396779334809116`"}], "+", 
      RowBox[{"1.0707669128971429`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.1427205960590454`"}], "+", 
      RowBox[{"1.1199214833381976`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.5585409731606994`"}], "+", 
      RowBox[{"1.1631045338923487`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->2126025059,ExpressionUUID->"a0aaa39f-197d-40f9-a275-6dc29b0c3c94"]
}, Open  ]],

Cell["\<\
For comparison, calculate the gradient by taking the partial derivative of \
the polynomial:\
\>", "ExampleText",
 CellID->2001042392,ExpressionUUID->"cd16072b-7884-4157-a95f-31718afb8b76"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"tmp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"var", ",", "$parity"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"tmp", ",", "$x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mint", "=", 
  RowBox[{"ReplaceAll", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"mat", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
      "var"}], ",", 
    RowBox[{"Thread", "[", 
     RowBox[{"var", "->", "$phi"}], "]"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1840117499,ExpressionUUID->"f4e4fdc6-0258-42d3-a7df-b55b6a927201"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->122764180,ExpressionUUID->"77237e2d-a1dd-4f6c-9f5a-7e1d7962a963"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "0"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][0]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][1]], ",", 
                    InterpretationBox[
                    SubscriptBox["\[Phi]", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`\[Phi][2]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{
     $CellContext`\[Phi][0], 
     $CellContext`\[Phi][1], 
     $CellContext`\[Phi][2]}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[7]=",
 CellID->1713272140,ExpressionUUID->"5aa3a11f-ef74-4bf1-9dae-8544f1c44ece"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1.5396779334809114`"}], "+", 
    RowBox[{"1.070766912897143`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.1427205960590452`"}], "+", 
    RowBox[{"1.1199214833381976`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.5585409731606994`"}], "+", 
    RowBox[{"1.163104533892349`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",\

 CellLabel->"Out[7]=",
 CellID->1504118004,ExpressionUUID->"d3784cc6-e206-43fb-bc78-c9a07b36e5c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"grd", "-", "mint"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1440956291,ExpressionUUID->"7f4b0359-1860-4328-b766-475f3bdcbf34"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1681284391,ExpressionUUID->"2f3978af-1fb3-455d-a0c0-2eabcbe5fd70"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "5f9270f9-409d-4679-943a-4b48406ab810"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->1767104397,ExpressionUUID->"f48371b4-4292-4849-b14f-2da50324af5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "75"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->24762369,ExpressionUUID->"4bb74ff1-8fb2-4e3e-8ec9-8d1d572ad92f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1716791912,ExpressionUUID->"6214ae8e-9de2-40ab-980c-71d63a100e7a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->531383892,ExpressionUUID->"16be33eb-2117-41e3-b124-17aeb350597d"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->756932311,ExpressionUUID->"935a3d42-c06e-4406-b476-d9b6dc1b4b14"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1736427641,ExpressionUUID->"d6f16913-1965-4c49-ad11-1b29fd13c8ff"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}], ",", 
                    "1.3526643903415392`", ",", 
                    RowBox[{"-", "1.4612784342395748`"}], ",", 
                    "1.2380248457091423`", ",", 
                    RowBox[{"-", "0.4898389003561131`"}], ",", 
                    "0.14740162462925227`", ",", "0.09519214138002281`", ",", 
                    
                    RowBox[{"-", "0.054377159963480484`"}], ",", 
                    "1.1366917987048297`", ",", 
                    RowBox[{"-", "0.9313131184913914`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwBZQKa/SFib1JlAQAAAEsAAADCKMdWmtbwP0p+jGsY//U/Fi5PbQIC2r/n
sG9qg6T1P4OL1n5lYfe/pUz/I/PO8z+So1VChVnfv9J3lHIO3sI/ZTsQHoNe
uD+SkGK3UtervzoZUb3jL/I/mjNIK1HN7b+ODIEp/w7tvwk0qfGDMtC/5FUa
BqIR5T+C2oqJ6rbnv+vIT+d30NA/36VHNZG66j9UEaj0Vk7RP3Lx+egYIPi/
ZvJ44rBL+D+CZ2RyYlruv+DKOxu8kua/ZLABsHUVxr+uW3p3rbrwP2zqRunA
uvM/ORtxR9lO8T8gEKsW4cbsP3H+kgsPEvg/N30clbQn9b/3XTp7207cvw7K
CN/azda/dezoiRYt9D/5o6J1nBH0v8qhqszH/OM/cZV8jIWBqD+J3WQ173PZ
vyhiulutxNo/aHOk30Km9L8np2ibHJLlP50ylu4YIeM/qt2wt8Fa8b+g/azw
FHjyP3pplXQTBMI/+E8gvHYH0796+6S7MwrivyY7aPXgH/M/0IYGxT288T8n
cP6KROj0v3YwO8QnN+G/JLKNqcez6b/5gNKj5Jvvv9FoeFM9epe/4s6MzZu6
4T8KyIb3G1PGP4HLGH6d39Y/pn/d+dO55L8Vqeq+64nzP0BdNsrjEvI/SFSk
3SKc5r/wApoBDKPyvzKjRF77frE/rDMlGe/whr9AlfksQx33v6UbaY60wOy/
62pLzBmAxL+IyHLLBNjtv6YOvFLihuW/5hWoc43C5T8N3Rod0YbXvxiGd75u
Bu8/r5dvXkuXxL8i2F9tPh3gv6uwXAmzc/e/kbWbNfIh97+B20y2
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->68226149,ExpressionUUID->"86cab5d2-45c2-4a76-b8d6-54bfb4eb77aa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->360339012,ExpressionUUID->"929b5480-079f-41eb-b3b3-eb237d4a47a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "grd"}], "}"}], "=", 
    RowBox[{"Gradient", "[", 
     RowBox[{"qsp", ",", "xx"}], "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->313890144,ExpressionUUID->"2a7c4bbe-54f4-48da-bd21-cd429fb89b3b"],

Cell[BoxData["3.717617`"], "EchoTiming",
 CellID->2068102392,ExpressionUUID->"40a4673e-9fc2-4f39-8987-bb0f791ec380"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"grd", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}]}], "]"}], "]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1745720274,ExpressionUUID->"af6595dc-a97c-4539-b6cb-af9964a29487"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "0.7476389859037255`"}], "-", 
       RowBox[{"1.8549919901494456`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7473570833739234`"}], "-", 
       RowBox[{"1.854511253993559`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7476311402464512`"}], "-", 
       RowBox[{"1.8548800313569078`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7474607507190953`"}], "-", 
       RowBox[{"1.8541124285330457`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.7476640804515604`"}], "-", 
       RowBox[{"1.8548863655653032`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "1.1004875287985585`"}], "-", 
       RowBox[{"1.6474893571595834`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.0834148233755785`"}], "-", 
       RowBox[{"1.6354010387015196`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1023876760416726`"}], "-", 
       RowBox[{"1.6406420392908385`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1122746752722539`"}], "-", 
       RowBox[{"1.6244668938133753`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1080253858253157`"}], "-", 
       RowBox[{"1.6451215910664816`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "1.3014746354907474`"}], "-", 
       RowBox[{"1.1469265457634368`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.2040922402867065`"}], "-", 
       RowBox[{"1.0872502071587873`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.3139470933624264`"}], "-", 
       RowBox[{"1.107495020904424`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.3840643821703353`"}], "-", 
       RowBox[{"1.0323028098261218`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.348504541066721`"}], "-", 
       RowBox[{"1.1357391412601059`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.8562582701892734`"}], "-", 
       RowBox[{"0.35880738687972713`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6227110349620539`"}], "-", 
       RowBox[{"0.22231680213551014`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.8886847224903233`"}], "-", 
       RowBox[{"0.26259450857795885`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.0775423665275032`"}], "-", 
       RowBox[{"0.09644535286280301`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.9750036487299802`"}], "-", 
       RowBox[{"0.33403684281824614`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.20660887202633704`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.47432126528052676`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.5165754627639698`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6512799143036041`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.15855787021389672`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6067052136748909`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1334255361462097`"}], "+", 
       RowBox[{"0.8140379610326964`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.03712124367306434`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.5051798963591223`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1574075649,ExpressionUUID->"f617d3cd-d139-496c-820a-bd9695937bc2"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "139ec61b-9b24-4184-98e3-9f1b1ae71bd6"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"54e8a4c1-34c2-49be-a597-231f0eba846e"],
 "Jacobian Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "862d3e89-f892-4fdd-9e5d-2eb15169dd64"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->38255620,ExpressionUUID->"c8a1a714-ab22-46a3-9ee8-301b6e50b055"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->864594887,ExpressionUUID->"761bd559-2d85-48b0-b982-5c9efadd218d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1371910207,ExpressionUUID->"96890b2c-fe13-450a-8837-cbe480854928"],

Cell["Construct a QSP:", "ExampleText",
 CellID->162931210,ExpressionUUID->"4ac3fd49-74cd-44f2-b01c-387b2d45600f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$phi", "=", 
  RowBox[{
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}], "*", 
   RowBox[{"Pi", "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$parity", "=", 
   RowBox[{"-", "1"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->343196545,ExpressionUUID->"fba35e4e-73b1-4adf-b3ec-4353e5a73a87"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->638385350,ExpressionUUID->"b8f045a6-23bd-4f44-a2df-0ea7cd6d5f7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->918428547,ExpressionUUID->"d01e59af-32e2-40c2-9792-6319f3da8236"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{1.0523932828678402`, 
    1.3747791482091025`, -0.4063726489518741}, -1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->514277038,ExpressionUUID->"d145aa33-add0-44f4-a9a3-af681091c509"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"Cos", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "*", "Pi"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1374222030,ExpressionUUID->"f92c094b-6ca5-419f-a4f5-0fe8e36dd3d6"],

Cell[BoxData[
 RowBox[{"-", "0.9763034131218359`"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1979982138,ExpressionUUID->"3225da5d-4c26-4f5e-ab60-4770b092d87c"]
}, Open  ]],

Cell["\<\
Calculate the Jacobian matrix the Chebyshev coefficients with respect to the \
phases:\
\>", "ExampleText",
 CellID->523581948,ExpressionUUID->"1258ec0a-b76e-42e7-882a-2b3dd2812b91"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cff", ",", "jac"}], "}"}], "=", 
   RowBox[{"Jacobian", "[", "$qsp", "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1601298277,ExpressionUUID->"cd130ce4-213d-481e-a51c-989f859a2600"],

Cell[CellGroupData[{

Cell[BoxData["cff"], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->450237662,ExpressionUUID->"601adca7-77f1-4a2e-b171-8712d9b45837"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.2602311260461158`"}], "-", 
    RowBox[{"0.7611134399038367`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3450831485647699`"}], "-", 
    RowBox[{"0.04976818742283829`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.01629028033872486`"}], "+", 
    RowBox[{"0.02755042198253971`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->153199454,ExpressionUUID->"73c18540-e401-4491-902e-746fde78ab23"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "jac", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->30274202,ExpressionUUID->"eb99cc34-c665-4eaf-bcb8-a4f51fc6110d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1.522226879807674`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5204622520922315`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.25097163688678475`"}], "-", 
       RowBox[{"1.233177156841502`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6998326728947746`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9233108263695126`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.09953637484567669`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.6901662971295398`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.6535555211756574`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2674606711686963`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.11915001937234378`"}], "-", 
       RowBox[{"0.3436095762973714`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.05510084396507945`"}], "-", 
       RowBox[{"0.032580560677449785`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.164078526399397`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2774926242264156`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.014020242834160321`"}], "+", 
       RowBox[{"0.023711292767662852`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->2137814272,ExpressionUUID->"32f0644a-a827-4d76-aa93-c1ca32b87052"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{"ChebyshevCoefficients", "[", 
   RowBox[{"$qsp", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$n", "+", "1"}], ",", "$parity"}], "}"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->429782927,ExpressionUUID->"51e7f530-2b09-49ce-986b-fd5b6dce6e31"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.26023112604611576`"}], "-", 
    RowBox[{"0.7611134399038368`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3450831485647699`"}], "-", 
    RowBox[{"0.0497681874228383`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.016290280338724896`"}], "+", 
    RowBox[{"0.027550421982539767`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->695571547,ExpressionUUID->"bee52923-6e9b-4807-93ed-40d2b470a4d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cff", "-", "new"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->379226317,ExpressionUUID->"ebb1ce87-5733-44be-9fbb-a1b324856a19"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellLabel->"Out[10]=",
 CellID->1717499808,ExpressionUUID->"56a34644-4a08-4c34-a6ae-1ea295c72d18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "931a3cae-9b83-4949-810b-f83b1777f01f"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->512088563,ExpressionUUID->"47cdfeb7-edec-4d96-8d7b-c05bfb09d874"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "75"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1705504812,ExpressionUUID->"0785aa86-f8f8-44b0-803f-a6b0fe91fc01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1955138775,ExpressionUUID->"7ee78d89-4dda-4c35-abdb-62a07ad35444"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1370108678,ExpressionUUID->"429cba2b-9dd0-4a06-b366-09e5711fe52d"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[3]=",
 CellID->1691573729,ExpressionUUID->"a5a33450-ec57-4e7b-bc33-db28d1367df8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->42686767,ExpressionUUID->"e2ceff59-f7f3-4fcf-876d-b37b70530db0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["148", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}], ",", 
                    "1.3526643903415392`", ",", 
                    RowBox[{"-", "1.4612784342395748`"}], ",", 
                    "1.2380248457091423`", ",", 
                    RowBox[{"-", "0.4898389003561131`"}], ",", 
                    "0.14740162462925227`", ",", "0.09519214138002281`", ",", 
                    
                    RowBox[{"-", "0.054377159963480484`"}], ",", 
                    "1.1366917987048297`", ",", 
                    RowBox[{"-", "0.9313131184913914`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwBZQKa/SFib1JlAQAAAEsAAADCKMdWmtbwP0p+jGsY//U/Fi5PbQIC2r/n
sG9qg6T1P4OL1n5lYfe/pUz/I/PO8z+So1VChVnfv9J3lHIO3sI/ZTsQHoNe
uD+SkGK3UtervzoZUb3jL/I/mjNIK1HN7b+ODIEp/w7tvwk0qfGDMtC/5FUa
BqIR5T+C2oqJ6rbnv+vIT+d30NA/36VHNZG66j9UEaj0Vk7RP3Lx+egYIPi/
ZvJ44rBL+D+CZ2RyYlruv+DKOxu8kua/ZLABsHUVxr+uW3p3rbrwP2zqRunA
uvM/ORtxR9lO8T8gEKsW4cbsP3H+kgsPEvg/N30clbQn9b/3XTp7207cvw7K
CN/azda/dezoiRYt9D/5o6J1nBH0v8qhqszH/OM/cZV8jIWBqD+J3WQ173PZ
vyhiulutxNo/aHOk30Km9L8np2ibHJLlP50ylu4YIeM/qt2wt8Fa8b+g/azw
FHjyP3pplXQTBMI/+E8gvHYH0796+6S7MwrivyY7aPXgH/M/0IYGxT288T8n
cP6KROj0v3YwO8QnN+G/JLKNqcez6b/5gNKj5Jvvv9FoeFM9epe/4s6MzZu6
4T8KyIb3G1PGP4HLGH6d39Y/pn/d+dO55L8Vqeq+64nzP0BdNsrjEvI/SFSk
3SKc5r/wApoBDKPyvzKjRF77frE/rDMlGe/whr9AlfksQx33v6UbaY60wOy/
62pLzBmAxL+IyHLLBNjtv6YOvFLihuW/5hWoc43C5T8N3Rod0YbXvxiGd75u
Bu8/r5dvXkuXxL8i2F9tPh3gv6uwXAmzc/e/kbWbNfIh97+B20y2
    "], 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1891144317,ExpressionUUID->"73bf4283-28e3-4bc9-b17f-2b3ffceb69d3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1963149449,ExpressionUUID->"7028819e-8bcc-42f3-816f-460c43639a83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cff", ",", "jac"}], "}"}], "=", 
    RowBox[{"Jacobian", "[", "$qsp", "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->714036835,ExpressionUUID->"4be80aff-8d65-477e-8674-243f8e2e38f9"],

Cell[BoxData["3.69898`"], "EchoTiming",
 CellID->1704560219,ExpressionUUID->"953c8ed6-f213-4168-aa44-2bb73efeb061"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"jac", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{"UpTo", "[", "5", "]"}]}]}], "]"}], "]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1994254140,ExpressionUUID->"ffaf46af-e0f8-4363-9111-60e706c65bab"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.10732694992958547`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3336074545476465`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0959251305470628`"}], "-", 
       RowBox[{"0.3523320370881716`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09741941203650925`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3368060087131481`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.20049921569346335`"}], "-", 
       RowBox[{"0.3971878392532484`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0839563448552769`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.32210909366168267`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.2880009589529222`"}], "-", 
       RowBox[{"0.761516990036452`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.23978592500425494`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.267312488420766`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.29731226353769974`"}], "-", 
       RowBox[{"0.7303137156920703`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1196883237734089`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.2455167748427231`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.30583680464939306`"}], "-", 
       RowBox[{"0.7717872255700957`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.14352211980460244`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.20437003455206015`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.2681270244161595`"}], "-", 
       RowBox[{"0.6071438444022214`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1518650547910353`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2478239005759883`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.008613609028514836`"}], "-", 
       RowBox[{"0.5970044400906976`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.21398620985314284`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.19304174933267`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.04828327650186211`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2774318040665258`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6158256914964385`"}], "-", 
       RowBox[{"0.32820786915146943`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.10792020842075108`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.4112214719482929`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0909602809008879`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2475035377862933`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1874135632946686`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.23988211090836487`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.6902568892430568`"}], "-", 
       RowBox[{"0.04706157499515176`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.10268272577955069`"}], "-", 
       RowBox[{"0.02540614540743067`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6300579863497657`"}], "-", 
       RowBox[{"0.027793534825155765`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.060432975775725796`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.13038596081342144`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.6876932784479498`"}], "-", 
       RowBox[{"0.026995819308095994`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1111749753,ExpressionUUID->"58bc0837-54cf-41bc-ae1d-da18870211b0"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "3"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "2c1691d7-776a-4b7f-9f7a-065b7298933d"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"eb895e02-55ab-4d98-8f0c-1994ff413707"],
 "Hessian Matrix",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "314bba58-6523-4f94-88d6-02cff3bcaa61"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->729870429,ExpressionUUID->"21ac121a-b2f7-46b3-a0c0-ff4032ce4e4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1888803347,ExpressionUUID->"878bbbf8-a054-4094-ac42-70cd33cd7d20"],

Cell["Construct a QSP:", "ExampleText",
 CellID->891018326,ExpressionUUID->"024fa53c-6765-471d-bd73-4791b1630e5f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$d", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$full", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{"$d", "+", "1"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1014583075,ExpressionUUID->"a8d132e3-bd39-46d4-a23e-364c94881a6a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.0523932828678402`", ",", "1.3747791482091025`", ",", 
   RowBox[{"-", "0.4063726489518741`"}]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->2070369771,ExpressionUUID->"e761d575-2bea-420c-9ede-766c7ed46d58"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", "$full", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->599153438,ExpressionUUID->"10496955-4472-4190-9e38-8759a3acc165"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "1.0523932828678402`", ",", "1.3747791482091025`", ",", 
                    RowBox[{"-", "0.4063726489518741`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{1.0523932828678402`, 
   1.3747791482091025`, -0.4063726489518741}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1027208856,ExpressionUUID->"e9aaed7d-7976-401e-9236-fe1d16e6b021"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP:", "ExampleText",
 CellID->316224040,ExpressionUUID->"23aaffc4-f599-48f7-919d-fd94a5b60750"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->2132222963,ExpressionUUID->"5ccd4a0d-81fe-471c-b951-46a03702a3f3"],

Cell[BoxData["0.8611328962689639`"], "Output",
 CellLabel->"Out[4]=",
 CellID->678204559,ExpressionUUID->"cf0c1411-7b1e-4443-b8e5-f2e8f11ed64a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "hss"}], "}"}], "=", 
  RowBox[{"Hessian", "[", 
   RowBox[{"qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->818380663,ExpressionUUID->"63cce546-15c6-49fb-b355-e12781087a5e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.5153551899367812`"}], "+", 
    RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1888308484,ExpressionUUID->"3d3530f3-ef47-4837-88f0-acd50d0287d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"val", "-", 
   RowBox[{"qsp", "[", "$x", "]"}]}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->580159733,ExpressionUUID->"2cec9c62-fcd7-4433-ae92-233f87b6266d"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->1287355222,ExpressionUUID->"191109a1-cff7-463b-a455-7eb8370dc524"]
}, Open  ]],

Cell["\<\
To verify the above result, let us calculate the Hessian matrix by explicitly \
taking the partial derivative with respect to the phase variables:\
\>", "ExampleText",
 CellID->1948001229,ExpressionUUID->"e2ef3f00-042c-4556-b626-8e3f3b09406c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$d"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun", "=", 
   RowBox[{"QSP", "[", "var", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{
   RowBox[{"Matrix", "[", 
    RowBox[{"fun", ",", "$x"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->104260101,ExpressionUUID->"d62ac041-346f-4952-a38b-ea39e0c0dc2b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->681472629,ExpressionUUID->"d5d47d2d-25c7-4a4b-a10d-b0bbcbaadc6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "0.2584501349634259`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][0]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.7415498650365742`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "0"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][0]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "0"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     InterpretationBox[
      SubscriptBox["\[Phi]", 
       TemplateBox[{",", "\",\"", "2"},
        "RowWithSeparators"]],
      $CellContext`\[Phi][2]], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "2"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][2]], "]"}]}]}], ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->980186152,ExpressionUUID->"8101a741-288f-4499-831a-1d2558b547f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"fun", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", "var", ",", 
     "var"}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"var", "->", "$full"}], "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->447088284,ExpressionUUID->"44503b37-3ffa-4e92-b308-5a6e79280ad0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.12974669072139716`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.49561199655712734`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.5153551899367812`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.8398386288552563`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->641600527,ExpressionUUID->"d0c10d67-55a6-441c-9615-635a7ba6f04f"]
}, Open  ]],

Cell["Finally, compare the two results:", "ExampleText",
 CellID->1592012364,ExpressionUUID->"2bf0d98e-f84d-424a-9214-01a85138d7d4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hss", "-", "new"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->2109008775,ExpressionUUID->"06be8b29-9de4-46ae-82ec-7e01987d86d2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->864665702,ExpressionUUID->"99e1cecb-5936-45ac-9d31-d3da66a37297"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "02f7c0da-2898-4c8b-823e-4b4a2ebfbf04"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->16707169,ExpressionUUID->"5bea972e-290c-4d73-8b38-8eeaf66ef0e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1832672994,ExpressionUUID->"9babff77-61e6-4ce6-82a9-807b867cbd8d"],

Cell[TextData[{
 "Construct a QSP with a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " phase vector:"
}], "ExampleText",
 CellID->377061237,ExpressionUUID->"389aaa24-7313-4a89-8b76-494d5e2a9588"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$d", "=", 
  RowBox[{
   RowBox[{"2", "*", "$n"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "$parity"}], ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$phi", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{"$n", "+", "1"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->43967962,ExpressionUUID->"26ddf4ea-3768-4490-8db4-63c588b291a4"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[2]=",
 CellID->414614265,ExpressionUUID->"c383db4f-9d8a-41db-a87e-cd3ba6a59ca0"],

Cell[BoxData["4"], "Output",
 CellLabel->"Out[2]=",
 CellID->1985000987,ExpressionUUID->"a2374cfb-15e4-4332-b22e-36a109e0f28e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5339902389407843`", ",", "1.1787619696233085`", ",", 
   "0.7580510288911491`"}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->753132364,ExpressionUUID->"8a29f363-80e2-4292-b736-771f488ad0a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->200293604,ExpressionUUID->"8f67cc32-a8bb-4cfc-b371-390276bcaf5e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "0.5339902389407843`", ",", "1.1787619696233085`", ",", 
                    "0.7580510288911491`"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{0.5339902389407843, 1.1787619696233085`, 
    0.7580510288911491}, 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->627026330,ExpressionUUID->"84fcf4a6-0e1e-497d-ac7f-c9638f349c42"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP:", "ExampleText",
 CellID->1394539877,ExpressionUUID->"ff8575b8-6751-4a10-a7a5-ca9d2b023964"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$x", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->395189381,ExpressionUUID->"4d903c22-c656-4fbf-b7cb-9e6feb44f057"],

Cell[BoxData["0.7222657925379279`"], "Output",
 CellLabel->"Out[4]=",
 CellID->729272481,ExpressionUUID->"739a7198-91b2-498a-93d9-3807cd527fba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"val", ",", "hss"}], "}"}], "=", 
  RowBox[{"Hessian", "[", 
   RowBox[{"qsp", ",", "$x"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->159787830,ExpressionUUID->"73c7e3ae-d7aa-4d83-840a-4fdd1160e022"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5769627824536402`", "\[VeryThinSpace]", "-", 
    RowBox[{"0.4145364025864139`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2.3078511298145608`"}], "+", 
        RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.2552598932355523`", "\[VeryThinSpace]", "+", 
        RowBox[{"2.5361482143617504`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "3.35838258479375`"}], "+", 
        RowBox[{"2.1631785520385023`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1.2552598932355523`", "\[VeryThinSpace]", "+", 
        RowBox[{"2.5361482143617504`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "2.4130282108016887`"}], "+", 
        RowBox[{"1.466902161955848`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.033706474826593384`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.004835123625018142`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3.35838258479375`"}], "+", 
        RowBox[{"2.1631785520385023`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.033706474826593384`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.004835123625018142`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "2.3078511298145608`"}], "+", 
        RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1193414738,ExpressionUUID->"b1f3e0da-b289-4cbb-af2e-cd7619fb9246"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"val", "-", 
   RowBox[{"qsp", "[", "$x", "]"}]}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1568514031,ExpressionUUID->"31b7e7ed-e7d7-49cf-a736-da9dc7fd2bbc"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->224238586,ExpressionUUID->"125aa64e-b06d-47dd-8d18-3bf9b398b148"]
}, Open  ]],

Cell["\<\
To verify the above result, let us calculate the Hessian matrix by explicitly \
taking the partial derivative with respect to the phase variables:\
\>", "ExampleText",
 CellID->664134417,ExpressionUUID->"80c9ec1b-fe39-47c7-9fe1-c6134620d783"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"var", "=", 
  RowBox[{"\[Phi]", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "$n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fun", "=", 
   RowBox[{"QSP", "[", 
    RowBox[{"{", 
     RowBox[{"var", ",", "$parity"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{
   RowBox[{"Matrix", "[", 
    RowBox[{"fun", ",", "$x"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1634633060,ExpressionUUID->"592d83cf-2fc1-4fdd-826a-9604cf2dc61a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "0"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][0]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][1]], ",", 
   InterpretationBox[
    SubscriptBox["\[Phi]", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`\[Phi][2]]}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->2091598064,ExpressionUUID->"99977c3e-7f85-4829-b4b4-276b827a0bd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     InterpretationBox[
      SubscriptBox["\[Phi]", 
       TemplateBox[{",", "\",\"", "0"},
        "RowWithSeparators"]],
      $CellContext`\[Phi][0]], "]"}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"Sin", "[", 
      InterpretationBox[
       SubscriptBox["\[Phi]", 
        TemplateBox[{",", "\",\"", "0"},
         "RowWithSeparators"]],
       $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.7222657925379279`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.47833212492955896`"}], "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.5216678750704411`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{"0.7222657925379279`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        InterpretationBox[
         SubscriptBox["\[Phi]", 
          TemplateBox[{",", "\",\"", "1"},
           "RowWithSeparators"]],
         $CellContext`\[Phi][1]], "]"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Sin", "[", 
         InterpretationBox[
          SubscriptBox["\[Phi]", 
           TemplateBox[{",", "\",\"", "1"},
            "RowWithSeparators"]],
          $CellContext`\[Phi][1]], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"0.`", "\[VeryThinSpace]", "+", 
          RowBox[{"0.6916155904326904`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.49953028255545406`", " ", "\[ImaginaryI]"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "-", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{"0.7222657925379279`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.47833212492955896`"}], "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.5216678750704411`", "\[VeryThinSpace]", "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "0"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][0]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "0"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][0]], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              InterpretationBox[
               SubscriptBox["\[Phi]", 
                TemplateBox[{",", "\",\"", "1"},
                 "RowWithSeparators"]],
               $CellContext`\[Phi][1]], "]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"Sin", "[", 
               InterpretationBox[
                SubscriptBox["\[Phi]", 
                 TemplateBox[{",", "\",\"", "1"},
                  "RowWithSeparators"]],
                $CellContext`\[Phi][1]], "]"}]}]}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            InterpretationBox[
             SubscriptBox["\[Phi]", 
              TemplateBox[{",", "\",\"", "2"},
               "RowWithSeparators"]],
             $CellContext`\[Phi][2]], "]"}], "+", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{"Sin", "[", 
             InterpretationBox[
              SubscriptBox["\[Phi]", 
               TemplateBox[{",", "\",\"", "2"},
                "RowWithSeparators"]],
              $CellContext`\[Phi][2]], "]"}]}]}], ")"}], "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellLabel->"Out[7]=",
 CellID->1328843905,ExpressionUUID->"69e91f77-07a9-4582-a768-b74bed34e087"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "=", 
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"fun", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", "var", ",", 
     "var"}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"var", "->", "$phi"}], "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2087253347,ExpressionUUID->"24a75f2e-8424-4ecd-8489-d1965b3ea2c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2.3078511298145594`"}], "+", 
      RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.2552598932355528`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.5361482143617513`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.358382584793751`"}], "+", 
      RowBox[{"2.1631785520385027`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.2552598932355528`", "\[VeryThinSpace]", "+", 
      RowBox[{"2.5361482143617513`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.413028210801688`"}], "+", 
      RowBox[{"1.4669021619558475`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03370647482659327`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.004835123625018508`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3.358382584793751`"}], "+", 
      RowBox[{"2.1631785520385027`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03370647482659327`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.004835123625018508`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.3078511298145594`"}], "+", 
      RowBox[{"1.6581456103456556`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->49582535,ExpressionUUID->"7e8e3a0e-e817-47b6-821e-e4e45e554fe7"]
}, Open  ]],

Cell["Finally, compare the two results:", "ExampleText",
 CellID->1200015267,ExpressionUUID->"25d4be5a-19ad-454f-bd88-1d14bdebad85"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"hss", "-", "new"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input",\

 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1637663492,ExpressionUUID->"9ccf8beb-b807-4581-8b06-2be62067ed13"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->110010709,ExpressionUUID->"ed45ce88-5f9b-4a9e-9af6-0d5c708f4fce"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "263cb138-4e06-411e-99cd-0fe8dbd3aaf4"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->486630493,ExpressionUUID->"23c5f7dc-187a-4765-8775-2fa530cc7f0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1180968075,ExpressionUUID->"de83b062-fabe-44ac-af76-fc1cd5f4b032"],

Cell[TextData[{
 "Construct a QSP with a ",
 StyleBox["reduced",
  FontSlant->"Italic"],
 " phase vector:"
}], "ExampleText",
 CellID->1486570951,ExpressionUUID->"88fbf5c8-f9f3-464a-9741-8bbf9b13f357"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$d", "=", 
  RowBox[{
   RowBox[{"2", "*", "$n"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "$parity"}], ")"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$phi", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
      RowBox[{"Pi", "/", "2"}]}], ",", 
     RowBox[{"$n", "+", "1"}]}], "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->973224259,ExpressionUUID->"4a1a9aa5-255a-42f4-a4d3-67ebaeb27a29"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[2]=",
 CellID->2114049743,ExpressionUUID->"9698c83b-ac7a-4199-be4c-b55ee50392eb"],

Cell[BoxData["50"], "Output",
 CellLabel->"Out[2]=",
 CellID->717090986,ExpressionUUID->"8eca6526-04e0-4506-9492-69816995ccc9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qsp", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{"{", 
    RowBox[{"$phi", ",", "$parity"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1678153624,ExpressionUUID->"8565f017-0767-47f1-b44f-7e610654d779"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["50", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["50", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Identity", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "0.5339902389407843`", ",", "1.1787619696233085`", ",", 
                    "0.7580510288911491`", ",", "1.134532453888182`", ",", 
                    RowBox[{"-", "1.3517605416842526`"}], ",", 
                    "0.9052533646233881`", ",", "0.591118526082671`", ",", 
                    RowBox[{"-", "1.2759930775363912`"}], ",", 
                    RowBox[{"-", "1.3804120440348508`"}], ",", 
                    "1.4620420068679363`", ",", "0.702587270614763`", ",", 
                    RowBox[{"-", "0.29182991018788623`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{{0.5339902389407843, 1.1787619696233085`, 
    0.7580510288911491, 1.134532453888182, -1.3517605416842526`, 
    0.9052533646233881, 
    0.591118526082671, -1.2759930775363912`, -1.3804120440348508`, 
    1.4620420068679363`, 
    0.702587270614763, -0.29182991018788623`, -0.2453649835205999, 
    1.0646298953735758`, -0.2539914181956648, 
    0.08863906086950231, -1.045348527321529, 
    0.09975231071398345, -1.0299833787160213`, -1.4448761853812915`, 
    1.4661621476657107`, -0.3262702156822805, 0.1599724033204789, 
    1.2257365296209746`, 0.5203548471987617, 0.895391934691802}, 1}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->469974738,ExpressionUUID->"40e6acec-b545-4feb-883e-f510b86a8d6d"]
}, Open  ]],

Cell["Calculate the Hessian matrix of the QSP:", "ExampleText",
 CellID->1858429471,ExpressionUUID->"bdca29e7-b60f-4724-aac8-2b0e0f108151"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1621957129,ExpressionUUID->"df07d200-60d9-4491-8c67-a411b2ff61d6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"EchoTiming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "hss"}], "}"}], "=", 
    RowBox[{"Hessian", "[", 
     RowBox[{"qsp", ",", "xx"}], "]"}]}], "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->454622630,ExpressionUUID->"ea989692-d525-4aa3-9446-e64f141f071c"],

Cell[BoxData["2.913976`"], "EchoTiming",
 CellID->420567900,ExpressionUUID->"7adfb2d4-85f1-49f7-8cb5-64a13bcebab1"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "3"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "b26e5089-9d4d-48d2-a50b-2e4630566729"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"538b8878-d4d2-4c03-93fd-85d963e2381d"],
 "Applications",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "6328c033-160d-48d5-8434-3a7b4f11baca"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->701469844,ExpressionUUID->"f751b05b-4caa-4038-bb75-fd9e5fbd552b"],

Cell["\<\
Evaluating a QSP involves a multiplication of many matrices. The \
computational cost can be reduced to half by using the reduced phase vector.\
\>", "ExampleText",
 CellID->411726774,ExpressionUUID->"a750081c-4157-466e-bc8a-b0251270fa76"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "350", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->271315786,ExpressionUUID->"129b18d1-402b-4fcf-a7bd-c0e8b420d3fe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"$n", "=", 
  RowBox[{"400", "+", 
   RowBox[{"RandomChoice", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"5", ",", "10"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"$parity", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1529848425,ExpressionUUID->"d0f4003d-e115-4fe9-9d24-b6decdc991de"],

Cell[BoxData["410"], "Output",
 CellLabel->"Out[2]=",
 CellID->1116013023,ExpressionUUID->"0f4219ca-e8c4-46c3-89ae-9385bef524f9"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->708704663,ExpressionUUID->"70b43bbd-62f0-4e69-8973-25f819479d58"]
}, Open  ]],

Cell["Construct a QSP with the reduced phase vector.", "ExampleText",
 CellID->263062639,ExpressionUUID->"d622910f-a40b-46d3-b6f7-df079600ce02"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$phi", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "*", 
       RowBox[{"Pi", "/", "2"}]}], ",", "$n"}], "]"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{"reduced", " ", "phase", " ", "vector"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"$post", "=", 
  RowBox[{"RandomChoice", "[", 
   RowBox[{"{", 
    RowBox[{"Re", ",", "Im"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"fun", "=", 
  RowBox[{"QSP", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"$phi", ",", "$parity"}], "}"}], ",", "$post"}], 
   "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->252225698,ExpressionUUID->"b04088fb-c273-4105-b395-e3acb5eac3e7"],

Cell[BoxData["Im"], "Output",
 CellLabel->"Out[3]=",
 CellID->487988694,ExpressionUUID->"a4518156-6f56-4d0b-8b43-134b126975eb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Im", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"1.188652429517412`", ",", 
                    RowBox[{"-", "1.5282539570581533`"}], ",", 
                    RowBox[{"-", "0.17942028160821494`"}], ",", 
                    RowBox[{"-", "1.2173503105164918`"}], ",", 
                    RowBox[{"-", "0.11887669407281704`"}], ",", 
                    RowBox[{"-", "0.18324875551430472`"}], ",", 
                    RowBox[{"-", "1.4383225005814628`"}], ",", 
                    RowBox[{"-", "1.5529442957893163`"}], ",", 
                    "1.1890198090786863`", ",", "0.8937051586490578`", ",", 
                    RowBox[{"-", "0.5875081577071491`"}], ",", 
                    RowBox[{"-", "1.3983546572808385`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[{CompressedData["
1:eJwNz2cgFQofgHFJRTfKjSiVUiiV9n2J/CmVFlJJisoIpbKSjCRys1JIkaSI
RNYpIfyNjJBkHXuc5ZyDs5eE9355Pv+e9Q63rJznSUlJJf8XRzeua4kMH6aq
e66XeUuwPWLY1Uhcj8Urv5wy9eej4M2JKcLNSvxZNj1V6NOA5XGnfOzni9Go
RXftQI8EjdIy3uov5IOyybNYg6QJ+PfRLfpgCwlXFCzXyL4kQtrhdhv1pVPY
7kxyBR4J7m3wU7p7iQO2RsscQ8pZYEGskaqMpMBonq+TR5gY35DWzHw+IEG9
5COzLvuaYH7EF8wP44EqXJFWvD+IurYRKhqGdPR6TWbbZ4pBN2jL4g36nXBO
a/Qfl6VM9F+qFV/uKETv4hMx19YOgAM57OqdFxTUrMGzRpk83Fr/uJ4sLwGp
eJnca4a56PN+uNkltAcNN69eQRnkA8HUSSx48Q0Vfmru3Zgmgla4eHm2fhK0
qQsUCpeKUfXXEjm3ujaMOVu5KMyuHCPpc5NB4wNIJkTQZIdZwGD+YDU/FaOX
5a8zXYljQHRNLSY48IHFPrCyOl6Mtn+eRAevo0DEa4mHj5CDVtExXjEbmLAr
0masVEmI0lv2/dn9loYHFShupY8ZEJieaxXcLkSvy5VJW2/+gJ8acXd+N/Nx
eZb019JfjTBdLGRqW3aDzP9YFRfSGWBc/SzElSbGSYXW46HsCWRstK1RK6oC
9ExLorycgIFmcc+VR9WQP//tVMlKHpbvsjlO4nYh4cDCzudBn/DVeMnWp0um
sG7to7zsU+2QE4+pX3MpkBr2ViVHSoJLbFOIKeuC4UnIyj8JxDo05p9ff6E5
BysrzRdcUaOhzZaiY/s9BXg2pem1XGI9Tg45r3qnS4eSUmeNY/wxyEyPyEs8
SocDilfroI4C243P2SYShPjMyMFZiswF9uyuJZP2Ijg7kdG3Y0EVzL3Z7NdF
HIDNVn5jN86IkXXtDdPl5BDWNjXtorYOY+ieOwWZe3io8SwymEItRp1Y53YT
Mw5Wq8pmeKcK4WBityexpwXWsj6Pvk1gYocVXwHbO6DU3eXLpDwJbOVmzTYu
oEIsWUw8ajaJX35rXTB4WgUa7Vo5gUQJdH3IvEfyJ+HjPUmFO6uJGJEoQ1IN
7sGP8z6G9SrlIDHmpkJz+ChWSOV/nlYW4D0dVvlLKREE7ZJNydStgpem/U6m
iwRgEByw8WTXMHA6AhzTbmTCqXnbztl6jEJORcQhL9Y4jt2NVvaeYcIEYXaN
2kEOOt+wqhncNgGHeD+u7TCfxKWiOvUtHhwc/Bphx7BqhxnbzhIbAhNNjezG
PqwW4Liezl5VYwkcXZ7yWdWMjKH05vFDe/lQZtH9yIA8gguuNzc+aCaBvrK/
yuEQEX5aXisd/4WDWaU/27SACuKIQ9+rQoX4NGQ662KkBC1enPSyWkLGvIeS
OMeIZlixe0hPQ5oLvoWucs8ZFFThyn4+VEcEnalrljn0EXw8NMPY82McFPq7
XiQeFIBha9spelwZRj3403fVdAItVxF9bi2mgqNt2SrwJWH/7cPNBeq96KWr
lj8sQ8eo7N9eFLshPEj84GRMFoBCiP/Gh0+YuLT0b5fGZha8DpwK21dSDccE
Rf8WUnhQvS2oPpdXBB+UBjYX3h7F7McpT2VHSsCzlfnyWOB/n72za/wfTIB5
Y1qjulUDWiWPBT7z4IFoBnXnzn8ErZkzEYF2HfisNjTmXL4EOVtd5dQVw8E3
TpeUYM1D7QNZT2vpHITbvu7mKi3waW1XTZqoBzUXrbBQXT0FNqW03wYMMST7
OKupmzphz4MCy6ZSKtil0e+Zb5jA/H9rTGUzqHi/9tL5TnMhmCZFBPiq02HE
6XSlF70da51VG46xGlFzOCXhunsRmtzYf+fRyW/oeG+9Z2/tGO7M82P72ZCh
z/1SylcmDzd+r8z1ZY1h3bugzFgaFR3P7Cte8ZyKzx+zjDv+asAwKyVbr0uT
4Ba0Za3PcyEo2farzIUTkBqeZHJEngcPjRYbepkz0bvl9bJ0uzE4fdt0Raw2
E6YiJVH8QRGGk6c5DqfH4FqyqU5ZpwRGr9oKXPXZmHFSPnp9gBgIM5RctbkJ
CHs++iiyUYx7j3sErD7Pw6i+rPFFlSRIjyaNNQgKYNWPVlnro+MgUlKymxZL
gFnpmJDYzoYv9LsnUoU9qKQ+rc3fNA4WAdcvRM9yYDyqCc4H9UFeaTypu1EC
BU567f0na7Dx3Spv7f0CZBgQrnicoGDvG77sgYdlYF9D2FhoyYXZhCGNNPYw
/OHdKbqcIYLE6RnmJFuCOx5tygjmd8Ok8wdBtb4ErPlrHBOsBODLD3poYcfH
033ym4evCaB9TwDNrICPzxhVfvrrOnCIb0hw9uei5VXmQOTPEVTty2pJ6eKA
dvvojf3lbRhcvtttzR0xMPfMcob+aYAr9/7I/dagYfuis6mq7zho8alOTDGn
w5L+5mXp/UOQO7rkOoNGwZC2VSr9DkW4IETKkOEmRuuxgQpinAhTGLciZCc7
4VS06VJ3jwk8v2Bqw6bpftyedTc+POEXNBSFJVldJKGM+PewWQYHa712WPd5
czG0QYa6YR4VXBlE7qbPVJy3k1QsMRNib0W9frIBH9tIF2aMHOlYxq9RcdH7
hNaG6tENTjQ0E/EyRs4M4ZOMrMjTIzyU16u+0ZJNhoNb1WqV11fBujj2/sPG
QtSy9/kU38LDPXd/v1X07YYWzbmh5KLvcHHmuxb8EeBPllziMbYA5q+Kn/yZ
xIHMKRmFoU9ikP5sceEQnQN2k30/vBM54Bkb1vXw6hguZFYN/NQkwVz2diWX
XjHcFxoK0iIGoD4o9OviHyww0R7N7VTrQHmaVj5b8AwFLy7sXinVhOLLF4fC
6yuxcZ2Jy8G/hzFgVTvlxWkB2lVZXZty+IRvVv9ZcD+ah9+dA3+bMbvgywnF
kkpGKQjf77NvXMFGg3Jr0wY9KrruS+j0OtoGvfMft5QoE1Gj5O9U5e8ULGzv
l2RXc+EpQf+mfiUXzN1iFz0cJmHdOZkwh6fZ6PuswXT4P7/74vOHeXVMPLFW
t9fHhAJfB9wo908NAaNiZ4aLfRfO+Hk7X8d2fPveih6XRcX0ZS8y4yPTMGpN
mPxw6Bjq/JVDczjHB/IlqfQ6Ag2/zeolR8kJsBrontPrhKjjFESz3lILpu9T
hwflOejpbb/0IYGPQqYoNbRXAJ0vajpsor5BjZVRnEhXAsu/rVPbpMmFlGMc
oeYeARD2N4XXllYgL27hZUF+L1rvXJpA6KtAo+PS0SqBQvDP0uBRnYfgyArj
JPcjIxjYJecjNyFGf4XAFznAhg7j/U43FMcgVnnM9+4aLkrUq00KbISowelo
/KebDOw3e59fT8kBJl/hYDKFi9pzjPcftSWob6AzpRjZCGuPVmlnj0pw9blB
r2zFNpg9crZYP7YP5+5E2eQajUN4tecvCzk63jX/mjIu1wwLdVsTWshsNNfU
5tvt5kL07Lbk4Tw60rnfbrTIVOEOBYVF8usF6MGLjLlcTMd56TdJk1EcEEZG
nORpPYSABa9ipqQHQNprfVE3cRzWvXJAU9VRNJ+5rW9zWgQ8+HPeI5YHV06b
DPdH8zHf3unI+6d0XFYQ63gurgK6L2e16PiL0TFk97J77mSQ5IQsZ/pVA1Fb
NjDGjgbadEpX6CADAxRuGQZeKINDDtsX5lHYOPTKjGW5iAr3P9L6NpVJYP/Q
NroNiYo2Km+CnHP6ARmb0tXi++Cx/PT49vkCOB42WHBXjoemdqe7XjWw8dbm
H/oNRyhobBzP/3ygAy/kfLNYX9AKBwLYesYTPFwkdh9XpbUia3KGFp3HBP88
etB+aS52FNaHOu0iIjKYUkwGH+WcPiSn/xKjxritmWi+CNe7LtG7MfcOH1gW
ZriaCMEtP29C81oT+u+4vDjekgdrF96klzxmovwP9xDSBg52NBsaXSd0g69d
fDb7Yh/mTdBlfeLG8YNn34khxVY0OGkWQQgbRjVxnIKKVD2kauV5N1O44Kdw
qsuGNQHe4rIdRU18bI1N7nr7mgotygOj1QQxRjsrZ/1aUwxp24LysraO4Or5
I8GXHLjA0mJau5KFsPILWd+wT4xnLm8VPeB9wcAU78V3rfgYo7OtwG/DCLaV
FGtVKE7hxn8GbntsE+KrmXnvw/N68C2lNnr3bA9kuqW9MzswjiYf65MEMSPw
v57yd/71ArAPkdGfOc+Db/Gcg0/sJPB/ujUvdA==
    "], -1}, Im],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->385932165,ExpressionUUID->"d21bfa47-08d8-477c-a691-2192bb992fd2"]
}, Open  ]],

Cell["\<\
For comparison, construct an equivalent QSP with the full phase vector.\
\>", "ExampleText",
 CellID->783735018,ExpressionUUID->"918ab2ba-6d03-4ebf-baef-4cbcdf156990"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gun", "=", 
  RowBox[{"QSPConvert", "[", "fun", "]"}], 
  RowBox[{"(*", 
   RowBox[{"full", " ", "phase", " ", "vector"}], "*)"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->553874063,ExpressionUUID->"579d8704-8d44-4fec-897a-3035c09864be"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["QSP",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Degree: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["819", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Parity: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"-", "1"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"PostProcessor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["Im", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Phases: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"1.188652429517412`", ",", 
                    RowBox[{"-", "1.5282539570581533`"}], ",", 
                    RowBox[{"-", "0.17942028160821494`"}], ",", 
                    RowBox[{"-", "1.2173503105164918`"}], ",", 
                    RowBox[{"-", "0.11887669407281704`"}], ",", 
                    RowBox[{"-", "0.18324875551430472`"}], ",", 
                    RowBox[{"-", "1.4383225005814628`"}], ",", 
                    RowBox[{"-", "1.5529442957893163`"}], ",", 
                    "1.1890198090786863`", ",", "0.8937051586490578`", ",", 
                    RowBox[{"-", "0.5875081577071491`"}], ",", 
                    RowBox[{"-", "1.3983546572808385`"}]}], "}"}], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`QSP[CompressedData["
1:eJw9mXlYzWv3xkMor8JrKDOhjB0H57wirSJHHEKmRIYGMlOEFFIcpXRUQieE
SCIpUqHVoIESSho17Ha12027PbR3Un7vH7/7/avr6qq9v9/nWete9/1ZE+0O
WTn2UlNTm9dHTc1+T7tTorqMOtNK9iW7qLjAp8rJRJnFCSNfrjV3k7H8zsrO
+IMp/DG5q/PZ0Wx+Hbj26LY+SjbJMxxXUaJik/CIu0b9ZDTc7GrAwhvN9NfF
Q6JveQIeETtUL2p7B9f/UWA9flAnFzgKnEgqoNOTTgw7uV1CNiaD7T1ft9Lq
4nS1FF8h1cS4Ohz2VvIdwdjuF4tVPD90Wc/uBe+pj89LfuotJV3a2XvI2W9s
aOOjo2csYufbtW3bHijJ0GPGgElGX2iTfs3vuweJ2W2QftBrewW7JKz03zuu
guxqvXcdvy7kKem8weSBlGdmXc6q1VKRWpD6473Gj/now6rc3V4lbDxtzAjh
NxnFmzso5dffsvbHKb9NDu+gfNq6oyerhQzq+mo/G6Rk3c8DNfdkfmL/DSn9
vW1fs6/oZ4tHUwXXxvvUa1S1UqP4Q2vuFSU7r/m8viikgYqdbiXE28motW3x
yLQgJdv8+NvvzAQh+dxWHT6qkLCVn7+z/yQxzfG1bkgapuDeMxb8mHu3npdo
C/ckXW4k93uPrc4UKNh5R8qNmQc/0Ee9wOPfc2U8NLL3q6TPOdSVoBAbrPlK
6v9pfbPlXiOZpl31dKpXcot2/p9ebc3cONkmfXRcKvGR8BvCf5qpIldZsvNi
Gj3tc7czcaSUX8+x/lPQXsTxi/t9uebxnG82Jc68MrCTM8ddjIlaW0DRQXzr
1WMh3fK+qxOtpuKBNmHFYRPO0N+eI38EF2eyqWzzxC250ZySYtl35+h6tp4R
t2LRETlvCHt/WzMki1sqHUfdNxRRYpKj3gpZAz245xMTslxEi4fsyqRMIf1i
uskmJF7BV03sHNVq26mtZ87Alm0dtKE5omx231T6eWfaiaLiCppmdaLhwHol
t+69I969qpIz3r+fU5dfxV7zjsc+mCdlvau+Z4R1CTw9wLHAzELCaboaES63
FLQk5OuR4pI8Gtf6ouZusJgLrWTaXFBISft3v2zREpCNZo/F5L51FFCrLF5u
0cIvv+tvWXgllfQK9KPdi1VU9OjBaYGbgC/Pu/Hs17Ri9glRF+ieKeEnvZ54
lw6L5mL/g9q5F2r4jdrTF13D5Xx6euvrf9Q6yGOORtgDw1T6x7zcwby/nBae
OTV5VVEVSQpP2YcfeEBre83aZHO4hqLf+Cx1bm3ihpN+w126xdQc3zN29BIJ
Ox6wSv82q5mWSj/snW3ZwoM6MsfPOCzhb698bButCqjb5kuidbyYzU1sGx6N
kXPT/Om/6ZqqaPnQsBe6FrXsJcptWvqbjJJXf724sLaa++7LzTmXKyCj4W46
f3h28POhGb2DXko4MunjJ32qI6XP0nepXgq+4tkVudVXxauvr3K2GljLMedV
gfY+uTRibuV8vd7t5PrMSfNao5B12jVeLM0spumde9dEi6r5cmV347wPTaRd
XnQ9ZImcjPM/rRUFJvOlcz/Kdpk385pRxUcPDagje5vkUeQq4PJjf+TGji9l
Z8PRT6vURXwp6ruz0LaSlxQ/cjCtlZO2p9vk83+LeVDSv3fn5LbSbfdO7wWJ
abRCHvfXM6GU0mZ5ZD2WxtGjYRXTnh2r4ajLYVc0qhPpSL74nxXu/33P0p6x
bueayTInPGe8VTZbhTa4Xz0spY5uNvy5+Qnpd6/3cbct5KsZXv6bnqpYMtNJ
c/yQC+QaaCgI3ihlg8WRVzJEEqZjrvstdfLo+bii9PCOEp7Sf8Rq3TGdZJ1U
/31ho5JCjzqOHm/uwCXnYte8T6oj23DRactJzfz0r3RzjYg6PpuxffMXSwWZ
3/A55TpeRNUO61KcRQWc4aibvaI1h6dUhQXv2x/HZgcWHb+46i3bn554pDSj
gX+NOdF2wrqWyvZvD3sllvLkdymPXVsbOPO+x4OA+jq2X78gYcS1Or52udW0
8F/Z7G01zMZ5ewvt8Zgx7ug1BQ2zKdf5eSGe6y7cMFumJaXzJgOMnS3F7JJ3
e/A92wZad8x8RICBmDp9VZdk3zr4Qm2XxG5dA+0NNZ+e/EVFNbts5E5GbRyx
Sstv4iklxXcLH4/+2Uze12ou+uYo+bc/D58as1nKl8oim/qnCOien6AhWx5L
oz7ka2xc3kQdw4bZdilVJE6xDw4paKOXopMrbylKeNj4LgPZ1CZafWrfFr8e
CTVdek+bPcooJilI8DVHRbEO8wvKV6Vzzv1RLgaL5Ny4MH7n4ZVCLr0j01h8
Ppm2pcdPframnXqCK/XC26roh/R43I6IDgrp6ha3tKl49sWpEWdkX6nF8ZE8
zUhFG2Vj7YOt5OQq8zi/2lbG68q0plXtlVPBvFP1FrEyvtqYesJoQiFXyozj
Hd3aec0ucYXvx2rWLYvMCyuSkEFBzYFFrz/xmddz94w9riTxvB5J5e/ZtPP0
D83vevVc0H/DLd37El79PFMptBTRwPLcwffKK+lxzcB9jfVC9vw0SqfcLo77
eqoZN+5R8saGijfFgR0c1njIR6PlC631Mx+0/3Azb+7bOWlqVzn/Enky6ELw
Z8qO875htVXA6srvVRYREs5wnr2xzKWdvbLV6yb1qiOnxuL2qS/quNevggSV
hYJL32QZhS6U8SfBlm4TexEny9J1ds9/zhuNx/tlO9SzRYc0onp9Jf8dEem7
rlrKWvPTDuRF1dKSmaMzhk9MpQmBbYv+MFWw/rajz4PypDzv5Pe7Q1y/Ut6U
n5Whce9oa/c7ffoh54+tmiEr2uTUZ1RQy8cbEnrQqa5d+VxJvV+s3rJUJCHb
lrIPLiESOhLgXXR+VwP3E6dWfJwioJ9RvwzbXaqkswpjebhPBWV5eL0a8KGV
zAxqHn8ZXcha9fpP2+RXWX59y9yRau9ZuWNr5YWsFM6ZYLZ7yb+r+NSoAuH1
dXK2TbXa22n3nO+M+dH3rJ+U3zm6f7cQF9HLlUMSUxqTSPFwwbacEW288PVG
8+z5dey0IPiL8/JPVNrncl7i8GLWS/z3reHvhPysoFwVldZOV+KNDhqltJPl
noD+56sEnLlJ3dvuShS7Xs02r/rv8+8fsPkPaaaYV44zLD1qJqRXFXuEZ9dW
UuObXyN2byvi7hMujvu4gO8+tBIFRtbxvcHXHwT5hvOlsd5aVV4NPP1f0fV2
m2RUu13tXmZ8Pb/tmR96SVPOaSQ60jVBwdMdPOo3zsgg84e3qr5pSfiIy7ZB
5+NlrBB33PIqldOX6+mF1pfeUrqVSWCHoYqGvp0weuqUdgpbIVFMmSen+EXv
L2QkvWFpYL8d8qelvPHXQcHxZW/Y5M/efjruCnKL1JPWOVbSshGmN/Yvq2b3
Is2jms1KdtN2vx5NbVRousjhwJAGChje4HpybDurxqeZxVorWE9SmPP711pq
u/PbtX1h0SSWaS8JFbazwc/Gh08MVGy0cHrnEN8cGrc81SCqRsVjNn1zjhry
iXqWbUgwCijjn8cvWT82aaILaUc+r9YU8UnLV2FNmrnUzzA/OK+2jS2nGMhs
57aTX8+s0KoYEYva3x7IU0/l2dra/bUmyvmw1Nd/R4KIe907KGi5JCGFr88q
qf55OtX3pn9n7wrq7Twx7mtxE024acfmujVs2X3MyHpdB0npx+bDAVLauc6s
qtxPxk+3OSx7eEXEg2MD7DcFvqGvOyLzprsp2d5z7uDT+2tJFe05VHwijYoN
NNz9bevJQCQs8vrWyKe0Dxm7b0mmpXa/9IsRtnHlTYvWNf3r6OyT+rKpySpa
VDlLZC2oY2udOx6O0eXEjVPvjQ4qo8taXU2/9JHTn97fYk9qStncdl3Rzew2
PjTtg1H2MiGbmgbJXiwu5C3Rb1dPjM2nxafa5ps2S7m/cn+Tbn0+t7Z01/vF
iMktRuSxqHc7Fz7L8nKYU8zcKFYTN8pY0+FR6L3PStZrsrHo6NPBE50Gzj/w
8z6fW/MswslMQXuexjRP2fue3WbvGBC0Rkrj+h0UJV4Ws9aH/Z6CSRIuzDU2
2Rf/lVxtg6LatpZxTLNI42hgEz86Urayckg+L1xl4RPvXcWjlYHaOmpZdEs/
xiVX2E4ntNcWWbc2k4syeXbcexnnB4QW3b1dR3nDK2rS4pXs5zg88vPYBAqf
5RETObOax/SpPrPdrp1a9cUbnWoVNPJlrZFxmZLX75jZcU76kt3DXAactJKx
//RZsScmVfOnxAT9N0M6efLvFccOz1Lwze5eDy/ElPBdYYbf3J4SerAn/L7F
4iY2e5J1Q+5fTf8peX3fLUtO2zzVjbo3S+ltkGTJ37aq//3E7/F3+D98Dj4X
34PvxXPgufCceG68B94L74n3xjngXHBOODecI84V54xzxz3gXnBPuDfcI+4V
94x7Rx2gLlAnqBvUEeoKdYa6Qx2iLlGnqFvUMeoadY66Rx+gL9An6Bv0EfoK
fYa+Qx+iL9Gn6Fv0MfoafY6+hw5AF6AT0A3oCHQFOgPdgQ5Bl6BT0C3oGHQN
Ogfdgw5CF6GT0E3oKHQVOgvdhQ5Dl6HT0G3oOHQdOg/dxxzAXMCcwNzAHMFc
wZzB3MEcwlzCnMLcwhzDXMOcw9zDHMRcxJzE3MQcxVzFnMXcxRzGXMacxtzG
HMdcx5zH3IcPgC+AT4BvgI+Ar4DPgO+AD4EvgU+Bb4GPga+Bz4HvgQ+CL4JP
gm+Cj4Kvgs+C74IPgy+DT4Nvg4+Dr4PPg++DD4QvhE+Eb4SPhK+Ez4TvhA+F
L4VPhW+Fj4Wvhc+F74UPhi+GT4Zvho+Gr4bPhu+GD4cvh0+Hb4ePh6+Hz4fv
Rw5ALkBOQG5AjkCuQM5A7kAOQS5BTkFuQY5BrkHOQe5BDkIuQk5CbkKOQq5C
zkLuQg5DLkNOQ25DjkOuQ85D7kMORC5ETkRuRI5ErkTORO5EDkUuRU5FbkWO
Ra5FzkXuRQ5GLkZORm5GjkauRs5G7kYORy5HTkduR45HrkfOR+4HBwAXACcA
NwBHAFcAZwB3AIcAlwCnALcAxwDXAOcA9wAHARcBJwE3AUcBVwFnAXcBhwGX
AacBtwHHAdcB5wH3AQcCFwInAjcCRwJXAmcCdwKHApcCpwK3AscC1wLnAvcC
BwMXAycDNwNHA1cDZwN3A4cDlwOnA7cDxwPXA+cD9wMHBBcEJwQ3BEcEVwRn
BHcEhwSXBKcEtwTHBNcE5wT3BAcFFwUnBTcFRwVXBWcFdwWHBZcFpwW3BccF
1wXnBfcFBwYXBicGNwZHBlcGZwZ3BocGlwanBrcGxwbXBucG9wYHBxcHJwc3
B0cHVwdnB3cHhweXB6cHtwfHB9cH5wf3xx4Ae4H/7Qn+f2+APQL2CtgzYO+A
PQT2EthTYG+BPQb2GthzYO+BPQj2ItiTYG+CPQr2KtizYO+CPQz2Mv8Ho/tc
Pg==
   "], Im],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->961283215,ExpressionUUID->"e29dc353-6a47-434f-98c6-c02c6e75f569"]
}, Open  ]],

Cell["Let us evaluate the QSP polynomial at the Chebyshev points.", \
"ExampleText",
 CellID->789353421,ExpressionUUID->"45d9267d-a8b7-4692-b0b7-0cc2ad783502"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xx", "=", 
   RowBox[{"ChebyshevPoints", "[", 
    RowBox[{"{", 
     RowBox[{"$n", ",", "$parity"}], "}"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->210476177,ExpressionUUID->"9c566411-ddae-45ef-b6c2-dcbb18526d4f"],

Cell["With the reduced phase vector, it is reasonably fast.", "ExampleText",
 CellID->1365905885,ExpressionUUID->"813f2566-a1af-408f-ad5e-67a1be27a51e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"val", "=", 
    RowBox[{"fun", "[", "xx", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->192749570,ExpressionUUID->"def92125-6019-4890-aa7c-ac1c59fdb765"],

Cell[BoxData["2.758064`"], "EchoTiming",
 CellID->767518124,ExpressionUUID->"c0756b39-2ab0-45a1-825e-48d4095c429b"]
}, Open  ]],

Cell["With the full phase vector, it takes much longer.", "ExampleText",
 CellID->988870704,ExpressionUUID->"5ee5e538-e110-4873-95b1-ba810a67daa8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{
   RowBox[{"new", "=", 
    RowBox[{"gun", "[", "xx", "]"}]}], ";"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->482833766,ExpressionUUID->"b31cfe2c-c3ee-4c12-ae96-79c04285f338"],

Cell[BoxData["8.641693`"], "EchoTiming",
 CellID->1890326186,ExpressionUUID->"dee6df28-08ec-4457-9901-057c9cda0013"]
}, Open  ]],

Cell["Nevertheless, the result must be the same.", "ExampleText",
 CellID->603496782,ExpressionUUID->"b1dba016-3deb-42e4-8825-f75ed3f5c3b1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"val", "-", "new"}], "//", "Chop"}], ",", "0"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->857850345,ExpressionUUID->"7cb14968-6efa-4fcf-b286-94ae6eef4576"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->839134384,ExpressionUUID->"27b466af-f8e9-479f-8ac7-9c21abf02a36"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QSPFind"]], "paclet:QuantumMob/Q3/ref/QSPFind", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "1744af13-67aa-4346-b869-9e9f662cf53b"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["QSPConvert"]], "paclet:QuantumMob/Q3/ref/QSPConvert", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "14914ea5-818b-40d5-8c1d-c215885ccba1"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChebyshevCoefficients"]], 
           "paclet:QuantumMob/Q3/ref/ChebyshevCoefficients", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "d1d7c2b5-1f0f-487e-81d8-5057f478ccf0"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["ChebyshevSeries"]], 
           "paclet:QuantumMob/Q3/ref/ChebyshevSeries", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "d298ea21-acc5-4e7a-809b-1e1e22eed4b5"]
       }], "SeeAlso",ExpressionUUID->"4eb879df-ec61-4680-babd-0b79c564ceec"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"be6e61c1-7824-49e0-bb87-\
7ae6df12411e"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Signal Processing",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumSignalProcessing"]], 
         "TechNotes",ExpressionUUID->
         "d0660a20-07b5-4fe6-ad02-c712df429fe7"]}]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox[
        "Quantum Linear System Problems",
         BaseStyle->"Link",
         ButtonData->
          "paclet:QuantumMob/Q3/tutorial/QuantumLinearSystemProblems"]], 
         "TechNotes",ExpressionUUID->
         "f1a24e2a-97a4-453b-b4a2-5a5ea70364ff"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "8193b97f-f531-4d13-af79-17e69948acbe"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "022d4119-0dfe-4fb2-9023-4e01241389ba"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Spin Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumSpinSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "f51fee40-eed4-4997-83ac-42851b3112bb"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"17cabb89-a54a-4138-b2ae-\
a5fec4b6b747"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Signal Processing"]], 
           "paclet:QuantumMob/Q3/guide/QuantumSignalProcessing"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "286bf641-72c2-421a-b795-7811f306e957"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "f3894768-48c3-44c3-bc65-a25df2c6e66c"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "d65bd775-0e0c-476f-aec3-c17ab493e717"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Spin Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumSpinSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "45a292e4-5a1c-46b0-b770-57f4f7e2836d"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "9e37fd34-6703-4f25-b53e-6aa739ed369e"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"8613df68-bfa8-4bd4-98a3-\
9791d259ff69"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        " ",
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "QSPPACK"}]]]], 
             "https://github.com/qsppack/QSPPACK"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "a83de05d-f3ee-4a98-aeb8-90fd8217c88d"]}]],ExpressionUUID->
         "7d6d7d59-63fa-4cfc-9d07-c18e877934ac"],
        " by Y. Dong, J. Wang, X. Meng, H. Ni and L. Lin."
       }], "RelatedLinks",ExpressionUUID->
        "57892d4f-6555-4458-80d3-535e497ce426"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Y. Dong et al. (2021)"}]]]], 
             "https://doi.org/10.1103/PhysRevA.103.042419"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "bffc2b28-9db8-44b3-9828-7c050640e1fd"]}]],ExpressionUUID->
         "77567590-d4e6-4939-ac03-a13199e057cc"],
        ", Physical Review A 103, 042419 (2021), \".Efficient phase-factor \
evaluation in quantum signal processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "69348b1c-ed54-4044-a687-b91aec2f92df"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J. Wang et al. (2022)"}]]]], 
             "https://doi.org/10.22331/q-2022-11-03-850"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "6e072b0a-33bb-4a8c-98a7-3a71935b04b6"]}]],ExpressionUUID->
         "1c600968-ae1f-4825-a282-cdaf94b24588"],
        ", Quantum 6, 850 (2022), \"On the energy landscape of symmetric \
quantum signal processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "80be9b21-c683-4f0f-b92d-a03a69ef5708"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "L. Lin (2022)"}]]]], 
             "https://arxiv.org/abs/2201.08309"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "2854253b-178e-4030-9c1e-6e6df2912ed7"]}]],ExpressionUUID->
         "154c99c3-bc44-4311-9cd4-db1963265658"],
        ", arXiv:2201.08309,  \"Lecture Notes on Quantum Algorithms for \
Scientific Computation.\""
       }], "RelatedLinks",ExpressionUUID->
        "26e0003d-c1fd-46a4-8fc8-38c9fb9a4012"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "A. Gilyen, Y. Su, G. H. Low, and N. Wiebe (2019)"}]]]], 
             "https://doi.org/10.1145/3313276.3316366"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "241e7799-6403-4b02-9b0d-28ced74d7812"]}]],ExpressionUUID->
         "efa4d2ee-3751-4430-8057-198781bacd61"],
        ", Proceedings of the 51st Annual ACM SIGACT Symposium on Theory of \
Computing, \"Quantum singular value transformation and beyond: exponential \
improvements for quantum matrix arithmetics.\""
       }], "RelatedLinks",ExpressionUUID->
        "919dfdc3-21ee-4744-9d90-5ecdfd1c940c"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "J. Haah (2019)"}]]]], 
             "https://doi.org/10.22331/q-2019-10-07-190"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "f13607a4-5d18-40a9-9bb2-05ccc4eaf373"]}]],ExpressionUUID->
         "e79e58e6-e52d-4d33-b182-b21ac1cd89d8"],
        ", Quantum 3, 190 (2019), \"Product Decomposition of Periodic \
Functions in Quantum Signal Processing.\""
       }], "RelatedLinks",ExpressionUUID->
        "85f37c2d-fe17-474e-ae14-8d93b5c06830"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "C. T. Kelley (1999)"}]]]],
              "https://doi.org/10.1137/1.9781611970920"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "32222b2d-a11e-469c-9387-36d118b361b9"]}]],ExpressionUUID->
         "10555711-f61e-4245-b92c-06355a3b9295"],
        ", Iterative Methods for Optimization (SIAM, 1999)."
       }], "RelatedLinks",ExpressionUUID->
        "88cbabf4-fbf4-48fb-9da7-454d53396fa4"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "W. Sun and Y.-X. Yuan (2006)"}]]]], 
             "https://doi.org/10.1007/b106451"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "f03afb54-762c-48fe-ae48-ffca2c0d33e9"]}]],ExpressionUUID->
         "b8119647-7c10-405a-b4d5-d3a647311f3d"],
        ", Optimization Theory and Methods (Kluwer Academic Publishers, 2006)."
       }], "RelatedLinks",ExpressionUUID->
        "a193e4ab-8c02-4408-a74c-9645d8f63626"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "806eb8dd-43d0-4bf4-9dde-b655b134a974"]}]],ExpressionUUID->
         "c5182ed6-54ff-4c99-a236-3d029a676f5b"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "c5a50add-4c95-49b1-a7fb-ae72c4b374d5"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"32d209f4-ea7b-4a0e-a52c-\
b05170efd3de"],

Cell[" ", "FooterCell",ExpressionUUID->"162a5f68-c461-4c1d-9d71-410aae057df3"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"QSP",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed, "3" -> Closed}, 
    "AllOptsTable" -> Closed, "NotesSection" -> Closed, 
    "ExampleSubsection" -> {
     "0" -> Closed, "1" -> Closed, "2" -> Closed, "3" -> Closed}}, 
  "NewStyles" -> True, "CitationPopupData" -> $Failed, "ShowCitation" -> 
  False, "HasOptions" -> True, "RootCaptions" -> "", 
  "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 10, 14, 26, 39.953816}", 
    "history" -> {"14.0", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {
     "quantum signal processing", "quantum singular value transform", 
      "quantum eigenvalue transform"}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> "QuantumMob/Q3",
     "status" -> "None", "summary" -> 
    "QSP[{\\[Phi]0, \\[Phi]1, \\[Phi]2, ..., \\[Phi]d}] represents the \
quantum signal processing of degree d with full phase vector {\\[Phi]0, \
\\[Phi]1, \\[Phi]2, ..., \\[Phi]d}. QSP[{{\\[Phi] 0, \\[Phi] 1, ...}, , \
parity}] represents the symmetric quantum signal processing associated with \
reduced phase vector {{\\[Phi] 0, \\[Phi] 1, ...}, parity}, where parity = \
\\[PlusMinus]1 for even and odd, respectively. QSP[{{\\[Phi]0, \\[Phi]1, \
...}, parity}, post] is equivalent to Composition[post, QSP[{\\[Phi]0, \
\\[Phi]1, ...}, parity}]].", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "QSP", "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "QSP", "type" -> "Symbol", "uri" -> "QuantumMob/Q3/ref/QSP"}},
CellContext->"Global`",
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"cdfec8b4-82b8-44c2-99ac-807d0dee53a6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[45869, 1403, 1441, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"39fd7cb9-ca12-444b-ad79-726bc980d779",
   CellTags->"PrimaryExamplesSection",
   CellID->743861598]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 249833, 6700}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[571, 21, 7784, 186, 70, "AnchorBarGrid",ExpressionUUID->"7a7aa697-aa27-4c36-8969-116b80f0ef21",
 CellID->1],
Cell[8358, 209, 96, 0, 70, "ContextNameCell",ExpressionUUID->"c8a55e6b-05b1-419e-94b5-cfa4fd45a732"],
Cell[CellGroupData[{
Cell[8479, 213, 1354, 37, 70, "ObjectNameGrid",ExpressionUUID->"367367cf-21e6-459f-ac0f-a6dd709ad2ec"],
Cell[9836, 252, 6110, 180, 70, "Usage",ExpressionUUID->"93a06ec9-8b9c-4f4e-805b-d5d7a82b658f",
 CellID->1887563293]
}, Open  ]],
Cell[CellGroupData[{
Cell[15983, 437, 1851, 45, 70, "NotesSection",ExpressionUUID->"c1ee34af-360d-41b9-86a5-ecfde1532ec2",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1004852458],
Cell[17837, 484, 2570, 85, 70, "Notes",ExpressionUUID->"4ad85537-52ae-4c86-9532-049572e03589",
 CellID->915826333],
Cell[20410, 571, 3840, 135, 70, "Notes",ExpressionUUID->"276353f2-48d6-40b5-ba27-9a2302b461ce",
 CellID->1931150725],
Cell[24253, 708, 4184, 144, 70, "Notes",ExpressionUUID->"fbf9d508-4cb5-4660-8f48-69bec17cbea6",
 CellID->765642393],
Cell[28440, 854, 2929, 99, 70, "Notes",ExpressionUUID->"38eef5cc-dd2d-4b98-a443-84e69e43535c",
 CellID->328467597],
Cell[31372, 955, 1755, 57, 70, "Notes",ExpressionUUID->"236ce795-deb7-4a45-b901-c7452071619d",
 CellID->740487261],
Cell[33130, 1014, 5375, 168, 70, "Notes",ExpressionUUID->"5cb8d44a-0f7c-4283-8e83-e421e7eb8942",
 CellID->958672882],
Cell[38508, 1184, 1372, 38, 70, "Notes",ExpressionUUID->"830986fb-4547-4bf0-9316-b093485ca305",
 CellID->1795688728],
Cell[39883, 1224, 1951, 57, 70, "Notes",ExpressionUUID->"11a733b4-b9a4-4f8e-b0c9-3ae8cdd0721d",
 CellID->1190343635],
Cell[41837, 1283, 3542, 104, 70, "Notes",ExpressionUUID->"b7411b4b-2212-4818-a871-5cc27fc1188b",
 CellID->1535193593],
Cell[45382, 1389, 360, 8, 70, "Notes",ExpressionUUID->"c26b381f-d7dc-4b29-bfa5-4137bfe0d2b4",
 CellID->227248759]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[45869, 1403, 1441, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"39fd7cb9-ca12-444b-ad79-726bc980d779",
 CellTags->"PrimaryExamplesSection",
 CellID->743861598],
Cell[47313, 1443, 202, 3, 70, "Input",ExpressionUUID->"3e033788-0868-4aa8-a156-4d08cb31a063",
 CellID->556413652],
Cell[CellGroupData[{
Cell[47540, 1450, 1419, 37, 70, "ExampleSection",ExpressionUUID->"98ac740d-8df8-4d8c-a3b4-c9ab3f07245f",
 CellID->1579568399],
Cell[48962, 1489, 204, 5, 70, "Input",ExpressionUUID->"230fe014-dbbb-45c2-93e1-bbf62a9a4732",
 CellID->672243474],
Cell[49169, 1496, 130, 1, 70, "ExampleText",ExpressionUUID->"a93a5d60-ce37-41b2-a7f2-812f6441958c",
 CellID->966966361],
Cell[49302, 1499, 219, 5, 70, "Input",ExpressionUUID->"6f374979-a62f-405b-bcd8-e2ab4483cf18",
 CellID->484600651],
Cell[CellGroupData[{
Cell[49546, 1508, 544, 16, 70, "Input",ExpressionUUID->"169cd958-751a-4ff4-951e-ad387f31b944",
 CellID->1425151933],
Cell[50093, 1526, 254, 5, 70, "Output",ExpressionUUID->"0b97435d-177a-4804-83b8-8119388891a0",
 CellID->931228551],
Cell[50350, 1533, 126, 2, 70, "Output",ExpressionUUID->"dd41e5ba-fbb7-4703-be42-16730b295f18",
 CellID->297437321]
}, Open  ]],
Cell[50491, 1538, 115, 1, 70, "ExampleText",ExpressionUUID->"da9206c4-b586-43fe-95ac-7339e1c59f70",
 CellID->1540884431],
Cell[CellGroupData[{
Cell[50631, 1543, 303, 8, 70, "Input",ExpressionUUID->"50037b46-f2ef-4457-8706-48653bccbe12",
 CellID->1098093014],
Cell[50937, 1553, 4501, 98, 70, "Output",ExpressionUUID->"a3f4389d-b896-4646-9c36-862866d17c6c",
 CellID->1834607478]
}, Open  ]],
Cell[55453, 1654, 114, 1, 70, "ExampleText",ExpressionUUID->"9b252bd7-f3c8-402f-b3b2-0717f4d31553",
 CellID->569269380],
Cell[CellGroupData[{
Cell[55592, 1659, 293, 8, 70, "Input",ExpressionUUID->"fdf681b4-2d14-4005-9a20-3d48fcd571ae",
 CellID->1920729624],
Cell[55888, 1669, 144, 2, 70, "Output",ExpressionUUID->"9eecd9ae-a3c4-47ee-b0c3-b3f0ed8746e7",
 CellID->677679120]
}, Open  ]],
Cell[56047, 1674, 144, 1, 70, "ExampleText",ExpressionUUID->"a8bb711f-08f3-45bb-aff4-fa9090f4549f",
 CellID->1970697472],
Cell[CellGroupData[{
Cell[56216, 1679, 216, 5, 70, "Input",ExpressionUUID->"1affa54b-cdb5-4788-9cc4-f23e33eb26ce",
 CellID->1579083477],
Cell[56435, 1686, 163, 3, 70, "Output",ExpressionUUID->"441ca5d5-82f3-4c7d-b138-ce1fd4abf55a",
 CellID->1647189799]
}, Open  ]],
Cell[56613, 1692, 173, 3, 70, "ExampleText",ExpressionUUID->"f2c3c3f0-49bf-459d-b52d-b22690333216",
 CellID->1682239748],
Cell[CellGroupData[{
Cell[56811, 1699, 294, 8, 70, "Input",ExpressionUUID->"d1574224-76d3-4385-9f55-50de38a9d20a",
 CellID->487601425],
Cell[57108, 1709, 348, 9, 70, "Output",ExpressionUUID->"2ad0b0ed-049a-4e1a-931d-1ee2c750a8bc",
 CellID->1107258316]
}, Open  ]],
Cell[57471, 1721, 189, 4, 70, "ExampleText",ExpressionUUID->"3dc79638-0eb6-4d17-9e60-ea3e887bc8b5",
 CellID->1831286845],
Cell[CellGroupData[{
Cell[57685, 1729, 392, 10, 70, "Input",ExpressionUUID->"10b49b70-8258-4243-8168-621d52685176",
 CellID->1520012391],
Cell[58080, 1741, 296, 7, 70, "Output",ExpressionUUID->"cc5928e0-39d0-40ce-adda-9f0cd9efd3d5",
 CellID->1744715757],
Cell[58379, 1750, 901, 23, 70, "Output",ExpressionUUID->"c5b333bc-efc4-4763-85bf-3bcf187ad8eb",
 CellID->1696011761]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[59429, 1781, 1323, 35, 70, "ExampleSection",ExpressionUUID->"df142de1-0aad-4c62-9f54-1ccf7f4c8254",
 CellID->1703330544],
Cell[CellGroupData[{
Cell[60777, 1820, 1333, 35, 70, "ExampleSubsection",ExpressionUUID->"51d4cade-0827-430c-b83f-ca12c0389e18",
 CellID->1625224184],
Cell[62113, 1857, 223, 5, 70, "Input",ExpressionUUID->"4bfe8b12-f139-45aa-9a33-9044f79b5a62",
 CellID->866063270],
Cell[62339, 1864, 205, 5, 70, "Input",ExpressionUUID->"cf91db09-0e25-474e-bbb4-7bf63f266258",
 CellID->1774012929],
Cell[62547, 1871, 115, 1, 70, "ExampleText",ExpressionUUID->"064bc26c-c167-4179-95e4-a2e652a405c2",
 CellID->1210812697],
Cell[CellGroupData[{
Cell[62687, 1876, 355, 9, 70, "Input",ExpressionUUID->"9f4d6ea7-9793-4a61-9d91-001e8120cdc3",
 CellID->93372207],
Cell[63045, 1887, 608, 19, 70, "Output",ExpressionUUID->"63329990-6118-4961-9758-2c404698ade1",
 CellID->1319220496],
Cell[63656, 1908, 144, 3, 70, "Output",ExpressionUUID->"e8765f41-901c-4136-999f-f6cc6e08291a",
 CellID->1517704644]
}, Open  ]],
Cell[CellGroupData[{
Cell[63837, 1916, 277, 7, 70, "Input",ExpressionUUID->"783cdb34-9e70-4a94-aa2b-0785d8bc9ee7",
 CellID->1264054559],
Cell[64117, 1925, 5045, 110, 70, "Output",ExpressionUUID->"ad98171a-ab50-4ce9-bd58-2e5c4ca2d014",
 CellID->251192642]
}, Open  ]],
Cell[69177, 2038, 125, 1, 70, "ExampleText",ExpressionUUID->"099be4dd-0751-4fc4-a71f-8f1a84aaad5b",
 CellID->645597649],
Cell[69305, 2041, 383, 11, 70, "Input",ExpressionUUID->"e0327912-eeb9-447b-af2f-d3e6145f2f44",
 CellID->1538010568],
Cell[CellGroupData[{
Cell[69713, 2056, 202, 4, 70, "Input",ExpressionUUID->"d76a246b-e9f1-4559-b576-a68a2e9b38c6",
 CellID->2098320073],
Cell[69918, 2062, 172, 4, 70, "Output",ExpressionUUID->"5c7b7123-54ba-44fc-bb42-74af74d6b139",
 CellID->1989367739]
}, Open  ]],
Cell[CellGroupData[{
Cell[70127, 2071, 273, 7, 70, "Input",ExpressionUUID->"2395a4ec-6b52-446a-b33e-67ab845785f6",
 CellID->1894606122],
Cell[70403, 2080, 5789, 175, 70, "Output",ExpressionUUID->"b70df93f-f515-444e-834e-8502f28b8ca1",
 CellID->1130689230]
}, Open  ]],
Cell[CellGroupData[{
Cell[76229, 2260, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"72465aa1-17f2-4160-be1d-f15245571f9e",
 CellID->706601561],
Cell[76474, 2267, 206, 5, 70, "Input",ExpressionUUID->"34185249-36a8-417b-8a65-88b2787a0779",
 CellID->349864653],
Cell[76683, 2274, 220, 5, 70, "Input",ExpressionUUID->"e552f10f-deee-4849-a3fb-5de0e094b1f5",
 CellID->1138088487],
Cell[CellGroupData[{
Cell[76928, 2283, 571, 17, 70, "Input",ExpressionUUID->"f366d3a8-9b0f-4769-a2c6-8891e3bc4d71",
 CellID->2147261437],
Cell[77502, 2302, 126, 2, 70, "Output",ExpressionUUID->"f5e908f5-8696-491d-92f2-23e0d95b597d",
 CellID->411096307]
}, Open  ]],
Cell[CellGroupData[{
Cell[77665, 2309, 275, 7, 70, "Input",ExpressionUUID->"f5cffbe0-c9cd-4229-abd0-e6b52955092a",
 CellID->745752491],
Cell[77943, 2318, 8161, 160, 70, "Output",ExpressionUUID->"7e4b8c56-5b37-4e71-859e-8758fc165384",
 CellID->840739350]
}, Open  ]],
Cell[86119, 2481, 306, 8, 70, "Input",ExpressionUUID->"b7e0c238-8018-4fe9-a193-5cbf17f3ca40",
 CellID->1123936882],
Cell[CellGroupData[{
Cell[86450, 2493, 342, 10, 70, "Input",ExpressionUUID->"314b044c-d345-4ecf-be12-9e36aa37b29e",
 CellID->1756899605],
Cell[86795, 2505, 116, 1, 70, "EchoTiming",ExpressionUUID->"f74ddab7-2aac-4f84-af85-1eff2771c9a7",
 CellID->2011341837]
}, Open  ]],
Cell[CellGroupData[{
Cell[86948, 2511, 305, 8, 70, "Input",ExpressionUUID->"840c8aae-04ab-44d3-b48f-bcf5d5823f89",
 CellID->1891135613],
Cell[87256, 2521, 5014, 119, 70, "Output",ExpressionUUID->"d70ff576-4f65-481e-9e2c-3a9ab9ea04fc",
 CellID->1082167032]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[92434, 2649, 1334, 35, 70, "ExampleSubsection",ExpressionUUID->"b7704e67-34dc-4204-8f90-6e53976da5c2",
 CellID->976509307],
Cell[93771, 2686, 204, 5, 70, "Input",ExpressionUUID->"b5561db8-9cf8-4d52-ae4e-a29456172662",
 CellID->404620761],
Cell[93978, 2693, 220, 5, 70, "Input",ExpressionUUID->"91b9f4db-92ba-4fc8-8556-612d44f0f30a",
 CellID->1527903725],
Cell[94201, 2700, 114, 1, 70, "ExampleText",ExpressionUUID->"73faa8f9-6c5f-4888-82aa-bc9c981a4e7c",
 CellID->645812421],
Cell[CellGroupData[{
Cell[94340, 2705, 498, 15, 70, "Input",ExpressionUUID->"91c31911-6b17-4d04-aea0-a874802cddae",
 CellID->2015938896],
Cell[94841, 2722, 254, 5, 70, "Output",ExpressionUUID->"26886725-4102-4f4e-ad53-2a65228a3049",
 CellID->942300381]
}, Open  ]],
Cell[CellGroupData[{
Cell[95132, 2732, 276, 7, 70, "Input",ExpressionUUID->"77d2cdec-a653-48a1-b043-00beb32aa1b4",
 CellID->883939583],
Cell[95411, 2741, 4572, 100, 70, "Output",ExpressionUUID->"b632a8ed-7c30-44ba-b722-bd4dcbcd8d9e",
 CellID->1698090489]
}, Open  ]],
Cell[CellGroupData[{
Cell[100020, 2846, 334, 9, 70, "Input",ExpressionUUID->"07d01525-6225-424c-b96a-7e606ae7d2a3",
 CellID->1288517488],
Cell[100357, 2857, 162, 3, 70, "Output",ExpressionUUID->"7fe0827b-0a12-4ccb-bae7-dc66cf45f2c3",
 CellID->1896663640]
}, Open  ]],
Cell[100534, 2863, 149, 1, 70, "ExampleText",ExpressionUUID->"fc579dbc-294d-423c-b6c0-0be4330b74eb",
 CellID->1991143895],
Cell[CellGroupData[{
Cell[100708, 2868, 299, 8, 70, "Input",ExpressionUUID->"1ff6b06f-58fe-4c87-81c8-8a2b0f2981cf",
 CellID->763019732],
Cell[101010, 2878, 720, 18, 70, "Output",ExpressionUUID->"a0aaa39f-197d-40f9-a275-6dc29b0c3c94",
 CellID->2126025059]
}, Open  ]],
Cell[101745, 2899, 199, 4, 70, "ExampleText",ExpressionUUID->"cd16072b-7884-4157-a95f-31718afb8b76",
 CellID->2001042392],
Cell[CellGroupData[{
Cell[101969, 2907, 1034, 30, 70, "Input",ExpressionUUID->"f4e4fdc6-0258-42d3-a7df-b55b6a927201",
 CellID->1840117499],
Cell[103006, 2939, 607, 19, 70, "Output",ExpressionUUID->"77237e2d-a1dd-4f6c-9f5a-7e1d7962a963",
 CellID->122764180],
Cell[103616, 2960, 5046, 110, 70, "Output",ExpressionUUID->"5aa3a11f-ef74-4bf1-9dae-8544f1c44ece",
 CellID->1713272140],
Cell[108665, 3072, 533, 14, 70, "Output",ExpressionUUID->"d3784cc6-e206-43fb-bc78-c9a07b36e5c7",
 CellID->1504118004]
}, Open  ]],
Cell[CellGroupData[{
Cell[109235, 3091, 218, 5, 70, "Input",ExpressionUUID->"7f4b0359-1860-4328-b766-475f3bdcbf34",
 CellID->1440956291],
Cell[109456, 3098, 182, 4, 70, "Output",ExpressionUUID->"2f3978af-1fb3-455d-a0c0-2eabcbe5fd70",
 CellID->1681284391]
}, Open  ]],
Cell[CellGroupData[{
Cell[109675, 3107, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"f48371b4-4292-4849-b14f-2da50324af5e",
 CellID->1767104397],
Cell[109921, 3114, 204, 5, 70, "Input",ExpressionUUID->"4bb74ff1-8fb2-4e3e-8ec9-8d1d572ad92f",
 CellID->24762369],
Cell[110128, 3121, 220, 5, 70, "Input",ExpressionUUID->"6214ae8e-9de2-40ab-980c-71d63a100e7a",
 CellID->1716791912],
Cell[CellGroupData[{
Cell[110373, 3130, 570, 17, 70, "Input",ExpressionUUID->"16be33eb-2117-41e3-b124-17aeb350597d",
 CellID->531383892],
Cell[110946, 3149, 126, 2, 70, "Output",ExpressionUUID->"935a3d42-c06e-4406-b476-d9b6dc1b4b14",
 CellID->756932311]
}, Open  ]],
Cell[CellGroupData[{
Cell[111109, 3156, 276, 7, 70, "Input",ExpressionUUID->"d6f16913-1965-4c49-ad11-1b29fd13c8ff",
 CellID->1736427641],
Cell[111388, 3165, 5813, 121, 70, "Output",ExpressionUUID->"86cab5d2-45c2-4a76-b8d6-54bfb4eb77aa",
 CellID->68226149]
}, Open  ]],
Cell[117216, 3289, 305, 8, 70, "Input",ExpressionUUID->"929b5480-079f-41eb-b3b3-eb237d4a47a2",
 CellID->360339012],
Cell[CellGroupData[{
Cell[117546, 3301, 362, 10, 70, "Input",ExpressionUUID->"2a7c4bbe-54f4-48da-bd21-cd429fb89b3b",
 CellID->313890144],
Cell[117911, 3313, 116, 1, 70, "EchoTiming",ExpressionUUID->"40a4673e-9fc2-4f39-8987-bb0f791ec380",
 CellID->2068102392]
}, Open  ]],
Cell[CellGroupData[{
Cell[118064, 3319, 393, 11, 70, "Input",ExpressionUUID->"af6595dc-a97c-4539-b6cb-af9964a29487",
 CellID->1745720274],
Cell[118460, 3332, 3863, 91, 70, "Output",ExpressionUUID->"f617d3cd-d139-496c-820a-bd9695937bc2",
 CellID->1574075649]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[122487, 3432, 1340, 35, 70, "ExampleSubsection",ExpressionUUID->"c8a1a714-ab22-46a3-9ee8-301b6e50b055",
 CellID->38255620],
Cell[123830, 3469, 204, 5, 70, "Input",ExpressionUUID->"761bd559-2d85-48b0-b982-5c9efadd218d",
 CellID->864594887],
Cell[124037, 3476, 220, 5, 70, "Input",ExpressionUUID->"96890b2c-fe13-450a-8837-cbe480854928",
 CellID->1371910207],
Cell[124260, 3483, 114, 1, 70, "ExampleText",ExpressionUUID->"4ac3fd49-74cd-44f2-b01c-387b2d45600f",
 CellID->162931210],
Cell[CellGroupData[{
Cell[124399, 3488, 497, 15, 70, "Input",ExpressionUUID->"fba35e4e-73b1-4adf-b3ec-4353e5a73a87",
 CellID->343196545],
Cell[124899, 3505, 254, 5, 70, "Output",ExpressionUUID->"b8f045a6-23bd-4f44-a2df-0ea7cd6d5f7b",
 CellID->638385350]
}, Open  ]],
Cell[CellGroupData[{
Cell[125190, 3515, 276, 7, 70, "Input",ExpressionUUID->"d01e59af-32e2-40c2-9792-6319f3da8236",
 CellID->918428547],
Cell[125469, 3524, 4571, 100, 70, "Output",ExpressionUUID->"d145aa33-add0-44f4-a9a3-af681091c509",
 CellID->514277038]
}, Open  ]],
Cell[CellGroupData[{
Cell[130077, 3629, 334, 9, 70, "Input",ExpressionUUID->"f92c094b-6ca5-419f-a4f5-0fe8e36dd3d6",
 CellID->1374222030],
Cell[130414, 3640, 162, 3, 70, "Output",ExpressionUUID->"3225da5d-4c26-4f5e-ab60-4770b092d87c",
 CellID->1979982138]
}, Open  ]],
Cell[130591, 3646, 192, 4, 70, "ExampleText",ExpressionUUID->"1258ec0a-b76e-42e7-882a-2b3dd2812b91",
 CellID->523581948],
Cell[130786, 3652, 296, 8, 70, "Input",ExpressionUUID->"cd130ce4-213d-481e-a51c-989f859a2600",
 CellID->1601298277],
Cell[CellGroupData[{
Cell[131107, 3664, 165, 3, 70, "Input",ExpressionUUID->"601adca7-77f1-4a2e-b171-8712d9b45837",
 CellID->450237662],
Cell[131275, 3669, 538, 14, 70, "Output",ExpressionUUID->"73c18540-e401-4491-902e-746fde78ab23",
 CellID->153199454]
}, Open  ]],
Cell[CellGroupData[{
Cell[131850, 3688, 200, 4, 70, "Input",ExpressionUUID->"eb99cc34-c665-4eaf-bcb8-a4f51fc6110d",
 CellID->30274202],
Cell[132053, 3694, 1751, 40, 70, "Output",ExpressionUUID->"32f0644a-a827-4d76-aa93-c1ca32b87052",
 CellID->2137814272]
}, Open  ]],
Cell[CellGroupData[{
Cell[133841, 3739, 347, 9, 70, "Input",ExpressionUUID->"51e7f530-2b09-49ce-986b-fd5b6dce6e31",
 CellID->429782927],
Cell[134191, 3750, 540, 14, 70, "Output",ExpressionUUID->"bee52923-6e9b-4807-93ed-40d2b470a4d5",
 CellID->695571547]
}, Open  ]],
Cell[CellGroupData[{
Cell[134768, 3769, 217, 5, 70, "Input",ExpressionUUID->"ebb1ce87-5733-44be-9fbb-a1b324856a19",
 CellID->379226317],
Cell[134988, 3776, 183, 4, 70, "Output",ExpressionUUID->"56a34644-4a08-4c34-a6ae-1ea295c72d18",
 CellID->1717499808]
}, Open  ]],
Cell[CellGroupData[{
Cell[135208, 3785, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"47cdfeb7-edec-4d96-8d7b-c05bfb09d874",
 CellID->512088563],
Cell[135453, 3792, 206, 5, 70, "Input",ExpressionUUID->"0785aa86-f8f8-44b0-803f-a6b0fe91fc01",
 CellID->1705504812],
Cell[135662, 3799, 220, 5, 70, "Input",ExpressionUUID->"7ee78d89-4dda-4c35-abdb-62a07ad35444",
 CellID->1955138775],
Cell[CellGroupData[{
Cell[135907, 3808, 571, 17, 70, "Input",ExpressionUUID->"429cba2b-9dd0-4a06-b366-09e5711fe52d",
 CellID->1370108678],
Cell[136481, 3827, 127, 2, 70, "Output",ExpressionUUID->"a5a33450-ec57-4e7b-bc33-db28d1367df8",
 CellID->1691573729]
}, Open  ]],
Cell[CellGroupData[{
Cell[136645, 3834, 275, 7, 70, "Input",ExpressionUUID->"e2ceff59-f7f3-4fcf-876d-b37b70530db0",
 CellID->42686767],
Cell[136923, 3843, 5815, 121, 70, "Output",ExpressionUUID->"73bf4283-28e3-4bc9-b17f-2b3ffceb69d3",
 CellID->1891144317]
}, Open  ]],
Cell[142753, 3967, 306, 8, 70, "Input",ExpressionUUID->"7028819e-8bcc-42f3-816f-460c43639a83",
 CellID->1963149449],
Cell[CellGroupData[{
Cell[143084, 3979, 336, 9, 70, "Input",ExpressionUUID->"4be80aff-8d65-477e-8674-243f8e2e38f9",
 CellID->714036835],
Cell[143423, 3990, 115, 1, 70, "EchoTiming",ExpressionUUID->"953c8ed6-f213-4168-aa44-2bb73efeb061",
 CellID->1704560219]
}, Open  ]],
Cell[CellGroupData[{
Cell[143575, 3996, 393, 11, 70, "Input",ExpressionUUID->"ffaf46af-e0f8-4363-9111-60e706c65bab",
 CellID->1994254140],
Cell[143971, 4009, 3852, 82, 70, "Output",ExpressionUUID->"58bc0837-54cf-41bc-ae1d-da18870211b0",
 CellID->1111749753]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed]]]],
Cell[CellGroupData[{
Cell[147987, 4100, 1340, 35, 70, "ExampleSubsection",ExpressionUUID->"21ac121a-b2f7-46b3-a0c0-ff4032ce4e4e",
 CellID->729870429],
Cell[149330, 4137, 220, 5, 70, "Input",ExpressionUUID->"878bbbf8-a054-4094-ac42-70cd33cd7d20",
 CellID->1888803347],
Cell[149553, 4144, 114, 1, 70, "ExampleText",ExpressionUUID->"024fa53c-6765-471d-bd73-4791b1630e5f",
 CellID->891018326],
Cell[CellGroupData[{
Cell[149692, 4149, 476, 14, 70, "Input",ExpressionUUID->"a8d132e3-bd39-46d4-a23e-364c94881a6a",
 CellID->1014583075],
Cell[150171, 4165, 255, 5, 70, "Output",ExpressionUUID->"e761d575-2bea-420c-9ede-766c7ed46d58",
 CellID->2070369771]
}, Open  ]],
Cell[CellGroupData[{
Cell[150463, 4175, 221, 5, 70, "Input",ExpressionUUID->"10496955-4472-4190-9e38-8759a3acc165",
 CellID->599153438],
Cell[150687, 4182, 4497, 98, 70, "Output",ExpressionUUID->"e9aaed7d-7976-401e-9236-fe1d16e6b021",
 CellID->1027208856]
}, Open  ]],
Cell[155199, 4283, 138, 1, 70, "ExampleText",ExpressionUUID->"23aaffc4-f599-48f7-919d-fd94a5b60750",
 CellID->316224040],
Cell[CellGroupData[{
Cell[155362, 4288, 294, 8, 70, "Input",ExpressionUUID->"5ccd4a0d-81fe-471c-b951-46a03702a3f3",
 CellID->2132222963],
Cell[155659, 4298, 144, 2, 70, "Output",ExpressionUUID->"cf0c1411-7b1e-4443-b8e5-f2e8f11ed64a",
 CellID->678204559]
}, Open  ]],
Cell[CellGroupData[{
Cell[155840, 4305, 297, 8, 70, "Input",ExpressionUUID->"63cce546-15c6-49fb-b355-e12781087a5e",
 CellID->818380663],
Cell[156140, 4315, 1675, 34, 70, "Output",ExpressionUUID->"3d3530f3-ef47-4837-88f0-acd50d0287d5",
 CellID->1888308484]
}, Open  ]],
Cell[CellGroupData[{
Cell[157852, 4354, 246, 6, 70, "Input",ExpressionUUID->"2cec9c62-fcd7-4433-ae92-233f87b6266d",
 CellID->580159733],
Cell[158101, 4362, 127, 2, 70, "Output",ExpressionUUID->"191109a1-cff7-463b-a455-7eb8370dc524",
 CellID->1287355222]
}, Open  ]],
Cell[158243, 4367, 253, 4, 70, "ExampleText",ExpressionUUID->"e2ef3f00-042c-4556-b626-8e3f3b09406c",
 CellID->1948001229],
Cell[CellGroupData[{
Cell[158521, 4375, 663, 18, 70, "Input",ExpressionUUID->"d62ac041-346f-4952-a38b-ea39e0c0dc2b",
 CellID->104260101],
Cell[159187, 4395, 607, 19, 70, "Output",ExpressionUUID->"d5d47d2d-25c7-4a4b-a10d-b0bbcbaadc6f",
 CellID->681472629],
Cell[159797, 4416, 3004, 89, 70, "Output",ExpressionUUID->"8101a741-288f-4499-831a-1d2558b547f8",
 CellID->980186152]
}, Open  ]],
Cell[CellGroupData[{
Cell[162838, 4510, 450, 13, 70, "Input",ExpressionUUID->"44503b37-3ffa-4e92-b308-5a6e79280ad0",
 CellID->447088284],
Cell[163291, 4525, 1462, 30, 70, "Output",ExpressionUUID->"d0c10d67-55a6-441c-9615-635a7ba6f04f",
 CellID->641600527]
}, Open  ]],
Cell[164768, 4558, 132, 1, 70, "ExampleText",ExpressionUUID->"2bf0d98e-f84d-424a-9214-01a85138d7d4",
 CellID->1592012364],
Cell[CellGroupData[{
Cell[164925, 4563, 253, 7, 70, "Input",ExpressionUUID->"06be8b29-9de4-46ae-82ec-7e01987d86d2",
 CellID->2109008775],
Cell[165181, 4572, 624, 18, 70, "Output",ExpressionUUID->"99e1cecb-5936-45ac-9d31-d3da66a37297",
 CellID->864665702]
}, Open  ]],
Cell[CellGroupData[{
Cell[165842, 4595, 241, 5, 70, "ExampleDelimiter",ExpressionUUID->"5bea972e-290c-4d73-8b38-8eeaf66ef0e5",
 CellID->16707169],
Cell[166086, 4602, 220, 5, 70, "Input",ExpressionUUID->"9babff77-61e6-4ce6-82a9-807b867cbd8d",
 CellID->1832672994],
Cell[166309, 4609, 200, 6, 70, "ExampleText",ExpressionUUID->"389aaa24-7313-4a89-8b76-494d5e2a9588",
 CellID->377061237],
Cell[CellGroupData[{
Cell[166534, 4619, 818, 25, 70, "Input",ExpressionUUID->"26ddf4ea-3768-4490-8db4-63c588b291a4",
 CellID->43967962],
Cell[167355, 4646, 126, 2, 70, "Output",ExpressionUUID->"c383db4f-9d8a-41db-a87e-cd3ba6a59ca0",
 CellID->414614265],
Cell[167484, 4650, 127, 2, 70, "Output",ExpressionUUID->"a2374cfb-15e4-4332-b22e-36a109e0f28e",
 CellID->1985000987],
Cell[167614, 4654, 242, 6, 70, "Output",ExpressionUUID->"8a29f363-80e2-4292-b736-771f488ad0a8",
 CellID->753132364]
}, Open  ]],
Cell[CellGroupData[{
Cell[167893, 4665, 275, 7, 70, "Input",ExpressionUUID->"8f67cc32-a8bb-4cfc-b371-390276bcaf5e",
 CellID->200293604],
Cell[168171, 4674, 4466, 97, 70, "Output",ExpressionUUID->"84fcf4a6-0e1e-497d-ac7f-c9638f349c42",
 CellID->627026330]
}, Open  ]],
Cell[172652, 4774, 139, 1, 70, "ExampleText",ExpressionUUID->"ff8575b8-6751-4a10-a7a5-ca9d2b023964",
 CellID->1394539877],
Cell[CellGroupData[{
Cell[172816, 4779, 293, 8, 70, "Input",ExpressionUUID->"4d903c22-c656-4fbf-b7cb-9e6feb44f057",
 CellID->395189381],
Cell[173112, 4789, 144, 2, 70, "Output",ExpressionUUID->"739a7198-91b2-498a-93d9-3807cd527fba",
 CellID->729272481]
}, Open  ]],
Cell[CellGroupData[{
Cell[173293, 4796, 297, 8, 70, "Input",ExpressionUUID->"73c7e3ae-d7aa-4d83-840a-4fdd1160e022",
 CellID->159787830],
Cell[173593, 4806, 1690, 38, 70, "Output",ExpressionUUID->"b1f3e0da-b289-4cbb-af2e-cd7619fb9246",
 CellID->1193414738]
}, Open  ]],
Cell[CellGroupData[{
Cell[175320, 4849, 247, 6, 70, "Input",ExpressionUUID->"31b7e7ed-e7d7-49cf-a736-da9dc7fd2bbc",
 CellID->1568514031],
Cell[175570, 4857, 126, 2, 70, "Output",ExpressionUUID->"125aa64e-b06d-47dd-8d18-3bf9b398b148",
 CellID->224238586]
}, Open  ]],
Cell[175711, 4862, 252, 4, 70, "ExampleText",ExpressionUUID->"80c9ec1b-fe39-47c7-9fe1-c6134620d783",
 CellID->664134417],
Cell[CellGroupData[{
Cell[175988, 4870, 721, 20, 70, "Input",ExpressionUUID->"592d83cf-2fc1-4fdd-826a-9604cf2dc61a",
 CellID->1634633060],
Cell[176712, 4892, 608, 19, 70, "Output",ExpressionUUID->"99977c3e-7f85-4829-b4b4-276b827a0bd9",
 CellID->2091598064],
Cell[177323, 4913, 16167, 420, 70, "Output",ExpressionUUID->"69e91f77-07a9-4582-a768-b74bed34e087",
 CellID->1328843905]
}, Open  ]],
Cell[CellGroupData[{
Cell[193527, 5338, 450, 13, 70, "Input",ExpressionUUID->"24a75f2e-8424-4ecd-8489-d1965b3ea2c9",
 CellID->2087253347],
Cell[193980, 5353, 1462, 34, 70, "Output",ExpressionUUID->"7e8e3a0e-e817-47b6-821e-e4e45e554fe7",
 CellID->49582535]
}, Open  ]],
Cell[195457, 5390, 132, 1, 70, "ExampleText",ExpressionUUID->"25d4be5a-19ad-454f-bd88-1d14bdebad85",
 CellID->1200015267],
Cell[CellGroupData[{
Cell[195614, 5395, 253, 7, 70, "Input",ExpressionUUID->"9ccf8beb-b807-4581-8b06-2be62067ed13",
 CellID->1637663492],
Cell[195870, 5404, 624, 18, 70, "Output",ExpressionUUID->"ed45ce88-5f9b-4a9e-9af6-0d5c708f4fce",
 CellID->110010709]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196543, 5428, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"23c5f7dc-187a-4765-8775-2fa530cc7f0a",
 CellID->486630493],
Cell[196788, 5435, 220, 5, 70, "Input",ExpressionUUID->"de83b062-fabe-44ac-af76-fc1cd5f4b032",
 CellID->1180968075],
Cell[197011, 5442, 201, 6, 70, "ExampleText",ExpressionUUID->"88fbf5c8-f9f3-464a-9741-8bbf9b13f357",
 CellID->1486570951],
Cell[CellGroupData[{
Cell[197237, 5452, 846, 26, 70, "Input",ExpressionUUID->"4a1a9aa5-255a-42f4-a4d3-67ebaeb27a29",
 CellID->973224259],
Cell[198086, 5480, 127, 2, 70, "Output",ExpressionUUID->"9698c83b-ac7a-4199-be4c-b55ee50392eb",
 CellID->2114049743],
Cell[198216, 5484, 127, 2, 70, "Output",ExpressionUUID->"8eca6526-04e0-4506-9492-69816995ccc9",
 CellID->717090986]
}, Open  ]],
Cell[CellGroupData[{
Cell[198380, 5491, 276, 7, 70, "Input",ExpressionUUID->"8565f017-0767-47f1-b44f-7e610654d779",
 CellID->1678153624],
Cell[198659, 5500, 5446, 113, 70, "Output",ExpressionUUID->"40e6acec-b545-4feb-883e-f510b86a8d6d",
 CellID->469974738]
}, Open  ]],
Cell[204120, 5616, 139, 1, 70, "ExampleText",ExpressionUUID->"bdca29e7-b60f-4724-aac8-2b0e0f108151",
 CellID->1858429471],
Cell[204262, 5619, 306, 8, 70, "Input",ExpressionUUID->"df07d200-60d9-4491-8c67-a411b2ff61d6",
 CellID->1621957129],
Cell[CellGroupData[{
Cell[204593, 5631, 361, 10, 70, "Input",ExpressionUUID->"ea989692-d525-4aa3-9446-e64f141f071c",
 CellID->454622630],
Cell[204957, 5643, 115, 1, 70, "EchoTiming",ExpressionUUID->"7adfb2d4-85f1-49f7-8cb5-64a13bcebab1",
 CellID->420567900]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "3"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[205348, 5656, 1329, 35, 70, "ExampleSection",ExpressionUUID->"f751b05b-4caa-4038-bb75-fd9e5fbd552b",
 CellID->701469844],
Cell[206680, 5693, 249, 4, 70, "ExampleText",ExpressionUUID->"a750081c-4157-466e-bc8a-b0251270fa76",
 CellID->411726774],
Cell[206932, 5699, 219, 5, 70, "Input",ExpressionUUID->"129b18d1-402b-4fcf-a7bd-c0e8b420d3fe",
 CellID->271315786],
Cell[CellGroupData[{
Cell[207176, 5708, 480, 13, 70, "Input",ExpressionUUID->"d0f4003d-e115-4fe9-9d24-b6decdc991de",
 CellID->1529848425],
Cell[207659, 5723, 129, 2, 70, "Output",ExpressionUUID->"0f4219ca-e8c4-46c3-89ae-9385bef524f9",
 CellID->1116013023],
Cell[207791, 5727, 143, 3, 70, "Output",ExpressionUUID->"70b43bbd-62f0-4e69-8973-25f819479d58",
 CellID->708704663]
}, Open  ]],
Cell[207949, 5733, 144, 1, 70, "ExampleText",ExpressionUUID->"d622910f-a40b-46d3-b6f7-df079600ce02",
 CellID->263062639],
Cell[CellGroupData[{
Cell[208118, 5738, 822, 25, 70, "Input",ExpressionUUID->"b04088fb-c273-4105-b395-e3acb5eac3e7",
 CellID->252225698],
Cell[208943, 5765, 127, 2, 70, "Output",ExpressionUUID->"a4518156-6f56-4d0b-8b43-134b126975eb",
 CellID->487988694],
Cell[209073, 5769, 9362, 178, 70, "Output",ExpressionUUID->"d21bfa47-08d8-477c-a691-2192bb992fd2",
 CellID->385932165]
}, Open  ]],
Cell[218450, 5950, 177, 3, 70, "ExampleText",ExpressionUUID->"918ab2ba-6d03-4ebf-baef-4cbcdf156990",
 CellID->783735018],
Cell[CellGroupData[{
Cell[218652, 5957, 302, 7, 70, "Input",ExpressionUUID->"579d8704-8d44-4fec-897a-3035c09864be",
 CellID->553874063],
Cell[218957, 5966, 10600, 199, 70, "Output",ExpressionUUID->"e29dc353-6a47-434f-98c6-c02c6e75f569",
 CellID->961283215]
}, Open  ]],
Cell[229572, 6168, 159, 2, 70, "ExampleText",ExpressionUUID->"45d9267d-a8b7-4692-b0b7-0cc2ad783502",
 CellID->789353421],
Cell[229734, 6172, 305, 8, 70, "Input",ExpressionUUID->"9c566411-ddae-45ef-b6c2-dcbb18526d4f",
 CellID->210476177],
Cell[230042, 6182, 152, 1, 70, "ExampleText",ExpressionUUID->"813f2566-a1af-408f-ad5e-67a1be27a51e",
 CellID->1365905885],
Cell[CellGroupData[{
Cell[230219, 6187, 276, 7, 70, "Input",ExpressionUUID->"def92125-6019-4890-aa7c-ac1c59fdb765",
 CellID->192749570],
Cell[230498, 6196, 115, 1, 70, "EchoTiming",ExpressionUUID->"c0756b39-2ab0-45a1-825e-48d4095c429b",
 CellID->767518124]
}, Open  ]],
Cell[230628, 6200, 147, 1, 70, "ExampleText",ExpressionUUID->"5ee5e538-e110-4873-95b1-ba810a67daa8",
 CellID->988870704],
Cell[CellGroupData[{
Cell[230800, 6205, 276, 7, 70, "Input",ExpressionUUID->"b31cfe2c-c3ee-4c12-ae96-79c04285f338",
 CellID->482833766],
Cell[231079, 6214, 116, 1, 70, "EchoTiming",ExpressionUUID->"dee6df28-08ec-4457-9901-057c9cda0013",
 CellID->1890326186]
}, Open  ]],
Cell[231210, 6218, 140, 1, 70, "ExampleText",ExpressionUUID->"b1dba016-3deb-42e4-8825-f75ed3f5c3b1",
 CellID->603496782],
Cell[CellGroupData[{
Cell[231375, 6223, 280, 7, 70, "Input",ExpressionUUID->"7cb14968-6efa-4fcf-b286-94ae6eef4576",
 CellID->857850345],
Cell[231658, 6232, 143, 3, 70, "Output",ExpressionUUID->"27b466af-f8e9-479f-8ac7-9c21abf02a36",
 CellID->839134384]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "3"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[232043, 6244, 2487, 66, 70, "SeeAlsoSection",ExpressionUUID->"be6e61c1-7824-49e0-bb87-7ae6df12411e"],
Cell[234533, 6312, 2211, 56, 70, "TechNotesSection",ExpressionUUID->"17cabb89-a54a-4138-b2ae-a5fec4b6b747"],
Cell[236747, 6370, 2223, 55, 70, "MoreAboutSection",ExpressionUUID->"8613df68-bfa8-4bd4-98a3-9791d259ff69"],
Cell[238973, 6427, 8163, 213, 70, "RelatedLinksSection",ExpressionUUID->"32d209f4-ea7b-4a0e-a52c-b05170efd3de"],
Cell[247139, 6642, 78, 0, 70, "FooterCell",ExpressionUUID->"162a5f68-c461-4c1d-9d71-410aae057df3"]
}
]
*)

(* End of internal cache information *)
