(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     54984,       1349]
NotebookOptionsPosition[     47675,       1201]
NotebookOutlinePosition[     50006,       1259]
CellTagsIndexPosition[     49920,       1254]
WindowTitle->BravyiInner
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "9493992e-b6b2-4d3f-8132-00e68091b1e1"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "9329dfc7-1b89-4609-b39e-4b8cef284479"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "0288ccfb-39a8-4135-ad25-1e05a78f4c17"]
         }],ExpressionUUID->"3b67a27e-2a94-460f-9c8d-0552feb71bc0"],
         StripOnInput->False],{
        StyleBox["\"BravyiState\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/BravyiState"], 
         StyleBox[
          "\"BravyiCovariance\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/BravyiCovariance"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "830afdbc-954a-4cea-86a5-02e1f94b0081"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "8854ff1b-07b6-477c-9617-d23898f74363"]
         }],ExpressionUUID->"598cf356-2f43-432e-ab9c-ad9c5913a95f"],
         StripOnInput->False],{
        "\"Fermionic Quantum Computation\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/FermionicQuantumComputation"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "317fe67b-f493-4169-9b5f-acd55c3632fe"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "4e89e4a9-2088-4b86-a34b-1e1805e1af9e"]
         }],ExpressionUUID->"a04eeb2c-2f62-4b0f-9399-78ed648f8d9a"],
         StripOnInput->False],{
        "\"Majorana Fermions\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/MajoranaFermions"], 
         "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "7dbfdc92-c83b-4240-ad9f-5a58644cc457"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "1f250e76-33de-4407-ae7f-a567cfc86652"]
         }],ExpressionUUID->"de2da6e4-83b9-4418-8437-055bdff8e504"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/BravyiInner\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/BravyiInner"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
BravyiInner.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/BravyiInner") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "22f7dc95-f2f0-4654-9064-a22789a203ea"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "d273c91b-caae-4441-9224-273ccc7940b2"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"cafd7b66-d89d-479d-bd7e-0c5d735eb21a"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"3f8d608e-9033-4869-a3bb-42e6348af139"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "BravyiInner", "ObjectName",ExpressionUUID->
      "6591b8bd-4479-4f5f-995e-adce7e28889e"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"acb91ae0-d849-4f07-99e8-5a8233a36ed6"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "1a9c953b-b2bc-4b47-ad01-8f78cff6f6ef"]
    }],ExpressionUUID->"32cf1341-38b4-4f83-9d94-51ec98594177"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.3\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->LightDarkSwitched[
              RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "56ceeb44-b5fc-470f-b224-d42b235962a0"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"d7f610d1-8a81-47dd-903f-2dca4022eea4"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["BravyiInner"]], "paclet:QuantumMobQ3/ref/BravyiInner", 
         "QuantumMobQ3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        StyleBox["a", "TI"], ",", 
        StyleBox["b", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "d95fc668-c1b5-4614-8094-bc4dc4ad1d20"],
     "\[LineSeparator]returns the ",
     ButtonBox["Hilbert-Schmidt product",
      BaseStyle->"Link",
      ButtonData->"paclet:QuantumMob/Q3/ref/HilbertSchmidtProduct"],
     " ",
     Cell[BoxData[
      FormBox[
       RowBox[{"Tr", "[", 
        RowBox[{
         SuperscriptBox["\[Rho]", "\[Dagger]"], "\[Sigma]"}], "]"}], 
       TraditionalForm]],ExpressionUUID->
      "792159e4-432d-4065-873e-92497fba601f"],
     " of two density matrices \[Rho] and \[Sigma] corresponding to the two ",
     
     ButtonBox["Bravyi states",
      BaseStyle->"Link",
      ButtonData->"paclet:QuantumMob/Q3/ref/BravyiState"],
     " ",
     Cell[BoxData[
      StyleBox["a", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "3e439f95-0b00-4d12-b03c-a81d66211f7b"],
     " and ",
     Cell[BoxData[
      StyleBox["b", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "60df6ce8-0f3d-4a8d-bebe-4a08afbe63d1"],
     "."
    }],ExpressionUUID->"49570125-4ecd-4284-890f-055686dbf455"]}
  }]], "Usage",
 CellID->1089404695,ExpressionUUID->"69409ca4-ba6b-4779-97fc-7ebac82b35f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[CurrentValue[
         EvaluationCell[], "CellGroupOpen"] =!= Closed, 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"d94dc178-ad6c-41fa-a1d4-9dad83ca7141"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"94017235-2ef0-4ac3-87a7-b60dff037873"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"de7a1c3d-0d74-454a-86ee-dcfd50d48f72"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"ae5cbfda-01e4-4e4c-876d-9d1acee9a536"]], \
"NotesSection",
 ShowGroupOpener->"Thumbnail",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->639911246,ExpressionUUID->"4ecdf450-71db-4ab3-905f-55dd4f9f41db"],

Cell[TextData[{
 "For two Bravyi states \[Rho] and \[Sigma] characterized by Majorana \
covariance matrices ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Rho]"], TraditionalForm]],ExpressionUUID->
  "e23d5e8b-754e-4ac5-be41-01a8f6d4dbb1"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Sigma]"], TraditionalForm]],ExpressionUUID->
  "1842ffdd-318a-4981-89b8-89d3dd9b5a56"],
 ", the Hilbert-Schmidt product of \[Rho] and \[Sigma] is given by\
\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[Rho]", ",", "\[Sigma]"}], "\[RightAngleBracket]"}], "HS"], ":=", 
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{
       SuperscriptBox["\[Rho]", "\[Dagger]"], "\[Sigma]"}], "]"}], "=", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox["2", "n"]], 
      RowBox[{"det", "(", 
       RowBox[{"I", "-", 
        RowBox[{
         SubscriptBox["V", "\[Rho]"], 
         SubscriptBox["V", "\[Sigma]"]}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"4ce238fa-aeb6-4a57-a8bc-672414c7eee4"],
 " ,\[LineSeparator]where ",
 Cell[BoxData[
  StyleBox["n", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "2e23e60d-8573-4295-9d61-38d7967ba26a"],
 " is the number of fermion modes (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Rho]"], TraditionalForm]],ExpressionUUID->
  "5763b273-aba6-4ff7-af1b-2565c18663e8"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Sigma]"], TraditionalForm]],ExpressionUUID->
  "37e83b0d-a5f1-4003-94e4-e7331b170d0d"],
 " are ",
 Cell[BoxData[
  RowBox[{"2", 
   StyleBox["n", "TI"], "\[Times]", "2", 
   StyleBox["n", "TI"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "685ffe01-40bd-41aa-841f-e2ab02155059"],
 " real anti-symmetric matices)."
}], "Notes",
 CellID->179134543,ExpressionUUID->"543f7e94-d76d-4807-b075-f47b33e2c2fa"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"9e142f2c-0c0a-42ef-8f23-6e65ddfa2e23"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"ed1a1f38-a65b-47a0-b9b6-a01e041b0ba2"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "be48427f-4d8f-470f-b8c4-d2b22e69f19c"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->390207346,ExpressionUUID->"3e0658fa-d5e0-40bc-a46c-0432effccd2b"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1631457739,ExpressionUUID->"52c34aff-b630-49a9-a780-92b28bbd7eaf"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"8abeb78d-08a6-4abd-b086-0022a835d750"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"b51b9ea2-d16f-46b4-85a7-170e4f98e529"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "cff8b2e9-59bd-4865-af35-5735439c4156"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1947289931,ExpressionUUID->"0f0c4d72-0946-41f7-a85b-f8409375fdb6"],

Cell["Set the number of fermion modes:", "ExampleText",
 CellID->1222081640,ExpressionUUID->"c5010ff3-5ae6-4f56-bed1-4aa37ccee0ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->82314745,ExpressionUUID->"e9a788bb-6639-4656-ac28-00af23f0e882"],

Cell["Consider two (mixed) Bravyi states:", "ExampleText",
 CellID->984257038,ExpressionUUID->"679e6506-6d05-41fb-85f5-9775f289136f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"grn", "[", "1", "]"}], "=", 
   RowBox[{"RandomNambuGreen", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ws", "[", "1", "]"}], "=", 
  RowBox[{"BravyiState", "[", 
   RowBox[{"grn", "@", "1"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1195271820,ExpressionUUID->"eb5a0ee9-fae4-44cf-ae7a-fe8b6628a18e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BravyiState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Covariance matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0", 
                    RowBox[{"-", "0.1681234183704616`"}], 
                    RowBox[{"-", "0.28844265376109257`"}], 
                    RowBox[{"-", "0.5014699832929441`"}], 
                    "\"\[Ellipsis]\""}, {
                    "0.1681234183704616`", "0", "0.09712328468933117`", 
                    RowBox[{"-", "0.33360769343261354`"}], 
                    "\"\[Ellipsis]\""}, {"0.28844265376109257`", 
                    RowBox[{"-", "0.09712328468933117`"}], "0", 
                    "0.2118866139636525`", "\"\[Ellipsis]\""}, {
                    "0.5014699832929441`", "0.33360769343261354`", 
                    RowBox[{"-", "0.2118866139636525`"}], "0", 
                    "\"\[Ellipsis]\""}, {
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", 
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\""}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {5, 5}, 0, {
                    1, {{0, 4, 8, 12, 16, 21}, {{2}, {3}, {4}, {5}, {1}, {
                    3}, {4}, {5}, {1}, {2}, {4}, {5}, {1}, {2}, {3}, {5}, {
                    1}, {2}, {3}, {4}, {
                    5}}}, {-0.1681234183704616, -0.28844265376109257`, \
-0.5014699832929441, "\[Ellipsis]", 0.1681234183704616, 
                    0.09712328468933117, -0.33360769343261354`, "\[Ellipsis]",
                     0.28844265376109257`, -0.09712328468933117, 
                    0.2118866139636525, "\[Ellipsis]", 0.5014699832929441, 
                    0.33360769343261354`, -0.2118866139636525, "\[Ellipsis]", 
                    "\[Ellipsis]", "\[Ellipsis]", "\[Ellipsis]", 
                    "\[Ellipsis]", "\[Ellipsis]"}}], TableHeadings -> 
                    None, {}]]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`BravyiState[{
   1, SparseArray[
    Automatic, {6, 6}, 0., {
     1, {{0, 6, 12, 18, 24, 30, 36}, {{1}, {2}, {3}, {4}, {5}, {6}, {2}, {
       1}, {3}, {4}, {5}, {6}, {3}, {1}, {2}, {4}, {5}, {6}, {4}, {1}, {2}, {
       3}, {5}, {6}, {5}, {1}, {2}, {3}, {4}, {6}, {6}, {1}, {2}, {3}, {4}, {
       5}}}, {0., -0.1681234183704616, -0.28844265376109257`, \
-0.5014699832929441, 0.22512337895847673`, 0.05478818651620404, 0., 
      0.1681234183704616, 0.09712328468933117, -0.33360769343261354`, 
      0.024047859828538742`, -0.11563571050854161`, 0., 
      0.28844265376109257`, -0.09712328468933117, 0.2118866139636525, 
      0.11621009376833266`, -0.34323472194326166`, 0., 0.5014699832929441, 
      0.33360769343261354`, -0.2118866139636525, 
      0.00746788241984684, -0.36478369656470633`, 
      0., -0.22512337895847673`, -0.024047859828538742`, \
-0.11621009376833266`, -0.00746788241984684, -0.3736149489799393, 
      0., -0.05478818651620404, 0.11563571050854161`, 0.34323472194326166`, 
      0.36478369656470633`, 0.3736149489799393}}]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[2]=",
 CellID->1148452586,ExpressionUUID->"6d8a7311-71d7-4027-94ee-031de83e10e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"grn", "[", "2", "]"}], "=", 
   RowBox[{"RandomNambuGreen", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ws", "[", "2", "]"}], "=", 
  RowBox[{"BravyiState", "[", 
   RowBox[{"grn", "@", "2"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1792054258,ExpressionUUID->"3d632ada-0128-482a-9a9c-23e776d5ae01"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BravyiState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Covariance matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0", "0.16717148991480177`", 
                    RowBox[{"-", "0.01381626377992675`"}], 
                    "0.42765829912097114`", "\"\[Ellipsis]\""}, {
                    RowBox[{"-", "0.16717148991480177`"}], "0", 
                    RowBox[{"-", "0.03797322285623286`"}], 
                    "0.1075545315974563`", "\"\[Ellipsis]\""}, {
                    "0.01381626377992675`", "0.03797322285623286`", "0", 
                    "0.6458874816443607`", "\"\[Ellipsis]\""}, {
                    RowBox[{"-", "0.42765829912097114`"}], 
                    RowBox[{"-", "0.1075545315974563`"}], 
                    RowBox[{"-", "0.6458874816443607`"}], "0", 
                    "\"\[Ellipsis]\""}, {
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", 
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\""}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {5, 5}, 0, {
                    1, {{0, 4, 8, 12, 16, 21}, {{2}, {3}, {4}, {5}, {1}, {
                    3}, {4}, {5}, {1}, {2}, {4}, {5}, {1}, {2}, {3}, {5}, {
                    1}, {2}, {3}, {4}, {5}}}, {
                    0.16717148991480177`, -0.01381626377992675, 
                    0.42765829912097114`, 
                    "\[Ellipsis]", -0.16717148991480177`, \
-0.03797322285623286, 0.1075545315974563, "\[Ellipsis]", 0.01381626377992675, 
                    0.03797322285623286, 0.6458874816443607, 
                    
                    "\[Ellipsis]", -0.42765829912097114`, \
-0.1075545315974563, -0.6458874816443607, "\[Ellipsis]", "\[Ellipsis]", 
                    "\[Ellipsis]", "\[Ellipsis]", "\[Ellipsis]", 
                    "\[Ellipsis]"}}], TableHeadings -> None, {}]]], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`BravyiState[{
   1, SparseArray[
    Automatic, {6, 6}, 0., {
     1, {{0, 6, 12, 18, 24, 30, 36}, {{1}, {2}, {3}, {4}, {5}, {6}, {2}, {
       1}, {3}, {4}, {5}, {6}, {3}, {1}, {2}, {4}, {5}, {6}, {4}, {1}, {2}, {
       3}, {5}, {6}, {5}, {1}, {2}, {3}, {4}, {6}, {6}, {1}, {2}, {3}, {4}, {
       5}}}, {0., 0.16717148991480177`, -0.01381626377992675, 
      0.42765829912097114`, 0.47561174755309965`, 0.32930563586629835`, 
      0., -0.16717148991480177`, -0.03797322285623286, 0.1075545315974563, 
      0.4069113256549318, -0.5283521831835688, 0., 0.01381626377992675, 
      0.03797322285623286, 
      0.6458874816443607, -0.21439289491866492`, -0.3422311889708965, 
      0., -0.42765829912097114`, -0.1075545315974563, -0.6458874816443607, \
-0.1868123755885341, -0.0653119478059294, 
      0., -0.47561174755309965`, -0.40691132565493193`, 0.21439289491866492`, 
      0.1868123755885341, 0.36758688061519473`, 0., -0.32930563586629835`, 
      0.5283521831835688, 0.3422311889708964, 
      0.0653119478059294, -0.36758688061519473`}}]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->616515045,ExpressionUUID->"af215cf9-8e83-413f-abce-385dd2685730"]
}, Open  ]],

Cell["Note that the above two are mixed states:", "ExampleText",
 CellID->1501733819,ExpressionUUID->"f5011ef4-3a75-406d-bf39-21c5e7355d48"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"BravyiPureQ", "[", 
  RowBox[{"ws", "@", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"BravyiPureQ", "[", 
  RowBox[{"ws", "@", "2"}], "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->808065030,ExpressionUUID->"c0823599-5785-405e-8884-493ba50553d9"],

Cell[BoxData["False"], "Output",
 CellLabel->"Out[4]=",
 CellID->13755203,ExpressionUUID->"444b452a-6503-42fe-8be9-b39d2b329611"],

Cell[BoxData["False"], "Output",
 CellLabel->"Out[4]=",
 CellID->1402946592,ExpressionUUID->"59e85529-f879-4e6d-b19b-fabb5131505b"]
}, Open  ]],

Cell["Calculate the Hilbert-Schmidt product:", "ExampleText",
 CellID->487251552,ExpressionUUID->"ea5f8051-85a2-421f-a9b1-f30751501a33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"val", "=", 
  RowBox[{"BravyiInner", "[", 
   RowBox[{
    RowBox[{"ws", "@", "1"}], ",", 
    RowBox[{"ws", "@", "2"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1184804050,ExpressionUUID->"0ba041bf-e2da-46a1-a3e4-9770826a16c7"],

Cell[BoxData["0.1550501219753268`"], "Output",
 CellLabel->"Out[5]=",
 CellID->1210988730,ExpressionUUID->"0e41eadb-84eb-43d9-ae07-cbfe714c989a"]
}, Open  ]],

Cell["\<\
To verify the above result by using the conventional method, get the density \
matrices of the two Bravyi states:\
\>", "ExampleText",
 CellID->22552757,ExpressionUUID->"c67e7024-56bb-4348-93ad-ec6fb1d641f0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rho", "[", "1", "]"}], "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"ws", "@", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "[", "1", "]"}], "//", "ArrayShort"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rho", "[", "2", "]"}], "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"ws", "@", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "[", "2", "]"}], "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->855304665,ExpressionUUID->"2e209c0b-3598-4c1b-9737-ad9178b91b9c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.2611344616346113`", "0", "0", 
      RowBox[{"0.04382564613016308`", "\[VeryThinSpace]", "-", 
       RowBox[{
       "0.1151474510240738`", " ", "\[ImaginaryI]"}]}], "\<\"\[Ellipsis]\"\>"},
     {"0", "0.12429585354300526`", 
      RowBox[{"0.011182489424142251`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0457280793002795`", " ", "\[ImaginaryI]"}]}], 
      "0", "\<\"\[Ellipsis]\"\>"},
     {"0", 
      RowBox[{"0.011182489424142268`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.045728079300279494`", " ", "\[ImaginaryI]"}]}], 
      "0.21386517704104424`", "0", "\<\"\[Ellipsis]\"\>"},
     {
      RowBox[{"0.04382564613016309`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11514745102407388`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0.15143949942781157`", "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1483034926,ExpressionUUID->"942ca853-b962-4bc0-82bf-e88ac95fd294"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.056958217059162895`", "0", "0", 
      RowBox[{"0.05812058727303607`", "\[VeryThinSpace]", "+", 
       RowBox[{
       "0.04650427154142452`", " ", 
        "\[ImaginaryI]"}]}], "\<\"\[Ellipsis]\"\>"},
     {"0", "0.022923004210357294`", 
      RowBox[{
       RowBox[{"-", "0.011353905075060046`"}], "-", 
       RowBox[{"0.013705863201304909`", " ", "\[ImaginaryI]"}]}], 
      "0", "\<\"\[Ellipsis]\"\>"},
     {"0", 
      RowBox[{
       RowBox[{"-", "0.011353905075059945`"}], "+", 
       RowBox[{"0.013705863201304938`", " ", "\[ImaginaryI]"}]}], 
      "0.08169631462299644`", "0", "\<\"\[Ellipsis]\"\>"},
     {
      RowBox[{"0.058120587273036095`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04650427154142462`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0.12459331454699721`", "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1672794200,ExpressionUUID->"6cd0992d-c4c4-4dbf-a3b6-194548fd5be9"]
}, Open  ]],

Cell["\<\
Calculate the Hilbert-Schmidt product in the conventional way:\
\>", "ExampleText",
 CellID->290529546,ExpressionUUID->"a5c2303e-f774-41cf-b56c-6b4b50241d5f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alt", "=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"rho", "[", "1", "]"}], ".", 
     RowBox[{"rho", "[", "2", "]"}]}], "]"}], "//", "Chop"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->186223897,ExpressionUUID->"a38f2067-cea9-4432-8a33-6c040607ba2e"],

Cell[BoxData["0.15505012197532683`"], "Output",
 CellLabel->"Out[7]=",
 CellID->834535053,ExpressionUUID->"c257448f-30c0-4897-8110-6a26ca4fa761"]
}, Open  ]],

Cell["Verify the above result:", "ExampleText",
 CellID->814937214,ExpressionUUID->"923a7674-d2e9-4812-b33f-92b33616cbb8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"val", "-", "alt"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2147182951,ExpressionUUID->"95b83b57-913c-4cda-a47f-ed9e2f0fd560"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[8]=",
 CellID->629960033,ExpressionUUID->"a8958156-585d-4bfe-ba5e-24e065d2995f"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BravyiState"]], "paclet:QuantumMob/Q3/ref/BravyiState", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "96b7ada1-236d-428b-9dd5-d77e334e50c1"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BravyiCovariance"]], 
           "paclet:QuantumMob/Q3/ref/BravyiCovariance", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "c68d760f-e2a6-4f48-a36b-4b31778f9828"]
       }], "SeeAlso",ExpressionUUID->"d8e32989-da91-4327-a47f-0d40d2f277b9"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"cc8491f4-43cf-4332-8afc-\
286b61730cba"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Majorana Fermions"]], 
           "paclet:QuantumMob/Q3/tutorial/MajoranaFermions"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "e9a53734-4d78-4ef0-a6e7-576c69783d2f"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "325a123f-47ae-460d-abda-88f98227df46"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "02cedba6-520d-477e-817d-e1ad55918b19"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], 
           "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "85f56594-e0d3-43c8-be60-49023ae82f24"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"67637f5e-96e1-459d-9e4e-\
8f5fa0009e3c"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Fermionic Quantum Computation"]], 
           "paclet:QuantumMob/Q3/guide/FermionicQuantumComputation"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "d97d88e3-5769-42f5-9fe0-6b34db46dd50"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "5a55d023-30d9-41a4-81f5-3cdf48f6aeb8"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "7a31f5ac-e19e-4fe0-9f3e-fe40b4b45edb"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "28c5d2ce-8617-4334-8e83-c891f17d57c6"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"37608b7b-bc3f-4d15-8dd1-\
71ed74937cf7"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "S. Bravyi (2005)"}]]]], 
             "https://dl.acm.org/doi/abs/10.5555/2011637.2011640"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "9976645b-81b4-4710-8ab7-17200ed33ba7"]}]],ExpressionUUID->
         "b73ee83c-3a0a-4229-a204-beb0d7dec78e"],
        ", Quantum Information & Computation 5, 216 (2005), \"Lagrangian \
representation for fermionic linear optics.\""
       }], "RelatedLinks",ExpressionUUID->
        "708c8568-2d82-47ef-969c-f5807a01c374"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "abf5c2db-d81f-42c3-8217-f865676539aa"]}]],ExpressionUUID->
         "974ed23c-e07d-4901-881d-03eb6009d834"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "3f3fa2e5-75ca-4298-8c18-8ebf96afd511"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"ea86e3ce-8656-437e-8a7c-\
cef0ead4f021"],

Cell[" ", "FooterCell",ExpressionUUID->"795c4eeb-69d4-4a86-81b8-1bc2db02f955"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"BravyiInner",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}, 
    "AllOptsTable" -> Closed, "NotesSection" -> Closed}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 10, 15, 8, 52.182331}", 
    "history" -> {"14.3", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> "QuantumMob/Q3",
     "status" -> "None", "summary" -> 
    "BravyiInner[a, b] returns the Hilbert-Schmidt product \
Tr[\\[Rho]^\\[Dagger] \\[Sigma]] of two density matrices \\[Rho] and \
\\[Sigma] corresponding to the two Bravyi states a and b.", "synonyms" -> {}, 
    "tabletags" -> {}, "title" -> "BravyiInner", "titlemodifier" -> "", 
    "metadescription" -> "", "windowtitle" -> "BravyiInner", "type" -> 
    "Symbol", "uri" -> "QuantumMob/Q3/ref/BravyiInner"}},
CellContext->"Global`",
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"72d6b392-f820-4cbe-af96-e817619472e8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[14832, 401, 1440, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"3e0658fa-d5e0-40bc-a46c-0432effccd2b",
   CellTags->"PrimaryExamplesSection",
   CellID->390207346]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 49720, 1247}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[579, 21, 7161, 175, 70, "AnchorBarGrid",ExpressionUUID->"cafd7b66-d89d-479d-bd7e-0c5d735eb21a",
 CellID->1],
Cell[7743, 198, 96, 0, 70, "ContextNameCell",ExpressionUUID->"3f8d608e-9033-4869-a3bb-42e6348af139"],
Cell[CellGroupData[{
Cell[7864, 202, 1362, 37, 70, "ObjectNameGrid",ExpressionUUID->"d7f610d1-8a81-47dd-903f-2dca4022eea4"],
Cell[9229, 241, 1644, 45, 70, "Usage",ExpressionUUID->"69409ca4-ba6b-4779-97fc-7ebac82b35f6",
 CellID->1089404695]
}, Open  ]],
Cell[CellGroupData[{
Cell[10910, 291, 1850, 45, 70, "NotesSection",ExpressionUUID->"4ecdf450-71db-4ab3-905f-55dd4f9f41db",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->639911246],
Cell[12763, 338, 1942, 57, 70, "Notes",ExpressionUUID->"543f7e94-d76d-4807-b075-f47b33e2c2fa",
 CellID->179134543]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[14832, 401, 1440, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"3e0658fa-d5e0-40bc-a46c-0432effccd2b",
 CellTags->"PrimaryExamplesSection",
 CellID->390207346],
Cell[16275, 441, 203, 3, 70, "Input",ExpressionUUID->"52c34aff-b630-49a9-a780-92b28bbd7eaf",
 CellID->1631457739],
Cell[CellGroupData[{
Cell[16503, 448, 1419, 37, 70, "ExampleSection",ExpressionUUID->"0f0c4d72-0946-41f7-a85b-f8409375fdb6",
 CellID->1947289931],
Cell[17925, 487, 131, 1, 70, "ExampleText",ExpressionUUID->"c5010ff3-5ae6-4f56-bed1-4aa37ccee0ed",
 CellID->1222081640],
Cell[18059, 490, 203, 5, 70, "Input",ExpressionUUID->"e9a788bb-6639-4656-ac28-00af23f0e882",
 CellID->82314745],
Cell[18265, 497, 133, 1, 70, "ExampleText",ExpressionUUID->"679e6506-6d05-41fb-85f5-9775f289136f",
 CellID->984257038],
Cell[CellGroupData[{
Cell[18423, 502, 425, 11, 70, "Input",ExpressionUUID->"eb5a0ee9-fae4-44cf-ae7a-fe8b6628a18e",
 CellID->1195271820],
Cell[18851, 515, 7136, 139, 70, "Output",ExpressionUUID->"6d8a7311-71d7-4027-94ee-031de83e10e9",
 CellID->1148452586]
}, Open  ]],
Cell[CellGroupData[{
Cell[26024, 659, 425, 11, 70, "Input",ExpressionUUID->"3d632ada-0128-482a-9a9c-23e776d5ae01",
 CellID->1792054258],
Cell[26452, 672, 7134, 140, 70, "Output",ExpressionUUID->"af215cf9-8e83-413f-abce-385dd2685730",
 CellID->616515045]
}, Open  ]],
Cell[33601, 815, 140, 1, 70, "ExampleText",ExpressionUUID->"f5011ef4-3a75-406d-bf39-21c5e7355d48",
 CellID->1501733819],
Cell[CellGroupData[{
Cell[33766, 820, 315, 7, 70, "Input",ExpressionUUID->"c0823599-5785-405e-8884-493ba50553d9",
 CellID->808065030],
Cell[34084, 829, 129, 2, 70, "Output",ExpressionUUID->"444b452a-6503-42fe-8be9-b39d2b329611",
 CellID->13755203],
Cell[34216, 833, 131, 2, 70, "Output",ExpressionUUID->"59e85529-f879-4e6d-b19b-fabb5131505b",
 CellID->1402946592]
}, Open  ]],
Cell[34362, 838, 136, 1, 70, "ExampleText",ExpressionUUID->"ea5f8051-85a2-421f-a9b1-f30751501a33",
 CellID->487251552],
Cell[CellGroupData[{
Cell[34523, 843, 302, 8, 70, "Input",ExpressionUUID->"0ba041bf-e2da-46a1-a3e4-9770826a16c7",
 CellID->1184804050],
Cell[34828, 853, 145, 2, 70, "Output",ExpressionUUID->"0e41eadb-84eb-43d9-ae07-cbfe714c989a",
 CellID->1210988730]
}, Open  ]],
Cell[34988, 858, 218, 4, 70, "ExampleText",ExpressionUUID->"c67e7024-56bb-4348-93ad-ec6fb1d641f0",
 CellID->22552757],
Cell[CellGroupData[{
Cell[35231, 866, 635, 17, 70, "Input",ExpressionUUID->"2e209c0b-3598-4c1b-9737-ad9178b91b9c",
 CellID->855304665],
Cell[35869, 885, 1515, 33, 70, "Output",ExpressionUUID->"942ca853-b962-4bc0-82bf-e88ac95fd294",
 CellID->1483034926],
Cell[37387, 920, 1537, 36, 70, "Output",ExpressionUUID->"6cd0992d-c4c4-4dbf-a3b6-194548fd5be9",
 CellID->1672794200]
}, Open  ]],
Cell[38939, 959, 168, 3, 70, "ExampleText",ExpressionUUID->"a5c2303e-f774-41cf-b56c-6b4b50241d5f",
 CellID->290529546],
Cell[CellGroupData[{
Cell[39132, 966, 335, 9, 70, "Input",ExpressionUUID->"a38f2067-cea9-4432-8a33-6c040607ba2e",
 CellID->186223897],
Cell[39470, 977, 145, 2, 70, "Output",ExpressionUUID->"c257448f-30c0-4897-8110-6a26ca4fa761",
 CellID->834535053]
}, Open  ]],
Cell[39630, 982, 122, 1, 70, "ExampleText",ExpressionUUID->"923a7674-d2e9-4812-b33f-92b33616cbb8",
 CellID->814937214],
Cell[CellGroupData[{
Cell[39777, 987, 217, 5, 70, "Input",ExpressionUUID->"95b83b57-913c-4cda-a47f-ed9e2f0fd560",
 CellID->2147182951],
Cell[39997, 994, 126, 2, 70, "Output",ExpressionUUID->"a8958156-585d-4bfe-ba5e-24e065d2995f",
 CellID->629960033]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[40365, 1005, 1415, 37, 70, "SeeAlsoSection",ExpressionUUID->"cc8491f4-43cf-4332-8afc-286b61730cba"],
Cell[41783, 1044, 1877, 47, 70, "TechNotesSection",ExpressionUUID->"67637f5e-96e1-459d-9e4e-8f5fa0009e3c"],
Cell[43663, 1093, 1871, 46, 70, "MoreAboutSection",ExpressionUUID->"37608b7b-bc3f-4d15-8dd1-71ed74937cf7"],
Cell[45537, 1141, 2053, 56, 70, "RelatedLinksSection",ExpressionUUID->"ea86e3ce-8656-437e-8a7c-cef0ead4f021"],
Cell[47593, 1199, 78, 0, 70, "FooterCell",ExpressionUUID->"795c4eeb-69d4-4a86-81b8-1bc2db02f955"]
}
]
*)

(* End of internal cache information *)
