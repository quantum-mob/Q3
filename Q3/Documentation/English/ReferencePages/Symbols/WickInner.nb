(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     54909,       1349]
NotebookOptionsPosition[     47611,       1201]
NotebookOutlinePosition[     49931,       1259]
CellTagsIndexPosition[     49845,       1254]
WindowTitle->WickInner
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "738ac257-4753-4a10-9918-6eed41890b65"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "53937b88-6316-48dd-9aee-cc4cd5898d60"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "bdd90e8a-9b07-4986-984d-8b9b85b0b472"]
         }],ExpressionUUID->"ff49e8ff-8ee8-4a60-bedc-90ae0bd7505c"],
         StripOnInput->False],{
        StyleBox["\"WickState\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/WickState"], 
         StyleBox[
          "\"WickCovariance\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/WickCovariance"]},
        
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "d07f58a1-5f2c-44f8-b6ad-3bc5d94e2bb6"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "d2601134-e2c7-4b31-94ee-0c795bd4e837"]
         }],ExpressionUUID->"a109674d-1151-4e9f-9276-eb91c31680a6"],
         StripOnInput->False],{
        "\"Fermionic Quantum Computation\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/FermionicQuantumComputation"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "d11d6cf3-0816-42d5-a4ce-9093ee45d392"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "4244958d-d26e-44f9-880d-a2e343a03a71"]
         }],ExpressionUUID->"69358c84-aef7-49b0-897c-a64b5533c9fe"],
         StripOnInput->False],{
        "\"Majorana Fermions\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/MajoranaFermions"], 
         "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "d8fadb26-227e-4ebe-8842-60f58cc882ea"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "3c0941cd-013d-4d44-927f-ba5d341840bb"]
         }],ExpressionUUID->"f20e6572-b6df-4277-bbae-c8e2d9fbe442"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/WickInner\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/WickInner"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
WickInner.html"], StandardForm]], "Input", TextClipboardType -> "PlainText"]},
                Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/WickInner") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "2eb1dec9-ef49-4134-905d-b1ba8ab09b5c"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "c384aa9b-9a93-451f-8f13-c2b715d73a18"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"5a78a6ca-5757-47a5-b094-b3ce0d1180d0"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"8147d949-9468-4c23-823c-1a2bb553ab6c"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "WickInner", "ObjectName",ExpressionUUID->
      "d43a16ea-119f-43b1-bf7a-b7c36760b0da"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"ad9e2b05-2374-432e-9c8f-bba7471afea0"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "8e6985e8-8ac0-4238-9a90-53cef5bdb48d"]
    }],ExpressionUUID->"4a8aac80-c8d8-47ed-9779-2e508431cc06"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.3\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->LightDarkSwitched[
              RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "a8dec4ba-cbfa-40db-9805-ddaf6ed07f69"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"10cad113-28aa-4382-aff5-60a342d07c9d"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["WickInner"]], "paclet:QuantumMobQ3/ref/WickInner", 
         "QuantumMobQ3 Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        StyleBox["a", "TI"], ",", 
        StyleBox["b", "TI"]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "a0501fa8-ec0c-40fd-92a1-7492664a5fc9"],
     "\[LineSeparator]returns the ",
     ButtonBox["Hilbert-Schmidt product",
      BaseStyle->"Link",
      ButtonData->"paclet:QuantumMob/Q3/ref/HilbertSchmidtProduct"],
     " ",
     Cell[BoxData[
      FormBox[
       RowBox[{"Tr", "[", 
        RowBox[{
         SuperscriptBox["\[Rho]", "\[Dagger]"], "\[Sigma]"}], "]"}], 
       TraditionalForm]],ExpressionUUID->
      "7d80a9fe-f772-4281-a0d1-d33c038d3204"],
     " of two density matrices \[Rho] and \[Sigma] corresponding to the two ",
     
     ButtonBox["Wick states",
      BaseStyle->"Link",
      ButtonData->"paclet:QuantumMob/Q3/ref/WickState"],
     " ",
     Cell[BoxData[
      StyleBox["a", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "36beb264-0850-45b2-81e7-924d5f3063af"],
     " and ",
     Cell[BoxData[
      StyleBox["b", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "1d69ee37-0fd0-444d-8802-b5ae185ee179"],
     "."
    }],ExpressionUUID->"90e81d1a-c289-4c0c-b1a7-8392711295b7"]}
  }]], "Usage",
 CellID->1089404695,ExpressionUUID->"0e65a69b-de7a-49ef-b4b1-6cacaa20dcb6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[CurrentValue[
         EvaluationCell[], "CellGroupOpen"] =!= Closed, 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"47185aa1-57e0-4340-90f9-3ffbc3b8cd94"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"b5d36e32-a20a-485c-b4d7-767d010af8a1"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"c79e0dc9-36f9-4f70-a4ed-8a9b1d299591"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"0b20eb6c-3cd5-4081-a065-4aa4b339d6e5"]], \
"NotesSection",
 ShowGroupOpener->"Thumbnail",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->525912184,ExpressionUUID->"105a8b4d-221f-4bdf-971d-9547bb28aa02"],

Cell[TextData[{
 "For two Wick states \[Rho] and \[Sigma] characterized by Majorana \
covariance matrices ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Rho]"], TraditionalForm]],ExpressionUUID->
  "323f5d4c-ecad-4053-a156-6ea1c51d6279"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Sigma]"], TraditionalForm]],ExpressionUUID->
  "c1c98b9e-b478-4c1e-b2dc-3409b17c5e7e"],
 ", the Hilbert-Schmidt product of \[Rho] and \[Sigma] is given by\
\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[Rho]", ",", "\[Sigma]"}], "\[RightAngleBracket]"}], "HS"], ":=", 
    RowBox[{
     RowBox[{"Tr", "[", 
      RowBox[{
       SuperscriptBox["\[Rho]", "\[Dagger]"], "\[Sigma]"}], "]"}], "=", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox["2", "n"]], 
      RowBox[{"det", "(", 
       RowBox[{"I", "-", 
        RowBox[{
         SubscriptBox["V", "\[Rho]"], 
         SubscriptBox["V", "\[Sigma]"]}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"70f4969c-795b-41f1-ba70-1718551ea25c"],
 " ,\[LineSeparator]where ",
 Cell[BoxData[
  StyleBox["n", "TI"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "1bd724f7-d374-4335-aa03-17b85051cbaa"],
 " is the number of fermion modes (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Rho]"], TraditionalForm]],ExpressionUUID->
  "1b8b7665-af28-4b23-8d69-f57a612ae238"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "\[Sigma]"], TraditionalForm]],ExpressionUUID->
  "832e9c2d-9be3-4f3f-b111-dc327b7b3744"],
 " are ",
 Cell[BoxData[
  RowBox[{"2", 
   StyleBox["n", "TI"], "\[Times]", "2", 
   StyleBox["n", "TI"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "16c2b774-7443-48d3-8feb-380074d4f0b7"],
 " real anti-symmetric matices)."
}], "Notes",
 CellID->179134543,ExpressionUUID->"2d35c181-05ef-44eb-b389-25592814d8d0"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"52d63d72-87fe-4957-bba3-071fb1c0b89b"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"3595a738-6fca-4d70-9098-60af27f72f21"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "2787f616-1d76-44c9-839b-65c2db5cc075"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->2110869083,ExpressionUUID->"c0c99680-6c8e-4e33-9d34-9771c2900fc2"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1631457739,ExpressionUUID->"a1fa098d-34ad-4c68-b163-531458af4702"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"7c757023-055e-4b51-b6eb-97c4d0a5bcc2"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"3a62a0ac-91e7-4263-9ea8-18f0e93fdd4d"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "1c4992fe-8a92-4b06-a929-a0d37520b910"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->946829541,ExpressionUUID->"ae8fd80e-b3fb-4ba7-b21c-d3f92a7c3591"],

Cell["Set the number of fermion modes:", "ExampleText",
 CellID->1222081640,ExpressionUUID->"7b82d027-40e3-48ee-ac72-45808513663a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->82314745,ExpressionUUID->"b090b2d6-5cc3-419b-aaac-b6989a526fa7"],

Cell["Consider two (mixed) Wick states:", "ExampleText",
 CellID->984257038,ExpressionUUID->"7c901189-b9d7-4865-a3a2-230c9c37e216"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"grn", "[", "1", "]"}], "=", 
   RowBox[{"RandomNambuGreen", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ws", "[", "1", "]"}], "=", 
  RowBox[{"WickState", "[", 
   RowBox[{"grn", "@", "1"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1195271820,ExpressionUUID->"00f0382c-de52-471c-bb50-18f8e3d20bab"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Covariance matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0", 
                    RowBox[{"-", "0.1681234183704616`"}], 
                    RowBox[{"-", "0.28844265376109257`"}], 
                    RowBox[{"-", "0.5014699832929441`"}], 
                    "\"\[Ellipsis]\""}, {
                    "0.1681234183704616`", "0", "0.09712328468933117`", 
                    RowBox[{"-", "0.33360769343261354`"}], 
                    "\"\[Ellipsis]\""}, {"0.28844265376109257`", 
                    RowBox[{"-", "0.09712328468933117`"}], "0", 
                    "0.2118866139636525`", "\"\[Ellipsis]\""}, {
                    "0.5014699832929441`", "0.33360769343261354`", 
                    RowBox[{"-", "0.2118866139636525`"}], "0", 
                    "\"\[Ellipsis]\""}, {
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", 
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\""}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {5, 5}, 0, {
                    1, {{0, 4, 8, 12, 16, 21}, {{2}, {3}, {4}, {5}, {1}, {
                    3}, {4}, {5}, {1}, {2}, {4}, {5}, {1}, {2}, {3}, {5}, {
                    1}, {2}, {3}, {4}, {
                    5}}}, {-0.1681234183704616, -0.28844265376109257`, \
-0.5014699832929441, "\[Ellipsis]", 0.1681234183704616, 
                    0.09712328468933117, -0.33360769343261354`, "\[Ellipsis]",
                     0.28844265376109257`, -0.09712328468933117, 
                    0.2118866139636525, "\[Ellipsis]", 0.5014699832929441, 
                    0.33360769343261354`, -0.2118866139636525, "\[Ellipsis]", 
                    "\[Ellipsis]", "\[Ellipsis]", "\[Ellipsis]", 
                    "\[Ellipsis]", "\[Ellipsis]"}}], TableHeadings -> 
                    None, {}]]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`WickState[{
   1, SparseArray[
    Automatic, {6, 6}, 0., {
     1, {{0, 6, 12, 18, 24, 30, 36}, {{1}, {2}, {3}, {4}, {5}, {6}, {2}, {
       1}, {3}, {4}, {5}, {6}, {3}, {1}, {2}, {4}, {5}, {6}, {4}, {1}, {2}, {
       3}, {5}, {6}, {5}, {1}, {2}, {3}, {4}, {6}, {6}, {1}, {2}, {3}, {4}, {
       5}}}, {0., -0.1681234183704616, -0.28844265376109257`, \
-0.5014699832929441, 0.22512337895847673`, 0.05478818651620404, 0., 
      0.1681234183704616, 0.09712328468933117, -0.33360769343261354`, 
      0.024047859828538742`, -0.11563571050854161`, 0., 
      0.28844265376109257`, -0.09712328468933117, 0.2118866139636525, 
      0.11621009376833266`, -0.34323472194326166`, 0., 0.5014699832929441, 
      0.33360769343261354`, -0.2118866139636525, 
      0.00746788241984684, -0.36478369656470633`, 
      0., -0.22512337895847673`, -0.024047859828538742`, \
-0.11621009376833266`, -0.00746788241984684, -0.3736149489799393, 
      0., -0.05478818651620404, 0.11563571050854161`, 0.34323472194326166`, 
      0.36478369656470633`, 0.3736149489799393}}]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[2]=",
 CellID->1148452586,ExpressionUUID->"1745cf3d-3941-49cb-873d-f91c30f447c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"grn", "[", "2", "]"}], "=", 
   RowBox[{"RandomNambuGreen", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ws", "[", "2", "]"}], "=", 
  RowBox[{"WickState", "[", 
   RowBox[{"grn", "@", "2"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1792054258,ExpressionUUID->"fa0ec28c-4a38-4157-96a6-33d626f2038a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Covariance matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0", "0.16717148991480177`", 
                    RowBox[{"-", "0.01381626377992675`"}], 
                    "0.42765829912097114`", "\"\[Ellipsis]\""}, {
                    RowBox[{"-", "0.16717148991480177`"}], "0", 
                    RowBox[{"-", "0.03797322285623286`"}], 
                    "0.1075545315974563`", "\"\[Ellipsis]\""}, {
                    "0.01381626377992675`", "0.03797322285623286`", "0", 
                    "0.6458874816443607`", "\"\[Ellipsis]\""}, {
                    RowBox[{"-", "0.42765829912097114`"}], 
                    RowBox[{"-", "0.1075545315974563`"}], 
                    RowBox[{"-", "0.6458874816443607`"}], "0", 
                    "\"\[Ellipsis]\""}, {
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", 
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\""}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {5, 5}, 0, {
                    1, {{0, 4, 8, 12, 16, 21}, {{2}, {3}, {4}, {5}, {1}, {
                    3}, {4}, {5}, {1}, {2}, {4}, {5}, {1}, {2}, {3}, {5}, {
                    1}, {2}, {3}, {4}, {5}}}, {
                    0.16717148991480177`, -0.01381626377992675, 
                    0.42765829912097114`, 
                    "\[Ellipsis]", -0.16717148991480177`, \
-0.03797322285623286, 0.1075545315974563, "\[Ellipsis]", 0.01381626377992675, 
                    0.03797322285623286, 0.6458874816443607, 
                    
                    "\[Ellipsis]", -0.42765829912097114`, \
-0.1075545315974563, -0.6458874816443607, "\[Ellipsis]", "\[Ellipsis]", 
                    "\[Ellipsis]", "\[Ellipsis]", "\[Ellipsis]", 
                    "\[Ellipsis]"}}], TableHeadings -> None, {}]]], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`WickState[{
   1, SparseArray[
    Automatic, {6, 6}, 0., {
     1, {{0, 6, 12, 18, 24, 30, 36}, {{1}, {2}, {3}, {4}, {5}, {6}, {2}, {
       1}, {3}, {4}, {5}, {6}, {3}, {1}, {2}, {4}, {5}, {6}, {4}, {1}, {2}, {
       3}, {5}, {6}, {5}, {1}, {2}, {3}, {4}, {6}, {6}, {1}, {2}, {3}, {4}, {
       5}}}, {0., 0.16717148991480177`, -0.01381626377992675, 
      0.42765829912097114`, 0.47561174755309965`, 0.32930563586629835`, 
      0., -0.16717148991480177`, -0.03797322285623286, 0.1075545315974563, 
      0.4069113256549318, -0.5283521831835688, 0., 0.01381626377992675, 
      0.03797322285623286, 
      0.6458874816443607, -0.21439289491866492`, -0.3422311889708965, 
      0., -0.42765829912097114`, -0.1075545315974563, -0.6458874816443607, \
-0.1868123755885341, -0.0653119478059294, 
      0., -0.47561174755309965`, -0.40691132565493193`, 0.21439289491866492`, 
      0.1868123755885341, 0.36758688061519473`, 0., -0.32930563586629835`, 
      0.5283521831835688, 0.3422311889708964, 
      0.0653119478059294, -0.36758688061519473`}}]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->616515045,ExpressionUUID->"a4d42d42-3b66-47ca-a122-a338e3e96f79"]
}, Open  ]],

Cell["Note that the above two are mixed states:", "ExampleText",
 CellID->1501733819,ExpressionUUID->"7f14bb0a-966c-4d16-8d26-e4cccbda9de6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"WickPureQ", "[", 
  RowBox[{"ws", "@", "1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WickPureQ", "[", 
  RowBox[{"ws", "@", "2"}], "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->808065030,ExpressionUUID->"2fb79e52-fba1-445a-b4f5-ad2e8513b57b"],

Cell[BoxData["False"], "Output",
 CellLabel->"Out[4]=",
 CellID->13755203,ExpressionUUID->"0d03d234-359f-40ae-89e9-5c5707d16fa6"],

Cell[BoxData["False"], "Output",
 CellLabel->"Out[4]=",
 CellID->1402946592,ExpressionUUID->"ac2aba67-f6b9-47fc-8483-47312fb874d0"]
}, Open  ]],

Cell["Calculate the Hilbert-Schmidt product:", "ExampleText",
 CellID->487251552,ExpressionUUID->"9dca114a-93e2-48cb-9cbb-d3042b187974"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"val", "=", 
  RowBox[{"WickInner", "[", 
   RowBox[{
    RowBox[{"ws", "@", "1"}], ",", 
    RowBox[{"ws", "@", "2"}]}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1184804050,ExpressionUUID->"1f74170b-d81b-4ea3-bc5f-f68960b44167"],

Cell[BoxData["0.1550501219753268`"], "Output",
 CellLabel->"Out[5]=",
 CellID->1210988730,ExpressionUUID->"044f7273-c8a5-43d8-b29e-8820bd59f919"]
}, Open  ]],

Cell["\<\
To verify the above result by using the conventional method, get the density \
matrices of the two Wick states:\
\>", "ExampleText",
 CellID->22552757,ExpressionUUID->"d5f1383d-ecb6-413e-9c98-fd2daf16fc3f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rho", "[", "1", "]"}], "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"ws", "@", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "[", "1", "]"}], "//", "ArrayShort"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rho", "[", "2", "]"}], "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"ws", "@", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "[", "2", "]"}], "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->855304665,ExpressionUUID->"f3f3a529-7332-41c4-aca5-c19afc61f565"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.2611344616346113`", "0", "0", 
      RowBox[{"0.04382564613016308`", "\[VeryThinSpace]", "-", 
       RowBox[{
       "0.1151474510240738`", " ", "\[ImaginaryI]"}]}], "\<\"\[Ellipsis]\"\>"},
     {"0", "0.12429585354300526`", 
      RowBox[{"0.011182489424142251`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0457280793002795`", " ", "\[ImaginaryI]"}]}], 
      "0", "\<\"\[Ellipsis]\"\>"},
     {"0", 
      RowBox[{"0.011182489424142268`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.045728079300279494`", " ", "\[ImaginaryI]"}]}], 
      "0.21386517704104424`", "0", "\<\"\[Ellipsis]\"\>"},
     {
      RowBox[{"0.04382564613016309`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11514745102407388`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0.15143949942781157`", "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1483034926,ExpressionUUID->"d674018f-20d8-4864-a4dc-45d4c004a83b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.056958217059162895`", "0", "0", 
      RowBox[{"0.05812058727303607`", "\[VeryThinSpace]", "+", 
       RowBox[{
       "0.04650427154142452`", " ", 
        "\[ImaginaryI]"}]}], "\<\"\[Ellipsis]\"\>"},
     {"0", "0.022923004210357294`", 
      RowBox[{
       RowBox[{"-", "0.011353905075060046`"}], "-", 
       RowBox[{"0.013705863201304909`", " ", "\[ImaginaryI]"}]}], 
      "0", "\<\"\[Ellipsis]\"\>"},
     {"0", 
      RowBox[{
       RowBox[{"-", "0.011353905075059945`"}], "+", 
       RowBox[{"0.013705863201304938`", " ", "\[ImaginaryI]"}]}], 
      "0.08169631462299644`", "0", "\<\"\[Ellipsis]\"\>"},
     {
      RowBox[{"0.058120587273036095`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.04650427154142462`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0.12459331454699721`", "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1672794200,ExpressionUUID->"36e2db25-397f-4f74-b4de-c9a7e109170c"]
}, Open  ]],

Cell["\<\
Calculate the Hilbert-Schmidt product in the conventional way:\
\>", "ExampleText",
 CellID->290529546,ExpressionUUID->"071ed770-5370-4def-a845-b4582314d8f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"alt", "=", 
  RowBox[{
   RowBox[{"Tr", "[", 
    RowBox[{
     RowBox[{"rho", "[", "1", "]"}], ".", 
     RowBox[{"rho", "[", "2", "]"}]}], "]"}], "//", "Chop"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->186223897,ExpressionUUID->"bc7a8b58-5f2c-4a23-8c03-bb54220b4ff8"],

Cell[BoxData["0.15505012197532683`"], "Output",
 CellLabel->"Out[7]=",
 CellID->834535053,ExpressionUUID->"f800b940-06cc-4a24-a81e-7773245f8649"]
}, Open  ]],

Cell["Verify the above result:", "ExampleText",
 CellID->814937214,ExpressionUUID->"7d461fee-867b-4d1e-a8bd-e34f1070b557"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"val", "-", "alt"}], "//", "Chop"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2147182951,ExpressionUUID->"2eea3a26-08d3-4d09-9f56-5a50ee5777ae"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[8]=",
 CellID->629960033,ExpressionUUID->"f18ee800-2f01-48b5-ba42-34219c198752"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["WickState"]], "paclet:QuantumMob/Q3/ref/WickState", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "9aeeb3c5-e31b-4001-b45d-8d5e1f22639f"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["WickCovariance"]], 
           "paclet:QuantumMob/Q3/ref/WickCovariance", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "46dad7ed-5316-40cd-9e14-781ae8241685"]
       }], "SeeAlso",ExpressionUUID->"f0a24d6c-e7b1-402a-8dc6-dafe71bf0ea6"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"c735802d-04b8-4aa0-bc5b-\
574d63f9fbcf"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Majorana Fermions"]], 
           "paclet:QuantumMob/Q3/tutorial/MajoranaFermions"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "fe2f32e3-6aaf-4251-8178-bdbe33a5a541"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "7990ef7e-b771-4bdb-ae61-13d89b9616f6"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "891cbd2a-e4a9-49ef-a7a8-e3338f7fe837"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], 
           "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "a9a4a447-8e9a-49fd-816e-478ab65b9d4c"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"2d24888b-a19e-4a44-b5b5-\
29660727cc79"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Fermionic Quantum Computation"]], 
           "paclet:QuantumMob/Q3/guide/FermionicQuantumComputation"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "ebe6c640-b8bf-4b99-8a7f-8dcd0439374b"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "de40a2a0-e000-46a6-97ce-a7239d3cef71"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "5ba2cf6c-cf8e-4597-aa57-f307e5eb56c6"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "12b8ecd7-7b08-4423-bbf8-f417c3764301"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"2ffa07e6-cecc-48eb-acc4-\
ab505de41889"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "S. Bravyi (2005)"}]]]], 
             "https://dl.acm.org/doi/abs/10.5555/2011637.2011640"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "ae729973-2aa2-4a8b-a4ad-4002051407aa"]}]],ExpressionUUID->
         "e6a665eb-afaf-4fd9-a82a-8b9f5bb2a675"],
        ", Quantum Information & Computation 5, 216 (2005), \"Lagrangian \
representation for fermionic linear optics.\""
       }], "RelatedLinks",ExpressionUUID->
        "1e4d2184-4ed3-440e-adfc-f3df6d41f589"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "7a3bf512-b82a-4288-b5c3-0f50b81e5873"]}]],ExpressionUUID->
         "3d03f9e1-e008-4ad9-965f-0916cdb66747"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "248e6a4f-47f9-424c-bcdb-90eaf19d0e59"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"0ab6e96c-a1b9-4b9b-a6d7-\
54acbc066d56"],

Cell[" ", "FooterCell",ExpressionUUID->"22231ce9-d674-4b7f-be46-fd946b3e652f"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"WickInner",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}, 
    "AllOptsTable" -> Closed, "NotesSection" -> Closed}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 1, 28, 22, 54, 0.829999}", 
    "history" -> {"14.3", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> "QuantumMob/Q3",
     "status" -> "None", "summary" -> 
    "WickInner[a, b] returns the Hilbert-Schmidt product \
Tr[\\[Rho]^\\[Dagger] \\[Sigma]] of two density matrices \\[Rho] and \
\\[Sigma] corresponding to the two Wick states a and b.", "synonyms" -> {}, 
    "tabletags" -> {}, "title" -> "WickInner", "titlemodifier" -> "", 
    "metadescription" -> "", "windowtitle" -> "WickInner", "type" -> "Symbol",
     "uri" -> "QuantumMob/Q3/ref/WickInner"}},
CellContext->"Global`",
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"802783a5-7d3b-4d31-be32-22457bbe37eb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[14798, 401, 1441, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"c0c99680-6c8e-4e33-9d34-9771c2900fc2",
   CellTags->"PrimaryExamplesSection",
   CellID->2110869083]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 49644, 1247}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[577, 21, 7141, 175, 70, "AnchorBarGrid",ExpressionUUID->"5a78a6ca-5757-47a5-b094-b3ce0d1180d0",
 CellID->1],
Cell[7721, 198, 96, 0, 70, "ContextNameCell",ExpressionUUID->"8147d949-9468-4c23-823c-1a2bb553ab6c"],
Cell[CellGroupData[{
Cell[7842, 202, 1360, 37, 70, "ObjectNameGrid",ExpressionUUID->"10cad113-28aa-4382-aff5-60a342d07c9d"],
Cell[9205, 241, 1636, 45, 70, "Usage",ExpressionUUID->"0e65a69b-de7a-49ef-b4b1-6cacaa20dcb6",
 CellID->1089404695]
}, Open  ]],
Cell[CellGroupData[{
Cell[10878, 291, 1850, 45, 70, "NotesSection",ExpressionUUID->"105a8b4d-221f-4bdf-971d-9547bb28aa02",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->525912184],
Cell[12731, 338, 1940, 57, 70, "Notes",ExpressionUUID->"2d35c181-05ef-44eb-b389-25592814d8d0",
 CellID->179134543]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[14798, 401, 1441, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"c0c99680-6c8e-4e33-9d34-9771c2900fc2",
 CellTags->"PrimaryExamplesSection",
 CellID->2110869083],
Cell[16242, 441, 203, 3, 70, "Input",ExpressionUUID->"a1fa098d-34ad-4c68-b163-531458af4702",
 CellID->1631457739],
Cell[CellGroupData[{
Cell[16470, 448, 1418, 37, 70, "ExampleSection",ExpressionUUID->"ae8fd80e-b3fb-4ba7-b21c-d3f92a7c3591",
 CellID->946829541],
Cell[17891, 487, 131, 1, 70, "ExampleText",ExpressionUUID->"7b82d027-40e3-48ee-ac72-45808513663a",
 CellID->1222081640],
Cell[18025, 490, 203, 5, 70, "Input",ExpressionUUID->"b090b2d6-5cc3-419b-aaac-b6989a526fa7",
 CellID->82314745],
Cell[18231, 497, 131, 1, 70, "ExampleText",ExpressionUUID->"7c901189-b9d7-4865-a3a2-230c9c37e216",
 CellID->984257038],
Cell[CellGroupData[{
Cell[18387, 502, 423, 11, 70, "Input",ExpressionUUID->"00f0382c-de52-471c-bb50-18f8e3d20bab",
 CellID->1195271820],
Cell[18813, 515, 7132, 139, 70, "Output",ExpressionUUID->"1745cf3d-3941-49cb-873d-f91c30f447c1",
 CellID->1148452586]
}, Open  ]],
Cell[CellGroupData[{
Cell[25982, 659, 423, 11, 70, "Input",ExpressionUUID->"fa0ec28c-4a38-4157-96a6-33d626f2038a",
 CellID->1792054258],
Cell[26408, 672, 7130, 140, 70, "Output",ExpressionUUID->"a4d42d42-3b66-47ca-a122-a338e3e96f79",
 CellID->616515045]
}, Open  ]],
Cell[33553, 815, 140, 1, 70, "ExampleText",ExpressionUUID->"7f14bb0a-966c-4d16-8d26-e4cccbda9de6",
 CellID->1501733819],
Cell[CellGroupData[{
Cell[33718, 820, 311, 7, 70, "Input",ExpressionUUID->"2fb79e52-fba1-445a-b4f5-ad2e8513b57b",
 CellID->808065030],
Cell[34032, 829, 129, 2, 70, "Output",ExpressionUUID->"0d03d234-359f-40ae-89e9-5c5707d16fa6",
 CellID->13755203],
Cell[34164, 833, 131, 2, 70, "Output",ExpressionUUID->"ac2aba67-f6b9-47fc-8483-47312fb874d0",
 CellID->1402946592]
}, Open  ]],
Cell[34310, 838, 136, 1, 70, "ExampleText",ExpressionUUID->"9dca114a-93e2-48cb-9cbb-d3042b187974",
 CellID->487251552],
Cell[CellGroupData[{
Cell[34471, 843, 300, 8, 70, "Input",ExpressionUUID->"1f74170b-d81b-4ea3-bc5f-f68960b44167",
 CellID->1184804050],
Cell[34774, 853, 145, 2, 70, "Output",ExpressionUUID->"044f7273-c8a5-43d8-b29e-8820bd59f919",
 CellID->1210988730]
}, Open  ]],
Cell[34934, 858, 216, 4, 70, "ExampleText",ExpressionUUID->"d5f1383d-ecb6-413e-9c98-fd2daf16fc3f",
 CellID->22552757],
Cell[CellGroupData[{
Cell[35175, 866, 635, 17, 70, "Input",ExpressionUUID->"f3f3a529-7332-41c4-aca5-c19afc61f565",
 CellID->855304665],
Cell[35813, 885, 1515, 33, 70, "Output",ExpressionUUID->"d674018f-20d8-4864-a4dc-45d4c004a83b",
 CellID->1483034926],
Cell[37331, 920, 1537, 36, 70, "Output",ExpressionUUID->"36e2db25-397f-4f74-b4de-c9a7e109170c",
 CellID->1672794200]
}, Open  ]],
Cell[38883, 959, 168, 3, 70, "ExampleText",ExpressionUUID->"071ed770-5370-4def-a845-b4582314d8f6",
 CellID->290529546],
Cell[CellGroupData[{
Cell[39076, 966, 335, 9, 70, "Input",ExpressionUUID->"bc7a8b58-5f2c-4a23-8c03-bb54220b4ff8",
 CellID->186223897],
Cell[39414, 977, 145, 2, 70, "Output",ExpressionUUID->"f800b940-06cc-4a24-a81e-7773245f8649",
 CellID->834535053]
}, Open  ]],
Cell[39574, 982, 122, 1, 70, "ExampleText",ExpressionUUID->"7d461fee-867b-4d1e-a8bd-e34f1070b557",
 CellID->814937214],
Cell[CellGroupData[{
Cell[39721, 987, 217, 5, 70, "Input",ExpressionUUID->"2eea3a26-08d3-4d09-9f56-5a50ee5777ae",
 CellID->2147182951],
Cell[39941, 994, 126, 2, 70, "Output",ExpressionUUID->"f18ee800-2f01-48b5-ba42-34219c198752",
 CellID->629960033]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[40309, 1005, 1407, 37, 70, "SeeAlsoSection",ExpressionUUID->"c735802d-04b8-4aa0-bc5b-574d63f9fbcf"],
Cell[41719, 1044, 1877, 47, 70, "TechNotesSection",ExpressionUUID->"2d24888b-a19e-4a44-b5b5-29660727cc79"],
Cell[43599, 1093, 1871, 46, 70, "MoreAboutSection",ExpressionUUID->"2ffa07e6-cecc-48eb-acc4-ab505de41889"],
Cell[45473, 1141, 2053, 56, 70, "RelatedLinksSection",ExpressionUUID->"0ab6e96c-a1b9-4b9b-a6d7-54acbc066d56"],
Cell[47529, 1199, 78, 0, 70, "FooterCell",ExpressionUUID->"22231ce9-d674-4b7f-be46-fd946b3e652f"]
}
]
*)

(* End of internal cache information *)
