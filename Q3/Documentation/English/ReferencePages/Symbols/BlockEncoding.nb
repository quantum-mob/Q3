(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    171905,       4093]
NotebookOptionsPosition[    158406,       3823]
NotebookOutlinePosition[    160949,       3885]
CellTagsIndexPosition[    160862,       3880]
WindowTitle->BlockEncoding
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "7318e864-9d43-4d41-9178-b0ab7dac866b"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "99af01d6-815e-419c-90b2-0dc2393065ae"],
        Background->RGBColor[0.490196, 0.576471, 0.690196],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "7fe47e43-a844-4e8f-8f2f-331fbb799697"]
         }],ExpressionUUID->"58ecd4db-4f6c-47f4-9314-7139d93854a9"],
         StripOnInput->False],{
        StyleBox[
          "\"UniformlyControlledGate\"", "SeeAlsoRelated", StripOnInput -> 
           False] :> Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/UniformlyControlledGate"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "f7240667-a235-46c8-b0bd-dd046efbbf32"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "e8533f27-c44c-4592-9cf7-b1b9df5fadf2"]
         }],ExpressionUUID->"29dfb4d5-cd17-4b63-97a7-3986497c5e17"],
         StripOnInput->False],{
        "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"], "\"Q3\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "f240e6e2-b50e-4fcb-a538-4c78d0bb135a"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "2e445d17-a90f-4165-957a-7eabcf6a6ac0"]
         }],ExpressionUUID->"11a8d934-b982-4115-b37a-0f91cea62700"],
         StripOnInput->False],{
        "\"Block Encoding\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/BlockEncoding"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"], 
         "\"Quick Quantum Computing with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuickQuantumComputingWithQ3"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "2b27737a-5d0a-4239-b4a7-37b234ef87a9"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "f2ac0cf8-b38c-45a9-9bee-33daa9da8639"]
         }],ExpressionUUID->"bc2b21ef-02cb-4c8e-af1d-ebfb9e4a3236"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/BlockEncoding\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/BlockEncoding"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
BlockEncoding.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[If[TrueQ[False], 
                 "http://reference.wolfram.com/system-modeler/", 
                 "http://reference.wolfram.com/language/"] <> 
               "QuantumMob/Q3/ref/BlockEncoding" <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "48915713-eab5-492c-9eea-d67fe8f52185"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "1ea0a67f-33d4-4f2c-8dcc-04c973f54652"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"056dab60-df02-4691-8539-51aea65a2dfa"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"03236569-b7ef-4057-8b8b-f7f8800dde86"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "BlockEncoding", "ObjectName",ExpressionUUID->
      "3964a804-f439-418c-84ff-df7ad5a73693"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"c03e4919-7528-476d-af06-f81c88095033"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "37182890-5617-4d66-b876-a290254bf3ce"]
    }],ExpressionUUID->"a185c185-20d9-442f-880a-9ed2b562c3a9"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.0\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->RGBColor[0.968627, 0.466667, 0]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "3aba66b6-697b-47fd-863f-8d854b98a37d"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"e807fa00-9a39-4428-8a53-4747ae12cf5b"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["BlockEncoding"]], 
         "paclet:QuantumMob/Q3/ref/BlockEncoding", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        StyleBox["mat", "TI"], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["s", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["s", "TI"], 
           StyleBox["2", "TR"]], ",", "\[Ellipsis]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["a", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["a", "TI"], 
           StyleBox["2", "TR"]], ",", "\[Ellipsis]"}], "}"}]}], "]"}]], 
      "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "04862a15-f119-489a-a0f8-08a17de4cb4f"],
     "\[LineSeparator]represents the block encoding of matrix ",
     Cell[BoxData[
      StyleBox["mat", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "6613c7b5-427e-4707-9ddc-51ae9cb36a2a"],
     ", which is regarded to represent an operator on the system register ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["s", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "01fba12c-6542-45a8-aa93-ea6f29f806ae"],
     ", using ancilla register ",
     Cell[BoxData[
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["a", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["a", "TI"], 
         StyleBox["2", "TR"]], ",", 
        StyleBox["\[Ellipsis]", "TR"]}], "}"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "b18f167f-3474-4512-b9aa-a696d174b546"],
     "."
    }],ExpressionUUID->"1a45344f-01c1-49a8-98c6-c6db788cbf04"]}
  }]], "Usage",
 CellID->2139940575,ExpressionUUID->"8413d501-f1c5-494e-8418-ab42652b7777"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[
       MatchQ[
        CurrentValue[
         EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, 
         Closed], 
        Alternatives[Open, True]], 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000001`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"2a71d6f9-f503-42a1-a499-5be1e9dd9629"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"5dd3dced-6e43-400e-9fef-1993de65908a"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"a8979355-3f1c-4813-9253-f27025b5102d"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"bd5674bf-aec9-4565-9049-1cd30855a43a"]], \
"NotesSection",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->921218736,ExpressionUUID->"5266c15e-9d5f-4c43-85f0-998974b240c7"],

Cell[TextData[{
 "Q3 implements one particular form described in the tech note \"",
 ButtonBox["Block Encoding",
  BaseStyle->"Link",
  ButtonData->"paclet:QuantumMob/Q3/tutorial/BlockEncoding"],
 "\"."
}], "Notes",
 CellID->2072607716,ExpressionUUID->"a1ecd3b3-5c7b-445b-89e3-919f08c38308"],

Cell[TextData[{
 "Option  ",
 Cell[BoxData[
  RowBox[{"\"\<Label\>\"", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      StyleBox["lbl", "TI"], 
      StyleBox["1", "TR"]], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox[
        StyleBox["lbl", "TI"], 
        StyleBox["21", "TR"]], ",", 
       SubscriptBox[
        StyleBox["lbl", "TI"], 
        StyleBox["22", "TR"]], ",", 
       SubscriptBox[
        StyleBox["lbl", "TI"], 
        StyleBox["23", "TR"]]}], "}"}]}], "}"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "84c6897a-9912-466c-9b3d-9e1e0dadf511"],
 " sets the label of the pristine form of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["BlockEncoding"]], "paclet:QuantumMob/Q3/ref/BlockEncoding", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "1dd41123-91ae-48ec-bd99-365d3a6eb2e8"],
 " to ",
 Cell[BoxData[
  SubscriptBox[
   StyleBox["lbl", "TI"], 
   StyleBox["1", "TR"]]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "5c6e1e3c-a1c7-4cc5-aa84-b438f9683f8f"],
 ", and ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    SubscriptBox[
     StyleBox["lbl", "TI"], 
     StyleBox["21", "TR"]], ",", 
    SubscriptBox[
     StyleBox["lbl", "TI"], 
     StyleBox["22", "TR"]], ",", 
    SubscriptBox[
     StyleBox["lbl", "TI"], 
     StyleBox["22", "TR"]]}], "}"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "5ef9aeef-440e-414e-9c0d-3d80328730b2"],
 " for the labels of the expanded form (",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Expand"]], "paclet:ref/Expand"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{"BlockEncoding", "[", 
    StyleBox["\[Ellipsis]", "TR"], "]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "dcaba06b-4a14-4f47-8213-cd664e263483"],
 ")."
}], "Notes",
 CellID->1333943237,ExpressionUUID->"c42c3b63-4aac-47b3-aa3c-d4d2c09f8110"],

Cell[TextData[{
 "Option  ",
 Cell[BoxData[
  RowBox[{"\"\<Label\>\"", "\[Rule]", 
   StyleBox["lbl", "TI"]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "ece4b4ec-431e-44bf-bb13-7e56f9199d91"],
 " or ",
 Cell[BoxData[
  RowBox[{"\"\<Label\>\"", "\[Rule]", 
   RowBox[{"{", 
    StyleBox["lbl", "TI"], "}"}]}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "7e720e9b-d3f2-476e-b7a2-7b8a543cc3b1"],
 " just sets the label of the pristine form of ",
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["BlockEncoding"]], "paclet:QuantumMob/Q3/ref/BlockEncoding", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "22493e90-b00f-453c-9aba-a63b47bea5d6"],
 "; the expanded form (",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{
     Cell[
      TextData["Expand"]], "paclet:ref/Expand"},
    "RefLink",
    BaseStyle->{"InlineFormula"}], "[", 
   RowBox[{"BlockEncoding", "[", 
    StyleBox["\[Ellipsis]", "TR"], "]"}], "]"}]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "13fe7ac8-f6ee-425b-b768-a46044199ee4"],
 ") takes the default label."
}], "Notes",
 CellID->320383127,ExpressionUUID->"ba388e21-3c75-489d-a0de-1929a4e34416"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375}}]],
  ExpressionUUID->"36a4e930-71dc-4bc5-913a-c44b9037241e"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"0fef5b7f-3df2-4387-8119-d93bbce82f52"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(4)", "ExampleCount",ExpressionUUID->
  "78c46c5b-6513-4bb8-b372-072c1c128269"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->1713684729,ExpressionUUID->"33658a36-b4d1-4316-8a1c-ab29cd7909d0"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->466743568,ExpressionUUID->"7421fae1-ac1f-43f9-ae7c-3b8a1ca32273"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625}}]],
  ExpressionUUID->"aefd51d6-b5cc-499b-ab7f-147f0d80efc9"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"6042eceb-c444-4197-8a6e-ff1fefc5b2d5"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "e3ccf52b-eeaa-4583-bb57-36a30715e681"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1996050386,ExpressionUUID->"a94a48cb-8abb-48db-a4a8-9f8cbbd8820a"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S", ",", "A"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->311642837,ExpressionUUID->"1e11fcff-b05d-4068-b297-fa645cc693ef"],

Cell[TextData[{
 "Consider a system register of ",
 StyleBox["n",
  FontSlant->"Italic"],
 " qubits."
}], "ExampleText",
 CellID->1521877654,ExpressionUUID->"9d7cad13-c6ee-4034-bb15-70d23dbc9d5b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$N", "=", 
   RowBox[{"Power", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->2067036557,ExpressionUUID->"c3cb4a75-8750-4532-8f67-45e17beb33bd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1974896852,ExpressionUUID->"9bc5213a-0f87-4146-bd97-b38701d8a232"]
}, Open  ]],

Cell[TextData[{
 "We are going to block-encode a matrix representing a linear operator acting \
on the system register by using an ancilla register of ",
 StyleBox["m",
  FontSlant->"Italic"],
 " qubits."
}], "ExampleText",
 CellID->489786172,ExpressionUUID->"0cb2d8bc-a08f-4c47-92b3-c9a8db63d431"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$m", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AA", "=", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$m"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1692008167,ExpressionUUID->"c478501b-4486-4c18-aa5e-d17f0c72fbd9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["A", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`A[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["A", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`A[2, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1224459765,ExpressionUUID->"839dd08c-2bd5-45ba-bf83-b04f3b0b4c89"]
}, Open  ]],

Cell["\<\
For later use, define a variable representing the total register.\
\>", "ExampleText",
 CellID->745459262,ExpressionUUID->"85124225-b41a-4476-a2d6-62f04fce3ead"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AS", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"AA", ",", "SS"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->776733676,ExpressionUUID->"5b5ab331-dc39-499d-87ab-c6c58c1aad39"],

Cell["\<\
Take a matrix representing an operator on the system register.\
\>", "ExampleText",
 CellID->1666669546,ExpressionUUID->"5e3bebba-5717-429a-bd09-f8f8c726984c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ThePauli", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "1"}], "}"}], "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"I", "/", "2"}], ")"}], "*", 
       RowBox[{"ThePauli", "[", 
        RowBox[{"{", 
         RowBox[{"3", ",", "2", ",", "2"}], "}"}], "]"}]}]}], ")"}], "/", 
    "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->959780981,ExpressionUUID->"f0bae31a-6e06-4ef4-9358-2245858460c8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", "0"},
     {"0", "0", 
      FractionBox["\[ImaginaryI]", "8"], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", "0", "0"},
     {"0", 
      FractionBox["\[ImaginaryI]", "8"], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "4"]},
     {
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "4"], "0"},
     {"0", 
      FractionBox["\[ImaginaryI]", "4"], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "8"]},
     {
      FractionBox["\[ImaginaryI]", "4"], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", 
      FractionBox["\[ImaginaryI]", "8"], "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{4}, {6}, {3}, {5}, {2}, {8}, {
       1}, {7}, {8}, {2}, {7}, {1}, {6}, {4}, {5}, {3}}}, {
      Complex[0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]]}}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->230027356,ExpressionUUID->"71e314a4-5f75-41a2-acee-6c1d8e94dfec"]
}, Open  ]],

Cell["Block-encode the matrix using the ancilla register.", "ExampleText",
 CellID->1833361766,ExpressionUUID->"6e89f723-53f1-415b-a4e3-58c341e31ac9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"enc", "=", 
  RowBox[{"BlockEncoding", "[", 
   RowBox[{"in", ",", "SS", ",", "AA"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->68546426,ExpressionUUID->"681a9289-c96d-460c-b267-7d4364bb4e8e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BlockEncoding",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"System Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`S[3, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Ancilla Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, Q3`$]]}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"System Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`S[3, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Ancilla Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`A[2, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0", "0", "0", 
                    RowBox[{"-", 
                    FractionBox["\[ImaginaryI]", "8"]}]}, {"0", "0", 
                    FractionBox["\[ImaginaryI]", "8"], "0"}, {"0", 
                    FractionBox["\[ImaginaryI]", "8"], "0", "0"}, {
                    RowBox[{"-", 
                    FractionBox["\[ImaginaryI]", "8"]}], "0", "0", "0"}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {4, 4}, 0, {
                    1, {{0, 1, 2, 3, 4}, {{4}, {3}, {2}, {1}}}, {
                    Complex[0, Rational[-1, 8]], Complex[0, Rational[1, 8]], 
                    Complex[0, Rational[1, 8]], Complex[
                    0, Rational[-1, 8]]}}]]]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`Private`vec,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[6]=",
 CellID->375592456,ExpressionUUID->"897686bd-220f-42f7-9c29-63286a940198"]
}, Open  ]],

Cell["Display the block encoding in a quantum circuit.", "ExampleText",
 CellID->88969382,ExpressionUUID->"9fd48db8-4cfa-4315-bef0-6938f96f62f8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "enc", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1551551898,ExpressionUUID->"4b85ebc5-0bbe-414b-8936-a361ace5db7a"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}, {{0, -5}, {2, -5}}}], {
     LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}, {1, -5}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -2.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"enc\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox["\<\"M\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`BlockEncoding[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{4}, {6}, {3}, {5}, {2}, {8}, {
       1}, {7}, {8}, {2}, {7}, {1}, {6}, {4}, {5}, {3}}}, {
      Complex[0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]]}}], {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, {
     $CellContext`A[1, Q3`$], 
     $CellContext`A[2, Q3`$]}]]]], "Output",
 CellLabel->"Out[7]=",
 CellID->902256453,ExpressionUUID->"b462011b-5f1b-489d-a8fd-8df4a0ae74ee"]
}, Open  ]],

Cell["\<\
Convert the block-encoding into the matrix representation, and check the \
block to make sure the input matrix has been properly embedded.\
\>", "ExampleText",
 CellID->1436470908,ExpressionUUID->"bf37df37-f9c1-4c55-b4a3-8b3952164124"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "enc", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "$N"}], ",", 
     RowBox[{";;", "$N"}]}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2003141392,ExpressionUUID->"ebb1ea6a-6d33-474d-a99d-edfa8966e75e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", "0"},
     {"0", "0", 
      FractionBox["\[ImaginaryI]", "8"], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", "0", "0"},
     {"0", 
      FractionBox["\[ImaginaryI]", "8"], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "4"]},
     {
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "4"], "0"},
     {"0", 
      FractionBox["\[ImaginaryI]", "4"], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "8"]},
     {
      FractionBox["\[ImaginaryI]", "4"], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", 
      FractionBox["\[ImaginaryI]", "8"], "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{4}, {6}, {3}, {5}, {2}, {8}, {
       1}, {7}, {2}, {8}, {1}, {7}, {4}, {6}, {3}, {5}}}, {
      Complex[0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[1, 4]], Complex[0, Rational[1, 8]], Complex[
       0, Rational[1, 4]], Complex[0, Rational[-1, 8]], Complex[
       0, Rational[-1, 4]], Complex[0, Rational[-1, 8]], Complex[
       0, Rational[-1, 4]], Complex[0, Rational[1, 8]]}}]]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->330995392,ExpressionUUID->"8c4940af-782f-4e12-8329-0c2793475561"]
}, Open  ]],

Cell[TextData[{
 "For a matrix ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]],ExpressionUUID->
  "4ac67d3d-07ec-4328-8ca6-db3626bf6135"],
 " with singular-value decomposition ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "=", 
    RowBox[{"V", "\[VeryThinSpace]", "\[CapitalLambda]", "\[VeryThinSpace]", 
     SuperscriptBox["W", "\[Dagger]"]}]}], TraditionalForm]],ExpressionUUID->
  "b87f9c27-0a81-4ab5-9b25-4512fb48cde9"],
 ", Q3 implements the quantum singular-value transform as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "\[RightTeeArrow]", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {"V", "0"},
        {"0", "V"}
       }], ")"}], 
     RowBox[{"(", GridBox[{
        {"\[CapitalLambda]", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["\[CapitalLambda]", "2"]}]]},
        {
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["\[CapitalLambda]", "2"]}]], 
         RowBox[{"-", "\[CapitalLambda]"}]}
       }], ")"}], 
     RowBox[{"(", GridBox[{
        {
         SuperscriptBox["W", "\[Dagger]"], "0"},
        {"0", 
         SuperscriptBox["W", "\[Dagger]"]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "b1cb9cee-857a-47db-89c9-46f1e36de70f"],
 ", where ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "c0b23a44-3f8f-4e3c-8cd4-493284c87a54"],
 " and ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],ExpressionUUID->
  "4984729e-d7e5-404c-980b-1b5501b1896a"],
 " are unitary matrices and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", ":=", 
    RowBox[{
     RowBox[{"diagonal", "(", 
      RowBox[{
       SubscriptBox["\[Lambda]", "1"], ",", 
       SubscriptBox["\[Lambda]", "2"], ",", "\[Ellipsis]"}], ")"}], "\[GreaterEqual]",
      "0"}]}], TraditionalForm]],ExpressionUUID->
  "0eeacf41-63cb-4465-adb3-2fa2dbf9a84f"],
 " are singular values. This implementation is described as follows. Here, we \
have used a short-hand notation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalOmega]", "k"], ":=", 
    SubscriptBox["\[CapitalOmega]", 
     SubscriptBox["\[Theta]", "k"]]}], TraditionalForm]],ExpressionUUID->
  "c957287e-fc97-4d49-a3ec-c8e1c7d686c9"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"cos", "(", 
     SubscriptBox["\[Theta]", "k"], ")"}], ":=", 
    SubscriptBox["\[Lambda]", "k"]}], TraditionalForm]],ExpressionUUID->
  "01687a82-1ac3-492d-b811-3454f1fc8adc"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalOmega]", "\[Theta]"], "\[DotEqual]", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"cos", "\[VeryThinSpace]", "\[Theta]"}], 
        RowBox[{"sin", "\[VeryThinSpace]", "\[Theta]"}]},
       {
        RowBox[{"sin", "\[VeryThinSpace]", "\[Theta]"}], 
        RowBox[{
         RowBox[{"-", "cos"}], "\[VeryThinSpace]", "\[Theta]"}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "dd808720-6e2f-430b-9bf8-2afedc04df14"],
 "."
}], "ExampleText",
 CellID->763152763,ExpressionUUID->"63bd978e-06e4-4793-873c-edc8481cd028"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"new", "=", 
  RowBox[{"Expand", "[", "enc", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"alt", "=", 
  RowBox[{"Expand", "[", "new", "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->39073415,ExpressionUUID->"a93ae4db-6aa9-4871-ad00-246b248c16fb"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}, {{0, -5}, {4, -5}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"W\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -3}, {2, -4}, {2, -5}, {2, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -3}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -3}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -4}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -4}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -5}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -5}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "\<\"\[Ellipsis]\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -5.4}, {3.4, -2.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 5]] - 2^Rational[-1, 2] Q3`Multiply[
      $CellContext`S[1, 5], 
      $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 
    Rational[1, 2] 2^Rational[-1, 2] $CellContext`S[3, 4] + 
    Rational[-1, 2] 2^Rational[-1, 2] $CellContext`S[3, 5], "Label" -> 
    Superscript["W", "\[Dagger]"]}, 
   Q3`UniformlyControlledGate[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, {
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[2, 1] + 
     Rational[3, 8] $CellContext`A[2, 3], 
     Rational[1, 8] 55^Rational[1, 2] $CellContext`A[2, 1] + 
     Rational[3, 8] $CellContext`A[2, 3], 
     Rational[1, 8] 55^Rational[1, 2] $CellContext`A[2, 1] + 
     Rational[3, 8] $CellContext`A[2, 3], 
     Rational[1, 8] 55^Rational[1, 2] $CellContext`A[2, 1] + 
     Rational[3, 8] $CellContext`A[2, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[2, 1] + 
     Rational[1, 8] $CellContext`A[2, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[2, 1] + 
     Rational[1, 8] $CellContext`A[2, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[2, 1] + 
     Rational[1, 8] $CellContext`A[2, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[2, 1] + 
     Rational[1, 8] $CellContext`A[2, 3]}, "Label" -> "\[CapitalOmega]"], {
   Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5]] + Complex[0, -1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 4] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 5], "Label" -> 
    "V"}, "Visible" -> {
     $CellContext`A[1, Q3`$], 
     $CellContext`A[2, Q3`$]}]]], "Output",
 CellLabel->"Out[9]=",
 CellID->1016200793,ExpressionUUID->"a2a5b169-e443-4ce7-b73a-e1abd2062308"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}, {{0, -3}, {11, -3}}, {{
     0, -4}, {11, -4}}, {{0, -5}, {11, -5}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -5.4}, {1.4, -2.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"W\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -3}, {2, -4}, {2, -5}, {2, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -5}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -2.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "0"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -3}, {3, -4}, {3, -5}, {3, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{3, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{3, -4}, 0.09]}, 
     DiskBox[{3, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -2.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "1"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -3}, {4, -4}, {4, -5}, {4, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{4, -3}, 0.09]}, 
     DiskBox[{4, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{4, -5}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -2.4}, {4.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {4., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -3}, {5, -4}, {5, -5}, {5, -2}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{5, -3}, 0.09]}, 
     DiskBox[{5, -4}, 0.09], DiskBox[{5, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -2.4}, {5.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -3}, {6, -4}, {6, -5}, {6, -2}}], 
     DiskBox[{6, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{6, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{6, -5}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -2.4}, {6.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -3}, {7, -4}, {7, -5}, {7, -2}}], 
     DiskBox[{7, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{7, -4}, 0.09]}, 
     DiskBox[{7, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -2.4}, {7.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "5"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {7., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -3}, {8, -4}, {8, -5}, {8, -2}}], 
     DiskBox[{8, -3}, 0.09], DiskBox[{8, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{8, -5}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -2.4}, {8.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "6"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -3}, {9, -4}, {9, -5}, {9, -2}}], 
     DiskBox[{9, -3}, 0.09], DiskBox[{9, -4}, 0.09], DiskBox[{9, -5}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -2.4}, {9.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "7"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {9., -2.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -5.4}, {10.4, -2.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10., -4.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->442.8,
   PlotRange->{{0, 11}, {-5.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 5]] - 2^Rational[-1, 2] Q3`Multiply[
      $CellContext`S[1, 5], 
      $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 
    Rational[1, 2] 2^Rational[-1, 2] $CellContext`S[3, 4] + 
    Rational[-1, 2] 2^Rational[-1, 2] $CellContext`S[3, 5], "Label" -> 
    Superscript["W", "\[Dagger]"]}, 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[2, 1] + 
    Rational[3, 8] $CellContext`A[2, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 0], "Label" -> "\[CapitalOmega]"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[2, 1] + 
    Rational[3, 8] $CellContext`A[2, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 1], "Label" -> "\[CapitalOmega]"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[2, 1] + 
    Rational[3, 8] $CellContext`A[2, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 2], "Label" -> "\[CapitalOmega]"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[2, 1] + 
    Rational[3, 8] $CellContext`A[2, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 3], "Label" -> "\[CapitalOmega]"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[2, 1] + 
    Rational[1, 8] $CellContext`A[2, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 4], "Label" -> "\[CapitalOmega]"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[2, 1] + 
    Rational[1, 8] $CellContext`A[2, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 5], "Label" -> "\[CapitalOmega]"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[2, 1] + 
    Rational[1, 8] $CellContext`A[2, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 6], "Label" -> "\[CapitalOmega]"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[2, 1] + 
    Rational[1, 8] $CellContext`A[2, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 7], "Label" -> "\[CapitalOmega]"], {
   Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5]] + Complex[0, -1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 4] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 5], "Label" -> 
    "V"}, "Visible" -> {
     $CellContext`A[1, Q3`$], 
     $CellContext`A[2, Q3`$]}]]], "Output",
 CellLabel->"Out[9]=",
 CellID->349283360,ExpressionUUID->"534a51b3-fa14-4abc-8f18-ba7d3152023b"]
}, Open  ]],

Cell["\<\
Check that these equivalent quantum circuits indeed reproduce the same matrix.\
\>", "ExampleText",
 CellID->532372496,ExpressionUUID->"5441af8f-c8d0-4696-8607-4e1dcca82b9d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mint", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"new", ",", "AS"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mint", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "$N"}], ",", 
     RowBox[{";;", "$N"}]}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->1651031722,ExpressionUUID->"d21b8612-66a3-40a6-8033-20feddd6896e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", "0"},
     {"0", "0", 
      FractionBox["\[ImaginaryI]", "8"], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", "0", "0"},
     {"0", 
      FractionBox["\[ImaginaryI]", "8"], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "4"]},
     {
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "4"], "0"},
     {"0", 
      FractionBox["\[ImaginaryI]", "4"], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "8"]},
     {
      FractionBox["\[ImaginaryI]", "4"], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", 
      FractionBox["\[ImaginaryI]", "8"], "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{4}, {6}, {8}, {2}, {3}, {5}, {
       7}, {1}, {2}, {8}, {6}, {4}, {1}, {7}, {5}, {3}, {8}, {4}, {2}, {6}, {
       7}, {3}, {1}, {5}, {6}, {2}, {4}, {8}, {5}, {1}, {3}, {7}}}, {
      Complex[0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], 0, 0, Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]], 0, 0, Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], 0, 0, Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], 0, 0, Complex[
       0, Rational[1, 8]], 0, Complex[0, Rational[1, 4]], 0, Complex[
       0, Rational[-1, 8]], 0, Complex[0, Rational[1, 4]], 0, Complex[
       0, Rational[-1, 8]], 0, Complex[0, Rational[-1, 4]], 0, Complex[
       0, Rational[1, 8]], 0, Complex[0, Rational[-1, 4]], 0}}]]]]], "Output",\

 CellLabel->"Out[10]//MatrixForm=",
 CellID->142883923,ExpressionUUID->"735d2c07-3228-4f00-8725-ce64b7f9027a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mint", "-", "mat"}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[11]:=",
 CellID->1011213466,ExpressionUUID->"ad0cc927-3da0-4792-b16d-87e559de1842"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {32, 32}, 0, {
     1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}]]]]], "Output",
 CellLabel->"Out[11]//MatrixForm=",
 CellID->1991411206,ExpressionUUID->"66892ea0-96bf-4c10-83c4-59abe3dca687"]
}, Open  ]],

Cell["\<\
Calculate the operator expression of the block-encoding on the total register.\
\>", "ExampleText",
 CellID->73177469,ExpressionUUID->"5517c82a-c4e3-4e4e-a933-b435adfa57ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EchoTiming", "[", 
  RowBox[{"expr", "=", 
   RowBox[{
    RowBox[{"Elaborate", "[", "enc", "]"}], "//", "Elaborate"}]}], 
  "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[12]:=",
 CellID->264598071,ExpressionUUID->"e8487b53-be54-4294-9fe6-75ed04402688"],

Cell[BoxData["2.550231`"], "EchoTiming",
 CellID->1671930460,ExpressionUUID->"d64f2ee4-ee98-4ca0-a059-ecc8965f5bb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", " ", 
      SqrtBox["7"]}], "+", 
     SqrtBox["55"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"A", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`A[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[2, 1], 
     $CellContext`S[1, 2], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "-", 
  RowBox[{
   FractionBox["1", "16"], " ", "\[ImaginaryI]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", " ", 
      SqrtBox["7"]}], "-", 
     SqrtBox["55"]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"A", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`A[2, 1]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[2, 1], 
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"A", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`A[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"X\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[2, 3], 
     $CellContext`S[1, 2], 
     $CellContext`S[2, 3], 
     $CellContext`S[3, 1]]]}], "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"A", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`A[2, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Z\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[1, 3]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[2, 2]], 
        InterpretationBox[
         TemplateBox[{"S", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"Y\""}, "RowWithSeparators"]}, 
          "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         $CellContext`S[3, 2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`A[2, 3], 
     $CellContext`S[1, 3], 
     $CellContext`S[2, 2], 
     $CellContext`S[3, 2]]]}]}]], "Output",
 CellLabel->"Out[12]=",
 CellID->311720225,ExpressionUUID->"b3b26a16-8468-4a92-9b83-a0a09c9e1dc6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"del", "=", 
   RowBox[{
    RowBox[{"Matrix", "[", 
     RowBox[{"alt", ",", "AS"}], "]"}], "-", "mat"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"del", "//", "SimplifyThrough"}], "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[13]:=",
 CellID->1548810753,ExpressionUUID->"15cc2578-c4f4-41bd-ad0f-70767c6e7439"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {32, 32}, 0, {
     1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, {}}]]]]], "Output",
 CellLabel->"Out[13]//MatrixForm=",
 CellID->255013269,ExpressionUUID->"08a2083a-5648-4c9a-b5fa-2ba9e9b72735"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"ed554da2-34d3-4e2e-b898-9b604c966728"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"73b0330b-95b4-4df4-adbb-478e34fe06e6"],
 "Options",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "8db1d277-c57e-487c-86ba-d094604be479"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->651243633,ExpressionUUID->"b169a046-4ea5-4db1-af6e-64676768e95c"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"49152859-82f3-479d-8624-2ed2023d5ebe"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"cf4b0dc2-19c5-4328-a5d7-4c22e985914c"],
 "Label",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "c3328058-fb59-4b69-9ce7-1f6113eb4e1c"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1875074719,ExpressionUUID->"179bf208-e8b4-4946-9c39-ee09d55020e4"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Qubit", ",", "S", ",", "A"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->376599101,ExpressionUUID->"123b2022-ea12-445b-bc48-5dbc03fc14fc"],

Cell[TextData[{
 "Consider a system register of ",
 StyleBox["n",
  FontSlant->"Italic"],
 " qubits."
}], "ExampleText",
 CellID->866782798,ExpressionUUID->"71437043-8ce2-45de-bccb-7004f5e180ab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SS", "=", 
  RowBox[{"S", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$n"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1636908385,ExpressionUUID->"9630e648-2915-4bdf-8f6b-951366a44da5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`S[1, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`S[2, Q3`$]], ",", 
   InterpretationBox[
    SubscriptBox["S", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`S[3, Q3`$]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->403831826,ExpressionUUID->"4f1e3a4e-9d00-4d86-9c2f-8b46e997de75"]
}, Open  ]],

Cell[TextData[{
 "We are going to block-encode a matrix representing a linear operator acting \
on the system register by using an ancilla register of ",
 StyleBox["m",
  FontSlant->"Italic"],
 " qubits."
}], "ExampleText",
 CellID->764294589,ExpressionUUID->"16b82599-0e7e-484c-b08b-dc2868d40a18"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AA", "=", 
  RowBox[{"A", "[", 
   RowBox[{
    RowBox[{"Range", "@", "$m"}], ",", "$"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1399464616,ExpressionUUID->"ea494152-9833-4434-82d3-6fa5db91a0e7"],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   SubscriptBox["A", 
    TemplateBox[{",", "\",\"", "1"},
     "RowWithSeparators"]],
   $CellContext`A[1, Q3`$]], "}"}]], "Output",
 CellLabel->"Out[3]=",
 CellID->659474466,ExpressionUUID->"2c8dc63f-7d2b-47ea-aba1-fd18ab1e59b7"]
}, Open  ]],

Cell["\<\
For later use, define a variable representing the total register.\
\>", "ExampleText",
 CellID->372084824,ExpressionUUID->"603891f7-14e4-448a-91d4-cf146a604d77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AS", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"AA", ",", "SS"}], "]"}]}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->157256904,ExpressionUUID->"2e652a43-1815-4cbd-82dd-3b5ca9adb9e3"],

Cell["\<\
Take a matrix representing an operator on the system register.\
\>", "ExampleText",
 CellID->1611899718,ExpressionUUID->"8deb4abc-6a50-4c8f-82ef-de45fbe999de"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"in", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ThePauli", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "1"}], "}"}], "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"I", "/", "2"}], ")"}], "*", 
       RowBox[{"ThePauli", "[", 
        RowBox[{"{", 
         RowBox[{"3", ",", "2", ",", "2"}], "}"}], "]"}]}]}], ")"}], "/", 
    "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"in", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->692353521,ExpressionUUID->"b1acf3b7-e0a1-4bc0-9444-11acd2b2f116"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", "0"},
     {"0", "0", 
      FractionBox["\[ImaginaryI]", "8"], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", "0", "0"},
     {"0", 
      FractionBox["\[ImaginaryI]", "8"], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "4"]},
     {
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "4"], "0"},
     {"0", 
      FractionBox["\[ImaginaryI]", "4"], "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "8"]},
     {
      FractionBox["\[ImaginaryI]", "4"], "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "8"]}], "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "4"]}], "0", 
      FractionBox["\[ImaginaryI]", "8"], "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{4}, {6}, {3}, {5}, {2}, {8}, {
       1}, {7}, {8}, {2}, {7}, {1}, {6}, {4}, {5}, {3}}}, {
      Complex[0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]]}}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1440034375,ExpressionUUID->"97c5a78a-8ed7-4c3b-8dc7-46d0e4f8a7da"]
}, Open  ]],

Cell["Block-encode the matrix using the ancilla register.", "ExampleText",
 CellID->1643841179,ExpressionUUID->"26005c72-69a1-4504-b391-94da1c016c03"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"enc", "=", 
  RowBox[{"BlockEncoding", "[", 
   RowBox[{"in", ",", "SS", ",", "AA"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->661576798,ExpressionUUID->"fd5a7788-83ca-4fea-8523-0231ab84b930"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BlockEncoding",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"System Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`S[3, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Ancilla Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, Q3`$]], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"System Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`S[1, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
                    $CellContext`S[2, Q3`$]], ",", 
                    InterpretationBox[
                    SubscriptBox["S", 
                    TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
                    $CellContext`S[3, Q3`$]]}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Ancilla Register: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    InterpretationBox[
                    SubscriptBox["A", 
                    TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
                    $CellContext`A[1, Q3`$]], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0", "0", "0", 
                    RowBox[{"-", 
                    FractionBox["\[ImaginaryI]", "8"]}]}, {"0", "0", 
                    FractionBox["\[ImaginaryI]", "8"], "0"}, {"0", 
                    FractionBox["\[ImaginaryI]", "8"], "0", "0"}, {
                    RowBox[{"-", 
                    FractionBox["\[ImaginaryI]", "8"]}], "0", "0", "0"}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {4, 4}, 0, {
                    1, {{0, 1, 2, 3, 4}, {{4}, {3}, {2}, {1}}}, {
                    Complex[0, Rational[-1, 8]], Complex[0, Rational[1, 8]], 
                    Complex[0, Rational[1, 8]], Complex[
                    0, Rational[-1, 8]]}}]]]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Q3`Private`vec,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[6]=",
 CellID->469594900,ExpressionUUID->"e9ab5767-e908-42b3-8bb4-2634da8a028f"]
}, Open  ]],

Cell["Display the block encoding in a quantum circuit.", "ExampleText",
 CellID->1494129546,ExpressionUUID->"66cc5797-a5cb-45c5-9a25-af2a8883ee86"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"QuantumCircuit", "[", "enc", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1308995251,ExpressionUUID->"f9d583fb-7129-4e7a-b3ce-b12f3fa000d6"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"enc\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`BlockEncoding[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{4}, {6}, {3}, {5}, {2}, {8}, {
       1}, {7}, {8}, {2}, {7}, {1}, {6}, {4}, {5}, {3}}}, {
      Complex[0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]]}}], {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, {
     $CellContext`A[1, Q3`$]}, "Label" -> "A"]]]], "Output",
 CellLabel->"Out[7]=",
 CellID->1942813907,ExpressionUUID->"84f90627-c77b-4de9-8b12-06b5ce422493"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "a20f1672-c138-401c-8ce8-e15d5988af2e"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->271351881,ExpressionUUID->"ef2b0cd9-2f7b-437a-9408-1df44b6e052e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"enc", "=", 
   RowBox[{"BlockEncoding", "[", 
    RowBox[{"in", ",", "SS", ",", "AA", ",", 
     RowBox[{"\"\<Label\>\"", "->", "\"\<A\>\""}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "enc", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", "enc", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExpandAll", "[", "enc", "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1522210377,ExpressionUUID->"eba9a383-53ce-4191-a151-cd0243830a95"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"enc\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`BlockEncoding[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{4}, {6}, {3}, {5}, {2}, {8}, {
       1}, {7}, {8}, {2}, {7}, {1}, {6}, {4}, {5}, {3}}}, {
      Complex[0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]]}}], {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, {
     $CellContext`A[1, Q3`$]}, "Label" -> "A"]]]], "Output",
 CellLabel->"Out[1]=",
 CellID->14958706,ExpressionUUID->"f3636a4b-0eab-4571-86e1-62f3383b5475"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"W\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -4}, {2, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -2}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -2}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -3}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -3}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -4}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -4}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "\<\"\[Ellipsis]\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 5]] - 2^Rational[-1, 2] Q3`Multiply[
      $CellContext`S[1, 5], 
      $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 
    Rational[1, 2] 2^Rational[-1, 2] $CellContext`S[3, 4] + 
    Rational[-1, 2] 2^Rational[-1, 2] $CellContext`S[3, 5], "Label" -> 
    Superscript["W", "\[Dagger]"]}, 
   Q3`UniformlyControlledGate[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, {
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[3, 8] $CellContext`A[1, 3], 
     Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[3, 8] $CellContext`A[1, 3], 
     Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[3, 8] $CellContext`A[1, 3], 
     Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[3, 8] $CellContext`A[1, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[1, 8] $CellContext`A[1, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[1, 8] $CellContext`A[1, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[1, 8] $CellContext`A[1, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[1, 8] $CellContext`A[1, 3]}, "Label" -> "\[CapitalOmega]", 
    "Label" -> "A"], {Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5]] + Complex[0, -1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 4] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 5], "Label" -> 
    "V"}, "Visible" -> {
     $CellContext`A[1, Q3`$]}]]], "Output",
 CellLabel->"Out[1]=",
 CellID->155385043,ExpressionUUID->"d2f38512-8efb-49a0-88c2-80867fd62527"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}, {{0, -3}, {11, -3}}, {{
     0, -4}, {11, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"W\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -4}, {2, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "0"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -2}, {3, -3}, {3, -4}, {3, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{3, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{3, -3}, 0.09]}, 
     DiskBox[{3, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "1"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -3}, {4, -4}, {4, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{4, -2}, 0.09]}, 
     DiskBox[{4, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{4, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -3}, {5, -4}, {5, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{5, -2}, 0.09]}, 
     DiskBox[{5, -3}, 0.09], DiskBox[{5, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -2}, {6, -3}, {6, -4}, {6, -1}}], 
     DiskBox[{6, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{6, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{6, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -3}, {7, -4}, {7, -1}}], 
     DiskBox[{7, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{7, -3}, 0.09]}, 
     DiskBox[{7, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "5"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {7., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -2}, {8, -3}, {8, -4}, {8, -1}}], 
     DiskBox[{8, -2}, 0.09], DiskBox[{8, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{8, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -1.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "6"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -2}, {9, -3}, {9, -4}, {9, -1}}], 
     DiskBox[{9, -2}, 0.09], DiskBox[{9, -3}, 0.09], DiskBox[{9, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"\[CapitalOmega]\"\>", "7"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {9., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -1.6}]}, InsetBox[
      StyleBox["\<\"V\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->442.8,
   PlotRange->{{0, 11}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 5]] - 2^Rational[-1, 2] Q3`Multiply[
      $CellContext`S[1, 5], 
      $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 
    Rational[1, 2] 2^Rational[-1, 2] $CellContext`S[3, 4] + 
    Rational[-1, 2] 2^Rational[-1, 2] $CellContext`S[3, 5], "Label" -> 
    Superscript["W", "\[Dagger]"]}, 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[3, 8] $CellContext`A[1, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 0], "Label" -> "\[CapitalOmega]", "Label" -> 
    "A"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[3, 8] $CellContext`A[1, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 1], "Label" -> "\[CapitalOmega]", "Label" -> 
    "A"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[3, 8] $CellContext`A[1, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 2], "Label" -> "\[CapitalOmega]", "Label" -> 
    "A"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[3, 8] $CellContext`A[1, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 3], "Label" -> "\[CapitalOmega]", "Label" -> 
    "A"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[1, 8] $CellContext`A[1, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 4], "Label" -> "\[CapitalOmega]", "Label" -> 
    "A"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[1, 8] $CellContext`A[1, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 5], "Label" -> "\[CapitalOmega]", "Label" -> 
    "A"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[1, 8] $CellContext`A[1, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 6], "Label" -> "\[CapitalOmega]", "Label" -> 
    "A"], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[1, 8] $CellContext`A[1, 3], "Label" -> 
    Subscript["\[CapitalOmega]", 7], "Label" -> "\[CapitalOmega]", "Label" -> 
    "A"], {Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5]] + Complex[0, -1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 4] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 5], "Label" -> 
    "V"}, "Visible" -> {
     $CellContext`A[1, Q3`$]}]]], "Output",
 CellLabel->"Out[1]=",
 CellID->216302949,ExpressionUUID->"e7d9fc72-7fd6-4ab1-93a0-f41ac51df6a1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "799559e2-e98c-4caf-9c7e-148a300b4bd8"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->2088356695,ExpressionUUID->"54894bb6-fd7a-4527-a283-51bc1f6487f6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"enc", "=", 
   RowBox[{"BlockEncoding", "[", 
    RowBox[{"in", ",", "SS", ",", "AA", ",", 
     RowBox[{"\"\<Label\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<A\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<U\>\"", ",", "\"\<G\>\"", ",", "\"\<V\>\""}], "}"}]}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"QuantumCircuit", "[", "enc", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Expand", "[", "enc", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExpandAll", "[", "enc", "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->678008436,ExpressionUUID->"98b71f21-4a45-4668-b233-8cd0c3900d9e"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {2, -1}}, {{0, -2}, {2, -2}}, {{0, -3}, {2, -3}}, {{
     0, -4}, {2, -4}}}], {LineBox[{{1, -1}, {1, -2}, {1, -3}, {1, -4}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -1.4}, {1.4, -0.6},
       RoundingRadius->0.4]}, InsetBox[
      StyleBox["\<\"enc\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {0, 1}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox["\<\"A\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.2],
       FontWeight->"Light",
       FontSlant->Italic], {1., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->118.8,
   PlotRange->{{0, 2}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[
   Q3`BlockEncoding[
   SparseArray[
    Automatic, {8, 8}, 0, {
     1, {{0, 2, 4, 6, 8, 10, 12, 14, 16}, {{4}, {6}, {3}, {5}, {2}, {8}, {
       1}, {7}, {8}, {2}, {7}, {1}, {6}, {4}, {5}, {3}}}, {
      Complex[0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[1, 4]], Complex[
       0, Rational[-1, 8]], Complex[0, Rational[-1, 4]], Complex[
       0, Rational[1, 8]], Complex[0, Rational[-1, 4]]}}], {
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, {
     $CellContext`A[1, Q3`$]}, "Label" -> {"A", {"U", "G", "V"}}]]]], "Output",\

 CellLabel->"Out[1]=",
 CellID->1777171622,ExpressionUUID->"d4e53767-8a11-469b-a427-e81031fe5cd9"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {4, -1}}, {{0, -2}, {4, -2}}, {{0, -3}, {4, -3}}, {{
     0, -4}, {4, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"V\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {1., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -4}, {2, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -2}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -2}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -3}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -3}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      DiskBox[{2, -4}, 0.09, 
       NCache[{Rational[1, 4] Pi, Rational[5, 4] Pi}, {0.7853981633974483, 
        3.9269908169872414`}]], 
      {GrayLevel[0], 
       DiskBox[{2, -4}, 0.09, 
        NCache[{Rational[-3, 4] Pi, Rational[1, 4] Pi}, {-2.356194490192345, 
         0.7853981633974483}]]}}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"G\"\>", "\<\"\[Ellipsis]\"\>"],
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -4.4}, {3.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.1],
       FontWeight->"Light",
       FontSlant->Italic], {3., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->190.79999999999998`,
   PlotRange->{{0, 4}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 5]] - 2^Rational[-1, 2] Q3`Multiply[
      $CellContext`S[1, 5], 
      $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 
    Rational[1, 2] 2^Rational[-1, 2] $CellContext`S[3, 4] + 
    Rational[-1, 2] 2^Rational[-1, 2] $CellContext`S[3, 5], "Label" -> 
    Superscript["V", "\[Dagger]"]}, 
   Q3`UniformlyControlledGate[{
     $CellContext`S[1, Q3`$], 
     $CellContext`S[2, Q3`$], 
     $CellContext`S[3, Q3`$]}, {
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[3, 8] $CellContext`A[1, 3], 
     Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[3, 8] $CellContext`A[1, 3], 
     Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[3, 8] $CellContext`A[1, 3], 
     Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[3, 8] $CellContext`A[1, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[1, 8] $CellContext`A[1, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[1, 8] $CellContext`A[1, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[1, 8] $CellContext`A[1, 3], 
     Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
     Rational[1, 8] $CellContext`A[1, 3]}, "Label" -> "G", 
    "Label" -> {"A", {"U", "G", "V"}}], {Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5]] + Complex[0, -1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 4] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 5], "Label" -> 
    "U"}, "Visible" -> {
     $CellContext`A[1, Q3`$]}]]], "Output",
 CellLabel->"Out[1]=",
 CellID->1720888478,ExpressionUUID->"ae03c329-6b3a-4bb1-9797-297de0e172b7"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    {Dashing[{Small, Small}], LineBox[{}]}, 
    LineBox[{{{0, -1}, {11, -1}}, {{0, -2}, {11, -2}}, {{0, -3}, {11, -3}}, {{
     0, -4}, {11, -4}}}], {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -4.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"V\"", "\"\[Dagger]\""},
        "Superscript"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {1., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{2, -2}, {2, -3}, {2, -4}, {2, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{2, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -1.4}, {2.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"G\"\>", "0"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {2., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{3, -2}, {3, -3}, {3, -4}, {3, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{3, -2}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{3, -3}, 0.09]}, 
     DiskBox[{3, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{2.6, -1.4}, {3.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"G\"\>", "1"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {3., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{4, -2}, {4, -3}, {4, -4}, {4, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{4, -2}, 0.09]}, 
     DiskBox[{4, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{4, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{3.6, -1.4}, {4.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"G\"\>", "2"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {4., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{5, -2}, {5, -3}, {5, -4}, {5, -1}}], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{5, -2}, 0.09]}, 
     DiskBox[{5, -3}, 0.09], DiskBox[{5, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{4.6, -1.4}, {5.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"G\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {5., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{6, -2}, {6, -3}, {6, -4}, {6, -1}}], 
     DiskBox[{6, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{6, -3}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{6, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{5.6, -1.4}, {6.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"G\"\>", "4"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {6., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{7, -2}, {7, -3}, {7, -4}, {7, -1}}], 
     DiskBox[{7, -2}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{7, -3}, 0.09]}, 
     DiskBox[{7, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{6.6, -1.4}, {7.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"G\"\>", "5"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {7., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{8, -2}, {8, -3}, {8, -4}, {8, -1}}], 
     DiskBox[{8, -2}, 0.09], DiskBox[{8, -3}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], DiskBox[{8, -4}, 0.09]}, 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{7.6, -1.4}, {8.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"G\"\>", "6"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {8., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {LineBox[{{9, -2}, {9, -3}, {9, -4}, {9, -1}}], 
     DiskBox[{9, -2}, 0.09], DiskBox[{9, -3}, 0.09], DiskBox[{9, -4}, 0.09], 
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{8.6, -1.4}, {9.4, -0.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"G\"\>", "7"],
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {9., -1.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {
     {GrayLevel[1], EdgeForm[Opacity[1]], 
      RectangleBox[{9.6, -4.4}, {10.4, -1.6}]}, InsetBox[
      StyleBox["\<\"U\"\>",
       StripOnInput->False,
       FontSize->Scaled[0.03636363636363637],
       FontWeight->"Light",
       FontSlant->Italic], {10., -3.}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   AxesStyle->Large,
   FrameStyle->Large,
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->442.8,
   PlotRange->{{0, 11}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  Q3`QuantumCircuit[{Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[3, 5]] - 2^Rational[-1, 2] Q3`Multiply[
      $CellContext`S[1, 5], 
      $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + Rational[-1, 2] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4], 
       $CellContext`S[3, 5]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 4]] + 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5], 
       $CellContext`S[3, 5]] + 
    Rational[1, 2] 2^Rational[-1, 2] $CellContext`S[3, 4] + 
    Rational[-1, 2] 2^Rational[-1, 2] $CellContext`S[3, 5], "Label" -> 
    Superscript["V", "\[Dagger]"]}, 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[3, 8] $CellContext`A[1, 3], "Label" -> Subscript["G", 0], 
    "Label" -> "G", "Label" -> {"A", {"U", "G", "V"}}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[3, 8] $CellContext`A[1, 3], "Label" -> Subscript["G", 1], 
    "Label" -> "G", "Label" -> {"A", {"U", "G", "V"}}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[3, 8] $CellContext`A[1, 3], "Label" -> Subscript["G", 2], 
    "Label" -> "G", "Label" -> {"A", {"U", "G", "V"}}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 0, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[1, 8] 55^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[3, 8] $CellContext`A[1, 3], "Label" -> Subscript["G", 3], 
    "Label" -> "G", "Label" -> {"A", {"U", "G", "V"}}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[1, 8] $CellContext`A[1, 3], "Label" -> Subscript["G", 4], 
    "Label" -> "G", "Label" -> {"A", {"U", "G", "V"}}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     0, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[1, 8] $CellContext`A[1, 3], "Label" -> Subscript["G", 5], 
    "Label" -> "G", "Label" -> {"A", {"U", "G", "V"}}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 0}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[1, 8] $CellContext`A[1, 3], "Label" -> Subscript["G", 6], 
    "Label" -> "G", "Label" -> {"A", {"U", "G", "V"}}], 
   Q3`ControlledGate[{$CellContext`S[1, Q3`$] -> 1, $CellContext`S[2, Q3`$] -> 
     1, $CellContext`S[3, Q3`$] -> 1}, 
    Rational[3, 8] 7^Rational[1, 2] $CellContext`A[1, 1] + 
    Rational[1, 8] $CellContext`A[1, 3], "Label" -> Subscript["G", 7], 
    "Label" -> "G", "Label" -> {"A", {"U", "G", "V"}}], {Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 4]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 5]] + Complex[0, -1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 4]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 4], 
       $CellContext`S[2, 5]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 3], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 1] 2^Rational[-1, 2] Q3`Multiply[
       $CellContext`S[1, 5], 
       $CellContext`S[2, 3], 
       $CellContext`S[3, 3]] + Complex[0, 
       Rational[-1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 4] + Complex[0, 
       Rational[1, 2]] 2^Rational[-1, 2] $CellContext`S[2, 5], "Label" -> 
    "U"}, "Visible" -> {
     $CellContext`A[1, Q3`$]}]]], "Output",
 CellLabel->"Out[1]=",
 CellID->662891950,ExpressionUUID->"2567c1bc-4327-4d55-a0d9-6bb52819d165"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[Cell[BoxData[
        TemplateBox[{
          Cell[
           TextData["UniformlyControlledGate"]], 
          "paclet:QuantumMob/Q3/ref/UniformlyControlledGate", 
          "QuantumMob Package Symbol"},
         "PackageLink",
         BaseStyle->"InlineFormula"]], "InlineFormula",
        FontFamily->"Source Sans Pro",ExpressionUUID->
        "65a02b25-298d-4e99-89af-56ba81ed714f"]], "SeeAlso",ExpressionUUID->
        "da9fbca1-7f49-422f-9607-e9d25e507957"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"e9336ee8-1fe4-4f8c-8e30-\
8570fbee8579"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{
       "\[FilledVerySmallSquare]", Cell[TextData[ButtonBox["Block Encoding",
         BaseStyle->"Link",
         ButtonData->"paclet:QuantumMob/Q3/tutorial/BlockEncoding"]], 
         "TechNotes",ExpressionUUID->
         "0120ba02-0c82-46d5-92b8-817737dcfd6a"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "55e1dab5-974e-4290-9a31-2a14869aaf35"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quick Quantum Computing with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuickQuantumComputingWithQ3"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "3c64db10-6a9d-41c9-a7b8-f8a16959ed5b"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], 
           "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "78f2382b-cbb4-448f-98ac-8f9097cd8cbd"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"cddcd0b1-23d8-448c-9b81-\
8a3646d784dd"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "d26dc414-f790-491b-8cb3-884f3c5ccfbb"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3"]], "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "390c9806-f998-4667-9c27-0949da41c8ee"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"23327d9b-ec52-4e39-b427-\
d515480a21e1"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "A. Gilyen, Y. Su, G. Hao, and N. Wiebe (2019)"}]]]], 
             "https://doi.org/10.1145/3313276.3316366"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "9244aa73-199a-4176-a0ca-36821ec9d63b"]}]],ExpressionUUID->
         "78a4c761-9512-40d2-bdc3-e199cd93bbb8"],
        ", Proceedings of the 51st Annual ACM SIGACT Symposium on Theory of \
Computing, \"Quantum singular value transformation and beyond: exponential \
improvements for quantum matrix arithmetics.\""
       }], "RelatedLinks",ExpressionUUID->
        "e4fd812d-c8d5-43bd-a512-f20547b2a274"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "L. Lin (2022)"}]]]], 
             "https://arxiv.org/abs/2201.08309"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "59bc0c2e-4754-400f-98e5-5041e3bd01a0"]}]],ExpressionUUID->
         "018f2eac-17d4-424c-a724-3b0370e79fc7"],
        ", arXiv:2201.08309, \"Lecture Notes on Quantum Algorithms for \
Scientific Computation.\""
       }], "RelatedLinks",ExpressionUUID->
        "e0ce257d-e15b-4443-869f-cec1f53ee130"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "J. M. Martyn, Z. M. Rossi, A. K. Tan, I. L. Chuan \
(2021)"}]]]], "https://doi.org/10.1103%2Fprxquantum.2.040203"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "40aafea7-eba2-4199-9ab2-7220df516113"]}]],ExpressionUUID->
         "9b924108-fdb9-4851-a258-4388e8b6c734"],
        ", PRX Quantum 2, 4 040203, \"Grand Unification of Quantum \
Algorithms.\""
       }], "RelatedLinks",ExpressionUUID->
        "5184f669-7aca-4880-b484-a93958088d9b"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "M. Nielsen and I. L. Chuang (2022)"}]]]], 
             "https://doi.org/10.1017/CBO9780511976667"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "e53136b5-bce1-47a5-9690-41f851ad33f6"]}]],ExpressionUUID->
         "3fc53e47-795a-4599-9d95-5489259ef1d8"],
        StyleBox[
        ", Quantum Computation and Quantum Information (Cambridge University \
Press).",
         FontSlant->"Plain"]
       }], "RelatedLinks",ExpressionUUID->
        "b777ee43-3997-4f9a-aa98-0bca11f1f44f"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "8fc14c5a-e734-402f-a167-b43ef1c2c2a0"]}]],ExpressionUUID->
         "5a789ff2-b55b-4b1d-8300-8cbbac6960d1"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "864de614-d177-4cac-a476-8a58a41aa0c5"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"fc2d0e78-2d7b-4782-adc3-\
a111f32a99c6"],

Cell[" ", "FooterCell",ExpressionUUID->"95a0b34b-3a5a-4e9e-93fb-5841d92cb963"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"BlockEncoding",
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed}, "AllOptsTable" -> 
    Closed, "NotesSection" -> Closed, "ExampleSubsection" -> {"0" -> Closed}},
   "NewStyles" -> True, "CitationPopupData" -> $Failed, "ShowCitation" -> 
  False, "HasOptions" -> True, "RootCaptions" -> "", 
  "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2025, 3, 6, 0, 58, 9.637801}", 
    "history" -> {"14.0", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {
     "quantum singular-value transform (QSVT)", 
      "quantum eigen-value transform (QET)", "qubitization"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3", "status" -> "None", "summary" -> 
    "BlockEncoding[mat, {s1, s2, ...}, {a1, a2, ...}] represents the block \
encoding of matrix mat, which is regarded to represent an operator on the \
system register {s1, s2, ...}, using ancilla register {a1, a2, ...}.", 
    "synonyms" -> {}, "tabletags" -> {}, "title" -> "BlockEncoding", 
    "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "BlockEncoding", "type" -> "Symbol", "uri" -> 
    "QuantumMob/Q3/ref/BlockEncoding"}},
CellContext->"Global`",
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (December 26, 2024)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.2 for Mac OS X ARM (64-bit) (December 26, 2024)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"8f4991f7-3cc1-4d13-8672-40aa9804ec04"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[16777, 474, 1438, 38, 34, "PrimaryExamplesSection",ExpressionUUID->"33658a36-b4d1-4316-8a1c-ab29cd7909d0",
   CellTags->"PrimaryExamplesSection",
   CellID->1713684729]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 160661, 3873}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[581, 21, 6651, 165, 50, "AnchorBarGrid",ExpressionUUID->"056dab60-df02-4691-8539-51aea65a2dfa",
 CellID->1],
Cell[7235, 188, 96, 0, 22, "ContextNameCell",ExpressionUUID->"03236569-b7ef-4057-8b8b-f7f8800dde86"],
Cell[CellGroupData[{
Cell[7356, 192, 1330, 36, 57, "ObjectNameGrid",ExpressionUUID->"e807fa00-9a39-4428-8a53-4747ae12cf5b"],
Cell[8689, 230, 2324, 66, 127, "Usage",ExpressionUUID->"8413d501-f1c5-494e-8418-ab42652b7777",
 CellID->2139940575]
}, Open  ]],
Cell[CellGroupData[{
Cell[11050, 301, 1916, 48, 34, "NotesSection",ExpressionUUID->"5266c15e-9d5f-4c43-85f0-998974b240c7",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->921218736],
Cell[12969, 351, 291, 7, 70, "Notes",ExpressionUUID->"a1ecd3b3-5c7b-445b-89e3-919f08c38308",
 CellID->2072607716],
Cell[13263, 360, 2081, 68, 70, "Notes",ExpressionUUID->"c42c3b63-4aac-47b3-aa3c-d4d2c09f8110",
 CellID->1333943237],
Cell[15347, 430, 1303, 38, 70, "Notes",ExpressionUUID->"ba388e21-3c75-489d-a0de-1929a4e34416",
 CellID->320383127]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[16777, 474, 1438, 38, 34, "PrimaryExamplesSection",ExpressionUUID->"33658a36-b4d1-4316-8a1c-ab29cd7909d0",
 CellTags->"PrimaryExamplesSection",
 CellID->1713684729],
Cell[18218, 514, 202, 3, 29, "Input",ExpressionUUID->"7421fae1-ac1f-43f9-ae7c-3b8a1ca32273",
 CellID->466743568],
Cell[CellGroupData[{
Cell[18445, 521, 1416, 37, 29, "ExampleSection",ExpressionUUID->"a94a48cb-8abb-48db-a4a8-9f8cbbd8820a",
 CellID->1996050386],
Cell[19864, 560, 229, 5, 28, "Input",ExpressionUUID->"1e11fcff-b05d-4068-b297-fa645cc693ef",
 CellID->311642837],
Cell[20096, 567, 196, 6, 37, "ExampleText",ExpressionUUID->"9d7cad13-c6ee-4034-bb15-70d23dbc9d5b",
 CellID->1521877654],
Cell[CellGroupData[{
Cell[20317, 577, 468, 13, 63, "Input",ExpressionUUID->"c3cb4a75-8750-4532-8f67-45e17beb33bd",
 CellID->2067036557],
Cell[20788, 592, 596, 19, 36, "Output",ExpressionUUID->"9bc5213a-0f87-4146-bd97-b38701d8a232",
 CellID->1974896852]
}, Open  ]],
Cell[21399, 614, 298, 7, 56, "ExampleText",ExpressionUUID->"0cb2d8bc-a08f-4c47-92b3-c9a8db63d431",
 CellID->489786172],
Cell[CellGroupData[{
Cell[21722, 625, 340, 9, 45, "Input",ExpressionUUID->"c478501b-4486-4c18-aa5e-d17f0c72fbd9",
 CellID->1692008167],
Cell[22065, 636, 448, 14, 36, "Output",ExpressionUUID->"839dd08c-2bd5-45ba-bf83-b04f3b0b4c89",
 CellID->1224459765]
}, Open  ]],
Cell[22528, 653, 171, 3, 37, "ExampleText",ExpressionUUID->"85124225-b41a-4476-a2d6-62f04fce3ead",
 CellID->745459262],
Cell[22702, 658, 263, 7, 28, "Input",ExpressionUUID->"5b5ab331-dc39-499d-87ab-c6c58c1aad39",
 CellID->776733676],
Cell[22968, 667, 169, 3, 37, "ExampleText",ExpressionUUID->"5e3bebba-5717-429a-bd09-f8f8c726984c",
 CellID->1666669546],
Cell[CellGroupData[{
Cell[23162, 674, 646, 19, 45, "Input",ExpressionUUID->"f0bae31a-6e06-4ef4-9358-2245858460c8",
 CellID->959780981],
Cell[23811, 695, 2399, 59, 221, "Output",ExpressionUUID->"71e314a4-5f75-41a2-acee-6c1d8e94dfec",
 CellID->230027356]
}, Open  ]],
Cell[26225, 757, 150, 1, 70, "ExampleText",ExpressionUUID->"6e89f723-53f1-415b-a4e3-58c341e31ac9",
 CellID->1833361766],
Cell[CellGroupData[{
Cell[26400, 762, 263, 6, 70, "Input",ExpressionUUID->"681a9289-c96d-460c-b267-7d4364bb4e8e",
 CellID->68546426],
Cell[26666, 770, 7388, 155, 70, "Output",ExpressionUUID->"897686bd-220f-42f7-9c29-63286a940198",
 CellID->375592456]
}, Open  ]],
Cell[34069, 928, 145, 1, 70, "ExampleText",ExpressionUUID->"9fd48db8-4cfa-4315-bef0-6938f96f62f8",
 CellID->88969382],
Cell[CellGroupData[{
Cell[34239, 933, 230, 5, 70, "Input",ExpressionUUID->"4b85ebc5-0bbe-414b-8936-a361ace5db7a",
 CellID->1551551898],
Cell[34472, 940, 2244, 52, 204, "Output",ExpressionUUID->"b462011b-5f1b-489d-a8fd-8df4a0ae74ee",
 CellID->902256453]
}, Open  ]],
Cell[36731, 995, 245, 4, 70, "ExampleText",ExpressionUUID->"bf37df37-f9c1-4c55-b4a3-8b3952164124",
 CellID->1436470908],
Cell[CellGroupData[{
Cell[37001, 1003, 429, 12, 70, "Input",ExpressionUUID->"ebb1ea6a-6d33-474d-a99d-edfa8966e75e",
 CellID->2003141392],
Cell[37433, 1017, 2399, 59, 221, "Output",ExpressionUUID->"8c4940af-782f-4e12-8329-0c2793475561",
 CellID->330995392]
}, Open  ]],
Cell[39847, 1079, 3057, 92, 70, "ExampleText",ExpressionUUID->"63bd978e-06e4-4793-873c-edc8481cd028",
 CellID->763152763],
Cell[CellGroupData[{
Cell[42929, 1175, 310, 7, 70, "Input",ExpressionUUID->"a93ae4db-6aa9-4871-ad00-246b248c16fb",
 CellID->39073415],
Cell[43242, 1184, 7039, 157, 209, "Output",ExpressionUUID->"a2a5b169-e443-4ce7-b73a-e1abd2062308",
 CellID->1016200793],
Cell[50284, 1343, 11907, 243, 213, "Output",ExpressionUUID->"534a51b3-fa14-4abc-8f18-ba7d3152023b",
 CellID->349283360]
}, Open  ]],
Cell[62206, 1589, 184, 3, 70, "ExampleText",ExpressionUUID->"5441af8f-c8d0-4696-8607-4e1dcca82b9d",
 CellID->532372496],
Cell[CellGroupData[{
Cell[62415, 1596, 458, 13, 70, "Input",ExpressionUUID->"d21b8612-66a3-40a6-8033-20feddd6896e",
 CellID->1651031722],
Cell[62876, 1611, 2540, 61, 221, "Output",ExpressionUUID->"735d2c07-3228-4f00-8725-ce64b7f9027a",
 CellID->142883923]
}, Open  ]],
Cell[CellGroupData[{
Cell[65453, 1677, 256, 7, 70, "Input",ExpressionUUID->"ad0cc927-3da0-4792-b16d-87e559de1842",
 CellID->1011213466],
Cell[65712, 1686, 6516, 115, 535, "Output",ExpressionUUID->"66892ea0-96bf-4c10-83c4-59abe3dca687",
 CellID->1991411206]
}, Open  ]],
Cell[72243, 1804, 183, 3, 70, "ExampleText",ExpressionUUID->"5517c82a-c4e3-4e4e-a933-b435adfa57ef",
 CellID->73177469],
Cell[CellGroupData[{
Cell[72451, 1811, 302, 8, 70, "Input",ExpressionUUID->"e8487b53-be54-4294-9fe6-75ed04402688",
 CellID->264598071],
Cell[72756, 1821, 116, 1, 70, "EchoTiming",ExpressionUUID->"d64f2ee4-ee98-4ca0-a059-ecc8965f5bb1",
 CellID->1671930460],
Cell[72875, 1824, 6361, 153, 48, "Output",ExpressionUUID->"b3b26a16-8468-4a92-9b83-a0a09c9e1dc6",
 CellID->311720225]
}, Open  ]],
Cell[CellGroupData[{
Cell[79273, 1982, 399, 10, 70, "Input",ExpressionUUID->"15cc2578-c4f4-41bd-ad0f-70767c6e7439",
 CellID->1548810753],
Cell[79675, 1994, 6515, 115, 535, "Output",ExpressionUUID->"08a2083a-5648-4c9a-b5fa-2ba9e9b72735",
 CellID->255013269]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[86339, 2117, 1412, 37, 70, "ExampleSection",ExpressionUUID->"b169a046-4ea5-4db1-af6e-64676768e95c",
 CellID->651243633],
Cell[CellGroupData[{
Cell[87776, 2158, 1420, 37, 70, "ExampleSubsection",ExpressionUUID->"179bf208-e8b4-4946-9c39-ee09d55020e4",
 CellID->1875074719],
Cell[89199, 2197, 229, 5, 70, "Input",ExpressionUUID->"123b2022-ea12-445b-bc48-5dbc03fc14fc",
 CellID->376599101],
Cell[89431, 2204, 195, 6, 70, "ExampleText",ExpressionUUID->"71437043-8ce2-45de-bccb-7004f5e180ab",
 CellID->866782798],
Cell[CellGroupData[{
Cell[89651, 2214, 340, 9, 70, "Input",ExpressionUUID->"9630e648-2915-4bdf-8f6b-951366a44da5",
 CellID->1636908385],
Cell[89994, 2225, 595, 19, 36, "Output",ExpressionUUID->"4f1e3a4e-9d00-4d86-9c2f-8b46e997de75",
 CellID->403831826]
}, Open  ]],
Cell[90604, 2247, 298, 7, 70, "ExampleText",ExpressionUUID->"16b82599-0e7e-484c-b08b-dc2868d40a18",
 CellID->764294589],
Cell[CellGroupData[{
Cell[90927, 2258, 340, 9, 70, "Input",ExpressionUUID->"ea494152-9833-4434-82d3-6fa5db91a0e7",
 CellID->1399464616],
Cell[91270, 2269, 281, 8, 36, "Output",ExpressionUUID->"2c8dc63f-7d2b-47ea-aba1-fd18ab1e59b7",
 CellID->659474466]
}, Open  ]],
Cell[91566, 2280, 171, 3, 70, "ExampleText",ExpressionUUID->"603891f7-14e4-448a-91d4-cf146a604d77",
 CellID->372084824],
Cell[91740, 2285, 263, 7, 70, "Input",ExpressionUUID->"2e652a43-1815-4cbd-82dd-3b5ca9adb9e3",
 CellID->157256904],
Cell[92006, 2294, 169, 3, 70, "ExampleText",ExpressionUUID->"8deb4abc-6a50-4c8f-82ef-de45fbe999de",
 CellID->1611899718],
Cell[CellGroupData[{
Cell[92200, 2301, 646, 19, 70, "Input",ExpressionUUID->"b1acf3b7-e0a1-4bc0-9444-11acd2b2f116",
 CellID->692353521],
Cell[92849, 2322, 2400, 59, 221, "Output",ExpressionUUID->"97c5a78a-8ed7-4c3b-8dc7-46d0e4f8a7da",
 CellID->1440034375]
}, Open  ]],
Cell[95264, 2384, 150, 1, 70, "ExampleText",ExpressionUUID->"26005c72-69a1-4504-b391-94da1c016c03",
 CellID->1643841179],
Cell[CellGroupData[{
Cell[95439, 2389, 264, 6, 70, "Input",ExpressionUUID->"fd5a7788-83ca-4fea-8523-0231ab84b930",
 CellID->661576798],
Cell[95706, 2397, 6912, 145, 70, "Output",ExpressionUUID->"e9ab5767-e908-42b3-8bb4-2634da8a028f",
 CellID->469594900]
}, Open  ]],
Cell[102633, 2545, 147, 1, 70, "ExampleText",ExpressionUUID->"66cc5797-a5cb-45c5-9a25-af2a8883ee86",
 CellID->1494129546],
Cell[CellGroupData[{
Cell[102805, 2550, 230, 5, 70, "Input",ExpressionUUID->"f9d583fb-7129-4e7a-b3ce-b12f3fa000d6",
 CellID->1308995251],
Cell[103038, 2557, 2194, 50, 170, "Output",ExpressionUUID->"84f90627-c77b-4de9-8b12-06b5ce422493",
 CellID->1942813907]
}, Open  ]],
Cell[CellGroupData[{
Cell[105269, 2612, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"ef2b0cd9-2f7b-437a-9408-1df44b6e052e",
 CellID->271351881],
Cell[CellGroupData[{
Cell[105536, 2621, 541, 11, 70, "Input",ExpressionUUID->"eba9a383-53ce-4191-a151-cd0243830a95",
 CellID->1522210377],
Cell[106080, 2634, 2192, 50, 170, "Output",ExpressionUUID->"f3636a4b-0eab-4571-86e1-62f3383b5475",
 CellID->14958706],
Cell[108275, 2686, 7004, 156, 175, "Output",ExpressionUUID->"d2f38512-8efb-49a0-88c2-80867fd62527",
 CellID->155385043],
Cell[115282, 2844, 12019, 249, 177, "Output",ExpressionUUID->"e7d9fc72-7fd6-4ab1-93a0-f41ac51df6a1",
 CellID->216302949]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127350, 3099, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"54894bb6-fd7a-4527-a283-51bc1f6487f6",
 CellID->2088356695],
Cell[CellGroupData[{
Cell[127618, 3108, 696, 16, 70, "Input",ExpressionUUID->"98b71f21-4a45-4668-b233-8cd0c3900d9e",
 CellID->678008436],
Cell[128317, 3126, 2215, 51, 170, "Output",ExpressionUUID->"d4e53767-8a11-469b-a427-e81031fe5cd9",
 CellID->1777171622],
Cell[130535, 3179, 6996, 156, 175, "Output",ExpressionUUID->"ae03c329-6b3a-4bb1-9797-297de0e172b7",
 CellID->1720888478],
Cell[137534, 3337, 11795, 241, 177, "Output",ExpressionUUID->"2567c1bc-4327-4d55-a0d9-6bb52819d165",
 CellID->662891950]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[149698, 3591, 884, 22, 70, "SeeAlsoSection",ExpressionUUID->"e9336ee8-1fe4-4f8c-8e30-8570fbee8579"],
Cell[150585, 3615, 1813, 45, 70, "TechNotesSection",ExpressionUUID->"cddcd0b1-23d8-448c-9b81-8a3646d784dd"],
Cell[152401, 3662, 1083, 27, 70, "MoreAboutSection",ExpressionUUID->"23327d9b-ec52-4e39-b427-d515480a21e1"],
Cell[153487, 3691, 4834, 128, 70, "RelatedLinksSection",ExpressionUUID->"fc2d0e78-2d7b-4782-adc3-a111f32a99c6"],
Cell[158324, 3821, 78, 0, 70, "FooterCell",ExpressionUUID->"95a0b34b-3a5a-4e9e-93fb-5841d92cb963"]
}
]
*)

(* End of internal cache information *)

