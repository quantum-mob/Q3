(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    197778,       5014]
NotebookOptionsPosition[    178150,       4617]
NotebookOutlinePosition[    180731,       4680]
CellTagsIndexPosition[    180644,       4675]
WindowTitle->BravyiDensityMatrix
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "53bb2cce-1c2d-43d1-9ffe-bc626e407559"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "c4943af3-15fb-40d8-a48b-c326f4c5db5e"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "d14596dc-7f80-43f7-9319-56f22e807122"]
         }],ExpressionUUID->"813d0ba5-56bf-425c-b077-1718fa51f850"],
         StripOnInput->False],{
        StyleBox["\"BravyiGreen\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/BravyiGreen"], 
         StyleBox["\"BravyiState\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/BravyiState"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "a7c60178-e757-4a82-946a-dc8820948832"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "ed84c800-0e61-463c-b747-755a6887b1be"]
         }],ExpressionUUID->"6d4a09be-5861-4e06-b16e-d58dc175597e"],
         StripOnInput->False],{
        "\"Fermionic Quantum Computation\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/FermionicQuantumComputation"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "0fd2c7f7-e0ea-4022-b8a5-629689d7f0ff"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "3710dd3b-59ed-49ee-a2e2-ddb3a2d4b69d"]
         }],ExpressionUUID->"84f896f1-fbc3-4da4-84e6-255da7c8bc9b"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "03745c23-7f08-4ce1-846e-ff82d0d6bfd6"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "110b71a4-1238-4495-aeee-329e02af6a43"]
         }],ExpressionUUID->"193ff0c2-9639-4938-9ad9-635b0474e144"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/BravyiDensityMatrix\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/BravyiDensityMatrix"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
BravyiDensityMatrix.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/BravyiDensityMatrix") <> ".html"], 
              None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "18a387ee-36d4-4905-bd00-6b6e12d166f5"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "b33093e5-ad1a-4c92-b1e5-f16a8fd53816"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"65e5acbc-1f57-4091-a7eb-02dbe2988c3c"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"6743855a-732c-4bf6-8b8b-67378ba86198"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "BravyiDensityMatrix", "ObjectName",ExpressionUUID->
      "26ed160a-5503-402c-b37c-b59e65dcdab9"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"5da9f0d8-5f8c-4582-90d1-1d085f7c5819"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "5c7f37db-317d-47ea-b8a8-3fee579c1099"]
    }],ExpressionUUID->"16f10c15-3a48-4300-a23f-beea709baba3"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.1\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->LightDarkSwitched[
              RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "fb4bcbdc-1777-4724-b46c-ce66a94d4b87"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"10526b93-6e69-4208-8361-bcf725ff9513"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["BravyiDensityMatrix"]], 
         "paclet:QuantumMob/Q3/ref/BravyiDensityMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["grn", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "533307b2-cb6c-40d8-93ce-12512860c4c2"],
     "\[LineSeparator]returns the density matrix corresponding to the \
single-particle Green's function ",
     Cell[BoxData[
      StyleBox["grn", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "527c08af-eb34-4ac5-a738-9b8ca5842d9e"],
     ", assuming that ",
     Cell[BoxData[
      StyleBox["grn", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "34dd806c-0965-4a79-b15c-4a0c16510917"],
     " is associated with a fermionic Gaussian state."
    }],ExpressionUUID->"e5a08b30-e834-4592-bee1-30ddd92bdd3d"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["BravyiDensityMatrix"]], 
         "paclet:QuantumMob/Q3/ref/BravyiDensityMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["ws", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "c5a12a44-56f3-490c-9f05-955976b42f30"],
     "\[LineSeparator]is a shortcut and returns the density matrix \
corresponding to the Bravyi or Nambu state ",
     Cell[BoxData[
      StyleBox["ws", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "fe198955-e995-46a4-a0c1-a7ce19c13ba5"],
     "."
    }],ExpressionUUID->"20c53aaa-050c-4425-84f3-dfdb4eb0788b"]}
  }]], "Usage",
 CellID->837314546,ExpressionUUID->"96abf360-bce5-4fac-896a-97c29183b796"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[CurrentValue[
         EvaluationCell[], "CellGroupOpen"] =!= Closed, 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"21ffd3cf-1957-4464-99f3-9511d23a1cb1"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"1e2df161-21ef-4c16-abdb-6d42ed87f600"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"f03de4ad-0704-46bc-95a6-0fef8f018794"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"b44da1bd-840d-4250-bc27-23e01b99b58b"]], \
"NotesSection",
 ShowGroupOpener->"Thumbnail",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->435106592,ExpressionUUID->"63c961a7-fcfb-4886-b4bf-f2a5caa033fe"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["BravyiDensityMatrix"]], 
    "paclet:QuantumMob/Q3/ref/BravyiDensityMatrix", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "a8778b09-e408-48af-adf8-8cc7f8fb102a"],
 " is intended for elementary tests, but not for practical calculations for \
large systems."
}], "Notes",
 CellID->285235831,ExpressionUUID->"c511b8a8-1186-49ce-a849-da0eaf1d2a4f"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"89fcd693-293f-4c4e-bec9-576863af7a5b"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"6b2d831d-996c-429d-a385-de3af09ddc17"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(5)", "ExampleCount",ExpressionUUID->
  "e580e3a1-00df-4c94-bb51-eb71952caaa6"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->654673709,ExpressionUUID->"afd4de03-79ac-4f78-aaeb-14995dd66e07"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1940205291,ExpressionUUID->"c3742214-427d-42e4-888c-a4bb2e65b1c5"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"cc01005b-db92-47b9-a10b-0578fbf59a98"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"20dd1026-2a5a-400a-a1ea-b1d9c48bc048"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "974eb28e-432e-409c-8a41-9b544904ea75"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1542303582,ExpressionUUID->"96e6bcdd-f926-408f-a5e6-05fdab20db54"],

Cell["Consider a few fermion modes:", "ExampleText",
 CellID->1579571379,ExpressionUUID->"3cedba60-3a10-4b75-b7fc-89d80841469a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->2144923147,ExpressionUUID->"c742f442-67db-4bfe-be23-ac5308836b2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "357", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1611621965,ExpressionUUID->"d6a26ccc-cde6-4562-aead-87d7d39150e3"],

Cell["Pick a Bravyi state (fermionic Gaussian state):", "ExampleText",
 CellID->1793530776,ExpressionUUID->"22874ae0-b020-40f3-b966-a578656e259c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ws", "=", 
  RowBox[{"RandomBravyiState", "[", "$n", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1279536004,ExpressionUUID->"2511ae66-6ac4-4df5-9ada-417bc4606a13"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BravyiState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Covariance matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{
                    "0", "0.1489988513511953`", "0.27755039339664933`", 
                    "0.824375870374534`", "\"\[Ellipsis]\""}, {
                    RowBox[{"-", "0.14899885135119534`"}], "0", 
                    RowBox[{"-", "0.9046672948367519`"}], 
                    "0.22907506773957562`", "\"\[Ellipsis]\""}, {
                    RowBox[{"-", "0.27755039339664933`"}], 
                    "0.9046672948367518`", "0", 
                    RowBox[{"-", "0.26712575441926795`"}], 
                    "\"\[Ellipsis]\""}, {
                    RowBox[{"-", "0.824375870374534`"}], 
                    RowBox[{"-", "0.2290750677395755`"}], 
                    "0.2671257544192679`", "0", "\"\[Ellipsis]\""}, {
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", 
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\""}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {5, 5}, 0, {
                    1, {{0, 4, 8, 12, 16, 21}, {{2}, {3}, {4}, {5}, {1}, {
                    3}, {4}, {5}, {1}, {2}, {4}, {5}, {1}, {2}, {3}, {5}, {
                    1}, {2}, {3}, {4}, {5}}}, {
                    0.1489988513511953, 0.27755039339664933`, 
                    0.824375870374534, 
                    "\[Ellipsis]", -0.14899885135119534`, -0.9046672948367519,
                     0.22907506773957562`, 
                    "\[Ellipsis]", -0.27755039339664933`, 
                    0.9046672948367518, -0.26712575441926795`, 
                    "\[Ellipsis]", -0.824375870374534, -0.2290750677395755, 
                    0.2671257544192679, "\[Ellipsis]", "\[Ellipsis]", 
                    "\[Ellipsis]", "\[Ellipsis]", "\[Ellipsis]", 
                    "\[Ellipsis]"}}], TableHeadings -> None, {}]]], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`BravyiState[{
   1, SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 5, 10, 15, 20, 25, 30}, {{2}, {3}, {4}, {5}, {6}, {1}, {3}, {
       4}, {5}, {6}, {1}, {2}, {4}, {5}, {6}, {1}, {2}, {3}, {5}, {6}, {1}, {
       2}, {3}, {4}, {6}, {1}, {2}, {3}, {4}, {5}}}, {0.1489988513511953, 
      0.27755039339664933`, 
      0.824375870374534, -0.33641658921820405`, -0.3286235296877096, \
-0.14899885135119534`, -0.9046672948367519, 
      0.22907506773957562`, -0.30359331215138496`, 
      0.12137603596196012`, -0.27755039339664933`, 
      0.9046672948367518, -0.26712575441926795`, -0.12010322782643197`, \
-0.13697412445322893`, -0.824375870374534, -0.2290750677395755, 
      0.2671257544192679, -0.24319800588375032`, 0.3707122859367387, 
      0.33641658921820405`, 0.303593312151385, 0.12010322782643196`, 
      0.24319800588375035`, 0.849167194323698, 
      0.3286235296877096, -0.12137603596196014`, 
      0.13697412445322882`, -0.3707122859367387, -0.849167194323698}}]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1374224457,ExpressionUUID->"c95d6daf-8a3e-462d-87f4-ecf632351b39"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", "ws", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->79841072,ExpressionUUID->"5fbcf907-54dd-4291-804d-b307e51dfbb3"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[4]=",
 CellID->1159916761,ExpressionUUID->"450fb4c3-c761-4152-95bb-8ec11083319d"]
}, Open  ]],

Cell["Calculate the Green's function:", "ExampleText",
 CellID->829017474,ExpressionUUID->"88ea997c-0398-4dd1-9100-e0b189fbb913"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"BravyiGreen", "[", "ws", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1228699821,ExpressionUUID->"e89806ff-1ec3-43c9-9e3c-7fe5c14ee6e4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.08781206481273302`", 
        RowBox[{"0.026835380369657137`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.023549788633138752`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.14893732102674437`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.16206566983334703`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.02683538036965711`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.023549788633138752`", " ", "\[ImaginaryI]"}]}], 
        "0.6517966560756925`", 
        RowBox[{
         RowBox[{"-", "0.0003182020338820396`"}], "+", 
         RowBox[{"0.013875025128263468`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.1489373210267444`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.16206566983334703`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.00031820203388204307`"}], "-", 
         RowBox[{"0.01387502512826344`", " ", "\[ImaginaryI]"}]}], 
        "0.5684870622266145`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{
         RowBox[{"-", "0.1413729142394449`"}], "-", 
         RowBox[{"0.09804921430873641`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.015374443817110423`"}], "+", 
         RowBox[{"0.023290473135022347`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.14137291423944492`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.09804921430873642`", " ", "\[ImaginaryI]"}]}], "0", 
        RowBox[{"0.06036981594709802`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.43845862229011245`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.015374443817110409`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.023290473135022347`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.06036981594709803`"}], "-", 
         RowBox[{"0.43845862229011245`", " ", "\[ImaginaryI]"}]}], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->976797241,ExpressionUUID->"9cae8822-49f3-48b0-8814-0820c2168526"]
}, Open  ]],

Cell["Calculate the density matrix:", "ExampleText",
 CellID->1287199281,ExpressionUUID->"ed74145d-5dc5-428e-ad6f-4a461a6a3e5b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"BravyiDensityMatrix", "[", "grn", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayShort", "[", 
  RowBox[{"rho", ",", 
   RowBox[{"\"\<Size\>\"", "->", "8"}]}], "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1625237059,ExpressionUUID->"f9bd32de-39c9-4c23-9054-8ad5688baba0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0.08556082933090559`", 
      RowBox[{"0.0003182020338819575`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.013875025128263368`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{
       RowBox[{"-", "0.14893732102674423`"}], "-", 
       RowBox[{"0.16206566983334697`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.14137291423944495`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.09804921430873648`", " ", "\[ImaginaryI]"}]}]},
     {"0", 
      RowBox[{"0.0003182020338819369`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.013875025128263396`", " ", "\[ImaginaryI]"}]}], 
      "0.002251235481827318`", "0", 
      RowBox[{
       RowBox[{"-", "0.0268353803696571`"}], "+", 
       RowBox[{"0.023549788633138863`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{
       RowBox[{"-", "0.015374443817110513`"}], "-", 
       RowBox[{"0.023290473135022357`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "0.14893732102674437`"}], "+", 
       RowBox[{"0.16206566983334714`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.026835380369657113`"}], "-", 
       RowBox[{"0.023549788633138842`", " ", "\[ImaginaryI]"}]}], "0", 
      "0.566235826744787`", "0", "0", 
      RowBox[{
       RowBox[{"-", "0.060369815947097956`"}], "+", 
       RowBox[{"0.4384586222901126`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"0.14137291423944492`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.09804921430873648`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.015374443817110494`"}], "+", 
       RowBox[{"0.023290473135022343`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{
       RowBox[{"-", "0.06036981594709791`"}], "-", 
       RowBox[{"0.43845862229011223`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0.34595210844248014`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->580600593,ExpressionUUID->"75fb087e-62ac-47cc-a921-ca39f8b5e15e"]
}, Open  ]],

Cell["\<\
Verify it by calculating the density matrix from the vector representation of \
the Gaussian state:\
\>", "ExampleText",
 CellID->2088378959,ExpressionUUID->"fd7d3a4d-fd3b-4d78-9448-790dfc615117"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"Matrix", "[", "ws", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alt", "=", 
   RowBox[{"Dyad", "[", 
    RowBox[{"vec", ",", "vec"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayShort", "[", 
  RowBox[{"rho", ",", 
   RowBox[{"\"\<Size\>\"", "->", "8"}]}], "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1687043485,ExpressionUUID->"95e8395a-ef8f-419f-bf5b-2c8f35380736"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0.08556082933090559`", 
      RowBox[{"0.0003182020338819575`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.013875025128263368`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{
       RowBox[{"-", "0.14893732102674423`"}], "-", 
       RowBox[{"0.16206566983334697`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.14137291423944495`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.09804921430873648`", " ", "\[ImaginaryI]"}]}]},
     {"0", 
      RowBox[{"0.0003182020338819369`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.013875025128263396`", " ", "\[ImaginaryI]"}]}], 
      "0.002251235481827318`", "0", 
      RowBox[{
       RowBox[{"-", "0.0268353803696571`"}], "+", 
       RowBox[{"0.023549788633138863`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{
       RowBox[{"-", "0.015374443817110513`"}], "-", 
       RowBox[{"0.023290473135022357`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "0.14893732102674437`"}], "+", 
       RowBox[{"0.16206566983334714`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.026835380369657113`"}], "-", 
       RowBox[{"0.023549788633138842`", " ", "\[ImaginaryI]"}]}], "0", 
      "0.566235826744787`", "0", "0", 
      RowBox[{
       RowBox[{"-", "0.060369815947097956`"}], "+", 
       RowBox[{"0.4384586222901126`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"0.14137291423944492`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.09804921430873648`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.015374443817110494`"}], "+", 
       RowBox[{"0.023290473135022343`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{
       RowBox[{"-", "0.06036981594709791`"}], "-", 
       RowBox[{"0.43845862229011223`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0.34595210844248014`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1409814138,ExpressionUUID->"64173312-e776-4076-ab7e-b73ed4a78274"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rho", "-", "alt"}], "//", "ArrayZeroQ"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1578285105,ExpressionUUID->"7df7a892-f550-4c33-955d-b21c5a035c00"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[8]=",
 CellID->1217362739,ExpressionUUID->"88bfb625-11fb-4a70-b76e-0ac67819de38"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"388c5689-73d4-4d74-9d81-f3a21f6fdba1"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"5327f695-bc4d-4ec1-8c85-ad9a36392b74"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(4)", "ExampleCount",ExpressionUUID->
  "ba3d6f48-76b7-4f02-b0a1-72d33dc6aa8a"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->65633975,ExpressionUUID->"63316f9f-9e5e-4218-a995-27c021fc9625"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"d19c2d0d-07f0-4d7a-9172-34e7022473a2"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"f9a27c7c-3808-47a1-b354-a85f20401ba3"],
 "Manifestly Gaussian: without pairing",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "b947f786-e43c-474f-875d-3f7c69ea1e88"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->497423321,ExpressionUUID->"ab566b27-a363-41ea-b66c-5e0cb93a3e43"],

Cell["\<\
Here, we construct a manifestly Gaussian state, and calculate the density \
matrix using the Bravyi tools.\
\>", "ExampleText",
 CellID->1625303001,ExpressionUUID->"56eafeaf-55d4-4ef3-995b-51d8ee0dcc12"],

Cell["Consider some fermion modes:", "ExampleText",
 CellID->2146590148,ExpressionUUID->"8963b758-1630-4b0e-8039-210d128dade3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$N", "=", 
   RowBox[{"Power", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1998991449,ExpressionUUID->"a0b0022a-74f4-4d1c-ab9f-ccfeb9b15c02"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "[", 
   RowBox[{"Range", "@", "$n"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1412231210,ExpressionUUID->"6d4e537b-8fb1-4c5e-887d-57b8c03c92fa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1671700638,ExpressionUUID->"218c9de2-2dbb-4866-a237-fa0a7453461a"]
}, Open  ]],

Cell["Construct a Gaussian density matrix:", "ExampleText",
 CellID->1531256439,ExpressionUUID->"f07443fc-0d1f-42ff-b1cc-909d86f17be1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "357", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1340151952,ExpressionUUID->"b260d9f7-6c76-49ea-b507-912a08e90906"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ham", "=", 
   RowBox[{"RandomHermitian", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ham", "=", 
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "@", "cc"}], ",", 
     RowBox[{"ham", ".", "cc"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"Matrix", "[", 
     RowBox[{"ham", ",", "cc"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "/=", 
  RowBox[{"Tr", "[", "rho", "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1713041365,ExpressionUUID->"4245cd0f-8207-47ef-a41e-4a39fe85882c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtkPNnH1
1bNydW9ftD9fmqHFlfPEftMaHpGoS++oZr5KzjX3Z1Mv2hsc1Wd/fP2Y/Rq/
AOvPbc9wqg/ZxmH9PPWyfff7z2G69evsfa3ZXy8Temy/s9vAdeeWF/Y33Jev
q5n21v5kRO6/+K/vaR4+HFs/i2WnXbKPkAm61bjqgP2WUh45J4OnONWv/Tcp
65H4Q/vcmIcNzxpe2qfMvZ6d3f/e3rKBlbHf97I91/nnMcqLN9u7l66akLzl
Mcnu2f9t2gXDhgv2UTPFFL4LnrevT6veGuH/wv6HOq9i1/fz9m1SFrO962/b
Vzc0VJxmf4PTnKbk1sWXTl6z9ylo3alU9My+K2rpRHFn2ocnqeLTjs3Z0ZN6
wd4w0u6pUeE9+5aQ+xtLl+L2l221hxrfoUv2UlrTdos9320v+nKR8oqZT+zf
L220cLa6aF9zZlvzzb6T9l63d5r2yj4n2T2Bc6z/hj0+Z6/9xKf6dNdle2WD
LNeP3K/sO2Rd2jbLXrQXX/JH8OqJh/ZzPjhwftj+Fqc5pMYXtcS7pmnnp527
YK9um6Btu+6BvY3MYue9jm/td2s8lZ4767x9awKnbYD+JfuWxQze4aUvcZrz
Zc/r+1duX7Dnn9S/mCH6jP2Dm4K79+0gPTxxiQvqdNxXtDxvf4J/tuLRGzfs
f4n6X3xS+XrQpU9c4gAyqh1i
              "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> False, 
             Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["20", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtkPNnH1
1bNydW9ftD9fmqHFlfPEftMaHpGoS++oZr5KzjX3Z1Mv2hsc1Wd/fP2Y/Rq/
AOvPbc9wqg/ZxmH9PPWyfff7z2G69evsfa3ZXy8Temy/s9vAdeeWF/Y33Jev
q5n21v5kRO6/+K/vaR4+HFs/i2WnXbKPkAm61bjqgP2WUh45J4OnONWv/Tcp
65H4Q/vcmIcNzxpe2qfMvZ6d3f/e3rKBlbHf97I91/nnMcqLN9u7l66akLzl
Mcnu2f9t2gXDhgv2UTPFFL4LnrevT6veGuH/wv6HOq9i1/fz9m1SFrO962/b
Vzc0VJxmf4PTnKbk1sWXTl6z9ylo3alU9My+K2rpRHFn2ocnqeLTjs3Z0ZN6
wd4w0u6pUeE9+5aQ+xtLl+L2l221hxrfoUv2UlrTdos9320v+nKR8oqZT+zf
L220cLa6aF9zZlvzzb6T9l63d5r2yj4n2T2Bc6z/hj0+Z6/9xKf6dNdle2WD
LNeP3K/sO2Rd2jbLXrQXX/JH8OqJh/ZzPjhwftj+Fqc5pMYXtcS7pmnnp527
YK9um6Btu+6BvY3MYue9jm/td2s8lZ4767x9awKnbYD+JfuWxQze4aUvcZrz
Zc/r+1duX7Dnn9S/mCH6jP2Dm4K79+0gPTxxiQvqdNxXtDxvf4J/tuLRGzfs
f4n6X3xS+XrQpU9c4gAyqh1i
              "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> False, 
             Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["20", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.3125`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.025054727721722826`", "\[VeryThinSpace]"}], 
                    "-", 
                    
                    RowBox[{
                    "6.855577543667292`*^-19", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.0643522198329772`", "\[VeryThinSpace]"}], "-", 
                    
                    
                    RowBox[{
                    "6.01848968479367`*^-18", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.0010098844468969075`"}], "-", 
                    RowBox[{"0.05705729158334501`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "5"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.01963278418126318`"}], "-", 
                    RowBox[{"0.06008657978151958`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {8, 8}, Complex[0., 0.], {
   1, {{0, 1, 4, 7, 10, 13, 16, 19, 20}, {{1}, {2}, {3}, {5}, {2}, {3}, {5}, {
     4}, {6}, {7}, {2}, {3}, {5}, {4}, {6}, {7}, {4}, {6}, {7}, {
     8}}}, CompressedData["
1:eJxTTMoPShNhYGAoZgESPpnFJWlMIB47kHDOzy3ISa0o4tLfHPBp+Uz7IrvD
6z+88NLcg6nErW+2eHLlBvuizICzTxIORmNRsmEDi/bh7oD9RV7TNjHNNVu7
H1NJ38rP1+dKTdlflKqix7f68DosSmrRTLHHVHLuTL5Y2Y+N9kUL/R7q122M
xOIWpXIrkdu5i+yLFmV9Tt4zbQEWi+pFrLWvHF5pX5Q+oWLaZOFALKbIcSyQ
S1Rcvr9oSmrr0ytflmAxZe/Rjn2ftwF9FKmr/bWiaBsW53bBPJ0M8TQWJXDn
LoA4F4uSQ194i513HrIvui9bNv9IWiIW58rCnDsZ4lwspjBccnwfvva0fVEi
06UJxalZNphK2mO8hOtj1uwv2m3ZamwYfgaLpw/APB0L8TQWJb0wU/ZBTMHi
lpz6ZXOkbK/YFyVNl7p/JL8Qi1v2HP7wYV7DHvuiyr8ntZ0lffYAABM7Aco=

    "]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->2117725931,ExpressionUUID->"b17beb80-5997-46e9-b8dc-72b51eb20081"]
}, Open  ]],

Cell["Check the density matrix:", "ExampleText",
 CellID->1114864780,ExpressionUUID->"8422338f-8566-4377-97cc-e8869e252c71"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tr", "[", "rho", "]"}], "//", "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eigenvalues", "[", "rho", "]"}], "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1726168276,ExpressionUUID->"5b64c4a6-b67d-44e3-a380-580979577e22"],

Cell[BoxData["1.`"], "Output",
 CellLabel->"Out[5]=",
 CellID->1819883667,ExpressionUUID->"5218cb9b-134a-4cb1-881f-7a802d607c66"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5242705365183049`", ",", "0.2141780982887552`", ",", 
   "0.1113375986322031`", ",", "0.06132959275452351`", 
   ",", "\<\"\[Ellipsis]\"\>"}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->175207048,ExpressionUUID->"8d7cfd62-eca4-49d9-b0c7-548cc9b2debf"]
}, Open  ]],

Cell["Calculate the Green's functions:", "ExampleText",
 CellID->1488178613,ExpressionUUID->"3f189d30-c46c-4d18-99c3-0c5d8dcf3f35"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Multiply", ",", "cc", ",", 
     RowBox[{"Dagger", "@", "cc"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"ops", ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ops", "//", "Dimensions"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1543102090,ExpressionUUID->"85620a6a-509e-42e3-92f9-0ae42c69b17d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3", ",", "8", ",", "8"}], "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->2891139,ExpressionUUID->"60362807-7161-41a6-878e-f965c3bc6f99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"#", ".", "rho"}], "]"}], "&"}], ",", "ops", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "Dimensions"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1147281361,ExpressionUUID->"3934c719-c6b8-47f4-abff-25d6adcf269e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3"}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->296362582,ExpressionUUID->"902db2d4-3e87-4a54-906f-d9ec813134ed"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.2099265958729045`", 
      RowBox[{"0.009182156342633939`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.07333044072984798`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0005963727938047211`"}], "-", 
       RowBox[{"0.14777079137479474`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.009182156342633946`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.073330440729848`", " ", "\[ImaginaryI]"}]}], 
      "0.45191326374324897`", 
      RowBox[{"0.056403075884421956`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2784681861264695`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.0005963727938046968`"}], "+", 
       RowBox[{"0.1477707913747947`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.05640307588442192`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.27846818612646945`", " ", "\[ImaginaryI]"}]}], 
      "0.5577604778395644`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->951338281,ExpressionUUID->"5cd22425-88f3-4307-972b-3d9c30262649"]
}, Open  ]],

Cell["Reproduce the density matrix from the Green's functions:", "ExampleText",
 CellID->1295948158,ExpressionUUID->"34ea92ab-5eb7-42dc-a520-d9afbcbf8d0e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"BravyiDensityMatrix", "[", "grn", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "-", "rho"}], "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->916462759,ExpressionUUID->"a95f1d59-4bb4-4e01-a34e-bfd8d5564cc7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->209719098,ExpressionUUID->"658309a5-03a2-43ef-a529-cdb876439e48"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "-", "rho"}], "//", "ArrayZeroQ"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1292850891,ExpressionUUID->"ef071611-179d-4717-b21a-e0f9ba7de426"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[9]=",
 CellID->1017975932,ExpressionUUID->"55fbda9c-27fd-4313-82bc-9d25b1726c1a"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"1c876b00-a208-4495-ba7f-2d6e49fd0f39"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"8d98880c-3ecb-4b1c-8692-84077cf6a722"],
 "Manifestly Gaussian: with pairing",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "c673d6de-f33f-4c7b-ba6f-5829d157ea96"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1882279022,ExpressionUUID->"962af4a5-e0d7-40ab-986d-8aaceca31d40"],

Cell["Consider some fermion modes:", "ExampleText",
 CellID->707366989,ExpressionUUID->"d7a886f0-d345-42ef-abe3-93bb8b056a20"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$N", "=", 
   RowBox[{"Power", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->297536878,ExpressionUUID->"b088bf6d-d5b0-4087-8106-af1a05ea3957"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "[", 
   RowBox[{"Range", "@", "$n"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ccdd", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"cc", ",", 
    RowBox[{"Dagger", "@", "cc"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->891360236,ExpressionUUID->"2659cb6a-9624-4964-a853-22201869478c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->816483153,ExpressionUUID->"518058e9-6500-4db2-abc4-ea4e02211a87"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    QuantumMob`Q3`Dagger[
     $CellContext`c[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    QuantumMob`Q3`Dagger[
     $CellContext`c[2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    QuantumMob`Q3`Dagger[
     $CellContext`c[3]]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->211848141,ExpressionUUID->"11b1ea65-6e1a-4fb5-9840-06b16d986a10"]
}, Open  ]],

Cell["Construct a Gaussian density matrix:", "ExampleText",
 CellID->1215678238,ExpressionUUID->"85a89cdc-4c5e-4800-bc31-8ab8713bee4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "357", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->638652385,ExpressionUUID->"467a5579-c18e-4a81-8c29-a2561b72048f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ham", "=", 
   RowBox[{"RandomNambuHermitian", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ham", "=", 
   RowBox[{
    RowBox[{"MultiplyDot", "[", 
     RowBox[{
      RowBox[{"Dagger", "@", "ccdd"}], ",", 
      RowBox[{
       RowBox[{"Normal", "[", "ham", "]"}], ".", "ccdd"}]}], "]"}], "/", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"Matrix", "[", 
     RowBox[{"ham", ",", "cc"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "/=", 
  RowBox[{"Tr", "[", "rho", "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1523597312,ExpressionUUID->"03ccb234-58e0-43ed-ad82-f6c5d489bf00"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJyVVH1MzHEcPhQVYyr9HJPOSSmlJtpdeLw1r3kPHdV6IevHEMkkHS421KEi
Ra2YTiXFadLrdJbe7n53Xa+rKafrrrvuYgtjXmbz7/eP++O7fffs2ef7fD7P
8/1wIk/sPjyJxWLZ/D//7vyEqrDsBXI8WFYg9f+uhq6Ao9lVNAKXEuc++7JO
rNzJOsantZDU+yyk15khK6fTPcRKVE8szvUM1YAbHPd0eoQJpDqcnJb1dfYq
ZHt/e7HHewj54QfjRVwzkU/ChYv0P7q8tagPklp9DTDiml9ea2a7GRL3gfFk
RyUEmsFhO8kgOkOTZvKKRi2u70gvnXUmTw6bFKrZ5VUnJn0ZCQmdYiDyTTvu
3HYRKxA3L/EoFaiC1dS3uY0X9ai84RNYKdWhe2Nh6YW7o2g6cPx3+Di53+3L
OeJSfwaxF4qjtnr0Q/3HZsLsCKPF+lvjHIJSxAxyRWv1VQ/luOGqyHNfoSPy
r99n73kX9wGlAV4/e2Q6zI+X8mclmdHMyzp9ebkCRu0aI8uswtmmqyr6vd5i
PYZ1WmdlhQLJSU7uhVm9KI91psVdBvjmSJgaNYMYO1uPTtkANvXU6n22kv3K
LBlfVbi/F7te8iV+R4Zxk1L7fhJYnh9SDmN8uT4BI3IY5J/csuu60GFbX0eB
7DsJF49K4mXXGTjUJf0+ff4DrmXnNpn6yD6+iXFaXRHJ4BbVNpb2WYFfmvT2
1mQdLnVZJ9RGyeE1X9AQMtCBYH9tbX8v+V0Szp59r+rUZAbbw94bnuxTolhn
vfAkpQc9RyTqv9IOx8WZDw/cHkJ/mHDlEi/yPH9G1+RlfWGwrybmGW/pIL6m
N4jKEiz/X6mJwkjrZ0oUvbJdIG7UQDkjYUNaKnlvlGBoC7uqDxO6PXkBdjqk
qFjSj7FmeHIzmtcsY6DOmHi0poQBz2PtWEsbOechz6uFcxMVeEyFcAYaemBV
xmZmFFvu7yMq8fjmcx2wjuWW36W0eJ0v3Lieb8beYdvkaIESg99N8rn5H+EY
NKw5bE/ui4T/kG2Tj7kq0OhX4B2R0Y0rMpngHk3WKaKn1bezGYidTIdEwX1w
C7Q6kuVntHgf/gU8WhoB
              "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> False, 
             Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["32", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJyVVH1MzHEcPhQVYyr9HJPOSSmlJtpdeLw1r3kPHdV6IevHEMkkHS421KEi
Ra2YTiXFadLrdJbe7n53Xa+rKafrrrvuYgtjXmbz7/eP++O7fffs2ef7fD7P
8/1wIk/sPjyJxWLZ/D//7vyEqrDsBXI8WFYg9f+uhq6Ao9lVNAKXEuc++7JO
rNzJOsantZDU+yyk15khK6fTPcRKVE8szvUM1YAbHPd0eoQJpDqcnJb1dfYq
ZHt/e7HHewj54QfjRVwzkU/ChYv0P7q8tagPklp9DTDiml9ea2a7GRL3gfFk
RyUEmsFhO8kgOkOTZvKKRi2u70gvnXUmTw6bFKrZ5VUnJn0ZCQmdYiDyTTvu
3HYRKxA3L/EoFaiC1dS3uY0X9ai84RNYKdWhe2Nh6YW7o2g6cPx3+Di53+3L
OeJSfwaxF4qjtnr0Q/3HZsLsCKPF+lvjHIJSxAxyRWv1VQ/luOGqyHNfoSPy
r99n73kX9wGlAV4/e2Q6zI+X8mclmdHMyzp9ebkCRu0aI8uswtmmqyr6vd5i
PYZ1WmdlhQLJSU7uhVm9KI91psVdBvjmSJgaNYMYO1uPTtkANvXU6n22kv3K
LBlfVbi/F7te8iV+R4Zxk1L7fhJYnh9SDmN8uT4BI3IY5J/csuu60GFbX0eB
7DsJF49K4mXXGTjUJf0+ff4DrmXnNpn6yD6+iXFaXRHJ4BbVNpb2WYFfmvT2
1mQdLnVZJ9RGyeE1X9AQMtCBYH9tbX8v+V0Szp59r+rUZAbbw94bnuxTolhn
vfAkpQc9RyTqv9IOx8WZDw/cHkJ/mHDlEi/yPH9G1+RlfWGwrybmGW/pIL6m
N4jKEiz/X6mJwkjrZ0oUvbJdIG7UQDkjYUNaKnlvlGBoC7uqDxO6PXkBdjqk
qFjSj7FmeHIzmtcsY6DOmHi0poQBz2PtWEsbOechz6uFcxMVeEyFcAYaemBV
xmZmFFvu7yMq8fjmcx2wjuWW36W0eJ0v3Lieb8beYdvkaIESg99N8rn5H+EY
NKw5bE/ui4T/kG2Tj7kq0OhX4B2R0Y0rMpngHk3WKaKn1bezGYidTIdEwX1w
C7Q6kuVntHgf/gU8WhoB
              "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> False, 
             Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["32", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.5`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.058544827668892525`", "\[VeryThinSpace]"}], 
                    "+", 
                    
                    RowBox[{
                    "6.106769328167756`*^-18", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.003046407929773202`", "\[VeryThinSpace]"}], 
                    "-", 
                    RowBox[{"0.01547227318121875`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "6"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.016507953899620398`", "\[VeryThinSpace]"}], 
                    "-", 
                    RowBox[{"0.007584355345183995`", " ", "\[ImaginaryI]"}]}],
                     ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.046645033333915474`", "\[VeryThinSpace]"}], 
                    "-", 
                    RowBox[{"0.06632331561932078`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {8, 8}, Complex[0., 0.], {
   1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{1}, {4}, {6}, {7}, {2}, {3}, {
     5}, {8}, {2}, {3}, {5}, {8}, {1}, {4}, {6}, {7}, {2}, {3}, {5}, {8}, {
     1}, {4}, {6}, {7}, {1}, {4}, {6}, {7}, {2}, {3}, {5}, {
     8}}}, CompressedData["
1:eJxTTMoPSlNgYGAoZgESPpnFJWlMIB47kHDOzy3ISa0oOqmbUDDt51r7olM+
CcdnasbYYCqxadp+9viXDPuiJczlUW/X9+/HVPJhQy1H2fMJ9kVCBZsfHRWo
x6LE2T1x5u2Hy+2Lzkn2TJ/wawMWJcvM8gxtluyzL9ry6PnkfTNq9mAqeWCS
rhVdPG1/UfCSrV+iqrdjMUXVp7nP/We1fVEH28uAO7s3Y1Gi82vW1ucvt9sX
KX/qV9rptw+Lkuswi0IgFtljKvHiPiEp2rXNvujHUu6VJp4xWJy7zbcpUcEF
6OmktefT3rqXYjHlxssDC8x2b7Avsr3oHZLxewcWJVKwCFgFiQAsSp4tEfRO
711gX2T8tE7SbnUIlmhk2v7/56s/QB8FbdV4tWfyTCyeVhZeGvGjyMu+qPIa
a0JE8SosFmnAQrcTErpYlGyFeToZ4mksFpVuzc8NL91jX6SWKh/p1R6Hxbk5
0y9GqssDQzfS5r3MJZMFWCz6DEt17JBUh0UJM5qnsShx+qcoK7PjgH2RbK91
m+2SdCxuecp/zNTm5KT9RRdzzdf06h7A4iMnWPI+D0neWCyyg4VuKSR0sZjy
CmbRBYhFWEwRbtP7KW583r7o2BLvA8E1pVicqwdL3vKQ5I3FlKtoqQ6LW9Aj
AIsSV+4GOYuFp+2LXrvsC86vKtwDAKr2m1o=
    "]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1893307887,ExpressionUUID->"1ae30c1e-3305-430e-8493-708073780924"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rho", "//", "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->947799548,ExpressionUUID->"6a1cd02d-1866-433b-a274-eb1b962851ba"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.058544827668892525`", "\[VeryThinSpace]", "+", 
       RowBox[{"6.106769328167756`*^-18", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.003046407929773202`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.01547227318121875`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.016507953899620398`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.007584355345183995`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.046645033333915474`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.06632331561932078`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.11969352919387663`", "\[VeryThinSpace]", "-", 
       RowBox[{"2.480364697121887`*^-17", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.021924423659403725`"}], "-", 
       RowBox[{"0.09172600244859667`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.006829528349231705`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.07708527541492505`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09341285880780309`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.11838872045331832`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.021924423659403693`"}], "+", 
       RowBox[{"0.09172600244859669`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.08804447059087042`", "\[VeryThinSpace]", "-", 
       RowBox[{"6.1335398094976944`*^-18", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04544163885398282`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.005195548391366019`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.06535664963386212`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.09758617456447367`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.0030464079297731874`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.01547227318121876`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.03232882300728494`", "\[VeryThinSpace]", "+", 
       RowBox[{"4.481856794238419`*^-18", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.02244918013450726`"}], "-", 
       RowBox[{"0.024977638046199964`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0008071625355020356`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.05166126415398948`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.006829528349231707`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.07708527541492506`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.045441638853982814`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00519554839136602`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1111654894045467`", "\[VeryThinSpace]", "+", 
       RowBox[{"6.61980848013676`*^-18", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.08641286795463338`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.03165299037174724`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.016507953899620408`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.007584355345183986`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.022449180134507262`"}], "+", 
       RowBox[{"0.024977638046199964`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.13061858580111801`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.0252893927536929`*^-17", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.01834577635010239`"}], "-", 
       RowBox[{"0.1263901797200178`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.04664503333391547`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0663233156193208`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0008071625355020385`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.05166126415398945`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.018345776350102407`"}], "+", 
       RowBox[{"0.12639017972001776`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.24374675433232137`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.863583327689154`*^-17", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09341285880780312`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11838872045331826`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.06535664963386208`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.09758617456447367`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.08641286795463338`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.03165299037174724`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.21585752000108918`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.5159975026254842`*^-17", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, Complex[0., 0.], {
     1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{1}, {4}, {6}, {7}, {2}, {3}, {
       5}, {8}, {2}, {3}, {5}, {8}, {1}, {4}, {6}, {7}, {2}, {3}, {5}, {8}, {
       1}, {4}, {6}, {7}, {1}, {4}, {6}, {7}, {2}, {3}, {5}, {
       8}}}, CompressedData["
1:eJxTTMoPSlNgYGAoZgESPpnFJWlMIB47kHDOzy3ISa0oOqmbUDDt51r7olM+
CcdnasbYYCqxadp+9viXDPuiJczlUW/X9+/HVPJhQy1H2fMJ9kVCBZsfHRWo
x6LE2T1x5u2Hy+2Lzkn2TJ/wawMWJcvM8gxtluyzL9ry6PnkfTNq9mAqeWCS
rhVdPG1/UfCSrV+iqrdjMUXVp7nP/We1fVEH28uAO7s3Y1Gi82vW1ucvt9sX
KX/qV9rptw+Lkuswi0IgFtljKvHiPiEp2rXNvujHUu6VJp4xWJy7zbcpUcEF
6OmktefT3rqXYjHlxssDC8x2b7Avsr3oHZLxewcWJVKwCFgFiQAsSp4tEfRO
711gX2T8tE7SbnUIlmhk2v7/56s/QB8FbdV4tWfyTCyeVhZeGvGjyMu+qPIa
a0JE8SosFmnAQrcTErpYlGyFeToZ4mksFpVuzc8NL91jX6SWKh/p1R6Hxbk5
0y9GqssDQzfS5r3MJZMFWCz6DEt17JBUh0UJM5qnsShx+qcoK7PjgH2RbK91
m+2SdCxuecp/zNTm5KT9RRdzzdf06h7A4iMnWPI+D0neWCyyg4VuKSR0sZjy
CmbRBYhFWEwRbtP7KW583r7o2BLvA8E1pVicqwdL3vKQ5I3FlKtoqQ6LW9Aj
AIsSV+4GOYuFp+2LXrvsC86vKtwDAKr2m1o=
      "]}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1133144346,ExpressionUUID->"96615bbd-29d9-4e16-b461-8839358532f7"]
}, Open  ]],

Cell["Check the density matrix:", "ExampleText",
 CellID->315707420,ExpressionUUID->"a2a2958f-48a9-4d70-aac4-480b1e67457a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tr", "[", "rho", "]"}], "//", "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eigenvalues", "[", "rho", "]"}], "//", "Chop"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1809999850,ExpressionUUID->"ca85d0ec-9d0d-4839-a113-78df1cdc230e"],

Cell[BoxData["0.9999999999999998`"], "Output",
 CellLabel->"Out[6]=",
 CellID->1054767301,ExpressionUUID->"919c7f7f-770b-4485-a9f4-3f7116da9ca2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.44636101322386657`", ",", "0.35553987829196376`", ",", 
   "0.09423902297615487`", ",", "0.07506419639407717`", ",", 
   "0.013234460292649235`", ",", "0.010541642890635652`", ",", 
   "0.0027941566818032366`", ",", "0.0022256292488492435`"}], "}"}]], "Output",\

 CellLabel->"Out[6]=",
 CellID->2144005569,ExpressionUUID->"129fc3ff-fbb4-49b7-a1b7-2467e5dd36cb"]
}, Open  ]],

Cell["Calculate the Green's functions:", "ExampleText",
 CellID->1787161257,ExpressionUUID->"cf6c585a-1d3f-4889-a0dd-a5e59ba94c54"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Multiply", ",", "ccdd", ",", 
     RowBox[{"Dagger", "@", "ccdd"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"ops", ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ops", "//", "Dimensions"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->744728508,ExpressionUUID->"37f27441-f23c-4ab5-86d1-8d1bd3314e2f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "6", ",", "8", ",", "8"}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->198701064,ExpressionUUID->"74c0733e-76f6-4022-9b48-ade2512e6d4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"#", ".", "rho"}], "]"}], "&"}], ",", "ops", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "Dimensions"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "=", 
  RowBox[{"NambuGreen", "[", "grn", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ArrayShort", "@", "grn"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2112959457,ExpressionUUID->"8a7d4993-ab11-4519-a1f9-5beb76b3619e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "6"}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->638425511,ExpressionUUID->"a3b6fab5-e204-477a-a92c-96e9e85fd09c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["NambuGreen",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Target: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["All", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Target: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["All", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Blocks: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0.2986116504609245`", 
                    RowBox[{
                    RowBox[{"-", "0.022992458719475552`"}], "-", 
                    RowBox[{"0.019782089654833943`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.006022365813729669`"}], "-", 
                    
                    RowBox[{"0.12874653956891452`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.022992458719475563`"}], "+", 
                    RowBox[{"0.019782089654833947`", " ", "\[ImaginaryI]"}]}],
                     "0.42002243206843387`", 
                    RowBox[{
                    RowBox[{"0.040270200009506096`", "\[VeryThinSpace]"}], 
                    "-", 
                    
                    RowBox[{"0.21811618216861445`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.00602236581372967`"}], "+", 
                    RowBox[{"0.12874653956891452`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.04027020000950611`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.21811618216861445`", " ", "\[ImaginaryI]"}]}], 
                    "0.501501541996631`"}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
                    
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0", 
                    RowBox[{
                    RowBox[{"-", "0.1400578921417186`"}], "-", 
                    RowBox[{"0.18471203607263906`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.048848695734241665`", "\[VeryThinSpace]"}], 
                    "-", 
                    
                    RowBox[{"0.10517052990965765`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.1400578921417186`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.18471203607263906`", " ", "\[ImaginaryI]"}]}], 
                    "0", 
                    RowBox[{
                    RowBox[{"-", "0.08945927588440657`"}], "+", 
                    
                    RowBox[{"0.016180717190528483`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.048848695734241665`"}], "+", 
                    RowBox[{"0.10517052990965765`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.08945927588440657`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.016180717190528483`", " ", "\[ImaginaryI]"}]}],
                     "0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
                    RowAlignments -> Baseline, ColumnAlignments -> Center], 
                    "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], 
                    "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`NambuGreen[{{{Complex[
     0.2986116504609245, -2.034856065831039*^-17], 
     Complex[-0.022992458719475552`, -0.019782089654833943`], 
     Complex[-0.006022365813729669, -0.12874653956891452`]}, {
     Complex[-0.022992458719475563`, 0.019782089654833947`], Complex[
     0.42002243206843387`, -1.8241752353774247`*^-18], Complex[
     0.040270200009506096`, -0.21811618216861445`]}, {
     Complex[-0.00602236581372967, 0.12874653956891452`], Complex[
     0.04027020000950611, 0.21811618216861445`], Complex[0.501501541996631, 
     2.5228871275698363`*^-17]}}, {{Complex[0., 0.], 
     Complex[-0.1400578921417186, -0.18471203607263906`], Complex[
     0.048848695734241665`, -0.10517052990965765`]}, {Complex[
     0.1400578921417186, 0.18471203607263906`], Complex[0., 0.], 
     Complex[-0.08945927588440657, 0.016180717190528483`]}, {
     Complex[-0.048848695734241665`, 0.10517052990965765`], Complex[
     0.08945927588440657, -0.016180717190528483`], Complex[0., 0.]}}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[8]=",
 CellID->1189262965,ExpressionUUID->"d811ca5b-9c27-43ed-9924-909df8c8abca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.2986116504609245`", 
        RowBox[{
         RowBox[{"-", "0.022992458719475552`"}], "-", 
         RowBox[{"0.019782089654833943`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.006022365813729669`"}], "-", 
         RowBox[{"0.12874653956891452`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.022992458719475563`"}], "+", 
         RowBox[{"0.019782089654833947`", " ", "\[ImaginaryI]"}]}], 
        "0.42002243206843387`", 
        RowBox[{"0.040270200009506096`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.21811618216861445`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.00602236581372967`"}], "+", 
         RowBox[{"0.12874653956891452`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.04027020000950611`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.21811618216861445`", " ", "\[ImaginaryI]"}]}], 
        "0.501501541996631`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{
         RowBox[{"-", "0.1400578921417186`"}], "-", 
         RowBox[{"0.18471203607263906`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.048848695734241665`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.10517052990965765`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.1400578921417186`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.18471203607263906`", " ", "\[ImaginaryI]"}]}], "0", 
        RowBox[{
         RowBox[{"-", "0.08945927588440657`"}], "+", 
         RowBox[{"0.016180717190528483`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.048848695734241665`"}], "+", 
         RowBox[{"0.10517052990965765`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.08945927588440657`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.016180717190528483`", " ", "\[ImaginaryI]"}]}], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1312350126,ExpressionUUID->"a3b213de-9293-4e24-adbe-5c9a19a021d9"]
}, Open  ]],

Cell["Reproduce the density matrix from the Green's functions:", "ExampleText",
 CellID->1438399926,ExpressionUUID->"c068acab-d9e3-46be-a66b-0b1eef55786a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"BravyiDensityMatrix", "[", "grn", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "-", "rho"}], "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1570527806,ExpressionUUID->"1201cebb-6112-4774-a4bf-3e546e9f7009"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->1629062436,ExpressionUUID->"4f74e1c9-c050-4208-a2b8-819fb4d5fe98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "-", "rho"}], "//", "ArrayZeroQ"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->2098448323,ExpressionUUID->"dafe2801-152a-4162-ade2-7fb7c84fca95"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[10]=",
 CellID->1287757309,ExpressionUUID->"75488fb9-3dc0-4a4d-b65b-40f5808c771e"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000003`, {0.43114257812500156`, 13.168857421875}}]],
  ExpressionUUID->"75651c1a-d5b8-4308-ac5b-f473517398e1"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"8fd59c1e-be36-4b28-bcee-d19d7529d250"],
 "Maximally Entangled States",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "a033836e-67f3-4a06-b5ca-07c662f05a42"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1857010531,ExpressionUUID->"bfc49847-9754-4f1d-bb54-e3de3de93d0f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "@", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->177031794,ExpressionUUID->"cf2d6de0-4ab2-433b-9b8e-ebf0b70b6034"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->898028705,ExpressionUUID->"b2775f0a-e479-47ed-9b9d-aef05c2a09b5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->445065507,ExpressionUUID->"e26f42bd-7c01-427b-9e13-dc21fa9711ab"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"cc", "->", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"cc", "->", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"I", "*", "\[Phi]"}], "]"}]}]}], ")"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1153852927,ExpressionUUID->"6c9fd64c-598a-4bc1-82e8-f553dfd8f121"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 0, $CellContext`c[2] -> 1|>]], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 0|>]]}]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[3]=",
 CellID->1384283578,ExpressionUUID->"965d6749-d987-4067-b40d-39731dd77f97"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{
     RowBox[{"in", "**", 
      RowBox[{"Dagger", "[", "in", "]"}]}], ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->676224746,ExpressionUUID->"de8682af-36b7-49d0-92d1-3d473c74c488"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", 
      FractionBox["1", "2"], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], "2"], "0"},
     {"0", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"], 
      FractionBox["1", "2"], "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 0, 2, 4, 4}, {{2}, {3}, {2}, {3}}}, {
      Rational[1, 2], Rational[1, 2] E^(Complex[0, -1] $CellContext`\[Phi]), 
       Rational[1, 2] E^(Complex[0, 1] $CellContext`\[Phi]), Rational[
       1, 2]}}], TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1387474301,ExpressionUUID->"95752645-b156-454e-b39d-ce6759d471f3"]
}, Open  ]],

Cell["Calculate the Green's functions:", "ExampleText",
 CellID->1477099835,ExpressionUUID->"abc5954f-b6e2-45fd-b257-d01fccea7762"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Multiply", ",", "cc", ",", 
     RowBox[{"Dagger", "@", "cc"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gg", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1448597231,ExpressionUUID->"82c4254b-9ea5-4cd2-9de0-baa59cfb2952"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[1]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]], 
         $CellContext`c[1]]]}], 
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[2]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]], 
         $CellContext`c[1]]]}]},
     {
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[1]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]], 
         $CellContext`c[2]]]}], 
      RowBox[{"1", "-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[2]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]], 
         $CellContext`c[2]]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->50697626,ExpressionUUID->"b5cef19c-217e-4af0-bb32-bc930971ece4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Dagger", "[", "in", "]"}], "**", "#", "**", "in"}], "&"}], ",",
      "gg", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->139344697,ExpressionUUID->"a23ce317-eb6c-41f7-be91-89701987d1e6"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]]}], 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->316486182,ExpressionUUID->"091e8319-e1c7-4e7a-bf41-b297834213b1"]
}, Open  ]],

Cell["Calculate the density matrix from the Green's functions:", "ExampleText",
 CellID->1906329941,ExpressionUUID->"36e79559-e69e-4aa8-849c-202efdb54081"],

Cell[BoxData[
 RowBox[{
  RowBox[{"del", "[", "ph_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]", "=", "ph"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"BravyiDensityMatrix", "[", 
       RowBox[{"Normal", "@", "grn"}], "]"}], "-", 
      RowBox[{"Normal", "[", "rho", "]"}]}], "//", "Chop"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1988032374,ExpressionUUID->"f576ece7-7ead-4137-835b-89fec0a9e3e6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"del", "[", 
      RowBox[{"p", "*", "Pi"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayShort", "/@", "data"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->255519355,ExpressionUUID->"26ac0507-a0c7-444b-9128-bdd88f8a5579"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->915820395,ExpressionUUID->"ab84a19d-af4e-4fbf-b7c1-e620c4b3e5a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"logneg", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"BravyiLogarithmicNegativity", "[", 
      RowBox[{
       RowBox[{"grn", "/.", 
        RowBox[{"\[Phi]", "->", 
         RowBox[{"p", "*", "Pi"}]}]}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], "]"}], "//", 
   RowBox[{
    RowBox[{"IntegerChop", "[", 
     RowBox[{"#", ",", "1.0*^-4"}], "]"}], "&"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->442774530,ExpressionUUID->"8c35720b-c326-403c-a032-f84ab538702f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",",
    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->1739186003,ExpressionUUID->"19b787e0-b318-4c9e-b88c-d51ed28bec46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "1670ee6e-0103-44c6-afb9-ccc2ad296f54"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->770380891,ExpressionUUID->"68eecd6d-cabf-4bab-b50e-e9bf05c38a81"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "@", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ccdd", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"cc", ",", 
    RowBox[{"Dagger", "@", "cc"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->2079034484,ExpressionUUID->"391b6f1d-952a-4b9e-95c8-e73c5320a75a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1974060169,ExpressionUUID->"73e2fdda-817e-44a0-aaa6-594bffad7903"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    QuantumMob`Q3`Dagger[
     $CellContext`c[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    QuantumMob`Q3`Dagger[
     $CellContext`c[2]]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1554397880,ExpressionUUID->"72e37eb8-da4c-4435-acb3-5762625e2749"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1071012257,ExpressionUUID->"7b71245a-b0a4-4737-baba-ae52835e95cf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"cc", "->", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"cc", "->", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"I", "*", "\[Phi]"}], "]"}]}]}], ")"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->295074245,ExpressionUUID->"7970b768-b555-4387-a5c2-70d647666de3"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 0, $CellContext`c[2] -> 0|>]], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 1|>]]}]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[3]=",
 CellID->266394469,ExpressionUUID->"76765ad2-599c-4fa5-931e-67c237c53b92"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{
     RowBox[{"in", "**", 
      RowBox[{"Dagger", "[", "in", "]"}]}], ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1128104794,ExpressionUUID->"c1958313-237f-4f0b-85a0-686e37d76059"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0", "0", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], "2"]},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"], "0", "0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 2, 2, 4}, {{1}, {4}, {1}, {4}}}, {
      Rational[1, 2], Rational[1, 2] E^(Complex[0, -1] $CellContext`\[Phi]), 
       Rational[1, 2] E^(Complex[0, 1] $CellContext`\[Phi]), Rational[
       1, 2]}}], TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->667892655,ExpressionUUID->"095e0267-e31f-4af4-b4d9-870bc370ecb6"]
}, Open  ]],

Cell["Calculate the Green's functions:", "ExampleText",
 CellID->851396083,ExpressionUUID->"16d99db7-e287-4d7d-93f9-c8fa6568bf3d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Multiply", ",", "ccdd", ",", 
     RowBox[{"Dagger", "@", "ccdd"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gg", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->730427020,ExpressionUUID->"0011290a-2293-4f2c-aa24-a9ee837ae5be"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[1]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]], 
         $CellContext`c[1]]]}], 
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[2]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]], 
         $CellContext`c[1]]]}], "0", 
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         $CellContext`c[2], 
         $CellContext`c[1]]]}]},
     {
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[1]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]], 
         $CellContext`c[2]]]}], 
      RowBox[{"1", "-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[2]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]], 
         $CellContext`c[2]]]}], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]], 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        $CellContext`c[2], 
        $CellContext`c[1]]], "0"},
     {"0", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[1]]], 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[2]]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        QuantumMob`Q3`Dagger[
         $CellContext`c[1]], 
        QuantumMob`Q3`Dagger[
         $CellContext`c[2]]]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[1]]], 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        QuantumMob`Q3`Dagger[
         $CellContext`c[1]], 
        $CellContext`c[1]]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[1]]], 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        QuantumMob`Q3`Dagger[
         $CellContext`c[1]], 
        $CellContext`c[2]]]},
     {
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[1]]], 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[2]]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]]]]}], "0", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[2]]], 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        QuantumMob`Q3`Dagger[
         $CellContext`c[2]], 
        $CellContext`c[1]]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[2]]], 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        QuantumMob`Q3`Dagger[
         $CellContext`c[2]], 
        $CellContext`c[2]]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1659271935,ExpressionUUID->"2bdcc7af-7272-48c5-8e69-96e2ab528034"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Dagger", "[", "in", "]"}], "**", "#", "**", "in"}], "&"}], ",",
      "gg", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "ArrayShort"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"NambuGreen", "[", 
    RowBox[{"grn", ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1311692142,ExpressionUUID->"f66ad0ac-c028-4ddc-8b56-438c95de4b27"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"]}]},
     {"0", 
      FractionBox["1", "2"], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"], "0"},
     {"0", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], "2"], 
      FractionBox["1", "2"], "0"},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]]}], "0", "0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1987484122,ExpressionUUID->"d52411dc-9fe3-49e8-ad53-7461aa6bd184"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", "2"], "0"},
       {"0", 
        FractionBox["1", "2"]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"]}]},
       {
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1684993016,ExpressionUUID->"22519ac0-a9db-452f-b81f-8c663639f900"]
}, Open  ]],

Cell["Calculate the density matrix from the Green's functions:", "ExampleText",
 CellID->179211657,ExpressionUUID->"dde77e00-6eda-48b1-87a3-a371d6d14916"],

Cell[BoxData[
 RowBox[{
  RowBox[{"del", "[", "ph_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]", "=", "ph"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"BravyiDensityMatrix", "[", "grn", "]"}], "-", 
      RowBox[{"Normal", "[", "rho", "]"}]}], "//", "Chop"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1238246105,ExpressionUUID->"8ca6fe84-08b7-44ed-ade9-3100dc09b751"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"del", "[", 
      RowBox[{"p", "*", "Pi"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayShort", "/@", "data"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2085747305,ExpressionUUID->"4ee990d1-9c06-4f2f-a437-c2da69430c0e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1719884081,ExpressionUUID->"8367cdc0-0792-4df1-af9c-e40c48425715"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"logneg", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"BravyiLogarithmicNegativity", "[", 
      RowBox[{
       RowBox[{"grn", "/.", 
        RowBox[{"\[Phi]", "->", 
         RowBox[{"p", "*", "Pi"}]}]}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], "]"}], "//", 
   "IntegerChop"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1400974601,ExpressionUUID->"7336bc5e-e9d1-4611-a50a-e3579043648f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",",
    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->1081338500,ExpressionUUID->"8f3867e6-6a59-47cb-bb11-f43d6e6f6847"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BravyiGreen"]], "paclet:QuantumMob/Q3/ref/BravyiGreen", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "8f084e11-04c3-4aa0-b063-a1db4c530005"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BravyiState"]], "paclet:QuantumMob/Q3/ref/BravyiState", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "a17b7d0d-9558-4dff-8f62-aa2b63ec29f7"]
       }], "SeeAlso",ExpressionUUID->"ff51ffa2-9002-4b99-b533-1f215a31b583"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"8c54a668-572f-42e3-b2ca-\
0158a7dde777"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "521ea198-dec7-4312-9f66-77c3754864e2"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], 
           "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "2a41e670-a064-4c6f-b9d3-568f75cefd81"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"af744b80-53c9-47af-b898-\
86960e219a5f"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Fermionic Quantum Computation"]], 
           "paclet:QuantumMob/Q3/guide/FermionicQuantumComputation"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "35d3a251-e892-45cf-b360-3fec7a991393"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "18b4faff-9e54-43c6-913a-45c94cbfbd7a"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "2daf5967-34ee-4127-a38c-bc1e173d17df"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"bc2a68d0-2f7a-463c-b944-\
2e43d2c34cac"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "S. Bravyi and R. K\[ODoubleDot]nig (2012)"}]]]], 
             "https://dl.acm.org/doi/10.5555/2481569.2481571"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "1d1e792b-0eef-48fb-992f-e0b5205d38a3"]}]],ExpressionUUID->
         "df02be77-fbd1-4b8b-aca7-d3dd8b4eaec8"],
        ", Quantum Information & Computation 12, 925 (2012), \"Classical \
simulation of dissipative fermionic linear optics.\""
       }], "RelatedLinks",ExpressionUUID->
        "1eed3b8f-cbf7-43af-a22c-e9729d8c3272"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "S. Bravyi (2005)"}]]]], 
             "https://dl.acm.org/doi/abs/10.5555/2011637.2011640"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "110b24c3-9c12-400c-a510-7a3bae6921cf"]}]],ExpressionUUID->
         "05a8131a-62b3-49b6-a46f-4f42b8af18f9"],
        ", Quantum Information & Computation 5, 216 (2005), \"Lagrangian \
representation for fermionic linear optics.\""
       }], "RelatedLinks",ExpressionUUID->
        "57ad56b5-f2ea-4acc-8881-0df631390d38"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "S. Bravyi and A. Y. Kitaev (2002)"}]]]], 
             "https://doi.org/10.1006/aphy.2002.6254"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "9ba33b62-26d5-4896-bc89-331ae7e1c027"]}]],ExpressionUUID->
         "5bfc0dd6-0fd6-468a-9797-7f903a4d9e07"],
        ", Annals of Physics 298, 210 (2002),\"Fermionic Quantum Computation.\
\""
       }], "RelatedLinks",ExpressionUUID->
        "de6d11f3-5a40-4dfd-a7f3-60e8da44f90e"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "B. M. Terhal and D. P. DiVincenzo (2002)"}]]]], 
             "https://doi.org/10.1103/PhysRevA.65.032325"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "1906b224-52b4-4292-8bf6-e812dd2e7e16"]}]],ExpressionUUID->
         "b0ae2666-9061-4683-8ae7-1c5c0c789814"],
        ", Physical Review A 65, 032325, \"Classical simulation of ",
        StyleBox["noninteracting",
         IgnoreSpellCheck->True],
        "-fermion quantum circuits.\""
       }], "RelatedLinks",ExpressionUUID->
        "980f26b8-ddf2-4b31-95f6-dc08a3680b80"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "26b07a1e-501a-4948-bd47-fd2aa0437d25"]}]],ExpressionUUID->
         "962b2d61-101d-4806-9291-8618dd8ef58d"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "070af91b-f038-4ae8-a61d-1d874bc8b9c1"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"7b7c57dc-5e40-4c64-a4c0-\
f6efd132c7bb"],

Cell[" ", "FooterCell",ExpressionUUID->"ddfadf0f-e26b-42ae-8546-29c856b6f6e1"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"BravyiDensityMatrix",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed}, "AllOptsTable" -> 
    Closed, "NotesSection" -> Closed, 
    "ExampleSubsection" -> {"0" -> Closed, "1" -> Closed, "2" -> Closed}}, 
  "NewStyles" -> True, "CitationPopupData" -> $Failed, "ShowCitation" -> 
  False, "HasOptions" -> True, "RootCaptions" -> "", 
  "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 18, 23, 58, 40.713984}", 
    "history" -> {"14.1", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> "QuantumMob/Q3",
     "status" -> "None", "summary" -> 
    "BravyiDensityMatrix[grn] returns the density matrix corresponding to the \
single-particle Green's function grn, assuming that grn is associated with a \
fermionic Gaussian state. BravyiDensityMatrix[ws] is a shortcut and returns \
the density matrix corresponding to the Bravyi or Nambu state ws.", 
    "synonyms" -> {}, "tabletags" -> {}, "title" -> "BravyiDensityMatrix", 
    "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "BravyiDensityMatrix", "type" -> "Symbol", "uri" -> 
    "QuantumMob/Q3/ref/BravyiDensityMatrix"}},
CellContext->"Global`",
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"ff068368-e2b4-427c-850b-e6fce2664a49"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[13321, 352, 1440, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"afd4de03-79ac-4f78-aaeb-14995dd66e07",
   CellTags->"PrimaryExamplesSection",
   CellID->654673709]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 180444, 4668}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[587, 21, 6731, 165, 70, "AnchorBarGrid",ExpressionUUID->"65e5acbc-1f57-4091-a7eb-02dbe2988c3c",
 CellID->1],
Cell[7321, 188, 96, 0, 70, "ContextNameCell",ExpressionUUID->"6743855a-732c-4bf6-8b8b-67378ba86198"],
Cell[CellGroupData[{
Cell[7442, 192, 1370, 37, 70, "ObjectNameGrid",ExpressionUUID->"10526b93-6e69-4208-8361-bcf725ff9513"],
Cell[8815, 231, 1964, 49, 70, "Usage",ExpressionUUID->"96abf360-bce5-4fac-896a-97c29183b796",
 CellID->837314546]
}, Open  ]],
Cell[CellGroupData[{
Cell[10816, 285, 1850, 45, 70, "NotesSection",ExpressionUUID->"63c961a7-fcfb-4886-b4bf-f2a5caa033fe",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->435106592],
Cell[12669, 332, 525, 14, 70, "Notes",ExpressionUUID->"c511b8a8-1186-49ce-a849-da0eaf1d2a4f",
 CellID->285235831]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[13321, 352, 1440, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"afd4de03-79ac-4f78-aaeb-14995dd66e07",
 CellTags->"PrimaryExamplesSection",
 CellID->654673709],
Cell[14764, 392, 203, 3, 70, "Input",ExpressionUUID->"c3742214-427d-42e4-888c-a4bb2e65b1c5",
 CellID->1940205291],
Cell[CellGroupData[{
Cell[14992, 399, 1419, 37, 70, "ExampleSection",ExpressionUUID->"96e6bcdd-f926-408f-a5e6-05fdab20db54",
 CellID->1542303582],
Cell[16414, 438, 128, 1, 70, "ExampleText",ExpressionUUID->"3cedba60-3a10-4b75-b7fc-89d80841469a",
 CellID->1579571379],
Cell[16545, 441, 205, 5, 70, "Input",ExpressionUUID->"c742f442-67db-4bfe-be23-ac5308836b2c",
 CellID->2144923147],
Cell[16753, 448, 220, 5, 70, "Input",ExpressionUUID->"d6a26ccc-cde6-4562-aead-87d7d39150e3",
 CellID->1611621965],
Cell[16976, 455, 146, 1, 70, "ExampleText",ExpressionUUID->"22874ae0-b020-40f3-b966-a578656e259c",
 CellID->1793530776],
Cell[CellGroupData[{
Cell[17147, 460, 232, 5, 70, "Input",ExpressionUUID->"2511ae66-6ac4-4df5-9ada-417bc4606a13",
 CellID->1279536004],
Cell[17382, 467, 7142, 142, 70, "Output",ExpressionUUID->"c95d6daf-8a3e-462d-87f4-ecf632351b39",
 CellID->1374224457]
}, Open  ]],
Cell[CellGroupData[{
Cell[24561, 614, 193, 4, 70, "Input",ExpressionUUID->"5fbcf907-54dd-4291-804d-b307e51dfbb3",
 CellID->79841072],
Cell[24757, 620, 127, 2, 70, "Output",ExpressionUUID->"450fb4c3-c761-4152-95bb-8ec11083319d",
 CellID->1159916761]
}, Open  ]],
Cell[24899, 625, 129, 1, 70, "ExampleText",ExpressionUUID->"88ea997c-0398-4dd1-9100-e0b189fbb913",
 CellID->829017474],
Cell[CellGroupData[{
Cell[25053, 630, 310, 7, 70, "Input",ExpressionUUID->"e89806ff-1ec3-43c9-9e3c-7fe5c14ee6e4",
 CellID->1228699821],
Cell[25366, 639, 2918, 67, 70, "Output",ExpressionUUID->"9cae8822-49f3-48b0-8814-0820c2168526",
 CellID->976797241]
}, Open  ]],
Cell[28299, 709, 128, 1, 70, "ExampleText",ExpressionUUID->"ed74145d-5dc5-428e-ad6f-4a461a6a3e5b",
 CellID->1287199281],
Cell[CellGroupData[{
Cell[28452, 714, 382, 9, 70, "Input",ExpressionUUID->"f9bd32de-39c9-4c23-9054-8ad5688baba0",
 CellID->1625237059],
Cell[28837, 725, 2593, 58, 70, "Output",ExpressionUUID->"75fb087e-62ac-47cc-a921-ca39f8b5e15e",
 CellID->580600593]
}, Open  ]],
Cell[31445, 786, 206, 4, 70, "ExampleText",ExpressionUUID->"fd7d3a4d-fd3b-4d78-9448-790dfc615117",
 CellID->2088378959],
Cell[CellGroupData[{
Cell[31676, 794, 499, 13, 70, "Input",ExpressionUUID->"95e8395a-ef8f-419f-bf5b-2c8f35380736",
 CellID->1687043485],
Cell[32178, 809, 2594, 58, 70, "Output",ExpressionUUID->"64173312-e776-4076-ab7e-b73ed4a78274",
 CellID->1409814138]
}, Open  ]],
Cell[CellGroupData[{
Cell[34809, 872, 223, 5, 70, "Input",ExpressionUUID->"7df7a892-f550-4c33-955d-b21c5a035c00",
 CellID->1578285105],
Cell[35035, 879, 130, 2, 70, "Output",ExpressionUUID->"88bfb625-11fb-4a70-b76e-0ac67819de38",
 CellID->1217362739]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[35314, 889, 1409, 37, 70, "ExampleSection",ExpressionUUID->"63316f9f-9e5e-4218-a995-27c021fc9625",
 CellID->65633975],
Cell[CellGroupData[{
Cell[36748, 930, 1450, 37, 70, "ExampleSubsection",ExpressionUUID->"ab566b27-a363-41ea-b66c-5e0cb93a3e43",
 CellID->497423321],
Cell[38201, 969, 213, 4, 70, "ExampleText",ExpressionUUID->"56eafeaf-55d4-4ef3-995b-51d8ee0dcc12",
 CellID->1625303001],
Cell[38417, 975, 127, 1, 70, "ExampleText",ExpressionUUID->"8963b758-1630-4b0e-8039-210d128dade3",
 CellID->2146590148],
Cell[38547, 978, 335, 9, 70, "Input",ExpressionUUID->"a0b0022a-74f4-4d1c-ab9f-ccfeb9b15c02",
 CellID->1998991449],
Cell[CellGroupData[{
Cell[38907, 991, 332, 8, 70, "Input",ExpressionUUID->"6d4e537b-8fb1-4c5e-887d-57b8c03c92fa",
 CellID->1412231210],
Cell[39242, 1001, 578, 19, 70, "Output",ExpressionUUID->"218c9de2-2dbb-4866-a237-fa0a7453461a",
 CellID->1671700638]
}, Open  ]],
Cell[39835, 1023, 135, 1, 70, "ExampleText",ExpressionUUID->"f07443fc-0d1f-42ff-b1cc-909d86f17be1",
 CellID->1531256439],
Cell[39973, 1026, 220, 5, 70, "Input",ExpressionUUID->"b260d9f7-6c76-49ea-b507-912a08e90906",
 CellID->1340151952],
Cell[CellGroupData[{
Cell[40218, 1035, 702, 19, 70, "Input",ExpressionUUID->"4245cd0f-8207-47ef-a41e-4a39fe85882c",
 CellID->1713041365],
Cell[40923, 1056, 12978, 268, 70, "Output",ExpressionUUID->"b17beb80-5997-46e9-b8dc-72b51eb20081",
 CellID->2117725931]
}, Open  ]],
Cell[53916, 1327, 124, 1, 70, "ExampleText",ExpressionUUID->"8422338f-8566-4377-97cc-e8869e252c71",
 CellID->1114864780],
Cell[CellGroupData[{
Cell[54065, 1332, 323, 7, 70, "Input",ExpressionUUID->"5b64c4a6-b67d-44e3-a380-580979577e22",
 CellID->1726168276],
Cell[54391, 1341, 129, 2, 70, "Output",ExpressionUUID->"5218cb9b-134a-4cb1-881f-7a802d607c66",
 CellID->1819883667],
Cell[54523, 1345, 303, 7, 70, "Output",ExpressionUUID->"8d7cfd62-eca4-49d9-b0c7-548cc9b2debf",
 CellID->175207048]
}, Open  ]],
Cell[54841, 1355, 131, 1, 70, "ExampleText",ExpressionUUID->"3f189d30-c46c-4d18-99c3-0c5d8dcf3f35",
 CellID->1488178613],
Cell[CellGroupData[{
Cell[54997, 1360, 510, 13, 70, "Input",ExpressionUUID->"85620a6a-509e-42e3-92f9-0ae42c69b17d",
 CellID->1543102090],
Cell[55510, 1375, 189, 4, 70, "Output",ExpressionUUID->"60362807-7161-41a6-878e-f965c3bc6f99",
 CellID->2891139]
}, Open  ]],
Cell[CellGroupData[{
Cell[55736, 1384, 510, 13, 70, "Input",ExpressionUUID->"3934c719-c6b8-47f4-abff-25d6adcf269e",
 CellID->1147281361],
Cell[56249, 1399, 171, 4, 70, "Output",ExpressionUUID->"902db2d4-3e87-4a54-906f-d9ec813134ed",
 CellID->296362582],
Cell[56423, 1405, 1479, 34, 70, "Output",ExpressionUUID->"5cd22425-88f3-4307-972b-3d9c30262649",
 CellID->951338281]
}, Open  ]],
Cell[57917, 1442, 155, 1, 70, "ExampleText",ExpressionUUID->"34ea92ab-5eb7-42dc-a520-d9afbcbf8d0e",
 CellID->1295948158],
Cell[CellGroupData[{
Cell[58097, 1447, 343, 8, 70, "Input",ExpressionUUID->"a95f1d59-4bb4-4e01-a34e-bfd8d5564cc7",
 CellID->916462759],
Cell[58443, 1457, 909, 21, 70, "Output",ExpressionUUID->"658309a5-03a2-43ef-a529-cdb876439e48",
 CellID->209719098]
}, Open  ]],
Cell[CellGroupData[{
Cell[59389, 1483, 223, 5, 70, "Input",ExpressionUUID->"ef071611-179d-4717-b21a-e0f9ba7de426",
 CellID->1292850891],
Cell[59615, 1490, 130, 2, 70, "Output",ExpressionUUID->"55fbda9c-27fd-4313-82bc-9d25b1726c1a",
 CellID->1017975932]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[59897, 1500, 1448, 37, 70, "ExampleSubsection",ExpressionUUID->"962af4a5-e0d7-40ab-986d-8aaceca31d40",
 CellID->1882279022],
Cell[61348, 1539, 126, 1, 70, "ExampleText",ExpressionUUID->"d7a886f0-d345-42ef-abe3-93bb8b056a20",
 CellID->707366989],
Cell[61477, 1542, 334, 9, 70, "Input",ExpressionUUID->"b088bf6d-d5b0-4087-8106-af1a05ea3957",
 CellID->297536878],
Cell[CellGroupData[{
Cell[61836, 1555, 471, 12, 70, "Input",ExpressionUUID->"2659cb6a-9624-4964-a853-22201869478c",
 CellID->891360236],
Cell[62310, 1569, 577, 19, 70, "Output",ExpressionUUID->"518058e9-6500-4db2-abc4-ea4e02211a87",
 CellID->816483153],
Cell[62890, 1590, 1366, 40, 70, "Output",ExpressionUUID->"11b1ea65-6e1a-4fb5-9840-06b16d986a10",
 CellID->211848141]
}, Open  ]],
Cell[64271, 1633, 135, 1, 70, "ExampleText",ExpressionUUID->"85a89cdc-4c5e-4800-bc31-8ab8713bee4c",
 CellID->1215678238],
Cell[64409, 1636, 219, 5, 70, "Input",ExpressionUUID->"467a5579-c18e-4a81-8c29-a2561b72048f",
 CellID->638652385],
Cell[CellGroupData[{
Cell[64653, 1645, 782, 22, 70, "Input",ExpressionUUID->"03ccb234-58e0-43ed-ad82-f6c5d489bf00",
 CellID->1523597312],
Cell[65438, 1669, 14016, 284, 70, "Output",ExpressionUUID->"1ae30c1e-3305-430e-8493-708073780924",
 CellID->1893307887]
}, Open  ]],
Cell[CellGroupData[{
Cell[79491, 1958, 197, 4, 70, "Input",ExpressionUUID->"6a1cd02d-1866-433b-a274-eb1b962851ba",
 CellID->947799548],
Cell[79691, 1964, 8928, 176, 70, "Output",ExpressionUUID->"96615bbd-29d9-4e16-b461-8839358532f7",
 CellID->1133144346]
}, Open  ]],
Cell[88634, 2143, 123, 1, 70, "ExampleText",ExpressionUUID->"a2a2958f-48a9-4d70-aac4-480b1e67457a",
 CellID->315707420],
Cell[CellGroupData[{
Cell[88782, 2148, 317, 7, 70, "Input",ExpressionUUID->"ca85d0ec-9d0d-4839-a113-78df1cdc230e",
 CellID->1809999850],
Cell[89102, 2157, 145, 2, 70, "Output",ExpressionUUID->"919c7f7f-770b-4485-a9f4-3f7116da9ca2",
 CellID->1054767301],
Cell[89250, 2161, 407, 9, 70, "Output",ExpressionUUID->"129fc3ff-fbb4-49b7-a1b7-2467e5dd36cb",
 CellID->2144005569]
}, Open  ]],
Cell[89672, 2173, 131, 1, 70, "ExampleText",ExpressionUUID->"cf6c585a-1d3f-4889-a0dd-a5e59ba94c54",
 CellID->1787161257],
Cell[CellGroupData[{
Cell[89828, 2178, 513, 13, 70, "Input",ExpressionUUID->"37f27441-f23c-4ab5-86d1-8d1bd3314e2f",
 CellID->744728508],
Cell[90344, 2193, 191, 4, 70, "Output",ExpressionUUID->"74c0733e-76f6-4022-9b48-ade2512e6d4b",
 CellID->198701064]
}, Open  ]],
Cell[CellGroupData[{
Cell[90572, 2202, 600, 15, 70, "Input",ExpressionUUID->"8a7d4993-ab11-4519-a1f9-5beb76b3619e",
 CellID->2112959457],
Cell[91175, 2219, 171, 4, 70, "Output",ExpressionUUID->"a3b6fab5-e204-477a-a92c-96e9e85fd09c",
 CellID->638425511],
Cell[91349, 2225, 8491, 174, 70, "Output",ExpressionUUID->"d811ca5b-9c27-43ed-9924-909df8c8abca",
 CellID->1189262965],
Cell[99843, 2401, 2925, 69, 70, "Output",ExpressionUUID->"a3b213de-9293-4e24-adbe-5c9a19a021d9",
 CellID->1312350126]
}, Open  ]],
Cell[102783, 2473, 155, 1, 70, "ExampleText",ExpressionUUID->"c068acab-d9e3-46be-a66b-0b1eef55786a",
 CellID->1438399926],
Cell[CellGroupData[{
Cell[102963, 2478, 344, 8, 70, "Input",ExpressionUUID->"1201cebb-6112-4774-a4bf-3e546e9f7009",
 CellID->1570527806],
Cell[103310, 2488, 910, 21, 70, "Output",ExpressionUUID->"4f74e1c9-c050-4208-a2b8-819fb4d5fe98",
 CellID->1629062436]
}, Open  ]],
Cell[CellGroupData[{
Cell[104257, 2514, 224, 5, 70, "Input",ExpressionUUID->"dafe2801-152a-4162-ade2-7fb7c84fca95",
 CellID->2098448323],
Cell[104484, 2521, 131, 2, 70, "Output",ExpressionUUID->"75488fb9-3dc0-4a4d-b65b-40f5808c771e",
 CellID->1287757309]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[104767, 2531, 1441, 37, 70, "ExampleSubsection",ExpressionUUID->"bfc49847-9754-4f1d-bb54-e3de3de93d0f",
 CellID->1857010531],
Cell[CellGroupData[{
Cell[106233, 2572, 346, 9, 70, "Input",ExpressionUUID->"cf2d6de0-4ab2-433b-9b8e-ebf0b70b6034",
 CellID->177031794],
Cell[106582, 2583, 435, 14, 70, "Output",ExpressionUUID->"b2775f0a-e479-47ed-9b9d-aef05c2a09b5",
 CellID->898028705]
}, Open  ]],
Cell[107032, 2600, 223, 5, 70, "Input",ExpressionUUID->"e26f42bd-7c01-427b-9e13-dc21fa9711ab",
 CellID->445065507],
Cell[CellGroupData[{
Cell[107280, 2609, 621, 19, 70, "Input",ExpressionUUID->"6c9fd64c-598a-4bc1-82e8-f553dfd8f121",
 CellID->1153852927],
Cell[107904, 2630, 1719, 43, 70, "Output",ExpressionUUID->"965d6749-d987-4067-b40d-39731dd77f97",
 CellID->1384283578]
}, Open  ]],
Cell[CellGroupData[{
Cell[109660, 2678, 395, 10, 70, "Input",ExpressionUUID->"de8682af-36b7-49d0-92d1-3d473c74c488",
 CellID->676224746],
Cell[110058, 2690, 1247, 34, 70, "Output",ExpressionUUID->"95752645-b156-454e-b39d-ce6759d471f3",
 CellID->1387474301]
}, Open  ]],
Cell[111320, 2727, 131, 1, 70, "ExampleText",ExpressionUUID->"abc5954f-b6e2-45fd-b257-d01fccea7762",
 CellID->1477099835],
Cell[CellGroupData[{
Cell[111476, 2732, 376, 9, 70, "Input",ExpressionUUID->"82c4254b-9ea5-4cd2-9de0-baa59cfb2952",
 CellID->1448597231],
Cell[111855, 2743, 4076, 105, 70, "Output",ExpressionUUID->"b5cef19c-217e-4af0-bb32-bc930971ece4",
 CellID->50697626]
}, Open  ]],
Cell[CellGroupData[{
Cell[115968, 2853, 468, 13, 70, "Input",ExpressionUUID->"a23ce317-eb6c-41f7-be91-89701987d1e6",
 CellID->139344697],
Cell[116439, 2868, 999, 29, 70, "Output",ExpressionUUID->"091e8319-e1c7-4e7a-bf41-b297834213b1",
 CellID->316486182]
}, Open  ]],
Cell[117453, 2900, 155, 1, 70, "ExampleText",ExpressionUUID->"36e79559-e69e-4aa8-849c-202efdb54081",
 CellID->1906329941],
Cell[117611, 2903, 584, 15, 70, "Input",ExpressionUUID->"f576ece7-7ead-4137-835b-89fec0a9e3e6",
 CellID->1988032374],
Cell[CellGroupData[{
Cell[118220, 2922, 468, 13, 70, "Input",ExpressionUUID->"26ac0507-a0c7-444b-9128-bdd88f8a5579",
 CellID->255519355],
Cell[118691, 2937, 12730, 361, 70, "Output",ExpressionUUID->"ab84a19d-af4e-4fbf-b7c1-e620c4b3e5a3",
 CellID->915820395]
}, Open  ]],
Cell[CellGroupData[{
Cell[131458, 3303, 647, 18, 70, "Input",ExpressionUUID->"8c35720b-c326-403c-a032-f84ab538702f",
 CellID->442774530],
Cell[132108, 3323, 373, 7, 70, "Output",ExpressionUUID->"19b787e0-b318-4c9e-b88c-d51ed28bec46",
 CellID->1739186003]
}, Open  ]],
Cell[CellGroupData[{
Cell[132518, 3335, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"68eecd6d-cabf-4bab-b50e-e9bf05c38a81",
 CellID->770380891],
Cell[CellGroupData[{
Cell[132785, 3344, 487, 13, 70, "Input",ExpressionUUID->"391b6f1d-952a-4b9e-95c8-e73c5320a75a",
 CellID->2079034484],
Cell[133275, 3359, 436, 14, 70, "Output",ExpressionUUID->"73e2fdda-817e-44a0-aaa6-594bffad7903",
 CellID->1974060169],
Cell[133714, 3375, 962, 28, 70, "Output",ExpressionUUID->"72e37eb8-da4c-4435-acb3-5762625e2749",
 CellID->1554397880]
}, Open  ]],
Cell[134691, 3406, 224, 5, 70, "Input",ExpressionUUID->"7b71245a-b0a4-4737-baba-ae52835e95cf",
 CellID->1071012257],
Cell[CellGroupData[{
Cell[134940, 3415, 620, 19, 70, "Input",ExpressionUUID->"7970b768-b555-4387-a5c2-70d647666de3",
 CellID->295074245],
Cell[135563, 3436, 1718, 43, 70, "Output",ExpressionUUID->"76765ad2-599c-4fa5-931e-67c237c53b92",
 CellID->266394469]
}, Open  ]],
Cell[CellGroupData[{
Cell[137318, 3484, 396, 10, 70, "Input",ExpressionUUID->"c1958313-237f-4f0b-85a0-686e37d76059",
 CellID->1128104794],
Cell[137717, 3496, 1246, 34, 70, "Output",ExpressionUUID->"095e0267-e31f-4af4-b4d9-870bc370ecb6",
 CellID->667892655]
}, Open  ]],
Cell[138978, 3533, 130, 1, 70, "ExampleText",ExpressionUUID->"16d99db7-e287-4d7d-93f9-c8fa6568bf3d",
 CellID->851396083],
Cell[CellGroupData[{
Cell[139133, 3538, 379, 9, 70, "Input",ExpressionUUID->"0011290a-2293-4f2c-aa24-a9ee837ae5be",
 CellID->730427020],
Cell[139515, 3549, 10774, 276, 70, "Output",ExpressionUUID->"2bdcc7af-7272-48c5-8e69-96e2ab528034",
 CellID->1659271935]
}, Open  ]],
Cell[CellGroupData[{
Cell[150326, 3830, 667, 18, 70, "Input",ExpressionUUID->"f66ad0ac-c028-4ddc-8b56-438c95de4b27",
 CellID->1311692142],
Cell[150996, 3850, 1377, 40, 70, "Output",ExpressionUUID->"d52411dc-9fe3-49e8-ad53-7461aa6bd184",
 CellID->1987484122],
Cell[152376, 3892, 1515, 43, 70, "Output",ExpressionUUID->"22519ac0-a9db-452f-b81f-8c663639f900",
 CellID->1684993016]
}, Open  ]],
Cell[153906, 3938, 154, 1, 70, "ExampleText",ExpressionUUID->"dde77e00-6eda-48b1-87a3-a371d6d14916",
 CellID->179211657],
Cell[154063, 3941, 551, 14, 70, "Input",ExpressionUUID->"8ca6fe84-08b7-44ed-ade9-3100dc09b751",
 CellID->1238246105],
Cell[CellGroupData[{
Cell[154639, 3959, 469, 13, 70, "Input",ExpressionUUID->"4ee990d1-9c06-4f2f-a437-c2da69430c0e",
 CellID->2085747305],
Cell[155111, 3974, 12731, 361, 70, "Output",ExpressionUUID->"8367cdc0-0792-4df1-af9c-e40c48425715",
 CellID->1719884081]
}, Open  ]],
Cell[CellGroupData[{
Cell[167879, 4340, 571, 16, 70, "Input",ExpressionUUID->"7336bc5e-e9d1-4611-a50a-e3579043648f",
 CellID->1400974601],
Cell[168453, 4358, 373, 7, 70, "Output",ExpressionUUID->"8f3867e6-6a59-47cb-bb11-f43d6e6f6847",
 CellID->1081338500]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[169195, 4378, 1393, 36, 70, "SeeAlsoSection",ExpressionUUID->"8c54a668-572f-42e3-b2ca-0158a7dde777"],
Cell[170591, 4416, 1134, 29, 70, "TechNotesSection",ExpressionUUID->"af744b80-53c9-47af-b898-86960e219a5f"],
Cell[171728, 4447, 1497, 37, 70, "MoreAboutSection",ExpressionUUID->"bc2a68d0-2f7a-463c-b944-2e43d2c34cac"],
Cell[173228, 4486, 4837, 127, 70, "RelatedLinksSection",ExpressionUUID->"7b7c57dc-5e40-4c64-a4c0-f6efd132c7bb"],
Cell[178068, 4615, 78, 0, 70, "FooterCell",ExpressionUUID->"ddfadf0f-e26b-42ae-8546-29c856b6f6e1"]
}
]
*)

(* End of internal cache information *)
