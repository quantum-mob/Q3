(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    197335,       5006]
NotebookOptionsPosition[    177709,       4609]
NotebookOutlinePosition[    180290,       4672]
CellTagsIndexPosition[    180203,       4667]
WindowTitle->BravyiDensityMatrix
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "86e6e6a9-e591-469e-ad51-7ab3e8b72bb4"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "69386014-c8dd-4c09-8f04-ff90995ebd5c"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "f2806994-bd2a-4dd3-803c-88ac1b2be6bb"]
         }],ExpressionUUID->"882642b3-2b93-4534-ae51-bd8edde2eae0"],
         StripOnInput->False],{
        StyleBox["\"BravyiGreen\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/BravyiGreen"], 
         StyleBox["\"BravyiState\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/BravyiState"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "d6f25534-890d-4ce4-acfd-4bec9f902bc0"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "4250ed57-5105-4dd3-a784-f8cced1f7c6a"]
         }],ExpressionUUID->"f9700db3-1e93-4b35-b3e2-c289946de21b"],
         StripOnInput->False],{
        "\"Fermionic Quantum Computation\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/FermionicQuantumComputation"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "4e260798-aeea-4657-9b84-1d55f836657e"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "885a5e2a-252e-4a4a-a6cc-853d32f95c3a"]
         }],ExpressionUUID->"3b5d3cc4-6ab6-472f-80f9-6a5dacb874f7"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "969dccc1-662f-41b3-8d8b-fc8fa76dcda2"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "59469ef6-9b37-4823-9412-dc31f18dbb1e"]
         }],ExpressionUUID->"d145fb5b-37ac-4905-8101-887c18e8d787"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/BravyiDensityMatrix\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/BravyiDensityMatrix"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
BravyiDensityMatrix.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/BravyiDensityMatrix") <> ".html"], 
              None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "d4e1aafa-5153-46da-b7a9-ec8025355e72"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "572cc5e1-92b0-495e-a2d3-0386659f8935"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"dfd81d2d-d7c3-438a-b864-1b589f0c8a18"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"2189ed41-6b30-43c7-81ea-a80a0983b6a6"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "BravyiDensityMatrix", "ObjectName",ExpressionUUID->
      "df8f34cc-f974-4be1-83fa-546c8a30e1fe"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"11d8c78a-6a4c-4264-89e1-d126d86a4b8a"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "7cda5246-ac3c-466a-a9e2-190870837511"]
    }],ExpressionUUID->"515f9509-9b02-4aad-a3ef-603d022312b8"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.1\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->LightDarkSwitched[
              RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "d91f3368-b101-4e75-9d30-3ce8a0d70a8b"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"84128f0f-9675-4310-8eb6-c416966994f0"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["BravyiDensityMatrix"]], 
         "paclet:QuantumMob/Q3/ref/BravyiDensityMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["grn", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "a078e257-6de9-46d5-b81f-3a4c43bc8819"],
     "\[LineSeparator]returns the density matrix corresponding to the \
single-particle Green's function ",
     Cell[BoxData[
      StyleBox["grn", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "75f352bb-ef15-4fdf-8101-f528317798b5"],
     ", assuming that ",
     Cell[BoxData[
      StyleBox["grn", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "b4750c24-04ca-4a1e-9aa4-caa1f51ecb04"],
     " is associated with a fermionic Gaussian state."
    }],ExpressionUUID->"f39438b1-e9a2-41b3-9443-afeaf268408e"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["BravyiDensityMatrix"]], 
         "paclet:QuantumMob/Q3/ref/BravyiDensityMatrix", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["ws", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "bc43b55b-ac8e-4a39-901f-47fef80affa4"],
     "\[LineSeparator]is a shortcut and returns the density matrix \
corresponding to the Bravyi or Nambu state ",
     Cell[BoxData[
      StyleBox["ws", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "e20eea8d-16d4-4616-8777-f7cdfb125d29"],
     "."
    }],ExpressionUUID->"6e60ffa3-b33d-4b91-8e72-ad12a4c4af6a"]}
  }]], "Usage",
 CellID->837314546,ExpressionUUID->"203e03ea-cd8a-4377-8be6-970387efff92"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[CurrentValue[
         EvaluationCell[], "CellGroupOpen"] =!= Closed, 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"ebb21d41-141e-447e-88d3-cb5dbf9ed1d3"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"38569c93-d613-45cc-949c-54a1c0ecd552"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"a56cd3d0-215f-4d90-a94a-aa5674835067"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"5c6be452-741d-48c0-861e-7fc65f51a704"]], \
"NotesSection",
 ShowGroupOpener->"Thumbnail",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->681064617,ExpressionUUID->"29e198f7-026c-4820-b972-3c8d1d222700"],

Cell[TextData[{
 Cell[BoxData[
  TemplateBox[{
    Cell[
     TextData["BravyiDensityMatrix"]], 
    "paclet:QuantumMob/Q3/ref/BravyiDensityMatrix", 
    "QuantumMob Package Symbol"},
   "PackageLink",
   BaseStyle->"InlineFormula"]], "InlineFormula",
  FontFamily->"Source Sans Pro",ExpressionUUID->
  "211f96e1-ee60-48b5-a27d-de14feb0bec0"],
 " is intended for elementary tests, but not for practical calculations for \
large systems."
}], "Notes",
 CellID->285235831,ExpressionUUID->"79284a02-2a63-4e86-bc05-9bcfe9fd73d8"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"c6aa4679-5ff8-4042-b88a-e61bd4cf1180"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"3f7453ae-5252-418d-850e-da40381da9aa"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(5)", "ExampleCount",ExpressionUUID->
  "c2a300b5-8584-49a6-b4c1-64588bf8fcf3"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->565179409,ExpressionUUID->"28b9ab3d-eba5-4d65-94dc-69d72ec69a9d"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1940205291,ExpressionUUID->"fbfea4a5-a747-476d-b2c7-bb1c509181e3"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"3b94e4f6-7e08-4af5-bed3-374a3488e26b"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"db3a4fc5-eb7b-4061-a805-30869a6cf2f7"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "3c1f9cb8-c0b0-46b5-9984-88d8f6c47737"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->650156382,ExpressionUUID->"36ddef4d-93d8-49ed-8b63-72293e2ffa62"],

Cell["Consider a few fermion modes:", "ExampleText",
 CellID->1579571379,ExpressionUUID->"9f4077a8-1574-448d-8c13-287cb85615ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->2144923147,ExpressionUUID->"5196832d-5746-4be8-9ab0-09b49b646cc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "357", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1611621965,ExpressionUUID->"6406b301-5198-4aa9-acab-69f038e27abf"],

Cell["Pick a Bravyi state (fermionic Gaussian state):", "ExampleText",
 CellID->1793530776,ExpressionUUID->"e199f575-d3db-4dc2-8cbc-0eef222adbae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ws", "=", 
  RowBox[{"RandomBravyiState", "[", "$n", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1279536004,ExpressionUUID->"b5c59a3b-7160-4730-8930-9b2256759786"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["BravyiState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Prefactor: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["1", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Covariance matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{
                    "0", "0.1489988513511953`", "0.27755039339664933`", 
                    "0.824375870374534`", "\"\[Ellipsis]\""}, {
                    RowBox[{"-", "0.14899885135119534`"}], "0", 
                    RowBox[{"-", "0.9046672948367519`"}], 
                    "0.22907506773957562`", "\"\[Ellipsis]\""}, {
                    RowBox[{"-", "0.27755039339664933`"}], 
                    "0.9046672948367518`", "0", 
                    RowBox[{"-", "0.26712575441926795`"}], 
                    "\"\[Ellipsis]\""}, {
                    RowBox[{"-", "0.824375870374534`"}], 
                    RowBox[{"-", "0.2290750677395755`"}], 
                    "0.2671257544192679`", "0", "\"\[Ellipsis]\""}, {
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", "\"\[Ellipsis]\"", 
                    "\"\[Ellipsis]\"", "\"\[Ellipsis]\""}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {5, 5}, 0, {
                    1, {{0, 4, 8, 12, 16, 21}, {{2}, {3}, {4}, {5}, {1}, {
                    3}, {4}, {5}, {1}, {2}, {4}, {5}, {1}, {2}, {3}, {5}, {
                    1}, {2}, {3}, {4}, {5}}}, {
                    0.1489988513511953, 0.27755039339664933`, 
                    0.824375870374534, 
                    "\[Ellipsis]", -0.14899885135119534`, -0.9046672948367519,
                     0.22907506773957562`, 
                    "\[Ellipsis]", -0.27755039339664933`, 
                    0.9046672948367518, -0.26712575441926795`, 
                    "\[Ellipsis]", -0.824375870374534, -0.2290750677395755, 
                    0.2671257544192679, "\[Ellipsis]", "\[Ellipsis]", 
                    "\[Ellipsis]", "\[Ellipsis]", "\[Ellipsis]", 
                    "\[Ellipsis]"}}], TableHeadings -> None, {}]]], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`BravyiState[{
   1, SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 5, 10, 15, 20, 25, 30}, {{2}, {3}, {4}, {5}, {6}, {1}, {3}, {
       4}, {5}, {6}, {1}, {2}, {4}, {5}, {6}, {1}, {2}, {3}, {5}, {6}, {1}, {
       2}, {3}, {4}, {6}, {1}, {2}, {3}, {4}, {5}}}, {0.1489988513511953, 
      0.27755039339664933`, 
      0.824375870374534, -0.33641658921820405`, -0.3286235296877096, \
-0.14899885135119534`, -0.9046672948367519, 
      0.22907506773957562`, -0.30359331215138496`, 
      0.12137603596196012`, -0.27755039339664933`, 
      0.9046672948367518, -0.26712575441926795`, -0.12010322782643197`, \
-0.13697412445322893`, -0.824375870374534, -0.2290750677395755, 
      0.2671257544192679, -0.24319800588375032`, 0.3707122859367387, 
      0.33641658921820405`, 0.303593312151385, 0.12010322782643196`, 
      0.24319800588375035`, 0.849167194323698, 
      0.3286235296877096, -0.12137603596196014`, 
      0.13697412445322882`, -0.3707122859367387, -0.849167194323698}}]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1374224457,ExpressionUUID->"b5418074-01bb-4273-8399-8e1fc6fb3ef8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Norm", "[", "ws", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->79841072,ExpressionUUID->"a6322626-1c60-4e0e-a916-420f483bbfbe"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[4]=",
 CellID->1159916761,ExpressionUUID->"b8e0f743-dfd7-431b-9cbd-5726bf1217ee"]
}, Open  ]],

Cell["Calculate the Green's function:", "ExampleText",
 CellID->829017474,ExpressionUUID->"f94c8b33-3c26-4f9e-aac4-8c971b6ae68e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"BravyiGreen", "[", "ws", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1228699821,ExpressionUUID->"d291a06d-1af1-4ebb-b399-beb8a9dcf473"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.08781206481273302`", 
        RowBox[{"0.026835380369657137`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.023549788633138752`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.14893732102674437`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.16206566983334703`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.02683538036965711`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.023549788633138752`", " ", "\[ImaginaryI]"}]}], 
        "0.6517966560756925`", 
        RowBox[{
         RowBox[{"-", "0.0003182020338820396`"}], "+", 
         RowBox[{"0.013875025128263468`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.1489373210267444`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.16206566983334703`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.00031820203388204307`"}], "-", 
         RowBox[{"0.01387502512826344`", " ", "\[ImaginaryI]"}]}], 
        "0.5684870622266145`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{
         RowBox[{"-", "0.1413729142394449`"}], "-", 
         RowBox[{"0.09804921430873641`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.015374443817110423`"}], "+", 
         RowBox[{"0.023290473135022347`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.14137291423944492`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.09804921430873642`", " ", "\[ImaginaryI]"}]}], "0", 
        RowBox[{"0.06036981594709802`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.43845862229011245`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.015374443817110409`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.023290473135022347`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.06036981594709803`"}], "-", 
         RowBox[{"0.43845862229011245`", " ", "\[ImaginaryI]"}]}], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->976797241,ExpressionUUID->"6fc7a472-4a09-47eb-8bbd-68f0fa718dfb"]
}, Open  ]],

Cell["Calculate the density matrix:", "ExampleText",
 CellID->1287199281,ExpressionUUID->"a73ca52b-948a-474d-85a3-afea90d33c11"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"BravyiDensityMatrix", "[", "grn", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayShort", "[", 
  RowBox[{"rho", ",", 
   RowBox[{"\"\<Size\>\"", "->", "8"}]}], "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1625237059,ExpressionUUID->"a01d8f5e-7b6e-44ac-aefa-da720defe728"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0.08556082933090559`", 
      RowBox[{"0.0003182020338819575`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.013875025128263368`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{
       RowBox[{"-", "0.14893732102674423`"}], "-", 
       RowBox[{"0.16206566983334697`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.14137291423944495`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.09804921430873648`", " ", "\[ImaginaryI]"}]}]},
     {"0", 
      RowBox[{"0.0003182020338819369`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.013875025128263396`", " ", "\[ImaginaryI]"}]}], 
      "0.002251235481827318`", "0", 
      RowBox[{
       RowBox[{"-", "0.0268353803696571`"}], "+", 
       RowBox[{"0.023549788633138863`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{
       RowBox[{"-", "0.015374443817110513`"}], "-", 
       RowBox[{"0.023290473135022357`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "0.14893732102674437`"}], "+", 
       RowBox[{"0.16206566983334714`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.026835380369657113`"}], "-", 
       RowBox[{"0.023549788633138842`", " ", "\[ImaginaryI]"}]}], "0", 
      "0.566235826744787`", "0", "0", 
      RowBox[{
       RowBox[{"-", "0.060369815947097956`"}], "+", 
       RowBox[{"0.4384586222901126`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"0.14137291423944492`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.09804921430873648`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.015374443817110494`"}], "+", 
       RowBox[{"0.023290473135022343`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{
       RowBox[{"-", "0.06036981594709791`"}], "-", 
       RowBox[{"0.43845862229011223`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0.34595210844248014`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->580600593,ExpressionUUID->"6aa6f797-2dcf-4bdd-b57b-bd9b30d0feae"]
}, Open  ]],

Cell["\<\
Verify it by calculating the density matrix from the vector representation of \
the Gaussian state:\
\>", "ExampleText",
 CellID->2088378959,ExpressionUUID->"a36e7d82-232e-4eec-9ca3-4ea345093a13"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"Matrix", "[", "ws", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alt", "=", 
   RowBox[{"Dyad", "[", 
    RowBox[{"vec", ",", "vec"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayShort", "[", 
  RowBox[{"rho", ",", 
   RowBox[{"\"\<Size\>\"", "->", "8"}]}], "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1687043485,ExpressionUUID->"f4c00a8d-d1e7-460b-9eb9-4c6d73a2c4aa"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0.08556082933090559`", 
      RowBox[{"0.0003182020338819575`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.013875025128263368`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{
       RowBox[{"-", "0.14893732102674423`"}], "-", 
       RowBox[{"0.16206566983334697`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{"0.14137291423944495`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.09804921430873648`", " ", "\[ImaginaryI]"}]}]},
     {"0", 
      RowBox[{"0.0003182020338819369`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.013875025128263396`", " ", "\[ImaginaryI]"}]}], 
      "0.002251235481827318`", "0", 
      RowBox[{
       RowBox[{"-", "0.0268353803696571`"}], "+", 
       RowBox[{"0.023549788633138863`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      RowBox[{
       RowBox[{"-", "0.015374443817110513`"}], "-", 
       RowBox[{"0.023290473135022357`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "0.14893732102674437`"}], "+", 
       RowBox[{"0.16206566983334714`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.026835380369657113`"}], "-", 
       RowBox[{"0.023549788633138842`", " ", "\[ImaginaryI]"}]}], "0", 
      "0.566235826744787`", "0", "0", 
      RowBox[{
       RowBox[{"-", "0.060369815947097956`"}], "+", 
       RowBox[{"0.4384586222901126`", " ", "\[ImaginaryI]"}]}]},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"0.14137291423944492`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.09804921430873648`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.015374443817110494`"}], "+", 
       RowBox[{"0.023290473135022343`", " ", "\[ImaginaryI]"}]}], "0", 
      RowBox[{
       RowBox[{"-", "0.06036981594709791`"}], "-", 
       RowBox[{"0.43845862229011223`", " ", "\[ImaginaryI]"}]}], "0", "0", 
      "0.34595210844248014`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->1409814138,ExpressionUUID->"f828d39e-6a17-4719-bfb3-59092714a217"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rho", "-", "alt"}], "//", "ArrayZeroQ"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1578285105,ExpressionUUID->"4b682c93-b12b-4372-b44c-b7b9d97129ad"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[8]=",
 CellID->1217362739,ExpressionUUID->"c22eaf46-9fd7-478b-b008-24c85cb2ca50"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "10153c5c-1ba9-418f-bbcf-c767af36a04b"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"808cf2ce-1eba-4dd1-992f-c7c393d3b6e2"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(4)", "ExampleCount",ExpressionUUID->
  "4caa5843-d714-41f7-af04-83532145b16a"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->65633975,ExpressionUUID->"626561d9-8a6e-4b01-9631-6f8d9eeb60a2"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "966b2c3e-86a6-4c4b-8e12-23550f96545c"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"839b5ddc-61a4-4de0-96cb-4dace46bdd07"],
 "Manifestly Gaussian: without pairing",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "c2778181-2b59-4c8b-a673-8f2ea335e454"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->497423321,ExpressionUUID->"c71ba834-85c5-4f7c-bb05-7050e35241c9"],

Cell["\<\
Here, we construct a manifestly Gaussian state, and calculate the density \
matrix using the Bravyi tools.\
\>", "ExampleText",
 CellID->1625303001,ExpressionUUID->"d48819ca-4053-47b1-99a0-0ec8b57ed492"],

Cell["Consider some fermion modes:", "ExampleText",
 CellID->2146590148,ExpressionUUID->"e4b79ce0-86e2-4adb-8f50-773a3ce98baf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$N", "=", 
   RowBox[{"Power", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->1998991449,ExpressionUUID->"f60d4dd9-d4ae-4c40-a8e5-dfd1346f6a10"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "[", 
   RowBox[{"Range", "@", "$n"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1412231210,ExpressionUUID->"88664c70-f646-4279-843e-f978dbdf9e54"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1671700638,ExpressionUUID->"9a9e85c6-c79e-4ebe-af2d-c306f4a1041f"]
}, Open  ]],

Cell["Construct a Gaussian density matrix:", "ExampleText",
 CellID->1531256439,ExpressionUUID->"f794ef63-9855-464d-8cf3-e9b8faad376d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "357", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1340151952,ExpressionUUID->"5989500c-9b4b-46d3-aa51-c3655ea97f2b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ham", "=", 
   RowBox[{"RandomHermitian", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ham", "=", 
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "@", "cc"}], ",", 
     RowBox[{"ham", ".", "cc"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"Matrix", "[", 
     RowBox[{"ham", ",", "cc"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "/=", 
  RowBox[{"Tr", "[", "rho", "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1713041365,ExpressionUUID->"80592d7a-e10e-40fe-902a-8612807aaec1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtkPNnH1
1bNydW9ftD9fmqHFlfPEftMaHpGoS++oZr5KzjX3Z1Mv2hsc1Wd/fP2Y/Rq/
AOvPbc9wqg/ZxmH9PPWyfff7z2G69evsfa3ZXy8Temy/s9vAdeeWF/Y33Jev
q5n21v5kRO6/+K/vaR4+HFs/i2WnXbKPkAm61bjqgP2WUh45J4OnONWv/Tcp
65H4Q/vcmIcNzxpe2qfMvZ6d3f/e3rKBlbHf97I91/nnMcqLN9u7l66akLzl
Mcnu2f9t2gXDhgv2UTPFFL4LnrevT6veGuH/wv6HOq9i1/fz9m1SFrO962/b
Vzc0VJxmf4PTnKbk1sWXTl6z9ylo3alU9My+K2rpRHFn2ocnqeLTjs3Z0ZN6
wd4w0u6pUeE9+5aQ+xtLl+L2l221hxrfoUv2UlrTdos9320v+nKR8oqZT+zf
L220cLa6aF9zZlvzzb6T9l63d5r2yj4n2T2Bc6z/hj0+Z6/9xKf6dNdle2WD
LNeP3K/sO2Rd2jbLXrQXX/JH8OqJh/ZzPjhwftj+Fqc5pMYXtcS7pmnnp527
YK9um6Btu+6BvY3MYue9jm/td2s8lZ4767x9awKnbYD+JfuWxQze4aUvcZrz
Zc/r+1duX7Dnn9S/mCH6jP2Dm4K79+0gPTxxiQvqdNxXtDxvf4J/tuLRGzfs
f4n6X3xS+XrQpU9c4gAyqh1i
              "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> False, 
             Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["20", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggGIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtkPNnH1
1bNydW9ftD9fmqHFlfPEftMaHpGoS++oZr5KzjX3Z1Mv2hsc1Wd/fP2Y/Rq/
AOvPbc9wqg/ZxmH9PPWyfff7z2G69evsfa3ZXy8Temy/s9vAdeeWF/Y33Jev
q5n21v5kRO6/+K/vaR4+HFs/i2WnXbKPkAm61bjqgP2WUh45J4OnONWv/Tcp
65H4Q/vcmIcNzxpe2qfMvZ6d3f/e3rKBlbHf97I91/nnMcqLN9u7l66akLzl
Mcnu2f9t2gXDhgv2UTPFFL4LnrevT6veGuH/wv6HOq9i1/fz9m1SFrO962/b
Vzc0VJxmf4PTnKbk1sWXTl6z9ylo3alU9My+K2rpRHFn2ocnqeLTjs3Z0ZN6
wd4w0u6pUeE9+5aQ+xtLl+L2l221hxrfoUv2UlrTdos9320v+nKR8oqZT+zf
L220cLa6aF9zZlvzzb6T9l63d5r2yj4n2T2Bc6z/hj0+Z6/9xKf6dNdle2WD
LNeP3K/sO2Rd2jbLXrQXX/JH8OqJh/ZzPjhwftj+Fqc5pMYXtcS7pmnnp527
YK9um6Btu+6BvY3MYue9jm/td2s8lZ4767x9awKnbYD+JfuWxQze4aUvcZrz
Zc/r+1duX7Dnn9S/mCH6jP2Dm4K79+0gPTxxiQvqdNxXtDxvf4J/tuLRGzfs
f4n6X3xS+XrQpU9c4gAyqh1i
              "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> False, 
             Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["20", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.3125`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.025054727721722826`", "\[VeryThinSpace]"}], 
                    "-", 
                    
                    RowBox[{
                    "6.855577543667292`*^-19", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.0643522198329772`", "\[VeryThinSpace]"}], "-", 
                    
                    
                    RowBox[{
                    "6.01848968479367`*^-18", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.0010098844468969075`"}], "-", 
                    RowBox[{"0.05705729158334501`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "5"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"-", "0.01963278418126318`"}], "-", 
                    RowBox[{"0.06008657978151958`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {8, 8}, Complex[0., 0.], {
   1, {{0, 1, 4, 7, 10, 13, 16, 19, 20}, {{1}, {2}, {3}, {5}, {2}, {3}, {5}, {
     4}, {6}, {7}, {2}, {3}, {5}, {4}, {6}, {7}, {4}, {6}, {7}, {
     8}}}, CompressedData["
1:eJxTTMoPShNhYGAoZgESPpnFJWlMIB47kHDOzy3ISa0o4tLfHPBp+Uz7IrvD
6z+88NLcg6nErW+2eHLlBvuizICzTxIORmNRsmEDi/bh7oD9RV7TNjHNNVu7
H1NJ38rP1+dKTdlflKqix7f68DosSmrRTLHHVHLuTL5Y2Y+N9kUL/R7q122M
xOIWpXIrkdu5i+yLFmV9Tt4zbQEWi+pFrLWvHF5pX5Q+oWLaZOFALKbIcSyQ
S1Rcvr9oSmrr0ytflmAxZe/Rjn2ftwF9FKmr/bWiaBsW53bBPJ0M8TQWJXDn
LoA4F4uSQ194i513HrIvui9bNv9IWiIW58rCnDsZ4lwspjBccnwfvva0fVEi
06UJxalZNphK2mO8hOtj1uwv2m3ZamwYfgaLpw/APB0L8TQWJb0wU/ZBTMHi
lpz6ZXOkbK/YFyVNl7p/JL8Qi1v2HP7wYV7DHvuiyr8ntZ0lffYAABM7Aco=

    "]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->2117725931,ExpressionUUID->"640df672-debd-4843-a15d-dc0bc0199965"]
}, Open  ]],

Cell["Check the density matrix:", "ExampleText",
 CellID->1114864780,ExpressionUUID->"3e914d71-d53b-4165-8a85-4931b1183c79"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tr", "[", "rho", "]"}], "//", "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eigenvalues", "[", "rho", "]"}], "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1726168276,ExpressionUUID->"3f05e491-eb84-496e-85f1-6280c2b86cf4"],

Cell[BoxData["1.`"], "Output",
 CellLabel->"Out[5]=",
 CellID->1819883667,ExpressionUUID->"c73fb596-8b5a-4d4e-a6fb-46d33243b6f3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5242705365183049`", ",", "0.2141780982887552`", ",", 
   "0.1113375986322031`", ",", "0.06132959275452351`", 
   ",", "\<\"\[Ellipsis]\"\>"}], "}"}]], "Output",
 CellLabel->"Out[5]=",
 CellID->175207048,ExpressionUUID->"aa338335-3487-4350-afc9-0247cbc696f1"]
}, Open  ]],

Cell["Calculate the Green's functions:", "ExampleText",
 CellID->1488178613,ExpressionUUID->"4040b582-c127-470c-b1f5-6c611e45ebb8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Multiply", ",", "cc", ",", 
     RowBox[{"Dagger", "@", "cc"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"ops", ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ops", "//", "Dimensions"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1543102090,ExpressionUUID->"0badb20c-adb5-424f-8d7c-e92e2c151e60"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3", ",", "8", ",", "8"}], "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->2891139,ExpressionUUID->"ea073798-d0ea-4ad6-a821-693d58188a46"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"#", ".", "rho"}], "]"}], "&"}], ",", "ops", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "Dimensions"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1147281361,ExpressionUUID->"d7ed27d9-c4fe-4367-8123-d0dbfcc1de7a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3"}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->296362582,ExpressionUUID->"f99cfa05-335d-44fc-976a-a0eabeaf402f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.2099265958729045`", 
      RowBox[{"0.009182156342633939`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.07333044072984798`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.0005963727938047211`"}], "-", 
       RowBox[{"0.14777079137479474`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.009182156342633946`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.073330440729848`", " ", "\[ImaginaryI]"}]}], 
      "0.45191326374324897`", 
      RowBox[{"0.056403075884421956`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.2784681861264695`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.0005963727938046968`"}], "+", 
       RowBox[{"0.1477707913747947`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.05640307588442192`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.27846818612646945`", " ", "\[ImaginaryI]"}]}], 
      "0.5577604778395644`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->951338281,ExpressionUUID->"9c726d7b-8c8e-4cf3-a1ac-01d78550e388"]
}, Open  ]],

Cell["Reproduce the density matrix from the Green's functions:", "ExampleText",
 CellID->1295948158,ExpressionUUID->"4fdbd089-52a3-475a-9a24-5c488dd50eae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"BravyiDensityMatrix", "[", "grn", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "-", "rho"}], "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->916462759,ExpressionUUID->"8b0aa2b4-b048-4f1a-8fed-55442e86017d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[8]//MatrixForm=",
 CellID->209719098,ExpressionUUID->"9522cda4-e815-4265-98f8-f03238776462"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "-", "rho"}], "//", "ArrayZeroQ"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1292850891,ExpressionUUID->"9420d9dd-6d74-45c5-bbac-17d377a8b3b8"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[9]=",
 CellID->1017975932,ExpressionUUID->"faeff80e-21b9-44c8-b873-616c9be0e5bb"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "3ea49940-76ab-4ae9-a1d1-9effb4763fdc"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"f1b98729-9fd2-4cd2-85d3-3d4fa3a44e47"],
 "Manifestly Gaussian: with pairing",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "d827c0bc-6912-4739-97fe-84c9e7c3fc07"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1882279022,ExpressionUUID->"01ca9a70-e539-40d6-a63a-6cd2c1f00e35"],

Cell["Consider some fermion modes:", "ExampleText",
 CellID->707366989,ExpressionUUID->"e92779da-576d-43d8-a307-9e0e88f04db2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$N", "=", 
   RowBox[{"Power", "[", 
    RowBox[{"2", ",", "$n"}], "]"}]}], ";"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[1]:=",
 CellID->297536878,ExpressionUUID->"a32c3e1f-705b-45cc-b60e-a09a5cebd8e1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "[", 
   RowBox[{"Range", "@", "$n"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ccdd", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"cc", ",", 
    RowBox[{"Dagger", "@", "cc"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[2]:=",
 CellID->891360236,ExpressionUUID->"b1b7754d-ffec-45dc-be12-5cf562e926a3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->816483153,ExpressionUUID->"7c18a8ba-dfed-4299-823a-4ee02bf035c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    QuantumMob`Q3`Dagger[
     $CellContext`c[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    QuantumMob`Q3`Dagger[
     $CellContext`c[2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    QuantumMob`Q3`Dagger[
     $CellContext`c[3]]]}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->211848141,ExpressionUUID->"d97fe53e-78c8-44bf-a049-5af2f303e9ce"]
}, Open  ]],

Cell["Construct a Gaussian density matrix:", "ExampleText",
 CellID->1215678238,ExpressionUUID->"bd559760-c23e-437a-b0ac-c0db2dd591bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "357", "]"}], ";"}]], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[3]:=",
 CellID->638652385,ExpressionUUID->"4cec1836-5239-4a6a-83af-ec7576bb8853"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ham", "=", 
   RowBox[{"RandomNambuHermitian", "[", "$n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ham", "=", 
   RowBox[{
    RowBox[{"MultiplyDot", "[", 
     RowBox[{
      RowBox[{"Dagger", "@", "ccdd"}], ",", 
      RowBox[{
       RowBox[{"Normal", "[", "ham", "]"}], ".", "ccdd"}]}], "]"}], "/", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"Matrix", "[", 
     RowBox[{"ham", ",", "cc"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "/=", 
  RowBox[{"Tr", "[", "rho", "]"}]}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[4]:=",
 CellID->1523597312,ExpressionUUID->"ce413d11-669a-40ab-8d7f-42048552de79"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJyVVH1MzHEcPhQVYyr9HJPOSSmlJtpdeLw1r3kPHdV6IevHEMkkHS421KEi
Ra2YTiXFadLrdJbe7n53Xa+rKafrrrvuYgtjXmbz7/eP++O7fffs2ef7fD7P
8/1wIk/sPjyJxWLZ/D//7vyEqrDsBXI8WFYg9f+uhq6Ao9lVNAKXEuc++7JO
rNzJOsantZDU+yyk15khK6fTPcRKVE8szvUM1YAbHPd0eoQJpDqcnJb1dfYq
ZHt/e7HHewj54QfjRVwzkU/ChYv0P7q8tagPklp9DTDiml9ea2a7GRL3gfFk
RyUEmsFhO8kgOkOTZvKKRi2u70gvnXUmTw6bFKrZ5VUnJn0ZCQmdYiDyTTvu
3HYRKxA3L/EoFaiC1dS3uY0X9ai84RNYKdWhe2Nh6YW7o2g6cPx3+Di53+3L
OeJSfwaxF4qjtnr0Q/3HZsLsCKPF+lvjHIJSxAxyRWv1VQ/luOGqyHNfoSPy
r99n73kX9wGlAV4/e2Q6zI+X8mclmdHMyzp9ebkCRu0aI8uswtmmqyr6vd5i
PYZ1WmdlhQLJSU7uhVm9KI91psVdBvjmSJgaNYMYO1uPTtkANvXU6n22kv3K
LBlfVbi/F7te8iV+R4Zxk1L7fhJYnh9SDmN8uT4BI3IY5J/csuu60GFbX0eB
7DsJF49K4mXXGTjUJf0+ff4DrmXnNpn6yD6+iXFaXRHJ4BbVNpb2WYFfmvT2
1mQdLnVZJ9RGyeE1X9AQMtCBYH9tbX8v+V0Szp59r+rUZAbbw94bnuxTolhn
vfAkpQc9RyTqv9IOx8WZDw/cHkJ/mHDlEi/yPH9G1+RlfWGwrybmGW/pIL6m
N4jKEiz/X6mJwkjrZ0oUvbJdIG7UQDkjYUNaKnlvlGBoC7uqDxO6PXkBdjqk
qFjSj7FmeHIzmtcsY6DOmHi0poQBz2PtWEsbOechz6uFcxMVeEyFcAYaemBV
xmZmFFvu7yMq8fjmcx2wjuWW36W0eJ0v3Lieb8beYdvkaIESg99N8rn5H+EY
NKw5bE/ui4T/kG2Tj7kq0OhX4B2R0Y0rMpngHk3WKaKn1bezGYidTIdEwX1w
C7Q6kuVntHgf/gU8WhoB
              "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> False, 
             Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["32", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJyVVH1MzHEcPhQVYyr9HJPOSSmlJtpdeLw1r3kPHdV6IevHEMkkHS421KEi
Ra2YTiXFadLrdJbe7n53Xa+rKafrrrvuYgtjXmbz7/eP++O7fffs2ef7fD7P
8/1wIk/sPjyJxWLZ/D//7vyEqrDsBXI8WFYg9f+uhq6Ao9lVNAKXEuc++7JO
rNzJOsantZDU+yyk15khK6fTPcRKVE8szvUM1YAbHPd0eoQJpDqcnJb1dfYq
ZHt/e7HHewj54QfjRVwzkU/ChYv0P7q8tagPklp9DTDiml9ea2a7GRL3gfFk
RyUEmsFhO8kgOkOTZvKKRi2u70gvnXUmTw6bFKrZ5VUnJn0ZCQmdYiDyTTvu
3HYRKxA3L/EoFaiC1dS3uY0X9ai84RNYKdWhe2Nh6YW7o2g6cPx3+Di53+3L
OeJSfwaxF4qjtnr0Q/3HZsLsCKPF+lvjHIJSxAxyRWv1VQ/luOGqyHNfoSPy
r99n73kX9wGlAV4/e2Q6zI+X8mclmdHMyzp9ebkCRu0aI8uswtmmqyr6vd5i
PYZ1WmdlhQLJSU7uhVm9KI91psVdBvjmSJgaNYMYO1uPTtkANvXU6n22kv3K
LBlfVbi/F7te8iV+R4Zxk1L7fhJYnh9SDmN8uT4BI3IY5J/csuu60GFbX0eB
7DsJF49K4mXXGTjUJf0+ff4DrmXnNpn6yD6+iXFaXRHJ4BbVNpb2WYFfmvT2
1mQdLnVZJ9RGyeE1X9AQMtCBYH9tbX8v+V0Szp59r+rUZAbbw94bnuxTolhn
vfAkpQc9RyTqv9IOx8WZDw/cHkJ/mHDlEi/yPH9G1+RlfWGwrybmGW/pIL6m
N4jKEiz/X6mJwkjrZ0oUvbJdIG7UQDkjYUNaKnlvlGBoC7uqDxO6PXkBdjqk
qFjSj7FmeHIzmtcsY6DOmHi0poQBz2PtWEsbOechz6uFcxMVeEyFcAYaemBV
xmZmFFvu7yMq8fjmcx2wjuWW36W0eJ0v3Lieb8beYdvkaIESg99N8rn5H+EY
NKw5bE/ui4T/kG2Tj7kq0OhX4B2R0Y0rMpngHk3WKaKn1bezGYidTIdEwX1w
C7Q6kuVntHgf/gU8WhoB
              "], {{0, 0}, {8, 8}}, {0, 1}], AspectRatio -> 1, Axes -> False, 
             Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "GridLinesInFront" -> True, "AxisPadding" -> Scaled[0.02], 
               "DefaultBoundaryStyle" -> Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}, 
             PlotRangePadding -> Automatic, PlotRangePadding -> 
             Scaled[0.025]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["32", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{
                    RowBox[{"0.`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.5`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.058544827668892525`", "\[VeryThinSpace]"}], 
                    "+", 
                    
                    RowBox[{
                    "6.106769328167756`*^-18", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.003046407929773202`", "\[VeryThinSpace]"}], 
                    "-", 
                    RowBox[{"0.01547227318121875`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "6"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.016507953899620398`", "\[VeryThinSpace]"}], 
                    "-", 
                    RowBox[{"0.007584355345183995`", " ", "\[ImaginaryI]"}]}],
                     ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{
                    RowBox[{"0.046645033333915474`", "\[VeryThinSpace]"}], 
                    "-", 
                    RowBox[{"0.06632331561932078`", " ", "\[ImaginaryI]"}]}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {8, 8}, Complex[0., 0.], {
   1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{1}, {4}, {6}, {7}, {2}, {3}, {
     5}, {8}, {2}, {3}, {5}, {8}, {1}, {4}, {6}, {7}, {2}, {3}, {5}, {8}, {
     1}, {4}, {6}, {7}, {1}, {4}, {6}, {7}, {2}, {3}, {5}, {
     8}}}, CompressedData["
1:eJxTTMoPSlNgYGAoZgESPpnFJWlMIB47kHDOzy3ISa0oOqmbUDDt51r7olM+
CcdnasbYYCqxadp+9viXDPuiJczlUW/X9+/HVPJhQy1H2fMJ9kVCBZsfHRWo
x6LE2T1x5u2Hy+2Lzkn2TJ/wawMWJcvM8gxtluyzL9ry6PnkfTNq9mAqeWCS
rhVdPG1/UfCSrV+iqrdjMUXVp7nP/We1fVEH28uAO7s3Y1Gi82vW1ucvt9sX
KX/qV9rptw+Lkuswi0IgFtljKvHiPiEp2rXNvujHUu6VJp4xWJy7zbcpUcEF
6OmktefT3rqXYjHlxssDC8x2b7Avsr3oHZLxewcWJVKwCFgFiQAsSp4tEfRO
711gX2T8tE7SbnUIlmhk2v7/56s/QB8FbdV4tWfyTCyeVhZeGvGjyMu+qPIa
a0JE8SosFmnAQrcTErpYlGyFeToZ4mksFpVuzc8NL91jX6SWKh/p1R6Hxbk5
0y9GqssDQzfS5r3MJZMFWCz6DEt17JBUh0UJM5qnsShx+qcoK7PjgH2RbK91
m+2SdCxuecp/zNTm5KT9RRdzzdf06h7A4iMnWPI+D0neWCyyg4VuKSR0sZjy
CmbRBYhFWEwRbtP7KW583r7o2BLvA8E1pVicqwdL3vKQ5I3FlKtoqQ6LW9Aj
AIsSV+4GOYuFp+2LXrvsC86vKtwDAKr2m1o=
    "]}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1893307887,ExpressionUUID->"9612e90b-d988-43f2-b939-dc08e5f4c325"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rho", "//", "MatrixForm"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->947799548,ExpressionUUID->"9fb876f7-7db2-427a-83e1-4ca7f4d1ace1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.058544827668892525`", "\[VeryThinSpace]", "+", 
       RowBox[{"6.106769328167756`*^-18", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.003046407929773202`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.01547227318121875`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.016507953899620398`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.007584355345183995`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.046645033333915474`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.06632331561932078`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.11969352919387663`", "\[VeryThinSpace]", "-", 
       RowBox[{"2.480364697121887`*^-17", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.021924423659403725`"}], "-", 
       RowBox[{"0.09172600244859667`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.006829528349231705`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.07708527541492505`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09341285880780309`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.11838872045331832`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.021924423659403693`"}], "+", 
       RowBox[{"0.09172600244859669`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.08804447059087042`", "\[VeryThinSpace]", "-", 
       RowBox[{"6.1335398094976944`*^-18", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.04544163885398282`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.005195548391366019`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.06535664963386212`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.09758617456447367`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.0030464079297731874`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.01547227318121876`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.03232882300728494`", "\[VeryThinSpace]", "+", 
       RowBox[{"4.481856794238419`*^-18", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.02244918013450726`"}], "-", 
       RowBox[{"0.024977638046199964`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0008071625355020356`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.05166126415398948`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.006829528349231707`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.07708527541492506`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.045441638853982814`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.00519554839136602`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1111654894045467`", "\[VeryThinSpace]", "+", 
       RowBox[{"6.61980848013676`*^-18", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.08641286795463338`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.03165299037174724`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.016507953899620408`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.007584355345183986`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.022449180134507262`"}], "+", 
       RowBox[{"0.024977638046199964`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.13061858580111801`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.0252893927536929`*^-17", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.01834577635010239`"}], "-", 
       RowBox[{"0.1263901797200178`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.04664503333391547`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0663233156193208`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0008071625355020385`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.05166126415398945`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.018345776350102407`"}], "+", 
       RowBox[{"0.12639017972001776`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.24374675433232137`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.863583327689154`*^-17", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09341285880780312`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.11838872045331826`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.06535664963386208`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.09758617456447367`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.08641286795463338`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.03165299037174724`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.21585752000108918`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.5159975026254842`*^-17", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {8, 8}, Complex[0., 0.], {
     1, {{0, 4, 8, 12, 16, 20, 24, 28, 32}, {{1}, {4}, {6}, {7}, {2}, {3}, {
       5}, {8}, {2}, {3}, {5}, {8}, {1}, {4}, {6}, {7}, {2}, {3}, {5}, {8}, {
       1}, {4}, {6}, {7}, {1}, {4}, {6}, {7}, {2}, {3}, {5}, {
       8}}}, CompressedData["
1:eJxTTMoPSlNgYGAoZgESPpnFJWlMIB47kHDOzy3ISa0oOqmbUDDt51r7olM+
CcdnasbYYCqxadp+9viXDPuiJczlUW/X9+/HVPJhQy1H2fMJ9kVCBZsfHRWo
x6LE2T1x5u2Hy+2Lzkn2TJ/wawMWJcvM8gxtluyzL9ry6PnkfTNq9mAqeWCS
rhVdPG1/UfCSrV+iqrdjMUXVp7nP/We1fVEH28uAO7s3Y1Gi82vW1ucvt9sX
KX/qV9rptw+Lkuswi0IgFtljKvHiPiEp2rXNvujHUu6VJp4xWJy7zbcpUcEF
6OmktefT3rqXYjHlxssDC8x2b7Avsr3oHZLxewcWJVKwCFgFiQAsSp4tEfRO
711gX2T8tE7SbnUIlmhk2v7/56s/QB8FbdV4tWfyTCyeVhZeGvGjyMu+qPIa
a0JE8SosFmnAQrcTErpYlGyFeToZ4mksFpVuzc8NL91jX6SWKh/p1R6Hxbk5
0y9GqssDQzfS5r3MJZMFWCz6DEt17JBUh0UJM5qnsShx+qcoK7PjgH2RbK91
m+2SdCxuecp/zNTm5KT9RRdzzdf06h7A4iMnWPI+D0neWCyyg4VuKSR0sZjy
CmbRBYhFWEwRbtP7KW583r7o2BLvA8E1pVicqwdL3vKQ5I3FlKtoqQ6LW9Aj
AIsSV+4GOYuFp+2LXrvsC86vKtwDAKr2m1o=
      "]}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1133144346,ExpressionUUID->"c21540d9-722e-4a3b-b731-ef4081088a40"]
}, Open  ]],

Cell["Check the density matrix:", "ExampleText",
 CellID->315707420,ExpressionUUID->"72d5065b-be1b-40b3-a2e5-3dd86ad36813"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tr", "[", "rho", "]"}], "//", "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eigenvalues", "[", "rho", "]"}], "//", "Chop"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[6]:=",
 CellID->1809999850,ExpressionUUID->"657cd7f6-76e0-46a0-8fc8-52821a5cdf25"],

Cell[BoxData["0.9999999999999998`"], "Output",
 CellLabel->"Out[6]=",
 CellID->1054767301,ExpressionUUID->"f6faf945-d676-4b82-b179-b90346621b61"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.44636101322386657`", ",", "0.35553987829196376`", ",", 
   "0.09423902297615487`", ",", "0.07506419639407717`", ",", 
   "0.013234460292649235`", ",", "0.010541642890635652`", ",", 
   "0.0027941566818032366`", ",", "0.0022256292488492435`"}], "}"}]], "Output",\

 CellLabel->"Out[6]=",
 CellID->2144005569,ExpressionUUID->"3ff478ad-cf90-4d0c-88d8-8f493ad97089"]
}, Open  ]],

Cell["Calculate the Green's functions:", "ExampleText",
 CellID->1787161257,ExpressionUUID->"3050a537-e977-4875-b11e-9729fcfffad4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Multiply", ",", "ccdd", ",", 
     RowBox[{"Dagger", "@", "ccdd"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{"ops", ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ops", "//", "Dimensions"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[7]:=",
 CellID->744728508,ExpressionUUID->"40f92205-5f68-4147-a10d-6826068fd8d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "6", ",", "8", ",", "8"}], "}"}]], "Output",
 CellLabel->"Out[7]=",
 CellID->198701064,ExpressionUUID->"cd75b44e-8663-4702-bb53-33d8ee2d98a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Tr", "[", 
       RowBox[{"#", ".", "rho"}], "]"}], "&"}], ",", "ops", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "Dimensions"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "=", 
  RowBox[{"NambuGreen", "[", "grn", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ArrayShort", "@", "grn"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[8]:=",
 CellID->2112959457,ExpressionUUID->"70e8d7a3-71de-430b-8f9d-76858d0a76be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "6"}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->638425511,ExpressionUUID->"be62d27e-7cd0-4484-b07e-184dd2a50854"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["NambuGreen",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Target: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["All", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Target: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["All", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Blocks: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0.2986116504609245`", 
                    RowBox[{
                    RowBox[{"-", "0.022992458719475552`"}], "-", 
                    RowBox[{"0.019782089654833943`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.006022365813729669`"}], "-", 
                    
                    RowBox[{"0.12874653956891452`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.022992458719475563`"}], "+", 
                    RowBox[{"0.019782089654833947`", " ", "\[ImaginaryI]"}]}],
                     "0.42002243206843387`", 
                    RowBox[{
                    RowBox[{"0.040270200009506096`", "\[VeryThinSpace]"}], 
                    "-", 
                    
                    RowBox[{"0.21811618216861445`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.00602236581372967`"}], "+", 
                    RowBox[{"0.12874653956891452`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.04027020000950611`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.21811618216861445`", " ", "\[ImaginaryI]"}]}], 
                    "0.501501541996631`"}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
                    
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"0", 
                    RowBox[{
                    RowBox[{"-", "0.1400578921417186`"}], "-", 
                    RowBox[{"0.18471203607263906`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.048848695734241665`", "\[VeryThinSpace]"}], 
                    "-", 
                    
                    RowBox[{"0.10517052990965765`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.1400578921417186`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.18471203607263906`", " ", "\[ImaginaryI]"}]}], 
                    "0", 
                    RowBox[{
                    RowBox[{"-", "0.08945927588440657`"}], "+", 
                    
                    RowBox[{"0.016180717190528483`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.048848695734241665`"}], "+", 
                    RowBox[{"0.10517052990965765`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.08945927588440657`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.016180717190528483`", " ", "\[ImaginaryI]"}]}],
                     "0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
                    RowAlignments -> Baseline, ColumnAlignments -> Center], 
                    "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], 
                    "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`NambuGreen[{{{Complex[
     0.2986116504609245, -2.034856065831039*^-17], 
     Complex[-0.022992458719475552`, -0.019782089654833943`], 
     Complex[-0.006022365813729669, -0.12874653956891452`]}, {
     Complex[-0.022992458719475563`, 0.019782089654833947`], Complex[
     0.42002243206843387`, -1.8241752353774247`*^-18], Complex[
     0.040270200009506096`, -0.21811618216861445`]}, {
     Complex[-0.00602236581372967, 0.12874653956891452`], Complex[
     0.04027020000950611, 0.21811618216861445`], Complex[0.501501541996631, 
     2.5228871275698363`*^-17]}}, {{Complex[0., 0.], 
     Complex[-0.1400578921417186, -0.18471203607263906`], Complex[
     0.048848695734241665`, -0.10517052990965765`]}, {Complex[
     0.1400578921417186, 0.18471203607263906`], Complex[0., 0.], 
     Complex[-0.08945927588440657, 0.016180717190528483`]}, {
     Complex[-0.048848695734241665`, 0.10517052990965765`], Complex[
     0.08945927588440657, -0.016180717190528483`], Complex[0., 0.]}}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[8]=",
 CellID->1189262965,ExpressionUUID->"43d93e63-57cf-43e9-800c-40ced6a40f92"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0.2986116504609245`", 
        RowBox[{
         RowBox[{"-", "0.022992458719475552`"}], "-", 
         RowBox[{"0.019782089654833943`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{
         RowBox[{"-", "0.006022365813729669`"}], "-", 
         RowBox[{"0.12874653956891452`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.022992458719475563`"}], "+", 
         RowBox[{"0.019782089654833947`", " ", "\[ImaginaryI]"}]}], 
        "0.42002243206843387`", 
        RowBox[{"0.040270200009506096`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.21811618216861445`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.00602236581372967`"}], "+", 
         RowBox[{"0.12874653956891452`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.04027020000950611`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.21811618216861445`", " ", "\[ImaginaryI]"}]}], 
        "0.501501541996631`"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{
         RowBox[{"-", "0.1400578921417186`"}], "-", 
         RowBox[{"0.18471203607263906`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.048848695734241665`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.10517052990965765`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{"0.1400578921417186`", "\[VeryThinSpace]", "+", 
         RowBox[{"0.18471203607263906`", " ", "\[ImaginaryI]"}]}], "0", 
        RowBox[{
         RowBox[{"-", "0.08945927588440657`"}], "+", 
         RowBox[{"0.016180717190528483`", " ", "\[ImaginaryI]"}]}]},
       {
        RowBox[{
         RowBox[{"-", "0.048848695734241665`"}], "+", 
         RowBox[{"0.10517052990965765`", " ", "\[ImaginaryI]"}]}], 
        RowBox[{"0.08945927588440657`", "\[VeryThinSpace]", "-", 
         RowBox[{"0.016180717190528483`", " ", "\[ImaginaryI]"}]}], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1312350126,ExpressionUUID->"b785c619-bf89-49f0-924a-3c95a388e9d2"]
}, Open  ]],

Cell["Reproduce the density matrix from the Green's functions:", "ExampleText",
 CellID->1438399926,ExpressionUUID->"3773f644-fb88-4a45-87d5-afca568ba20a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"BravyiDensityMatrix", "[", "grn", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "-", "rho"}], "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["Q3`"],
 CellLabel->"In[9]:=",
 CellID->1570527806,ExpressionUUID->"3e1c69f6-37c4-42b1-b3cb-6bbae6acb27a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->1629062436,ExpressionUUID->"401471f7-2fa9-49de-a234-217883284e0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"new", "-", "rho"}], "//", "ArrayZeroQ"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->2098448323,ExpressionUUID->"24c04b87-3ad8-481d-80f2-74a006adeee4"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[10]=",
 CellID->1287757309,ExpressionUUID->"a05763fe-9017-46c1-9fcd-05f1c8d15b67"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "a7e24401-40ba-49cf-a049-16f9f32bf968"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"384a7d2e-516b-480d-883c-1e2139104d6f"],
 "Maximally Entangled States",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "85e2ccca-b33c-4249-99ba-395c4c6fec19"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1857010531,ExpressionUUID->"08b129a1-b529-41ce-97b3-c75a29869eb6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "@", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->177031794,ExpressionUUID->"85340e4b-e2f4-4aec-bfdc-dd6a564446a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->898028705,ExpressionUUID->"9d9bcc4b-ead1-430c-b4bf-233b5510ae96"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->445065507,ExpressionUUID->"7d0e1921-78dd-4917-b14c-204a4d2c88af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"cc", "->", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"cc", "->", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"I", "*", "\[Phi]"}], "]"}]}]}], ")"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1153852927,ExpressionUUID->"12637842-1ed7-490e-8fe3-a4f96793965a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["1", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 0, $CellContext`c[2] -> 1|>]], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]], 
         SubscriptBox["0", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 0|>]]}]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[3]=",
 CellID->1384283578,ExpressionUUID->"86d974a9-2086-462d-bb22-3e928ae6af57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{
     RowBox[{"in", "**", 
      RowBox[{"Dagger", "[", "in", "]"}]}], ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->676224746,ExpressionUUID->"f4f02099-6658-4f64-b709-2d70c2c7175a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", 
      FractionBox["1", "2"], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], "2"], "0"},
     {"0", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"], 
      FractionBox["1", "2"], "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 0, 2, 4, 4}, {{2}, {3}, {2}, {3}}}, {
      Rational[1, 2], Rational[1, 2] E^(Complex[0, -1] $CellContext`\[Phi]), 
       Rational[1, 2] E^(Complex[0, 1] $CellContext`\[Phi]), Rational[
       1, 2]}}], TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->1387474301,ExpressionUUID->"44577cf7-898e-45fb-a797-31081cee85da"]
}, Open  ]],

Cell["Calculate the Green's functions:", "ExampleText",
 CellID->1477099835,ExpressionUUID->"b7edc96d-da62-4a8e-a364-f48139214f97"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Multiply", ",", "cc", ",", 
     RowBox[{"Dagger", "@", "cc"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gg", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1448597231,ExpressionUUID->"7b933a41-d8f5-4f78-8b24-3dc5d8721789"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[1]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]], 
         $CellContext`c[1]]]}], 
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[2]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]], 
         $CellContext`c[1]]]}]},
     {
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[1]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]], 
         $CellContext`c[2]]]}], 
      RowBox[{"1", "-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[2]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]], 
         $CellContext`c[2]]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->50697626,ExpressionUUID->"98d6159e-796f-4665-9751-5a92f1c59dd0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Dagger", "[", "in", "]"}], "**", "#", "**", "in"}], "&"}], ",",
      "gg", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->139344697,ExpressionUUID->"ce7227d2-40f5-4d77-a8fe-49ee85ddaf4d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]]}], 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->316486182,ExpressionUUID->"4f329d02-2691-4327-9862-47b4f2eb8db5"]
}, Open  ]],

Cell["Calculate the density matrix from the Green's functions:", "ExampleText",
 CellID->1906329941,ExpressionUUID->"634b1861-b828-4d7e-b54f-c5f12bbe01f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"del", "[", "ph_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]", "=", "ph"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"BravyiDensityMatrix", "[", 
       RowBox[{"Normal", "@", "grn"}], "]"}], "-", 
      RowBox[{"Normal", "[", "rho", "]"}]}], "//", "Chop"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1988032374,ExpressionUUID->"dc9e2391-3229-4f6e-89cc-89002da4dc3e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"del", "[", 
      RowBox[{"p", "*", "Pi"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayShort", "/@", "data"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->255519355,ExpressionUUID->"d86af694-5fde-4c40-8b93-0e5fe478f298"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->915820395,ExpressionUUID->"bea1f9ec-eb1b-4d5d-b944-3829ed0ba621"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"logneg", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"BravyiLogarithmicNegativity", "[", 
      RowBox[{
       RowBox[{"grn", "/.", 
        RowBox[{"\[Phi]", "->", 
         RowBox[{"p", "*", "Pi"}]}]}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], "]"}], "//", 
   RowBox[{
    RowBox[{"IntegerChop", "[", 
     RowBox[{"#", ",", "1.0*^-4"}], "]"}], "&"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->442774530,ExpressionUUID->"1ad6c8d0-cbd9-41b7-a869-a7621bd7153b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",",
    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->1739186003,ExpressionUUID->"96dbbddb-6e18-4868-a6ca-983d7b03c7af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "d236c8b0-5035-4174-8876-ae7bb0840c87"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->770380891,ExpressionUUID->"bd2a0a61-329c-4355-b82a-0f4a24ec27af"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "@", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ccdd", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"cc", ",", 
    RowBox[{"Dagger", "@", "cc"}]}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->2079034484,ExpressionUUID->"5e53dc98-613c-4b31-8f98-55f42d7e766e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1974060169,ExpressionUUID->"38fea0f8-65e8-4e53-86e2-c3626dd09afb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    QuantumMob`Q3`Dagger[
     $CellContext`c[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    QuantumMob`Q3`Dagger[
     $CellContext`c[2]]]}], "}"}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1554397880,ExpressionUUID->"6720d94f-605f-40f3-ac0f-b8117bc1c092"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Real", ",", "\[Phi]"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1071012257,ExpressionUUID->"01dd1837-ae6f-4bee-862e-ff17e78831f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Ket", "[", 
      RowBox[{"cc", "->", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "+", 
     RowBox[{
      RowBox[{"Ket", "[", 
       RowBox[{"cc", "->", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"I", "*", "\[Phi]"}], "]"}]}]}], ")"}], "/", 
   RowBox[{"Sqrt", "[", "2", "]"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->295074245,ExpressionUUID->"a4e470fb-b0c2-43ab-97f0-23a4b65c2fe3"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]], 
        SubscriptBox["0", 
         TemplateBox[{",", "\",\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]]}, "RowWithSeparators"]},
     "Ket"],
    Ket[<|$CellContext`c[1] -> 0, $CellContext`c[2] -> 0|>]], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], " ", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]], 
         SubscriptBox["1", 
          TemplateBox[{",", "\",\"", 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]]}, 
        "RowWithSeparators"]},
      "Ket"],
     Ket[<|$CellContext`c[1] -> 1, $CellContext`c[2] -> 1|>]]}]}], 
  SqrtBox["2"]]], "Output",
 CellLabel->"Out[3]=",
 CellID->266394469,ExpressionUUID->"ef99e497-d7fb-473e-8910-66061e1b91f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rho", "=", 
   RowBox[{"Matrix", "[", 
    RowBox[{
     RowBox[{"in", "**", 
      RowBox[{"Dagger", "[", "in", "]"}]}], ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rho", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1128104794,ExpressionUUID->"1dc8f3da-3012-45f9-8466-3ed642544e84"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0", "0", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], "2"]},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"], "0", "0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 2, 2, 4}, {{1}, {4}, {1}, {4}}}, {
      Rational[1, 2], Rational[1, 2] E^(Complex[0, -1] $CellContext`\[Phi]), 
       Rational[1, 2] E^(Complex[0, 1] $CellContext`\[Phi]), Rational[
       1, 2]}}], TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->667892655,ExpressionUUID->"7bf594d7-3ee6-47b6-929a-f4bde136ac87"]
}, Open  ]],

Cell["Calculate the Green's functions:", "ExampleText",
 CellID->851396083,ExpressionUUID->"0a7cffad-8708-4039-bccd-93fed36d63a2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{"Outer", "[", 
    RowBox[{"Multiply", ",", "ccdd", ",", 
     RowBox[{"Dagger", "@", "ccdd"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gg", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->730427020,ExpressionUUID->"5ffe2552-e67d-49f7-aabc-46ffe685a2f9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1", "-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[1]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]], 
         $CellContext`c[1]]]}], 
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[2]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]], 
         $CellContext`c[1]]]}], "0", 
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
             $CellContext`c[1]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         $CellContext`c[2], 
         $CellContext`c[1]]]}]},
     {
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[1]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]], 
         $CellContext`c[2]]]}], 
      RowBox[{"1", "-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[2]]], 
            InterpretationBox[
             SubscriptBox["c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
             $CellContext`c[2]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]], 
         $CellContext`c[2]]]}], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]], 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        $CellContext`c[2], 
        $CellContext`c[1]]], "0"},
     {"0", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[1]]], 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[2]]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        QuantumMob`Q3`Dagger[
         $CellContext`c[1]], 
        QuantumMob`Q3`Dagger[
         $CellContext`c[2]]]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[1]]], 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        QuantumMob`Q3`Dagger[
         $CellContext`c[1]], 
        $CellContext`c[1]]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[1]]], 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        QuantumMob`Q3`Dagger[
         $CellContext`c[1]], 
        $CellContext`c[2]]]},
     {
      RowBox[{"-", 
       InterpretationBox[
        TemplateBox[{
          TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
               
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[1]]], 
            InterpretationBox[
             TemplateBox[{"c", 
               TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
               TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
                "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
              SubsuperscriptBox], 
             QuantumMob`Q3`Dagger[
              $CellContext`c[2]]]}, "RowWithSeparators"]},
         "RowDefault"],
        QuantumMob`Q3`Multiply[
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]]]]}], "0", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[2]]], 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
            $CellContext`c[1]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        QuantumMob`Q3`Dagger[
         $CellContext`c[2]], 
        $CellContext`c[1]]], 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            QuantumMob`Q3`Dagger[
             $CellContext`c[2]]], 
           InterpretationBox[
            SubscriptBox["c", 
             TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
            $CellContext`c[2]]}, "RowWithSeparators"]},
        "RowDefault"],
       QuantumMob`Q3`Multiply[
        QuantumMob`Q3`Dagger[
         $CellContext`c[2]], 
        $CellContext`c[2]]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1659271935,ExpressionUUID->"6ac05ed7-20d2-4a64-ab85-e1554c5aedda"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Dagger", "[", "in", "]"}], "**", "#", "**", "in"}], "&"}], ",",
      "gg", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "ArrayShort"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grn", "=", 
   RowBox[{"NambuGreen", "[", 
    RowBox[{"grn", ",", "cc"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"grn", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1311692142,ExpressionUUID->"ad8a91ba-bce1-43e1-b875-906111611c5a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0", "0", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"]}]},
     {"0", 
      FractionBox["1", "2"], 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"], "0"},
     {"0", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], "2"], 
      FractionBox["1", "2"], "0"},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]]}], "0", "0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->1987484122,ExpressionUUID->"34e74342-4831-40ad-a00f-046344964c2f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", "2"], "0"},
       {"0", 
        FractionBox["1", "2"]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"]}]},
       {
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Phi]"}]], "2"], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], "}"}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1684993016,ExpressionUUID->"fde16ae6-cfaa-4614-94bf-1f7bf28b4e49"]
}, Open  ]],

Cell["Calculate the density matrix from the Green's functions:", "ExampleText",
 CellID->179211657,ExpressionUUID->"d88527c0-0920-43a2-a50d-8b37d0255fc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"del", "[", "ph_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]", "=", "ph"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"BravyiDensityMatrix", "[", "grn", "]"}], "-", 
      RowBox[{"Normal", "[", "rho", "]"}]}], "//", "Chop"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1238246105,ExpressionUUID->"aaa99278-acb0-4ed0-a5c4-6e3b9da27f23"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"del", "[", 
      RowBox[{"p", "*", "Pi"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ArrayShort", "/@", "data"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2085747305,ExpressionUUID->"34e2ea94-1e2e-4419-97ad-92b1a4452407"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->1719884081,ExpressionUUID->"bf27db12-d799-46bf-8b84-71a8c566eea1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"logneg", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"BravyiLogarithmicNegativity", "[", 
      RowBox[{
       RowBox[{"grn", "/.", 
        RowBox[{"\[Phi]", "->", 
         RowBox[{"p", "*", "Pi"}]}]}], ",", 
       RowBox[{"{", "1", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "0", ",", "2", ",", "0.1"}], "}"}]}], "]"}], "//", 
   "IntegerChop"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->1400974601,ExpressionUUID->"bef9ba30-0d37-4aff-b653-b12bf4a44eda"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",",
    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
    ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]], "Output",
 CellLabel->"Out[9]=",
 CellID->1081338500,ExpressionUUID->"f326e66a-cc56-478a-a4e3-a67d10acbca6"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BravyiGreen"]], "paclet:QuantumMob/Q3/ref/BravyiGreen", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "e1c181d2-4195-4414-82bb-c932be408c6c"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BravyiState"]], "paclet:QuantumMob/Q3/ref/BravyiState", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "de32f5b7-9f74-407e-a375-57da923110a9"]
       }], "SeeAlso",ExpressionUUID->"09110c7a-e1f8-448d-9273-559ff4f56d49"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"dcbfe85b-37fd-44a3-904d-\
baac82352c85"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "8a86b473-fd40-47f1-a2bd-4c035f471fb2"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], 
           "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "ebcfcc10-9491-4d00-8a86-fbf415533e24"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"1bbd313c-b12d-46d1-961b-\
6c79bbda6019"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Fermionic Quantum Computation"]], 
           "paclet:QuantumMob/Q3/guide/FermionicQuantumComputation"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "38f69f06-f2fb-4e63-96ab-bdca7f907b43"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "f10fc1a7-556d-4bb1-81d1-21aaae11d286"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "cec66348-b903-444f-b24f-ba06047fcd6d"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"2b3bcfe9-afbb-4ea4-b57b-\
13015b501137"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "S. Bravyi and R. K\[ODoubleDot]nig (2012)"}]]]], 
             "https://dl.acm.org/doi/10.5555/2481569.2481571"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "04f451a8-00f5-49a9-91aa-087e47bdb0d6"]}]],ExpressionUUID->
         "bd0e6c5b-4afd-4275-b210-cc8f36680993"],
        ", Quantum Information & Computation 12, 925 (2012), \"Classical \
simulation of dissipative fermionic linear optics.\""
       }], "RelatedLinks",ExpressionUUID->
        "365dc521-ba04-4ed9-b5a1-3e0fe62502ae"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "S. Bravyi (2005)"}]]]], 
             "https://dl.acm.org/doi/abs/10.5555/2011637.2011640"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "19b44d09-17bd-4091-ae29-40d98b9afa1c"]}]],ExpressionUUID->
         "2c413982-4603-4d3f-9b25-34a530218098"],
        ", Quantum Information & Computation 5, 216 (2005), \"Lagrangian \
representation for fermionic linear optics.\""
       }], "RelatedLinks",ExpressionUUID->
        "dd85a615-a2af-4ace-bfc4-5da4b38a1689"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "S. Bravyi and A. Y. Kitaev (2002)"}]]]], 
             "https://doi.org/10.1006/aphy.2002.6254"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "940281f1-d334-4904-b688-cf75092edf4c"]}]],ExpressionUUID->
         "58ba6d5e-c2e1-48b3-90e6-773eab24e6ab"],
        ", Annals of Physics 298, 210 (2002),\"Fermionic Quantum Computation.\
\""
       }], "RelatedLinks",ExpressionUUID->
        "33a16753-3f2a-4b55-8875-8dba1e6f65ee"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "B. M. Terhal and D. P. DiVincenzo (2002)"}]]]], 
             "https://doi.org/10.1103/PhysRevA.65.032325"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "573d968b-6786-40be-aa4f-dc3fe6af66d8"]}]],ExpressionUUID->
         "6902a782-3545-45b3-9539-7f84c03aa3a2"],
        ", Physical Review A 65, 032325, \"Classical simulation of ",
        StyleBox["noninteracting",
         IgnoreSpellCheck->True],
        "-fermion quantum circuits.\""
       }], "RelatedLinks",ExpressionUUID->
        "b518273c-0412-41db-b5f1-0d1068b3ed60"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "35b3cf2e-e3bb-4c99-a6dc-8a1cf83090bf"]}]],ExpressionUUID->
         "04330b30-8060-4350-96fe-1ab52c8f870b"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "285ad1b2-7bd9-49d2-9555-540978456a00"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"1c23a2cb-c23c-4c5c-94eb-\
d70e36bcb9ee"],

Cell[" ", "FooterCell",ExpressionUUID->"9b31ca7d-aff3-4f94-ac94-431245ebf0eb"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"BravyiDensityMatrix",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed}, "AllOptsTable" -> 
    Closed, "NotesSection" -> Closed, 
    "ExampleSubsection" -> {"0" -> Closed, "1" -> Closed, "2" -> Closed}}, 
  "NewStyles" -> True, "CitationPopupData" -> $Failed, "ShowCitation" -> 
  False, "HasOptions" -> True, "RootCaptions" -> "", 
  "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 10, 15, 42, 47.527605}", 
    "history" -> {"14.1", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> "QuantumMob/Q3",
     "status" -> "None", "summary" -> 
    "BravyiDensityMatrix[grn] returns the density matrix corresponding to the \
single-particle Green's function grn, assuming that grn is associated with a \
fermionic Gaussian state. BravyiDensityMatrix[ws] is a shortcut and returns \
the density matrix corresponding to the Bravyi or Nambu state ws.", 
    "synonyms" -> {}, "tabletags" -> {}, "title" -> "BravyiDensityMatrix", 
    "titlemodifier" -> "", "metadescription" -> "", "windowtitle" -> 
    "BravyiDensityMatrix", "type" -> "Symbol", "uri" -> 
    "QuantumMob/Q3/ref/BravyiDensityMatrix"}},
CellContext->"Global`",
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"72d6b392-f820-4cbe-af96-e817619472e8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[13321, 352, 1440, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"28b9ab3d-eba5-4d65-94dc-69d72ec69a9d",
   CellTags->"PrimaryExamplesSection",
   CellID->565179409]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 180003, 4660}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[587, 21, 6731, 165, 70, "AnchorBarGrid",ExpressionUUID->"dfd81d2d-d7c3-438a-b864-1b589f0c8a18",
 CellID->1],
Cell[7321, 188, 96, 0, 70, "ContextNameCell",ExpressionUUID->"2189ed41-6b30-43c7-81ea-a80a0983b6a6"],
Cell[CellGroupData[{
Cell[7442, 192, 1370, 37, 70, "ObjectNameGrid",ExpressionUUID->"84128f0f-9675-4310-8eb6-c416966994f0"],
Cell[8815, 231, 1964, 49, 70, "Usage",ExpressionUUID->"203e03ea-cd8a-4377-8be6-970387efff92",
 CellID->837314546]
}, Open  ]],
Cell[CellGroupData[{
Cell[10816, 285, 1850, 45, 70, "NotesSection",ExpressionUUID->"29e198f7-026c-4820-b972-3c8d1d222700",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->681064617],
Cell[12669, 332, 525, 14, 70, "Notes",ExpressionUUID->"79284a02-2a63-4e86-bc05-9bcfe9fd73d8",
 CellID->285235831]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[13321, 352, 1440, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"28b9ab3d-eba5-4d65-94dc-69d72ec69a9d",
 CellTags->"PrimaryExamplesSection",
 CellID->565179409],
Cell[14764, 392, 203, 3, 70, "Input",ExpressionUUID->"fbfea4a5-a747-476d-b2c7-bb1c509181e3",
 CellID->1940205291],
Cell[CellGroupData[{
Cell[14992, 399, 1418, 37, 70, "ExampleSection",ExpressionUUID->"36ddef4d-93d8-49ed-8b63-72293e2ffa62",
 CellID->650156382],
Cell[16413, 438, 128, 1, 70, "ExampleText",ExpressionUUID->"9f4077a8-1574-448d-8c13-287cb85615ee",
 CellID->1579571379],
Cell[16544, 441, 205, 5, 70, "Input",ExpressionUUID->"5196832d-5746-4be8-9ab0-09b49b646cc5",
 CellID->2144923147],
Cell[16752, 448, 220, 5, 70, "Input",ExpressionUUID->"6406b301-5198-4aa9-acab-69f038e27abf",
 CellID->1611621965],
Cell[16975, 455, 146, 1, 70, "ExampleText",ExpressionUUID->"e199f575-d3db-4dc2-8cbc-0eef222adbae",
 CellID->1793530776],
Cell[CellGroupData[{
Cell[17146, 460, 232, 5, 70, "Input",ExpressionUUID->"b5c59a3b-7160-4730-8930-9b2256759786",
 CellID->1279536004],
Cell[17381, 467, 7142, 142, 70, "Output",ExpressionUUID->"b5418074-01bb-4273-8399-8e1fc6fb3ef8",
 CellID->1374224457]
}, Open  ]],
Cell[CellGroupData[{
Cell[24560, 614, 193, 4, 70, "Input",ExpressionUUID->"a6322626-1c60-4e0e-a916-420f483bbfbe",
 CellID->79841072],
Cell[24756, 620, 127, 2, 70, "Output",ExpressionUUID->"b8e0f743-dfd7-431b-9cbd-5726bf1217ee",
 CellID->1159916761]
}, Open  ]],
Cell[24898, 625, 129, 1, 70, "ExampleText",ExpressionUUID->"f94c8b33-3c26-4f9e-aac4-8c971b6ae68e",
 CellID->829017474],
Cell[CellGroupData[{
Cell[25052, 630, 310, 7, 70, "Input",ExpressionUUID->"d291a06d-1af1-4ebb-b399-beb8a9dcf473",
 CellID->1228699821],
Cell[25365, 639, 2918, 67, 70, "Output",ExpressionUUID->"6fc7a472-4a09-47eb-8bbd-68f0fa718dfb",
 CellID->976797241]
}, Open  ]],
Cell[28298, 709, 128, 1, 70, "ExampleText",ExpressionUUID->"a73ca52b-948a-474d-85a3-afea90d33c11",
 CellID->1287199281],
Cell[CellGroupData[{
Cell[28451, 714, 382, 9, 70, "Input",ExpressionUUID->"a01d8f5e-7b6e-44ac-aefa-da720defe728",
 CellID->1625237059],
Cell[28836, 725, 2593, 58, 70, "Output",ExpressionUUID->"6aa6f797-2dcf-4bdd-b57b-bd9b30d0feae",
 CellID->580600593]
}, Open  ]],
Cell[31444, 786, 206, 4, 70, "ExampleText",ExpressionUUID->"a36e7d82-232e-4eec-9ca3-4ea345093a13",
 CellID->2088378959],
Cell[CellGroupData[{
Cell[31675, 794, 499, 13, 70, "Input",ExpressionUUID->"f4c00a8d-d1e7-460b-9eb9-4c6d73a2c4aa",
 CellID->1687043485],
Cell[32177, 809, 2594, 58, 70, "Output",ExpressionUUID->"f828d39e-6a17-4719-bfb3-59092714a217",
 CellID->1409814138]
}, Open  ]],
Cell[CellGroupData[{
Cell[34808, 872, 223, 5, 70, "Input",ExpressionUUID->"4b682c93-b12b-4372-b44c-b7b9d97129ad",
 CellID->1578285105],
Cell[35034, 879, 130, 2, 70, "Output",ExpressionUUID->"c22eaf46-9fd7-478b-b008-24c85cb2ca50",
 CellID->1217362739]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[35313, 889, 1321, 35, 70, "ExampleSection",ExpressionUUID->"626561d9-8a6e-4b01-9631-6f8d9eeb60a2",
 CellID->65633975],
Cell[CellGroupData[{
Cell[36659, 928, 1362, 35, 70, "ExampleSubsection",ExpressionUUID->"c71ba834-85c5-4f7c-bb05-7050e35241c9",
 CellID->497423321],
Cell[38024, 965, 213, 4, 70, "ExampleText",ExpressionUUID->"d48819ca-4053-47b1-99a0-0ec8b57ed492",
 CellID->1625303001],
Cell[38240, 971, 127, 1, 70, "ExampleText",ExpressionUUID->"e4b79ce0-86e2-4adb-8f50-773a3ce98baf",
 CellID->2146590148],
Cell[38370, 974, 335, 9, 70, "Input",ExpressionUUID->"f60d4dd9-d4ae-4c40-a8e5-dfd1346f6a10",
 CellID->1998991449],
Cell[CellGroupData[{
Cell[38730, 987, 332, 8, 70, "Input",ExpressionUUID->"88664c70-f646-4279-843e-f978dbdf9e54",
 CellID->1412231210],
Cell[39065, 997, 578, 19, 70, "Output",ExpressionUUID->"9a9e85c6-c79e-4ebe-af2d-c306f4a1041f",
 CellID->1671700638]
}, Open  ]],
Cell[39658, 1019, 135, 1, 70, "ExampleText",ExpressionUUID->"f794ef63-9855-464d-8cf3-e9b8faad376d",
 CellID->1531256439],
Cell[39796, 1022, 220, 5, 70, "Input",ExpressionUUID->"5989500c-9b4b-46d3-aa51-c3655ea97f2b",
 CellID->1340151952],
Cell[CellGroupData[{
Cell[40041, 1031, 702, 19, 70, "Input",ExpressionUUID->"80592d7a-e10e-40fe-902a-8612807aaec1",
 CellID->1713041365],
Cell[40746, 1052, 12978, 268, 70, "Output",ExpressionUUID->"640df672-debd-4843-a15d-dc0bc0199965",
 CellID->2117725931]
}, Open  ]],
Cell[53739, 1323, 124, 1, 70, "ExampleText",ExpressionUUID->"3e914d71-d53b-4165-8a85-4931b1183c79",
 CellID->1114864780],
Cell[CellGroupData[{
Cell[53888, 1328, 323, 7, 70, "Input",ExpressionUUID->"3f05e491-eb84-496e-85f1-6280c2b86cf4",
 CellID->1726168276],
Cell[54214, 1337, 129, 2, 70, "Output",ExpressionUUID->"c73fb596-8b5a-4d4e-a6fb-46d33243b6f3",
 CellID->1819883667],
Cell[54346, 1341, 303, 7, 70, "Output",ExpressionUUID->"aa338335-3487-4350-afc9-0247cbc696f1",
 CellID->175207048]
}, Open  ]],
Cell[54664, 1351, 131, 1, 70, "ExampleText",ExpressionUUID->"4040b582-c127-470c-b1f5-6c611e45ebb8",
 CellID->1488178613],
Cell[CellGroupData[{
Cell[54820, 1356, 510, 13, 70, "Input",ExpressionUUID->"0badb20c-adb5-424f-8d7c-e92e2c151e60",
 CellID->1543102090],
Cell[55333, 1371, 189, 4, 70, "Output",ExpressionUUID->"ea073798-d0ea-4ad6-a821-693d58188a46",
 CellID->2891139]
}, Open  ]],
Cell[CellGroupData[{
Cell[55559, 1380, 510, 13, 70, "Input",ExpressionUUID->"d7ed27d9-c4fe-4367-8123-d0dbfcc1de7a",
 CellID->1147281361],
Cell[56072, 1395, 171, 4, 70, "Output",ExpressionUUID->"f99cfa05-335d-44fc-976a-a0eabeaf402f",
 CellID->296362582],
Cell[56246, 1401, 1479, 34, 70, "Output",ExpressionUUID->"9c726d7b-8c8e-4cf3-a1ac-01d78550e388",
 CellID->951338281]
}, Open  ]],
Cell[57740, 1438, 155, 1, 70, "ExampleText",ExpressionUUID->"4fdbd089-52a3-475a-9a24-5c488dd50eae",
 CellID->1295948158],
Cell[CellGroupData[{
Cell[57920, 1443, 343, 8, 70, "Input",ExpressionUUID->"8b0aa2b4-b048-4f1a-8fed-55442e86017d",
 CellID->916462759],
Cell[58266, 1453, 909, 21, 70, "Output",ExpressionUUID->"9522cda4-e815-4265-98f8-f03238776462",
 CellID->209719098]
}, Open  ]],
Cell[CellGroupData[{
Cell[59212, 1479, 223, 5, 70, "Input",ExpressionUUID->"9420d9dd-6d74-45c5-bbac-17d377a8b3b8",
 CellID->1292850891],
Cell[59438, 1486, 130, 2, 70, "Output",ExpressionUUID->"faeff80e-21b9-44c8-b873-616c9be0e5bb",
 CellID->1017975932]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[59720, 1496, 1360, 35, 70, "ExampleSubsection",ExpressionUUID->"01ca9a70-e539-40d6-a63a-6cd2c1f00e35",
 CellID->1882279022],
Cell[61083, 1533, 126, 1, 70, "ExampleText",ExpressionUUID->"e92779da-576d-43d8-a307-9e0e88f04db2",
 CellID->707366989],
Cell[61212, 1536, 323, 9, 70, "Input",ExpressionUUID->"a32c3e1f-705b-45cc-b60e-a09a5cebd8e1",
 CellID->297536878],
Cell[CellGroupData[{
Cell[61560, 1549, 460, 12, 70, "Input",ExpressionUUID->"b1b7754d-ffec-45dc-be12-5cf562e926a3",
 CellID->891360236],
Cell[62023, 1563, 577, 19, 70, "Output",ExpressionUUID->"7c18a8ba-dfed-4299-823a-4ee02bf035c1",
 CellID->816483153],
Cell[62603, 1584, 1366, 40, 70, "Output",ExpressionUUID->"d97fe53e-78c8-44bf-a049-5af2f303e9ce",
 CellID->211848141]
}, Open  ]],
Cell[63984, 1627, 135, 1, 70, "ExampleText",ExpressionUUID->"bd559760-c23e-437a-b0ac-c0db2dd591bb",
 CellID->1215678238],
Cell[64122, 1630, 208, 5, 70, "Input",ExpressionUUID->"4cec1836-5239-4a6a-83af-ec7576bb8853",
 CellID->638652385],
Cell[CellGroupData[{
Cell[64355, 1639, 771, 22, 70, "Input",ExpressionUUID->"ce413d11-669a-40ab-8d7f-42048552de79",
 CellID->1523597312],
Cell[65129, 1663, 14016, 284, 70, "Output",ExpressionUUID->"9612e90b-d988-43f2-b939-dc08e5f4c325",
 CellID->1893307887]
}, Open  ]],
Cell[CellGroupData[{
Cell[79182, 1952, 197, 4, 70, "Input",ExpressionUUID->"9fb876f7-7db2-427a-83e1-4ca7f4d1ace1",
 CellID->947799548],
Cell[79382, 1958, 8928, 176, 70, "Output",ExpressionUUID->"c21540d9-722e-4a3b-b731-ef4081088a40",
 CellID->1133144346]
}, Open  ]],
Cell[88325, 2137, 123, 1, 70, "ExampleText",ExpressionUUID->"72d5065b-be1b-40b3-a2e5-3dd86ad36813",
 CellID->315707420],
Cell[CellGroupData[{
Cell[88473, 2142, 306, 7, 70, "Input",ExpressionUUID->"657cd7f6-76e0-46a0-8fc8-52821a5cdf25",
 CellID->1809999850],
Cell[88782, 2151, 145, 2, 70, "Output",ExpressionUUID->"f6faf945-d676-4b82-b179-b90346621b61",
 CellID->1054767301],
Cell[88930, 2155, 407, 9, 70, "Output",ExpressionUUID->"3ff478ad-cf90-4d0c-88d8-8f493ad97089",
 CellID->2144005569]
}, Open  ]],
Cell[89352, 2167, 131, 1, 70, "ExampleText",ExpressionUUID->"3050a537-e977-4875-b11e-9729fcfffad4",
 CellID->1787161257],
Cell[CellGroupData[{
Cell[89508, 2172, 502, 13, 70, "Input",ExpressionUUID->"40f92205-5f68-4147-a10d-6826068fd8d8",
 CellID->744728508],
Cell[90013, 2187, 191, 4, 70, "Output",ExpressionUUID->"cd75b44e-8663-4702-bb53-33d8ee2d98a0",
 CellID->198701064]
}, Open  ]],
Cell[CellGroupData[{
Cell[90241, 2196, 589, 15, 70, "Input",ExpressionUUID->"70e8d7a3-71de-430b-8f9d-76858d0a76be",
 CellID->2112959457],
Cell[90833, 2213, 171, 4, 70, "Output",ExpressionUUID->"be62d27e-7cd0-4484-b07e-184dd2a50854",
 CellID->638425511],
Cell[91007, 2219, 8491, 174, 70, "Output",ExpressionUUID->"43d93e63-57cf-43e9-800c-40ced6a40f92",
 CellID->1189262965],
Cell[99501, 2395, 2925, 69, 70, "Output",ExpressionUUID->"b785c619-bf89-49f0-924a-3c95a388e9d2",
 CellID->1312350126]
}, Open  ]],
Cell[102441, 2467, 155, 1, 70, "ExampleText",ExpressionUUID->"3773f644-fb88-4a45-87d5-afca568ba20a",
 CellID->1438399926],
Cell[CellGroupData[{
Cell[102621, 2472, 333, 8, 70, "Input",ExpressionUUID->"3e1c69f6-37c4-42b1-b3cb-6bbae6acb27a",
 CellID->1570527806],
Cell[102957, 2482, 910, 21, 70, "Output",ExpressionUUID->"401471f7-2fa9-49de-a234-217883284e0c",
 CellID->1629062436]
}, Open  ]],
Cell[CellGroupData[{
Cell[103904, 2508, 224, 5, 70, "Input",ExpressionUUID->"24c04b87-3ad8-481d-80f2-74a006adeee4",
 CellID->2098448323],
Cell[104131, 2515, 131, 2, 70, "Output",ExpressionUUID->"a05763fe-9017-46c1-9fcd-05f1c8d15b67",
 CellID->1287757309]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed]]]],
Cell[CellGroupData[{
Cell[104414, 2525, 1353, 35, 70, "ExampleSubsection",ExpressionUUID->"08b129a1-b529-41ce-97b3-c75a29869eb6",
 CellID->1857010531],
Cell[CellGroupData[{
Cell[105792, 2564, 346, 9, 70, "Input",ExpressionUUID->"85340e4b-e2f4-4aec-bfdc-dd6a564446a2",
 CellID->177031794],
Cell[106141, 2575, 435, 14, 70, "Output",ExpressionUUID->"9d9bcc4b-ead1-430c-b4bf-233b5510ae96",
 CellID->898028705]
}, Open  ]],
Cell[106591, 2592, 223, 5, 70, "Input",ExpressionUUID->"7d0e1921-78dd-4917-b14c-204a4d2c88af",
 CellID->445065507],
Cell[CellGroupData[{
Cell[106839, 2601, 621, 19, 70, "Input",ExpressionUUID->"12637842-1ed7-490e-8fe3-a4f96793965a",
 CellID->1153852927],
Cell[107463, 2622, 1719, 43, 70, "Output",ExpressionUUID->"86d974a9-2086-462d-bb22-3e928ae6af57",
 CellID->1384283578]
}, Open  ]],
Cell[CellGroupData[{
Cell[109219, 2670, 395, 10, 70, "Input",ExpressionUUID->"f4f02099-6658-4f64-b709-2d70c2c7175a",
 CellID->676224746],
Cell[109617, 2682, 1247, 34, 70, "Output",ExpressionUUID->"44577cf7-898e-45fb-a797-31081cee85da",
 CellID->1387474301]
}, Open  ]],
Cell[110879, 2719, 131, 1, 70, "ExampleText",ExpressionUUID->"b7edc96d-da62-4a8e-a364-f48139214f97",
 CellID->1477099835],
Cell[CellGroupData[{
Cell[111035, 2724, 376, 9, 70, "Input",ExpressionUUID->"7b933a41-d8f5-4f78-8b24-3dc5d8721789",
 CellID->1448597231],
Cell[111414, 2735, 4076, 105, 70, "Output",ExpressionUUID->"98d6159e-796f-4665-9751-5a92f1c59dd0",
 CellID->50697626]
}, Open  ]],
Cell[CellGroupData[{
Cell[115527, 2845, 468, 13, 70, "Input",ExpressionUUID->"ce7227d2-40f5-4d77-a8fe-49ee85ddaf4d",
 CellID->139344697],
Cell[115998, 2860, 999, 29, 70, "Output",ExpressionUUID->"4f329d02-2691-4327-9862-47b4f2eb8db5",
 CellID->316486182]
}, Open  ]],
Cell[117012, 2892, 155, 1, 70, "ExampleText",ExpressionUUID->"634b1861-b828-4d7e-b54f-c5f12bbe01f1",
 CellID->1906329941],
Cell[117170, 2895, 584, 15, 70, "Input",ExpressionUUID->"dc9e2391-3229-4f6e-89cc-89002da4dc3e",
 CellID->1988032374],
Cell[CellGroupData[{
Cell[117779, 2914, 468, 13, 70, "Input",ExpressionUUID->"d86af694-5fde-4c40-8b93-0e5fe478f298",
 CellID->255519355],
Cell[118250, 2929, 12730, 361, 70, "Output",ExpressionUUID->"bea1f9ec-eb1b-4d5d-b944-3829ed0ba621",
 CellID->915820395]
}, Open  ]],
Cell[CellGroupData[{
Cell[131017, 3295, 647, 18, 70, "Input",ExpressionUUID->"1ad6c8d0-cbd9-41b7-a869-a7621bd7153b",
 CellID->442774530],
Cell[131667, 3315, 373, 7, 70, "Output",ExpressionUUID->"96dbbddb-6e18-4868-a6ca-983d7b03c7af",
 CellID->1739186003]
}, Open  ]],
Cell[CellGroupData[{
Cell[132077, 3327, 242, 5, 70, "ExampleDelimiter",ExpressionUUID->"bd2a0a61-329c-4355-b82a-0f4a24ec27af",
 CellID->770380891],
Cell[CellGroupData[{
Cell[132344, 3336, 487, 13, 70, "Input",ExpressionUUID->"5e53dc98-613c-4b31-8f98-55f42d7e766e",
 CellID->2079034484],
Cell[132834, 3351, 436, 14, 70, "Output",ExpressionUUID->"38fea0f8-65e8-4e53-86e2-c3626dd09afb",
 CellID->1974060169],
Cell[133273, 3367, 962, 28, 70, "Output",ExpressionUUID->"6720d94f-605f-40f3-ac0f-b8117bc1c092",
 CellID->1554397880]
}, Open  ]],
Cell[134250, 3398, 224, 5, 70, "Input",ExpressionUUID->"01dd1837-ae6f-4bee-862e-ff17e78831f5",
 CellID->1071012257],
Cell[CellGroupData[{
Cell[134499, 3407, 620, 19, 70, "Input",ExpressionUUID->"a4e470fb-b0c2-43ab-97f0-23a4b65c2fe3",
 CellID->295074245],
Cell[135122, 3428, 1718, 43, 70, "Output",ExpressionUUID->"ef99e497-d7fb-473e-8910-66061e1b91f0",
 CellID->266394469]
}, Open  ]],
Cell[CellGroupData[{
Cell[136877, 3476, 396, 10, 70, "Input",ExpressionUUID->"1dc8f3da-3012-45f9-8466-3ed642544e84",
 CellID->1128104794],
Cell[137276, 3488, 1246, 34, 70, "Output",ExpressionUUID->"7bf594d7-3ee6-47b6-929a-f4bde136ac87",
 CellID->667892655]
}, Open  ]],
Cell[138537, 3525, 130, 1, 70, "ExampleText",ExpressionUUID->"0a7cffad-8708-4039-bccd-93fed36d63a2",
 CellID->851396083],
Cell[CellGroupData[{
Cell[138692, 3530, 379, 9, 70, "Input",ExpressionUUID->"5ffe2552-e67d-49f7-aabc-46ffe685a2f9",
 CellID->730427020],
Cell[139074, 3541, 10774, 276, 70, "Output",ExpressionUUID->"6ac05ed7-20d2-4a64-ab85-e1554c5aedda",
 CellID->1659271935]
}, Open  ]],
Cell[CellGroupData[{
Cell[149885, 3822, 667, 18, 70, "Input",ExpressionUUID->"ad8a91ba-bce1-43e1-b875-906111611c5a",
 CellID->1311692142],
Cell[150555, 3842, 1377, 40, 70, "Output",ExpressionUUID->"34e74342-4831-40ad-a00f-046344964c2f",
 CellID->1987484122],
Cell[151935, 3884, 1515, 43, 70, "Output",ExpressionUUID->"fde16ae6-cfaa-4614-94bf-1f7bf28b4e49",
 CellID->1684993016]
}, Open  ]],
Cell[153465, 3930, 154, 1, 70, "ExampleText",ExpressionUUID->"d88527c0-0920-43a2-a50d-8b37d0255fc9",
 CellID->179211657],
Cell[153622, 3933, 551, 14, 70, "Input",ExpressionUUID->"aaa99278-acb0-4ed0-a5c4-6e3b9da27f23",
 CellID->1238246105],
Cell[CellGroupData[{
Cell[154198, 3951, 469, 13, 70, "Input",ExpressionUUID->"34e2ea94-1e2e-4419-97ad-92b1a4452407",
 CellID->2085747305],
Cell[154670, 3966, 12731, 361, 70, "Output",ExpressionUUID->"bf27db12-d799-46bf-8b84-71a8c566eea1",
 CellID->1719884081]
}, Open  ]],
Cell[CellGroupData[{
Cell[167438, 4332, 571, 16, 70, "Input",ExpressionUUID->"bef9ba30-0d37-4aff-b653-b12bf4a44eda",
 CellID->1400974601],
Cell[168012, 4350, 373, 7, 70, "Output",ExpressionUUID->"f326e66a-cc56-478a-a4e3-a67d10acbca6",
 CellID->1081338500]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "2"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[168754, 4370, 1393, 36, 70, "SeeAlsoSection",ExpressionUUID->"dcbfe85b-37fd-44a3-904d-baac82352c85"],
Cell[170150, 4408, 1134, 29, 70, "TechNotesSection",ExpressionUUID->"1bbd313c-b12d-46d1-961b-6c79bbda6019"],
Cell[171287, 4439, 1497, 37, 70, "MoreAboutSection",ExpressionUUID->"2b3bcfe9-afbb-4ea4-b57b-13015b501137"],
Cell[172787, 4478, 4837, 127, 70, "RelatedLinksSection",ExpressionUUID->"1c23a2cb-c23c-4c5c-94eb-d70e36bcb9ee"],
Cell[177627, 4607, 78, 0, 70, "FooterCell",ExpressionUUID->"9b31ca7d-aff3-4f94-ac94-431245ebf0eb"]
}
]
*)

(* End of internal cache information *)
