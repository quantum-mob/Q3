(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    109535,       3084]
NotebookOptionsPosition[     97925,       2848]
NotebookOutlinePosition[    100165,       2905]
CellTagsIndexPosition[    100079,       2900]
WindowTitle->FockBilinearSystem
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "29f91450-77a8-4e39-9acf-5b10dff79eef"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "52887368-e074-4339-8785-0e80ace22e76"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "d51a7a1d-1278-48f2-abc3-b439a87ce71c"]
         }],ExpressionUUID->"6e710c07-3f71-4d65-b83b-605b67670ce0"],
         StripOnInput->False],{
        StyleBox[
          "\"FockBilinearQ\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/FockBilinearQ"], 
         StyleBox[
          "\"FockBilinearOperators\"", "SeeAlsoRelated", StripOnInput -> 
           False] :> Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/FockBilinearOperators"], 
         StyleBox[
          "\"FockBilinearMatrix\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/FockBilinearMatrix"], 
         StyleBox[
          "\"FockBilinearSystem\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/FockBilinearSystem"], 
         StyleBox[
          "\"CoefficientTensor\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/ref/CoefficientTensor"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "247700a6-2112-41e0-b76e-c72f1b1f7ace"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "fa36137e-fbfc-470f-be37-b773bac5fb32"]
         }],ExpressionUUID->"3650cc43-4d9c-40ca-9803-ec6c38572e0a"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "6af39870-1cc4-44fb-ade5-1b5a42e2b8af"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "a4503014-fcd9-4065-b273-acd27ee7fe6b"]
         }],ExpressionUUID->"ef0ba585-32af-4cf7-a5e0-7efad63ed9d2"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "333169ca-ecdc-433d-961e-e96310b8beaf"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "6868aad5-973e-41cd-af58-13565bd3db3d"]
         }],ExpressionUUID->"1063f8ad-b935-4dbf-a633-a55117e3432a"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/FockBilinearSystem\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/FockBilinearSystem"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
FockBilinearSystem.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/FockBilinearSystem") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "35eec5df-6db2-4481-9e58-64f0ba74fde3"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "bac079da-5a7b-4711-863a-7d83e1c317d2"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"4b61a1df-9a99-4093-b417-2da7dabf715f"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"32a40816-2484-4dbf-977e-cf118f9f569a"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "FockBilinearSystem", "ObjectName",ExpressionUUID->
      "31035a0c-a23c-4f8a-82e3-bb26ba02deff"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"9cb2d142-c085-493a-a6a5-fd8fc2363fde"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "0d712595-566e-44db-81be-4172c73bc4d4"]
    }],ExpressionUUID->"91f0cf8b-149d-4054-9c71-7fffcb9b14af"], 
    "\[SpanFromLeft]"}
  }]], "ObjectNameGrid",ExpressionUUID->"aaf927b8-a653-4ce1-bae7-\
382aae5dfa23"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{"FockBilinearSystem", "[", "expr", "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "70ff957a-26dc-4a2e-ac6d-ebad16567e52"],
     " \[LineSeparator]returns a list of {operators, matrix} of the bilinear \
combination."
    }],ExpressionUUID->"3afa361e-cb47-4c05-b57a-d13ef647c5d0"]}
  }]], "Usage",
 CellID->982511436,ExpressionUUID->"83f4f0c5-e020-43f7-8255-6c75ec19a0ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"15c9ce14-93c3-4247-9edd-e9f9c73bc692"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"afc218b4-8ce9-42a8-9b7d-cf30f2908b0f"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "531edd84-88d7-487e-a86d-2e0d73159ab0"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->776329039,ExpressionUUID->"4f8436a9-3ec5-4daa-a1b6-9b254cccecef"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->742081683,ExpressionUUID->"7d6ef191-553c-497f-8b91-83ed02c6abd7"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"bff2cc1b-df12-457b-bf49-84f383cb0615"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"e1eddacd-5fdf-41e5-b98a-eeee3045cad8"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "f14040f2-c425-4416-b8e6-82b4e505a48d"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1799002948,ExpressionUUID->"129fba0e-616b-442b-ae6f-8ef9e04a5dd5"],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Boson", ",", "a"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->54356201,ExpressionUUID->"993f5ddd-9ac1-459b-91f4-0ad67b649968"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"a", "[", "2", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], "**", 
       RowBox[{"a", "[", "3", "]"}]}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->301411736,ExpressionUUID->"760a2a24-282c-4f22-a2f1-3dc184e67101"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`a[1]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`a[3], 
       $CellContext`a[1]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->2048158089,ExpressionUUID->"b2799f60-6de1-49f1-9489-3c42f49cb47d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`a[3]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`a[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`a[3], 
     $CellContext`a[1]]]}], "+", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"a", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`a[2]]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`a[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`a[2]], 
     $CellContext`a[1]]]}]}]], "Print",
 CellLabel->"During evaluation of In[372]:=",
 CellID->1377624060,ExpressionUUID->"182505c5-51eb-4ee7-b324-be722398ad90"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`a[1]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`a[2]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`a[3]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[2]]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[3]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[372]:=",
 CellID->1706378113,ExpressionUUID->"29772cc7-fc17-4965-a7bf-0ade2c97d801"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox["x", "2"], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], "0", 
      FractionBox["x", "2"], "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 0, 1, 1, 3, 3, 4}, {{1}, {3}, {5}, {1}}}, {
      Rational[1, 2] $CellContext`x, 
       Rational[1, 2] $CellContext`x $CellContext`z, 
       Rational[1, 2] $CellContext`x, 
       Rational[1, 2] $CellContext`x $CellContext`z}}]]]]], "Output",
 CellLabel->"Out[2]//MatrixForm=",
 CellID->1600323153,ExpressionUUID->"3021797d-75c8-4ced-b2d9-48e32d9a3a78"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
           $CellContext`a[1]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`a[3], 
       $CellContext`a[1]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[2]=",
 CellID->1546037443,ExpressionUUID->"4aaacc9a-2f29-4989-b135-97875338e5c0"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[2]=",
 CellID->1846659448,ExpressionUUID->"efcf8972-033b-4746-bec6-3fadfdfb13e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"a", "[", "2", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"Dagger", "[", 
        RowBox[{"a", "[", "1", "]"}], "]"}], "**", 
       RowBox[{"a", "[", "3", "]"}]}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->950609431,ExpressionUUID->"59dc3222-022b-4dea-8245-ddc4d6295368"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"a", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`a[1]]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`a[1]], 
       $CellContext`a[3]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1185499796,ExpressionUUID->"c376072c-dd4b-4d01-be32-a4fa11a0cc10"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`a[1]]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`a[3]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`a[1]], 
     $CellContext`a[3]]]}], "+", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"a", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`a[2]]], 
        InterpretationBox[
         SubscriptBox["a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`a[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`a[2]], 
     $CellContext`a[1]]]}]}]], "Print",
 CellLabel->"During evaluation of In[379]:=",
 CellID->341794506,ExpressionUUID->"f1e96dc4-edd5-4196-ba44-96edf5b2c2e2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`a[1]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`a[2]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`a[3]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[379]:=",
 CellID->21506617,ExpressionUUID->"ca8b6666-4809-45ce-9b73-fa9c393b9120"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{"x", " ", "z"}]},
     {"x", "0", "0"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0, {
     1, {{0, 1, 2, 2}, {{3}, {
       1}}}, {$CellContext`x $CellContext`z, $CellContext`x}}]]]]], "Output",
 CellLabel->"Out[3]//MatrixForm=",
 CellID->684459223,ExpressionUUID->"07362080-0b7f-4718-b01c-7f639910da2d"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"a", 
             TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`a[1]]], 
          InterpretationBox[
           SubscriptBox["a", 
            TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
           $CellContext`a[3]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`a[1]], 
       $CellContext`a[3]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"a", 
            TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`a[2]]], 
         InterpretationBox[
          SubscriptBox["a", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
          $CellContext`a[1]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`a[2]], 
      $CellContext`a[1]]]}], ")"}]}]], "Output",
 CellLabel->"Out[3]=",
 CellID->1783747629,ExpressionUUID->"d776f464-b0fb-4663-bf42-33833958d86d"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[3]=",
 CellID->574688483,ExpressionUUID->"eb999440-6a90-4e39-a384-f73f6d08cacd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c", ",", "d"}], "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1462286656,ExpressionUUID->"559d5cde-1955-47dc-affa-dc1ee31cea7a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", "Up", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"c", "[", "Down", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"c", "[", "Up", "]"}], "**", 
       RowBox[{"d", "[", "Up", "]"}]}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1828079879,ExpressionUUID->"dc8cc277-30ea-4910-9709-9e7d9636c458"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["d", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`d[Plus[1]/2]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`d[
        Rational[1, 2]], 
       $CellContext`c[
        Rational[1, 2]]]]}], "-", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`c[(-1)/2]]], 
         InterpretationBox[
          SubscriptBox["c", 
           
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
            "RowWithSeparators"]], 
          $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`c[
        Rational[-1, 2]]], 
      $CellContext`c[
       Rational[1, 2]]]]}], ")"}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->2099369269,ExpressionUUID->"cf6ed403-9d2e-425d-bb40-2e5c07a8c7cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "x"}], " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["d", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`d[Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`d[
      Rational[1, 2]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           
           TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
            "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[(-1)/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[-1, 2]]], 
     $CellContext`c[
      Rational[1, 2]]]]}]}]], "Print",
 CellLabel->"During evaluation of In[387]:=",
 CellID->942983873,ExpressionUUID->"723dfef1-2c8d-4bf1-9880-0096c3099537"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[(-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[Plus[1]/2]], ",", 
   InterpretationBox[
    SubscriptBox["d", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`d[Plus[1]/2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[(-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"d", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`d[1/2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[387]:=",
 CellID->300638651,ExpressionUUID->"514e52a5-147f-4e01-bc24-b125b5b00c2b"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", 
       FractionBox["x", "2"]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], 
      FractionBox["x", "2"], "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"x", " ", "z"}], "2"]}], "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 1, 1, 1, 1, 3, 4}, {{2}, {3}, {4}, {2}}}, {
      Rational[-1, 2] $CellContext`x, 
       Rational[1, 2] $CellContext`x $CellContext`z, 
       Rational[1, 2] $CellContext`x, 
       Rational[-1, 2] $CellContext`x $CellContext`z}}]]]]], "Output",
 CellLabel->"Out[5]//MatrixForm=",
 CellID->1952269613,ExpressionUUID->"e912e3db-750b-4344-9b37-c49f1e4e6385"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "x"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"z", " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["d", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`d[Plus[1]/2]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`d[
        Rational[1, 2]], 
       $CellContext`c[
        Rational[1, 2]]]]}], "+", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`c[(-1)/2]]], 
         InterpretationBox[
          SubscriptBox["c", 
           
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
            "RowWithSeparators"]], 
          $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`c[
        Rational[-1, 2]]], 
      $CellContext`c[
       Rational[1, 2]]]]}], ")"}]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->392743178,ExpressionUUID->"6eaa5cd5-bfc3-495c-804a-fc61babe0a19"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[5]=",
 CellID->1617345415,ExpressionUUID->"e32b5a2f-f83c-45cf-9250-174b697572bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"x", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"c", "[", "Up", "]"}], "**", 
      RowBox[{"Dagger", "[", 
       RowBox[{"c", "[", "Down", "]"}], "]"}]}], "+", 
     RowBox[{"z", "*", 
      RowBox[{
       RowBox[{"c", "[", "Up", "]"}], "**", 
       RowBox[{"d", "[", "Up", "]"}]}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{"expr", "+", 
   RowBox[{"Dagger", "[", "expr", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Expand", "[", "expr", "]"}], "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ops", "//", "Print"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"rslt", "=", 
  RowBox[{
   RowBox[{"MultiplyDot", "[", 
    RowBox[{
     RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rslt", "-", "expr"}], "//", "Simplify"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->680707724,ExpressionUUID->"07f8e7bd-3ede-491b-87e1-48941fb4f01c"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "z"}], " ", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           SubscriptBox["d", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`d[Plus[1]/2]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       $CellContext`d[
        Rational[1, 2]], 
       $CellContext`c[
        Rational[1, 2]]]]}], "-", 
    InterpretationBox[
     TemplateBox[{
       TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
         InterpretationBox[
          TemplateBox[{"c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"], 
            
            TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
             "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
           SubsuperscriptBox], 
          Q3`Dagger[
           $CellContext`c[(-1)/2]]], 
         InterpretationBox[
          SubscriptBox["c", 
           
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
            "RowWithSeparators"]], 
          $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
      "RowDefault"],
     Q3`Multiply[
      Q3`Dagger[
       $CellContext`c[
        Rational[-1, 2]]], 
      $CellContext`c[
       Rational[1, 2]]]]}], ")"}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1483456694,ExpressionUUID->"288681de-a621-4360-b61d-98e405bdcd94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "z"}], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            SubscriptBox["d", 
             
             TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
              "RowWithSeparators"]], 
            $CellContext`d[Plus[1]/2]], 
           InterpretationBox[
            SubscriptBox["c", 
             
             TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
              "RowWithSeparators"]], 
            $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        $CellContext`d[
         Rational[1, 2]], 
        $CellContext`c[
         Rational[1, 2]]]]}], "-", 
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"c", 
             
             TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
              "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`c[(-1)/2]]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`c[
         Rational[-1, 2]]], 
       $CellContext`c[
        Rational[1, 2]]]]}], ")"}]}], "+", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`c[1/2]]], 
           InterpretationBox[
            SubscriptBox["c", 
             
             TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
              "RowWithSeparators"]], 
            $CellContext`c[(-1)/2]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        Q3`Dagger[
         $CellContext`c[
          Rational[1, 2]]], 
        $CellContext`c[
         Rational[-1, 2]]]]}], "-", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{"z", 
         TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
           StyleBox[
           "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
          "RowWithSeparators"]},
        "Superscript"],
       Conjugate[Q3`Private`z]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`c[1/2]]], 
           InterpretationBox[
            TemplateBox[{"d", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`d[1/2]]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        Q3`Dagger[
         $CellContext`c[
          Rational[1, 2]]], 
        Q3`Dagger[
         $CellContext`d[
          Rational[1, 2]]]]]}]}], ")"}]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->171514388,ExpressionUUID->"f95244ed-22a9-47eb-9fd1-570dbb3e3986"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "x"}], " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["d", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`d[Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`d[
      Rational[1, 2]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           
           TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
            "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[(-1)/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[-1, 2]]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[1/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[(-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[1, 2]]], 
     $CellContext`c[
      Rational[-1, 2]]]]}], "-", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   InterpretationBox[
    TemplateBox[{"z", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[1/2]]], 
        InterpretationBox[
         TemplateBox[{"d", 
           TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`d[1/2]]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[1, 2]]], 
     Q3`Dagger[
      $CellContext`d[
       Rational[1, 2]]]]]}]}]], "Print",
 CellLabel->"During evaluation of In[394]:=",
 CellID->719264842,ExpressionUUID->"16c0e2e2-e3ba-4216-ae14-08abe334b26c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[(-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[Plus[1]/2]], ",", 
   InterpretationBox[
    SubscriptBox["d", 
     TemplateBox[{",", "\",\"", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`d[Plus[1]/2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[(-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"d", 
      TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`d[1/2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[394]:=",
 CellID->498750531,ExpressionUUID->"1cc0ca24-3756-4fe3-a850-9800b26f3357"]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", 
       FractionBox["x", "2"]}], "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        InterpretationBox[
         TemplateBox[{"x", 
           TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
             StyleBox[
             "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]},
             "RowWithSeparators"]},
          "Superscript"],
         Conjugate[Q3`Private`z]], "2"]}], "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       InterpretationBox[
        TemplateBox[{"x", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]], " ", 
       InterpretationBox[
        TemplateBox[{"z", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]]}]},
     {"0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       InterpretationBox[
        TemplateBox[{"x", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]], " ", 
       InterpretationBox[
        TemplateBox[{"z", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]]}], "0"},
     {"0", "0", "0", "0", 
      FractionBox[
       InterpretationBox[
        TemplateBox[{"x", 
          TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
            StyleBox[
            "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
           "RowWithSeparators"]},
         "Superscript"],
        Conjugate[Q3`Private`z]], "2"], "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{"x", " ", "z"}], "2"], 
      FractionBox["x", "2"], "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"x", " ", "z"}], "2"]}], "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 1, 3, 4, 5, 7, 8}, {{2}, {1}, {6}, {5}, {5}, {3}, {4}, {2}}}, {
      Rational[-1, 2] $CellContext`x, Rational[-1, 2] 
       Conjugate[$CellContext`x], Rational[-1, 2] Conjugate[$CellContext`x] 
       Conjugate[$CellContext`z], Rational[1, 2] Conjugate[$CellContext`x] 
       Conjugate[$CellContext`z], Rational[1, 2] Conjugate[$CellContext`x], 
       Rational[1, 2] $CellContext`x $CellContext`z, 
       Rational[1, 2] $CellContext`x, 
       Rational[-1, 2] $CellContext`x $CellContext`z}}]]]]], "Output",
 CellLabel->"Out[6]//MatrixForm=",
 CellID->871500276,ExpressionUUID->"3fe09f24-d848-4d37-977b-b680c02f8224"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "x"}], " ", "z", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["d", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`d[Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`d[
      Rational[1, 2]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{"x", " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           
           TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
            "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         Q3`Dagger[
          $CellContext`c[(-1)/2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, "RowWithSeparators"]], 
         $CellContext`c[Plus[1]/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     Q3`Dagger[
      $CellContext`c[
       Rational[-1, 2]]], 
     $CellContext`c[
      Rational[1, 2]]]]}], "-", 
  RowBox[{
   InterpretationBox[
    TemplateBox[{"x", 
      TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
        StyleBox[
        "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
       "RowWithSeparators"]},
     "Superscript"],
    Conjugate[Q3`Private`z]], " ", 
   RowBox[{"(", 
    RowBox[{
     InterpretationBox[
      TemplateBox[{
        TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
          InterpretationBox[
           TemplateBox[{"c", 
             
             TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
              "RowWithSeparators"], 
             
             TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
              "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
            SubsuperscriptBox], 
           Q3`Dagger[
            $CellContext`c[1/2]]], 
          InterpretationBox[
           SubscriptBox["c", 
            
            TemplateBox[{",", "\",\"", "\"\[DownArrow]\""}, 
             "RowWithSeparators"]], 
           $CellContext`c[(-1)/2]]}, "RowWithSeparators"]},
       "RowDefault"],
      Q3`Multiply[
       Q3`Dagger[
        $CellContext`c[
         Rational[1, 2]]], 
       $CellContext`c[
        Rational[-1, 2]]]], "+", 
     RowBox[{
      InterpretationBox[
       TemplateBox[{"z", 
         TemplateBox[{"\[ThinSpace]", "\"\[ThinSpace]\"", 
           StyleBox[
           "\"*\"", FontColor -> RGBColor[1, 0, 0], StripOnInput -> False]}, 
          "RowWithSeparators"]},
        "Superscript"],
       Conjugate[Q3`Private`z]], " ", 
      InterpretationBox[
       TemplateBox[{
         TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
           InterpretationBox[
            TemplateBox[{"c", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`c[1/2]]], 
           InterpretationBox[
            TemplateBox[{"d", 
              
              TemplateBox[{",", "\",\"", "\"\[UpArrow]\""}, 
               "RowWithSeparators"], 
              
              TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, 
               "RowWithSeparators"]}, "Subsuperscript", SyntaxForm -> 
             SubsuperscriptBox], 
            Q3`Dagger[
             $CellContext`d[1/2]]]}, "RowWithSeparators"]},
        "RowDefault"],
       Q3`Multiply[
        Q3`Dagger[
         $CellContext`c[
          Rational[1, 2]]], 
        Q3`Dagger[
         $CellContext`d[
          Rational[1, 2]]]]]}]}], ")"}]}]}]], "Output",
 CellLabel->"Out[6]=",
 CellID->1466666192,ExpressionUUID->"526fb421-1d9d-4581-8cc7-a9e474d103b7"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[6]=",
 CellID->1441388678,ExpressionUUID->"1466a4b1-da9b-46dd-b808-27fcc2d112fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[Cell[
  "\t", "ExampleDelimiter",ExpressionUUID->
   "f6a634fe-03a9-4057-bdcd-769767570c0c"],
  $Line = 0; Null]], "ExampleDelimiter",
 CellID->2034447609,ExpressionUUID->"f40c37e2-13d2-427b-a39e-8ced5ea59898"],

Cell["\<\
Here is another important example including anomalous bilinear form.\
\>", "ExampleText",
 CellID->2085944042,ExpressionUUID->"9262b7d1-b225-4cef-8380-b51c5f1a1f7a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"h0", "=", 
  RowBox[{"PlusDagger", "[", 
   RowBox[{"FockHopping", "@@", 
    RowBox[{"c", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"h1", "=", 
  RowBox[{"MultiplyDot", "[", 
   RowBox[{
    RowBox[{"Dagger", "@", 
     RowBox[{"FockIsospinor", "[", 
      RowBox[{"c", "[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"ThePauli", "[", "1", "]"}], ",", 
    RowBox[{"FockIsospinor", "[", 
     RowBox[{"c", "[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"hh", "=", 
  RowBox[{"h0", "+", "h1"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->790976619,ExpressionUUID->"8e3c7891-45bf-411d-aa2e-0c94472abeee"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`c[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1]], 
    $CellContext`c[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`c[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[2]], 
    $CellContext`c[1]]]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1496184049,ExpressionUUID->"61f77c09-e8cd-4057-a3fe-034ad5aa54cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[2, Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[1, (-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`c[2, 
      Rational[1, 2]], 
     $CellContext`c[1, 
      Rational[-1, 2]]]]}], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1, 1/2]]], 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2, (-1)/2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1, 
      Rational[1, 2]]], 
    Q3`Dagger[
     $CellContext`c[2, 
      Rational[-1, 2]]]]]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->1479288820,ExpressionUUID->"3d94d0c8-88f9-431f-9e37-06c00a464442"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[2, Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[1, (-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`c[2, 
      Rational[1, 2]], 
     $CellContext`c[1, 
      Rational[-1, 2]]]]}], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`c[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1]], 
    $CellContext`c[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`c[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[2]], 
    $CellContext`c[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1, 1/2]]], 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2, (-1)/2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1, 
      Rational[1, 2]]], 
    Q3`Dagger[
     $CellContext`c[2, 
      Rational[-1, 2]]]]]}]], "Output",
 CellLabel->"Out[1]=",
 CellID->989016421,ExpressionUUID->"70a949ac-466f-48b7-b3d4-7be3d726f9c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FockBilinearQ", "[", "hh", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FockBilinearQ", "[", 
  RowBox[{"hh", ",", "True"}], "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1401692392,ExpressionUUID->"70de76b7-8e2b-4112-b946-8860bba81573"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[2]=",
 CellID->797663268,ExpressionUUID->"9027f035-3111-48e3-be6b-062ab4d51477"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[2]=",
 CellID->1733620702,ExpressionUUID->"0d20b781-0c84-46c8-8324-a394287950a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "hh", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ops", "//", "Print"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1021100159,ExpressionUUID->"1acfec2d-fe04-42b8-b14d-c3a26879e557"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[1, (-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[1, Plus[1]/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[2, (-1)/2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""},
      "RowWithSeparators"]],
    $CellContext`c[2, Plus[1]/2]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
       "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1, (-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[1, 1/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
       "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[2, (-1)/2]]], ",", 
   InterpretationBox[
    TemplateBox[{"c", 
      TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`c[2, 1/2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[407]:=",
 CellID->268618996,ExpressionUUID->"e5701247-7ed2-42ef-883b-db2c2a4b9eba"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {12, 12}, 0, {
     1, {{0, 1, 2, 2, 3, 4, 4, 5, 6, 7, 7, 7, 8}, {{2}, {1}, {11}, {10}, {
       8}, {7}, {6}, {3}}}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[-1, 2], 
       Rational[-1, 2], Rational[-1, 2], Rational[1, 2], 
       Rational[-1, 2]}}]]]]], "Output",
 CellLabel->"Out[3]//MatrixForm=",
 CellID->668839778,ExpressionUUID->"d4f3dad5-5a63-4e5e-844a-d827eb4f5fd7"]
}, Open  ]],

Cell["\<\
Let us check if the found operators and the matrix are correct\
\>", "ExampleText",
 CellID->1362781649,ExpressionUUID->"e933763e-3005-43b3-a05f-c8ff36333034"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"res", "=", 
  RowBox[{"MultiplyDot", "[", 
   RowBox[{
    RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"res", "-", "hh"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->1358079488,ExpressionUUID->"0c7c289d-5c63-45f6-a13d-31b96a731b1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[UpArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[2, Plus[1]/2]], 
        InterpretationBox[
         SubscriptBox["c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[DownArrow]\""}, 
           "RowWithSeparators"]], 
         $CellContext`c[1, (-1)/2]]}, "RowWithSeparators"]},
     "RowDefault"],
    Q3`Multiply[
     $CellContext`c[2, 
      Rational[1, 2]], 
     $CellContext`c[1, 
      Rational[-1, 2]]]]}], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`c[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1]], 
    $CellContext`c[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2]]], 
       InterpretationBox[
        SubscriptBox["c", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`c[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[2]], 
    $CellContext`c[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "1", "\"\[UpArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[1, 1/2]]], 
       InterpretationBox[
        TemplateBox[{"c", 
          
          TemplateBox[{",", "\",\"", "2", "\"\[DownArrow]\""}, 
           "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`c[2, (-1)/2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`c[1, 
      Rational[1, 2]]], 
    Q3`Dagger[
     $CellContext`c[2, 
      Rational[-1, 2]]]]]}]], "Output",
 CellLabel->"Out[4]=",
 CellID->592614415,ExpressionUUID->"956dc3c9-84d0-41bc-b1f8-4fdadecf3518"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[4]=",
 CellID->41318119,ExpressionUUID->"9ab8ff7c-106b-4170-834d-45c42f3c3a7b"]
}, Open  ]],

Cell["A similar example with bosons.", "ExampleText",
 CellID->207674041,ExpressionUUID->"4522dd21-6b52-4360-bdb1-5ef1de8e9407"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"h0", "=", 
  RowBox[{"PlusDagger", "@", 
   RowBox[{"FockHopping", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"h1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "**", 
    RowBox[{"a", "[", "2", "]"}]}], "+", 
   RowBox[{"Dagger", "[", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "**", 
     RowBox[{"a", "[", "2", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"hh", "=", 
  RowBox[{"h0", "+", "h1"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->716680712,ExpressionUUID->"3bd392c7-df32-4505-a7e0-5e96d206b947"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    $CellContext`a[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[2]], 
    $CellContext`a[1]]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1573309734,ExpressionUUID->"c0b351cd-777b-4b8d-a67f-982f6599f890"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`a[2], 
    $CellContext`a[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    Q3`Dagger[
     $CellContext`a[2]]]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->650553827,ExpressionUUID->"779a5f88-d1d6-4c1b-adc4-d264b5e58973"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`a[2], 
    $CellContext`a[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    $CellContext`a[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    Q3`Dagger[
     $CellContext`a[2]]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[2]], 
    $CellContext`a[1]]]}]], "Output",
 CellLabel->"Out[5]=",
 CellID->1018923512,ExpressionUUID->"74753690-cdf8-47a6-8567-c7a623b10cfb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FockBilinearQ", "[", "hh", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FockBilinearQ", "[", 
  RowBox[{"hh", ",", "True"}], "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->227185655,ExpressionUUID->"37169487-2dcb-4786-b2bc-1276d727c000"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[6]=",
 CellID->1336905752,ExpressionUUID->"4519a139-a57b-4439-b15e-7f5604a13178"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[6]=",
 CellID->253575303,ExpressionUUID->"b4ec49ae-d202-4e2e-8905-a61d8e25fd3b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ops", ",", "mat"}], "}"}], "=", 
   RowBox[{"FockBilinearSystem", "[", "hh", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ops", "//", "Print"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "MatrixForm"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->95272385,ExpressionUUID->"804dffdd-9645-4926-ae7f-cf714e843f31"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`a[1]], ",", 
   InterpretationBox[
    SubscriptBox["a", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`a[2]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[1]]], ",", 
   InterpretationBox[
    TemplateBox[{"a", 
      TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
      TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
     "Subsuperscript"],
    Q3`Dagger[
     $CellContext`a[2]]]}], "}"}]], "Print",
 CellLabel->"During evaluation of In[417]:=",
 CellID->1407168179,ExpressionUUID->"c621f2ae-a3c8-43aa-8359-8e350c1f2f95"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"]},
     {
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"]},
     {
      FractionBox["1", "2"], "0", 
      FractionBox["1", "2"], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{2}, {4}, {1}, {3}, {2}, {4}, {1}, {3}}}, {
      Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[1, 2], 
       Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[
       1, 2]}}]]]]], "Output",
 CellLabel->"Out[7]//MatrixForm=",
 CellID->38180042,ExpressionUUID->"a4ba5605-9226-48f1-8285-ca129a3f718d"]
}, Open  ]],

Cell["\<\
Let us check if the found operators and the matrix are correct\
\>", "ExampleText",
 CellID->352647418,ExpressionUUID->"48d33c71-9880-4f48-9c41-ca8dcde7aa94"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"res", "=", 
  RowBox[{"MultiplyDot", "[", 
   RowBox[{
    RowBox[{"Dagger", "[", "ops", "]"}], ",", "mat", ",", "ops"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"res", "-", "hh"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->2037772253,ExpressionUUID->"22430016-76ed-4e43-9946-3aa729147cf1"],

Cell[BoxData[
 RowBox[{
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    $CellContext`a[2], 
    $CellContext`a[1]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
        $CellContext`a[2]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    $CellContext`a[2]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[1]]], 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[1]], 
    Q3`Dagger[
     $CellContext`a[2]]]], "+", 
  InterpretationBox[
   TemplateBox[{
     TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
       InterpretationBox[
        TemplateBox[{"a", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
          TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]}, 
         "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
        Q3`Dagger[
         $CellContext`a[2]]], 
       InterpretationBox[
        SubscriptBox["a", 
         TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
        $CellContext`a[1]]}, "RowWithSeparators"]},
    "RowDefault"],
   Q3`Multiply[
    Q3`Dagger[
     $CellContext`a[2]], 
    $CellContext`a[1]]]}]], "Output",
 CellLabel->"Out[8]=",
 CellID->655607211,ExpressionUUID->"aaa29b3a-b0fe-4791-81b8-d76bb6bd2673"],

Cell[BoxData["0"], "Output",
 CellLabel->"Out[8]=",
 CellID->51802520,ExpressionUUID->"7510e477-8c19-43eb-829e-35663333cc3b"]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearQ"]], 
           "paclet:QuantumMob/Q3/ref/FockBilinearQ", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "a36e0900-830c-4a2d-ac01-a6eb91606807"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearOperators"]], 
           "paclet:QuantumMob/Q3/ref/FockBilinearOperators", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "95e09c4f-d88a-4592-9c3d-a030a4273172"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearMatrix"]], 
           "paclet:QuantumMob/Q3/ref/FockBilinearMatrix", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "1e42446a-13e6-4c25-a303-cb17df190134"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["FockBilinearSystem"]], 
           "paclet:QuantumMob/Q3/ref/FockBilinearSystem", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "0cdca578-1853-40c9-9e1c-23d455808dce"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["CoefficientTensor"]], 
           "paclet:QuantumMob/Q3/ref/CoefficientTensor", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "44cb98a7-a253-4075-bb2c-8bdac99dfa52"]
       }], "SeeAlso",ExpressionUUID->"d8a1e74d-f813-4172-9cdf-bcd4e3df7c12"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"7eb07ee3-4a3e-4abf-86a0-\
540f9b28ccc2"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTutorial.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TutorialsSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "2fd33430-9098-46a2-b3d8-44b4ea787ad9"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], 
           "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "29911bf6-7b97-4be1-bbce-220552425010"]}]}
     }]}
  }]], "TutorialsSection",ExpressionUUID->"f906ac58-c96b-4075-a7f9-\
0b580b356c25"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "e80d9e0b-4557-4b0c-be70-1a7d6cf89c1e"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "c1bba813-fb0a-4497-8a1d-3cd60e8f7720"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"ce648df1-e3b2-44be-a412-\
86829b04053f"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "98d6cc53-06e6-4071-9cd2-bcb1b532df08"]}]],ExpressionUUID->
         "33ef5542-b3b8-4138-9532-dfd276dd0b20"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "a1651622-903d-4c18-8918-794e61d1a5d4"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"17e37afc-9330-4ad5-86c6-\
6e0819570fdf"],

Cell[" ", "FooterCell",ExpressionUUID->"9ac8710d-2d13-4c81-9474-498ee9a3effb"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"FockBilinearSystem",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, "ExampleSection" -> {"0" -> Open}, 
    "AllOptsTable" -> Closed}, "NewStyles" -> True, 
  "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 10, 14, 23, 20.341518}", 
    "history" -> {"12", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {}, "specialkeywords" -> {}, 
    "tutorialcollectionlinks" -> {}, "index" -> True, "label" -> 
    "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> "QuantumMob/Q3",
     "status" -> "None", "summary" -> 
    "FockBilinearSystem[expr] returns a list of {operators, matrix} of the \
bilinear combination.", "synonyms" -> {}, "tabletags" -> {}, "title" -> 
    "FockBilinearSystem", "titlemodifier" -> "", "metadescription" -> "", 
    "windowtitle" -> "FockBilinearSystem", "type" -> "Symbol", "uri" -> 
    "QuantumMob/Q3/ref/FockBilinearSystem"}},
CellContext->"Global`",
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> FrontEnd`FileName[{"Wolfram"}, "Reference.nb"]]], 
   Cell[
    StyleData["Input"], CellContext -> "Global`"], 
   Cell[
    StyleData["Output"], CellContext -> "Global`"]}, Visible -> False, 
  FrontEndVersion -> "14.3 for Mac OS X ARM (64-bit) (July 8, 2025)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"cdfec8b4-82b8-44c2-99ac-807d0dee53a6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[8995, 234, 1440, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"4f8436a9-3ec5-4daa-a1b6-9b254cccecef",
   CellTags->"PrimaryExamplesSection",
   CellID->776329039]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 99880, 2893}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[586, 21, 7197, 176, 70, "AnchorBarGrid",ExpressionUUID->"4b61a1df-9a99-4093-b417-2da7dabf715f",
 CellID->1],
Cell[7786, 199, 96, 0, 70, "ContextNameCell",ExpressionUUID->"32a40816-2484-4dbf-977e-cf118f9f569a"],
Cell[CellGroupData[{
Cell[7907, 203, 561, 14, 70, "ObjectNameGrid",ExpressionUUID->"aaf927b8-a653-4ce1-bae7-382aae5dfa23"],
Cell[8471, 219, 487, 10, 70, "Usage",ExpressionUUID->"83f4f0c5-e020-43f7-8255-6c75ec19a0ac",
 CellID->982511436]
}, Open  ]],
Cell[CellGroupData[{
Cell[8995, 234, 1440, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"4f8436a9-3ec5-4daa-a1b6-9b254cccecef",
 CellTags->"PrimaryExamplesSection",
 CellID->776329039],
Cell[10438, 274, 202, 3, 70, "Input",ExpressionUUID->"7d6ef191-553c-497f-8b91-83ed02c6abd7",
 CellID->742081683],
Cell[CellGroupData[{
Cell[10665, 281, 1419, 37, 70, "ExampleSection",ExpressionUUID->"129fba0e-616b-442b-ae6f-8ef9e04a5dd5",
 CellID->1799002948],
Cell[12087, 320, 218, 5, 70, "Input",ExpressionUUID->"993f5ddd-9ac1-459b-91f4-0ad67b649968",
 CellID->54356201],
Cell[CellGroupData[{
Cell[12330, 329, 1214, 34, 70, "Input",ExpressionUUID->"760a2a24-282c-4f22-a2f1-3dc184e67101",
 CellID->301411736],
Cell[13547, 365, 1510, 42, 70, "Output",ExpressionUUID->"b2799f60-6de1-49f1-9489-3c42f49cb47d",
 CellID->2048158089],
Cell[CellGroupData[{
Cell[15082, 411, 1440, 39, 70, "Print",ExpressionUUID->"182505c5-51eb-4ee7-b324-be722398ad90",
 CellID->1377624060],
Cell[16525, 452, 1356, 40, 70, "Print",ExpressionUUID->"29772cc7-fc17-4965-a7bf-0ade2c97d801",
 CellID->1706378113]
}, Open  ]],
Cell[17896, 495, 1214, 34, 70, "Output",ExpressionUUID->"3021797d-75c8-4ced-b2d9-48e32d9a3a78",
 CellID->1600323153],
Cell[19113, 531, 1510, 42, 70, "Output",ExpressionUUID->"4aaacc9a-2f29-4989-b135-97875338e5c0",
 CellID->1546037443],
Cell[20626, 575, 127, 2, 70, "Output",ExpressionUUID->"efcf8972-033b-4746-bec6-3fadfdfb13e3",
 CellID->1846659448]
}, Open  ]],
Cell[CellGroupData[{
Cell[20790, 582, 1253, 35, 70, "Input",ExpressionUUID->"59dc3222-022b-4dea-8245-ddc4d6295368",
 CellID->950609431],
Cell[22046, 619, 1730, 48, 70, "Output",ExpressionUUID->"c376072c-dd4b-4d01-be32-a4fa11a0cc10",
 CellID->1185499796],
Cell[CellGroupData[{
Cell[23801, 671, 1622, 43, 70, "Print",ExpressionUUID->"f1e96dc4-edd5-4196-ba44-96edf5b2c2e2",
 CellID->341794506],
Cell[25426, 716, 598, 19, 70, "Print",ExpressionUUID->"ca8b6666-4809-45ce-9b73-fa9c393b9120",
 CellID->21506617]
}, Open  ]],
Cell[26039, 738, 779, 23, 70, "Output",ExpressionUUID->"07362080-0b7f-4718-b01c-7f639910da2d",
 CellID->684459223],
Cell[26821, 763, 1730, 48, 70, "Output",ExpressionUUID->"d776f464-b0fb-4663-bf42-33833958d86d",
 CellID->1783747629],
Cell[28554, 813, 126, 2, 70, "Output",ExpressionUUID->"eb999440-6a90-4e39-a384-f73f6d08cacd",
 CellID->574688483]
}, Open  ]],
Cell[28695, 818, 232, 5, 70, "Input",ExpressionUUID->"559d5cde-1955-47dc-affa-dc1ee31cea7a",
 CellID->1462286656],
Cell[CellGroupData[{
Cell[28952, 827, 1226, 35, 70, "Input",ExpressionUUID->"dc8cc277-30ea-4910-9709-9e7d9636c458",
 CellID->1828079879],
Cell[30181, 864, 1808, 55, 70, "Output",ExpressionUUID->"cf6ed403-9d2e-425d-bb40-2e5c07a8c7cd",
 CellID->2099369269],
Cell[CellGroupData[{
Cell[32014, 923, 1648, 46, 70, "Print",ExpressionUUID->"723dfef1-2c8d-4bf1-9880-0096c3099537",
 CellID->942983873],
Cell[33665, 971, 1467, 40, 70, "Print",ExpressionUUID->"514e52a5-147f-4e01-bc24-b125b5b00c2b",
 CellID->300638651]
}, Open  ]],
Cell[35147, 1014, 1263, 36, 70, "Output",ExpressionUUID->"e912e3db-750b-4344-9b37-c49f1e4e6385",
 CellID->1952269613],
Cell[36413, 1052, 1804, 55, 70, "Output",ExpressionUUID->"6eaa5cd5-bfc3-495c-804a-fc61babe0a19",
 CellID->392743178],
Cell[38220, 1109, 127, 2, 70, "Output",ExpressionUUID->"e32b5a2f-f83c-45cf-9250-174b697572bd",
 CellID->1617345415]
}, Open  ]],
Cell[CellGroupData[{
Cell[38384, 1116, 1341, 38, 70, "Input",ExpressionUUID->"07f8e7bd-3ede-491b-87e1-48941fb4f01c",
 CellID->680707724],
Cell[39728, 1156, 1808, 55, 70, "Output",ExpressionUUID->"288681de-a621-4360-b61d-98e405bdcd94",
 CellID->1483456694],
Cell[41539, 1213, 4648, 137, 70, "Output",ExpressionUUID->"f95244ed-22a9-47eb-9fd1-570dbb3e3986",
 CellID->171514388],
Cell[CellGroupData[{
Cell[46212, 1354, 4288, 120, 70, "Print",ExpressionUUID->"16c0e2e2-e3ba-4216-ae14-08abe334b26c",
 CellID->719264842],
Cell[50503, 1476, 1467, 40, 70, "Print",ExpressionUUID->"1cc0ca24-3756-4fe3-a850-9800b26f3357",
 CellID->498750531]
}, Open  ]],
Cell[51985, 1519, 3577, 95, 70, "Output",ExpressionUUID->"3fe09f24-d848-4d37-977b-b680c02f8224",
 CellID->871500276],
Cell[55565, 1616, 4355, 126, 70, "Output",ExpressionUUID->"526fb421-1d9d-4581-8cc7-a9e474d103b7",
 CellID->1466666192],
Cell[59923, 1744, 127, 2, 70, "Output",ExpressionUUID->"1466a4b1-da9b-46dd-b808-27fcc2d112fa",
 CellID->1441388678]
}, Open  ]],
Cell[CellGroupData[{
Cell[60087, 1751, 243, 5, 70, "ExampleDelimiter",ExpressionUUID->"f40c37e2-13d2-427b-a39e-8ced5ea59898",
 CellID->2034447609],
Cell[60333, 1758, 175, 3, 70, "ExampleText",ExpressionUUID->"9262b7d1-b225-4cef-8380-b51c5f1a1f7a",
 CellID->2085944042],
Cell[CellGroupData[{
Cell[60533, 1765, 757, 20, 70, "Input",ExpressionUUID->"8e3c7891-45bf-411d-aa2e-0c94472abeee",
 CellID->790976619],
Cell[61293, 1787, 1507, 41, 70, "Output",ExpressionUUID->"61f77c09-e8cd-4057-a3fe-034ad5aa54cd",
 CellID->1496184049],
Cell[62803, 1830, 1834, 54, 70, "Output",ExpressionUUID->"3d94d0c8-88f9-431f-9e37-06c00a464442",
 CellID->1479288820],
Cell[64640, 1886, 3211, 92, 70, "Output",ExpressionUUID->"70a949ac-466f-48b7-b3d4-7be3d726f9c7",
 CellID->989016421]
}, Open  ]],
Cell[CellGroupData[{
Cell[67888, 1983, 300, 6, 70, "Input",ExpressionUUID->"70de76b7-8e2b-4112-b946-8860bba81573",
 CellID->1401692392],
Cell[68191, 1991, 129, 2, 70, "Output",ExpressionUUID->"9027f035-3111-48e3-be6b-062ab4d51477",
 CellID->797663268],
Cell[68323, 1995, 130, 2, 70, "Output",ExpressionUUID->"0d20b781-0c84-46c8-8324-a394287950a5",
 CellID->1733620702]
}, Open  ]],
Cell[CellGroupData[{
Cell[68490, 2002, 425, 10, 70, "Input",ExpressionUUID->"1acfec2d-fe04-42b8-b14d-c3a26879e557",
 CellID->1021100159],
Cell[68918, 2014, 2769, 78, 70, "Print",ExpressionUUID->"e5701247-7ed2-42ef-883b-db2c2a4b9eba",
 CellID->268618996],
Cell[71690, 2094, 1958, 47, 70, "Output",ExpressionUUID->"d4f3dad5-5a63-4e5e-844a-d827eb4f5fd7",
 CellID->668839778]
}, Open  ]],
Cell[73663, 2144, 169, 3, 70, "ExampleText",ExpressionUUID->"e933763e-3005-43b3-a05f-c8ff36333034",
 CellID->1362781649],
Cell[CellGroupData[{
Cell[73857, 2151, 356, 8, 70, "Input",ExpressionUUID->"0c7c289d-5c63-45f6-a13d-31b96a731b1d",
 CellID->1358079488],
Cell[74216, 2161, 3211, 92, 70, "Output",ExpressionUUID->"956dc3c9-84d0-41bc-b1f8-4fdadecf3518",
 CellID->592614415],
Cell[77430, 2255, 125, 2, 70, "Output",ExpressionUUID->"9ab8ff7c-106b-4170-834d-45c42f3c3a7b",
 CellID->41318119]
}, Open  ]],
Cell[77570, 2260, 128, 1, 70, "ExampleText",ExpressionUUID->"4522dd21-6b52-4360-bdb1-5ef1de8e9407",
 CellID->207674041],
Cell[CellGroupData[{
Cell[77723, 2265, 703, 20, 70, "Input",ExpressionUUID->"3bd392c7-df32-4505-a7e0-5e96d206b947",
 CellID->716680712],
Cell[78429, 2287, 1507, 41, 70, "Output",ExpressionUUID->"c0b351cd-777b-4b8d-a67f-982f6599f890",
 CellID->1573309734],
Cell[79939, 2330, 1506, 41, 70, "Output",ExpressionUUID->"779a5f88-d1d6-4c1b-adc4-d264b5e58973",
 CellID->650553827],
Cell[81448, 2373, 2885, 79, 70, "Output",ExpressionUUID->"74753690-cdf8-47a6-8567-c7a623b10cfb",
 CellID->1018923512]
}, Open  ]],
Cell[CellGroupData[{
Cell[84370, 2457, 299, 6, 70, "Input",ExpressionUUID->"37169487-2dcb-4786-b2bc-1276d727c000",
 CellID->227185655],
Cell[84672, 2465, 130, 2, 70, "Output",ExpressionUUID->"4519a139-a57b-4439-b15e-7f5604a13178",
 CellID->1336905752],
Cell[84805, 2469, 129, 2, 70, "Output",ExpressionUUID->"b4ec49ae-d202-4e2e-8905-a61d8e25fd3b",
 CellID->253575303]
}, Open  ]],
Cell[CellGroupData[{
Cell[84971, 2476, 423, 10, 70, "Input",ExpressionUUID->"804dffdd-9645-4926-ae7f-cf714e843f31",
 CellID->95272385],
Cell[85397, 2488, 962, 28, 70, "Print",ExpressionUUID->"c621f2ae-a3c8-43aa-8359-8e350c1f2f95",
 CellID->1407168179],
Cell[86362, 2518, 1122, 33, 70, "Output",ExpressionUUID->"a4ba5605-9226-48f1-8285-ca129a3f718d",
 CellID->38180042]
}, Open  ]],
Cell[87499, 2554, 168, 3, 70, "ExampleText",ExpressionUUID->"48d33c71-9880-4f48-9c41-ca8dcde7aa94",
 CellID->352647418],
Cell[CellGroupData[{
Cell[87692, 2561, 356, 8, 70, "Input",ExpressionUUID->"22430016-76ed-4e43-9946-3aa729147cf1",
 CellID->2037772253],
Cell[88051, 2571, 2884, 79, 70, "Output",ExpressionUUID->"aaa29b3a-b0fe-4791-81b8-d76bb6bd2673",
 CellID->655607211],
Cell[90938, 2652, 125, 2, 70, "Output",ExpressionUUID->"7510e477-8c19-43eb-829e-35663333cc3b",
 CellID->51802520]
}, Open  ]]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[91317, 2664, 3095, 83, 70, "SeeAlsoSection",ExpressionUUID->"7eb07ee3-4a3e-4abf-86a0-540f9b28ccc2"],
Cell[94415, 2749, 1134, 29, 70, "TutorialsSection",ExpressionUUID->"f906ac58-c96b-4075-a7f9-0b580b356c25"],
Cell[95552, 2780, 1119, 28, 70, "MoreAboutSection",ExpressionUUID->"ce648df1-e3b2-44be-a412-86829b04053f"],
Cell[96674, 2810, 1166, 34, 70, "RelatedLinksSection",ExpressionUUID->"17e37afc-9330-4ad5-86c6-6e0819570fdf"],
Cell[97843, 2846, 78, 0, 70, "FooterCell",ExpressionUUID->"9ac8710d-2d13-4c81-9474-498ee9a3effb"]
}
]
*)

(* End of internal cache information *)
