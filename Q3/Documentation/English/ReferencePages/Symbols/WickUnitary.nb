(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    160578,       3675]
NotebookOptionsPosition[    149239,       3453]
NotebookOutlinePosition[    151456,       3505]
CellTagsIndexPosition[    151369,       3500]
WindowTitle->WickUnitary
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[GridBox[{
   {GridBox[{
      {
       ItemBox[Cell[BoxData[
         RowBox[{
          TemplateBox[{12},
           "Spacer1"], Cell["QUANTUM MOB/ Q3 SYMBOL", "PacletNameCell",
           TextAlignment->Center,ExpressionUUID->
           "a6705f1b-ee7e-433c-ae2a-df8e52fc859d"], 
          TemplateBox[{8},
           "Spacer1"]}]],
         TextAlignment->Center,ExpressionUUID->
         "44e76a10-383c-407a-940b-38bbd7009185"],
        Background->LightDarkSwitched[
          RGBColor[0.490196, 0.576471, 0.690196]],
        ItemSize->Full], ""}
     },
     GridBoxAlignment->{"Rows" -> {{Center}}},
     GridBoxItemSize->{"Columns" -> {Full, 
         Scaled[0.02]}, "Rows" -> {{2.5}}}], Cell[TextData[{
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "See Also",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "33387d2f-5b34-4615-8c3a-5149f53ba88d"]
         }],ExpressionUUID->"4049c09d-cd59-41df-bbce-ccc48a3ee7c9"],
         StripOnInput->False],{
        StyleBox["\"WickState\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/WickState"], 
         StyleBox[
          "\"WickNonunitary\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/WickNonunitary"], 
         StyleBox["\"WickJump\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/WickJump"], 
         StyleBox[
          "\"WickMeasurement\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/WickMeasurement"],
          StyleBox[
          "\"BravyiUnitary\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/BravyiUnitary"], 
         StyleBox[
          "\"NambuUnitary\"", "SeeAlsoRelated", StripOnInput -> False] :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/ref/NambuUnitary"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"SeeAlso"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "4a983cc3-143a-49d2-8a79-19dc1aaae069"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Related Guides",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "1a96ecae-c126-4769-9cc9-69df03b43f91"]
         }],ExpressionUUID->"8ee09e13-0de2-40b6-b476-ad2ac7efd696"],
         StripOnInput->False],{
        "\"Fermionic Quantum Computation\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/FermionicQuantumComputation"], 
         "\"Quantum Many-Body Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"], 
         "\"Quantum Information Systems\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"], 
         "\"Q3: Symbolic Quantum Simulation\"" :> 
         Documentation`HelpLookup["paclet:QuantumMob/Q3/guide/Q3"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"MoreAbout"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "937b1b16-d4e8-4c21-b13e-63d3c3d58238"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "Tech Notes",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "a205cf13-51be-4828-9e43-aa0aaff07fba"]
         }],ExpressionUUID->"b07e82b6-ae43-42e8-a12c-218d7a7b1235"],
         StripOnInput->False],{
        "\"Quantum Many-Body Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"], 
         "\"Quantum Information Systems with Q3\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"], 
         "\"Q3: Quick Start\"" :> 
         Documentation`HelpLookup[
          "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"Tutorials"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "313d313b-780c-4956-a8f1-197f5901599d"],
     "\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\[ThickSpace]\
\[ThickSpace]",
     Cell[BoxData[
      TagBox[
       ActionMenuBox[
        FrameBox[Cell[TextData[{
          "URL",
          " ",
          Cell[BoxData[
           GraphicsBox[
            {GrayLevel[0.66667], Thickness[0.13], 
             LineBox[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]},
            AspectRatio->1,
            ImageSize->20,
            PlotRange->{{-3, 4}, {-1, 1}},
            PlotRangePadding->Scaled[0.025]]],ExpressionUUID->
           "a4ff7b5a-2612-4709-a7b2-baa8cddcbb42"]
         }],ExpressionUUID->"34c993d5-a38f-469a-85d3-8f3534aa74ec"],
         StripOnInput->False],{
        "\"QuantumMob/Q3/ref/WickUnitary\"" :> None, 
         "\"Copy Wolfram Documentation Center URL\"" :> 
         CopyToClipboard["QuantumMob/Q3/ref/WickUnitary"], Delimiter, 
         "\"Copy web URL\"" :> 
         Module[{DocumentationSearch`Private`nb$}, 
           DocumentationSearch`Private`nb$ = 
            NotebookPut[
             Notebook[{
               Cell[BoxData[
                 MakeBoxes[
                  Hyperlink[
                   "http://reference.wolfram.com/language/QuantumMob/Q3/ref/\
WickUnitary.html"], StandardForm]], "Input", TextClipboardType -> 
                 "PlainText"]}, Visible -> False]]; 
           SelectionMove[DocumentationSearch`Private`nb$, All, Notebook]; 
           FrontEndTokenExecute[DocumentationSearch`Private`nb$, "Copy"]; 
           NotebookClose[DocumentationSearch`Private`nb$]; Null], 
         "\"Go to web URL\"" :> 
         FrontEndExecute[{
           NotebookLocate[{
             URL[(If[TrueQ[False], 
                  "http://reference.wolfram.com/system-modeler/", 
                  "http://reference.wolfram.com/language/"] <> 
                "QuantumMob/Q3/ref/WickUnitary") <> ".html"], None}]}]},
        Appearance->None,
        MenuAppearance->Automatic,
        MenuStyle->"URLMenu"],
       MouseAppearanceTag["LinkHand"]]],
      LineSpacing->{1.4, 0},ExpressionUUID->
      "b1bc9341-2f29-46c3-9eaa-c967a285c7cc"]
    }], "AnchorBar",
     CacheGraphics->False,ExpressionUUID->
     "d8811fe2-aec8-4b85-ad90-4cc3cf9a2c87"]}
  }]], "AnchorBarGrid",
 CellID->1,ExpressionUUID->"0dad1cc6-ddec-46ac-bc3f-1b3c2ba22ed7"],

Cell["QuantumMob`Q3`", "ContextNameCell",ExpressionUUID->"a3246ceb-39a4-4580-8131-f29e3e0e1366"],

Cell[CellGroupData[{

Cell[BoxData[GridBox[{
   {Cell[TextData[{
     Cell[
     "WickUnitary", "ObjectName",ExpressionUUID->
      "0f0d679c-cbc7-4a72-ab3f-b37e864fbccf"],
     Cell[BoxData[
      TemplateBox[{8},
       "Spacer1"]],ExpressionUUID->"ae481689-b14b-4d6a-a560-fd3e8c25f70f"],
     Cell[BoxData[
     ""], "ObjectNameTranslation",ExpressionUUID->
      "beaa70a7-41de-4fc2-8bdf-99851df0868b"]
    }],ExpressionUUID->"4f2fffba-50b9-4edb-a0fb-fedbbdc10c17"], Cell[BoxData[
     TooltipBox[
      StyleBox[
       TagBox[
        StyleBox[
         GraphicsBox[InsetBox[
           StyleBox["\<\"NEW IN 14.3\"\>",
            StripOnInput->False,
            FontFamily->"Source Sans Pro",
            FontSize->18,
            FontWeight->"Bold",
            FontSlant->"Italic",
            FontColor->LightDarkSwitched[
              RGBColor[0.968627, 0.466667, 0]]], {Right, Center}, {
           Right, Center}],
          ImageSize->{125, 24},
          PlotRangePadding->Scaled[0.025]], "NewInGraphic",
         StripOnInput->False],
        Deploy,
        DefaultBaseStyle->"Deploy"], "NewInGraphic",
       StripOnInput->False],
      "New in 14",
      TooltipDelay->0.3]],
     Magnification->1,ExpressionUUID->
     "b8ecb585-f177-40b3-8a9a-17035cf223a6"]}
  }]], "ObjectNameGrid",
 CacheGraphics->False,ExpressionUUID->"b89ca427-b55a-4da5-94c8-614e6aab9447"],

Cell[BoxData[GridBox[{
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["WickUnitary"]], "paclet:QuantumMob/Q3/ref/WickUnitary", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       StyleBox["u", "TI"], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "37dccc0b-2827-44a4-83ee-0e2f15675b59"],
     " \[LineSeparator]represents the Gaussian unitary gate corresponding to \
the canonical transformation of the fermion modes characterized by the \
unitary matrix ",
     Cell[BoxData[
      StyleBox["u", "TI"]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "0dc6058a-ca00-4f75-b9c8-f79bba05d747"],
     "."
    }],ExpressionUUID->"fba983af-a69c-42a2-8a40-85da5431ede3"]},
   {"", Cell[TextData[{
     Cell[BoxData[
      RowBox[{
       TemplateBox[{
         Cell[
          TextData["WickUnitary"]], "paclet:QuantumMob/Q3/ref/WickUnitary", 
         "QuantumMob Package Symbol"},
        "PackageLink",
        BaseStyle->"InlineFormula"], "[", 
       RowBox[{
        StyleBox["u", "TI"], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox[
           StyleBox["k", "TI"], 
           StyleBox["1", "TR"]], ",", 
          SubscriptBox[
           StyleBox["k", "TI"], 
           StyleBox["2", "TR"]], ",", 
          StyleBox["\[Ellipsis]", "TR"]}], "}"}]}], "]"}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "546d76e7-5875-4449-bfe8-a4efa33435ae"],
     "\[LineSeparator]assumes that the unitary gate operates on fermion modes \
",
     Cell[BoxData[
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox[
          StyleBox["k", "TI"], 
          StyleBox["1", "TR"]], ",", 
         SubscriptBox[
          StyleBox["k", "TI"], 
          StyleBox["2", "TR"]], ",", 
         StyleBox["\[Ellipsis]", "TR"]}], "}"}], "\[Subset]", 
       RowBox[{"[", 
        StyleBox["n", "TI"], "]"}]}]], "InlineFormula",
      FontFamily->"Source Sans Pro",ExpressionUUID->
      "65f8b582-7ffa-4f87-a39e-3def1692006f"],
     "."
    }],ExpressionUUID->"d7cca711-75f7-47b9-aebb-4da102043157"]}
  }]], "Usage",
 CellID->2009445904,ExpressionUUID->"a06e39c3-7d9c-4199-b0ce-5d217848c44f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 ButtonBox[Cell[TextData[{
   Cell[BoxData[
    DynamicBox[ToBoxes[
      If[CurrentValue[
         EvaluationCell[], "CellGroupOpen"] =!= Closed, 
       Style[
        Graphics[{
          Thickness[0.18], 
          RGBColor[0.8509803921568627, 0.396078431372549, 0], 
          Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
         PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
        0.68 Inherited], 
       Rotate[
        Style[
         Graphics[{
           Thickness[0.18], 
           RGBColor[0.8509803921568627, 0.396078431372549, 0], 
           Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
          PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
         0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
     ImageSizeCache->{
      13.600000000000003`, {-0.1685058593749993, 13.768505859375}}]],
    ExpressionUUID->"78becabc-0383-4b71-b0c2-80ba93428eef"],
   Cell[BoxData[
    TemplateBox[{1},
     "Spacer1"]],ExpressionUUID->"31b6b7ca-65f4-4215-bc00-b354ed68a97a"],
   "Details and Options"
  }], "NotesFrameText",ExpressionUUID->"c5555bd1-b362-4193-9f1b-7290299ceaed"],
  Appearance->{Automatic, None, "Normal", Automatic},
  BaseStyle->None,
  ButtonFunction:>(FrontEndExecute[{
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], All, ButtonCell], 
     FrontEndToken["OpenCloseGroup"], 
     FrontEnd`SelectionMove[
      FrontEnd`SelectedNotebook[], After, CellContents]}]& ),
  Evaluator->None,
  Method->
   "Preemptive"]],ExpressionUUID->"b68a25ae-b861-4bfc-bdbd-557e9100de08"]], \
"NotesSection",
 ShowGroupOpener->"Thumbnail",
 WholeCellGroupOpener->True,
 CellGroupingRules->{"SectionGrouping", 50},
 CacheGraphics->False,
 CellID->1533885409,ExpressionUUID->"b2261f19-3cc1-4004-9c75-d095d584ec01"],

Cell[TextData[{
 "A Wick unitary gate represents the unitary operator ",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{"exp", "(", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "H"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"66736c54-843a-46c8-b7c3-2d11034e62c2"],
 " for a quadratic Hamiltonian\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", "=", 
    RowBox[{
     SubscriptBox["\[CapitalSigma]", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]], 
     SubsuperscriptBox["a", "i", "\[Dagger]"], 
     SubscriptBox["h", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]], 
     SubscriptBox["a", "j"]}]}], TraditionalForm]],ExpressionUUID->
  "5ec9c51a-892e-42f5-be4f-4219d6dfa4d1"],
 " ,\[LineSeparator]where ",
 Cell[BoxData[
  FormBox["h", TraditionalForm]],ExpressionUUID->
  "09335d9b-903f-4ef9-b662-7839ee057540"],
 " is an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "2503c7e2-9075-4d59-a62e-e21f7d97c9dc"],
 " Hermitian matrix and ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],ExpressionUUID->
  "61d2e2b4-54d7-45f6-b326-f1b3d1c5784d"],
 " is the number of fermion modes."
}], "Notes",
 CellID->1429475806,ExpressionUUID->"61ec228a-2700-4372-82d9-6cd11043e70a"],

Cell[TextData[{
 "Note that the unitary gate corresponds to the canonical transform\
\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"U", " ", 
     SubsuperscriptBox["a", "j", "\[Dagger]"], 
     SuperscriptBox["U", "\[Dagger]"]}], "=", 
    RowBox[{
     SubsuperscriptBox["\[CapitalSigma]", 
      RowBox[{"i", "=", "1"}], "n"], 
     SubsuperscriptBox["a", "i", "\[Dagger]"], 
     SubscriptBox["u", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"d3b40593-f963-4276-bd6c-17b3bb5c2840"],
 " ,\nwhere the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "571e5e8f-9d2b-4092-8bd6-aee8767c81bd"],
 " unitary matrix ",
 Cell[BoxData[
  FormBox["u", TraditionalForm]],ExpressionUUID->
  "fc7dd872-50f7-4a1a-a0e4-dc261585cf42"],
 " is given by\[LineSeparator]\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{"exp", "(", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "h"}], ")"}]}], TraditionalForm]],
  ExpressionUUID->"d457a108-9c63-4631-a96c-b4d1f6c6a6da"],
 " ."
}], "Notes",
 CellID->2063552999,ExpressionUUID->"d0d57c33-13b3-4d99-ba4d-a0f7bb159b3a"]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "PrimaryExamplesSection"}, Open], 
      Alternatives[True, Open]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.251494140625001, 9.348505859375003}}]],
  ExpressionUUID->"66f8ae0c-1601-47de-8cca-79f9b89e2e93"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"f2111fe0-156d-4b13-9203-9523a7a0048d"],
 "Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(3)", "ExampleCount",ExpressionUUID->
  "4d41b8eb-8347-4407-91bb-666b8aa83f6f"]
}], "PrimaryExamplesSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellTags->"PrimaryExamplesSection",
 CellID->1618370475,ExpressionUUID->"8f67b8fe-c523-4972-9f29-4b0b9f9f57ae"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<QuantumMob`Q3`\>\"", "]"}]], "Input", "ExampleInitialization",
 CellLabel->"In[1]:=",
 CellID->1691119094,ExpressionUUID->"ebe98923-ffd2-43de-839a-8952a8a8324a"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]],
   ImageSizeCache->{
    13.600000000000001`, {4.551318359375001, 9.048681640625002}}]],
  ExpressionUUID->"3948381b-22f5-4489-b59c-0f0f99fd793c"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"8ed11e26-2150-4a05-a4b6-a7f3edcbdb34"],
 "Basic Examples",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "556dd073-7568-4d0b-b608-572fa493d379"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->2072184070,ExpressionUUID->"4dd392d1-c7fa-4d1a-a0ef-e26b37b0de4e"],

Cell["Set the number of qubits in the quantum register:", "ExampleText",
 CellID->1050157890,ExpressionUUID->"001162aa-cd27-4825-a996-57ce45ef9de9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "3"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->259003905,ExpressionUUID->"4c59eb94-6d79-4cb1-bd5f-bba683e1ae27"],

Cell["Consider a Gaussian unitary gate:", "ExampleText",
 CellID->684313274,ExpressionUUID->"36ca58ec-2cd5-4663-8483-82dd23da8af4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SeedRandom", "[", "450", "]"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1192065336,ExpressionUUID->"297b03c5-716e-4d9d-93a9-3b14db03efc1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"op", "=", 
  RowBox[{"RandomWickUnitary", "[", "$n", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1683933745,ExpressionUUID->"9e2407aa-1e7d-4da2-a230-8a3916c8cf78"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickUnitary",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox[
                 "\"Transformation matrix: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"0.28201272093280627`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.13564820334796523`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.33153031107436176`"}], "-", 
                    RowBox[{"0.5451154381155197`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.12197590486195668`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.6929120295973457`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.4564833351096839`"}], "-", 
                    RowBox[{"0.8260163295494393`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.10903789647652794`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.17282915728286277`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.2595459983555249`"}], "-", 
                    
                    RowBox[{
                    "0.014024348374001495`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.05253033547414482`"}], "+", 
                    RowBox[{"0.0928920992352428`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.09613933030567363`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.736162251586094`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.35741810368417487`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.5564946445578075`", " ", "\[ImaginaryI]"}]}]}},
                     RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`WickUnitary[{{Complex[
    0.28201272093280627`, -0.13564820334796523`], 
    Complex[-0.33153031107436176`, -0.5451154381155197], Complex[
    0.12197590486195668`, 0.6929120295973457]}, {
    Complex[-0.4564833351096839, -0.8260163295494393], Complex[
    0.10903789647652794`, -0.17282915728286277`], 
    Complex[-0.2595459983555249, -0.014024348374001495`]}, {
    Complex[-0.05253033547414482, 0.0928920992352428], Complex[
    0.09613933030567363, -0.736162251586094], Complex[
    0.35741810368417487`, -0.5564946445578075]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->1511185819,ExpressionUUID->"ba1c7c7a-88ec-4110-959a-418532f72e1d"]
}, Open  ]],

Cell["Get the matrix representation of it:", "ExampleText",
 CellID->811715240,ExpressionUUID->"8af8b57d-1a52-4e8f-9164-c2edb3e2eccb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"Matrix", "[", "op", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mat", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->422922265,ExpressionUUID->"3ec446ed-a09d-42c3-aac7-f138f1513a39"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", 
      RowBox[{"0.35741810368417526`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5564946445578078`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.09613933030567337`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.7361622515860933`", " ", "\[ImaginaryI]"}]}], 
      "0", "\<\"\[Ellipsis]\"\>"},
     {"0", 
      RowBox[{
       RowBox[{"-", "0.25954599835552533`"}], "-", 
       RowBox[{"0.014024348374001572`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.10903789647652869`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.17282915728286388`", " ", "\[ImaginaryI]"}]}], 
      "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"-", "0.021929607921550326`"}], "-", 
       RowBox[{
       "0.31217095017932606`", " ", 
        "\[ImaginaryI]"}]}], "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[4]//MatrixForm=",
 CellID->210966864,ExpressionUUID->"492bbd46-221d-46ae-bec6-d06143a755a6"]
}, Open  ]],

Cell["Choose an input Wick state:", "ExampleText",
 CellID->593132822,ExpressionUUID->"026bc584-6c5e-4fe6-8eac-b26f07c1dfc4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"RandomWickState", "[", 
   RowBox[{"{", 
    RowBox[{"2", ",", "$n"}], "}"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->632644412,ExpressionUUID->"f312d400-9717-4a2a-a11d-732714042a3c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.36667506278571993`"}], "+", 
                    RowBox[{"0.056190425505484545`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.6870054476680982`"}], "+", 
                    RowBox[{"0.31707862640623385`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.44881856234420275`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.2973862674344191`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.037267447794941594`"}], "+", 
                    RowBox[{"0.8532296951784989`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.24603186154460005`"}], "-", 
                    RowBox[{"0.13189433042642015`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.4381630911263613`"}], "+", 
                    
                    RowBox[{
                    "0.02637307113921189`", " ", "\[ImaginaryI]"}]}]}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {2, 3}, 0, {
                    1, {{0, 3, 6}, {{1}, {2}, {3}, {1}, {2}, {3}}}, {
                    Complex[-0.36667506278571993`, 0.056190425505484545`], 
                    Complex[-0.6870054476680982, 0.31707862640623385`], 
                    Complex[0.44881856234420275`, 0.2973862674344191], 
                    Complex[-0.037267447794941594`, 0.8532296951784989], 
                    Complex[-0.24603186154460005`, -0.13189433042642015`], 
                    Complex[-0.4381630911263613, 0.02637307113921189]}}], 
                    TableHeadings -> None, {}]]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`WickState[
  SparseArray[
   Automatic, {2, 3}, Complex[0., 0.], {
    1, {{0, 3, 6}, {{1}, {2}, {3}, {1}, {2}, {3}}}, {
     Complex[-0.36667506278571993`, 0.056190425505484545`], 
     Complex[-0.6870054476680982, 0.31707862640623385`], Complex[
     0.44881856234420275`, 0.2973862674344191], 
     Complex[-0.037267447794941594`, 0.8532296951784989], 
     Complex[-0.24603186154460005`, -0.13189433042642015`], 
     Complex[-0.4381630911263613, 0.02637307113921189]}}]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[5]=",
 CellID->224582051,ExpressionUUID->"488b02b9-3e88-49a4-a44b-46707caaa67f"]
}, Open  ]],

Cell["Operate the unitary gate on the input state:", "ExampleText",
 CellID->1713534129,ExpressionUUID->"a54e384c-a09e-4bcb-af1a-4dd3d19435f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"op", "[", "in", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[6]:=",
 CellID->1640993928,ExpressionUUID->"47123008-c4e7-47a8-b55f-b72969284281"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["3", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"0.20469708540823828`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.7882286718240967`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.129402924605987`"}], "-", 
                    RowBox[{"0.48358159626721287`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.2800663343009041`"}], "-", 
                    
                    RowBox[{
                    "0.08809787390237123`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.007955435508994912`"}], "+", 
                    RowBox[{"0.45200292396337155`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.5784476910929259`"}], "-", 
                    RowBox[{"0.49016159386443076`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.01662563607898565`"}], "-", 
                    
                    RowBox[{
                    "0.46956739300012884`", " ", "\[ImaginaryI]"}]}]}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {2, 3}, 0, {
                    1, {{0, 3, 6}, {{1}, {2}, {3}, {1}, {2}, {3}}}, {Complex[
                    0.20469708540823828`, -0.7882286718240967], 
                    Complex[-0.129402924605987, -0.48358159626721287`], 
                    Complex[-0.2800663343009041, -0.08809787390237123], 
                    Complex[-0.007955435508994912, 0.45200292396337155`], 
                    Complex[-0.5784476910929259, -0.49016159386443076`], 
                    Complex[-0.01662563607898565, -0.46956739300012884`]}}], 
                    TableHeadings -> None, {}]]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`WickState[
  SparseArray[
   Automatic, {2, 3}, Complex[0., 0.], {
    1, {{0, 3, 6}, {{1}, {2}, {3}, {1}, {2}, {3}}}, {Complex[
     0.20469708540823828`, -0.7882286718240967], 
     Complex[-0.129402924605987, -0.48358159626721287`], 
     Complex[-0.2800663343009041, -0.08809787390237123], 
     Complex[-0.007955435508994912, 0.45200292396337155`], 
     Complex[-0.5784476910929259, -0.49016159386443076`], 
     Complex[-0.01662563607898565, -0.46956739300012884`]}}]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[6]=",
 CellID->1421763378,ExpressionUUID->"acd71738-38d9-4f1b-8c6a-c3a3ecc4d7e5"]
}, Open  ]],

Cell["Check the self-consistency:", "ExampleText",
 CellID->1813500599,ExpressionUUID->"66f7cb03-2cc9-4d06-8efb-f9ff5bc67248"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fidelity", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Matrix", "[", "out", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Matrix", "[", "op", "]"}], ".", 
    RowBox[{"Matrix", "[", "in", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[7]:=",
 CellID->1386171055,ExpressionUUID->"83e0441c-b6f0-4e25-b4d2-cf30d1cbd1fe"],

Cell[BoxData["0.9999999999999978`"], "Output",
 CellLabel->"Out[7]=",
 CellID->526553877,ExpressionUUID->"869a3c6c-b52d-46f5-8f18-750518dba621"]
}, Open  ]],

Cell["\<\
Let us further verify the above result by a conventional method:\
\>", "ExampleText",
 CellID->1312240680,ExpressionUUID->"2f6c3ffb-91ec-45c5-ac64-9188736b5788"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Let", "[", 
  RowBox[{"Fermion", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cc", "=", 
  RowBox[{"c", "[", 
   RowBox[{"Range", "@", "$n"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[8]:=",
 CellID->1208559217,ExpressionUUID->"29dd2111-f0e4-4339-8e45-b8a770f55e45"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "1"},
      "RowWithSeparators"]],
    $CellContext`c[1]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "2"},
      "RowWithSeparators"]],
    $CellContext`c[2]], ",", 
   InterpretationBox[
    SubscriptBox["c", 
     TemplateBox[{",", "\",\"", "3"},
      "RowWithSeparators"]],
    $CellContext`c[3]]}], "}"}]], "Output",
 CellLabel->"Out[8]=",
 CellID->772923898,ExpressionUUID->"ede323de-c859-48ef-bafa-385868a6af43"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ham", "=", 
   RowBox[{"MatrixLog", "[", 
    RowBox[{"First", "@", "op"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ham", "=", 
  RowBox[{"MultiplyDot", "[", 
   RowBox[{
    RowBox[{"Dagger", "@", "cc"}], ",", 
    RowBox[{"ham", ".", "cc"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{"Matrix", "[", 
     RowBox[{"ham", ",", "cc"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"new", "//", "ArrayShort"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[9]:=",
 CellID->524451751,ExpressionUUID->"752acf9c-e260-4c3f-b9bd-f6417a52a946"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "7.801230899594627`*^-16"}], "-", 
     RowBox[{"0.48910983457253454`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`c[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     QuantumMob`Q3`Dagger[
      $CellContext`c[1]], 
     $CellContext`c[1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.06542148200047562`", "\[VeryThinSpace]", "+", 
     RowBox[{"1.1732124017864958`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
         $CellContext`c[2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     QuantumMob`Q3`Dagger[
      $CellContext`c[1]], 
     $CellContext`c[2]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.19285956259600717`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.4856449199840883`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[1]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`c[3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     QuantumMob`Q3`Dagger[
      $CellContext`c[1]], 
     $CellContext`c[3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.06542148200047637`", "\[VeryThinSpace]", "-", 
     RowBox[{"1.1732124017864958`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`c[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     QuantumMob`Q3`Dagger[
      $CellContext`c[2]], 
     $CellContext`c[1]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"8.658032404067742`*^-16", "+", 
     RowBox[{"0.7008891529010332`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
         $CellContext`c[2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     QuantumMob`Q3`Dagger[
      $CellContext`c[2]], 
     $CellContext`c[2]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.5573036141307518`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.5110803822494383`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[2]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`c[3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     QuantumMob`Q3`Dagger[
      $CellContext`c[2]], 
     $CellContext`c[3]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.19285956259600717`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.4856449199840881`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[3]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "1"}, "RowWithSeparators"]], 
         $CellContext`c[1]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     QuantumMob`Q3`Dagger[
      $CellContext`c[3]], 
     $CellContext`c[1]]]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"0.5573036141307522`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.511080382249438`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[3]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "2"}, "RowWithSeparators"]], 
         $CellContext`c[2]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     QuantumMob`Q3`Dagger[
      $CellContext`c[3]], 
     $CellContext`c[2]]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"4.0272768082354693`*^-16", "+", 
     RowBox[{"0.8992634837221289`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
   InterpretationBox[
    TemplateBox[{
      TemplateBox[{"\[VeryThinSpace]", "\"\[VeryThinSpace]\"", 
        InterpretationBox[
         TemplateBox[{"c", 
           TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"], 
           TemplateBox[{",", "\",\"", "\"\[Dagger]\""}, "RowWithSeparators"]},
           "Subsuperscript", SyntaxForm -> SubsuperscriptBox], 
         QuantumMob`Q3`Dagger[
          $CellContext`c[3]]], 
        InterpretationBox[
         SubscriptBox["c", 
          TemplateBox[{",", "\",\"", "3"}, "RowWithSeparators"]], 
         $CellContext`c[3]]}, "RowWithSeparators"]},
     "RowDefault"],
    QuantumMob`Q3`Multiply[
     QuantumMob`Q3`Dagger[
      $CellContext`c[3]], 
     $CellContext`c[3]]]}]}]], "Output",
 CellLabel->"Out[9]=",
 CellID->1862523877,ExpressionUUID->"572b2799-5aa2-40e4-b501-b5fced2d164e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", 
      RowBox[{"0.35741810368417526`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5564946445578078`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.0961393303056734`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.7361622515860934`", " ", "\[ImaginaryI]"}]}], 
      "0", "\<\"\[Ellipsis]\"\>"},
     {"0", 
      RowBox[{
       RowBox[{"-", "0.25954599835552533`"}], "-", 
       RowBox[{"0.014024348374001655`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1090378964765285`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.1728291572828638`", " ", "\[ImaginaryI]"}]}], 
      "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"-", "0.021929607921550326`"}], "-", 
       RowBox[{
       "0.31217095017932606`", " ", 
        "\[ImaginaryI]"}]}], "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {5, 5}, 0, {
     1, {{0, 2, 5, 8, 10, 15}, {{1}, {5}, {2}, {3}, {5}, {2}, {3}, {5}, {4}, {
       5}, {1}, {2}, {3}, {4}, {5}}}, {
      1, "\[Ellipsis]", Complex[0.35741810368417526`, -0.5564946445578078], 
       Complex[0.0961393303056734, -0.7361622515860934], "\[Ellipsis]", 
       Complex[-0.25954599835552533`, -0.014024348374001655`], Complex[
       0.1090378964765285, -0.1728291572828638], "\[Ellipsis]", 
       Complex[-0.021929607921550326`, -0.31217095017932606`], "\[Ellipsis]", 
       "\[Ellipsis]", "\[Ellipsis]", "\[Ellipsis]", "\[Ellipsis]", 
       "\[Ellipsis]"}}], TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[9]//MatrixForm=",
 CellID->1717162067,ExpressionUUID->"5556ed7e-b4e4-422b-aa7b-94dd6c60c979"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"new", "-", "mat"}], "//", "ArrayShort"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"new", "-", "mat"}], "//", "ArrayZeroQ"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[10]:=",
 CellID->622994325,ExpressionUUID->"39264f25-ed8e-4070-9096-89731b86a299"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"0", "0", "0", "0", "\<\"\[Ellipsis]\"\>"},
     {"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>", \
"\<\"\[Ellipsis]\"\>", "\<\"\[Ellipsis]\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]]], "Output",
 CellLabel->"Out[10]//MatrixForm=",
 CellID->1341232880,ExpressionUUID->"bc6caaf4-60be-4cda-8903-d3581d6fe9d3"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[10]=",
 CellID->2112655248,ExpressionUUID->"20dd08e2-2d99-4781-a971-0f841699efb2"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"},
        Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "2d795ae9-d768-4c70-b663-c732eb040882"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"ec96ae19-9ee5-4d75-9185-2fbdf3488afd"],
 "Scope",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(2)", "ExampleCount",ExpressionUUID->
  "bf5fda54-e082-42c7-b18e-e1d4fbfa49bf"]
}], "ExampleSection", "ExampleSection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->1915647073,ExpressionUUID->"d96b2a02-3210-4342-a38d-4308edfb3594"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "6fd9a0db-04be-42fd-aef4-bd0329aca0d2"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"f401c567-3f1b-4b0e-9163-e739acdc1d49"],
 "Partial Modes",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "4ff460b3-20d6-415b-b1eb-65ffb7eb17df"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->2094670095,ExpressionUUID->"440ae985-15b6-401d-bbb2-4d8bb5fd8a43"],

Cell["Set the number of fermion modes:", "ExampleText",
 CellID->2067795335,ExpressionUUID->"0c83eabe-c06c-49a6-b33a-e2b097d9001d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$n", "=", "4"}], ";"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->200148117,ExpressionUUID->"b1460b90-e738-4496-b1fe-dcaaf1b85d4b"],

Cell["\<\
Construct a unitary gate acting only on some of fermion modes:\
\>", "ExampleText",
 CellID->46280482,ExpressionUUID->"9904bc30-8573-4601-b4cf-5c66a79fa05a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"kk", "=", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uu", "=", 
   RowBox[{"RandomUnitary", "[", 
    RowBox[{"$n", "/", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"uu", "=", 
  RowBox[{"WickUnitary", "[", 
   RowBox[{"uu", ",", "kk"}], "]"}]}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->930011217,ExpressionUUID->"71e7c652-28c0-483f-9c7a-be98a697a1da"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "3"}], "}"}]], "Output",
 CellLabel->"Out[2]=",
 CellID->344162351,ExpressionUUID->"7f1c3d74-597e-4b6b-bb80-240f4efd6150"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickUnitary",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"0.17124419417319015`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.9607087605626662`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.18384559091787978`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{
                    "0.11796144302345682`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.07051549676531514`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.20674058154136427`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.8917705070787513`"}], "+", 
                    RowBox[{"0.3962716989192972`", " ", "\[ImaginaryI]"}]}]}},
                     RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`WickUnitary[{{Complex[
    0.17124419417319015`, -0.9607087605626662], Complex[
    0.18384559091787978`, -0.11796144302345682`]}, {Complex[
    0.07051549676531514, -0.20674058154136427`], Complex[-0.8917705070787513, 
    0.3962716989192972]}}, {2, 3}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[2]=",
 CellID->1163171886,ExpressionUUID->"5c8303a7-9a67-4fec-9b9e-5190ae12c5cf"]
}, Open  ]],

Cell["Pick an initial state:", "ExampleText",
 CellID->729548796,ExpressionUUID->"3a474741-c728-43bb-91f6-9257f1175e1a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"in", "=", 
  RowBox[{"WickState", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", "$n"}], "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->928817187,ExpressionUUID->"c17d2622-4a71-40b4-b3d8-4e854a11042a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"1", "0", "0", "0"}, {"0", "0", "1", "0"}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {2, 4}, 0, {
                    1, {{0, 1, 2}, {{1}, {3}}}, {1, 1}}], TableHeadings -> 
                    None, {}]]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`WickState[
  SparseArray[Automatic, {2, 4}, 0, {1, {{0, 1, 2}, {{1}, {3}}}, {1, 1}}]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->998152496,ExpressionUUID->"0883751f-1a8f-485c-9fb9-7a8463ddfdd1"]
}, Open  ]],

Cell["Operate the unitary gate on the input state:", "ExampleText",
 CellID->1739421571,ExpressionUUID->"f6e0bf30-f206-44ee-8d7b-8b1b783b8da5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"uu", "[", "in", "]"}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[4]:=",
 CellID->788851537,ExpressionUUID->"df69a9f6-b35b-48de-9358-48ab668819e0"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickState",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Particles: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{"1", "0", "0", "0"}, {"0", 
                    RowBox[{
                    RowBox[{"0.18384559091787978`", "\[VeryThinSpace]"}], "+", 
                    RowBox[{"0.11796144302345682`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"-", "0.8917705070787513`"}], "-", 
                    RowBox[{"0.3962716989192972`", " ", "\[ImaginaryI]"}]}], 
                    "0"}}, RowSpacings -> 1, ColumnSpacings -> 1, 
                    RowAlignments -> Baseline, ColumnAlignments -> Center], 
                    "\[NoBreak]", ")"}], 
                   Function[BoxForm`e$, 
                    MatrixForm[
                    SparseArray[
                    Automatic, {2, 4}, 0, {
                    1, {{0, 1, 3}, {{1}, {2}, {3}}}, {
                    1, Complex[0.18384559091787978`, 0.11796144302345682`], 
                    Complex[-0.8917705070787513, -0.3962716989192972]}}], 
                    TableHeadings -> None, {}]]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`WickState[
  SparseArray[
   Automatic, {2, 4}, 0, {
    1, {{0, 1, 3}, {{1}, {2}, {3}}}, {
     1, Complex[0.18384559091787978`, 0.11796144302345682`], 
      Complex[-0.8917705070787513, -0.3962716989192972]}}]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",
 CellID->1861086955,ExpressionUUID->"5e6a8398-15f4-4b72-a433-1da6d59d9c56"]
}, Open  ]],

Cell["Check the self-consistency:", "ExampleText",
 CellID->1189134130,ExpressionUUID->"497ad324-62aa-4d75-a195-2fc9afa809d6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fidelity", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Matrix", "[", "out", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Matrix", "[", 
     RowBox[{"uu", ",", "$n"}], "]"}], ".", 
    RowBox[{"Matrix", "[", "in", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[5]:=",
 CellID->1672744108,ExpressionUUID->"caf628ea-6cd7-47c0-9af1-aa69785f0dca"],

Cell[BoxData["1.`"], "Output",
 CellLabel->"Out[5]=",
 CellID->1987259850,ExpressionUUID->"b9d47a62-3127-4263-91ec-766350e85a13"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, 
  Closed]]]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  DynamicBox[ToBoxes[
    If[
     MatchQ[
      CurrentValue[
       EvaluationNotebook[], {
       TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed], 
      Alternatives[Open, True]], 
     Style[
      Graphics[{
        Thickness[0.18], 
        RGBColor[0.8509803921568627, 0.396078431372549, 0], 
        Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
       PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
      0.68 Inherited], 
     Rotate[
      Style[
       Graphics[{
         Thickness[0.18], 
         RGBColor[0.8509803921568627, 0.396078431372549, 0], 
         Line[{{-1.8, 0.5}, {0, 0}, {1.8, 0.5}}]}, AspectRatio -> 1, 
        PlotRange -> {{-3, 4}, {-1, 1}}, ImageSize -> 20], Magnification -> 
       0.68 Inherited], Rational[1, 2] Pi, {-1.65, -1}]]]]],ExpressionUUID->
  "f9e51557-8151-400b-83b7-45ea4a4ce726"],
 Cell[BoxData[
  TemplateBox[{1},
   "Spacer1"]],ExpressionUUID->"de7fbf86-5719-4e3a-b036-9eae77c0caf7"],
 "Quantum Circuit",
 "\[NonBreakingSpace]\[NonBreakingSpace]",
 Cell["(1)", "ExampleCount",ExpressionUUID->
  "6de61eaf-95d5-4d14-b35e-a699b1f723f8"]
}], "ExampleSubsection", "ExampleSubsection",
 WholeCellGroupOpener->True,
 CacheGraphics->False,
 CellID->958378569,ExpressionUUID->"445b3f1c-8730-42c2-81fc-7660778ae48a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"qc", "=", 
  RowBox[{"WickCircuit", "@", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RandomWickUnitary", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"\"\<Label\>\"", "->", 
          RowBox[{"Subscript", "[", 
           RowBox[{"\"\<U\>\"", ",", "1"}], "]"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"RandomWickUnitary", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "4"}], "}"}], ",", 
         RowBox[{"\"\<Label\>\"", "->", 
          RowBox[{"Subscript", "[", 
           RowBox[{"\"\<U\>\"", ",", "2"}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"RandomWickUnitary", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], ",", 
        RowBox[{"\"\<Label\>\"", "->", 
         RowBox[{"Subscript", "[", 
          RowBox[{"\"\<U\>\"", ",", "3"}], "]"}]}]}], "]"}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
    "}"}]}]}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[1]:=",
 CellID->291676705,ExpressionUUID->"a0ace05c-f032-4ea7-9a61-f34085352b41"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickCircuit",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Fermion modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Circuit depth: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Fermion modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Circuit depth: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Some elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    TagBox["WickUnitary", "SummaryHead"], "[", 
                    
                    DynamicModuleBox[{
                    Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
                    TemplateBox[{
                    PaneSelectorBox[{False -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxOpener"]], 
                    ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 2\"", 
                    QuantumMob`Q3`Private`AtLeast[2]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "SummaryItem"]}]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}, 
                    "Rows" -> {{Automatic}}}, AutoDelete -> False, 
                    GridBoxItemSize -> {"Columns" -> {{Automatic}}, 
                    "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{2}}, 
                    "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}], True -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxCloser"]], 
                    ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 2\"", 
                    QuantumMob`Q3`Private`AtLeast[2]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.8365599309873879`"}], "+", 
                    RowBox[{"0.5200785464800819`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.14950942281752816`"}], "+", 
                    
                    RowBox[{"0.08563130179036078`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.13953645141161397`"}], "-", 
                    RowBox[{"0.10107109421093918`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.7763962068817628`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.606236870028596`", " ", "\[ImaginaryI]"}]}]}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], 
                    "SummaryItem"]}]}}, GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                    AutoDelete -> False, 
                    GridBoxItemSize -> {"Columns" -> {{Automatic}}, 
                    "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{2}}, 
                    "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}]}, 
                    Dynamic[Typeset`open$$], ImageSize -> Automatic]}, 
                    "SummaryPanel"], DynamicModuleValues :> {}], "]"}], 
                    
                    QuantumMob`Q3`WickUnitary[{{Complex[-0.8365599309873879, 
                    0.5200785464800819], Complex[-0.14950942281752816`, 
                    0.08563130179036078]}, {
                    Complex[-0.13953645141161397`, -0.10107109421093918`], 
                    Complex[0.7763962068817628, 0.606236870028596]}}, {1, 2}, 
                    "Label" -> Subscript["U", 1]], Selectable -> False, 
                    Editable -> False, SelectWithContents -> True], ",", 
                    InterpretationBox[
                    RowBox[{
                    TagBox["WickUnitary", "SummaryHead"], "[", 
                    
                    DynamicModuleBox[{
                    Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
                    TemplateBox[{
                    PaneSelectorBox[{False -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxOpener"]], 
                    ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 4\"", 
                    QuantumMob`Q3`Private`AtLeast[4]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}, 
                    "Rows" -> {{Automatic}}}, AutoDelete -> False, 
                    GridBoxItemSize -> {"Columns" -> {{Automatic}}, 
                    "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{2}}, 
                    "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}], True -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxCloser"]], 
                    ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 4\"", 
                    QuantumMob`Q3`Private`AtLeast[4]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.42467560233165114`"}], "-", 
                    RowBox[{"0.7865614131135286`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.1880663380541057`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.40694327451871876`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.17732558080543923`"}], "+", 
                    RowBox[{"0.4117370697145353`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.8690740862218694`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.20913741050449197`", " ", 
                    "\[ImaginaryI]"}]}]}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], 
                    "SummaryItem"]}]}}, GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                    AutoDelete -> False, 
                    GridBoxItemSize -> {"Columns" -> {{Automatic}}, 
                    "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{2}}, 
                    "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}]}, 
                    Dynamic[Typeset`open$$], ImageSize -> Automatic]}, 
                    "SummaryPanel"], DynamicModuleValues :> {}], "]"}], 
                    
                    QuantumMob`Q3`WickUnitary[{{
                    Complex[-0.42467560233165114`, -0.7865614131135286], 
                    Complex[0.1880663380541057, -0.40694327451871876`]}, {
                    Complex[-0.17732558080543923`, 0.4117370697145353], 
                    Complex[0.8690740862218694, -0.20913741050449197`]}}, {3, 
                    4}, "Label" -> Subscript["U", 2]], Selectable -> False, 
                    Editable -> False, SelectWithContents -> True]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    InterpretationBox[
                    RowBox[{
                    TagBox["WickUnitary", "SummaryHead"], "[", 
                    
                    DynamicModuleBox[{
                    Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
                    TemplateBox[{
                    PaneSelectorBox[{False -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxOpener"]], 
                    ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 3\"", 
                    QuantumMob`Q3`Private`AtLeast[3]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                    AutoDelete -> False, 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}], True -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxCloser"]], 
                    ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 3\"", 
                    QuantumMob`Q3`Private`AtLeast[3]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.8843394033034941`"}], "-", 
                    RowBox[{"0.1714712587471254`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.011739031976241952`"}], "-", 
                    
                    RowBox[{"0.43405486095280305`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.1319516325954833`"}], "+", 
                    RowBox[{"0.4136788535130639`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"0.8971471171513717`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.08115185147910532`", " ", 
                    "\[ImaginaryI]"}]}]}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], 
                    "SummaryItem"]}]}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                    AutoDelete -> False, 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}]}, 
                    Dynamic[Typeset`open$$], ImageSize -> Automatic]}, 
                    "SummaryPanel"], DynamicModuleValues :> {}], "]"}], 
                    
                    QuantumMob`Q3`WickUnitary[{{
                    Complex[-0.8843394033034941, -0.1714712587471254], 
                    Complex[-0.011739031976241952`, -0.43405486095280305`]}, {
                    Complex[-0.1319516325954833, 0.4136788535130639], Complex[
                    0.8971471171513717, 0.08115185147910532]}}, {2, 3}, 
                    "Label" -> Subscript["U", 3]], Selectable -> False, 
                    Editable -> False, SelectWithContents -> True], "}"}]}], 
                    "}"}], Short], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`WickCircuit[{{
     QuantumMob`Q3`WickUnitary[{{Complex[-0.8365599309873879, 
       0.5200785464800819], Complex[-0.14950942281752816`, 
       0.08563130179036078]}, {
       Complex[-0.13953645141161397`, -0.10107109421093918`], Complex[
       0.7763962068817628, 0.606236870028596]}}, {1, 2}, "Label" -> 
      Subscript["U", 1]], 
     QuantumMob`Q3`WickUnitary[{{
       Complex[-0.42467560233165114`, -0.7865614131135286], Complex[
       0.1880663380541057, -0.40694327451871876`]}, {
       Complex[-0.17732558080543923`, 0.4117370697145353], Complex[
       0.8690740862218694, -0.20913741050449197`]}}, {3, 4}, "Label" -> 
      Subscript["U", 2]]}, {
     QuantumMob`Q3`WickUnitary[{{
       Complex[-0.8843394033034941, -0.1714712587471254], 
       Complex[-0.011739031976241952`, -0.43405486095280305`]}, {
       Complex[-0.1319516325954833, 0.4136788535130639], Complex[
       0.8971471171513717, 0.08115185147910532]}}, {2, 3}, "Label" -> 
      Subscript["U", 3]]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[1]=",
 CellID->959821135,ExpressionUUID->"87b38b13-d1a0-4b85-9ab6-446ca97f9f0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", "qc", "]"}]], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[2]:=",
 CellID->1966620161,ExpressionUUID->"aeed1be8-bb2d-478d-83b2-bce8e708dc94"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}, {{
     0, -4}, {3, -4}}}], {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -2.4}, {1.4, -0.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "1"],
        StripOnInput->False,
        FontSize->Scaled[0.13333333333333333`],
        FontWeight->"Light",
        FontSlant->Italic], {1., -1.5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{0.6, -4.4}, {1.4, -2.6}]}, InsetBox[
       StyleBox[
        SubscriptBox["\<\"U\"\>", "2"],
        StripOnInput->False,
        FontSize->Scaled[0.13333333333333333`],
        FontWeight->"Light",
        FontSlant->Italic], {1., -3.5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}, {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{1.6, -3.4}, {2.4, -1.6}]}, InsetBox[
      StyleBox[
       SubscriptBox["\<\"U\"\>", "3"],
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {2., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->154.79999999999998`,
   PlotRange->{{0, 3}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{
    QuantumMob`Q3`Gate[{
      QuantumMob`Q3`Private`c$32532[1], 
      QuantumMob`Q3`Private`c$32532[2]}, "Label" -> Subscript["U", 1], 
     "Label" -> "U"], 
    QuantumMob`Q3`Gate[{
      QuantumMob`Q3`Private`c$32532[3], 
      QuantumMob`Q3`Private`c$32532[4]}, "Label" -> Subscript["U", 2], 
     "Label" -> "U"]}, {
    QuantumMob`Q3`Gate[{
      QuantumMob`Q3`Private`c$32532[2], 
      QuantumMob`Q3`Private`c$32532[3]}, "Label" -> Subscript["U", 3], 
     "Label" -> "U"]}, "PostMeasurementDashes" -> False]]], "Output",
 CellLabel->"Out[2]=",
 CellID->1964143328,ExpressionUUID->"230c1241-f5df-498b-b5b3-577d2ef3d65c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dag", "=", 
  RowBox[{"Reverse", "/@", 
   RowBox[{"Map", "[", 
    RowBox[{"Dagger", ",", "qc", ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "dag", "]"}]}], "Input",
 CellProlog:>Needs["QuantumMob`Q3`"],
 CellLabel->"In[3]:=",
 CellID->1590852805,ExpressionUUID->"05eef405-edc7-4a3c-b8dd-d53bde4e3909"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["WickCircuit",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Fermion modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Circuit depth: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Fermion modes: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["4", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Circuit depth: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Some elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    InterpretationBox[
                    RowBox[{
                    TagBox["WickUnitary", "SummaryHead"], "[", 
                    
                    DynamicModuleBox[{
                    Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
                    TemplateBox[{
                    PaneSelectorBox[{False -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxOpener"]], 
                    ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 3\"", 
                    QuantumMob`Q3`Private`AtLeast[3]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                    AutoDelete -> False, 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}], True -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxCloser"]], 
                    ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 3\"", 
                    QuantumMob`Q3`Private`AtLeast[3]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.8843394033034941`"}], "+", 
                    RowBox[{"0.1714712587471254`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.1319516325954833`"}], "-", 
                    RowBox[{"0.4136788535130639`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.011739031976241952`"}], "+", 
                    RowBox[{"0.43405486095280305`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.8971471171513717`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.08115185147910532`", " ", 
                    "\[ImaginaryI]"}]}]}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], 
                    "SummaryItem"]}]}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                    AutoDelete -> False, 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}]}, 
                    Dynamic[Typeset`open$$], ImageSize -> Automatic]}, 
                    "SummaryPanel"], DynamicModuleValues :> {}], "]"}], 
                    
                    QuantumMob`Q3`WickUnitary[{{Complex[-0.8843394033034941, 
                    0.1714712587471254], 
                    Complex[-0.1319516325954833, -0.4136788535130639]}, {
                    Complex[-0.011739031976241952`, 0.43405486095280305`], 
                    Complex[0.8971471171513717, -0.08115185147910532]}}, {2, 
                    3}, {"Label" -> Subsuperscript["U", 3, "\[Dagger]"]}], 
                    Selectable -> False, Editable -> False, 
                    SelectWithContents -> True], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    InterpretationBox[
                    RowBox[{
                    TagBox["WickUnitary", "SummaryHead"], "[", 
                    
                    DynamicModuleBox[{
                    Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
                    TemplateBox[{
                    PaneSelectorBox[{False -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxOpener"]], 
                    ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 2\"", 
                    QuantumMob`Q3`Private`AtLeast[2]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "SummaryItem"]}]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}, 
                    "Rows" -> {{Automatic}}}, AutoDelete -> False, 
                    GridBoxItemSize -> {"Columns" -> {{Automatic}}, 
                    "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{2}}, 
                    "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}], True -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxCloser"]], 
                    ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 2\"", 
                    QuantumMob`Q3`Private`AtLeast[2]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.8365599309873879`"}], "-", 
                    RowBox[{"0.5200785464800819`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.13953645141161397`"}], "+", 
                    
                    RowBox[{"0.10107109421093918`", " ", 
                    "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"-", "0.14950942281752816`"}], "-", 
                    RowBox[{"0.08563130179036078`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.7763962068817628`", "\[VeryThinSpace]"}], "-", 
                    
                    RowBox[{"0.606236870028596`", " ", "\[ImaginaryI]"}]}]}}, 
                    RowSpacings -> 1, ColumnSpacings -> 1, RowAlignments -> 
                    Baseline, ColumnAlignments -> Center], "\[NoBreak]", 
                    ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], 
                    "SummaryItem"]}]}}, GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                    AutoDelete -> False, 
                    GridBoxItemSize -> {"Columns" -> {{Automatic}}, 
                    "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{2}}, 
                    "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}]}, 
                    Dynamic[Typeset`open$$], ImageSize -> Automatic]}, 
                    "SummaryPanel"], DynamicModuleValues :> {}], "]"}], 
                    
                    QuantumMob`Q3`WickUnitary[{{
                    Complex[-0.8365599309873879, -0.5200785464800819], 
                    Complex[-0.13953645141161397`, 0.10107109421093918`]}, {
                    Complex[-0.14950942281752816`, -0.08563130179036078], 
                    Complex[0.7763962068817628, -0.606236870028596]}}, {1, 
                    2}, {"Label" -> Subsuperscript["U", 1, "\[Dagger]"]}], 
                    Selectable -> False, Editable -> False, 
                    SelectWithContents -> True], ",", 
                    InterpretationBox[
                    RowBox[{
                    TagBox["WickUnitary", "SummaryHead"], "[", 
                    
                    DynamicModuleBox[{
                    Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
                    TemplateBox[{
                    PaneSelectorBox[{False -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxOpener"]], 
                    ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 4\"", 
                    QuantumMob`Q3`Private`AtLeast[4]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}, 
                    "Rows" -> {{Automatic}}}, AutoDelete -> False, 
                    GridBoxItemSize -> {"Columns" -> {{Automatic}}, 
                    "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{2}}, 
                    "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}], True -> GridBox[{{
                    PaneBox[
                    ButtonBox[
                    DynamicBox[
                    FEPrivate`FrontEndResource[
                    "FEBitmaps", "SummaryBoxCloser"]], 
                    ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                    None, BaseStyle -> {}, Evaluator -> Automatic, Method -> 
                    "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
                    Dynamic[{Automatic, 3.5 (CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification])}]], 
                    GridBox[{{
                    RowBox[{
                    TagBox["\"Modes: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    InterpretationBox["\"at least 4\"", 
                    QuantumMob`Q3`Private`AtLeast[4]], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Acting on: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                    RowBox[{
                    TagBox["\"Transformation: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    TagBox[
                    RowBox[{"(", "\[NoBreak]", 
                    GridBox[{{
                    RowBox[{
                    RowBox[{"-", "0.42467560233165114`"}], "+", 
                    RowBox[{"0.7865614131135286`", " ", "\[ImaginaryI]"}]}], 
                    RowBox[{
                    RowBox[{"-", "0.17732558080543923`"}], "-", 
                    RowBox[{"0.4117370697145353`", " ", "\[ImaginaryI]"}]}]}, {
                    RowBox[{
                    RowBox[{"0.1880663380541057`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.40694327451871876`", " ", "\[ImaginaryI]"}]}], 
                    
                    RowBox[{
                    RowBox[{"0.8690740862218694`", "\[VeryThinSpace]"}], "+", 
                    
                    RowBox[{"0.20913741050449197`", " ", 
                    "\[ImaginaryI]"}]}]}}, RowSpacings -> 1, ColumnSpacings -> 
                    1, RowAlignments -> Baseline, ColumnAlignments -> Center],
                     "\[NoBreak]", ")"}], 
                    Function[BoxForm`e$, 
                    MatrixForm[BoxForm`e$, TableHeadings -> None, {}]]], 
                    "SummaryItem"]}]}}, GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
                    AutoDelete -> False, 
                    GridBoxItemSize -> {"Columns" -> {{Automatic}}, 
                    "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {"Columns" -> {{2}}, 
                    "Rows" -> {{Automatic}}}, 
                    BaseStyle -> {ShowStringCharacters -> False, NumberMarks -> 
                    False, PrintPrecision -> 3, ShowSyntaxStyles -> False}]}},
                     GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    BaselinePosition -> {1, 1}]}, 
                    Dynamic[Typeset`open$$], ImageSize -> Automatic]}, 
                    "SummaryPanel"], DynamicModuleValues :> {}], "]"}], 
                    
                    QuantumMob`Q3`WickUnitary[{{Complex[-0.42467560233165114`,
                     0.7865614131135286], 
                    Complex[-0.17732558080543923`, -0.4117370697145353]}, {
                    Complex[0.1880663380541057, 0.40694327451871876`], 
                    Complex[0.8690740862218694, 0.20913741050449197`]}}, {3, 
                    4}, {"Label" -> Subsuperscript["U", 2, "\[Dagger]"]}], 
                    Selectable -> False, Editable -> False, 
                    SelectWithContents -> True]}], "}"}]}], "}"}], Short], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  QuantumMob`Q3`WickCircuit[{{
     QuantumMob`Q3`WickUnitary[{{Complex[-0.8843394033034941, 
       0.1714712587471254], 
       Complex[-0.1319516325954833, -0.4136788535130639]}, {
       Complex[-0.011739031976241952`, 0.43405486095280305`], Complex[
       0.8971471171513717, -0.08115185147910532]}}, {2, 3}, {
      "Label" -> Subsuperscript["U", 3, "\[Dagger]"]}]}, {
     QuantumMob`Q3`WickUnitary[{{
       Complex[-0.8365599309873879, -0.5200785464800819], 
       Complex[-0.13953645141161397`, 0.10107109421093918`]}, {
       Complex[-0.14950942281752816`, -0.08563130179036078], Complex[
       0.7763962068817628, -0.606236870028596]}}, {1, 2}, {
      "Label" -> Subsuperscript["U", 1, "\[Dagger]"]}], 
     QuantumMob`Q3`WickUnitary[{{Complex[-0.42467560233165114`, 
       0.7865614131135286], 
       Complex[-0.17732558080543923`, -0.4117370697145353]}, {Complex[
       0.1880663380541057, 0.40694327451871876`], Complex[0.8690740862218694, 
       0.20913741050449197`]}}, {3, 4}, {
      "Label" -> Subsuperscript["U", 2, "\[Dagger]"]}]}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[3]=",
 CellID->238292012,ExpressionUUID->"8a849a90-6341-4020-a0a4-48964862a0e2"],

Cell[BoxData[
 InterpretationBox[
  GraphicsBox[{
    LineBox[{{{0, -1}, {3, -1}}, {{0, -2}, {3, -2}}, {{0, -3}, {3, -3}}, {{
     0, -4}, {3, -4}}}], {
     {LightDarkSwitched[
       GrayLevel[1]], EdgeForm[Opacity[1]], 
      RectangleBox[{0.6, -3.4}, {1.4, -1.6}]}, InsetBox[
      StyleBox[
       TemplateBox[{"\"U\"", "3", "\"\[Dagger]\""},
        "Subsuperscript"],
       StripOnInput->False,
       FontSize->Scaled[0.13333333333333333`],
       FontWeight->"Light",
       FontSlant->Italic], {1., -2.5}, NCache[
      ImageScaled[{Rational[1, 2], Rational[1, 2]}], ImageScaled[{0.5, 0.5}]],
       Automatic, {1, 0}]}, {{
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{1.6, -2.4}, {2.4, -0.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", "1", "\"\[Dagger]\""},
         "Subsuperscript"],
        StripOnInput->False,
        FontSize->Scaled[0.13333333333333333`],
        FontWeight->"Light",
        FontSlant->Italic], {2., -1.5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}, {
      {LightDarkSwitched[
        GrayLevel[1]], EdgeForm[Opacity[1]], 
       RectangleBox[{1.6, -4.4}, {2.4, -2.6}]}, InsetBox[
       StyleBox[
        TemplateBox[{"\"U\"", "2", "\"\[Dagger]\""},
         "Subsuperscript"],
        StripOnInput->False,
        FontSize->Scaled[0.13333333333333333`],
        FontWeight->"Light",
        FontSlant->Italic], {2., -3.5}, NCache[
       ImageScaled[{Rational[1, 2], Rational[1, 2]}], 
        ImageScaled[{0.5, 0.5}]], Automatic, {1, 0}]}}},
   ImagePadding->{{25.56, 25.56}, {7.2, 7.2}},
   ImageSize->154.79999999999998`,
   PlotRange->{{0, 3}, {-4.5, -0.5}},
   PlotRangePadding->Scaled[0.025]],
  QuantumMob`Q3`QuantumCircuit[{
    QuantumMob`Q3`Gate[{
      QuantumMob`Q3`Private`c$32608[2], 
      QuantumMob`Q3`Private`c$32608[3]}, {
     "Label" -> Subsuperscript["U", 3, "\[Dagger]"]}, "Label" -> "U"]}, {
    QuantumMob`Q3`Gate[{
      QuantumMob`Q3`Private`c$32608[1], 
      QuantumMob`Q3`Private`c$32608[2]}, {
     "Label" -> Subsuperscript["U", 1, "\[Dagger]"]}, "Label" -> "U"], 
    QuantumMob`Q3`Gate[{
      QuantumMob`Q3`Private`c$32608[3], 
      QuantumMob`Q3`Private`c$32608[4]}, {
     "Label" -> Subsuperscript["U", 2, "\[Dagger]"]}, "Label" -> "U"]}, 
   "PostMeasurementDashes" -> False]]], "Output",
 CellLabel->"Out[3]=",
 CellID->2064327676,ExpressionUUID->"79e0e2e1-cbb4-4532-b4a2-f226ec87b268"]
}, Open  ]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, 
  Closed]]]]
}, Dynamic[CurrentValue[
 EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, 
  Closed]]]],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedFunction.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"See", " ", "Also"}], "SeeAlsoSection"]},
      {Cell[TextData[{
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["WickState"]], "paclet:QuantumMob/Q3/ref/WickState", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "95fe650a-afb8-4ff5-8d93-ca51d30ac0f0"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["WickNonunitary"]], 
           "paclet:QuantumMob/Q3/ref/WickNonunitary", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "d8799251-bf03-4cb4-9679-7aa3cbf6bf88"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["WickJump"]], "paclet:QuantumMob/Q3/ref/WickJump", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "35c80759-c703-410a-bb70-6c7d811f9c4b"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["WickMeasurement"]], 
           "paclet:QuantumMob/Q3/ref/WickMeasurement", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "ac130e8a-0c4b-41b7-9f42-a8b962efb2eb"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["BravyiUnitary"]], 
           "paclet:QuantumMob/Q3/ref/BravyiUnitary", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "a0480757-fd5f-4134-b467-f5c51be2d594"],
        "\[NonBreakingSpace]",
        StyleBox[
        "\[MediumSpace]\[FilledVerySmallSquare]\[MediumSpace]", 
         "InlineSeparator"],
        " ",
        Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["NambuUnitary"]], 
           "paclet:QuantumMob/Q3/ref/NambuUnitary", 
           "QuantumMob Package Symbol"},
          "PackageLink",
          BaseStyle->"InlineFormula"]], "InlineFormula",
         FontFamily->"Source Sans Pro",ExpressionUUID->
         "31d70904-e396-4fc9-9193-aa180e4cf85e"]
       }], "SeeAlso",ExpressionUUID->"3af65f3f-681b-4c8f-9e69-fcb4c46d2bb3"]}
     }]}
  }]], "SeeAlsoSection",ExpressionUUID->"7461c5b9-3ed0-4c8a-8b9e-\
0cb06c74c12f"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, 
       "RelatedTechNote.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Tech", " ", "Notes"}], "TechNotesSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "f139a172-5ffa-41eb-a8ff-903db1c321ac"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems with Q3"]], 
           "paclet:QuantumMob/Q3/tutorial/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "140886fe-e322-4bf5-957f-15fc7a6fb0f8"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Quick Start"]], 
           "paclet:QuantumMob/Q3/tutorial/Q3QuickStart"},
          "RefLinkPlain",
          BaseStyle->{"Tutorials"}]], "Tutorials",ExpressionUUID->
         "cb1a8f2f-98f5-4b80-ba9d-d27b47451355"]}]}
     }]}
  }]], "TechNotesSection",ExpressionUUID->"899e09b7-5e15-41ea-bde5-\
e884eedfb537"],

Cell[BoxData[GridBox[{
   {
    DynamicBox[FEPrivate`ImportImage[
      FrontEnd`FileName[{"Documentation", "FooterIcons"}, "RelatedGuide.png"]],
     ImageSizeCache->{50., {26.47265625, 33.52734375}}], GridBox[{
      {
       StyleBox[
        RowBox[{"Related", " ", "Guides"}], "MoreAboutSection"]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Fermionic Quantum Computation"]], 
           "paclet:QuantumMob/Q3/guide/FermionicQuantumComputation"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "34e2fe05-f98c-4f1f-8ec2-7bfde25bf34b"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Many-Body Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumManyBodySystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "ac7e8904-50fd-4803-9b15-a71f1df873ac"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Quantum Information Systems"]], 
           "paclet:QuantumMob/Q3/guide/QuantumInformationSystems"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "46ad2117-0bc9-4954-ba6c-13bf955222f8"]}]},
      {
       RowBox[{"\[FilledVerySmallSquare]", Cell[BoxData[
         TemplateBox[{
           Cell[
            TextData["Q3: Symbolic Quantum Simulation"]], 
           "paclet:QuantumMob/Q3/guide/Q3"},
          "RefLinkPlain",
          BaseStyle->{"MoreAbout"}]], "MoreAbout",ExpressionUUID->
         "5d39752d-93b5-4e26-8b2e-759686b2657d"]}]}
     }]}
  }]], "MoreAboutSection",ExpressionUUID->"0a345950-ed7d-4a0d-b9b0-\
138701a4dbd7"],

Cell[BoxData[GridBox[{
   {
    TemplateBox[{29},
     "Spacer1"], GridBox[{
      {
       RowBox[{
        TemplateBox[{17},
         "Spacer1"], 
        StyleBox[
         RowBox[{"Related", " ", "Links"}], "RelatedLinksSection"]}]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "S. Bravyi and R. K\[ODoubleDot]nig (2012)"}]]]], 
             "https://dl.acm.org/doi/10.5555/2481569.2481571"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "f70f8fea-5810-46d9-ac30-044e90384f56"]}]],ExpressionUUID->
         "6a22acdf-4de3-4c23-ae4c-7e5dc0a416de"],
        ", Quantum Information & Computation 12, 925 (2012), \"Classical \
simulation of dissipative fermionic linear optics.\""
       }], "RelatedLinks",ExpressionUUID->
        "135ee3ce-695a-4fe5-b370-2cb4c4ae131a"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], "S. Bravyi (2005)"}]]]], 
             "https://dl.acm.org/doi/abs/10.5555/2011637.2011640"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "12c96648-d722-4807-be63-4262ef424fa7"]}]],ExpressionUUID->
         "16ab6fa2-1b83-49c4-9d9d-eedecb38969b"],
        ", Quantum Information & Computation 5, 216 (2005), \"Lagrangian \
representation for fermionic linear optics.\""
       }], "RelatedLinks",ExpressionUUID->
        "40ae99b3-cad2-4ea2-9ec6-c0dc703681f9"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "S. Bravyi and A. Y. Kitaev (2002)"}]]]], 
             "https://doi.org/10.1006/aphy.2002.6254"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "f47c830a-1ba2-4c87-9dfa-f1d5b326ab88"]}]],ExpressionUUID->
         "8248110d-0c33-4e7c-8883-33bd371f6507"],
        ", Annals of Physics 298, 210 (2002),\"Fermionic Quantum Computation.\
\""
       }], "RelatedLinks",ExpressionUUID->
        "b2d8d24e-398e-496a-ba88-da1659c66718"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "X. Feng and S. Chen (2024)"}]]]], 
             "https://doi.org/10.1103/PhysRevB.110.144305"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "cea6241c-afcd-4066-a60d-1ef45fd4bdc3"]}]],ExpressionUUID->
         "6710e515-8405-4feb-9388-966f25d2fec4"],
        ", Physical Review B 110, 144305 (2024), \".\""
       }], "RelatedLinks",ExpressionUUID->
        "3d906036-86e3-454f-b596-12a619ce379c"]},
      {Cell[TextData[{
        Cell[BoxData[
         RowBox[{
          TemplateBox[{16},
           "Spacer1"], "\[FilledVerySmallSquare]", Cell[BoxData[
           TemplateBox[{
             Cell[
              TextData[
               Cell[
                TextData[{
                  Cell[
                   BoxData[
                    TemplateBox[{2}, "Spacer1"]]], 
                  "Mahn-Soo Choi (2022)"}]]]], 
             "https://doi.org/10.1007/978-3-030-91214-7"},
            "WebLink",
            BaseStyle->{"RelatedLinks"}]],ExpressionUUID->
           "68df549e-1eef-4a5d-a950-e20505a3a01e"]}]],ExpressionUUID->
         "dde69983-6bbd-403c-a9a2-686b8f107966"],
        ", A Quantum Computation Workbook (Springer)."
       }], "RelatedLinks",ExpressionUUID->
        "4d194076-9613-46a1-967a-ed51943f508f"]}
     }]}
  }]], "RelatedLinksSection",ExpressionUUID->"55986a4b-ab7c-4b39-9693-\
5a206dfaec3e"],

Cell[" ", "FooterCell",ExpressionUUID->"fd76ca51-4a42-4d76-a9f4-dab105e4bcf8"]
},
Saveable->False,
ScreenStyleEnvironment->"Working",
WindowSize->{900, 830},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowTitle->"WickUnitary",
Visible->True,
TaggingRules->{
 "ModificationHighlight" -> False, "ColorType" -> "", "LinkTrails" -> "", 
  "ExampleCounter" -> 1, 
  "Openers" -> {
   "PrimaryExamplesSection" -> Open, 
    "ExampleSection" -> {"0" -> Open, "1" -> Closed}, "AllOptsTable" -> 
    Closed, "NotesSection" -> Closed, 
    "ExampleSubsection" -> {"0" -> Closed, "1" -> Closed}}, "NewStyles" -> 
  True, "CitationPopupData" -> $Failed, "ShowCitation" -> False, "HasOptions" -> 
  True, "RootCaptions" -> "", "HeaderCoreAreaLink" -> {}, 
  "Metadata" -> {
   "built" -> "{2026, 2, 17, 23, 56, 2.326236}", 
    "history" -> {"14.3", "", "", ""}, "context" -> "QuantumMob`Q3`", 
    "keywords" -> {
     "fermionic quantum computation", "fermionic Gaussian state"}, 
    "specialkeywords" -> {}, "tutorialcollectionlinks" -> {}, "index" -> True,
     "label" -> "Quantum Mob/ Q3 Symbol", "language" -> "en", "paclet" -> 
    "QuantumMob/Q3", "status" -> "None", "summary" -> 
    "WickUnitary[u] represents the Gaussian unitary gate corresponding to the \
canonical transformation of the fermion modes characterized by the unitary \
matrix u. WickUnitary[u, {k1, k2, ...}] assumes that the unitary gate \
operates on fermion modes {k1, k2, ...} \\[Subset] [n].", "synonyms" -> {}, 
    "tabletags" -> {}, "title" -> "WickUnitary", "titlemodifier" -> "", 
    "metadescription" -> "", "windowtitle" -> "WickUnitary", "type" -> 
    "Symbol", "uri" -> "QuantumMob/Q3/ref/WickUnitary"}},
FrontEndVersion->"14.3 for Mac OS X ARM (64-bit) (July 8, 2025)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "Reference.nb"],
ExpressionUUID->"0de7c95a-6f04-45f7-9d41-23194f560b7c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "PrimaryExamplesSection"->{
  Cell[16581, 443, 1441, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"8f67b8fe-c523-4972-9f29-4b0b9f9f57ae",
   CellTags->"PrimaryExamplesSection",
   CellID->1618370475]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"PrimaryExamplesSection", 151168, 3493}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[579, 21, 7681, 182, 70, "AnchorBarGrid",ExpressionUUID->"0dad1cc6-ddec-46ac-bc3f-1b3c2ba22ed7",
 CellID->1],
Cell[8263, 205, 96, 0, 70, "ContextNameCell",ExpressionUUID->"a3246ceb-39a4-4580-8131-f29e3e0e1366"],
Cell[CellGroupData[{
Cell[8384, 209, 1362, 37, 70, "ObjectNameGrid",ExpressionUUID->"b89ca427-b55a-4da5-94c8-614e6aab9447"],
Cell[9749, 248, 2341, 64, 70, "Usage",ExpressionUUID->"a06e39c3-7d9c-4199-b0ce-5d217848c44f",
 CellID->2009445904]
}, Open  ]],
Cell[CellGroupData[{
Cell[12127, 317, 1851, 45, 70, "NotesSection",ExpressionUUID->"b2261f19-3cc1-4004-9c75-d095d584ec01",
 CellGroupingRules->{"SectionGrouping", 50},
 CellID->1533885409],
Cell[13981, 364, 1273, 36, 70, "Notes",ExpressionUUID->"61ec228a-2700-4372-82d9-6cd11043e70a",
 CellID->1429475806],
Cell[15257, 402, 1197, 35, 70, "Notes",ExpressionUUID->"d0d57c33-13b3-4d99-ba4d-a0f7bb159b3a",
 CellID->2063552999]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "NotesSection"}, Closed]]]],
Cell[CellGroupData[{
Cell[16581, 443, 1441, 38, 70, "PrimaryExamplesSection",ExpressionUUID->"8f67b8fe-c523-4972-9f29-4b0b9f9f57ae",
 CellTags->"PrimaryExamplesSection",
 CellID->1618370475],
Cell[18025, 483, 203, 3, 70, "Input",ExpressionUUID->"ebe98923-ffd2-43de-839a-8952a8a8324a",
 CellID->1691119094],
Cell[CellGroupData[{
Cell[18253, 490, 1419, 37, 70, "ExampleSection",ExpressionUUID->"4dd392d1-c7fa-4d1a-a0ef-e26b37b0de4e",
 CellID->2072184070],
Cell[19675, 529, 148, 1, 70, "ExampleText",ExpressionUUID->"001162aa-cd27-4825-a996-57ce45ef9de9",
 CellID->1050157890],
Cell[19826, 532, 204, 5, 70, "Input",ExpressionUUID->"4c59eb94-6d79-4cb1-bd5f-bba683e1ae27",
 CellID->259003905],
Cell[20033, 539, 131, 1, 70, "ExampleText",ExpressionUUID->"36ca58ec-2cd5-4663-8483-82dd23da8af4",
 CellID->684313274],
Cell[20167, 542, 220, 5, 70, "Input",ExpressionUUID->"297b03c5-716e-4d9d-93a9-3b14db03efc1",
 CellID->1192065336],
Cell[CellGroupData[{
Cell[20412, 551, 232, 5, 70, "Input",ExpressionUUID->"9e2407aa-1e7d-4da2-a230-8a3916c8cf78",
 CellID->1683933745],
Cell[20647, 558, 6857, 141, 70, "Output",ExpressionUUID->"ba1c7c7a-88ec-4110-959a-418532f72e1d",
 CellID->1511185819]
}, Open  ]],
Cell[27519, 702, 134, 1, 70, "ExampleText",ExpressionUUID->"8af8b57d-1a52-4e8f-9164-c2edb3e2eccb",
 CellID->811715240],
Cell[CellGroupData[{
Cell[27678, 707, 304, 7, 70, "Input",ExpressionUUID->"3ec446ed-a09d-42c3-aac7-f138f1513a39",
 CellID->422922265],
Cell[27985, 716, 1571, 37, 70, "Output",ExpressionUUID->"492bbd46-221d-46ae-bec6-d06143a755a6",
 CellID->210966864]
}, Open  ]],
Cell[29571, 756, 125, 1, 70, "ExampleText",ExpressionUUID->"026bc584-6c5e-4fe6-8eac-b26f07c1dfc4",
 CellID->593132822],
Cell[CellGroupData[{
Cell[29721, 761, 278, 7, 70, "Input",ExpressionUUID->"f312d400-9717-4a2a-a11d-732714042a3c",
 CellID->632644412],
Cell[30002, 770, 6616, 136, 70, "Output",ExpressionUUID->"488b02b9-3e88-49a4-a44b-46707caaa67f",
 CellID->224582051]
}, Open  ]],
Cell[36633, 909, 143, 1, 70, "ExampleText",ExpressionUUID->"a54e384c-a09e-4bcb-af1a-4dd3d19435f6",
 CellID->1713534129],
Cell[CellGroupData[{
Cell[36801, 914, 218, 5, 70, "Input",ExpressionUUID->"47123008-c4e7-47a8-b55f-b72969284281",
 CellID->1640993928],
Cell[37022, 921, 6678, 139, 70, "Output",ExpressionUUID->"acd71738-38d9-4f1b-8c6a-c3a3ecc4d7e5",
 CellID->1421763378]
}, Open  ]],
Cell[43715, 1063, 126, 1, 70, "ExampleText",ExpressionUUID->"66f7cb03-2cc9-4d06-8efb-f9ff5bc67248",
 CellID->1813500599],
Cell[CellGroupData[{
Cell[43866, 1068, 425, 10, 70, "Input",ExpressionUUID->"83e0441c-b6f0-4e25-b4d2-cf30d1cbd1fe",
 CellID->1386171055],
Cell[44294, 1080, 144, 2, 70, "Output",ExpressionUUID->"869a3c6c-b52d-46f5-8f18-750518dba621",
 CellID->526553877]
}, Open  ]],
Cell[44453, 1085, 171, 3, 70, "ExampleText",ExpressionUUID->"2f6c3ffb-91ec-45c5-ac64-9188736b5788",
 CellID->1312240680],
Cell[CellGroupData[{
Cell[44649, 1092, 332, 8, 70, "Input",ExpressionUUID->"29dd2111-f0e4-4339-8e45-b8a770f55e45",
 CellID->1208559217],
Cell[44984, 1102, 577, 19, 70, "Output",ExpressionUUID->"ede323de-c859-48ef-bafa-385868a6af43",
 CellID->772923898]
}, Open  ]],
Cell[CellGroupData[{
Cell[45598, 1126, 680, 18, 70, "Input",ExpressionUUID->"752acf9c-e260-4c3f-b9bd-f6417a52a946",
 CellID->524451751],
Cell[46281, 1146, 8270, 211, 70, "Output",ExpressionUUID->"572b2799-5aa2-40e4-b501-b5fced2d164e",
 CellID->1862523877],
Cell[54554, 1359, 2180, 48, 70, "Output",ExpressionUUID->"5556ed7e-b4e4-422b-aa7b-94dd6c60c979",
 CellID->1717162067]
}, Open  ]],
Cell[CellGroupData[{
Cell[56771, 1412, 312, 7, 70, "Input",ExpressionUUID->"39264f25-ed8e-4070-9096-89731b86a299",
 CellID->622994325],
Cell[57086, 1421, 911, 21, 70, "Output",ExpressionUUID->"bc6caaf4-60be-4cda-8903-d3581d6fe9d3",
 CellID->1341232880],
Cell[58000, 1444, 131, 2, 70, "Output",ExpressionUUID->"20dd08e2-2d99-4781-a971-0f841699efb2",
 CellID->2112655248]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[58280, 1454, 1323, 35, 70, "ExampleSection",ExpressionUUID->"d96b2a02-3210-4342-a38d-4308edfb3594",
 CellID->1915647073],
Cell[CellGroupData[{
Cell[59628, 1493, 1340, 35, 70, "ExampleSubsection",ExpressionUUID->"440ae985-15b6-401d-bbb2-4d8bb5fd8a43",
 CellID->2094670095],
Cell[60971, 1530, 131, 1, 70, "ExampleText",ExpressionUUID->"0c83eabe-c06c-49a6-b33a-e2b097d9001d",
 CellID->2067795335],
Cell[61105, 1533, 204, 5, 70, "Input",ExpressionUUID->"b1460b90-e738-4496-b1fe-dcaaf1b85d4b",
 CellID->200148117],
Cell[61312, 1540, 167, 3, 70, "ExampleText",ExpressionUUID->"9904bc30-8573-4601-b4cf-5c66a79fa05a",
 CellID->46280482],
Cell[CellGroupData[{
Cell[61504, 1547, 486, 13, 70, "Input",ExpressionUUID->"71e7c652-28c0-483f-9c7a-be98a697a1da",
 CellID->930011217],
Cell[61993, 1562, 171, 4, 70, "Output",ExpressionUUID->"7f1c3d74-597e-4b6b-bb80-240f4efd6150",
 CellID->344162351],
Cell[62167, 1568, 5637, 119, 70, "Output",ExpressionUUID->"5c8303a7-9a67-4fec-9b9e-5190ae12c5cf",
 CellID->1163171886]
}, Open  ]],
Cell[67819, 1690, 120, 1, 70, "ExampleText",ExpressionUUID->"3a474741-c728-43bb-91f6-9257f1175e1a",
 CellID->729548796],
Cell[CellGroupData[{
Cell[67964, 1695, 298, 8, 70, "Input",ExpressionUUID->"c17d2622-4a71-40b4-b3d8-4e854a11042a",
 CellID->928817187],
Cell[68265, 1705, 4695, 101, 70, "Output",ExpressionUUID->"0883751f-1a8f-485c-9fb9-7a8463ddfdd1",
 CellID->998152496]
}, Open  ]],
Cell[72975, 1809, 143, 1, 70, "ExampleText",ExpressionUUID->"f6e0bf30-f206-44ee-8d7b-8b1b783b8da5",
 CellID->1739421571],
Cell[CellGroupData[{
Cell[73143, 1814, 217, 5, 70, "Input",ExpressionUUID->"df69a9f6-b35b-48de-9358-48ab668819e0",
 CellID->788851537],
Cell[73363, 1821, 5321, 113, 70, "Output",ExpressionUUID->"5e6a8398-15f4-4b72-a433-1da6d59d9c56",
 CellID->1861086955]
}, Open  ]],
Cell[78699, 1937, 126, 1, 70, "ExampleText",ExpressionUUID->"497ad324-62aa-4d75-a195-2fc9afa809d6",
 CellID->1189134130],
Cell[CellGroupData[{
Cell[78850, 1942, 452, 11, 70, "Input",ExpressionUUID->"caf628ea-6cd7-47c0-9af1-aa69785f0dca",
 CellID->1672744108],
Cell[79305, 1955, 129, 2, 70, "Output",ExpressionUUID->"b9d47a62-3127-4263-91ec-766350e85a13",
 CellID->1987259850]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "0"}, Closed]]]],
Cell[CellGroupData[{
Cell[79586, 1965, 1341, 35, 70, "ExampleSubsection",ExpressionUUID->"445b3f1c-8730-42c2-81fc-7660778ae48a",
 CellID->958378569],
Cell[CellGroupData[{
Cell[80952, 2004, 1349, 35, 70, "Input",ExpressionUUID->"a0ace05c-f032-4ea7-9a61-f34085352b41",
 CellID->291676705],
Cell[82304, 2041, 24607, 470, 70, "Output",ExpressionUUID->"87b38b13-d1a0-4b85-9ab6-446ca97f9f0b",
 CellID->959821135]
}, Open  ]],
Cell[CellGroupData[{
Cell[106948, 2516, 195, 4, 70, "Input",ExpressionUUID->"aeed1be8-bb2d-478d-83b2-bce8e708dc94",
 CellID->1966620161],
Cell[107146, 2522, 2321, 56, 70, "Output",ExpressionUUID->"230c1241-f5df-498b-b5b3-577d2ef3d65c",
 CellID->1964143328]
}, Open  ]],
Cell[CellGroupData[{
Cell[109504, 2583, 378, 9, 70, "Input",ExpressionUUID->"05eef405-edc7-4a3c-b8dd-d53bde4e3909",
 CellID->1590852805],
Cell[109885, 2594, 24746, 471, 70, "Output",ExpressionUUID->"8a849a90-6341-4020-a0a4-48964862a0e2",
 CellID->238292012],
Cell[134634, 3067, 2507, 60, 70, "Output",ExpressionUUID->"79e0e2e1-cbb4-4532-b4a2-f226ec87b268",
 CellID->2064327676]
}, Open  ]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSubsection", "1"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "ExampleSection", "1"}, Closed]]]]
}, Dynamic[CurrentValue[EvaluationNotebook[], {TaggingRules, "Openers", "PrimaryExamplesSection"}, Closed]]]],
Cell[137498, 3139, 3555, 96, 70, "SeeAlsoSection",ExpressionUUID->"7461c5b9-3ed0-4c8a-8b9e-0cb06c74c12f"],
Cell[141056, 3237, 1519, 38, 70, "TechNotesSection",ExpressionUUID->"899e09b7-5e15-41ea-bde5-e884eedfb537"],
Cell[142578, 3277, 1871, 46, 70, "MoreAboutSection",ExpressionUUID->"0a345950-ed7d-4a0d-b9b0-138701a4dbd7"],
Cell[144452, 3325, 4702, 124, 70, "RelatedLinksSection",ExpressionUUID->"55986a4b-ab7c-4b39-9693-5a206dfaec3e"],
Cell[149157, 3451, 78, 0, 70, "FooterCell",ExpressionUUID->"fd76ca51-4a42-4d76-a9f4-dab105e4bcf8"]
}
]
*)

(* End of internal cache information *)
